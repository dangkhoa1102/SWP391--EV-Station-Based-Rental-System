function kx(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(s,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var _p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jp={exports:{}},yl={},Sp={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var za=Symbol.for("react.element"),bx=Symbol.for("react.portal"),Ix=Symbol.for("react.fragment"),Lx=Symbol.for("react.strict_mode"),Px=Symbol.for("react.profiler"),Ex=Symbol.for("react.provider"),Tx=Symbol.for("react.context"),Bx=Symbol.for("react.forward_ref"),Rx=Symbol.for("react.suspense"),Ax=Symbol.for("react.memo"),Mx=Symbol.for("react.lazy"),Th=Symbol.iterator;function Fx(e){return e===null||typeof e!="object"?null:(e=Th&&e[Th]||e["@@iterator"],typeof e=="function"?e:null)}var Cp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Np=Object.assign,kp={};function Ms(e,t,n){this.props=e,this.context=t,this.refs=kp,this.updater=n||Cp}Ms.prototype.isReactComponent={};Ms.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ms.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function bp(){}bp.prototype=Ms.prototype;function Od(e,t,n){this.props=e,this.context=t,this.refs=kp,this.updater=n||Cp}var Dd=Od.prototype=new bp;Dd.constructor=Od;Np(Dd,Ms.prototype);Dd.isPureReactComponent=!0;var Bh=Array.isArray,Ip=Object.prototype.hasOwnProperty,zd={current:null},Lp={key:!0,ref:!0,__self:!0,__source:!0};function Pp(e,t,n){var s,o={},a=null,l=null;if(t!=null)for(s in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(a=""+t.key),t)Ip.call(t,s)&&!Lp.hasOwnProperty(s)&&(o[s]=t[s]);var d=arguments.length-2;if(d===1)o.children=n;else if(1<d){for(var u=Array(d),f=0;f<d;f++)u[f]=arguments[f+2];o.children=u}if(e&&e.defaultProps)for(s in d=e.defaultProps,d)o[s]===void 0&&(o[s]=d[s]);return{$$typeof:za,type:e,key:a,ref:l,props:o,_owner:zd.current}}function Ux(e,t){return{$$typeof:za,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $d(e){return typeof e=="object"&&e!==null&&e.$$typeof===za}function Ox(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Rh=/\/+/g;function Ql(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ox(""+e.key):t.toString(36)}function Po(e,t,n,s,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case za:case bx:l=!0}}if(l)return l=e,o=o(l),e=s===""?"."+Ql(l,0):s,Bh(o)?(n="",e!=null&&(n=e.replace(Rh,"$&/")+"/"),Po(o,t,n,"",function(f){return f})):o!=null&&($d(o)&&(o=Ux(o,n+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(Rh,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=s===""?".":s+":",Bh(e))for(var d=0;d<e.length;d++){a=e[d];var u=s+Ql(a,d);l+=Po(a,t,n,u,o)}else if(u=Fx(e),typeof u=="function")for(e=u.call(e),d=0;!(a=e.next()).done;)a=a.value,u=s+Ql(a,d++),l+=Po(a,t,n,u,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function uo(e,t,n){if(e==null)return e;var s=[],o=0;return Po(e,s,"","",function(a){return t.call(n,a,o++)}),s}function Dx(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var sn={current:null},Eo={transition:null},zx={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:Eo,ReactCurrentOwner:zd};function Ep(){throw Error("act(...) is not supported in production builds of React.")}Ge.Children={map:uo,forEach:function(e,t,n){uo(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return uo(e,function(){t++}),t},toArray:function(e){return uo(e,function(t){return t})||[]},only:function(e){if(!$d(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ge.Component=Ms;Ge.Fragment=Ix;Ge.Profiler=Px;Ge.PureComponent=Od;Ge.StrictMode=Lx;Ge.Suspense=Rx;Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zx;Ge.act=Ep;Ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Np({},e.props),o=e.key,a=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,l=zd.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var d=e.type.defaultProps;for(u in t)Ip.call(t,u)&&!Lp.hasOwnProperty(u)&&(s[u]=t[u]===void 0&&d!==void 0?d[u]:t[u])}var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){d=Array(u);for(var f=0;f<u;f++)d[f]=arguments[f+2];s.children=d}return{$$typeof:za,type:e.type,key:o,ref:a,props:s,_owner:l}};Ge.createContext=function(e){return e={$$typeof:Tx,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ex,_context:e},e.Consumer=e};Ge.createElement=Pp;Ge.createFactory=function(e){var t=Pp.bind(null,e);return t.type=e,t};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(e){return{$$typeof:Bx,render:e}};Ge.isValidElement=$d;Ge.lazy=function(e){return{$$typeof:Mx,_payload:{_status:-1,_result:e},_init:Dx}};Ge.memo=function(e,t){return{$$typeof:Ax,type:e,compare:t===void 0?null:t}};Ge.startTransition=function(e){var t=Eo.transition;Eo.transition={};try{e()}finally{Eo.transition=t}};Ge.unstable_act=Ep;Ge.useCallback=function(e,t){return sn.current.useCallback(e,t)};Ge.useContext=function(e){return sn.current.useContext(e)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(e){return sn.current.useDeferredValue(e)};Ge.useEffect=function(e,t){return sn.current.useEffect(e,t)};Ge.useId=function(){return sn.current.useId()};Ge.useImperativeHandle=function(e,t,n){return sn.current.useImperativeHandle(e,t,n)};Ge.useInsertionEffect=function(e,t){return sn.current.useInsertionEffect(e,t)};Ge.useLayoutEffect=function(e,t){return sn.current.useLayoutEffect(e,t)};Ge.useMemo=function(e,t){return sn.current.useMemo(e,t)};Ge.useReducer=function(e,t,n){return sn.current.useReducer(e,t,n)};Ge.useRef=function(e){return sn.current.useRef(e)};Ge.useState=function(e){return sn.current.useState(e)};Ge.useSyncExternalStore=function(e,t,n){return sn.current.useSyncExternalStore(e,t,n)};Ge.useTransition=function(){return sn.current.useTransition()};Ge.version="18.3.1";Sp.exports=Ge;var v=Sp.exports;const hr=wp(v),$x=kx({__proto__:null,default:hr},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx=v,Hx=Symbol.for("react.element"),Zx=Symbol.for("react.fragment"),Vx=Object.prototype.hasOwnProperty,qx=Wx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gx={key:!0,ref:!0,__self:!0,__source:!0};function Tp(e,t,n){var s,o={},a=null,l=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)Vx.call(t,s)&&!Gx.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:Hx,type:e,key:a,ref:l,props:o,_owner:qx.current}}yl.Fragment=Zx;yl.jsx=Tp;yl.jsxs=Tp;jp.exports=yl;var r=jp.exports,Bp={exports:{}},jn={},Rp={exports:{}},Ap={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(H,he){var ne=H.length;H.push(he);e:for(;0<ne;){var xe=ne-1>>>1,ve=H[xe];if(0<o(ve,he))H[xe]=he,H[ne]=ve,ne=xe;else break e}}function n(H){return H.length===0?null:H[0]}function s(H){if(H.length===0)return null;var he=H[0],ne=H.pop();if(ne!==he){H[0]=ne;e:for(var xe=0,ve=H.length,oe=ve>>>1;xe<oe;){var D=2*(xe+1)-1,ee=H[D],G=D+1,_e=H[G];if(0>o(ee,ne))G<ve&&0>o(_e,ee)?(H[xe]=_e,H[G]=ne,xe=G):(H[xe]=ee,H[D]=ne,xe=D);else if(G<ve&&0>o(_e,ne))H[xe]=_e,H[G]=ne,xe=G;else break e}}return he}function o(H,he){var ne=H.sortIndex-he.sortIndex;return ne!==0?ne:H.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var u=[],f=[],m=1,g=null,y=3,C=!1,N=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(H){for(var he=n(f);he!==null;){if(he.callback===null)s(f);else if(he.startTime<=H)s(f),he.sortIndex=he.expirationTime,t(u,he);else break;he=n(f)}}function S(H){if(_=!1,k(H),!N)if(n(u)!==null)N=!0,ie(E);else{var he=n(f);he!==null&&U(S,he.startTime-H)}}function E(H,he){N=!1,_&&(_=!1,w(B),B=-1),C=!0;var ne=y;try{for(k(he),g=n(u);g!==null&&(!(g.expirationTime>he)||H&&!M());){var xe=g.callback;if(typeof xe=="function"){g.callback=null,y=g.priorityLevel;var ve=xe(g.expirationTime<=he);he=e.unstable_now(),typeof ve=="function"?g.callback=ve:g===n(u)&&s(u),k(he)}else s(u);g=n(u)}if(g!==null)var oe=!0;else{var D=n(f);D!==null&&U(S,D.startTime-he),oe=!1}return oe}finally{g=null,y=ne,C=!1}}var P=!1,R=null,B=-1,A=5,I=-1;function M(){return!(e.unstable_now()-I<A)}function W(){if(R!==null){var H=e.unstable_now();I=H;var he=!0;try{he=R(!0,H)}finally{he?V():(P=!1,R=null)}}else P=!1}var V;if(typeof x=="function")V=function(){x(W)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,Q=$.port2;$.port1.onmessage=W,V=function(){Q.postMessage(null)}}else V=function(){b(W,0)};function ie(H){R=H,P||(P=!0,V())}function U(H,he){B=b(function(){H(e.unstable_now())},he)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){N||C||(N=!0,ie(E))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(H){switch(y){case 1:case 2:case 3:var he=3;break;default:he=y}var ne=y;y=he;try{return H()}finally{y=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,he){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ne=y;y=H;try{return he()}finally{y=ne}},e.unstable_scheduleCallback=function(H,he,ne){var xe=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?xe+ne:xe):ne=xe,H){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=ne+ve,H={id:m++,callback:he,priorityLevel:H,startTime:ne,expirationTime:ve,sortIndex:-1},ne>xe?(H.sortIndex=ne,t(f,H),n(u)===null&&H===n(f)&&(_?(w(B),B=-1):_=!0,U(S,ne-xe))):(H.sortIndex=ve,t(u,H),N||C||(N=!0,ie(E))),H},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(H){var he=y;return function(){var ne=y;y=he;try{return H.apply(this,arguments)}finally{y=ne}}}})(Ap);Rp.exports=Ap;var Yx=Rp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx=v,wn=Yx;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mp=new Set,wa={};function $i(e,t){Is(e,t),Is(e+"Capture",t)}function Is(e,t){for(wa[e]=t,e=0;e<t.length;e++)Mp.add(t[e])}var Er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bc=Object.prototype.hasOwnProperty,Jx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ah={},Mh={};function Qx(e){return Bc.call(Mh,e)?!0:Bc.call(Ah,e)?!1:Jx.test(e)?Mh[e]=!0:(Ah[e]=!0,!1)}function Xx(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ev(e,t,n,s){if(t===null||typeof t>"u"||Xx(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function an(e,t,n,s,o,a,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wt[e]=new an(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wt[t]=new an(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wt[e]=new an(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wt[e]=new an(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wt[e]=new an(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wt[e]=new an(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wt[e]=new an(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wt[e]=new an(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wt[e]=new an(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wd=/[\-:]([a-z])/g;function Hd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wd,Hd);Wt[t]=new an(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wd,Hd);Wt[t]=new an(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wd,Hd);Wt[t]=new an(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wt[e]=new an(e,1,!1,e.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wt[e]=new an(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zd(e,t,n,s){var o=Wt.hasOwnProperty(t)?Wt[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ev(t,n,o,s)&&(n=null),s||o===null?Qx(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,s=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Ar=Kx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ho=Symbol.for("react.element"),ds=Symbol.for("react.portal"),us=Symbol.for("react.fragment"),Vd=Symbol.for("react.strict_mode"),Rc=Symbol.for("react.profiler"),Fp=Symbol.for("react.provider"),Up=Symbol.for("react.context"),qd=Symbol.for("react.forward_ref"),Ac=Symbol.for("react.suspense"),Mc=Symbol.for("react.suspense_list"),Gd=Symbol.for("react.memo"),qr=Symbol.for("react.lazy"),Op=Symbol.for("react.offscreen"),Fh=Symbol.iterator;function Qs(e){return e===null||typeof e!="object"?null:(e=Fh&&e[Fh]||e["@@iterator"],typeof e=="function"?e:null)}var wt=Object.assign,Xl;function la(e){if(Xl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Xl=t&&t[1]||""}return`
`+Xl+e}var ec=!1;function tc(e,t){if(!e||ec)return"";ec=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var s=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){s=f}e.call(t.prototype)}else{try{throw Error()}catch(f){s=f}e()}}catch(f){if(f&&s&&typeof f.stack=="string"){for(var o=f.stack.split(`
`),a=s.stack.split(`
`),l=o.length-1,d=a.length-1;1<=l&&0<=d&&o[l]!==a[d];)d--;for(;1<=l&&0<=d;l--,d--)if(o[l]!==a[d]){if(l!==1||d!==1)do if(l--,d--,0>d||o[l]!==a[d]){var u=`
`+o[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=d);break}}}finally{ec=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?la(e):""}function tv(e){switch(e.tag){case 5:return la(e.type);case 16:return la("Lazy");case 13:return la("Suspense");case 19:return la("SuspenseList");case 0:case 2:case 15:return e=tc(e.type,!1),e;case 11:return e=tc(e.type.render,!1),e;case 1:return e=tc(e.type,!0),e;default:return""}}function Fc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case us:return"Fragment";case ds:return"Portal";case Rc:return"Profiler";case Vd:return"StrictMode";case Ac:return"Suspense";case Mc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Up:return(e.displayName||"Context")+".Consumer";case Fp:return(e._context.displayName||"Context")+".Provider";case qd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Gd:return t=e.displayName||null,t!==null?t:Fc(e.type)||"Memo";case qr:t=e._payload,e=e._init;try{return Fc(e(t))}catch{}}return null}function nv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fc(t);case 8:return t===Vd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ci(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function rv(e){var t=Dp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(l){s=""+l,a.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fo(e){e._valueTracker||(e._valueTracker=rv(e))}function zp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Dp(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Zo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Uc(e,t){var n=t.checked;return wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Uh(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=ci(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $p(e,t){t=t.checked,t!=null&&Zd(e,"checked",t,!1)}function Oc(e,t){$p(e,t);var n=ci(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Dc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Dc(e,t.type,ci(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Oh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Dc(e,t,n){(t!=="number"||Zo(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ca=Array.isArray;function js(e,t,n,s){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&s&&(e[n].defaultSelected=!0)}else{for(n=""+ci(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function zc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Dh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(pe(92));if(ca(n)){if(1<n.length)throw Error(pe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ci(n)}}function Wp(e,t){var n=ci(t.value),s=ci(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function zh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $c(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var po,Zp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(po=po||document.createElement("div"),po.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=po.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ja(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ha={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iv=["Webkit","ms","Moz","O"];Object.keys(ha).forEach(function(e){iv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ha[t]=ha[e]})});function Vp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ha.hasOwnProperty(e)&&ha[e]?(""+t).trim():t+"px"}function qp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,o=Vp(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,o):e[n]=o}}var sv=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wc(e,t){if(t){if(sv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function Hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zc=null;function Yd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Vc=null,Ss=null,Cs=null;function $h(e){if(e=Ha(e)){if(typeof Vc!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=jl(t),Vc(e.stateNode,e.type,t))}}function Gp(e){Ss?Cs?Cs.push(e):Cs=[e]:Ss=e}function Yp(){if(Ss){var e=Ss,t=Cs;if(Cs=Ss=null,$h(e),t)for(e=0;e<t.length;e++)$h(t[e])}}function Kp(e,t){return e(t)}function Jp(){}var nc=!1;function Qp(e,t,n){if(nc)return e(t,n);nc=!0;try{return Kp(e,t,n)}finally{nc=!1,(Ss!==null||Cs!==null)&&(Jp(),Yp())}}function Sa(e,t){var n=e.stateNode;if(n===null)return null;var s=jl(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(pe(231,t,typeof n));return n}var qc=!1;if(Er)try{var Xs={};Object.defineProperty(Xs,"passive",{get:function(){qc=!0}}),window.addEventListener("test",Xs,Xs),window.removeEventListener("test",Xs,Xs)}catch{qc=!1}function av(e,t,n,s,o,a,l,d,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(m){this.onError(m)}}var fa=!1,Vo=null,qo=!1,Gc=null,ov={onError:function(e){fa=!0,Vo=e}};function lv(e,t,n,s,o,a,l,d,u){fa=!1,Vo=null,av.apply(ov,arguments)}function cv(e,t,n,s,o,a,l,d,u){if(lv.apply(this,arguments),fa){if(fa){var f=Vo;fa=!1,Vo=null}else throw Error(pe(198));qo||(qo=!0,Gc=f)}}function Wi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Xp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wh(e){if(Wi(e)!==e)throw Error(pe(188))}function dv(e){var t=e.alternate;if(!t){if(t=Wi(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var n=e,s=t;;){var o=n.return;if(o===null)break;var a=o.alternate;if(a===null){if(s=o.return,s!==null){n=s;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return Wh(o),e;if(a===s)return Wh(o),t;a=a.sibling}throw Error(pe(188))}if(n.return!==s.return)n=o,s=a;else{for(var l=!1,d=o.child;d;){if(d===n){l=!0,n=o,s=a;break}if(d===s){l=!0,s=o,n=a;break}d=d.sibling}if(!l){for(d=a.child;d;){if(d===n){l=!0,n=a,s=o;break}if(d===s){l=!0,s=a,n=o;break}d=d.sibling}if(!l)throw Error(pe(189))}}if(n.alternate!==s)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?e:t}function em(e){return e=dv(e),e!==null?tm(e):null}function tm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tm(e);if(t!==null)return t;e=e.sibling}return null}var nm=wn.unstable_scheduleCallback,Hh=wn.unstable_cancelCallback,uv=wn.unstable_shouldYield,hv=wn.unstable_requestPaint,Ct=wn.unstable_now,fv=wn.unstable_getCurrentPriorityLevel,Kd=wn.unstable_ImmediatePriority,rm=wn.unstable_UserBlockingPriority,Go=wn.unstable_NormalPriority,pv=wn.unstable_LowPriority,im=wn.unstable_IdlePriority,xl=null,dr=null;function mv(e){if(dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(xl,e,void 0,(e.current.flags&128)===128)}catch{}}var qn=Math.clz32?Math.clz32:xv,gv=Math.log,yv=Math.LN2;function xv(e){return e>>>=0,e===0?32:31-(gv(e)/yv|0)|0}var mo=64,go=4194304;function da(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yo(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,o=e.suspendedLanes,a=e.pingedLanes,l=n&268435455;if(l!==0){var d=l&~o;d!==0?s=da(d):(a&=l,a!==0&&(s=da(a)))}else l=n&~o,l!==0?s=da(l):a!==0&&(s=da(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-qn(t),o=1<<n,s|=e[n],t&=~o;return s}function vv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _v(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-qn(a),d=1<<l,u=o[l];u===-1?(!(d&n)||d&s)&&(o[l]=vv(d,t)):u<=t&&(e.expiredLanes|=d),a&=~d}}function Yc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sm(){var e=mo;return mo<<=1,!(mo&4194240)&&(mo=64),e}function rc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function $a(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qn(t),e[t]=n}function wv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-qn(n),a=1<<o;t[o]=0,s[o]=-1,e[o]=-1,n&=~a}}function Jd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-qn(n),o=1<<s;o&t|e[s]&t&&(e[s]|=t),n&=~o}}var ot=0;function am(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var om,Qd,lm,cm,dm,Kc=!1,yo=[],ei=null,ti=null,ni=null,Ca=new Map,Na=new Map,Yr=[],jv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zh(e,t){switch(e){case"focusin":case"focusout":ei=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":Ca.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Na.delete(t.pointerId)}}function ea(e,t,n,s,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[o]},t!==null&&(t=Ha(t),t!==null&&Qd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Sv(e,t,n,s,o){switch(t){case"focusin":return ei=ea(ei,e,t,n,s,o),!0;case"dragenter":return ti=ea(ti,e,t,n,s,o),!0;case"mouseover":return ni=ea(ni,e,t,n,s,o),!0;case"pointerover":var a=o.pointerId;return Ca.set(a,ea(Ca.get(a)||null,e,t,n,s,o)),!0;case"gotpointercapture":return a=o.pointerId,Na.set(a,ea(Na.get(a)||null,e,t,n,s,o)),!0}return!1}function um(e){var t=Li(e.target);if(t!==null){var n=Wi(t);if(n!==null){if(t=n.tag,t===13){if(t=Xp(n),t!==null){e.blockedOn=t,dm(e.priority,function(){lm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function To(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Zc=s,n.target.dispatchEvent(s),Zc=null}else return t=Ha(n),t!==null&&Qd(t),e.blockedOn=n,!1;t.shift()}return!0}function Vh(e,t,n){To(e)&&n.delete(t)}function Cv(){Kc=!1,ei!==null&&To(ei)&&(ei=null),ti!==null&&To(ti)&&(ti=null),ni!==null&&To(ni)&&(ni=null),Ca.forEach(Vh),Na.forEach(Vh)}function ta(e,t){e.blockedOn===t&&(e.blockedOn=null,Kc||(Kc=!0,wn.unstable_scheduleCallback(wn.unstable_NormalPriority,Cv)))}function ka(e){function t(o){return ta(o,e)}if(0<yo.length){ta(yo[0],e);for(var n=1;n<yo.length;n++){var s=yo[n];s.blockedOn===e&&(s.blockedOn=null)}}for(ei!==null&&ta(ei,e),ti!==null&&ta(ti,e),ni!==null&&ta(ni,e),Ca.forEach(t),Na.forEach(t),n=0;n<Yr.length;n++)s=Yr[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Yr.length&&(n=Yr[0],n.blockedOn===null);)um(n),n.blockedOn===null&&Yr.shift()}var Ns=Ar.ReactCurrentBatchConfig,Ko=!0;function Nv(e,t,n,s){var o=ot,a=Ns.transition;Ns.transition=null;try{ot=1,Xd(e,t,n,s)}finally{ot=o,Ns.transition=a}}function kv(e,t,n,s){var o=ot,a=Ns.transition;Ns.transition=null;try{ot=4,Xd(e,t,n,s)}finally{ot=o,Ns.transition=a}}function Xd(e,t,n,s){if(Ko){var o=Jc(e,t,n,s);if(o===null)fc(e,t,s,Jo,n),Zh(e,s);else if(Sv(o,e,t,n,s))s.stopPropagation();else if(Zh(e,s),t&4&&-1<jv.indexOf(e)){for(;o!==null;){var a=Ha(o);if(a!==null&&om(a),a=Jc(e,t,n,s),a===null&&fc(e,t,s,Jo,n),a===o)break;o=a}o!==null&&s.stopPropagation()}else fc(e,t,s,null,n)}}var Jo=null;function Jc(e,t,n,s){if(Jo=null,e=Yd(s),e=Li(e),e!==null)if(t=Wi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Xp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jo=e,null}function hm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fv()){case Kd:return 1;case rm:return 4;case Go:case pv:return 16;case im:return 536870912;default:return 16}default:return 16}}var Jr=null,eu=null,Bo=null;function fm(){if(Bo)return Bo;var e,t=eu,n=t.length,s,o="value"in Jr?Jr.value:Jr.textContent,a=o.length;for(e=0;e<n&&t[e]===o[e];e++);var l=n-e;for(s=1;s<=l&&t[n-s]===o[a-s];s++);return Bo=o.slice(e,1<s?1-s:void 0)}function Ro(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xo(){return!0}function qh(){return!1}function Sn(e){function t(n,s,o,a,l){this._reactName=n,this._targetInst=o,this.type=s,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var d in e)e.hasOwnProperty(d)&&(n=e[d],this[d]=n?n(a):a[d]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?xo:qh,this.isPropagationStopped=qh,this}return wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xo)},persist:function(){},isPersistent:xo}),t}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tu=Sn(Fs),Wa=wt({},Fs,{view:0,detail:0}),bv=Sn(Wa),ic,sc,na,vl=wt({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==na&&(na&&e.type==="mousemove"?(ic=e.screenX-na.screenX,sc=e.screenY-na.screenY):sc=ic=0,na=e),ic)},movementY:function(e){return"movementY"in e?e.movementY:sc}}),Gh=Sn(vl),Iv=wt({},vl,{dataTransfer:0}),Lv=Sn(Iv),Pv=wt({},Wa,{relatedTarget:0}),ac=Sn(Pv),Ev=wt({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),Tv=Sn(Ev),Bv=wt({},Fs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rv=Sn(Bv),Av=wt({},Fs,{data:0}),Yh=Sn(Av),Mv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ov(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Uv[e])?!!t[e]:!1}function nu(){return Ov}var Dv=wt({},Wa,{key:function(e){if(e.key){var t=Mv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ro(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nu,charCode:function(e){return e.type==="keypress"?Ro(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ro(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zv=Sn(Dv),$v=wt({},vl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kh=Sn($v),Wv=wt({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nu}),Hv=Sn(Wv),Zv=wt({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vv=Sn(Zv),qv=wt({},vl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Gv=Sn(qv),Yv=[9,13,27,32],ru=Er&&"CompositionEvent"in window,pa=null;Er&&"documentMode"in document&&(pa=document.documentMode);var Kv=Er&&"TextEvent"in window&&!pa,pm=Er&&(!ru||pa&&8<pa&&11>=pa),Jh=" ",Qh=!1;function mm(e,t){switch(e){case"keyup":return Yv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hs=!1;function Jv(e,t){switch(e){case"compositionend":return gm(t);case"keypress":return t.which!==32?null:(Qh=!0,Jh);case"textInput":return e=t.data,e===Jh&&Qh?null:e;default:return null}}function Qv(e,t){if(hs)return e==="compositionend"||!ru&&mm(e,t)?(e=fm(),Bo=eu=Jr=null,hs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pm&&t.locale!=="ko"?null:t.data;default:return null}}var Xv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xv[e.type]:t==="textarea"}function ym(e,t,n,s){Gp(s),t=Qo(t,"onChange"),0<t.length&&(n=new tu("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var ma=null,ba=null;function e_(e){Im(e,0)}function _l(e){var t=ms(e);if(zp(t))return e}function t_(e,t){if(e==="change")return t}var xm=!1;if(Er){var oc;if(Er){var lc="oninput"in document;if(!lc){var ef=document.createElement("div");ef.setAttribute("oninput","return;"),lc=typeof ef.oninput=="function"}oc=lc}else oc=!1;xm=oc&&(!document.documentMode||9<document.documentMode)}function tf(){ma&&(ma.detachEvent("onpropertychange",vm),ba=ma=null)}function vm(e){if(e.propertyName==="value"&&_l(ba)){var t=[];ym(t,ba,e,Yd(e)),Qp(e_,t)}}function n_(e,t,n){e==="focusin"?(tf(),ma=t,ba=n,ma.attachEvent("onpropertychange",vm)):e==="focusout"&&tf()}function r_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _l(ba)}function i_(e,t){if(e==="click")return _l(t)}function s_(e,t){if(e==="input"||e==="change")return _l(t)}function a_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yn=typeof Object.is=="function"?Object.is:a_;function Ia(e,t){if(Yn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var o=n[s];if(!Bc.call(t,o)||!Yn(e[o],t[o]))return!1}return!0}function nf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rf(e,t){var n=nf(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nf(n)}}function _m(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?_m(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wm(){for(var e=window,t=Zo();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Zo(e.document)}return t}function iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function o_(e){var t=wm(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&_m(n.ownerDocument.documentElement,n)){if(s!==null&&iu(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(s.start,o);s=s.end===void 0?a:Math.min(s.end,o),!e.extend&&a>s&&(o=s,s=a,a=o),o=rf(n,a);var l=rf(n,s);o&&l&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var l_=Er&&"documentMode"in document&&11>=document.documentMode,fs=null,Qc=null,ga=null,Xc=!1;function sf(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xc||fs==null||fs!==Zo(s)||(s=fs,"selectionStart"in s&&iu(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ga&&Ia(ga,s)||(ga=s,s=Qo(Qc,"onSelect"),0<s.length&&(t=new tu("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=fs)))}function vo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ps={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionend:vo("Transition","TransitionEnd")},cc={},jm={};Er&&(jm=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function wl(e){if(cc[e])return cc[e];if(!ps[e])return e;var t=ps[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in jm)return cc[e]=t[n];return e}var Sm=wl("animationend"),Cm=wl("animationiteration"),Nm=wl("animationstart"),km=wl("transitionend"),bm=new Map,af="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ui(e,t){bm.set(e,t),$i(t,[e])}for(var dc=0;dc<af.length;dc++){var uc=af[dc],c_=uc.toLowerCase(),d_=uc[0].toUpperCase()+uc.slice(1);ui(c_,"on"+d_)}ui(Sm,"onAnimationEnd");ui(Cm,"onAnimationIteration");ui(Nm,"onAnimationStart");ui("dblclick","onDoubleClick");ui("focusin","onFocus");ui("focusout","onBlur");ui(km,"onTransitionEnd");Is("onMouseEnter",["mouseout","mouseover"]);Is("onMouseLeave",["mouseout","mouseover"]);Is("onPointerEnter",["pointerout","pointerover"]);Is("onPointerLeave",["pointerout","pointerover"]);$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$i("onBeforeInput",["compositionend","keypress","textInput","paste"]);$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u_=new Set("cancel close invalid load scroll toggle".split(" ").concat(ua));function of(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,cv(s,t,void 0,e),e.currentTarget=null}function Im(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],o=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var l=s.length-1;0<=l;l--){var d=s[l],u=d.instance,f=d.currentTarget;if(d=d.listener,u!==a&&o.isPropagationStopped())break e;of(o,d,f),a=u}else for(l=0;l<s.length;l++){if(d=s[l],u=d.instance,f=d.currentTarget,d=d.listener,u!==a&&o.isPropagationStopped())break e;of(o,d,f),a=u}}}if(qo)throw e=Gc,qo=!1,Gc=null,e}function ht(e,t){var n=t[id];n===void 0&&(n=t[id]=new Set);var s=e+"__bubble";n.has(s)||(Lm(t,e,2,!1),n.add(s))}function hc(e,t,n){var s=0;t&&(s|=4),Lm(n,e,s,t)}var _o="_reactListening"+Math.random().toString(36).slice(2);function La(e){if(!e[_o]){e[_o]=!0,Mp.forEach(function(n){n!=="selectionchange"&&(u_.has(n)||hc(n,!1,e),hc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_o]||(t[_o]=!0,hc("selectionchange",!1,t))}}function Lm(e,t,n,s){switch(hm(t)){case 1:var o=Nv;break;case 4:o=kv;break;default:o=Xd}n=o.bind(null,t,n,e),o=void 0,!qc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function fc(e,t,n,s,o){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var d=s.stateNode.containerInfo;if(d===o||d.nodeType===8&&d.parentNode===o)break;if(l===4)for(l=s.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;l=l.return}for(;d!==null;){if(l=Li(d),l===null)return;if(u=l.tag,u===5||u===6){s=a=l;continue e}d=d.parentNode}}s=s.return}Qp(function(){var f=a,m=Yd(n),g=[];e:{var y=bm.get(e);if(y!==void 0){var C=tu,N=e;switch(e){case"keypress":if(Ro(n)===0)break e;case"keydown":case"keyup":C=zv;break;case"focusin":N="focus",C=ac;break;case"focusout":N="blur",C=ac;break;case"beforeblur":case"afterblur":C=ac;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Gh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Lv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Hv;break;case Sm:case Cm:case Nm:C=Tv;break;case km:C=Vv;break;case"scroll":C=bv;break;case"wheel":C=Gv;break;case"copy":case"cut":case"paste":C=Rv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Kh}var _=(t&4)!==0,b=!_&&e==="scroll",w=_?y!==null?y+"Capture":null:y;_=[];for(var x=f,k;x!==null;){k=x;var S=k.stateNode;if(k.tag===5&&S!==null&&(k=S,w!==null&&(S=Sa(x,w),S!=null&&_.push(Pa(x,S,k)))),b)break;x=x.return}0<_.length&&(y=new C(y,N,null,n,m),g.push({event:y,listeners:_}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",y&&n!==Zc&&(N=n.relatedTarget||n.fromElement)&&(Li(N)||N[Tr]))break e;if((C||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,C?(N=n.relatedTarget||n.toElement,C=f,N=N?Li(N):null,N!==null&&(b=Wi(N),N!==b||N.tag!==5&&N.tag!==6)&&(N=null)):(C=null,N=f),C!==N)){if(_=Gh,S="onMouseLeave",w="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(_=Kh,S="onPointerLeave",w="onPointerEnter",x="pointer"),b=C==null?y:ms(C),k=N==null?y:ms(N),y=new _(S,x+"leave",C,n,m),y.target=b,y.relatedTarget=k,S=null,Li(m)===f&&(_=new _(w,x+"enter",N,n,m),_.target=k,_.relatedTarget=b,S=_),b=S,C&&N)t:{for(_=C,w=N,x=0,k=_;k;k=cs(k))x++;for(k=0,S=w;S;S=cs(S))k++;for(;0<x-k;)_=cs(_),x--;for(;0<k-x;)w=cs(w),k--;for(;x--;){if(_===w||w!==null&&_===w.alternate)break t;_=cs(_),w=cs(w)}_=null}else _=null;C!==null&&lf(g,y,C,_,!1),N!==null&&b!==null&&lf(g,b,N,_,!0)}}e:{if(y=f?ms(f):window,C=y.nodeName&&y.nodeName.toLowerCase(),C==="select"||C==="input"&&y.type==="file")var E=t_;else if(Xh(y))if(xm)E=s_;else{E=r_;var P=n_}else(C=y.nodeName)&&C.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(E=i_);if(E&&(E=E(e,f))){ym(g,E,n,m);break e}P&&P(e,y,f),e==="focusout"&&(P=y._wrapperState)&&P.controlled&&y.type==="number"&&Dc(y,"number",y.value)}switch(P=f?ms(f):window,e){case"focusin":(Xh(P)||P.contentEditable==="true")&&(fs=P,Qc=f,ga=null);break;case"focusout":ga=Qc=fs=null;break;case"mousedown":Xc=!0;break;case"contextmenu":case"mouseup":case"dragend":Xc=!1,sf(g,n,m);break;case"selectionchange":if(l_)break;case"keydown":case"keyup":sf(g,n,m)}var R;if(ru)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else hs?mm(e,n)&&(B="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(B="onCompositionStart");B&&(pm&&n.locale!=="ko"&&(hs||B!=="onCompositionStart"?B==="onCompositionEnd"&&hs&&(R=fm()):(Jr=m,eu="value"in Jr?Jr.value:Jr.textContent,hs=!0)),P=Qo(f,B),0<P.length&&(B=new Yh(B,e,null,n,m),g.push({event:B,listeners:P}),R?B.data=R:(R=gm(n),R!==null&&(B.data=R)))),(R=Kv?Jv(e,n):Qv(e,n))&&(f=Qo(f,"onBeforeInput"),0<f.length&&(m=new Yh("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:f}),m.data=R))}Im(g,t)})}function Pa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qo(e,t){for(var n=t+"Capture",s=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=Sa(e,n),a!=null&&s.unshift(Pa(e,a,o)),a=Sa(e,t),a!=null&&s.push(Pa(e,a,o))),e=e.return}return s}function cs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function lf(e,t,n,s,o){for(var a=t._reactName,l=[];n!==null&&n!==s;){var d=n,u=d.alternate,f=d.stateNode;if(u!==null&&u===s)break;d.tag===5&&f!==null&&(d=f,o?(u=Sa(n,a),u!=null&&l.unshift(Pa(n,u,d))):o||(u=Sa(n,a),u!=null&&l.push(Pa(n,u,d)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var h_=/\r\n?/g,f_=/\u0000|\uFFFD/g;function cf(e){return(typeof e=="string"?e:""+e).replace(h_,`
`).replace(f_,"")}function wo(e,t,n){if(t=cf(t),cf(e)!==t&&n)throw Error(pe(425))}function Xo(){}var ed=null,td=null;function nd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rd=typeof setTimeout=="function"?setTimeout:void 0,p_=typeof clearTimeout=="function"?clearTimeout:void 0,df=typeof Promise=="function"?Promise:void 0,m_=typeof queueMicrotask=="function"?queueMicrotask:typeof df<"u"?function(e){return df.resolve(null).then(e).catch(g_)}:rd;function g_(e){setTimeout(function(){throw e})}function pc(e,t){var n=t,s=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(s===0){e.removeChild(o),ka(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=o}while(n);ka(t)}function ri(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function uf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Us=Math.random().toString(36).slice(2),cr="__reactFiber$"+Us,Ea="__reactProps$"+Us,Tr="__reactContainer$"+Us,id="__reactEvents$"+Us,y_="__reactListeners$"+Us,x_="__reactHandles$"+Us;function Li(e){var t=e[cr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Tr]||n[cr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=uf(e);e!==null;){if(n=e[cr])return n;e=uf(e)}return t}e=n,n=e.parentNode}return null}function Ha(e){return e=e[cr]||e[Tr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ms(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function jl(e){return e[Ea]||null}var sd=[],gs=-1;function hi(e){return{current:e}}function ft(e){0>gs||(e.current=sd[gs],sd[gs]=null,gs--)}function ut(e,t){gs++,sd[gs]=e.current,e.current=t}var di={},Jt=hi(di),un=hi(!1),Mi=di;function Ls(e,t){var n=e.type.contextTypes;if(!n)return di;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in n)o[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function hn(e){return e=e.childContextTypes,e!=null}function el(){ft(un),ft(Jt)}function hf(e,t,n){if(Jt.current!==di)throw Error(pe(168));ut(Jt,t),ut(un,n)}function Pm(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(pe(108,nv(e)||"Unknown",o));return wt({},n,s)}function tl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||di,Mi=Jt.current,ut(Jt,e),ut(un,un.current),!0}function ff(e,t,n){var s=e.stateNode;if(!s)throw Error(pe(169));n?(e=Pm(e,t,Mi),s.__reactInternalMemoizedMergedChildContext=e,ft(un),ft(Jt),ut(Jt,e)):ft(un),ut(un,n)}var Nr=null,Sl=!1,mc=!1;function Em(e){Nr===null?Nr=[e]:Nr.push(e)}function v_(e){Sl=!0,Em(e)}function fi(){if(!mc&&Nr!==null){mc=!0;var e=0,t=ot;try{var n=Nr;for(ot=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Nr=null,Sl=!1}catch(o){throw Nr!==null&&(Nr=Nr.slice(e+1)),nm(Kd,fi),o}finally{ot=t,mc=!1}}return null}var ys=[],xs=0,nl=null,rl=0,Pn=[],En=0,Fi=null,kr=1,br="";function bi(e,t){ys[xs++]=rl,ys[xs++]=nl,nl=e,rl=t}function Tm(e,t,n){Pn[En++]=kr,Pn[En++]=br,Pn[En++]=Fi,Fi=e;var s=kr;e=br;var o=32-qn(s)-1;s&=~(1<<o),n+=1;var a=32-qn(t)+o;if(30<a){var l=o-o%5;a=(s&(1<<l)-1).toString(32),s>>=l,o-=l,kr=1<<32-qn(t)+o|n<<o|s,br=a+e}else kr=1<<a|n<<o|s,br=e}function su(e){e.return!==null&&(bi(e,1),Tm(e,1,0))}function au(e){for(;e===nl;)nl=ys[--xs],ys[xs]=null,rl=ys[--xs],ys[xs]=null;for(;e===Fi;)Fi=Pn[--En],Pn[En]=null,br=Pn[--En],Pn[En]=null,kr=Pn[--En],Pn[En]=null}var _n=null,vn=null,mt=!1,Zn=null;function Bm(e,t){var n=Tn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function pf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_n=e,vn=ri(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_n=e,vn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Fi!==null?{id:kr,overflow:br}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Tn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,_n=e,vn=null,!0):!1;default:return!1}}function ad(e){return(e.mode&1)!==0&&(e.flags&128)===0}function od(e){if(mt){var t=vn;if(t){var n=t;if(!pf(e,t)){if(ad(e))throw Error(pe(418));t=ri(n.nextSibling);var s=_n;t&&pf(e,t)?Bm(s,n):(e.flags=e.flags&-4097|2,mt=!1,_n=e)}}else{if(ad(e))throw Error(pe(418));e.flags=e.flags&-4097|2,mt=!1,_n=e}}}function mf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_n=e}function jo(e){if(e!==_n)return!1;if(!mt)return mf(e),mt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nd(e.type,e.memoizedProps)),t&&(t=vn)){if(ad(e))throw Rm(),Error(pe(418));for(;t;)Bm(e,t),t=ri(t.nextSibling)}if(mf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){vn=ri(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}vn=null}}else vn=_n?ri(e.stateNode.nextSibling):null;return!0}function Rm(){for(var e=vn;e;)e=ri(e.nextSibling)}function Ps(){vn=_n=null,mt=!1}function ou(e){Zn===null?Zn=[e]:Zn.push(e)}var __=Ar.ReactCurrentBatchConfig;function ra(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var s=n.stateNode}if(!s)throw Error(pe(147,e));var o=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(l){var d=o.refs;l===null?delete d[a]:d[a]=l},t._stringRef=a,t)}if(typeof e!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,e))}return e}function So(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gf(e){var t=e._init;return t(e._payload)}function Am(e){function t(w,x){if(e){var k=w.deletions;k===null?(w.deletions=[x],w.flags|=16):k.push(x)}}function n(w,x){if(!e)return null;for(;x!==null;)t(w,x),x=x.sibling;return null}function s(w,x){for(w=new Map;x!==null;)x.key!==null?w.set(x.key,x):w.set(x.index,x),x=x.sibling;return w}function o(w,x){return w=oi(w,x),w.index=0,w.sibling=null,w}function a(w,x,k){return w.index=k,e?(k=w.alternate,k!==null?(k=k.index,k<x?(w.flags|=2,x):k):(w.flags|=2,x)):(w.flags|=1048576,x)}function l(w){return e&&w.alternate===null&&(w.flags|=2),w}function d(w,x,k,S){return x===null||x.tag!==6?(x=jc(k,w.mode,S),x.return=w,x):(x=o(x,k),x.return=w,x)}function u(w,x,k,S){var E=k.type;return E===us?m(w,x,k.props.children,S,k.key):x!==null&&(x.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===qr&&gf(E)===x.type)?(S=o(x,k.props),S.ref=ra(w,x,k),S.return=w,S):(S=zo(k.type,k.key,k.props,null,w.mode,S),S.ref=ra(w,x,k),S.return=w,S)}function f(w,x,k,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==k.containerInfo||x.stateNode.implementation!==k.implementation?(x=Sc(k,w.mode,S),x.return=w,x):(x=o(x,k.children||[]),x.return=w,x)}function m(w,x,k,S,E){return x===null||x.tag!==7?(x=Ri(k,w.mode,S,E),x.return=w,x):(x=o(x,k),x.return=w,x)}function g(w,x,k){if(typeof x=="string"&&x!==""||typeof x=="number")return x=jc(""+x,w.mode,k),x.return=w,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ho:return k=zo(x.type,x.key,x.props,null,w.mode,k),k.ref=ra(w,null,x),k.return=w,k;case ds:return x=Sc(x,w.mode,k),x.return=w,x;case qr:var S=x._init;return g(w,S(x._payload),k)}if(ca(x)||Qs(x))return x=Ri(x,w.mode,k,null),x.return=w,x;So(w,x)}return null}function y(w,x,k,S){var E=x!==null?x.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return E!==null?null:d(w,x,""+k,S);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ho:return k.key===E?u(w,x,k,S):null;case ds:return k.key===E?f(w,x,k,S):null;case qr:return E=k._init,y(w,x,E(k._payload),S)}if(ca(k)||Qs(k))return E!==null?null:m(w,x,k,S,null);So(w,k)}return null}function C(w,x,k,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return w=w.get(k)||null,d(x,w,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ho:return w=w.get(S.key===null?k:S.key)||null,u(x,w,S,E);case ds:return w=w.get(S.key===null?k:S.key)||null,f(x,w,S,E);case qr:var P=S._init;return C(w,x,k,P(S._payload),E)}if(ca(S)||Qs(S))return w=w.get(k)||null,m(x,w,S,E,null);So(x,S)}return null}function N(w,x,k,S){for(var E=null,P=null,R=x,B=x=0,A=null;R!==null&&B<k.length;B++){R.index>B?(A=R,R=null):A=R.sibling;var I=y(w,R,k[B],S);if(I===null){R===null&&(R=A);break}e&&R&&I.alternate===null&&t(w,R),x=a(I,x,B),P===null?E=I:P.sibling=I,P=I,R=A}if(B===k.length)return n(w,R),mt&&bi(w,B),E;if(R===null){for(;B<k.length;B++)R=g(w,k[B],S),R!==null&&(x=a(R,x,B),P===null?E=R:P.sibling=R,P=R);return mt&&bi(w,B),E}for(R=s(w,R);B<k.length;B++)A=C(R,w,B,k[B],S),A!==null&&(e&&A.alternate!==null&&R.delete(A.key===null?B:A.key),x=a(A,x,B),P===null?E=A:P.sibling=A,P=A);return e&&R.forEach(function(M){return t(w,M)}),mt&&bi(w,B),E}function _(w,x,k,S){var E=Qs(k);if(typeof E!="function")throw Error(pe(150));if(k=E.call(k),k==null)throw Error(pe(151));for(var P=E=null,R=x,B=x=0,A=null,I=k.next();R!==null&&!I.done;B++,I=k.next()){R.index>B?(A=R,R=null):A=R.sibling;var M=y(w,R,I.value,S);if(M===null){R===null&&(R=A);break}e&&R&&M.alternate===null&&t(w,R),x=a(M,x,B),P===null?E=M:P.sibling=M,P=M,R=A}if(I.done)return n(w,R),mt&&bi(w,B),E;if(R===null){for(;!I.done;B++,I=k.next())I=g(w,I.value,S),I!==null&&(x=a(I,x,B),P===null?E=I:P.sibling=I,P=I);return mt&&bi(w,B),E}for(R=s(w,R);!I.done;B++,I=k.next())I=C(R,w,B,I.value,S),I!==null&&(e&&I.alternate!==null&&R.delete(I.key===null?B:I.key),x=a(I,x,B),P===null?E=I:P.sibling=I,P=I);return e&&R.forEach(function(W){return t(w,W)}),mt&&bi(w,B),E}function b(w,x,k,S){if(typeof k=="object"&&k!==null&&k.type===us&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case ho:e:{for(var E=k.key,P=x;P!==null;){if(P.key===E){if(E=k.type,E===us){if(P.tag===7){n(w,P.sibling),x=o(P,k.props.children),x.return=w,w=x;break e}}else if(P.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===qr&&gf(E)===P.type){n(w,P.sibling),x=o(P,k.props),x.ref=ra(w,P,k),x.return=w,w=x;break e}n(w,P);break}else t(w,P);P=P.sibling}k.type===us?(x=Ri(k.props.children,w.mode,S,k.key),x.return=w,w=x):(S=zo(k.type,k.key,k.props,null,w.mode,S),S.ref=ra(w,x,k),S.return=w,w=S)}return l(w);case ds:e:{for(P=k.key;x!==null;){if(x.key===P)if(x.tag===4&&x.stateNode.containerInfo===k.containerInfo&&x.stateNode.implementation===k.implementation){n(w,x.sibling),x=o(x,k.children||[]),x.return=w,w=x;break e}else{n(w,x);break}else t(w,x);x=x.sibling}x=Sc(k,w.mode,S),x.return=w,w=x}return l(w);case qr:return P=k._init,b(w,x,P(k._payload),S)}if(ca(k))return N(w,x,k,S);if(Qs(k))return _(w,x,k,S);So(w,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,x!==null&&x.tag===6?(n(w,x.sibling),x=o(x,k),x.return=w,w=x):(n(w,x),x=jc(k,w.mode,S),x.return=w,w=x),l(w)):n(w,x)}return b}var Es=Am(!0),Mm=Am(!1),il=hi(null),sl=null,vs=null,lu=null;function cu(){lu=vs=sl=null}function du(e){var t=il.current;ft(il),e._currentValue=t}function ld(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function ks(e,t){sl=e,lu=vs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(dn=!0),e.firstContext=null)}function Rn(e){var t=e._currentValue;if(lu!==e)if(e={context:e,memoizedValue:t,next:null},vs===null){if(sl===null)throw Error(pe(308));vs=e,sl.dependencies={lanes:0,firstContext:e}}else vs=vs.next=e;return t}var Pi=null;function uu(e){Pi===null?Pi=[e]:Pi.push(e)}function Fm(e,t,n,s){var o=t.interleaved;return o===null?(n.next=n,uu(t)):(n.next=o.next,o.next=n),t.interleaved=n,Br(e,s)}function Br(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Gr=!1;function hu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Um(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ii(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Xe&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,Br(e,n)}return o=s.interleaved,o===null?(t.next=t,uu(s)):(t.next=o.next,o.next=t),s.interleaved=t,Br(e,n)}function Ao(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Jd(e,n)}}function yf(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var o=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?o=a=l:a=a.next=l,n=n.next}while(n!==null);a===null?o=a=t:a=a.next=t}else o=a=t;n={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function al(e,t,n,s){var o=e.updateQueue;Gr=!1;var a=o.firstBaseUpdate,l=o.lastBaseUpdate,d=o.shared.pending;if(d!==null){o.shared.pending=null;var u=d,f=u.next;u.next=null,l===null?a=f:l.next=f,l=u;var m=e.alternate;m!==null&&(m=m.updateQueue,d=m.lastBaseUpdate,d!==l&&(d===null?m.firstBaseUpdate=f:d.next=f,m.lastBaseUpdate=u))}if(a!==null){var g=o.baseState;l=0,m=f=u=null,d=a;do{var y=d.lane,C=d.eventTime;if((s&y)===y){m!==null&&(m=m.next={eventTime:C,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var N=e,_=d;switch(y=t,C=n,_.tag){case 1:if(N=_.payload,typeof N=="function"){g=N.call(C,g,y);break e}g=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=_.payload,y=typeof N=="function"?N.call(C,g,y):N,y==null)break e;g=wt({},g,y);break e;case 2:Gr=!0}}d.callback!==null&&d.lane!==0&&(e.flags|=64,y=o.effects,y===null?o.effects=[d]:y.push(d))}else C={eventTime:C,lane:y,tag:d.tag,payload:d.payload,callback:d.callback,next:null},m===null?(f=m=C,u=g):m=m.next=C,l|=y;if(d=d.next,d===null){if(d=o.shared.pending,d===null)break;y=d,d=y.next,y.next=null,o.lastBaseUpdate=y,o.shared.pending=null}}while(!0);if(m===null&&(u=g),o.baseState=u,o.firstBaseUpdate=f,o.lastBaseUpdate=m,t=o.shared.interleaved,t!==null){o=t;do l|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Oi|=l,e.lanes=l,e.memoizedState=g}}function xf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=n,typeof o!="function")throw Error(pe(191,o));o.call(s)}}}var Za={},ur=hi(Za),Ta=hi(Za),Ba=hi(Za);function Ei(e){if(e===Za)throw Error(pe(174));return e}function fu(e,t){switch(ut(Ba,t),ut(Ta,e),ut(ur,Za),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$c(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$c(t,e)}ft(ur),ut(ur,t)}function Ts(){ft(ur),ft(Ta),ft(Ba)}function Om(e){Ei(Ba.current);var t=Ei(ur.current),n=$c(t,e.type);t!==n&&(ut(Ta,e),ut(ur,n))}function pu(e){Ta.current===e&&(ft(ur),ft(Ta))}var xt=hi(0);function ol(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gc=[];function mu(){for(var e=0;e<gc.length;e++)gc[e]._workInProgressVersionPrimary=null;gc.length=0}var Mo=Ar.ReactCurrentDispatcher,yc=Ar.ReactCurrentBatchConfig,Ui=0,_t=null,Et=null,Ft=null,ll=!1,ya=!1,Ra=0,w_=0;function Vt(){throw Error(pe(321))}function gu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function yu(e,t,n,s,o,a){if(Ui=a,_t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mo.current=e===null||e.memoizedState===null?N_:k_,e=n(s,o),ya){a=0;do{if(ya=!1,Ra=0,25<=a)throw Error(pe(301));a+=1,Ft=Et=null,t.updateQueue=null,Mo.current=b_,e=n(s,o)}while(ya)}if(Mo.current=cl,t=Et!==null&&Et.next!==null,Ui=0,Ft=Et=_t=null,ll=!1,t)throw Error(pe(300));return e}function xu(){var e=Ra!==0;return Ra=0,e}function lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?_t.memoizedState=Ft=e:Ft=Ft.next=e,Ft}function An(){if(Et===null){var e=_t.alternate;e=e!==null?e.memoizedState:null}else e=Et.next;var t=Ft===null?_t.memoizedState:Ft.next;if(t!==null)Ft=t,Et=e;else{if(e===null)throw Error(pe(310));Et=e,e={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Ft===null?_t.memoizedState=Ft=e:Ft=Ft.next=e}return Ft}function Aa(e,t){return typeof t=="function"?t(e):t}function xc(e){var t=An(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=Et,o=s.baseQueue,a=n.pending;if(a!==null){if(o!==null){var l=o.next;o.next=a.next,a.next=l}s.baseQueue=o=a,n.pending=null}if(o!==null){a=o.next,s=s.baseState;var d=l=null,u=null,f=a;do{var m=f.lane;if((Ui&m)===m)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),s=f.hasEagerState?f.eagerState:e(s,f.action);else{var g={lane:m,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(d=u=g,l=s):u=u.next=g,_t.lanes|=m,Oi|=m}f=f.next}while(f!==null&&f!==a);u===null?l=s:u.next=d,Yn(s,t.memoizedState)||(dn=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=u,n.lastRenderedState=s}if(e=n.interleaved,e!==null){o=e;do a=o.lane,_t.lanes|=a,Oi|=a,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vc(e){var t=An(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=n.dispatch,o=n.pending,a=t.memoizedState;if(o!==null){n.pending=null;var l=o=o.next;do a=e(a,l.action),l=l.next;while(l!==o);Yn(a,t.memoizedState)||(dn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,s]}function Dm(){}function zm(e,t){var n=_t,s=An(),o=t(),a=!Yn(s.memoizedState,o);if(a&&(s.memoizedState=o,dn=!0),s=s.queue,vu(Hm.bind(null,n,s,e),[e]),s.getSnapshot!==t||a||Ft!==null&&Ft.memoizedState.tag&1){if(n.flags|=2048,Ma(9,Wm.bind(null,n,s,o,t),void 0,null),Ut===null)throw Error(pe(349));Ui&30||$m(n,t,o)}return o}function $m(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Wm(e,t,n,s){t.value=n,t.getSnapshot=s,Zm(t)&&Vm(e)}function Hm(e,t,n){return n(function(){Zm(t)&&Vm(e)})}function Zm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch{return!0}}function Vm(e){var t=Br(e,1);t!==null&&Gn(t,e,1,-1)}function vf(e){var t=lr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:e},t.queue=e,e=e.dispatch=C_.bind(null,_t,e),[t.memoizedState,e]}function Ma(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function qm(){return An().memoizedState}function Fo(e,t,n,s){var o=lr();_t.flags|=e,o.memoizedState=Ma(1|t,n,void 0,s===void 0?null:s)}function Cl(e,t,n,s){var o=An();s=s===void 0?null:s;var a=void 0;if(Et!==null){var l=Et.memoizedState;if(a=l.destroy,s!==null&&gu(s,l.deps)){o.memoizedState=Ma(t,n,a,s);return}}_t.flags|=e,o.memoizedState=Ma(1|t,n,a,s)}function _f(e,t){return Fo(8390656,8,e,t)}function vu(e,t){return Cl(2048,8,e,t)}function Gm(e,t){return Cl(4,2,e,t)}function Ym(e,t){return Cl(4,4,e,t)}function Km(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Jm(e,t,n){return n=n!=null?n.concat([e]):null,Cl(4,4,Km.bind(null,t,e),n)}function _u(){}function Qm(e,t){var n=An();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&gu(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Xm(e,t){var n=An();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&gu(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function eg(e,t,n){return Ui&21?(Yn(n,t)||(n=sm(),_t.lanes|=n,Oi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,dn=!0),e.memoizedState=n)}function j_(e,t){var n=ot;ot=n!==0&&4>n?n:4,e(!0);var s=yc.transition;yc.transition={};try{e(!1),t()}finally{ot=n,yc.transition=s}}function tg(){return An().memoizedState}function S_(e,t,n){var s=ai(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},ng(e))rg(t,n);else if(n=Fm(e,t,n,s),n!==null){var o=rn();Gn(n,e,s,o),ig(n,t,s)}}function C_(e,t,n){var s=ai(e),o={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(ng(e))rg(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var l=t.lastRenderedState,d=a(l,n);if(o.hasEagerState=!0,o.eagerState=d,Yn(d,l)){var u=t.interleaved;u===null?(o.next=o,uu(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Fm(e,t,o,s),n!==null&&(o=rn(),Gn(n,e,s,o),ig(n,t,s))}}function ng(e){var t=e.alternate;return e===_t||t!==null&&t===_t}function rg(e,t){ya=ll=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ig(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Jd(e,n)}}var cl={readContext:Rn,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useInsertionEffect:Vt,useLayoutEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useMutableSource:Vt,useSyncExternalStore:Vt,useId:Vt,unstable_isNewReconciler:!1},N_={readContext:Rn,useCallback:function(e,t){return lr().memoizedState=[e,t===void 0?null:t],e},useContext:Rn,useEffect:_f,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Fo(4194308,4,Km.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=lr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=lr();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=S_.bind(null,_t,e),[s.memoizedState,e]},useRef:function(e){var t=lr();return e={current:e},t.memoizedState=e},useState:vf,useDebugValue:_u,useDeferredValue:function(e){return lr().memoizedState=e},useTransition:function(){var e=vf(!1),t=e[0];return e=j_.bind(null,e[1]),lr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=_t,o=lr();if(mt){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=t(),Ut===null)throw Error(pe(349));Ui&30||$m(s,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,_f(Hm.bind(null,s,a,e),[e]),s.flags|=2048,Ma(9,Wm.bind(null,s,a,n,t),void 0,null),n},useId:function(){var e=lr(),t=Ut.identifierPrefix;if(mt){var n=br,s=kr;n=(s&~(1<<32-qn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ra++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=w_++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},k_={readContext:Rn,useCallback:Qm,useContext:Rn,useEffect:vu,useImperativeHandle:Jm,useInsertionEffect:Gm,useLayoutEffect:Ym,useMemo:Xm,useReducer:xc,useRef:qm,useState:function(){return xc(Aa)},useDebugValue:_u,useDeferredValue:function(e){var t=An();return eg(t,Et.memoizedState,e)},useTransition:function(){var e=xc(Aa)[0],t=An().memoizedState;return[e,t]},useMutableSource:Dm,useSyncExternalStore:zm,useId:tg,unstable_isNewReconciler:!1},b_={readContext:Rn,useCallback:Qm,useContext:Rn,useEffect:vu,useImperativeHandle:Jm,useInsertionEffect:Gm,useLayoutEffect:Ym,useMemo:Xm,useReducer:vc,useRef:qm,useState:function(){return vc(Aa)},useDebugValue:_u,useDeferredValue:function(e){var t=An();return Et===null?t.memoizedState=e:eg(t,Et.memoizedState,e)},useTransition:function(){var e=vc(Aa)[0],t=An().memoizedState;return[e,t]},useMutableSource:Dm,useSyncExternalStore:zm,useId:tg,unstable_isNewReconciler:!1};function Wn(e,t){if(e&&e.defaultProps){t=wt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function cd(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:wt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Nl={isMounted:function(e){return(e=e._reactInternals)?Wi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=rn(),o=ai(e),a=Lr(s,o);a.payload=t,n!=null&&(a.callback=n),t=ii(e,a,o),t!==null&&(Gn(t,e,o,s),Ao(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=rn(),o=ai(e),a=Lr(s,o);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=ii(e,a,o),t!==null&&(Gn(t,e,o,s),Ao(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rn(),s=ai(e),o=Lr(n,s);o.tag=2,t!=null&&(o.callback=t),t=ii(e,o,s),t!==null&&(Gn(t,e,s,n),Ao(t,e,s))}};function wf(e,t,n,s,o,a,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,l):t.prototype&&t.prototype.isPureReactComponent?!Ia(n,s)||!Ia(o,a):!0}function sg(e,t,n){var s=!1,o=di,a=t.contextType;return typeof a=="object"&&a!==null?a=Rn(a):(o=hn(t)?Mi:Jt.current,s=t.contextTypes,a=(s=s!=null)?Ls(e,o):di),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Nl,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function jf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Nl.enqueueReplaceState(t,t.state,null)}function dd(e,t,n,s){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},hu(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=Rn(a):(a=hn(t)?Mi:Jt.current,o.context=Ls(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(cd(e,t,a,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Nl.enqueueReplaceState(o,o.state,null),al(e,n,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Bs(e,t){try{var n="",s=t;do n+=tv(s),s=s.return;while(s);var o=n}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function _c(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ud(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var I_=typeof WeakMap=="function"?WeakMap:Map;function ag(e,t,n){n=Lr(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){ul||(ul=!0,wd=s),ud(e,t)},n}function og(e,t,n){n=Lr(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;n.payload=function(){return s(o)},n.callback=function(){ud(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){ud(e,t),typeof s!="function"&&(si===null?si=new Set([this]):si.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Sf(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new I_;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(n)||(o.add(n),e=$_.bind(null,e,t,n),t.then(e,e))}function Cf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Nf(e,t,n,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Lr(-1,1),t.tag=2,ii(n,t,1))),n.lanes|=1),e)}var L_=Ar.ReactCurrentOwner,dn=!1;function tn(e,t,n,s){t.child=e===null?Mm(t,null,n,s):Es(t,e.child,n,s)}function kf(e,t,n,s,o){n=n.render;var a=t.ref;return ks(t,o),s=yu(e,t,n,s,a,o),n=xu(),e!==null&&!dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Rr(e,t,o)):(mt&&n&&su(t),t.flags|=1,tn(e,t,s,o),t.child)}function bf(e,t,n,s,o){if(e===null){var a=n.type;return typeof a=="function"&&!Iu(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,lg(e,t,a,s,o)):(e=zo(n.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var l=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ia,n(l,s)&&e.ref===t.ref)return Rr(e,t,o)}return t.flags|=1,e=oi(a,s),e.ref=t.ref,e.return=t,t.child=e}function lg(e,t,n,s,o){if(e!==null){var a=e.memoizedProps;if(Ia(a,s)&&e.ref===t.ref)if(dn=!1,t.pendingProps=s=a,(e.lanes&o)!==0)e.flags&131072&&(dn=!0);else return t.lanes=e.lanes,Rr(e,t,o)}return hd(e,t,n,s,o)}function cg(e,t,n){var s=t.pendingProps,o=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(ws,xn),xn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ut(ws,xn),xn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:n,ut(ws,xn),xn|=s}else a!==null?(s=a.baseLanes|n,t.memoizedState=null):s=n,ut(ws,xn),xn|=s;return tn(e,t,o,n),t.child}function dg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function hd(e,t,n,s,o){var a=hn(n)?Mi:Jt.current;return a=Ls(t,a),ks(t,o),n=yu(e,t,n,s,a,o),s=xu(),e!==null&&!dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Rr(e,t,o)):(mt&&s&&su(t),t.flags|=1,tn(e,t,n,o),t.child)}function If(e,t,n,s,o){if(hn(n)){var a=!0;tl(t)}else a=!1;if(ks(t,o),t.stateNode===null)Uo(e,t),sg(t,n,s),dd(t,n,s,o),s=!0;else if(e===null){var l=t.stateNode,d=t.memoizedProps;l.props=d;var u=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Rn(f):(f=hn(n)?Mi:Jt.current,f=Ls(t,f));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";g||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(d!==s||u!==f)&&jf(t,l,s,f),Gr=!1;var y=t.memoizedState;l.state=y,al(t,s,l,o),u=t.memoizedState,d!==s||y!==u||un.current||Gr?(typeof m=="function"&&(cd(t,n,m,s),u=t.memoizedState),(d=Gr||wf(t,n,d,s,y,u,f))?(g||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=u),l.props=s,l.state=u,l.context=f,s=d):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{l=t.stateNode,Um(e,t),d=t.memoizedProps,f=t.type===t.elementType?d:Wn(t.type,d),l.props=f,g=t.pendingProps,y=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=Rn(u):(u=hn(n)?Mi:Jt.current,u=Ls(t,u));var C=n.getDerivedStateFromProps;(m=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(d!==g||y!==u)&&jf(t,l,s,u),Gr=!1,y=t.memoizedState,l.state=y,al(t,s,l,o);var N=t.memoizedState;d!==g||y!==N||un.current||Gr?(typeof C=="function"&&(cd(t,n,C,s),N=t.memoizedState),(f=Gr||wf(t,n,f,s,y,N,u)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,N,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,N,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=N),l.props=s,l.state=N,l.context=u,s=f):(typeof l.componentDidUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),s=!1)}return fd(e,t,n,s,a,o)}function fd(e,t,n,s,o,a){dg(e,t);var l=(t.flags&128)!==0;if(!s&&!l)return o&&ff(t,n,!1),Rr(e,t,a);s=t.stateNode,L_.current=t;var d=l&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&l?(t.child=Es(t,e.child,null,a),t.child=Es(t,null,d,a)):tn(e,t,d,a),t.memoizedState=s.state,o&&ff(t,n,!0),t.child}function ug(e){var t=e.stateNode;t.pendingContext?hf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&hf(e,t.context,!1),fu(e,t.containerInfo)}function Lf(e,t,n,s,o){return Ps(),ou(o),t.flags|=256,tn(e,t,n,s),t.child}var pd={dehydrated:null,treeContext:null,retryLane:0};function md(e){return{baseLanes:e,cachePool:null,transitions:null}}function hg(e,t,n){var s=t.pendingProps,o=xt.current,a=!1,l=(t.flags&128)!==0,d;if((d=l)||(d=e!==null&&e.memoizedState===null?!1:(o&2)!==0),d?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),ut(xt,o&1),e===null)return od(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=Il(l,s,0,null),e=Ri(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=md(n),t.memoizedState=pd,e):wu(t,l));if(o=e.memoizedState,o!==null&&(d=o.dehydrated,d!==null))return P_(e,t,l,s,d,o,n);if(a){a=s.fallback,l=t.mode,o=e.child,d=o.sibling;var u={mode:"hidden",children:s.children};return!(l&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=u,t.deletions=null):(s=oi(o,u),s.subtreeFlags=o.subtreeFlags&14680064),d!==null?a=oi(d,a):(a=Ri(a,l,n,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=e.child.memoizedState,l=l===null?md(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=pd,s}return a=e.child,e=a.sibling,s=oi(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function wu(e,t){return t=Il({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Co(e,t,n,s){return s!==null&&ou(s),Es(t,e.child,null,n),e=wu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function P_(e,t,n,s,o,a,l){if(n)return t.flags&256?(t.flags&=-257,s=_c(Error(pe(422))),Co(e,t,l,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,o=t.mode,s=Il({mode:"visible",children:s.children},o,0,null),a=Ri(a,o,l,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&Es(t,e.child,null,l),t.child.memoizedState=md(l),t.memoizedState=pd,a);if(!(t.mode&1))return Co(e,t,l,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var d=s.dgst;return s=d,a=Error(pe(419)),s=_c(a,s,void 0),Co(e,t,l,s)}if(d=(l&e.childLanes)!==0,dn||d){if(s=Ut,s!==null){switch(l&-l){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|l)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,Br(e,o),Gn(s,e,o,-1))}return bu(),s=_c(Error(pe(421))),Co(e,t,l,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=W_.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,vn=ri(o.nextSibling),_n=t,mt=!0,Zn=null,e!==null&&(Pn[En++]=kr,Pn[En++]=br,Pn[En++]=Fi,kr=e.id,br=e.overflow,Fi=t),t=wu(t,s.children),t.flags|=4096,t)}function Pf(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ld(e.return,t,n)}function wc(e,t,n,s,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=o)}function fg(e,t,n){var s=t.pendingProps,o=s.revealOrder,a=s.tail;if(tn(e,t,s.children,n),s=xt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pf(e,n,t);else if(e.tag===19)Pf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ut(xt,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&ol(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),wc(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&ol(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}wc(t,!0,n,null,a);break;case"together":wc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Oi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,n=oi(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=oi(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function E_(e,t,n){switch(t.tag){case 3:ug(t),Ps();break;case 5:Om(t);break;case 1:hn(t.type)&&tl(t);break;case 4:fu(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;ut(il,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ut(xt,xt.current&1),t.flags|=128,null):n&t.child.childLanes?hg(e,t,n):(ut(xt,xt.current&1),e=Rr(e,t,n),e!==null?e.sibling:null);ut(xt,xt.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return fg(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),ut(xt,xt.current),s)break;return null;case 22:case 23:return t.lanes=0,cg(e,t,n)}return Rr(e,t,n)}var pg,gd,mg,gg;pg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gd=function(){};mg=function(e,t,n,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,Ei(ur.current);var a=null;switch(n){case"input":o=Uc(e,o),s=Uc(e,s),a=[];break;case"select":o=wt({},o,{value:void 0}),s=wt({},s,{value:void 0}),a=[];break;case"textarea":o=zc(e,o),s=zc(e,s),a=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Xo)}Wc(n,s);var l;n=null;for(f in o)if(!s.hasOwnProperty(f)&&o.hasOwnProperty(f)&&o[f]!=null)if(f==="style"){var d=o[f];for(l in d)d.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(wa.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in s){var u=s[f];if(d=o!=null?o[f]:void 0,s.hasOwnProperty(f)&&u!==d&&(u!=null||d!=null))if(f==="style")if(d){for(l in d)!d.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&d[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(a||(a=[]),a.push(f,n)),n=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,d=d?d.__html:void 0,u!=null&&d!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(wa.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&ht("scroll",e),a||d===u||(a=[])):(a=a||[]).push(f,u))}n&&(a=a||[]).push("style",n);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};gg=function(e,t,n,s){n!==s&&(t.flags|=4)};function ia(e,t){if(!mt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function T_(e,t,n){var s=t.pendingProps;switch(au(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(t),null;case 1:return hn(t.type)&&el(),qt(t),null;case 3:return s=t.stateNode,Ts(),ft(un),ft(Jt),mu(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(jo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zn!==null&&(Cd(Zn),Zn=null))),gd(e,t),qt(t),null;case 5:pu(t);var o=Ei(Ba.current);if(n=t.type,e!==null&&t.stateNode!=null)mg(e,t,n,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(pe(166));return qt(t),null}if(e=Ei(ur.current),jo(t)){s=t.stateNode,n=t.type;var a=t.memoizedProps;switch(s[cr]=t,s[Ea]=a,e=(t.mode&1)!==0,n){case"dialog":ht("cancel",s),ht("close",s);break;case"iframe":case"object":case"embed":ht("load",s);break;case"video":case"audio":for(o=0;o<ua.length;o++)ht(ua[o],s);break;case"source":ht("error",s);break;case"img":case"image":case"link":ht("error",s),ht("load",s);break;case"details":ht("toggle",s);break;case"input":Uh(s,a),ht("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},ht("invalid",s);break;case"textarea":Dh(s,a),ht("invalid",s)}Wc(n,a),o=null;for(var l in a)if(a.hasOwnProperty(l)){var d=a[l];l==="children"?typeof d=="string"?s.textContent!==d&&(a.suppressHydrationWarning!==!0&&wo(s.textContent,d,e),o=["children",d]):typeof d=="number"&&s.textContent!==""+d&&(a.suppressHydrationWarning!==!0&&wo(s.textContent,d,e),o=["children",""+d]):wa.hasOwnProperty(l)&&d!=null&&l==="onScroll"&&ht("scroll",s)}switch(n){case"input":fo(s),Oh(s,a,!0);break;case"textarea":fo(s),zh(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Xo)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{l=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=l.createElement(n,{is:s.is}):(e=l.createElement(n),n==="select"&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,n),e[cr]=t,e[Ea]=s,pg(e,t,!1,!1),t.stateNode=e;e:{switch(l=Hc(n,s),n){case"dialog":ht("cancel",e),ht("close",e),o=s;break;case"iframe":case"object":case"embed":ht("load",e),o=s;break;case"video":case"audio":for(o=0;o<ua.length;o++)ht(ua[o],e);o=s;break;case"source":ht("error",e),o=s;break;case"img":case"image":case"link":ht("error",e),ht("load",e),o=s;break;case"details":ht("toggle",e),o=s;break;case"input":Uh(e,s),o=Uc(e,s),ht("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=wt({},s,{value:void 0}),ht("invalid",e);break;case"textarea":Dh(e,s),o=zc(e,s),ht("invalid",e);break;default:o=s}Wc(n,o),d=o;for(a in d)if(d.hasOwnProperty(a)){var u=d[a];a==="style"?qp(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Zp(e,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ja(e,u):typeof u=="number"&&ja(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(wa.hasOwnProperty(a)?u!=null&&a==="onScroll"&&ht("scroll",e):u!=null&&Zd(e,a,u,l))}switch(n){case"input":fo(e),Oh(e,s,!1);break;case"textarea":fo(e),zh(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ci(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?js(e,!!s.multiple,a,!1):s.defaultValue!=null&&js(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Xo)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return qt(t),null;case 6:if(e&&t.stateNode!=null)gg(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(pe(166));if(n=Ei(Ba.current),Ei(ur.current),jo(t)){if(s=t.stateNode,n=t.memoizedProps,s[cr]=t,(a=s.nodeValue!==n)&&(e=_n,e!==null))switch(e.tag){case 3:wo(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wo(s.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[cr]=t,t.stateNode=s}return qt(t),null;case 13:if(ft(xt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(mt&&vn!==null&&t.mode&1&&!(t.flags&128))Rm(),Ps(),t.flags|=98560,a=!1;else if(a=jo(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(pe(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(pe(317));a[cr]=t}else Ps(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;qt(t),a=!1}else Zn!==null&&(Cd(Zn),Zn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||xt.current&1?Tt===0&&(Tt=3):bu())),t.updateQueue!==null&&(t.flags|=4),qt(t),null);case 4:return Ts(),gd(e,t),e===null&&La(t.stateNode.containerInfo),qt(t),null;case 10:return du(t.type._context),qt(t),null;case 17:return hn(t.type)&&el(),qt(t),null;case 19:if(ft(xt),a=t.memoizedState,a===null)return qt(t),null;if(s=(t.flags&128)!==0,l=a.rendering,l===null)if(s)ia(a,!1);else{if(Tt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=ol(e),l!==null){for(t.flags|=128,ia(a,!1),s=l.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)a=n,e=s,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ut(xt,xt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ct()>Rs&&(t.flags|=128,s=!0,ia(a,!1),t.lanes=4194304)}else{if(!s)if(e=ol(l),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ia(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!mt)return qt(t),null}else 2*Ct()-a.renderingStartTime>Rs&&n!==1073741824&&(t.flags|=128,s=!0,ia(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(n=a.last,n!==null?n.sibling=l:t.child=l,a.last=l)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ct(),t.sibling=null,n=xt.current,ut(xt,s?n&1|2:n&1),t):(qt(t),null);case 22:case 23:return ku(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?xn&1073741824&&(qt(t),t.subtreeFlags&6&&(t.flags|=8192)):qt(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function B_(e,t){switch(au(t),t.tag){case 1:return hn(t.type)&&el(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ts(),ft(un),ft(Jt),mu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pu(t),null;case 13:if(ft(xt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));Ps()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ft(xt),null;case 4:return Ts(),null;case 10:return du(t.type._context),null;case 22:case 23:return ku(),null;case 24:return null;default:return null}}var No=!1,Gt=!1,R_=typeof WeakSet=="function"?WeakSet:Set,ke=null;function _s(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){jt(e,t,s)}else n.current=null}function yd(e,t,n){try{n()}catch(s){jt(e,t,s)}}var Ef=!1;function A_(e,t){if(ed=Ko,e=wm(),iu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var o=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var l=0,d=-1,u=-1,f=0,m=0,g=e,y=null;t:for(;;){for(var C;g!==n||o!==0&&g.nodeType!==3||(d=l+o),g!==a||s!==0&&g.nodeType!==3||(u=l+s),g.nodeType===3&&(l+=g.nodeValue.length),(C=g.firstChild)!==null;)y=g,g=C;for(;;){if(g===e)break t;if(y===n&&++f===o&&(d=l),y===a&&++m===s&&(u=l),(C=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=C}n=d===-1||u===-1?null:{start:d,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(td={focusedElem:e,selectionRange:n},Ko=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var N=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var _=N.memoizedProps,b=N.memoizedState,w=t.stateNode,x=w.getSnapshotBeforeUpdate(t.elementType===t.type?_:Wn(t.type,_),b);w.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(S){jt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return N=Ef,Ef=!1,N}function xa(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&yd(t,n,a)}o=o.next}while(o!==s)}}function kl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function xd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function yg(e){var t=e.alternate;t!==null&&(e.alternate=null,yg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[cr],delete t[Ea],delete t[id],delete t[y_],delete t[x_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xg(e){return e.tag===5||e.tag===3||e.tag===4}function Tf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Xo));else if(s!==4&&(e=e.child,e!==null))for(vd(e,t,n),e=e.sibling;e!==null;)vd(e,t,n),e=e.sibling}function _d(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(_d(e,t,n),e=e.sibling;e!==null;)_d(e,t,n),e=e.sibling}var zt=null,Hn=!1;function Vr(e,t,n){for(n=n.child;n!==null;)vg(e,t,n),n=n.sibling}function vg(e,t,n){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(xl,n)}catch{}switch(n.tag){case 5:Gt||_s(n,t);case 6:var s=zt,o=Hn;zt=null,Vr(e,t,n),zt=s,Hn=o,zt!==null&&(Hn?(e=zt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):zt.removeChild(n.stateNode));break;case 18:zt!==null&&(Hn?(e=zt,n=n.stateNode,e.nodeType===8?pc(e.parentNode,n):e.nodeType===1&&pc(e,n),ka(e)):pc(zt,n.stateNode));break;case 4:s=zt,o=Hn,zt=n.stateNode.containerInfo,Hn=!0,Vr(e,t,n),zt=s,Hn=o;break;case 0:case 11:case 14:case 15:if(!Gt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var a=o,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&yd(n,t,l),o=o.next}while(o!==s)}Vr(e,t,n);break;case 1:if(!Gt&&(_s(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(d){jt(n,t,d)}Vr(e,t,n);break;case 21:Vr(e,t,n);break;case 22:n.mode&1?(Gt=(s=Gt)||n.memoizedState!==null,Vr(e,t,n),Gt=s):Vr(e,t,n);break;default:Vr(e,t,n)}}function Bf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new R_),t.forEach(function(s){var o=H_.bind(null,e,s);n.has(s)||(n.add(s),s.then(o,o))})}}function $n(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];try{var a=e,l=t,d=l;e:for(;d!==null;){switch(d.tag){case 5:zt=d.stateNode,Hn=!1;break e;case 3:zt=d.stateNode.containerInfo,Hn=!0;break e;case 4:zt=d.stateNode.containerInfo,Hn=!0;break e}d=d.return}if(zt===null)throw Error(pe(160));vg(a,l,o),zt=null,Hn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(f){jt(o,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)_g(t,e),t=t.sibling}function _g(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($n(t,e),ar(e),s&4){try{xa(3,e,e.return),kl(3,e)}catch(_){jt(e,e.return,_)}try{xa(5,e,e.return)}catch(_){jt(e,e.return,_)}}break;case 1:$n(t,e),ar(e),s&512&&n!==null&&_s(n,n.return);break;case 5:if($n(t,e),ar(e),s&512&&n!==null&&_s(n,n.return),e.flags&32){var o=e.stateNode;try{ja(o,"")}catch(_){jt(e,e.return,_)}}if(s&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,l=n!==null?n.memoizedProps:a,d=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{d==="input"&&a.type==="radio"&&a.name!=null&&$p(o,a),Hc(d,l);var f=Hc(d,a);for(l=0;l<u.length;l+=2){var m=u[l],g=u[l+1];m==="style"?qp(o,g):m==="dangerouslySetInnerHTML"?Zp(o,g):m==="children"?ja(o,g):Zd(o,m,g,f)}switch(d){case"input":Oc(o,a);break;case"textarea":Wp(o,a);break;case"select":var y=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var C=a.value;C!=null?js(o,!!a.multiple,C,!1):y!==!!a.multiple&&(a.defaultValue!=null?js(o,!!a.multiple,a.defaultValue,!0):js(o,!!a.multiple,a.multiple?[]:"",!1))}o[Ea]=a}catch(_){jt(e,e.return,_)}}break;case 6:if($n(t,e),ar(e),s&4){if(e.stateNode===null)throw Error(pe(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(_){jt(e,e.return,_)}}break;case 3:if($n(t,e),ar(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{ka(t.containerInfo)}catch(_){jt(e,e.return,_)}break;case 4:$n(t,e),ar(e);break;case 13:$n(t,e),ar(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(Cu=Ct())),s&4&&Bf(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(Gt=(f=Gt)||m,$n(t,e),Gt=f):$n(t,e),ar(e),s&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!m&&e.mode&1)for(ke=e,m=e.child;m!==null;){for(g=ke=m;ke!==null;){switch(y=ke,C=y.child,y.tag){case 0:case 11:case 14:case 15:xa(4,y,y.return);break;case 1:_s(y,y.return);var N=y.stateNode;if(typeof N.componentWillUnmount=="function"){s=y,n=y.return;try{t=s,N.props=t.memoizedProps,N.state=t.memoizedState,N.componentWillUnmount()}catch(_){jt(s,n,_)}}break;case 5:_s(y,y.return);break;case 22:if(y.memoizedState!==null){Af(g);continue}}C!==null?(C.return=y,ke=C):Af(g)}m=m.sibling}e:for(m=null,g=e;;){if(g.tag===5){if(m===null){m=g;try{o=g.stateNode,f?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(d=g.stateNode,u=g.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,d.style.display=Vp("display",l))}catch(_){jt(e,e.return,_)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=f?"":g.memoizedProps}catch(_){jt(e,e.return,_)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:$n(t,e),ar(e),s&4&&Bf(e);break;case 21:break;default:$n(t,e),ar(e)}}function ar(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(xg(n)){var s=n;break e}n=n.return}throw Error(pe(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ja(o,""),s.flags&=-33);var a=Tf(e);_d(e,a,o);break;case 3:case 4:var l=s.stateNode.containerInfo,d=Tf(e);vd(e,d,l);break;default:throw Error(pe(161))}}catch(u){jt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function M_(e,t,n){ke=e,wg(e)}function wg(e,t,n){for(var s=(e.mode&1)!==0;ke!==null;){var o=ke,a=o.child;if(o.tag===22&&s){var l=o.memoizedState!==null||No;if(!l){var d=o.alternate,u=d!==null&&d.memoizedState!==null||Gt;d=No;var f=Gt;if(No=l,(Gt=u)&&!f)for(ke=o;ke!==null;)l=ke,u=l.child,l.tag===22&&l.memoizedState!==null?Mf(o):u!==null?(u.return=l,ke=u):Mf(o);for(;a!==null;)ke=a,wg(a),a=a.sibling;ke=o,No=d,Gt=f}Rf(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,ke=a):Rf(e)}}function Rf(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Gt||kl(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Gt)if(n===null)s.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Wn(t.type,n.memoizedProps);s.componentDidUpdate(o,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&xf(t,a,s);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}xf(t,l,n)}break;case 5:var d=t.stateNode;if(n===null&&t.flags&4){n=d;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var m=f.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&ka(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Gt||t.flags&512&&xd(t)}catch(y){jt(t,t.return,y)}}if(t===e){ke=null;break}if(n=t.sibling,n!==null){n.return=t.return,ke=n;break}ke=t.return}}function Af(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ke=n;break}ke=t.return}}function Mf(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{kl(4,t)}catch(u){jt(t,n,u)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(u){jt(t,o,u)}}var a=t.return;try{xd(t)}catch(u){jt(t,a,u)}break;case 5:var l=t.return;try{xd(t)}catch(u){jt(t,l,u)}}}catch(u){jt(t,t.return,u)}if(t===e){ke=null;break}var d=t.sibling;if(d!==null){d.return=t.return,ke=d;break}ke=t.return}}var F_=Math.ceil,dl=Ar.ReactCurrentDispatcher,ju=Ar.ReactCurrentOwner,Bn=Ar.ReactCurrentBatchConfig,Xe=0,Ut=null,Lt=null,$t=0,xn=0,ws=hi(0),Tt=0,Fa=null,Oi=0,bl=0,Su=0,va=null,cn=null,Cu=0,Rs=1/0,Cr=null,ul=!1,wd=null,si=null,ko=!1,Qr=null,hl=0,_a=0,jd=null,Oo=-1,Do=0;function rn(){return Xe&6?Ct():Oo!==-1?Oo:Oo=Ct()}function ai(e){return e.mode&1?Xe&2&&$t!==0?$t&-$t:__.transition!==null?(Do===0&&(Do=sm()),Do):(e=ot,e!==0||(e=window.event,e=e===void 0?16:hm(e.type)),e):1}function Gn(e,t,n,s){if(50<_a)throw _a=0,jd=null,Error(pe(185));$a(e,n,s),(!(Xe&2)||e!==Ut)&&(e===Ut&&(!(Xe&2)&&(bl|=n),Tt===4&&Kr(e,$t)),fn(e,s),n===1&&Xe===0&&!(t.mode&1)&&(Rs=Ct()+500,Sl&&fi()))}function fn(e,t){var n=e.callbackNode;_v(e,t);var s=Yo(e,e===Ut?$t:0);if(s===0)n!==null&&Hh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Hh(n),t===1)e.tag===0?v_(Ff.bind(null,e)):Em(Ff.bind(null,e)),m_(function(){!(Xe&6)&&fi()}),n=null;else{switch(am(s)){case 1:n=Kd;break;case 4:n=rm;break;case 16:n=Go;break;case 536870912:n=im;break;default:n=Go}n=Lg(n,jg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function jg(e,t){if(Oo=-1,Do=0,Xe&6)throw Error(pe(327));var n=e.callbackNode;if(bs()&&e.callbackNode!==n)return null;var s=Yo(e,e===Ut?$t:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=fl(e,s);else{t=s;var o=Xe;Xe|=2;var a=Cg();(Ut!==e||$t!==t)&&(Cr=null,Rs=Ct()+500,Bi(e,t));do try{D_();break}catch(d){Sg(e,d)}while(!0);cu(),dl.current=a,Xe=o,Lt!==null?t=0:(Ut=null,$t=0,t=Tt)}if(t!==0){if(t===2&&(o=Yc(e),o!==0&&(s=o,t=Sd(e,o))),t===1)throw n=Fa,Bi(e,0),Kr(e,s),fn(e,Ct()),n;if(t===6)Kr(e,s);else{if(o=e.current.alternate,!(s&30)&&!U_(o)&&(t=fl(e,s),t===2&&(a=Yc(e),a!==0&&(s=a,t=Sd(e,a))),t===1))throw n=Fa,Bi(e,0),Kr(e,s),fn(e,Ct()),n;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(pe(345));case 2:Ii(e,cn,Cr);break;case 3:if(Kr(e,s),(s&130023424)===s&&(t=Cu+500-Ct(),10<t)){if(Yo(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){rn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=rd(Ii.bind(null,e,cn,Cr),t);break}Ii(e,cn,Cr);break;case 4:if(Kr(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var l=31-qn(s);a=1<<l,l=t[l],l>o&&(o=l),s&=~a}if(s=o,s=Ct()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*F_(s/1960))-s,10<s){e.timeoutHandle=rd(Ii.bind(null,e,cn,Cr),s);break}Ii(e,cn,Cr);break;case 5:Ii(e,cn,Cr);break;default:throw Error(pe(329))}}}return fn(e,Ct()),e.callbackNode===n?jg.bind(null,e):null}function Sd(e,t){var n=va;return e.current.memoizedState.isDehydrated&&(Bi(e,t).flags|=256),e=fl(e,t),e!==2&&(t=cn,cn=n,t!==null&&Cd(t)),e}function Cd(e){cn===null?cn=e:cn.push.apply(cn,e)}function U_(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var o=n[s],a=o.getSnapshot;o=o.value;try{if(!Yn(a(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kr(e,t){for(t&=~Su,t&=~bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qn(t),s=1<<n;e[n]=-1,t&=~s}}function Ff(e){if(Xe&6)throw Error(pe(327));bs();var t=Yo(e,0);if(!(t&1))return fn(e,Ct()),null;var n=fl(e,t);if(e.tag!==0&&n===2){var s=Yc(e);s!==0&&(t=s,n=Sd(e,s))}if(n===1)throw n=Fa,Bi(e,0),Kr(e,t),fn(e,Ct()),n;if(n===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ii(e,cn,Cr),fn(e,Ct()),null}function Nu(e,t){var n=Xe;Xe|=1;try{return e(t)}finally{Xe=n,Xe===0&&(Rs=Ct()+500,Sl&&fi())}}function Di(e){Qr!==null&&Qr.tag===0&&!(Xe&6)&&bs();var t=Xe;Xe|=1;var n=Bn.transition,s=ot;try{if(Bn.transition=null,ot=1,e)return e()}finally{ot=s,Bn.transition=n,Xe=t,!(Xe&6)&&fi()}}function ku(){xn=ws.current,ft(ws)}function Bi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,p_(n)),Lt!==null)for(n=Lt.return;n!==null;){var s=n;switch(au(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&el();break;case 3:Ts(),ft(un),ft(Jt),mu();break;case 5:pu(s);break;case 4:Ts();break;case 13:ft(xt);break;case 19:ft(xt);break;case 10:du(s.type._context);break;case 22:case 23:ku()}n=n.return}if(Ut=e,Lt=e=oi(e.current,null),$t=xn=t,Tt=0,Fa=null,Su=bl=Oi=0,cn=va=null,Pi!==null){for(t=0;t<Pi.length;t++)if(n=Pi[t],s=n.interleaved,s!==null){n.interleaved=null;var o=s.next,a=n.pending;if(a!==null){var l=a.next;a.next=o,s.next=l}n.pending=s}Pi=null}return e}function Sg(e,t){do{var n=Lt;try{if(cu(),Mo.current=cl,ll){for(var s=_t.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}ll=!1}if(Ui=0,Ft=Et=_t=null,ya=!1,Ra=0,ju.current=null,n===null||n.return===null){Tt=1,Fa=t,Lt=null;break}e:{var a=e,l=n.return,d=n,u=t;if(t=$t,d.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,m=d,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var C=Cf(l);if(C!==null){C.flags&=-257,Nf(C,l,d,a,t),C.mode&1&&Sf(a,f,t),t=C,u=f;var N=t.updateQueue;if(N===null){var _=new Set;_.add(u),t.updateQueue=_}else N.add(u);break e}else{if(!(t&1)){Sf(a,f,t),bu();break e}u=Error(pe(426))}}else if(mt&&d.mode&1){var b=Cf(l);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Nf(b,l,d,a,t),ou(Bs(u,d));break e}}a=u=Bs(u,d),Tt!==4&&(Tt=2),va===null?va=[a]:va.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=ag(a,u,t);yf(a,w);break e;case 1:d=u;var x=a.type,k=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(si===null||!si.has(k)))){a.flags|=65536,t&=-t,a.lanes|=t;var S=og(a,d,t);yf(a,S);break e}}a=a.return}while(a!==null)}kg(n)}catch(E){t=E,Lt===n&&n!==null&&(Lt=n=n.return);continue}break}while(!0)}function Cg(){var e=dl.current;return dl.current=cl,e===null?cl:e}function bu(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Ut===null||!(Oi&268435455)&&!(bl&268435455)||Kr(Ut,$t)}function fl(e,t){var n=Xe;Xe|=2;var s=Cg();(Ut!==e||$t!==t)&&(Cr=null,Bi(e,t));do try{O_();break}catch(o){Sg(e,o)}while(!0);if(cu(),Xe=n,dl.current=s,Lt!==null)throw Error(pe(261));return Ut=null,$t=0,Tt}function O_(){for(;Lt!==null;)Ng(Lt)}function D_(){for(;Lt!==null&&!uv();)Ng(Lt)}function Ng(e){var t=Ig(e.alternate,e,xn);e.memoizedProps=e.pendingProps,t===null?kg(e):Lt=t,ju.current=null}function kg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=B_(n,t),n!==null){n.flags&=32767,Lt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Tt=6,Lt=null;return}}else if(n=T_(n,t,xn),n!==null){Lt=n;return}if(t=t.sibling,t!==null){Lt=t;return}Lt=t=e}while(t!==null);Tt===0&&(Tt=5)}function Ii(e,t,n){var s=ot,o=Bn.transition;try{Bn.transition=null,ot=1,z_(e,t,n,s)}finally{Bn.transition=o,ot=s}return null}function z_(e,t,n,s){do bs();while(Qr!==null);if(Xe&6)throw Error(pe(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(wv(e,a),e===Ut&&(Lt=Ut=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ko||(ko=!0,Lg(Go,function(){return bs(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Bn.transition,Bn.transition=null;var l=ot;ot=1;var d=Xe;Xe|=4,ju.current=null,A_(e,n),_g(n,e),o_(td),Ko=!!ed,td=ed=null,e.current=n,M_(n),hv(),Xe=d,ot=l,Bn.transition=a}else e.current=n;if(ko&&(ko=!1,Qr=e,hl=o),a=e.pendingLanes,a===0&&(si=null),mv(n.stateNode),fn(e,Ct()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],s(o.value,{componentStack:o.stack,digest:o.digest});if(ul)throw ul=!1,e=wd,wd=null,e;return hl&1&&e.tag!==0&&bs(),a=e.pendingLanes,a&1?e===jd?_a++:(_a=0,jd=e):_a=0,fi(),null}function bs(){if(Qr!==null){var e=am(hl),t=Bn.transition,n=ot;try{if(Bn.transition=null,ot=16>e?16:e,Qr===null)var s=!1;else{if(e=Qr,Qr=null,hl=0,Xe&6)throw Error(pe(331));var o=Xe;for(Xe|=4,ke=e.current;ke!==null;){var a=ke,l=a.child;if(ke.flags&16){var d=a.deletions;if(d!==null){for(var u=0;u<d.length;u++){var f=d[u];for(ke=f;ke!==null;){var m=ke;switch(m.tag){case 0:case 11:case 15:xa(8,m,a)}var g=m.child;if(g!==null)g.return=m,ke=g;else for(;ke!==null;){m=ke;var y=m.sibling,C=m.return;if(yg(m),m===f){ke=null;break}if(y!==null){y.return=C,ke=y;break}ke=C}}}var N=a.alternate;if(N!==null){var _=N.child;if(_!==null){N.child=null;do{var b=_.sibling;_.sibling=null,_=b}while(_!==null)}}ke=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,ke=l;else e:for(;ke!==null;){if(a=ke,a.flags&2048)switch(a.tag){case 0:case 11:case 15:xa(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,ke=w;break e}ke=a.return}}var x=e.current;for(ke=x;ke!==null;){l=ke;var k=l.child;if(l.subtreeFlags&2064&&k!==null)k.return=l,ke=k;else e:for(l=x;ke!==null;){if(d=ke,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:kl(9,d)}}catch(E){jt(d,d.return,E)}if(d===l){ke=null;break e}var S=d.sibling;if(S!==null){S.return=d.return,ke=S;break e}ke=d.return}}if(Xe=o,fi(),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(xl,e)}catch{}s=!0}return s}finally{ot=n,Bn.transition=t}}return!1}function Uf(e,t,n){t=Bs(n,t),t=ag(e,t,1),e=ii(e,t,1),t=rn(),e!==null&&($a(e,1,t),fn(e,t))}function jt(e,t,n){if(e.tag===3)Uf(e,e,n);else for(;t!==null;){if(t.tag===3){Uf(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(si===null||!si.has(s))){e=Bs(n,e),e=og(t,e,1),t=ii(t,e,1),e=rn(),t!==null&&($a(t,1,e),fn(t,e));break}}t=t.return}}function $_(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=rn(),e.pingedLanes|=e.suspendedLanes&n,Ut===e&&($t&n)===n&&(Tt===4||Tt===3&&($t&130023424)===$t&&500>Ct()-Cu?Bi(e,0):Su|=n),fn(e,t)}function bg(e,t){t===0&&(e.mode&1?(t=go,go<<=1,!(go&130023424)&&(go=4194304)):t=1);var n=rn();e=Br(e,t),e!==null&&($a(e,t,n),fn(e,n))}function W_(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),bg(e,n)}function H_(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(pe(314))}s!==null&&s.delete(t),bg(e,n)}var Ig;Ig=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||un.current)dn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return dn=!1,E_(e,t,n);dn=!!(e.flags&131072)}else dn=!1,mt&&t.flags&1048576&&Tm(t,rl,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Uo(e,t),e=t.pendingProps;var o=Ls(t,Jt.current);ks(t,n),o=yu(null,t,s,e,o,n);var a=xu();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hn(s)?(a=!0,tl(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,hu(t),o.updater=Nl,t.stateNode=o,o._reactInternals=t,dd(t,s,e,n),t=fd(null,t,s,!0,a,n)):(t.tag=0,mt&&a&&su(t),tn(null,t,o,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=V_(s),e=Wn(s,e),o){case 0:t=hd(null,t,s,e,n);break e;case 1:t=If(null,t,s,e,n);break e;case 11:t=kf(null,t,s,e,n);break e;case 14:t=bf(null,t,s,Wn(s.type,e),n);break e}throw Error(pe(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),hd(e,t,s,o,n);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),If(e,t,s,o,n);case 3:e:{if(ug(t),e===null)throw Error(pe(387));s=t.pendingProps,a=t.memoizedState,o=a.element,Um(e,t),al(t,s,null,n);var l=t.memoizedState;if(s=l.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Bs(Error(pe(423)),t),t=Lf(e,t,s,n,o);break e}else if(s!==o){o=Bs(Error(pe(424)),t),t=Lf(e,t,s,n,o);break e}else for(vn=ri(t.stateNode.containerInfo.firstChild),_n=t,mt=!0,Zn=null,n=Mm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ps(),s===o){t=Rr(e,t,n);break e}tn(e,t,s,n)}t=t.child}return t;case 5:return Om(t),e===null&&od(t),s=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,l=o.children,nd(s,o)?l=null:a!==null&&nd(s,a)&&(t.flags|=32),dg(e,t),tn(e,t,l,n),t.child;case 6:return e===null&&od(t),null;case 13:return hg(e,t,n);case 4:return fu(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Es(t,null,s,n):tn(e,t,s,n),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),kf(e,t,s,o,n);case 7:return tn(e,t,t.pendingProps,n),t.child;case 8:return tn(e,t,t.pendingProps.children,n),t.child;case 12:return tn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,a=t.memoizedProps,l=o.value,ut(il,s._currentValue),s._currentValue=l,a!==null)if(Yn(a.value,l)){if(a.children===o.children&&!un.current){t=Rr(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var d=a.dependencies;if(d!==null){l=a.child;for(var u=d.firstContext;u!==null;){if(u.context===s){if(a.tag===1){u=Lr(-1,n&-n),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var m=f.pending;m===null?u.next=u:(u.next=m.next,m.next=u),f.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),ld(a.return,n,t),d.lanes|=n;break}u=u.next}}else if(a.tag===10)l=a.type===t.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(pe(341));l.lanes|=n,d=l.alternate,d!==null&&(d.lanes|=n),ld(l,n,t),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===t){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}tn(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,ks(t,n),o=Rn(o),s=s(o),t.flags|=1,tn(e,t,s,n),t.child;case 14:return s=t.type,o=Wn(s,t.pendingProps),o=Wn(s.type,o),bf(e,t,s,o,n);case 15:return lg(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),Uo(e,t),t.tag=1,hn(s)?(e=!0,tl(t)):e=!1,ks(t,n),sg(t,s,o),dd(t,s,o,n),fd(null,t,s,!0,e,n);case 19:return fg(e,t,n);case 22:return cg(e,t,n)}throw Error(pe(156,t.tag))};function Lg(e,t){return nm(e,t)}function Z_(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(e,t,n,s){return new Z_(e,t,n,s)}function Iu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function V_(e){if(typeof e=="function")return Iu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===qd)return 11;if(e===Gd)return 14}return 2}function oi(e,t){var n=e.alternate;return n===null?(n=Tn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zo(e,t,n,s,o,a){var l=2;if(s=e,typeof e=="function")Iu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case us:return Ri(n.children,o,a,t);case Vd:l=8,o|=8;break;case Rc:return e=Tn(12,n,t,o|2),e.elementType=Rc,e.lanes=a,e;case Ac:return e=Tn(13,n,t,o),e.elementType=Ac,e.lanes=a,e;case Mc:return e=Tn(19,n,t,o),e.elementType=Mc,e.lanes=a,e;case Op:return Il(n,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Fp:l=10;break e;case Up:l=9;break e;case qd:l=11;break e;case Gd:l=14;break e;case qr:l=16,s=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=Tn(l,n,t,o),t.elementType=e,t.type=s,t.lanes=a,t}function Ri(e,t,n,s){return e=Tn(7,e,s,t),e.lanes=n,e}function Il(e,t,n,s){return e=Tn(22,e,s,t),e.elementType=Op,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return e=Tn(6,e,null,t),e.lanes=n,e}function Sc(e,t,n){return t=Tn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function q_(e,t,n,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rc(0),this.expirationTimes=rc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rc(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Lu(e,t,n,s,o,a,l,d,u){return e=new q_(e,t,n,d,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Tn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hu(a),e}function G_(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ds,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Pg(e){if(!e)return di;e=e._reactInternals;e:{if(Wi(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var n=e.type;if(hn(n))return Pm(e,n,t)}return t}function Eg(e,t,n,s,o,a,l,d,u){return e=Lu(n,s,!0,e,o,a,l,d,u),e.context=Pg(null),n=e.current,s=rn(),o=ai(n),a=Lr(s,o),a.callback=t??null,ii(n,a,o),e.current.lanes=o,$a(e,o,s),fn(e,s),e}function Ll(e,t,n,s){var o=t.current,a=rn(),l=ai(o);return n=Pg(n),t.context===null?t.context=n:t.pendingContext=n,t=Lr(a,l),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ii(o,t,l),e!==null&&(Gn(e,o,l,a),Ao(e,o,l)),l}function pl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Of(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pu(e,t){Of(e,t),(e=e.alternate)&&Of(e,t)}function Y_(){return null}var Tg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Eu(e){this._internalRoot=e}Pl.prototype.render=Eu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));Ll(e,t,null,null)};Pl.prototype.unmount=Eu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Di(function(){Ll(null,e,null,null)}),t[Tr]=null}};function Pl(e){this._internalRoot=e}Pl.prototype.unstable_scheduleHydration=function(e){if(e){var t=cm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Yr.length&&t!==0&&t<Yr[n].priority;n++);Yr.splice(n,0,e),n===0&&um(e)}};function Tu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function El(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Df(){}function K_(e,t,n,s,o){if(o){if(typeof s=="function"){var a=s;s=function(){var f=pl(l);a.call(f)}}var l=Eg(t,s,e,0,null,!1,!1,"",Df);return e._reactRootContainer=l,e[Tr]=l.current,La(e.nodeType===8?e.parentNode:e),Di(),l}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var d=s;s=function(){var f=pl(u);d.call(f)}}var u=Lu(e,0,!1,null,null,!1,!1,"",Df);return e._reactRootContainer=u,e[Tr]=u.current,La(e.nodeType===8?e.parentNode:e),Di(function(){Ll(t,u,n,s)}),u}function Tl(e,t,n,s,o){var a=n._reactRootContainer;if(a){var l=a;if(typeof o=="function"){var d=o;o=function(){var u=pl(l);d.call(u)}}Ll(t,l,e,o)}else l=K_(n,t,e,o,s);return pl(l)}om=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=da(t.pendingLanes);n!==0&&(Jd(t,n|1),fn(t,Ct()),!(Xe&6)&&(Rs=Ct()+500,fi()))}break;case 13:Di(function(){var s=Br(e,1);if(s!==null){var o=rn();Gn(s,e,1,o)}}),Pu(e,1)}};Qd=function(e){if(e.tag===13){var t=Br(e,134217728);if(t!==null){var n=rn();Gn(t,e,134217728,n)}Pu(e,134217728)}};lm=function(e){if(e.tag===13){var t=ai(e),n=Br(e,t);if(n!==null){var s=rn();Gn(n,e,t,s)}Pu(e,t)}};cm=function(){return ot};dm=function(e,t){var n=ot;try{return ot=e,t()}finally{ot=n}};Vc=function(e,t,n){switch(t){case"input":if(Oc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var o=jl(s);if(!o)throw Error(pe(90));zp(s),Oc(s,o)}}}break;case"textarea":Wp(e,n);break;case"select":t=n.value,t!=null&&js(e,!!n.multiple,t,!1)}};Kp=Nu;Jp=Di;var J_={usingClientEntryPoint:!1,Events:[Ha,ms,jl,Gp,Yp,Nu]},sa={findFiberByHostInstance:Li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Q_={bundleType:sa.bundleType,version:sa.version,rendererPackageName:sa.rendererPackageName,rendererConfig:sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ar.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=em(e),e===null?null:e.stateNode},findFiberByHostInstance:sa.findFiberByHostInstance||Y_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{xl=bo.inject(Q_),dr=bo}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J_;jn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tu(t))throw Error(pe(200));return G_(e,t,null,n)};jn.createRoot=function(e,t){if(!Tu(e))throw Error(pe(299));var n=!1,s="",o=Tg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Lu(e,1,!1,null,null,n,!1,s,o),e[Tr]=t.current,La(e.nodeType===8?e.parentNode:e),new Eu(t)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=em(t),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return Di(e)};jn.hydrate=function(e,t,n){if(!El(t))throw Error(pe(200));return Tl(null,e,t,!0,n)};jn.hydrateRoot=function(e,t,n){if(!Tu(e))throw Error(pe(405));var s=n!=null&&n.hydratedSources||null,o=!1,a="",l=Tg;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Eg(t,null,e,1,n??null,o,!1,a,l),e[Tr]=t.current,La(e),s)for(e=0;e<s.length;e++)n=s[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Pl(t)};jn.render=function(e,t,n){if(!El(t))throw Error(pe(200));return Tl(null,e,t,!1,n)};jn.unmountComponentAtNode=function(e){if(!El(e))throw Error(pe(40));return e._reactRootContainer?(Di(function(){Tl(null,null,e,!1,function(){e._reactRootContainer=null,e[Tr]=null})}),!0):!1};jn.unstable_batchedUpdates=Nu;jn.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!El(n))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return Tl(e,t,n,!1,s)};jn.version="18.3.1-next-f1338f8080-20240426";function Bg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bg)}catch(e){console.error(e)}}Bg(),Bp.exports=jn;var Rg=Bp.exports,Ag,zf=Rg;Ag=zf.createRoot,zf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ua(){return Ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ua.apply(this,arguments)}var Xr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xr||(Xr={}));const $f="popstate";function X_(e){e===void 0&&(e={});function t(s,o){let{pathname:a,search:l,hash:d}=s.location;return Nd("",{pathname:a,search:l,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){return typeof o=="string"?o:ml(o)}return t0(t,n,null,e)}function Nt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Mg(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function e0(){return Math.random().toString(36).substr(2,8)}function Wf(e,t){return{usr:e.state,key:e.key,idx:t}}function Nd(e,t,n,s){return n===void 0&&(n=null),Ua({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Os(t):t,{state:n,key:t&&t.key||s||e0()})}function ml(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Os(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function t0(e,t,n,s){s===void 0&&(s={});let{window:o=document.defaultView,v5Compat:a=!1}=s,l=o.history,d=Xr.Pop,u=null,f=m();f==null&&(f=0,l.replaceState(Ua({},l.state,{idx:f}),""));function m(){return(l.state||{idx:null}).idx}function g(){d=Xr.Pop;let b=m(),w=b==null?null:b-f;f=b,u&&u({action:d,location:_.location,delta:w})}function y(b,w){d=Xr.Push;let x=Nd(_.location,b,w);f=m()+1;let k=Wf(x,f),S=_.createHref(x);try{l.pushState(k,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;o.location.assign(S)}a&&u&&u({action:d,location:_.location,delta:1})}function C(b,w){d=Xr.Replace;let x=Nd(_.location,b,w);f=m();let k=Wf(x,f),S=_.createHref(x);l.replaceState(k,"",S),a&&u&&u({action:d,location:_.location,delta:0})}function N(b){let w=o.location.origin!=="null"?o.location.origin:o.location.href,x=typeof b=="string"?b:ml(b);return x=x.replace(/ $/,"%20"),Nt(w,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,w)}let _={get action(){return d},get location(){return e(o,l)},listen(b){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener($f,g),u=b,()=>{o.removeEventListener($f,g),u=null}},createHref(b){return t(o,b)},createURL:N,encodeLocation(b){let w=N(b);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:y,replace:C,go(b){return l.go(b)}};return _}var Hf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Hf||(Hf={}));function n0(e,t,n){return n===void 0&&(n="/"),r0(e,t,n)}function r0(e,t,n,s){let o=typeof t=="string"?Os(t):t,a=Bu(o.pathname||"/",n);if(a==null)return null;let l=Fg(e);i0(l);let d=null;for(let u=0;d==null&&u<l.length;++u){let f=g0(a);d=f0(l[u],f)}return d}function Fg(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let o=(a,l,d)=>{let u={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};u.relativePath.startsWith("/")&&(Nt(u.relativePath.startsWith(s),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(s.length));let f=li([s,u.relativePath]),m=n.concat(u);a.children&&a.children.length>0&&(Nt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),Fg(a.children,t,m,f)),!(a.path==null&&!a.index)&&t.push({path:f,score:u0(f,a.index),routesMeta:m})};return e.forEach((a,l)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))o(a,l);else for(let u of Ug(a.path))o(a,l,u)}),t}function Ug(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return o?[a,""]:[a];let l=Ug(s.join("/")),d=[];return d.push(...l.map(u=>u===""?a:[a,u].join("/"))),o&&d.push(...l),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function i0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:h0(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const s0=/^:[\w-]+$/,a0=3,o0=2,l0=1,c0=10,d0=-2,Zf=e=>e==="*";function u0(e,t){let n=e.split("/"),s=n.length;return n.some(Zf)&&(s+=d0),t&&(s+=o0),n.filter(o=>!Zf(o)).reduce((o,a)=>o+(s0.test(a)?a0:a===""?l0:c0),s)}function h0(e,t){return e.length===t.length&&e.slice(0,-1).every((s,o)=>s===t[o])?e[e.length-1]-t[t.length-1]:0}function f0(e,t,n){let{routesMeta:s}=e,o={},a="/",l=[];for(let d=0;d<s.length;++d){let u=s[d],f=d===s.length-1,m=a==="/"?t:t.slice(a.length)||"/",g=p0({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},m),y=u.route;if(!g)return null;Object.assign(o,g.params),l.push({params:o,pathname:li([a,g.pathname]),pathnameBase:_0(li([a,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(a=li([a,g.pathnameBase]))}return l}function p0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=m0(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let a=o[0],l=a.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((f,m,g)=>{let{paramName:y,isOptional:C}=m;if(y==="*"){let _=d[g]||"";l=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const N=d[g];return C&&!N?f[y]=void 0:f[y]=(N||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:e}}function m0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Mg(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,u)=>(s.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),s]}function g0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Mg(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Bu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function y0(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:o=""}=typeof e=="string"?Os(e):e;return{pathname:n?n.startsWith("/")?n:x0(n,t):t,search:w0(s),hash:j0(o)}}function x0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Cc(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function v0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Ru(e,t){let n=v0(e);return t?n.map((s,o)=>o===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Au(e,t,n,s){s===void 0&&(s=!1);let o;typeof e=="string"?o=Os(e):(o=Ua({},e),Nt(!o.pathname||!o.pathname.includes("?"),Cc("?","pathname","search",o)),Nt(!o.pathname||!o.pathname.includes("#"),Cc("#","pathname","hash",o)),Nt(!o.search||!o.search.includes("#"),Cc("#","search","hash",o)));let a=e===""||o.pathname==="",l=a?"/":o.pathname,d;if(l==null)d=n;else{let g=t.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),g-=1;o.pathname=y.join("/")}d=g>=0?t[g]:"/"}let u=y0(o,d),f=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(f||m)&&(u.pathname+="/"),u}const li=e=>e.join("/").replace(/\/\/+/g,"/"),_0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),w0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,j0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function S0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Og=["post","put","patch","delete"];new Set(Og);const C0=["get",...Og];new Set(C0);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oa(){return Oa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Oa.apply(this,arguments)}const Mu=v.createContext(null),N0=v.createContext(null),pi=v.createContext(null),Bl=v.createContext(null),Mr=v.createContext({outlet:null,matches:[],isDataRoute:!1}),Dg=v.createContext(null);function k0(e,t){let{relative:n}=t===void 0?{}:t;Ds()||Nt(!1);let{basename:s,navigator:o}=v.useContext(pi),{hash:a,pathname:l,search:d}=Wg(e,{relative:n}),u=l;return s!=="/"&&(u=l==="/"?s:li([s,l])),o.createHref({pathname:u,search:d,hash:a})}function Ds(){return v.useContext(Bl)!=null}function mi(){return Ds()||Nt(!1),v.useContext(Bl).location}function zg(e){v.useContext(pi).static||v.useLayoutEffect(e)}function on(){let{isDataRoute:e}=v.useContext(Mr);return e?O0():b0()}function b0(){Ds()||Nt(!1);let e=v.useContext(Mu),{basename:t,future:n,navigator:s}=v.useContext(pi),{matches:o}=v.useContext(Mr),{pathname:a}=mi(),l=JSON.stringify(Ru(o,n.v7_relativeSplatPath)),d=v.useRef(!1);return zg(()=>{d.current=!0}),v.useCallback(function(f,m){if(m===void 0&&(m={}),!d.current)return;if(typeof f=="number"){s.go(f);return}let g=Au(f,JSON.parse(l),a,m.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:li([t,g.pathname])),(m.replace?s.replace:s.push)(g,m.state,m)},[t,s,l,a,e])}function $g(){let{matches:e}=v.useContext(Mr),t=e[e.length-1];return t?t.params:{}}function Wg(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=v.useContext(pi),{matches:o}=v.useContext(Mr),{pathname:a}=mi(),l=JSON.stringify(Ru(o,s.v7_relativeSplatPath));return v.useMemo(()=>Au(e,JSON.parse(l),a,n==="path"),[e,l,a,n])}function I0(e,t){return L0(e,t)}function L0(e,t,n,s){Ds()||Nt(!1);let{navigator:o}=v.useContext(pi),{matches:a}=v.useContext(Mr),l=a[a.length-1],d=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let f=mi(),m;if(t){var g;let b=typeof t=="string"?Os(t):t;u==="/"||(g=b.pathname)!=null&&g.startsWith(u)||Nt(!1),m=b}else m=f;let y=m.pathname||"/",C=y;if(u!=="/"){let b=u.replace(/^\//,"").split("/");C="/"+y.replace(/^\//,"").split("/").slice(b.length).join("/")}let N=n0(e,{pathname:C}),_=R0(N&&N.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:li([u,o.encodeLocation?o.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:li([u,o.encodeLocation?o.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,n,s);return t&&_?v.createElement(Bl.Provider,{value:{location:Oa({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Xr.Pop}},_):_}function P0(){let e=U0(),t=S0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),n?v.createElement("pre",{style:o},n):null,null)}const E0=v.createElement(P0,null);class T0 extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?v.createElement(Mr.Provider,{value:this.props.routeContext},v.createElement(Dg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function B0(e){let{routeContext:t,match:n,children:s}=e,o=v.useContext(Mu);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(Mr.Provider,{value:t},s)}function R0(e,t,n,s){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=s)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,d=(o=n)==null?void 0:o.errors;if(d!=null){let m=l.findIndex(g=>g.route.id&&(d==null?void 0:d[g.route.id])!==void 0);m>=0||Nt(!1),l=l.slice(0,Math.min(l.length,m+1))}let u=!1,f=-1;if(n&&s&&s.v7_partialHydration)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:y,errors:C}=n,N=g.route.loader&&y[g.route.id]===void 0&&(!C||C[g.route.id]===void 0);if(g.route.lazy||N){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((m,g,y)=>{let C,N=!1,_=null,b=null;n&&(C=d&&g.route.id?d[g.route.id]:void 0,_=g.route.errorElement||E0,u&&(f<0&&y===0?(D0("route-fallback"),N=!0,b=null):f===y&&(N=!0,b=g.route.hydrateFallbackElement||null)));let w=t.concat(l.slice(0,y+1)),x=()=>{let k;return C?k=_:N?k=b:g.route.Component?k=v.createElement(g.route.Component,null):g.route.element?k=g.route.element:k=m,v.createElement(B0,{match:g,routeContext:{outlet:m,matches:w,isDataRoute:n!=null},children:k})};return n&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?v.createElement(T0,{location:n.location,revalidation:n.revalidation,component:_,error:C,children:x(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):x()},null)}var Hg=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Hg||{}),Zg=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Zg||{});function A0(e){let t=v.useContext(Mu);return t||Nt(!1),t}function M0(e){let t=v.useContext(N0);return t||Nt(!1),t}function F0(e){let t=v.useContext(Mr);return t||Nt(!1),t}function Vg(e){let t=F0(),n=t.matches[t.matches.length-1];return n.route.id||Nt(!1),n.route.id}function U0(){var e;let t=v.useContext(Dg),n=M0(),s=Vg();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function O0(){let{router:e}=A0(Hg.UseNavigateStable),t=Vg(Zg.UseNavigateStable),n=v.useRef(!1);return zg(()=>{n.current=!0}),v.useCallback(function(o,a){a===void 0&&(a={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,Oa({fromRouteId:t},a)))},[e,t])}const Vf={};function D0(e,t,n){Vf[e]||(Vf[e]=!0)}function z0(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Nc(e){let{to:t,replace:n,state:s,relative:o}=e;Ds()||Nt(!1);let{future:a,static:l}=v.useContext(pi),{matches:d}=v.useContext(Mr),{pathname:u}=mi(),f=on(),m=Au(t,Ru(d,a.v7_relativeSplatPath),u,o==="path"),g=JSON.stringify(m);return v.useEffect(()=>f(JSON.parse(g),{replace:n,state:s,relative:o}),[f,g,o,n,s]),null}function Mt(e){Nt(!1)}function $0(e){let{basename:t="/",children:n=null,location:s,navigationType:o=Xr.Pop,navigator:a,static:l=!1,future:d}=e;Ds()&&Nt(!1);let u=t.replace(/^\/*/,"/"),f=v.useMemo(()=>({basename:u,navigator:a,static:l,future:Oa({v7_relativeSplatPath:!1},d)}),[u,d,a,l]);typeof s=="string"&&(s=Os(s));let{pathname:m="/",search:g="",hash:y="",state:C=null,key:N="default"}=s,_=v.useMemo(()=>{let b=Bu(m,u);return b==null?null:{location:{pathname:b,search:g,hash:y,state:C,key:N},navigationType:o}},[u,m,g,y,C,N,o]);return _==null?null:v.createElement(pi.Provider,{value:f},v.createElement(Bl.Provider,{children:n,value:_}))}function W0(e){let{children:t,location:n}=e;return I0(kd(t),n)}new Promise(()=>{});function kd(e,t){t===void 0&&(t=[]);let n=[];return v.Children.forEach(e,(s,o)=>{if(!v.isValidElement(s))return;let a=[...t,o];if(s.type===v.Fragment){n.push.apply(n,kd(s.props.children,a));return}s.type!==Mt&&Nt(!1),!s.props.index||!s.props.children||Nt(!1);let l={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=kd(s.props.children,a)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bd(){return bd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},bd.apply(this,arguments)}function H0(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,a;for(a=0;a<s.length;a++)o=s[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function Z0(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function V0(e,t){return e.button===0&&(!t||t==="_self")&&!Z0(e)}function Id(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(o=>[n,o]):[[n,s]])},[]))}function q0(e,t){let n=Id(e);return t&&t.forEach((s,o)=>{n.has(o)||t.getAll(o).forEach(a=>{n.append(o,a)})}),n}const G0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Y0="6";try{window.__reactRouterVersion=Y0}catch{}const K0="startTransition",qf=$x[K0];function J0(e){let{basename:t,children:n,future:s,window:o}=e,a=v.useRef();a.current==null&&(a.current=X_({window:o,v5Compat:!0}));let l=a.current,[d,u]=v.useState({action:l.action,location:l.location}),{v7_startTransition:f}=s||{},m=v.useCallback(g=>{f&&qf?qf(()=>u(g)):u(g)},[u,f]);return v.useLayoutEffect(()=>l.listen(m),[l,m]),v.useEffect(()=>z0(s),[s]),v.createElement($0,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:l,future:s})}const Q0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",X0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kc=v.forwardRef(function(t,n){let{onClick:s,relative:o,reloadDocument:a,replace:l,state:d,target:u,to:f,preventScrollReset:m,viewTransition:g}=t,y=H0(t,G0),{basename:C}=v.useContext(pi),N,_=!1;if(typeof f=="string"&&X0.test(f)&&(N=f,Q0))try{let k=new URL(window.location.href),S=f.startsWith("//")?new URL(k.protocol+f):new URL(f),E=Bu(S.pathname,C);S.origin===k.origin&&E!=null?f=E+S.search+S.hash:_=!0}catch{}let b=k0(f,{relative:o}),w=ew(f,{replace:l,state:d,target:u,preventScrollReset:m,relative:o,viewTransition:g});function x(k){s&&s(k),k.defaultPrevented||w(k)}return v.createElement("a",bd({},y,{href:N||b,onClick:_||a?s:x,ref:n,target:u}))});var Gf;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Gf||(Gf={}));var Yf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Yf||(Yf={}));function ew(e,t){let{target:n,replace:s,state:o,preventScrollReset:a,relative:l,viewTransition:d}=t===void 0?{}:t,u=on(),f=mi(),m=Wg(e,{relative:l});return v.useCallback(g=>{if(V0(g,n)){g.preventDefault();let y=s!==void 0?s:ml(f)===ml(m);u(e,{replace:y,state:o,preventScrollReset:a,relative:l,viewTransition:d})}},[f,u,m,s,o,n,e,a,l,d])}function qg(e){let t=v.useRef(Id(e)),n=v.useRef(!1),s=mi(),o=v.useMemo(()=>q0(s.search,n.current?null:t.current),[s.search]),a=on(),l=v.useCallback((d,u)=>{const f=Id(typeof d=="function"?d(o):d);n.current=!0,a("?"+f,u)},[a,o]);return[o,l]}function Gg(e,t){return function(){return e.apply(t,arguments)}}const{toString:tw}=Object.prototype,{getPrototypeOf:Fu}=Object,{iterator:Rl,toStringTag:Yg}=Symbol,Al=(e=>t=>{const n=tw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Kn=e=>(e=e.toLowerCase(),t=>Al(t)===e),Ml=e=>t=>typeof t===e,{isArray:zs}=Array,As=Ml("undefined");function Va(e){return e!==null&&!As(e)&&e.constructor!==null&&!As(e.constructor)&&pn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Kg=Kn("ArrayBuffer");function nw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Kg(e.buffer),t}const rw=Ml("string"),pn=Ml("function"),Jg=Ml("number"),qa=e=>e!==null&&typeof e=="object",iw=e=>e===!0||e===!1,$o=e=>{if(Al(e)!=="object")return!1;const t=Fu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Yg in e)&&!(Rl in e)},sw=e=>{if(!qa(e)||Va(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},aw=Kn("Date"),ow=Kn("File"),lw=Kn("Blob"),cw=Kn("FileList"),dw=e=>qa(e)&&pn(e.pipe),uw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||pn(e.append)&&((t=Al(e))==="formdata"||t==="object"&&pn(e.toString)&&e.toString()==="[object FormData]"))},hw=Kn("URLSearchParams"),[fw,pw,mw,gw]=["ReadableStream","Request","Response","Headers"].map(Kn),yw=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ga(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,o;if(typeof e!="object"&&(e=[e]),zs(e))for(s=0,o=e.length;s<o;s++)t.call(null,e[s],s,e);else{if(Va(e))return;const a=n?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let d;for(s=0;s<l;s++)d=a[s],t.call(null,e[d],d,e)}}function Qg(e,t){if(Va(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,o;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Ti=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Xg=e=>!As(e)&&e!==Ti;function Ld(){const{caseless:e,skipUndefined:t}=Xg(this)&&this||{},n={},s=(o,a)=>{const l=e&&Qg(n,a)||a;$o(n[l])&&$o(o)?n[l]=Ld(n[l],o):$o(o)?n[l]=Ld({},o):zs(o)?n[l]=o.slice():(!t||!As(o))&&(n[l]=o)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&Ga(arguments[o],s);return n}const xw=(e,t,n,{allOwnKeys:s}={})=>(Ga(t,(o,a)=>{n&&pn(o)?e[a]=Gg(o,n):e[a]=o},{allOwnKeys:s}),e),vw=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),_w=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},ww=(e,t,n,s)=>{let o,a,l;const d={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)l=o[a],(!s||s(l,e,t))&&!d[l]&&(t[l]=e[l],d[l]=!0);e=n!==!1&&Fu(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},jw=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},Sw=e=>{if(!e)return null;if(zs(e))return e;let t=e.length;if(!Jg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Cw=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Fu(Uint8Array)),Nw=(e,t)=>{const s=(e&&e[Rl]).call(e);let o;for(;(o=s.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},kw=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},bw=Kn("HTMLFormElement"),Iw=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),Kf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Lw=Kn("RegExp"),ey=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Ga(n,(o,a)=>{let l;(l=t(o,a,e))!==!1&&(s[a]=l||o)}),Object.defineProperties(e,s)},Pw=e=>{ey(e,(t,n)=>{if(pn(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(pn(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ew=(e,t)=>{const n={},s=o=>{o.forEach(a=>{n[a]=!0})};return zs(e)?s(e):s(String(e).split(t)),n},Tw=()=>{},Bw=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Rw(e){return!!(e&&pn(e.append)&&e[Yg]==="FormData"&&e[Rl])}const Aw=e=>{const t=new Array(10),n=(s,o)=>{if(qa(s)){if(t.indexOf(s)>=0)return;if(Va(s))return s;if(!("toJSON"in s)){t[o]=s;const a=zs(s)?[]:{};return Ga(s,(l,d)=>{const u=n(l,o+1);!As(u)&&(a[d]=u)}),t[o]=void 0,a}}return s};return n(e,0)},Mw=Kn("AsyncFunction"),Fw=e=>e&&(qa(e)||pn(e))&&pn(e.then)&&pn(e.catch),ty=((e,t)=>e?setImmediate:t?((n,s)=>(Ti.addEventListener("message",({source:o,data:a})=>{o===Ti&&a===n&&s.length&&s.shift()()},!1),o=>{s.push(o),Ti.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",pn(Ti.postMessage)),Uw=typeof queueMicrotask<"u"?queueMicrotask.bind(Ti):typeof process<"u"&&process.nextTick||ty,Ow=e=>e!=null&&pn(e[Rl]),J={isArray:zs,isArrayBuffer:Kg,isBuffer:Va,isFormData:uw,isArrayBufferView:nw,isString:rw,isNumber:Jg,isBoolean:iw,isObject:qa,isPlainObject:$o,isEmptyObject:sw,isReadableStream:fw,isRequest:pw,isResponse:mw,isHeaders:gw,isUndefined:As,isDate:aw,isFile:ow,isBlob:lw,isRegExp:Lw,isFunction:pn,isStream:dw,isURLSearchParams:hw,isTypedArray:Cw,isFileList:cw,forEach:Ga,merge:Ld,extend:xw,trim:yw,stripBOM:vw,inherits:_w,toFlatObject:ww,kindOf:Al,kindOfTest:Kn,endsWith:jw,toArray:Sw,forEachEntry:Nw,matchAll:kw,isHTMLForm:bw,hasOwnProperty:Kf,hasOwnProp:Kf,reduceDescriptors:ey,freezeMethods:Pw,toObjectSet:Ew,toCamelCase:Iw,noop:Tw,toFiniteNumber:Bw,findKey:Qg,global:Ti,isContextDefined:Xg,isSpecCompliantForm:Rw,toJSONObject:Aw,isAsyncFn:Mw,isThenable:Fw,setImmediate:ty,asap:Uw,isIterable:Ow};function We(e,t,n,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}J.inherits(We,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const ny=We.prototype,ry={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ry[e]={value:e}});Object.defineProperties(We,ry);Object.defineProperty(ny,"isAxiosError",{value:!0});We.from=(e,t,n,s,o,a)=>{const l=Object.create(ny);J.toFlatObject(e,l,function(m){return m!==Error.prototype},f=>f!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=t==null&&e?e.code:t;return We.call(l,d,u,n,s,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const Dw=null;function Pd(e){return J.isPlainObject(e)||J.isArray(e)}function iy(e){return J.endsWith(e,"[]")?e.slice(0,-2):e}function Jf(e,t,n){return e?e.concat(t).map(function(o,a){return o=iy(o),!n&&a?"["+o+"]":o}).join(n?".":""):t}function zw(e){return J.isArray(e)&&!e.some(Pd)}const $w=J.toFlatObject(J,{},null,function(t){return/^is[A-Z]/.test(t)});function Fl(e,t,n){if(!J.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=J.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,b){return!J.isUndefined(b[_])});const s=n.metaTokens,o=n.visitor||m,a=n.dots,l=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(t);if(!J.isFunction(o))throw new TypeError("visitor must be a function");function f(N){if(N===null)return"";if(J.isDate(N))return N.toISOString();if(J.isBoolean(N))return N.toString();if(!u&&J.isBlob(N))throw new We("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(N)||J.isTypedArray(N)?u&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function m(N,_,b){let w=N;if(N&&!b&&typeof N=="object"){if(J.endsWith(_,"{}"))_=s?_:_.slice(0,-2),N=JSON.stringify(N);else if(J.isArray(N)&&zw(N)||(J.isFileList(N)||J.endsWith(_,"[]"))&&(w=J.toArray(N)))return _=iy(_),w.forEach(function(k,S){!(J.isUndefined(k)||k===null)&&t.append(l===!0?Jf([_],S,a):l===null?_:_+"[]",f(k))}),!1}return Pd(N)?!0:(t.append(Jf(b,_,a),f(N)),!1)}const g=[],y=Object.assign($w,{defaultVisitor:m,convertValue:f,isVisitable:Pd});function C(N,_){if(!J.isUndefined(N)){if(g.indexOf(N)!==-1)throw Error("Circular reference detected in "+_.join("."));g.push(N),J.forEach(N,function(w,x){(!(J.isUndefined(w)||w===null)&&o.call(t,w,J.isString(x)?x.trim():x,_,y))===!0&&C(w,_?_.concat(x):[x])}),g.pop()}}if(!J.isObject(e))throw new TypeError("data must be an object");return C(e),t}function Qf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Uu(e,t){this._pairs=[],e&&Fl(e,this,t)}const sy=Uu.prototype;sy.append=function(t,n){this._pairs.push([t,n])};sy.toString=function(t){const n=t?function(s){return t.call(this,s,Qf)}:Qf;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function Ww(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ay(e,t,n){if(!t)return e;const s=n&&n.encode||Ww;J.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(t,n):a=J.isURLSearchParams(t)?t.toString():new Uu(t,n).toString(s),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Xf{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){J.forEach(this.handlers,function(s){s!==null&&t(s)})}}const oy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Hw=typeof URLSearchParams<"u"?URLSearchParams:Uu,Zw=typeof FormData<"u"?FormData:null,Vw=typeof Blob<"u"?Blob:null,qw={isBrowser:!0,classes:{URLSearchParams:Hw,FormData:Zw,Blob:Vw},protocols:["http","https","file","blob","url","data"]},Ou=typeof window<"u"&&typeof document<"u",Ed=typeof navigator=="object"&&navigator||void 0,Gw=Ou&&(!Ed||["ReactNative","NativeScript","NS"].indexOf(Ed.product)<0),Yw=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Kw=Ou&&window.location.href||"http://localhost",Jw=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ou,hasStandardBrowserEnv:Gw,hasStandardBrowserWebWorkerEnv:Yw,navigator:Ed,origin:Kw},Symbol.toStringTag,{value:"Module"})),Yt={...Jw,...qw};function Qw(e,t){return Fl(e,new Yt.classes.URLSearchParams,{visitor:function(n,s,o,a){return Yt.isNode&&J.isBuffer(n)?(this.append(s,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function Xw(e){return J.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ej(e){const t={},n=Object.keys(e);let s;const o=n.length;let a;for(s=0;s<o;s++)a=n[s],t[a]=e[a];return t}function ly(e){function t(n,s,o,a){let l=n[a++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),u=a>=n.length;return l=!l&&J.isArray(o)?o.length:l,u?(J.hasOwnProp(o,l)?o[l]=[o[l],s]:o[l]=s,!d):((!o[l]||!J.isObject(o[l]))&&(o[l]=[]),t(n,s,o[l],a)&&J.isArray(o[l])&&(o[l]=ej(o[l])),!d)}if(J.isFormData(e)&&J.isFunction(e.entries)){const n={};return J.forEachEntry(e,(s,o)=>{t(Xw(s),o,n,0)}),n}return null}function tj(e,t,n){if(J.isString(e))try{return(t||JSON.parse)(e),J.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const Ya={transitional:oy,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,a=J.isObject(t);if(a&&J.isHTMLForm(t)&&(t=new FormData(t)),J.isFormData(t))return o?JSON.stringify(ly(t)):t;if(J.isArrayBuffer(t)||J.isBuffer(t)||J.isStream(t)||J.isFile(t)||J.isBlob(t)||J.isReadableStream(t))return t;if(J.isArrayBufferView(t))return t.buffer;if(J.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Qw(t,this.formSerializer).toString();if((d=J.isFileList(t))||s.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Fl(d?{"files[]":t}:t,u&&new u,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),tj(t)):t}],transformResponse:[function(t){const n=this.transitional||Ya.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(J.isResponse(t)||J.isReadableStream(t))return t;if(t&&J.isString(t)&&(s&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(d){if(l)throw d.name==="SyntaxError"?We.from(d,We.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Yt.classes.FormData,Blob:Yt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],e=>{Ya.headers[e]={}});const nj=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),rj=e=>{const t={};let n,s,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),s=l.substring(o+1).trim(),!(!n||t[n]&&nj[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},ep=Symbol("internals");function aa(e){return e&&String(e).trim().toLowerCase()}function Wo(e){return e===!1||e==null?e:J.isArray(e)?e.map(Wo):String(e)}function ij(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const sj=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function bc(e,t,n,s,o){if(J.isFunction(s))return s.call(this,t,n);if(o&&(t=n),!!J.isString(t)){if(J.isString(s))return t.indexOf(s)!==-1;if(J.isRegExp(s))return s.test(t)}}function aj(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function oj(e,t){const n=J.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(o,a,l){return this[s].call(this,t,o,a,l)},configurable:!0})})}let mn=class{constructor(t){t&&this.set(t)}set(t,n,s){const o=this;function a(d,u,f){const m=aa(u);if(!m)throw new Error("header name must be a non-empty string");const g=J.findKey(o,m);(!g||o[g]===void 0||f===!0||f===void 0&&o[g]!==!1)&&(o[g||u]=Wo(d))}const l=(d,u)=>J.forEach(d,(f,m)=>a(f,m,u));if(J.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(J.isString(t)&&(t=t.trim())&&!sj(t))l(rj(t),n);else if(J.isObject(t)&&J.isIterable(t)){let d={},u,f;for(const m of t){if(!J.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[f=m[0]]=(u=d[f])?J.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}l(d,n)}else t!=null&&a(n,t,s);return this}get(t,n){if(t=aa(t),t){const s=J.findKey(this,t);if(s){const o=this[s];if(!n)return o;if(n===!0)return ij(o);if(J.isFunction(n))return n.call(this,o,s);if(J.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=aa(t),t){const s=J.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||bc(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let o=!1;function a(l){if(l=aa(l),l){const d=J.findKey(s,l);d&&(!n||bc(s,s[d],d,n))&&(delete s[d],o=!0)}}return J.isArray(t)?t.forEach(a):a(t),o}clear(t){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const a=n[s];(!t||bc(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const n=this,s={};return J.forEach(this,(o,a)=>{const l=J.findKey(s,a);if(l){n[l]=Wo(o),delete n[a];return}const d=t?aj(a):String(a).trim();d!==a&&delete n[a],n[d]=Wo(o),s[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return J.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=t&&J.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(o=>s.set(o)),s}static accessor(t){const s=(this[ep]=this[ep]={accessors:{}}).accessors,o=this.prototype;function a(l){const d=aa(l);s[d]||(oj(o,l),s[d]=!0)}return J.isArray(t)?t.forEach(a):a(t),this}};mn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(mn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});J.freezeMethods(mn);function Ic(e,t){const n=this||Ya,s=t||n,o=mn.from(s.headers);let a=s.data;return J.forEach(e,function(d){a=d.call(n,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function cy(e){return!!(e&&e.__CANCEL__)}function $s(e,t,n){We.call(this,e??"canceled",We.ERR_CANCELED,t,n),this.name="CanceledError"}J.inherits($s,We,{__CANCEL__:!0});function dy(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new We("Request failed with status code "+n.status,[We.ERR_BAD_REQUEST,We.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function lj(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function cj(e,t){e=e||10;const n=new Array(e),s=new Array(e);let o=0,a=0,l;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),m=s[a];l||(l=f),n[o]=u,s[o]=f;let g=a,y=0;for(;g!==o;)y+=n[g++],g=g%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),f-l<t)return;const C=m&&f-m;return C?Math.round(y*1e3/C):void 0}}function dj(e,t){let n=0,s=1e3/t,o,a;const l=(f,m=Date.now())=>{n=m,o=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const m=Date.now(),g=m-n;g>=s?l(f,m):(o=f,a||(a=setTimeout(()=>{a=null,l(o)},s-g)))},()=>o&&l(o)]}const gl=(e,t,n=3)=>{let s=0;const o=cj(50,250);return dj(a=>{const l=a.loaded,d=a.lengthComputable?a.total:void 0,u=l-s,f=o(u),m=l<=d;s=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:u,rate:f||void 0,estimated:f&&d&&m?(d-l)/f:void 0,event:a,lengthComputable:d!=null,[t?"download":"upload"]:!0};e(g)},n)},tp=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},np=e=>(...t)=>J.asap(()=>e(...t)),uj=Yt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Yt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Yt.origin),Yt.navigator&&/(msie|trident)/i.test(Yt.navigator.userAgent)):()=>!0,hj=Yt.hasStandardBrowserEnv?{write(e,t,n,s,o,a){const l=[e+"="+encodeURIComponent(t)];J.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),J.isString(s)&&l.push("path="+s),J.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function fj(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function pj(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function uy(e,t,n){let s=!fj(t);return e&&(s||n==!1)?pj(e,t):t}const rp=e=>e instanceof mn?{...e}:e;function zi(e,t){t=t||{};const n={};function s(f,m,g,y){return J.isPlainObject(f)&&J.isPlainObject(m)?J.merge.call({caseless:y},f,m):J.isPlainObject(m)?J.merge({},m):J.isArray(m)?m.slice():m}function o(f,m,g,y){if(J.isUndefined(m)){if(!J.isUndefined(f))return s(void 0,f,g,y)}else return s(f,m,g,y)}function a(f,m){if(!J.isUndefined(m))return s(void 0,m)}function l(f,m){if(J.isUndefined(m)){if(!J.isUndefined(f))return s(void 0,f)}else return s(void 0,m)}function d(f,m,g){if(g in t)return s(f,m);if(g in e)return s(void 0,f)}const u={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(f,m,g)=>o(rp(f),rp(m),g,!0)};return J.forEach(Object.keys({...e,...t}),function(m){const g=u[m]||o,y=g(e[m],t[m],m);J.isUndefined(y)&&g!==d||(n[m]=y)}),n}const hy=e=>{const t=zi({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:a,headers:l,auth:d}=t;if(t.headers=l=mn.from(l),t.url=ay(uy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),J.isFormData(n)){if(Yt.hasStandardBrowserEnv||Yt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(J.isFunction(n.getHeaders)){const u=n.getHeaders(),f=["content-type","content-length"];Object.entries(u).forEach(([m,g])=>{f.includes(m.toLowerCase())&&l.set(m,g)})}}if(Yt.hasStandardBrowserEnv&&(s&&J.isFunction(s)&&(s=s(t)),s||s!==!1&&uj(t.url))){const u=o&&a&&hj.read(a);u&&l.set(o,u)}return t},mj=typeof XMLHttpRequest<"u",gj=mj&&function(e){return new Promise(function(n,s){const o=hy(e);let a=o.data;const l=mn.from(o.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:f}=o,m,g,y,C,N;function _(){C&&C(),N&&N(),o.cancelToken&&o.cancelToken.unsubscribe(m),o.signal&&o.signal.removeEventListener("abort",m)}let b=new XMLHttpRequest;b.open(o.method.toUpperCase(),o.url,!0),b.timeout=o.timeout;function w(){if(!b)return;const k=mn.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),E={data:!d||d==="text"||d==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:k,config:e,request:b};dy(function(R){n(R),_()},function(R){s(R),_()},E),b=null}"onloadend"in b?b.onloadend=w:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(w)},b.onabort=function(){b&&(s(new We("Request aborted",We.ECONNABORTED,e,b)),b=null)},b.onerror=function(S){const E=S&&S.message?S.message:"Network Error",P=new We(E,We.ERR_NETWORK,e,b);P.event=S||null,s(P),b=null},b.ontimeout=function(){let S=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const E=o.transitional||oy;o.timeoutErrorMessage&&(S=o.timeoutErrorMessage),s(new We(S,E.clarifyTimeoutError?We.ETIMEDOUT:We.ECONNABORTED,e,b)),b=null},a===void 0&&l.setContentType(null),"setRequestHeader"in b&&J.forEach(l.toJSON(),function(S,E){b.setRequestHeader(E,S)}),J.isUndefined(o.withCredentials)||(b.withCredentials=!!o.withCredentials),d&&d!=="json"&&(b.responseType=o.responseType),f&&([y,N]=gl(f,!0),b.addEventListener("progress",y)),u&&b.upload&&([g,C]=gl(u),b.upload.addEventListener("progress",g),b.upload.addEventListener("loadend",C)),(o.cancelToken||o.signal)&&(m=k=>{b&&(s(!k||k.type?new $s(null,e,b):k),b.abort(),b=null)},o.cancelToken&&o.cancelToken.subscribe(m),o.signal&&(o.signal.aborted?m():o.signal.addEventListener("abort",m)));const x=lj(o.url);if(x&&Yt.protocols.indexOf(x)===-1){s(new We("Unsupported protocol "+x+":",We.ERR_BAD_REQUEST,e));return}b.send(a||null)})},yj=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,o;const a=function(f){if(!o){o=!0,d();const m=f instanceof Error?f:this.reason;s.abort(m instanceof We?m:new $s(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,a(new We(`timeout ${t} of ms exceeded`,We.ETIMEDOUT))},t);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:u}=s;return u.unsubscribe=()=>J.asap(d),u}},xj=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,o;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},vj=async function*(e,t){for await(const n of _j(e))yield*xj(n,t)},_j=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},ip=(e,t,n,s)=>{const o=vj(e,t);let a=0,l,d=u=>{l||(l=!0,s&&s(u))};return new ReadableStream({async pull(u){try{const{done:f,value:m}=await o.next();if(f){d(),u.close();return}let g=m.byteLength;if(n){let y=a+=g;n(y)}u.enqueue(new Uint8Array(m))}catch(f){throw d(f),f}},cancel(u){return d(u),o.return()}},{highWaterMark:2})},sp=64*1024,{isFunction:Io}=J,wj=(({Request:e,Response:t})=>({Request:e,Response:t}))(J.global),{ReadableStream:ap,TextEncoder:op}=J.global,lp=(e,...t)=>{try{return!!e(...t)}catch{return!1}},jj=e=>{e=J.merge.call({skipUndefined:!0},wj,e);const{fetch:t,Request:n,Response:s}=e,o=t?Io(t):typeof fetch=="function",a=Io(n),l=Io(s);if(!o)return!1;const d=o&&Io(ap),u=o&&(typeof op=="function"?(N=>_=>N.encode(_))(new op):async N=>new Uint8Array(await new n(N).arrayBuffer())),f=a&&d&&lp(()=>{let N=!1;const _=new n(Yt.origin,{body:new ap,method:"POST",get duplex(){return N=!0,"half"}}).headers.has("Content-Type");return N&&!_}),m=l&&d&&lp(()=>J.isReadableStream(new s("").body)),g={stream:m&&(N=>N.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(N=>{!g[N]&&(g[N]=(_,b)=>{let w=_&&_[N];if(w)return w.call(_);throw new We(`Response type '${N}' is not supported`,We.ERR_NOT_SUPPORT,b)})});const y=async N=>{if(N==null)return 0;if(J.isBlob(N))return N.size;if(J.isSpecCompliantForm(N))return(await new n(Yt.origin,{method:"POST",body:N}).arrayBuffer()).byteLength;if(J.isArrayBufferView(N)||J.isArrayBuffer(N))return N.byteLength;if(J.isURLSearchParams(N)&&(N=N+""),J.isString(N))return(await u(N)).byteLength},C=async(N,_)=>{const b=J.toFiniteNumber(N.getContentLength());return b??y(_)};return async N=>{let{url:_,method:b,data:w,signal:x,cancelToken:k,timeout:S,onDownloadProgress:E,onUploadProgress:P,responseType:R,headers:B,withCredentials:A="same-origin",fetchOptions:I}=hy(N),M=t||fetch;R=R?(R+"").toLowerCase():"text";let W=yj([x,k&&k.toAbortSignal()],S),V=null;const $=W&&W.unsubscribe&&(()=>{W.unsubscribe()});let Q;try{if(P&&f&&b!=="get"&&b!=="head"&&(Q=await C(B,w))!==0){let xe=new n(_,{method:"POST",body:w,duplex:"half"}),ve;if(J.isFormData(w)&&(ve=xe.headers.get("content-type"))&&B.setContentType(ve),xe.body){const[oe,D]=tp(Q,gl(np(P)));w=ip(xe.body,sp,oe,D)}}J.isString(A)||(A=A?"include":"omit");const ie=a&&"credentials"in n.prototype,U={...I,signal:W,method:b.toUpperCase(),headers:B.normalize().toJSON(),body:w,duplex:"half",credentials:ie?A:void 0};V=a&&new n(_,U);let H=await(a?M(V,I):M(_,U));const he=m&&(R==="stream"||R==="response");if(m&&(E||he&&$)){const xe={};["status","statusText","headers"].forEach(ee=>{xe[ee]=H[ee]});const ve=J.toFiniteNumber(H.headers.get("content-length")),[oe,D]=E&&tp(ve,gl(np(E),!0))||[];H=new s(ip(H.body,sp,oe,()=>{D&&D(),$&&$()}),xe)}R=R||"text";let ne=await g[J.findKey(g,R)||"text"](H,N);return!he&&$&&$(),await new Promise((xe,ve)=>{dy(xe,ve,{data:ne,headers:mn.from(H.headers),status:H.status,statusText:H.statusText,config:N,request:V})})}catch(ie){throw $&&$(),ie&&ie.name==="TypeError"&&/Load failed|fetch/i.test(ie.message)?Object.assign(new We("Network Error",We.ERR_NETWORK,N,V),{cause:ie.cause||ie}):We.from(ie,ie&&ie.code,N,V)}}},Sj=new Map,fy=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:o}=t,a=[s,o,n];let l=a.length,d=l,u,f,m=Sj;for(;d--;)u=a[d],f=m.get(u),f===void 0&&m.set(u,f=d?new Map:jj(t)),m=f;return f};fy();const Td={http:Dw,xhr:gj,fetch:{get:fy}};J.forEach(Td,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const cp=e=>`- ${e}`,Cj=e=>J.isFunction(e)||e===null||e===!1,py={getAdapter:(e,t)=>{e=J.isArray(e)?e:[e];const{length:n}=e;let s,o;const a={};for(let l=0;l<n;l++){s=e[l];let d;if(o=s,!Cj(s)&&(o=Td[(d=String(s)).toLowerCase()],o===void 0))throw new We(`Unknown adapter '${d}'`);if(o&&(J.isFunction(o)||(o=o.get(t))))break;a[d||"#"+l]=o}if(!o){const l=Object.entries(a).map(([u,f])=>`adapter ${u} `+(f===!1?"is not supported by the environment":"is not available in the build"));let d=n?l.length>1?`since :
`+l.map(cp).join(`
`):" "+cp(l[0]):"as no adapter specified";throw new We("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return o},adapters:Td};function Lc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new $s(null,e)}function dp(e){return Lc(e),e.headers=mn.from(e.headers),e.data=Ic.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),py.getAdapter(e.adapter||Ya.adapter,e)(e).then(function(s){return Lc(e),s.data=Ic.call(e,e.transformResponse,s),s.headers=mn.from(s.headers),s},function(s){return cy(s)||(Lc(e),s&&s.response&&(s.response.data=Ic.call(e,e.transformResponse,s.response),s.response.headers=mn.from(s.response.headers))),Promise.reject(s)})}const my="1.12.2",Ul={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ul[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const up={};Ul.transitional=function(t,n,s){function o(a,l){return"[Axios v"+my+"] Transitional option '"+a+"'"+l+(s?". "+s:"")}return(a,l,d)=>{if(t===!1)throw new We(o(l," has been removed"+(n?" in "+n:"")),We.ERR_DEPRECATED);return n&&!up[l]&&(up[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,l,d):!0}};Ul.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Nj(e,t,n){if(typeof e!="object")throw new We("options must be an object",We.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let o=s.length;for(;o-- >0;){const a=s[o],l=t[a];if(l){const d=e[a],u=d===void 0||l(d,a,e);if(u!==!0)throw new We("option "+a+" must be "+u,We.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new We("Unknown option "+a,We.ERR_BAD_OPTION)}}const Ho={assertOptions:Nj,validators:Ul},or=Ho.validators;let Ai=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Xf,response:new Xf}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?a&&!String(s.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+a):s.stack=a}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=zi(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:a}=n;s!==void 0&&Ho.assertOptions(s,{silentJSONParsing:or.transitional(or.boolean),forcedJSONParsing:or.transitional(or.boolean),clarifyTimeoutError:or.transitional(or.boolean)},!1),o!=null&&(J.isFunction(o)?n.paramsSerializer={serialize:o}:Ho.assertOptions(o,{encode:or.function,serialize:or.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Ho.assertOptions(n,{baseUrl:or.spelling("baseURL"),withXsrfToken:or.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=a&&J.merge(a.common,a[n.method]);a&&J.forEach(["delete","get","head","post","put","patch","common"],N=>{delete a[N]}),n.headers=mn.concat(l,a);const d=[];let u=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(u=u&&_.synchronous,d.unshift(_.fulfilled,_.rejected))});const f=[];this.interceptors.response.forEach(function(_){f.push(_.fulfilled,_.rejected)});let m,g=0,y;if(!u){const N=[dp.bind(this),void 0];for(N.unshift(...d),N.push(...f),y=N.length,m=Promise.resolve(n);g<y;)m=m.then(N[g++],N[g++]);return m}y=d.length;let C=n;for(;g<y;){const N=d[g++],_=d[g++];try{C=N(C)}catch(b){_.call(this,b);break}}try{m=dp.call(this,C)}catch(N){return Promise.reject(N)}for(g=0,y=f.length;g<y;)m=m.then(f[g++],f[g++]);return m}getUri(t){t=zi(this.defaults,t);const n=uy(t.baseURL,t.url,t.allowAbsoluteUrls);return ay(n,t.params,t.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(t){Ai.prototype[t]=function(n,s){return this.request(zi(s||{},{method:t,url:n,data:(s||{}).data}))}});J.forEach(["post","put","patch"],function(t){function n(s){return function(a,l,d){return this.request(zi(d||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Ai.prototype[t]=n(),Ai.prototype[t+"Form"]=n(!0)});let kj=class gy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(o=>{if(!s._listeners)return;let a=s._listeners.length;for(;a-- >0;)s._listeners[a](o);s._listeners=null}),this.promise.then=o=>{let a;const l=new Promise(d=>{s.subscribe(d),a=d}).then(o);return l.cancel=function(){s.unsubscribe(a)},l},t(function(a,l,d){s.reason||(s.reason=new $s(a,l,d),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new gy(function(o){t=o}),cancel:t}}};function bj(e){return function(n){return e.apply(null,n)}}function Ij(e){return J.isObject(e)&&e.isAxiosError===!0}const Bd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Bd).forEach(([e,t])=>{Bd[t]=e});function yy(e){const t=new Ai(e),n=Gg(Ai.prototype.request,t);return J.extend(n,Ai.prototype,t,{allOwnKeys:!0}),J.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return yy(zi(e,o))},n}const gt=yy(Ya);gt.Axios=Ai;gt.CanceledError=$s;gt.CancelToken=kj;gt.isCancel=cy;gt.VERSION=my;gt.toFormData=Fl;gt.AxiosError=We;gt.Cancel=gt.CanceledError;gt.all=function(t){return Promise.all(t)};gt.spread=bj;gt.isAxiosError=Ij;gt.mergeConfig=zi;gt.AxiosHeaders=mn;gt.formToJSON=e=>ly(J.isHTMLForm(e)?new FormData(e):e);gt.getAdapter=py.getAdapter;gt.HttpStatusCode=Bd;gt.default=gt;const{Axios:Z1,AxiosError:V1,CanceledError:q1,isCancel:G1,CancelToken:Y1,VERSION:K1,all:J1,Cancel:Q1,isAxiosError:X1,spread:eC,toFormData:tC,AxiosHeaders:nC,HttpStatusCode:rC,formToJSON:iC,getAdapter:sC,mergeConfig:aC}=gt,Hi="http://localhost:5054/api",te=gt.create({baseURL:Hi,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});te.interceptors.request.use(e=>{try{const t=localStorage.getItem("token");t&&t!=="null"&&(e.headers.Authorization=`Bearer ${t}`)}catch{}return e},e=>Promise.reject(e));let Lo=!1,Rd=[];const hp=(e,t=null)=>{Rd.forEach(n=>{e?n.reject(e):n.resolve(t)}),Rd=[]};te.interceptors.response.use(e=>e,async e=>{var n,s,o,a,l,d,u,f;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){if(Lo)return new Promise((m,g)=>{Rd.push({resolve:m,reject:g})}).then(m=>(t.headers.Authorization=`Bearer ${m}`,te(t))).catch(m=>Promise.reject(m));t._retry=!0,Lo=!0;try{console.log(" Token expired, refreshing...");const m=localStorage.getItem("refreshToken");if(!m)throw new Error("No refresh token available");const g=await gt.post(`${Hi}/Auth/Refresh-Token`,{refreshToken:m}),y=((o=(s=g.data)==null?void 0:s.data)==null?void 0:o.token)||((a=g.data)==null?void 0:a.token)||((l=g.data)==null?void 0:l.accessToken),C=((u=(d=g.data)==null?void 0:d.data)==null?void 0:u.refreshToken)||((f=g.data)==null?void 0:f.refreshToken);if(y)return console.log(" Token refreshed successfully"),localStorage.setItem("token",y),C&&localStorage.setItem("refreshToken",C),t.headers.Authorization=`Bearer ${y}`,hp(null,y),Lo=!1,te(t);throw new Error("No token in refresh response")}catch(m){return console.error(" Token refresh failed:",m),hp(m,null),Lo=!1,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),window.location.href="/",Promise.reject(m)}}return Promise.reject(e)});const Pr=e=>{if(!e)return{};try{const t=e.split(".");if(t.length<2)return{};const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch(t){return console.warn("decodeJwt failed",t),{}}},vt={register:async({fullName:e,email:t,phoneNumber:n,password:s})=>{const o={FullName:e,Email:t,PhoneNumber:n,Password:s,ConfirmPassword:s};return(await te.post("/Auth/Register",o)).data},login:async(e,t)=>{var n,s,o,a,l,d,u,f,m,g;try{const y=await te.post("/Auth/Login",{Email:e,Password:t}),C=((n=y.data)==null?void 0:n.data)||y.data||{},N=C.token||C.accessToken||((s=y.data)==null?void 0:s.token),_=C.refreshToken||((o=y.data)==null?void 0:o.refreshToken);if(N){localStorage.setItem("token",N);try{const b=Pr(N),w=b["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||b.nameidentifier||b.UserId||b.userId||b.uid||b.nameid||b.sub||b.id||b.Id;w&&localStorage.setItem("userId",w);const x=b["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||b.role||b.Role;x&&localStorage.setItem("userRole",x)}catch(b){console.error(" Error decoding JWT in authApi.login:",b)}}_&&localStorage.setItem("refreshToken",_),C.user&&localStorage.setItem("user",JSON.stringify(C.user)),(a=C.user)!=null&&a.email?localStorage.setItem("userEmail",C.user.email):e&&localStorage.setItem("userEmail",e);try{const b=localStorage.getItem("userRole");if(b&&(b.includes("Staff")||b.includes("staff")||b==="StationManager"||b.includes("Manager"))){const x=await vt.getMyProfile(),k=(x==null?void 0:x.stationId)||(x==null?void 0:x.StationId);k&&localStorage.setItem("stationId",k)}}catch(b){console.warn(" Could not fetch staff profile after login:",b)}return{raw:y.data,token:N,refreshToken:_,payload:C}}catch(y){const C=((d=(l=y.response)==null?void 0:l.data)==null?void 0:d.message)||((u=y.response)!=null&&u.data&&typeof y.response.data=="string"?y.response.data:null)||((m=(f=y.response)==null?void 0:f.data)==null?void 0:m.errors)&&Object.values(y.response.data.errors).flat().join("; ")||y.message||"Login failed",N=new Error(C);throw N.status=(g=y.response)==null?void 0:g.status,N}},logout:async()=>{const e=await te.post("/Auth/Logout");return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),localStorage.removeItem("userRole"),localStorage.removeItem("stationId"),e.data},refreshToken:async()=>{var s,o,a,l,d,u,f;const e=await te.post("/Auth/Refresh-Token"),t=((o=(s=e.data)==null?void 0:s.data)==null?void 0:o.token)||((a=e.data)==null?void 0:a.token)||((l=e.data)==null?void 0:l.accessToken),n=((u=(d=e.data)==null?void 0:d.data)==null?void 0:u.refreshToken)||((f=e.data)==null?void 0:f.refreshToken);return t&&localStorage.setItem("token",t),n&&localStorage.setItem("refreshToken",n),e.data},uploadCCCD:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await te.post("/Auth/cccd",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},uploadGPLX:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await te.post("/Auth/gplx",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},getMe:async()=>{var t;const e=await te.get("/Auth/Me");return((t=e.data)==null?void 0:t.data)||e.data||{}},getMyProfile:async()=>{var t;const e=await te.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},getUserById:async e=>{var t,n;try{const s=await te.get(`/Users/Get-By-${encodeURIComponent(e)}`);return((t=s.data)==null?void 0:t.data)||s.data||{}}catch{try{const o=await te.get(`/Users/${encodeURIComponent(e)}`);return((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error("authApi.getUserById failed:",o),o}}}};function Fr({isOpen:e,type:t="info",title:n,message:s,onClose:o,actionLabel:a="OK",onAction:l,autoCloseMs:d=null}){if(hr.useEffect(()=>{if(!e||!d)return;const m=setTimeout(o,d);return()=>clearTimeout(m)},[e,d,o]),!e)return null;const u=()=>{l&&l(),o()},f={success:"",error:"",info:"",warning:""}[t]||"";return r.jsx("div",{className:`notification-backdrop notification-${t}`,children:r.jsxs("div",{className:`notification-modal notification-${t}`,children:[r.jsxs("div",{className:"notification-header",children:[r.jsx("span",{className:"notification-icon",children:f}),r.jsx("h3",{className:"notification-title",children:n}),r.jsx("button",{className:"notification-close",onClick:o,children:""})]}),r.jsx("div",{className:"notification-body",children:Array.isArray(s)?r.jsx("ul",{children:s.map((m,g)=>r.jsx("li",{children:m},g))}):r.jsx("p",{children:s})}),r.jsxs("div",{className:"notification-footer",children:[r.jsx("button",{className:"btn-close",onClick:o,children:"Close"}),l&&r.jsx("button",{className:`btn-action btn-${t}`,onClick:u,children:a})]})]})})}function xy({documents:e,setDocuments:t,onDocumentUploadSuccess:n}){const[s,o]=v.useState({cccdFront:null,cccdBack:null,licenseFront:null,licenseBack:null}),[a,l]=v.useState({}),[d,u]=v.useState({isOpen:!1,type:"info",title:"",message:""}),f=(y,C)=>{if(!C)return;if(!C.type.startsWith("image/")){u({isOpen:!0,type:"error",title:"Invalid File Type",message:"Please select an image file (JPG, PNG, etc.)"});return}if(C.size>25*1024*1024){u({isOpen:!0,type:"error",title:"File Too Large",message:"Please select a file smaller than 25MB"});return}const N=new FileReader;N.onload=_=>{const b=_.target.result;t(w=>({...w,[y]:b}))},N.readAsDataURL(C),o(_=>({..._,[y]:C}))},m=async()=>{var N,_;const y=s.cccdFront,C=s.cccdBack;if(!y&&!C){u({isOpen:!0,type:"error",title:"No Files Selected",message:"Please select at least one CCCD image"});return}l(b=>({...b,cccdFront:!0,cccdBack:!0}));try{await vt.uploadCCCD(y,C);const w=await vt.getMe()||{};t(x=>({...x,cccdFront:w.cccdImageUrl_Front||"",cccdBack:w.cccdImageUrl_Back||""})),o(x=>({...x,cccdFront:null,cccdBack:null})),u({isOpen:!0,type:"success",title:"Upload Successful",message:" CCCD uploaded successfully!",autoCloseMs:2e3}),n&&n()}catch(b){u({isOpen:!0,type:"error",title:"Upload Failed",message:((_=(N=b.response)==null?void 0:N.data)==null?void 0:_.message)||"Failed to upload CCCD"})}finally{l(b=>({...b,cccdFront:!1,cccdBack:!1}))}},g=async()=>{var N,_;const y=s.licenseFront,C=s.licenseBack;if(!y&&!C){u({isOpen:!0,type:"error",title:"No Files Selected",message:"Please select at least one driver license image"});return}l(b=>({...b,licenseFront:!0,licenseBack:!0}));try{await vt.uploadGPLX(y,C);const w=await vt.getMe()||{};t(x=>({...x,licenseFront:w.gplxImageUrl_Front||"",licenseBack:w.gplxImageUrl_Back||""})),o(x=>({...x,licenseFront:null,licenseBack:null})),u({isOpen:!0,type:"success",title:"Upload Successful",message:" Driver License uploaded successfully!",autoCloseMs:2e3}),n&&n()}catch(b){u({isOpen:!0,type:"error",title:"Upload Failed",message:((_=(N=b.response)==null?void 0:N.data)==null?void 0:_.message)||"Failed to upload driver license"})}finally{l(b=>({...b,licenseFront:!1,licenseBack:!1}))}};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"document-upload-section",children:[r.jsx("h2",{className:"document-upload-title",children:" Upload Documents"}),r.jsx("p",{className:"document-upload-description",children:"Upload clear images of your ID card and driver license (both sides)"}),r.jsxs("div",{className:"document-upload-subsection",children:[r.jsx("h3",{children:"ID Card (CCCD)"}),r.jsxs("div",{className:"documents-grid",children:[r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"ID Card (Front)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("cccdFront-input").click(),children:[e.cccdFront&&e.cccdFront.trim()?r.jsx("img",{src:e.cccdFront,alt:"CCCD Front",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card"}),r.jsx("span",{children:"Click to select"})]}),a.cccdFront&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"cccdFront-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var C;return f("cccdFront",(C=y.target.files)==null?void 0:C[0])}})]}),r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"ID Card (Back)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("cccdBack-input").click(),children:[e.cccdBack&&e.cccdBack.trim()?r.jsx("img",{src:e.cccdBack,alt:"CCCD Back",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card"}),r.jsx("span",{children:"Click to select"})]}),a.cccdBack&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"cccdBack-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var C;return f("cccdBack",(C=y.target.files)==null?void 0:C[0])}})]})]}),r.jsxs("button",{type:"button",className:"btn-upload-docs",onClick:m,disabled:!s.cccdFront&&!s.cccdBack||a.cccdFront||a.cccdBack,children:[r.jsx("i",{className:"fas fa-upload"})," Upload ID Card"]})]}),r.jsxs("div",{className:"document-upload-subsection",children:[r.jsx("h3",{children:"Driver License (GPLX)"}),r.jsxs("div",{className:"documents-grid",children:[r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"Driver License (Front)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("licenseFront-input").click(),children:[e.licenseFront&&e.licenseFront.trim()?r.jsx("img",{src:e.licenseFront,alt:"License Front",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card-alt"}),r.jsx("span",{children:"Click to select"})]}),a.licenseFront&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"licenseFront-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var C;return f("licenseFront",(C=y.target.files)==null?void 0:C[0])}})]}),r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"Driver License (Back)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("licenseBack-input").click(),children:[e.licenseBack&&e.licenseBack.trim()?r.jsx("img",{src:e.licenseBack,alt:"License Back",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card-alt"}),r.jsx("span",{children:"Click to select"})]}),a.licenseBack&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"licenseBack-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var C;return f("licenseBack",(C=y.target.files)==null?void 0:C[0])}})]})]}),r.jsxs("button",{type:"button",className:"btn-upload-docs",onClick:g,disabled:!s.licenseFront&&!s.licenseBack||a.licenseFront||a.licenseBack,children:[r.jsx("i",{className:"fas fa-upload"})," Upload Driver License"]})]})]}),r.jsx(Fr,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,autoCloseMs:d.autoCloseMs,onClose:()=>u(y=>({...y,isOpen:!1}))})]})}function Lj(){const e=on(),[t,n]=v.useState({}),[s,o]=v.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""});return v.useEffect(()=>{(async()=>{try{console.log(" Fetching user profile from /api/Users/Get-My-Profile...");const l=await vt.getMyProfile();console.log(" User profile:",l),n(l||{}),console.log(" Fetching document URLs from /api/Auth/me...");const d=await vt.getMe();console.log(" Auth response from /api/Auth/me:",d);const u=d||{};console.log(" Extracted auth data:",u);const f=u.cccdImageUrl_Front&&u.cccdImageUrl_Front.trim()?u.cccdImageUrl_Front:"",m=u.cccdImageUrl_Back&&u.cccdImageUrl_Back.trim()?u.cccdImageUrl_Back:"",g=u.gplxImageUrl_Front&&u.gplxImageUrl_Front.trim()?u.gplxImageUrl_Front:"",y=u.gplxImageUrl_Back&&u.gplxImageUrl_Back.trim()?u.gplxImageUrl_Back:"";console.log(" Loaded document URLs:",{cccdFront:f,cccdBack:m,licenseFront:g,licenseBack:y}),o({cccdFront:f,cccdBack:m,licenseFront:g,licenseBack:y})}catch(l){console.error(" Error loading profile:",l);const d=localStorage.getItem("userEmail"),u=localStorage.getItem("username"),f=localStorage.getItem("userPhone");n({email:d,fullName:u,phoneNumber:f}),o({cccdFront:localStorage.getItem("cccdFront")||"",cccdBack:localStorage.getItem("cccdBack")||"",licenseFront:localStorage.getItem("licenseFront")||"",licenseBack:localStorage.getItem("licenseBack")||""})}})()},[]),r.jsx("main",{className:"profile-main",children:r.jsxs("div",{className:"profile-container",children:[r.jsx("h2",{children:"USER PROFILE"}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Full Name"}),r.jsx("input",{type:"text",value:t.firstName?`${t.firstName} ${t.lastName}`:t.fullName||"",readOnly:!0})]}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:t.email||"",readOnly:!0})]}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Phone Number"}),r.jsx("input",{type:"tel",value:t.phoneNumber||"",readOnly:!0})]}),r.jsx(xy,{documents:s,setDocuments:o,onDocumentUploadSuccess:()=>{console.log(" Document upload successful")}}),r.jsx("div",{className:"profile-actions",children:r.jsxs("button",{className:"btn-update-profile",onClick:()=>e("/update-profile"),children:[r.jsx("i",{className:"fas fa-edit"})," Update Profile Information"]})})]})})}const Ol={getMyProfile:async()=>{var t;const e=await te.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},updateMyProfile:async e=>{var t,n;try{console.log(" Updating user profile:",e);const s=await te.put("/Users/Update-My-Profile",e);return console.log(" Profile updated:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error updating profile:",((n=s.response)==null?void 0:n.data)||s.message),s}},changePassword:async(e,t)=>{var n,s;try{console.log(" Changing password");const o=await te.post("/Users/Change-Password",{currentPassword:e,newPassword:t});return console.log(" Password changed successfully"),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error changing password:",((s=o.response)==null?void 0:s.data)||o.message),o}},updateUserAvatar:async(e,t)=>{var n,s;try{console.log(" Updating avatar for user:",e);const o=await te.post(`/Users/${encodeURIComponent(e)}/avatar`,{avatarUrl:t});return console.log(" Avatar updated:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error updating avatar:",((s=o.response)==null?void 0:s.data)||o.message),o}},getUserById:async e=>{var t,n;try{console.log(" Fetching user by ID:",e);const s=await te.get(`/Users/Get-By-${encodeURIComponent(e)}`);return console.log(" User data:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching user:",((n=s.response)==null?void 0:n.data)||s.message),s}},searchUsers:async(e,t=1,n=10)=>{var s,o,a;try{console.log(" Searching users by email:",e);const l=await te.get("/Users/Search",{params:{email:e,pageNumber:t,pageSize:n}});return console.log(" Search results:",l.data),Array.isArray(l.data)?l.data:(s=l.data)!=null&&s.data&&Array.isArray(l.data.data)?l.data.data:(o=l.data)!=null&&o.items&&Array.isArray(l.data.items)?l.data.items:l.data||[]}catch(l){return console.error(" Error searching users:",((a=l.response)==null?void 0:a.data)||l.message),[]}},deactivateUser:async(e,t="")=>{var n;try{const s=encodeURIComponent(e),o=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Users/Deactivate-By-${s}${o}`,`/User/Deactivate-By-${s}${o}`];for(const l of a)try{const d=await te.patch(l,t?{reason:t}:{}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(n=d==null?void 0:d.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Deactivate user endpoint not found")}catch(s){throw console.error(" Error deactivating user:",s.message),s}},activateUser:async e=>{var t;try{const n=encodeURIComponent(e),s=[`/Users/Activate-By-${n}`,`/User/Activate-By-${n}`];for(const o of s)try{const a=await te.patch(o,{}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(t=a==null?void 0:a.response)==null?void 0:t.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Activate user endpoint not found")}catch(n){throw console.error(" Error activating user:",n.message),n}},updateUserRole:async(e,t)=>{var n;try{const s=encodeURIComponent(e),o=[`/Users/Update-Role-By-${s}`,`/User/Update-Role-By-${s}`];for(const a of o)try{const l=await te.patch(a,{role:t}),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){const d=(n=l==null?void 0:l.response)==null?void 0:n.status;if(d&&d!==404&&d!==405)throw l}throw new Error("Update user role endpoint not found")}catch(s){throw console.error(" Error updating user role:",s.message),s}},updateUserProfileByAdmin:async(e,t)=>{var n;try{const s=encodeURIComponent(e),o=[`/Users/Update-Profile-By-${s}`,`/User/Update-Profile-By-${s}`];for(const a of o)try{const l=await te.put(a,t),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){const d=(n=l==null?void 0:l.response)==null?void 0:n.status;if(d&&d!==404&&d!==405)throw l}throw new Error("Update user profile endpoint not found")}catch(s){throw console.error(" Error updating user profile:",s.message),s}},getTotalUserCount:async()=>{var e;try{const t=["/Users/Get-Total-Count","/User/Get-Total-Count"];for(const n of t)try{const s=await te.get(n),o=s==null?void 0:s.data,a=o&&typeof o=="object"&&"data"in o?o.data:o;return(a==null?void 0:a.totalCount)||(a==null?void 0:a.count)||a||0}catch(s){const o=(e=s==null?void 0:s.response)==null?void 0:e.status;if(o&&o!==404&&o!==405)throw s}return 0}catch(t){return console.error(" Error getting total user count:",t.message),0}},getUserStatisticsByRole:async()=>{var e;try{const t=["/Users/Get-Statistics-By-Role","/User/Get-Statistics-By-Role","/Users/Statistics-By-Role"];for(const n of t)try{const s=await te.get(n),o=s==null?void 0:s.data;return(o&&typeof o=="object"&&"data"in o?o.data:o)||{}}catch(s){const o=(e=s==null?void 0:s.response)==null?void 0:e.status;if(o&&o!==404&&o!==405)throw s}return{}}catch(t){return console.error(" Error getting user statistics:",t.message),{}}}};function Pj(){const e=on(),[t,n]=v.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[s,o]=v.useState(!1),[a,l]=v.useState(!0),[d,u]=v.useState([]),[f,m]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[g,y]=v.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""});v.useEffect(()=>{C()},[]);const C=async()=>{try{l(!0),console.log(" Initializing profile form...");const w=localStorage.getItem("userFirstName")||"",x=localStorage.getItem("userLastName")||"",k=localStorage.getItem("userPhone")||"";console.log(" Profile initialized from localStorage");const S=[],E=localStorage.getItem("userAddress"),P=localStorage.getItem("userDateOfBirth"),R=localStorage.getItem("userDriverLicenseNumber"),B=localStorage.getItem("userDriverLicenseExpiry");console.log(" Checking 4 required fields:"),console.log("  Address:",E),console.log("  DateOfBirth:",P),console.log("  DriverLicenseNumber:",R),console.log("  DriverLicenseExpiry:",B),(!E||E.trim()==="")&&S.push("address"),(!P||P.trim()==="")&&S.push("dateOfBirth"),(!R||R.trim()==="")&&S.push("driverLicenseNumber"),(!B||B.trim()==="")&&S.push("driverLicenseExpiry"),u(S),console.log(" Missing fields:",S),n({firstName:w,lastName:x,phoneNumber:k,address:localStorage.getItem("userAddress")||"",dateOfBirth:localStorage.getItem("userDateOfBirth")||"",yearOfBirth:localStorage.getItem("userYearOfBirth")||"",identityNumber:localStorage.getItem("userIdentityNumber")||"",driverLicenseNumber:localStorage.getItem("userDriverLicenseNumber")||"",driverLicenseExpiry:localStorage.getItem("userDriverLicenseExpiry")||"",driverLicenseClass:localStorage.getItem("userDriverLicenseClass")||""});const I=await vt.getMe()||{};y({cccdFront:I.cccdImageUrl_Front||"",cccdBack:I.cccdImageUrl_Back||"",licenseFront:I.gplxImageUrl_Front||"",licenseBack:I.gplxImageUrl_Back||""})}catch(w){console.error(" Error initializing profile:",w)}finally{l(!1)}},N=w=>{const{name:x,value:k}=w.target,S={...t,[x]:k};if(x==="dateOfBirth"&&k){const E=new Date(k).getFullYear();S.yearOfBirth=String(E),console.log(` Extracted year ${E} from date ${k}`)}n(S)},_=()=>t.firstName.trim()?t.lastName.trim()?t.phoneNumber.trim()?t.phoneNumber.match(/^[0-9]{10,11}$/)?t.address.trim()?t.driverLicenseNumber.trim()?t.driverLicenseExpiry.trim()?!0:(m({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Expiry is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Number is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Address is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number must be 10-11 digits"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Last name is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"First name is required"}),!1),b=async w=>{var x,k;if(w.preventDefault(),!!_()){o(!0);try{console.log(" Updating profile with data:",t);const S={request:"UpdateProfile",firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber,address:t.address||"",dateOfBirth:t.dateOfBirth||"",yearOfBirth:t.yearOfBirth?String(t.yearOfBirth):"",identityNumber:t.identityNumber||"",driverLicenseNumber:t.driverLicenseNumber||"",driverLicenseExpiry:t.driverLicenseExpiry||"",driverLicenseClass:t.driverLicenseClass||""},E=await Ol.updateMyProfile(S);console.log(" Profile updated successfully:",E),localStorage.setItem("userFirstName",t.firstName),localStorage.setItem("userLastName",t.lastName),localStorage.setItem("userPhone",t.phoneNumber),localStorage.setItem("userAddress",t.address),localStorage.setItem("userDateOfBirth",t.dateOfBirth),localStorage.setItem("userYearOfBirth",t.yearOfBirth),localStorage.setItem("userIdentityNumber",t.identityNumber),localStorage.setItem("userDriverLicenseNumber",t.driverLicenseNumber),localStorage.setItem("userDriverLicenseExpiry",t.driverLicenseExpiry),localStorage.setItem("userDriverLicenseClass",t.driverLicenseClass),m({isOpen:!0,type:"success",title:"Success! ",message:"Your profile has been updated successfully.",autoCloseMs:2e3,onAction:()=>{e("/")},actionLabel:"Go to Home"})}catch(S){console.error(" Error updating profile:",S),m({isOpen:!0,type:"error",title:"Update Failed",message:((k=(x=S.response)==null?void 0:x.data)==null?void 0:k.message)||"Failed to update profile. Please try again."})}finally{o(!1)}}};return a?r.jsx("div",{className:"update-profile-page",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Loading your profile..."})]})}):r.jsxs("div",{className:"update-profile-page",children:[r.jsx(Fr,{isOpen:f.isOpen,type:f.type,title:f.title,message:f.message,onClose:()=>m({...f,isOpen:!1}),autoCloseMs:f.autoCloseMs||0,onAction:f.onAction,actionLabel:f.actionLabel}),r.jsxs("div",{className:"container",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("h1",{children:" Update Your Profile"}),r.jsx("p",{style:{color:"white"},children:"Keep your information up to date to enjoy our services"})]}),d.length>0&&r.jsxs("div",{className:"warning-banner",children:[r.jsx("span",{className:"warning-icon",children:""}),r.jsxs("div",{children:[r.jsx("strong",{children:"Missing Information"}),r.jsxs("p",{children:["Please complete the following fields: ",d.map(w=>w==="address"?"Address":w==="driverLicenseNumber"?"Driver License Number":w==="driverLicenseExpiry"?"Driver License Expiry":w).join(", ")]})]})]}),r.jsxs("form",{onSubmit:b,className:"update-profile-form",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Basic Information"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"firstName",children:"First Name *"}),r.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:N,placeholder:"John",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),r.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:N,placeholder:"Doe",required:!0})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),r.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:t.phoneNumber,onChange:N,placeholder:"0912345678",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"address",children:["Address *",d.includes("address")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"address",name:"address",value:t.address,onChange:N,placeholder:"123 Main St, City, Country",className:d.includes("address")?"field-missing":"",required:!0})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Birth Information"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),r.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:t.dateOfBirth,onChange:N})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth (Auto-filled)"}),r.jsx("input",{type:"text",id:"yearOfBirth",name:"yearOfBirth",value:t.yearOfBirth,disabled:!0,placeholder:"Will auto-fill from date above",style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Driver License Information *"}),r.jsxs("div",{className:`form-group ${d.includes("driverLicenseNumber")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number *",d.includes("driverLicenseNumber")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:t.driverLicenseNumber,onChange:N,placeholder:"ABC123456",className:d.includes("driverLicenseNumber")?"field-missing":"",required:!0})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:`form-group ${d.includes("driverLicenseExpiry")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry *",d.includes("driverLicenseExpiry")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:t.driverLicenseExpiry,onChange:N,className:d.includes("driverLicenseExpiry")?"field-missing":"",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),r.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:t.driverLicenseClass,onChange:N,children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"A",children:"Class A"}),r.jsx("option",{value:"A1",children:"Class A1"}),r.jsx("option",{value:"B",children:"Class B"}),r.jsx("option",{value:"C",children:"Class C"}),r.jsx("option",{value:"D",children:"Class D"}),r.jsx("option",{value:"E",children:"Class E"})]})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Additional Information"}),r.jsxs("div",{className:`form-group ${d.includes("identityNumber")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"identityNumber",children:["Identity Number (CCCD) *",d.includes("identityNumber")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:t.identityNumber,onChange:N,placeholder:"123456789012",className:d.includes("identityNumber")?"field-missing":"",required:!0})]})]}),r.jsx(xy,{documents:g,setDocuments:y,onDocumentUploadSuccess:()=>{console.log(" Document upload successful")}}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e(-1),disabled:s,children:" Go Back"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?" Saving...":" Save Profile"})]})]})]})]})}const Ad={getAllStations:async(e=1,t=100)=>{var n;try{console.log(" Fetching stations from:",`${Hi}/Stations/Get-All`);const s=await te.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Stations response:",s.data);const o=s.data;return Array.isArray(o)?(console.log(" Returning stations array:",o.length,"items"),o):o.data&&o.data.data&&Array.isArray(o.data.data)?(console.log(" Returning stations from data.data.data:",o.data.data.length,"items"),o.data.data):o.data&&o.data.items&&Array.isArray(o.data.items)?(console.log(" Returning stations from data.data.items:",o.data.items.length,"items"),o.data.items):o.data&&Array.isArray(o.data)?(console.log(" Returning stations from data.data:",o.data.length,"items"),o.data):o.items&&Array.isArray(o.items)?(console.log(" Returning stations from data.items:",o.items.length,"items"),o.items):(console.warn(" No stations found in response"),[])}catch(s){return console.error(" Error fetching stations:",((n=s.response)==null?void 0:n.data)||s.message),[]}}},tt={getAllCars:async(e=1,t=100)=>{var n;try{console.log(" Fetching cars from:",`${Hi}/Cars/Get-All`);const s=await te.get("/Cars/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Cars response:",s.data);const o=s.data;return Array.isArray(o)?(console.log(" Returning cars array:",o.length,"items"),o):o.data&&o.data.data&&Array.isArray(o.data.data)?(console.log(" Returning cars from data.data.data:",o.data.data.length,"items"),o.data.data):o.data&&o.data.items&&Array.isArray(o.data.items)?(console.log(" Returning cars from data.data.items:",o.data.items.length,"items"),o.data.items):o.data&&Array.isArray(o.data)?(console.log(" Returning cars from data.data:",o.data.length,"items"),o.data):o.items&&Array.isArray(o.items)?(console.log(" Returning cars from data.items:",o.items.length,"items"),o.items):(console.warn(" No cars found in response"),[])}catch(s){return console.error(" Error fetching cars:",((n=s.response)==null?void 0:n.data)||s.message),[]}},getCarById:async e=>{var t;try{console.log(" Fetching car details for ID:",e);const n=await te.get(`/Cars/Get-By-${encodeURIComponent(e)}`);console.log(" Car detail response:",n.data);const s=n.data;return s.id||s.Id?(console.log(" Returning car object directly"),s):s.data&&s.data.data&&(s.data.data.id||s.data.data.Id)?(console.log(" Returning car from data.data.data"),s.data.data):s.data&&(s.data.id||s.data.Id)?(console.log(" Returning car from data.data"),s.data):(console.warn(" No car found in response"),null)}catch(n){throw console.error(" Error fetching car details:",((t=n.response)==null?void 0:t.data)||n.message),n}},getAvailableCarsByStation:async(e,t,n)=>{var s;try{console.log(" Fetching available cars for station:",e,"startTime:",t,"endTime:",n);try{const o=await te.get("/Bookings/available-cars-by-station",{params:{stationId:e,startTime:t,endTime:n}});console.log(" Available cars response:",o.data);const a=o.data;if(Array.isArray(a))return console.log(" Returning available cars array:",a.length,"items"),a;if(a.data&&a.data.data&&Array.isArray(a.data.data))return console.log(" Returning available cars from data.data.data:",a.data.data.length,"items"),a.data.data;if(a.data&&a.data.items&&Array.isArray(a.data.items))return console.log(" Returning available cars from data.data.items:",a.data.items.length,"items"),a.data.items;if(a.data&&Array.isArray(a.data))return console.log(" Returning available cars from data.data:",a.data.length,"items"),a.data;if(a.items&&Array.isArray(a.items))return console.log(" Returning available cars from data.items:",a.items.length,"items"),a.items}catch(o){console.warn(" Primary endpoint failed, trying fallback - getting all cars and filtering:",o.message);try{const a=await tt.getAllCars(),l=(a||[]).filter(d=>{var f,m;return(d.currentStationId||d.stationId||((f=d.station)==null?void 0:f.id)||((m=d.station)==null?void 0:m.Id))===e});return console.log(` Filtered ${l.length} cars for station ${e} from ${a.length} total cars`),l}catch(a){return console.warn(" Failed to get all cars for filtering:",a.message),[]}}return console.warn(" No available cars found in response"),[]}catch(o){return console.error(" Error fetching available cars:",((s=o.response)==null?void 0:s.data)||o.message),[]}},createCar:async e=>{var t,n;try{if(e instanceof FormData){const s={headers:{"Content-Type":void 0}};console.log(" Sending FormData with image for car creation");const o=await te.post("/Cars/Create",e,s);return((t=o.data)==null?void 0:t.data)||o.data}else{const s=await te.post("/Cars/Create",e);return((n=s.data)==null?void 0:n.data)||s.data}}catch(s){throw console.error("Error creating car:",s),s}},deleteCar:async e=>{var t;try{const n=await te.delete(`/Cars/Delete-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error deleting car:",n),n}},updateCar:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,t);return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car:",s),s}},updateStatus:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{tech:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car status:",s),s}},updateBatteryLevel:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{battery:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating battery level:",s),s}},updateCarDescription:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{issue:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car description:",s),s}},updateCarAvailability:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{isAvailable:t===1||t===!0});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car availability:",s),s}}},Ej=Object.freeze(Object.defineProperty({__proto__:null,default:tt},Symbol.toStringTag,{value:"Module"})),Tj=24e3;function Kt(e,t={convertFromUSD:!1}){const{convertFromUSD:n}=t||{},s=Number(e)||0,o=Math.round(n?s*Tj:s);return new Intl.NumberFormat("vi-VN").format(o)+" "}const vy=v.createContext(null);function Bj({children:e}){const[t,n]=v.useState([]),s=v.useCallback((a,l="info",d=3500,u=null)=>{const f=Date.now()+Math.random();let m=null;try{if(u&&typeof u.getBoundingClientRect=="function"){const g=u.getBoundingClientRect(),y=Math.round(g.top+g.height+8),C=Math.round(g.left+g.width/2);m={top:y,left:C}}}catch{m=null}n(g=>[...g,{id:f,message:a,type:l,pos:m}]),setTimeout(()=>{n(g=>g.filter(y=>y.id!==f))},d)},[]),o=v.useCallback(a=>{n(l=>l.filter(d=>d.id!==a))},[]);return r.jsxs(vy.Provider,{value:{showToast:s},children:[e,r.jsx("div",{className:"toast-viewport","aria-live":"polite",children:t.filter(a=>!a.pos).map(a=>r.jsxs("div",{className:`toast ${a.type}`,onClick:()=>o(a.id),children:[r.jsx("div",{className:"toast-message",children:a.message}),r.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},a.id))}),t.filter(a=>a.pos).map(a=>r.jsxs("div",{className:`toast ${a.type} anchored`,style:{position:"fixed",top:`${a.pos.top}px`,left:`${a.pos.left}px`,transform:"translateX(-50%)"},onClick:()=>o(a.id),children:[r.jsx("div",{className:"toast-message",children:a.message}),r.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},a.id))]})}function Du(){const e=v.useContext(vy);if(!e)throw new Error("useToast must be used within ToastProvider");return e}function _y(e,t){const n=v.useRef(t);v.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const Rj=1;function Aj(e){return Object.freeze({__version:Rj,map:e})}function Mj(e,t){return Object.freeze({...e,...t})}const wy=v.createContext(null),jy=wy.Provider;function zu(){const e=v.useContext(wy);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Fj(e){function t(n,s){const{instance:o,context:a}=e(n).current;return v.useImperativeHandle(s,()=>o),n.children==null?null:hr.createElement(jy,{value:a},n.children)}return v.forwardRef(t)}function Uj(e){function t(n,s){const[o,a]=v.useState(!1),{instance:l}=e(n,a).current;v.useImperativeHandle(s,()=>l),v.useEffect(function(){o&&l.update()},[l,o,n.children]);const d=l._contentNode;return d?Rg.createPortal(n.children,d):null}return v.forwardRef(t)}function Oj(e){function t(n,s){const{instance:o}=e(n).current;return v.useImperativeHandle(s,()=>o),null}return v.forwardRef(t)}function Sy(e,t){const n=v.useRef();v.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function $u(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function Dj(e,t){return function(s,o){const a=zu(),l=e($u(s,a),a);return _y(a.map,s.attribution),Sy(l.current,s.eventHandlers),t(l.current,a,s,o),l}}var Md={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,s){s(t)})(_p,function(n){var s="1.9.4";function o(i){var c,h,p,j;for(h=1,p=arguments.length;h<p;h++){j=arguments[h];for(c in j)i[c]=j[c]}return i}var a=Object.create||function(){function i(){}return function(c){return i.prototype=c,new i}}();function l(i,c){var h=Array.prototype.slice;if(i.bind)return i.bind.apply(i,h.call(arguments,1));var p=h.call(arguments,2);return function(){return i.apply(c,p.length?p.concat(h.call(arguments)):arguments)}}var d=0;function u(i){return"_leaflet_id"in i||(i._leaflet_id=++d),i._leaflet_id}function f(i,c,h){var p,j,T,O;return O=function(){p=!1,j&&(T.apply(h,j),j=!1)},T=function(){p?j=arguments:(i.apply(h,arguments),setTimeout(O,c),p=!0)},T}function m(i,c,h){var p=c[1],j=c[0],T=p-j;return i===p&&h?i:((i-j)%T+T)%T+j}function g(){return!1}function y(i,c){if(c===!1)return i;var h=Math.pow(10,c===void 0?6:c);return Math.round(i*h)/h}function C(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function N(i){return C(i).split(/\s+/)}function _(i,c){Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?a(i.options):{});for(var h in c)i.options[h]=c[h];return i.options}function b(i,c,h){var p=[];for(var j in i)p.push(encodeURIComponent(h?j.toUpperCase():j)+"="+encodeURIComponent(i[j]));return(!c||c.indexOf("?")===-1?"?":"&")+p.join("&")}var w=/\{ *([\w_ -]+) *\}/g;function x(i,c){return i.replace(w,function(h,p){var j=c[p];if(j===void 0)throw new Error("No value provided for variable "+h);return typeof j=="function"&&(j=j(c)),j})}var k=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function S(i,c){for(var h=0;h<i.length;h++)if(i[h]===c)return h;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function P(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var R=0;function B(i){var c=+new Date,h=Math.max(0,16-(c-R));return R=c+h,window.setTimeout(i,h)}var A=window.requestAnimationFrame||P("RequestAnimationFrame")||B,I=window.cancelAnimationFrame||P("CancelAnimationFrame")||P("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function M(i,c,h){if(h&&A===B)i.call(c);else return A.call(window,l(i,c))}function W(i){i&&I.call(window,i)}var V={__proto__:null,extend:o,create:a,bind:l,get lastId(){return d},stamp:u,throttle:f,wrapNum:m,falseFn:g,formatNum:y,trim:C,splitWords:N,setOptions:_,getParamString:b,template:x,isArray:k,indexOf:S,emptyImageUrl:E,requestFn:A,cancelFn:I,requestAnimFrame:M,cancelAnimFrame:W};function $(){}$.extend=function(i){var c=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,p=a(h);p.constructor=c,c.prototype=p;for(var j in this)Object.prototype.hasOwnProperty.call(this,j)&&j!=="prototype"&&j!=="__super__"&&(c[j]=this[j]);return i.statics&&o(c,i.statics),i.includes&&(Q(i.includes),o.apply(null,[p].concat(i.includes))),o(p,i),delete p.statics,delete p.includes,p.options&&(p.options=h.options?a(h.options):{},o(p.options,i.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var T=0,O=p._initHooks.length;T<O;T++)p._initHooks[T].call(this)}},c},$.include=function(i){var c=this.prototype.options;return o(this.prototype,i),i.options&&(this.prototype.options=c,this.mergeOptions(i.options)),this},$.mergeOptions=function(i){return o(this.prototype.options,i),this},$.addInitHook=function(i){var c=Array.prototype.slice.call(arguments,1),h=typeof i=="function"?i:function(){this[i].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function Q(i){if(!(typeof L>"u"||!L||!L.Mixin)){i=k(i)?i:[i];for(var c=0;c<i.length;c++)i[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ie={on:function(i,c,h){if(typeof i=="object")for(var p in i)this._on(p,i[p],c);else{i=N(i);for(var j=0,T=i.length;j<T;j++)this._on(i[j],c,h)}return this},off:function(i,c,h){if(!arguments.length)delete this._events;else if(typeof i=="object")for(var p in i)this._off(p,i[p],c);else{i=N(i);for(var j=arguments.length===1,T=0,O=i.length;T<O;T++)j?this._off(i[T]):this._off(i[T],c,h)}return this},_on:function(i,c,h,p){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(i,c,h)===!1){h===this&&(h=void 0);var j={fn:c,ctx:h};p&&(j.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(j)}},_off:function(i,c,h){var p,j,T;if(this._events&&(p=this._events[i],!!p)){if(arguments.length===1){if(this._firingCount)for(j=0,T=p.length;j<T;j++)p[j].fn=g;delete this._events[i];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var O=this._listens(i,c,h);if(O!==!1){var q=p[O];this._firingCount&&(q.fn=g,this._events[i]=p=p.slice()),p.splice(O,1)}}},fire:function(i,c,h){if(!this.listens(i,h))return this;var p=o({},c,{type:i,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var j=this._events[i];if(j){this._firingCount=this._firingCount+1||1;for(var T=0,O=j.length;T<O;T++){var q=j[T],K=q.fn;q.once&&this.off(i,K,q.ctx),K.call(q.ctx||this,p)}this._firingCount--}}return h&&this._propagateEvent(p),this},listens:function(i,c,h,p){typeof i!="string"&&console.warn('"string" type argument expected');var j=c;typeof c!="function"&&(p=!!c,j=void 0,h=void 0);var T=this._events&&this._events[i];if(T&&T.length&&this._listens(i,j,h)!==!1)return!0;if(p){for(var O in this._eventParents)if(this._eventParents[O].listens(i,c,h,p))return!0}return!1},_listens:function(i,c,h){if(!this._events)return!1;var p=this._events[i]||[];if(!c)return!!p.length;h===this&&(h=void 0);for(var j=0,T=p.length;j<T;j++)if(p[j].fn===c&&p[j].ctx===h)return j;return!1},once:function(i,c,h){if(typeof i=="object")for(var p in i)this._on(p,i[p],c,!0);else{i=N(i);for(var j=0,T=i.length;j<T;j++)this._on(i[j],c,h,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[u(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[u(i)],this},_propagateEvent:function(i){for(var c in this._eventParents)this._eventParents[c].fire(i.type,o({layer:i.target,propagatedFrom:i.target},i),!0)}};ie.addEventListener=ie.on,ie.removeEventListener=ie.clearAllEventListeners=ie.off,ie.addOneTimeEventListener=ie.once,ie.fireEvent=ie.fire,ie.hasEventListeners=ie.listens;var U=$.extend(ie);function H(i,c,h){this.x=h?Math.round(i):i,this.y=h?Math.round(c):c}var he=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(i){return this.clone()._add(ne(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(ne(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new H(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new H(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=he(this.x),this.y=he(this.y),this},distanceTo:function(i){i=ne(i);var c=i.x-this.x,h=i.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(i){return i=ne(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=ne(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ne(i,c,h){return i instanceof H?i:k(i)?new H(i[0],i[1]):i==null?i:typeof i=="object"&&"x"in i&&"y"in i?new H(i.x,i.y):new H(i,c,h)}function xe(i,c){if(i)for(var h=c?[i,c]:i,p=0,j=h.length;p<j;p++)this.extend(h[p])}xe.prototype={extend:function(i){var c,h;if(!i)return this;if(i instanceof H||typeof i[0]=="number"||"x"in i)c=h=ne(i);else if(i=ve(i),c=i.min,h=i.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(i){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var c,h;return typeof i[0]=="number"||i instanceof H?i=ne(i):i=ve(i),i instanceof xe?(c=i.min,h=i.max):c=h=i,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(i){i=ve(i);var c=this.min,h=this.max,p=i.min,j=i.max,T=j.x>=c.x&&p.x<=h.x,O=j.y>=c.y&&p.y<=h.y;return T&&O},overlaps:function(i){i=ve(i);var c=this.min,h=this.max,p=i.min,j=i.max,T=j.x>c.x&&p.x<h.x,O=j.y>c.y&&p.y<h.y;return T&&O},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var c=this.min,h=this.max,p=Math.abs(c.x-h.x)*i,j=Math.abs(c.y-h.y)*i;return ve(ne(c.x-p,c.y-j),ne(h.x+p,h.y+j))},equals:function(i){return i?(i=ve(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight())):!1}};function ve(i,c){return!i||i instanceof xe?i:new xe(i,c)}function oe(i,c){if(i)for(var h=c?[i,c]:i,p=0,j=h.length;p<j;p++)this.extend(h[p])}oe.prototype={extend:function(i){var c=this._southWest,h=this._northEast,p,j;if(i instanceof ee)p=i,j=i;else if(i instanceof oe){if(p=i._southWest,j=i._northEast,!p||!j)return this}else return i?this.extend(G(i)||D(i)):this;return!c&&!h?(this._southWest=new ee(p.lat,p.lng),this._northEast=new ee(j.lat,j.lng)):(c.lat=Math.min(p.lat,c.lat),c.lng=Math.min(p.lng,c.lng),h.lat=Math.max(j.lat,h.lat),h.lng=Math.max(j.lng,h.lng)),this},pad:function(i){var c=this._southWest,h=this._northEast,p=Math.abs(c.lat-h.lat)*i,j=Math.abs(c.lng-h.lng)*i;return new oe(new ee(c.lat-p,c.lng-j),new ee(h.lat+p,h.lng+j))},getCenter:function(){return new ee((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ee(this.getNorth(),this.getWest())},getSouthEast:function(){return new ee(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){typeof i[0]=="number"||i instanceof ee||"lat"in i?i=G(i):i=D(i);var c=this._southWest,h=this._northEast,p,j;return i instanceof oe?(p=i.getSouthWest(),j=i.getNorthEast()):p=j=i,p.lat>=c.lat&&j.lat<=h.lat&&p.lng>=c.lng&&j.lng<=h.lng},intersects:function(i){i=D(i);var c=this._southWest,h=this._northEast,p=i.getSouthWest(),j=i.getNorthEast(),T=j.lat>=c.lat&&p.lat<=h.lat,O=j.lng>=c.lng&&p.lng<=h.lng;return T&&O},overlaps:function(i){i=D(i);var c=this._southWest,h=this._northEast,p=i.getSouthWest(),j=i.getNorthEast(),T=j.lat>c.lat&&p.lat<h.lat,O=j.lng>c.lng&&p.lng<h.lng;return T&&O},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,c){return i?(i=D(i),this._southWest.equals(i.getSouthWest(),c)&&this._northEast.equals(i.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function D(i,c){return i instanceof oe?i:new oe(i,c)}function ee(i,c,h){if(isNaN(i)||isNaN(c))throw new Error("Invalid LatLng object: ("+i+", "+c+")");this.lat=+i,this.lng=+c,h!==void 0&&(this.alt=+h)}ee.prototype={equals:function(i,c){if(!i)return!1;i=G(i);var h=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return h<=(c===void 0?1e-9:c)},toString:function(i){return"LatLng("+y(this.lat,i)+", "+y(this.lng,i)+")"},distanceTo:function(i){return Ie.distance(this,G(i))},wrap:function(){return Ie.wrapLatLng(this)},toBounds:function(i){var c=180*i/40075017,h=c/Math.cos(Math.PI/180*this.lat);return D([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new ee(this.lat,this.lng,this.alt)}};function G(i,c,h){return i instanceof ee?i:k(i)&&typeof i[0]!="object"?i.length===3?new ee(i[0],i[1],i[2]):i.length===2?new ee(i[0],i[1]):null:i==null?i:typeof i=="object"&&"lat"in i?new ee(i.lat,"lng"in i?i.lng:i.lon,i.alt):c===void 0?null:new ee(i,c,h)}var _e={latLngToPoint:function(i,c){var h=this.projection.project(i),p=this.scale(c);return this.transformation._transform(h,p)},pointToLatLng:function(i,c){var h=this.scale(c),p=this.transformation.untransform(i,h);return this.projection.unproject(p)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(i),p=this.transformation.transform(c.min,h),j=this.transformation.transform(c.max,h);return new xe(p,j)},infinite:!1,wrapLatLng:function(i){var c=this.wrapLng?m(i.lng,this.wrapLng,!0):i.lng,h=this.wrapLat?m(i.lat,this.wrapLat,!0):i.lat,p=i.alt;return new ee(h,c,p)},wrapLatLngBounds:function(i){var c=i.getCenter(),h=this.wrapLatLng(c),p=c.lat-h.lat,j=c.lng-h.lng;if(p===0&&j===0)return i;var T=i.getSouthWest(),O=i.getNorthEast(),q=new ee(T.lat-p,T.lng-j),K=new ee(O.lat-p,O.lng-j);return new oe(q,K)}},Ie=o({},_e,{wrapLng:[-180,180],R:6371e3,distance:function(i,c){var h=Math.PI/180,p=i.lat*h,j=c.lat*h,T=Math.sin((c.lat-i.lat)*h/2),O=Math.sin((c.lng-i.lng)*h/2),q=T*T+Math.cos(p)*Math.cos(j)*O*O,K=2*Math.atan2(Math.sqrt(q),Math.sqrt(1-q));return this.R*K}}),Ce=6378137,we={R:Ce,MAX_LATITUDE:85.0511287798,project:function(i){var c=Math.PI/180,h=this.MAX_LATITUDE,p=Math.max(Math.min(h,i.lat),-h),j=Math.sin(p*c);return new H(this.R*i.lng*c,this.R*Math.log((1+j)/(1-j))/2)},unproject:function(i){var c=180/Math.PI;return new ee((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*c,i.x*c/this.R)},bounds:function(){var i=Ce*Math.PI;return new xe([-i,-i],[i,i])}()};function ze(i,c,h,p){if(k(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=c,this._c=h,this._d=p}ze.prototype={transform:function(i,c){return this._transform(i.clone(),c)},_transform:function(i,c){return c=c||1,i.x=c*(this._a*i.x+this._b),i.y=c*(this._c*i.y+this._d),i},untransform:function(i,c){return c=c||1,new H((i.x/c-this._b)/this._a,(i.y/c-this._d)/this._c)}};function me(i,c,h,p){return new ze(i,c,h,p)}var nt=o({},Ie,{code:"EPSG:3857",projection:we,transformation:function(){var i=.5/(Math.PI*we.R);return me(i,.5,-i,.5)}()}),gn=o({},nt,{code:"EPSG:900913"});function fe(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function ae(i,c){var h="",p,j,T,O,q,K;for(p=0,T=i.length;p<T;p++){for(q=i[p],j=0,O=q.length;j<O;j++)K=q[j],h+=(j?"L":"M")+K.x+" "+K.y;h+=c?F.svg?"z":"x":""}return h||"M0 0"}var le=document.documentElement.style,ye="ActiveXObject"in window,ue=ye&&!document.addEventListener,Ne="msLaunchUri"in navigator&&!("documentMode"in document),Qe=ge("webkit"),Jn=ge("android"),be=ge("android 2")||ge("android 3"),z=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ye=Jn&&ge("Google")&&z<537&&!("AudioNode"in window),He=!!window.opera,Pe=!Ne&&ge("chrome"),X=ge("gecko")&&!Qe&&!He&&!ye,Be=!Pe&&ge("safari"),rt=ge("phantom"),Ot="OTransition"in le,Cn=navigator.platform.indexOf("Win")===0,Ae=ye&&"transition"in le,Bt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!be,pr="MozPerspective"in le,Ur=!window.L_DISABLE_3D&&(Ae||Bt||pr)&&!Ot&&!rt,Pt=typeof orientation<"u"||ge("mobile"),et=Pt&&Qe,mr=Pt&&Bt,Mn=!window.PointerEvent&&window.MSPointerEvent,Vi=!!(window.PointerEvent||Mn),Y="ontouchstart"in window||!!window.TouchEvent,re=!window.L_NO_TOUCH&&(Y||Vi),se=Pt&&He,ce=Pt&&X,Ee=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Me=function(){var i=!1;try{var c=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return i}(),je=function(){return!!document.createElement("canvas").getContext}(),it=!!(document.createElementNS&&fe("svg").createSVGRect),pt=!!it&&function(){var i=document.createElement("div");return i.innerHTML="<svg/>",(i.firstChild&&i.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Z=!it&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var c=i.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Re=navigator.platform.indexOf("Mac")===0,$e=navigator.platform.indexOf("Linux")===0;function ge(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var F={ie:ye,ielt9:ue,edge:Ne,webkit:Qe,android:Jn,android23:be,androidStock:Ye,opera:He,chrome:Pe,gecko:X,safari:Be,phantom:rt,opera12:Ot,win:Cn,ie3d:Ae,webkit3d:Bt,gecko3d:pr,any3d:Ur,mobile:Pt,mobileWebkit:et,mobileWebkit3d:mr,msPointer:Mn,pointer:Vi,touch:re,touchNative:Y,mobileOpera:se,mobileGecko:ce,retina:Ee,passiveEvents:Me,canvas:je,svg:it,vml:Z,inlineSvg:pt,mac:Re,linux:$e},qe=F.msPointer?"MSPointerDown":"pointerdown",lt=F.msPointer?"MSPointerMove":"pointermove",Le=F.msPointer?"MSPointerUp":"pointerup",yt=F.msPointer?"MSPointerCancel":"pointercancel",Ht={touchstart:qe,touchmove:lt,touchend:Le,touchcancel:yt},Qt={touchstart:yi,touchmove:gr,touchend:gr,touchcancel:gr},Zt={},Qn=!1;function Xt(i,c,h){return c==="touchstart"&&qi(),Qt[c]?(h=Qt[c].bind(this,h),i.addEventListener(Ht[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function kt(i,c,h){if(!Ht[c]){console.warn("wrong event specified:",c);return}i.removeEventListener(Ht[c],h,!1)}function bt(i){Zt[i.pointerId]=i}function Fn(i){Zt[i.pointerId]&&(Zt[i.pointerId]=i)}function gi(i){delete Zt[i.pointerId]}function qi(){Qn||(document.addEventListener(qe,bt,!0),document.addEventListener(lt,Fn,!0),document.addEventListener(Le,gi,!0),document.addEventListener(yt,gi,!0),Qn=!0)}function gr(i,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in Zt)c.touches.push(Zt[h]);c.changedTouches=[c],i(c)}}function yi(i,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Dt(c),gr(i,c)}function xi(i){var c={},h,p;for(p in i)h=i[p],c[p]=h&&h.bind?h.bind(i):h;return i=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var vi=200;function _i(i,c){i.addEventListener("dblclick",c);var h=0,p;function j(T){if(T.detail!==1){p=T.detail;return}if(!(T.pointerType==="mouse"||T.sourceCapabilities&&!T.sourceCapabilities.firesTouchEvents)){var O=Gu(T);if(!(O.some(function(K){return K instanceof HTMLLabelElement&&K.attributes.for})&&!O.some(function(K){return K instanceof HTMLInputElement||K instanceof HTMLSelectElement}))){var q=Date.now();q-h<=vi?(p++,p===2&&c(xi(T))):p=1,h=q}}}return i.addEventListener("click",j),{dblclick:c,simDblclick:j}}function wi(i,c){i.removeEventListener("dblclick",c.dblclick),i.removeEventListener("click",c.simDblclick)}var yr=tr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Un=tr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Or=Un==="webkitTransition"||Un==="OTransition"?Un+"End":"transitionend";function Dr(i){return typeof i=="string"?document.getElementById(i):i}function On(i,c){var h=i.style[c]||i.currentStyle&&i.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(i,null);h=p?p[c]:null}return h==="auto"?null:h}function Ze(i,c,h){var p=document.createElement(i);return p.className=c||"",h&&h.appendChild(p),p}function st(i){var c=i.parentNode;c&&c.removeChild(i)}function Xn(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function Nn(i){var c=i.parentNode;c&&c.lastChild!==i&&c.appendChild(i)}function kn(i){var c=i.parentNode;c&&c.firstChild!==i&&c.insertBefore(i,c.firstChild)}function xr(i,c){if(i.classList!==void 0)return i.classList.contains(c);var h=er(i);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function Ue(i,c){if(i.classList!==void 0)for(var h=N(c),p=0,j=h.length;p<j;p++)i.classList.add(h[p]);else if(!xr(i,c)){var T=er(i);vr(i,(T?T+" ":"")+c)}}function ct(i,c){i.classList!==void 0?i.classList.remove(c):vr(i,C((" "+er(i)+" ").replace(" "+c+" "," ")))}function vr(i,c){i.className.baseVal===void 0?i.className=c:i.className.baseVal=c}function er(i){return i.correspondingElement&&(i=i.correspondingElement),i.className.baseVal===void 0?i.className:i.className.baseVal}function Rt(i,c){"opacity"in i.style?i.style.opacity=c:"filter"in i.style&&ji(i,c)}function ji(i,c){var h=!1,p="DXImageTransform.Microsoft.Alpha";try{h=i.filters.item(p)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):i.style.filter+=" progid:"+p+"(opacity="+c+")"}function tr(i){for(var c=document.documentElement.style,h=0;h<i.length;h++)if(i[h]in c)return i[h];return!1}function Ke(i,c,h){var p=c||new H(0,0);i.style[yr]=(F.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(h?" scale("+h+")":"")}function dt(i,c){i._leaflet_pos=c,F.any3d?Ke(i,c):(i.style.left=c.x+"px",i.style.top=c.y+"px")}function nr(i){return i._leaflet_pos||new H(0,0)}var zr,$r,Gi;if("onselectstart"in document)zr=function(){Oe(window,"selectstart",Dt)},$r=function(){at(window,"selectstart",Dt)};else{var Wr=tr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);zr=function(){if(Wr){var i=document.documentElement.style;Gi=i[Wr],i[Wr]="none"}},$r=function(){Wr&&(document.documentElement.style[Wr]=Gi,Gi=void 0)}}function Yi(){Oe(window,"dragstart",Dt)}function Ki(){at(window,"dragstart",Dt)}var Si,Ji;function Qi(i){for(;i.tabIndex===-1;)i=i.parentNode;i.style&&(Ci(),Si=i,Ji=i.style.outlineStyle,i.style.outlineStyle="none",Oe(window,"keydown",Ci))}function Ci(){Si&&(Si.style.outlineStyle=Ji,Si=void 0,Ji=void 0,at(window,"keydown",Ci))}function Ws(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body);return i}function Xi(i){var c=i.getBoundingClientRect();return{x:c.width/i.offsetWidth||1,y:c.height/i.offsetHeight||1,boundingClientRect:c}}var Ja={__proto__:null,TRANSFORM:yr,TRANSITION:Un,TRANSITION_END:Or,get:Dr,getStyle:On,create:Ze,remove:st,empty:Xn,toFront:Nn,toBack:kn,hasClass:xr,addClass:Ue,removeClass:ct,setClass:vr,getClass:er,setOpacity:Rt,testProp:tr,setTransform:Ke,setPosition:dt,getPosition:nr,get disableTextSelection(){return zr},get enableTextSelection(){return $r},disableImageDrag:Yi,enableImageDrag:Ki,preventOutline:Qi,restoreOutline:Ci,getSizedParentNode:Ws,getScale:Xi};function Oe(i,c,h,p){if(c&&typeof c=="object")for(var j in c)ts(i,j,c[j],h);else{c=N(c);for(var T=0,O=c.length;T<O;T++)ts(i,c[T],h,p)}return this}var yn="_leaflet_events";function at(i,c,h,p){if(arguments.length===1)Hs(i),delete i[yn];else if(c&&typeof c=="object")for(var j in c)ns(i,j,c[j],h);else if(c=N(c),arguments.length===2)Hs(i,function(q){return S(c,q)!==-1});else for(var T=0,O=c.length;T<O;T++)ns(i,c[T],h,p);return this}function Hs(i,c){for(var h in i[yn]){var p=h.split(/\d/)[0];(!c||c(p))&&ns(i,p,null,null,h)}}var es={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ts(i,c,h,p){var j=c+u(h)+(p?"_"+u(p):"");if(i[yn]&&i[yn][j])return this;var T=function(q){return h.call(p||i,q||window.event)},O=T;!F.touchNative&&F.pointer&&c.indexOf("touch")===0?T=Xt(i,c,T):F.touch&&c==="dblclick"?T=_i(i,T):"addEventListener"in i?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?i.addEventListener(es[c]||c,T,F.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(T=function(q){q=q||window.event,Dl(i,q)&&O(q)},i.addEventListener(es[c],T,!1)):i.addEventListener(c,O,!1):i.attachEvent("on"+c,T),i[yn]=i[yn]||{},i[yn][j]=T}function ns(i,c,h,p,j){j=j||c+u(h)+(p?"_"+u(p):"");var T=i[yn]&&i[yn][j];if(!T)return this;!F.touchNative&&F.pointer&&c.indexOf("touch")===0?kt(i,c,T):F.touch&&c==="dblclick"?wi(i,T):"removeEventListener"in i?i.removeEventListener(es[c]||c,T,!1):i.detachEvent("on"+c,T),i[yn][j]=null}function rr(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function St(i){return ts(i,"wheel",rr),this}function Zs(i){return Oe(i,"mousedown touchstart dblclick contextmenu",rr),i._leaflet_disable_click=!0,this}function Dt(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function Ni(i){return Dt(i),rr(i),this}function Gu(i){if(i.composedPath)return i.composedPath();for(var c=[],h=i.target;h;)c.push(h),h=h.parentNode;return c}function Yu(i,c){if(!c)return new H(i.clientX,i.clientY);var h=Xi(c),p=h.boundingClientRect;return new H((i.clientX-p.left)/h.x-c.clientLeft,(i.clientY-p.top)/h.y-c.clientTop)}var By=F.linux&&F.chrome?window.devicePixelRatio:F.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ku(i){return F.edge?i.wheelDeltaY/2:i.deltaY&&i.deltaMode===0?-i.deltaY/By:i.deltaY&&i.deltaMode===1?-i.deltaY*20:i.deltaY&&i.deltaMode===2?-i.deltaY*60:i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&Math.abs(i.detail)<32765?-i.detail*20:i.detail?i.detail/-32765*60:0}function Dl(i,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==i;)h=h.parentNode}catch{return!1}return h!==i}var Ry={__proto__:null,on:Oe,off:at,stopPropagation:rr,disableScrollPropagation:St,disableClickPropagation:Zs,preventDefault:Dt,stop:Ni,getPropagationPath:Gu,getMousePosition:Yu,getWheelDelta:Ku,isExternalTarget:Dl,addListener:Oe,removeListener:at},Ju=U.extend({run:function(i,c,h,p){this.stop(),this._el=i,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=nr(i),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(i){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),i):(this._runFrame(1),this._complete())},_runFrame:function(i,c){var h=this._startPos.add(this._offset.multiplyBy(i));c&&h._round(),dt(this._el,h),this.fire("step")},_complete:function(){W(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),Je=U.extend({options:{crs:nt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,c){c=_(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(G(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Un&&F.any3d&&!F.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Oe(this._proxy,Or,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),i=this._limitCenter(G(i),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=o({animate:h.animate},h.zoom),h.pan=o({animate:h.animate,duration:h.duration},h.pan));var p=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,c,h.zoom):this._tryAnimatedPan(i,h.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(i,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(i,c){return this._loaded?this.setView(this.getCenter(),i,{zoom:c}):(this._zoom=i,this)},zoomIn:function(i,c){return i=i||(F.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,c)},zoomOut:function(i,c){return i=i||(F.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,c)},setZoomAround:function(i,c,h){var p=this.getZoomScale(c),j=this.getSize().divideBy(2),T=i instanceof H?i:this.latLngToContainerPoint(i),O=T.subtract(j).multiplyBy(1-1/p),q=this.containerPointToLatLng(j.add(O));return this.setView(q,c,{zoom:h})},_getBoundsCenterZoom:function(i,c){c=c||{},i=i.getBounds?i.getBounds():D(i);var h=ne(c.paddingTopLeft||c.padding||[0,0]),p=ne(c.paddingBottomRight||c.padding||[0,0]),j=this.getBoundsZoom(i,!1,h.add(p));if(j=typeof c.maxZoom=="number"?Math.min(c.maxZoom,j):j,j===1/0)return{center:i.getCenter(),zoom:j};var T=p.subtract(h).divideBy(2),O=this.project(i.getSouthWest(),j),q=this.project(i.getNorthEast(),j),K=this.unproject(O.add(q).divideBy(2).add(T),j);return{center:K,zoom:j}},fitBounds:function(i,c){if(i=D(i),!i.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(i,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,c){return this.setView(i,this._zoom,{pan:c})},panBy:function(i,c){if(i=ne(i).round(),c=c||{},!i.x&&!i.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ju,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){Ue(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,c,h){if(h=h||{},h.animate===!1||!F.any3d)return this.setView(i,c,h);this._stop();var p=this.project(this.getCenter()),j=this.project(i),T=this.getSize(),O=this._zoom;i=G(i),c=c===void 0?O:c;var q=Math.max(T.x,T.y),K=q*this.getZoomScale(O,c),de=j.distanceTo(p)||1,Se=1.42,Fe=Se*Se;function Ve(It){var co=It?-1:1,jx=It?K:q,Sx=K*K-q*q+co*Fe*Fe*de*de,Cx=2*jx*Fe*de,Jl=Sx/Cx,Eh=Math.sqrt(Jl*Jl+1)-Jl,Nx=Eh<1e-9?-18:Math.log(Eh);return Nx}function en(It){return(Math.exp(It)-Math.exp(-It))/2}function At(It){return(Math.exp(It)+Math.exp(-It))/2}function In(It){return en(It)/At(It)}var ln=Ve(0);function ls(It){return q*(At(ln)/At(ln+Se*It))}function xx(It){return q*(At(ln)*In(ln+Se*It)-en(ln))/Fe}function vx(It){return 1-Math.pow(1-It,1.5)}var _x=Date.now(),Lh=(Ve(1)-ln)/Se,wx=h.duration?1e3*h.duration:1e3*Lh*.8;function Ph(){var It=(Date.now()-_x)/wx,co=vx(It)*Lh;It<=1?(this._flyToFrame=M(Ph,this),this._move(this.unproject(p.add(j.subtract(p).multiplyBy(xx(co)/de)),O),this.getScaleZoom(q/ls(co),O),{flyTo:!0})):this._move(i,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Ph.call(this),this},flyToBounds:function(i,c){var h=this._getBoundsCenterZoom(i,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(i){return i=D(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid()?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var c=this.options.minZoom;return this.options.minZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(i):this},setMaxZoom:function(i){var c=this.options.maxZoom;return this.options.maxZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(i):this},panInsideBounds:function(i,c){this._enforcingBounds=!0;var h=this.getCenter(),p=this._limitCenter(h,this._zoom,D(i));return h.equals(p)||this.panTo(p,c),this._enforcingBounds=!1,this},panInside:function(i,c){c=c||{};var h=ne(c.paddingTopLeft||c.padding||[0,0]),p=ne(c.paddingBottomRight||c.padding||[0,0]),j=this.project(this.getCenter()),T=this.project(i),O=this.getPixelBounds(),q=ve([O.min.add(h),O.max.subtract(p)]),K=q.getSize();if(!q.contains(T)){this._enforcingBounds=!0;var de=T.subtract(q.getCenter()),Se=q.extend(T).getSize().subtract(K);j.x+=de.x<0?-Se.x:Se.x,j.y+=de.y<0?-Se.y:Se.y,this.panTo(this.unproject(j),c),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=o({animate:!1,pan:!0},i===!0?{animate:!0}:i);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),p=c.divideBy(2).round(),j=h.divideBy(2).round(),T=p.subtract(j);return!T.x&&!T.y?this:(i.animate&&i.pan?this.panBy(T):(i.pan&&this._rawPanBy(T),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=o({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,i):navigator.geolocation.getCurrentPosition(c,h,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var c=i.code,h=i.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var c=i.coords.latitude,h=i.coords.longitude,p=new ee(c,h),j=p.toBounds(i.coords.accuracy*2),T=this._locateOptions;if(T.setView){var O=this.getBoundsZoom(j);this.setView(p,T.maxZoom?Math.min(O,T.maxZoom):O)}var q={latlng:p,bounds:j,timestamp:i.timestamp};for(var K in i.coords)typeof i.coords[K]=="number"&&(q[K]=i.coords[K]);this.fire("locationfound",q)}},addHandler:function(i,c){if(!c)return this;var h=this[i]=new c(this);return this._handlers.push(h),this.options[i]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),st(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(W(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)st(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,c){var h="leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),p=Ze("div",h,c||this._mapPane);return i&&(this._panes[i]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),c=this.unproject(i.getBottomLeft()),h=this.unproject(i.getTopRight());return new oe(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,c,h){i=D(i),h=ne(h||[0,0]);var p=this.getZoom()||0,j=this.getMinZoom(),T=this.getMaxZoom(),O=i.getNorthWest(),q=i.getSouthEast(),K=this.getSize().subtract(h),de=ve(this.project(q,p),this.project(O,p)).getSize(),Se=F.any3d?this.options.zoomSnap:1,Fe=K.x/de.x,Ve=K.y/de.y,en=c?Math.max(Fe,Ve):Math.min(Fe,Ve);return p=this.getScaleZoom(en,p),Se&&(p=Math.round(p/(Se/100))*(Se/100),p=c?Math.ceil(p/Se)*Se:Math.floor(p/Se)*Se),Math.max(j,Math.min(T,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,c){var h=this._getTopLeftPoint(i,c);return new xe(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(i===void 0?this.getZoom():i)},getPane:function(i){return typeof i=="string"?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(i)/h.scale(c)},getScaleZoom:function(i,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var p=h.zoom(i*h.scale(c));return isNaN(p)?1/0:p},project:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(G(i),c)},unproject:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ne(i),c)},layerPointToLatLng:function(i){var c=ne(i).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(i){var c=this.project(G(i))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(G(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(D(i))},distance:function(i,c){return this.options.crs.distance(G(i),G(c))},containerPointToLayerPoint:function(i){return ne(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return ne(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var c=this.containerPointToLayerPoint(ne(i));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(i)))},mouseEventToContainerPoint:function(i){return Yu(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var c=this._container=Dr(i);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Oe(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&F.any3d,Ue(i,"leaflet-container"+(F.touch?" leaflet-touch":"")+(F.retina?" leaflet-retina":"")+(F.ielt9?" leaflet-oldie":"")+(F.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=On(i,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),dt(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ue(i.markerPane,"leaflet-zoom-hide"),Ue(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,c,h){dt(this._mapPane,new H(0,0));var p=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var j=this._zoom!==c;this._moveStart(j,h)._move(i,c)._moveEnd(j),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(i,c){return i&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(i,c,h,p){c===void 0&&(c=this._zoom);var j=this._zoom!==c;return this._zoom=c,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),p?h&&h.pinch&&this.fire("zoom",h):((j||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return W(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){dt(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[u(this._container)]=this;var c=i?at:Oe;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),F.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){W(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,c){for(var h=[],p,j=c==="mouseout"||c==="mouseover",T=i.target||i.srcElement,O=!1;T;){if(p=this._targets[u(T)],p&&(c==="click"||c==="preclick")&&this._draggableMoved(p)){O=!0;break}if(p&&p.listens(c,!0)&&(j&&!Dl(T,i)||(h.push(p),j))||T===this._container)break;T=T.parentNode}return!h.length&&!O&&!j&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var c=i.target||i.srcElement;if(!(!this._loaded||c._leaflet_disable_events||i.type==="click"&&this._isClickDisabled(c))){var h=i.type;h==="mousedown"&&Qi(c),this._fireDOMEvent(i,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,c,h){if(i.type==="click"){var p=o({},i);p.type="preclick",this._fireDOMEvent(p,p.type,h)}var j=this._findEventTargets(i,c);if(h){for(var T=[],O=0;O<h.length;O++)h[O].listens(c,!0)&&T.push(h[O]);j=T.concat(j)}if(j.length){c==="contextmenu"&&Dt(i);var q=j[0],K={originalEvent:i};if(i.type!=="keypress"&&i.type!=="keydown"&&i.type!=="keyup"){var de=q.getLatLng&&(!q._radius||q._radius<=10);K.containerPoint=de?this.latLngToContainerPoint(q.getLatLng()):this.mouseEventToContainerPoint(i),K.layerPoint=this.containerPointToLayerPoint(K.containerPoint),K.latlng=de?q.getLatLng():this.layerPointToLatLng(K.layerPoint)}for(O=0;O<j.length;O++)if(j[O].fire(c,K,!0),K.originalEvent._stopped||j[O].options.bubblingMouseEvents===!1&&S(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(i){return i=i.dragging&&i.dragging.enabled()?i:this,i.dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,c=this._handlers.length;i<c;i++)this._handlers[i].disable()},whenReady:function(i,c){return this._loaded?i.call(c||this,{target:this}):this.on("load",i,c),this},_getMapPanePos:function(){return nr(this._mapPane)||new H(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,c){var h=i&&c!==void 0?this._getNewPixelOrigin(i,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,c){var h=this.getSize()._divideBy(2);return this.project(i,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,c,h){var p=this._getNewPixelOrigin(h,c);return this.project(i,c)._subtract(p)},_latLngBoundsToNewLayerBounds:function(i,c,h){var p=this._getNewPixelOrigin(h,c);return ve([this.project(i.getSouthWest(),c)._subtract(p),this.project(i.getNorthWest(),c)._subtract(p),this.project(i.getSouthEast(),c)._subtract(p),this.project(i.getNorthEast(),c)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,c,h){if(!h)return i;var p=this.project(i,c),j=this.getSize().divideBy(2),T=new xe(p.subtract(j),p.add(j)),O=this._getBoundsOffset(T,h,c);return Math.abs(O.x)<=1&&Math.abs(O.y)<=1?i:this.unproject(p.add(O),c)},_limitOffset:function(i,c){if(!c)return i;var h=this.getPixelBounds(),p=new xe(h.min.add(i),h.max.add(i));return i.add(this._getBoundsOffset(p,c))},_getBoundsOffset:function(i,c,h){var p=ve(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),j=p.min.subtract(i.min),T=p.max.subtract(i.max),O=this._rebound(j.x,-T.x),q=this._rebound(j.y,-T.y);return new H(O,q)},_rebound:function(i,c){return i+c>0?Math.round(i-c)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(c))},_limitZoom:function(i){var c=this.getMinZoom(),h=this.getMaxZoom(),p=F.any3d?this.options.zoomSnap:1;return p&&(i=Math.round(i/p)*p),Math.max(c,Math.min(h,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ct(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,c){var h=this._getCenterOffset(i)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var i=this._proxy=Ze("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(c){var h=yr,p=this._proxy.style[h];Ke(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),p===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){st(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),c=this.getZoom();Ke(this._proxy,this.project(i,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(c),j=this._getCenterOffset(i)._divideBy(1-1/p);return h.animate!==!0&&!this.getSize().contains(j)?!1:(M(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(i,c,!0)},this),!0)},_animateZoom:function(i,c,h,p){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=c,Ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:c,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ct(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ay(i,c){return new Je(i,c)}var Dn=$.extend({options:{position:"topright"},initialize:function(i){_(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var c=this._map;return c&&c.removeControl(this),this.options.position=i,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var c=this._container=this.onAdd(i),h=this.getPosition(),p=i._controlCorners[h];return Ue(c,"leaflet-control"),h.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(st(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),Vs=function(i){return new Dn(i)};Je.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},c="leaflet-",h=this._controlContainer=Ze("div",c+"control-container",this._container);function p(j,T){var O=c+j+" "+c+T;i[j+T]=Ze("div",O,h)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)st(this._controlCorners[i]);st(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Qu=Dn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,c,h,p){return h<p?-1:p<h?1:0}},initialize:function(i,c,h){_(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in i)this._addLayer(i[p],p);for(p in c)this._addLayer(c[p],p,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return Dn.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,c){return this._addLayer(i,c),this._map?this._update():this},addOverlay:function(i,c){return this._addLayer(i,c,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(i));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){Ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(Ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):ct(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ct(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",c=this._container=Ze("div",i),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Zs(c),St(c);var p=this._section=Ze("section",i+"-list");h&&(this._map.on("click",this.collapse,this),Oe(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var j=this._layersLink=Ze("a",i+"-toggle",c);j.href="#",j.title="Layers",j.setAttribute("role","button"),Oe(j,{keydown:function(T){T.keyCode===13&&this._expandSafely()},click:function(T){Dt(T),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=Ze("div",i+"-base",p),this._separator=Ze("div",i+"-separator",p),this._overlaysList=Ze("div",i+"-overlays",p),c.appendChild(p)},_getLayer:function(i){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===i)return this._layers[c]},_addLayer:function(i,c,h){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(p,j){return this.options.sortFunction(p.layer,j.layer,p.name,j.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xn(this._baseLayersList),Xn(this._overlaysList),this._layerControlInputs=[];var i,c,h,p,j=0;for(h=0;h<this._layers.length;h++)p=this._layers[h],this._addItem(p),c=c||p.overlay,i=i||!p.overlay,j+=p.overlay?0:1;return this.options.hideSingleBase&&(i=i&&j>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=c&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var c=this._getLayer(u(i.target)),h=c.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(i,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(c?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=h,p.firstChild},_addItem:function(i){var c=document.createElement("label"),h=this._map.hasLayer(i.layer),p;i.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=h):p=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(p),p.layerId=u(i.layer),Oe(p,"click",this._onInputClick,this);var j=document.createElement("span");j.innerHTML=" "+i.name;var T=document.createElement("span");c.appendChild(T),T.appendChild(p),T.appendChild(j);var O=i.overlay?this._overlaysList:this._baseLayersList;return O.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var i=this._layerControlInputs,c,h,p=[],j=[];this._handlingClick=!0;for(var T=i.length-1;T>=0;T--)c=i[T],h=this._getLayer(c.layerId).layer,c.checked?p.push(h):c.checked||j.push(h);for(T=0;T<j.length;T++)this._map.hasLayer(j[T])&&this._map.removeLayer(j[T]);for(T=0;T<p.length;T++)this._map.hasLayer(p[T])||this._map.addLayer(p[T]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i=this._layerControlInputs,c,h,p=this._map.getZoom(),j=i.length-1;j>=0;j--)c=i[j],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&p<h.options.minZoom||h.options.maxZoom!==void 0&&p>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,Oe(i,"click",Dt),this.expand();var c=this;setTimeout(function(){at(i,"click",Dt),c._preventClick=!1})}}),My=function(i,c,h){return new Qu(i,c,h)},zl=Dn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var c="leaflet-control-zoom",h=Ze("div",c+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,c,h,p,j){var T=Ze("a",h,p);return T.innerHTML=i,T.href="#",T.title=c,T.setAttribute("role","button"),T.setAttribute("aria-label",c),Zs(T),Oe(T,"click",Ni),Oe(T,"click",j,this),Oe(T,"click",this._refocusOnMap,this),T},_updateDisabled:function(){var i=this._map,c="leaflet-disabled";ct(this._zoomInButton,c),ct(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(Ue(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(Ue(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Je.mergeOptions({zoomControl:!0}),Je.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zl,this.addControl(this.zoomControl))});var Fy=function(i){return new zl(i)},Xu=Dn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var c="leaflet-control-scale",h=Ze("div",c),p=this.options;return this._addScales(p,c+"-line",h),i.on(p.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),h},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,c,h){i.metric&&(this._mScale=Ze("div",c,h)),i.imperial&&(this._iScale=Ze("div",c,h))},_update:function(){var i=this._map,c=i.getSize().y/2,h=i.distance(i.containerPointToLatLng([0,c]),i.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var c=this._getRoundNum(i),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/i)},_updateImperial:function(i){var c=i*3.2808399,h,p,j;c>5280?(h=c/5280,p=this._getRoundNum(h),this._updateScale(this._iScale,p+" mi",p/h)):(j=this._getRoundNum(c),this._updateScale(this._iScale,j+" ft",j/c))},_updateScale:function(i,c,h){i.style.width=Math.round(this.options.maxWidth*h)+"px",i.innerHTML=c},_getRoundNum:function(i){var c=Math.pow(10,(Math.floor(i)+"").length-1),h=i/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),Uy=function(i){return new Xu(i)},Oy='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',$l=Dn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(F.inlineSvg?Oy+" ":"")+"Leaflet</a>"},initialize:function(i){_(this,i),this._attributions={}},onAdd:function(i){i.attributionControl=this,this._container=Ze("div","leaflet-control-attribution"),Zs(this._container);for(var c in i._layers)i._layers[c].getAttribution&&this.addAttribution(i._layers[c].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i?(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update(),this):this},removeAttribution:function(i){return i?(this._attributions[i]&&(this._attributions[i]--,this._update()),this):this},_update:function(){if(this._map){var i=[];for(var c in this._attributions)this._attributions[c]&&i.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),i.length&&h.push(i.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});Je.mergeOptions({attributionControl:!0}),Je.addInitHook(function(){this.options.attributionControl&&new $l().addTo(this)});var Dy=function(i){return new $l(i)};Dn.Layers=Qu,Dn.Zoom=zl,Dn.Scale=Xu,Dn.Attribution=$l,Vs.layers=My,Vs.zoom=Fy,Vs.scale=Uy,Vs.attribution=Dy;var ir=$.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ir.addTo=function(i,c){return i.addHandler(c,this),this};var zy={Events:ie},eh=F.touch?"touchstart mousedown":"mousedown",Hr=U.extend({options:{clickTolerance:3},initialize:function(i,c,h,p){_(this,p),this._element=i,this._dragStartTarget=c||i,this._preventOutline=h},enable:function(){this._enabled||(Oe(this._dragStartTarget,eh,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Hr._dragging===this&&this.finishDrag(!0),at(this._dragStartTarget,eh,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(this._enabled&&(this._moved=!1,!xr(this._element,"leaflet-zoom-anim"))){if(i.touches&&i.touches.length!==1){Hr._dragging===this&&this.finishDrag();return}if(!(Hr._dragging||i.shiftKey||i.which!==1&&i.button!==1&&!i.touches)&&(Hr._dragging=this,this._preventOutline&&Qi(this._element),Yi(),zr(),!this._moving)){this.fire("down");var c=i.touches?i.touches[0]:i,h=Ws(this._element);this._startPoint=new H(c.clientX,c.clientY),this._startPos=nr(this._element),this._parentScale=Xi(h);var p=i.type==="mousedown";Oe(document,p?"mousemove":"touchmove",this._onMove,this),Oe(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var c=i.touches&&i.touches.length===1?i.touches[0]:i,h=new H(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Dt(i),this._moved||(this.fire("dragstart"),this._moved=!0,Ue(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=i,this._updatePosition())}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),dt(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){ct(document.body,"leaflet-dragging"),this._lastTarget&&(ct(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),at(document,"mousemove touchmove",this._onMove,this),at(document,"mouseup touchend touchcancel",this._onUp,this),Ki(),$r();var c=this._moved&&this._moving;this._moving=!1,Hr._dragging=!1,c&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function th(i,c,h){var p,j=[1,4,2,8],T,O,q,K,de,Se,Fe,Ve;for(T=0,Se=i.length;T<Se;T++)i[T]._code=ki(i[T],c);for(q=0;q<4;q++){for(Fe=j[q],p=[],T=0,Se=i.length,O=Se-1;T<Se;O=T++)K=i[T],de=i[O],K._code&Fe?de._code&Fe||(Ve=Qa(de,K,Fe,c,h),Ve._code=ki(Ve,c),p.push(Ve)):(de._code&Fe&&(Ve=Qa(de,K,Fe,c,h),Ve._code=ki(Ve,c),p.push(Ve)),p.push(K));i=p}return i}function nh(i,c){var h,p,j,T,O,q,K,de,Se;if(!i||i.length===0)throw new Error("latlngs not passed");bn(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Fe=G([0,0]),Ve=D(i),en=Ve.getNorthWest().distanceTo(Ve.getSouthWest())*Ve.getNorthEast().distanceTo(Ve.getNorthWest());en<1700&&(Fe=Wl(i));var At=i.length,In=[];for(h=0;h<At;h++){var ln=G(i[h]);In.push(c.project(G([ln.lat-Fe.lat,ln.lng-Fe.lng])))}for(q=K=de=0,h=0,p=At-1;h<At;p=h++)j=In[h],T=In[p],O=j.y*T.x-T.y*j.x,K+=(j.x+T.x)*O,de+=(j.y+T.y)*O,q+=O*3;q===0?Se=In[0]:Se=[K/q,de/q];var ls=c.unproject(ne(Se));return G([ls.lat+Fe.lat,ls.lng+Fe.lng])}function Wl(i){for(var c=0,h=0,p=0,j=0;j<i.length;j++){var T=G(i[j]);c+=T.lat,h+=T.lng,p++}return G([c/p,h/p])}var $y={__proto__:null,clipPolygon:th,polygonCenter:nh,centroid:Wl};function rh(i,c){if(!c||!i.length)return i.slice();var h=c*c;return i=Zy(i,h),i=Hy(i,h),i}function ih(i,c,h){return Math.sqrt(qs(i,c,h,!0))}function Wy(i,c,h){return qs(i,c,h)}function Hy(i,c){var h=i.length,p=typeof Uint8Array<"u"?Uint8Array:Array,j=new p(h);j[0]=j[h-1]=1,Hl(i,j,c,0,h-1);var T,O=[];for(T=0;T<h;T++)j[T]&&O.push(i[T]);return O}function Hl(i,c,h,p,j){var T=0,O,q,K;for(q=p+1;q<=j-1;q++)K=qs(i[q],i[p],i[j],!0),K>T&&(O=q,T=K);T>h&&(c[O]=1,Hl(i,c,h,p,O),Hl(i,c,h,O,j))}function Zy(i,c){for(var h=[i[0]],p=1,j=0,T=i.length;p<T;p++)Vy(i[p],i[j])>c&&(h.push(i[p]),j=p);return j<T-1&&h.push(i[T-1]),h}var sh;function ah(i,c,h,p,j){var T=p?sh:ki(i,h),O=ki(c,h),q,K,de;for(sh=O;;){if(!(T|O))return[i,c];if(T&O)return!1;q=T||O,K=Qa(i,c,q,h,j),de=ki(K,h),q===T?(i=K,T=de):(c=K,O=de)}}function Qa(i,c,h,p,j){var T=c.x-i.x,O=c.y-i.y,q=p.min,K=p.max,de,Se;return h&8?(de=i.x+T*(K.y-i.y)/O,Se=K.y):h&4?(de=i.x+T*(q.y-i.y)/O,Se=q.y):h&2?(de=K.x,Se=i.y+O*(K.x-i.x)/T):h&1&&(de=q.x,Se=i.y+O*(q.x-i.x)/T),new H(de,Se,j)}function ki(i,c){var h=0;return i.x<c.min.x?h|=1:i.x>c.max.x&&(h|=2),i.y<c.min.y?h|=4:i.y>c.max.y&&(h|=8),h}function Vy(i,c){var h=c.x-i.x,p=c.y-i.y;return h*h+p*p}function qs(i,c,h,p){var j=c.x,T=c.y,O=h.x-j,q=h.y-T,K=O*O+q*q,de;return K>0&&(de=((i.x-j)*O+(i.y-T)*q)/K,de>1?(j=h.x,T=h.y):de>0&&(j+=O*de,T+=q*de)),O=i.x-j,q=i.y-T,p?O*O+q*q:new H(j,T)}function bn(i){return!k(i[0])||typeof i[0][0]!="object"&&typeof i[0][0]<"u"}function oh(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),bn(i)}function lh(i,c){var h,p,j,T,O,q,K,de;if(!i||i.length===0)throw new Error("latlngs not passed");bn(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Se=G([0,0]),Fe=D(i),Ve=Fe.getNorthWest().distanceTo(Fe.getSouthWest())*Fe.getNorthEast().distanceTo(Fe.getNorthWest());Ve<1700&&(Se=Wl(i));var en=i.length,At=[];for(h=0;h<en;h++){var In=G(i[h]);At.push(c.project(G([In.lat-Se.lat,In.lng-Se.lng])))}for(h=0,p=0;h<en-1;h++)p+=At[h].distanceTo(At[h+1])/2;if(p===0)de=At[0];else for(h=0,T=0;h<en-1;h++)if(O=At[h],q=At[h+1],j=O.distanceTo(q),T+=j,T>p){K=(T-p)/j,de=[q.x-K*(q.x-O.x),q.y-K*(q.y-O.y)];break}var ln=c.unproject(ne(de));return G([ln.lat+Se.lat,ln.lng+Se.lng])}var qy={__proto__:null,simplify:rh,pointToSegmentDistance:ih,closestPointOnSegment:Wy,clipSegment:ah,_getEdgeIntersection:Qa,_getBitCode:ki,_sqClosestPointOnSegment:qs,isFlat:bn,_flat:oh,polylineCenter:lh},Zl={project:function(i){return new H(i.lng,i.lat)},unproject:function(i){return new ee(i.y,i.x)},bounds:new xe([-180,-90],[180,90])},Vl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new xe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(i){var c=Math.PI/180,h=this.R,p=i.lat*c,j=this.R_MINOR/h,T=Math.sqrt(1-j*j),O=T*Math.sin(p),q=Math.tan(Math.PI/4-p/2)/Math.pow((1-O)/(1+O),T/2);return p=-h*Math.log(Math.max(q,1e-10)),new H(i.lng*c*h,p)},unproject:function(i){for(var c=180/Math.PI,h=this.R,p=this.R_MINOR/h,j=Math.sqrt(1-p*p),T=Math.exp(-i.y/h),O=Math.PI/2-2*Math.atan(T),q=0,K=.1,de;q<15&&Math.abs(K)>1e-7;q++)de=j*Math.sin(O),de=Math.pow((1-de)/(1+de),j/2),K=Math.PI/2-2*Math.atan(T*de)-O,O+=K;return new ee(O*c,i.x*c/h)}},Gy={__proto__:null,LonLat:Zl,Mercator:Vl,SphericalMercator:we},Yy=o({},Ie,{code:"EPSG:3395",projection:Vl,transformation:function(){var i=.5/(Math.PI*Vl.R);return me(i,.5,-i,.5)}()}),ch=o({},Ie,{code:"EPSG:4326",projection:Zl,transformation:me(1/180,1,-1/180,.5)}),Ky=o({},_e,{projection:Zl,transformation:me(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,c){var h=c.lng-i.lng,p=c.lat-i.lat;return Math.sqrt(h*h+p*p)},infinite:!0});_e.Earth=Ie,_e.EPSG3395=Yy,_e.EPSG3857=nt,_e.EPSG900913=gn,_e.EPSG4326=ch,_e.Simple=Ky;var zn=U.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[u(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[u(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var c=i.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Je.include({addLayer:function(i){if(!i._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(i);return this._layers[c]?this:(this._layers[c]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i),this)},removeLayer:function(i){var c=u(i);return this._layers[c]?(this._loaded&&i.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this},hasLayer:function(i){return u(i)in this._layers},eachLayer:function(i,c){for(var h in this._layers)i.call(c,this._layers[h]);return this},_addLayers:function(i){i=i?k(i)?i:[i]:[];for(var c=0,h=i.length;c<h;c++)this.addLayer(i[c])},_addZoomLimit:function(i){(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom))&&(this._zoomBoundLayers[u(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var c=u(i);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,c=-1/0,h=this._getZoomSpan();for(var p in this._zoomBoundLayers){var j=this._zoomBoundLayers[p].options;i=j.minZoom===void 0?i:Math.min(i,j.minZoom),c=j.maxZoom===void 0?c:Math.max(c,j.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=i===1/0?void 0:i,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var rs=zn.extend({initialize:function(i,c){_(this,c),this._layers={};var h,p;if(i)for(h=0,p=i.length;h<p;h++)this.addLayer(i[h])},addLayer:function(i){var c=this.getLayerId(i);return this._layers[c]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var c=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(i){var c=typeof i=="number"?i:this.getLayerId(i);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var c=Array.prototype.slice.call(arguments,1),h,p;for(h in this._layers)p=this._layers[h],p[i]&&p[i].apply(p,c);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,c){for(var h in this._layers)i.call(c,this._layers[h]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return u(i)}}),Jy=function(i,c){return new rs(i,c)},_r=rs.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),rs.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),rs.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new oe;for(var c in this._layers){var h=this._layers[c];i.extend(h.getBounds?h.getBounds():h.getLatLng())}return i}}),Qy=function(i,c){return new _r(i,c)},is=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){_(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,c){var h=this._getIconUrl(i);if(!h){if(i==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(p,i),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(i,c){var h=this.options,p=h[c+"Size"];typeof p=="number"&&(p=[p,p]);var j=ne(p),T=ne(c==="shadow"&&h.shadowAnchor||h.iconAnchor||j&&j.divideBy(2,!0));i.className="leaflet-marker-"+c+" "+(h.className||""),T&&(i.style.marginLeft=-T.x+"px",i.style.marginTop=-T.y+"px"),j&&(i.style.width=j.x+"px",i.style.height=j.y+"px")},_createImg:function(i,c){return c=c||document.createElement("img"),c.src=i,c},_getIconUrl:function(i){return F.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}});function Xy(i){return new is(i)}var Gs=is.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return typeof Gs.imagePath!="string"&&(Gs.imagePath=this._detectIconPath()),(this.options.imagePath||Gs.imagePath)+is.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var c=function(h,p,j){var T=p.exec(h);return T&&T[j]};return i=c(i,/^url\((['"])?(.+)\1\)$/,2),i&&c(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=Ze("div","leaflet-default-icon-path",document.body),c=On(i,"background-image")||On(i,"backgroundImage");if(document.body.removeChild(i),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),dh=ir.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new Hr(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ue(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ct(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var c=this._marker,h=c._map,p=this._marker.options.autoPanSpeed,j=this._marker.options.autoPanPadding,T=nr(c._icon),O=h.getPixelBounds(),q=h.getPixelOrigin(),K=ve(O.min._subtract(q).add(j),O.max._subtract(q).subtract(j));if(!K.contains(T)){var de=ne((Math.max(K.max.x,T.x)-K.max.x)/(O.max.x-K.max.x)-(Math.min(K.min.x,T.x)-K.min.x)/(O.min.x-K.min.x),(Math.max(K.max.y,T.y)-K.max.y)/(O.max.y-K.max.y)-(Math.min(K.min.y,T.y)-K.min.y)/(O.min.y-K.min.y)).multiplyBy(p);h.panBy(de,{animate:!1}),this._draggable._newPos._add(de),this._draggable._startPos._add(de),dt(c._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=M(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&(W(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,i)))},_onDrag:function(i){var c=this._marker,h=c._shadow,p=nr(c._icon),j=c._map.layerPointToLatLng(p);h&&dt(h,p),c._latlng=j,i.latlng=j,i.oldLatLng=this._oldLatLng,c.fire("move",i).fire("drag",i)},_onDragEnd:function(i){W(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),Xa=zn.extend({options:{icon:new Gs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,c){_(this,c),this._latlng=G(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var c=this._latlng;return this._latlng=G(i),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=i.icon.createIcon(this._icon),p=!1;h!==this._icon&&(this._icon&&this._removeIcon(),p=!0,i.title&&(h.title=i.title),h.tagName==="IMG"&&(h.alt=i.alt||"")),Ue(h,c),i.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Oe(h,"focus",this._panOnFocus,this);var j=i.icon.createShadow(this._shadow),T=!1;j!==this._shadow&&(this._removeShadow(),T=!0),j&&(Ue(j,c),j.alt=""),this._shadow=j,i.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),j&&T&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&at(this._icon,"focus",this._panOnFocus,this),st(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&st(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&dt(this._icon,i),this._shadow&&dt(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(Ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),dh)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new dh(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&Rt(this._icon,i),this._shadow&&Rt(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var c=this.options.icon.options,h=c.iconSize?ne(c.iconSize):ne(0,0),p=c.iconAnchor?ne(c.iconAnchor):ne(0,0);i.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:h.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ex(i,c){return new Xa(i,c)}var Zr=zn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return _(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),eo=Zr.extend({options:{fill:!0,radius:10},initialize:function(i,c){_(this,c),this._latlng=G(i),this._radius=this.options.radius},setLatLng:function(i){var c=this._latlng;return this._latlng=G(i),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var c=i&&i.radius||this._radius;return Zr.prototype.setStyle.call(this,i),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,c=this._radiusY||i,h=this._clickTolerance(),p=[i+h,c+h];this._pxBounds=new xe(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function tx(i,c){return new eo(i,c)}var ql=eo.extend({initialize:function(i,c,h){if(typeof c=="number"&&(c=o({},h,{radius:c})),_(this,c),this._latlng=G(i),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new oe(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:Zr.prototype.setStyle,_project:function(){var i=this._latlng.lng,c=this._latlng.lat,h=this._map,p=h.options.crs;if(p.distance===Ie.distance){var j=Math.PI/180,T=this._mRadius/Ie.R/j,O=h.project([c+T,i]),q=h.project([c-T,i]),K=O.add(q).divideBy(2),de=h.unproject(K).lat,Se=Math.acos((Math.cos(T*j)-Math.sin(c*j)*Math.sin(de*j))/(Math.cos(c*j)*Math.cos(de*j)))/j;(isNaN(Se)||Se===0)&&(Se=T/Math.cos(Math.PI/180*c)),this._point=K.subtract(h.getPixelOrigin()),this._radius=isNaN(Se)?0:K.x-h.project([de,i-Se]).x,this._radiusY=K.y-O.y}else{var Fe=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(Fe).x}this._updateBounds()}});function nx(i,c,h){return new ql(i,c,h)}var wr=Zr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,c){_(this,c),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var c=1/0,h=null,p=qs,j,T,O=0,q=this._parts.length;O<q;O++)for(var K=this._parts[O],de=1,Se=K.length;de<Se;de++){j=K[de-1],T=K[de];var Fe=p(i,j,T,!0);Fe<c&&(c=Fe,h=p(i,j,T))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lh(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,c){return c=c||this._defaultShape(),i=G(i),c.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new oe,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return bn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var c=[],h=bn(i),p=0,j=i.length;p<j;p++)h?(c[p]=G(i[p]),this._bounds.extend(c[p])):c[p]=this._convertLatLngs(i[p]);return c},_project:function(){var i=new xe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),c=new H(i,i);this._rawPxBounds&&(this._pxBounds=new xe([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(i,c,h){var p=i[0]instanceof ee,j=i.length,T,O;if(p){for(O=[],T=0;T<j;T++)O[T]=this._map.latLngToLayerPoint(i[T]),h.extend(O[T]);c.push(O)}else for(T=0;T<j;T++)this._projectLatlngs(i[T],c,h)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,p,j,T,O,q,K;for(h=0,j=0,T=this._rings.length;h<T;h++)for(K=this._rings[h],p=0,O=K.length;p<O-1;p++)q=ah(K[p],K[p+1],i,p,!0),q&&(c[j]=c[j]||[],c[j].push(q[0]),(q[1]!==K[p+1]||p===O-2)&&(c[j].push(q[1]),j++))}},_simplifyPoints:function(){for(var i=this._parts,c=this.options.smoothFactor,h=0,p=i.length;h<p;h++)i[h]=rh(i[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,c){var h,p,j,T,O,q,K=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(h=0,T=this._parts.length;h<T;h++)for(q=this._parts[h],p=0,O=q.length,j=O-1;p<O;j=p++)if(!(!c&&p===0)&&ih(i,q[j],q[p])<=K)return!0;return!1}});function rx(i,c){return new wr(i,c)}wr._flat=oh;var ss=wr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return nh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var c=wr.prototype._convertLatLngs.call(this,i),h=c.length;return h>=2&&c[0]instanceof ee&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(i){wr.prototype._setLatLngs.call(this,i),bn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return bn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,c=this.options.weight,h=new H(c,c);if(i=new xe(i.min.subtract(h),i.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,j=this._rings.length,T;p<j;p++)T=th(this._rings[p],i,!0),T.length&&this._parts.push(T)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var c=!1,h,p,j,T,O,q,K,de;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(T=0,K=this._parts.length;T<K;T++)for(h=this._parts[T],O=0,de=h.length,q=de-1;O<de;q=O++)p=h[O],j=h[q],p.y>i.y!=j.y>i.y&&i.x<(j.x-p.x)*(i.y-p.y)/(j.y-p.y)+p.x&&(c=!c);return c||wr.prototype._containsPoint.call(this,i,!0)}});function ix(i,c){return new ss(i,c)}var jr=_r.extend({initialize:function(i,c){_(this,c),this._layers={},i&&this.addData(i)},addData:function(i){var c=k(i)?i:i.features,h,p,j;if(c){for(h=0,p=c.length;h<p;h++)j=c[h],(j.geometries||j.geometry||j.features||j.coordinates)&&this.addData(j);return this}var T=this.options;if(T.filter&&!T.filter(i))return this;var O=to(i,T);return O?(O.feature=io(i),O.defaultOptions=O.options,this.resetStyle(O),T.onEachFeature&&T.onEachFeature(i,O),this.addLayer(O)):this},resetStyle:function(i){return i===void 0?this.eachLayer(this.resetStyle,this):(i.options=o({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(c){this._setLayerStyle(c,i)},this)},_setLayerStyle:function(i,c){i.setStyle&&(typeof c=="function"&&(c=c(i.feature)),i.setStyle(c))}});function to(i,c){var h=i.type==="Feature"?i.geometry:i,p=h?h.coordinates:null,j=[],T=c&&c.pointToLayer,O=c&&c.coordsToLatLng||Gl,q,K,de,Se;if(!p&&!h)return null;switch(h.type){case"Point":return q=O(p),uh(T,i,q,c);case"MultiPoint":for(de=0,Se=p.length;de<Se;de++)q=O(p[de]),j.push(uh(T,i,q,c));return new _r(j);case"LineString":case"MultiLineString":return K=no(p,h.type==="LineString"?0:1,O),new wr(K,c);case"Polygon":case"MultiPolygon":return K=no(p,h.type==="Polygon"?1:2,O),new ss(K,c);case"GeometryCollection":for(de=0,Se=h.geometries.length;de<Se;de++){var Fe=to({geometry:h.geometries[de],type:"Feature",properties:i.properties},c);Fe&&j.push(Fe)}return new _r(j);case"FeatureCollection":for(de=0,Se=h.features.length;de<Se;de++){var Ve=to(h.features[de],c);Ve&&j.push(Ve)}return new _r(j);default:throw new Error("Invalid GeoJSON object.")}}function uh(i,c,h,p){return i?i(c,h):new Xa(h,p&&p.markersInheritOptions&&p)}function Gl(i){return new ee(i[1],i[0],i[2])}function no(i,c,h){for(var p=[],j=0,T=i.length,O;j<T;j++)O=c?no(i[j],c-1,h):(h||Gl)(i[j]),p.push(O);return p}function Yl(i,c){return i=G(i),i.alt!==void 0?[y(i.lng,c),y(i.lat,c),y(i.alt,c)]:[y(i.lng,c),y(i.lat,c)]}function ro(i,c,h,p){for(var j=[],T=0,O=i.length;T<O;T++)j.push(c?ro(i[T],bn(i[T])?0:c-1,h,p):Yl(i[T],p));return!c&&h&&j.length>0&&j.push(j[0].slice()),j}function as(i,c){return i.feature?o({},i.feature,{geometry:c}):io(c)}function io(i){return i.type==="Feature"||i.type==="FeatureCollection"?i:{type:"Feature",properties:{},geometry:i}}var Kl={toGeoJSON:function(i){return as(this,{type:"Point",coordinates:Yl(this.getLatLng(),i)})}};Xa.include(Kl),ql.include(Kl),eo.include(Kl),wr.include({toGeoJSON:function(i){var c=!bn(this._latlngs),h=ro(this._latlngs,c?1:0,!1,i);return as(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ss.include({toGeoJSON:function(i){var c=!bn(this._latlngs),h=c&&!bn(this._latlngs[0]),p=ro(this._latlngs,h?2:c?1:0,!0,i);return c||(p=[p]),as(this,{type:(h?"Multi":"")+"Polygon",coordinates:p})}}),rs.include({toMultiPoint:function(i){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(i).geometry.coordinates)}),as(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(i){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(i);var h=c==="GeometryCollection",p=[];return this.eachLayer(function(j){if(j.toGeoJSON){var T=j.toGeoJSON(i);if(h)p.push(T.geometry);else{var O=io(T);O.type==="FeatureCollection"?p.push.apply(p,O.features):p.push(O)}}}),h?as(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function hh(i,c){return new jr(i,c)}var sx=hh,so=zn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,c,h){this._url=i,this._bounds=D(c),_(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){st(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&Nn(this._image),this},bringToBack:function(){return this._map&&kn(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=D(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i=this._url.tagName==="IMG",c=this._image=i?this._url:Ze("img");if(Ue(c,"leaflet-image-layer"),this._zoomAnimated&&Ue(c,"leaflet-zoom-animated"),this.options.className&&Ue(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(i){var c=this._map.getZoomScale(i.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;Ke(this._image,h,c)},_reset:function(){var i=this._image,c=new xe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();dt(i,c.min),i.style.width=h.x+"px",i.style.height=h.y+"px"},_updateOpacity:function(){Rt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),ax=function(i,c,h){return new so(i,c,h)},fh=so.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i=this._url.tagName==="VIDEO",c=this._image=i?this._url:Ze("video");if(Ue(c,"leaflet-image-layer"),this._zoomAnimated&&Ue(c,"leaflet-zoom-animated"),this.options.className&&Ue(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=l(this.fire,this,"load"),i){for(var h=c.getElementsByTagName("source"),p=[],j=0;j<h.length;j++)p.push(h[j].src);this._url=h.length>0?p:[c.src];return}k(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var T=0;T<this._url.length;T++){var O=Ze("source");O.src=this._url[T],c.appendChild(O)}}});function ox(i,c,h){return new fh(i,c,h)}var ph=so.extend({_initImage:function(){var i=this._image=this._url;Ue(i,"leaflet-image-layer"),this._zoomAnimated&&Ue(i,"leaflet-zoom-animated"),this.options.className&&Ue(i,this.options.className),i.onselectstart=g,i.onmousemove=g}});function lx(i,c,h){return new ph(i,c,h)}var sr=zn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,c){i&&(i instanceof ee||k(i))?(this._latlng=G(i),_(this,c)):(_(this,i),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&Rt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&Rt(this._container,1),this.bringToFront(),this.options.interactive&&(Ue(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(Rt(this._container,0),this._removeTimeout=setTimeout(l(st,void 0,this._container),200)):st(this._container),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=G(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Nn(this._container),this},bringToBack:function(){return this._map&&kn(this._container),this},_prepareOpen:function(i){var c=this._source;if(!c._map)return!1;if(c instanceof _r){c=null;var h=this._source._layers;for(var p in h)if(h[p]._map){c=h[p];break}if(!c)return!1;this._source=c}if(!i)if(c.getCenter)i=c.getCenter();else if(c.getLatLng)i=c.getLatLng();else if(c.getBounds)i=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")i.innerHTML=c;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),c=ne(this.options.offset),h=this._getAnchor();this._zoomAnimated?dt(this._container,i.add(h)):c=c.add(i).add(h);var p=this._containerBottom=-c.y,j=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=p+"px",this._container.style.left=j+"px"}},_getAnchor:function(){return[0,0]}});Je.include({_initOverlay:function(i,c,h,p){var j=c;return j instanceof i||(j=new i(p).setContent(c)),h&&j.setLatLng(h),j}}),zn.include({_initOverlay:function(i,c,h,p){var j=h;return j instanceof i?(_(j,p),j._source=this):(j=c&&!p?c:new i(p,this),j.setContent(h)),j}});var ao=sr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,sr.prototype.openOn.call(this,i)},onAdd:function(i){sr.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Zr||this._source.on("preclick",rr))},onRemove:function(i){sr.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Zr||this._source.off("preclick",rr))},getEvents:function(){var i=sr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",c=this._container=Ze("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=Ze("div",i+"-content-wrapper",c);if(this._contentNode=Ze("div",i+"-content",h),Zs(c),St(this._contentNode),Oe(c,"contextmenu",rr),this._tipContainer=Ze("div",i+"-tip-container",c),this._tip=Ze("div",i+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=Ze("a",i+"-close-button",c);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',Oe(p,"click",function(j){Dt(j),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,c=i.style;c.width="",c.whiteSpace="nowrap";var h=i.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var p=i.offsetHeight,j=this.options.maxHeight,T="leaflet-popup-scrolled";j&&p>j?(c.height=j+"px",Ue(i,T)):ct(i,T),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),h=this._getAnchor();dt(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,c=parseInt(On(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,p=this._containerWidth,j=new H(this._containerLeft,-h-this._containerBottom);j._add(nr(this._container));var T=i.layerPointToContainerPoint(j),O=ne(this.options.autoPanPadding),q=ne(this.options.autoPanPaddingTopLeft||O),K=ne(this.options.autoPanPaddingBottomRight||O),de=i.getSize(),Se=0,Fe=0;T.x+p+K.x>de.x&&(Se=T.x+p-de.x+K.x),T.x-Se-q.x<0&&(Se=T.x-q.x),T.y+h+K.y>de.y&&(Fe=T.y+h-de.y+K.y),T.y-Fe-q.y<0&&(Fe=T.y-q.y),(Se||Fe)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([Se,Fe]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),cx=function(i,c){return new ao(i,c)};Je.mergeOptions({closePopupOnClick:!0}),Je.include({openPopup:function(i,c,h){return this._initOverlay(ao,i,c,h).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),zn.include({bindPopup:function(i,c){return this._popup=this._initOverlay(ao,this._popup,i,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof _r||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(!(!this._popup||!this._map)){Ni(i);var c=i.layer||i.target;if(this._popup._source===c&&!(c instanceof Zr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=c,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){i.originalEvent.keyCode===13&&this._openPopup(i)}});var oo=sr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){sr.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){sr.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=sr.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip",c=i+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ze("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var c,h,p=this._map,j=this._container,T=p.latLngToContainerPoint(p.getCenter()),O=p.layerPointToContainerPoint(i),q=this.options.direction,K=j.offsetWidth,de=j.offsetHeight,Se=ne(this.options.offset),Fe=this._getAnchor();q==="top"?(c=K/2,h=de):q==="bottom"?(c=K/2,h=0):q==="center"?(c=K/2,h=de/2):q==="right"?(c=0,h=de/2):q==="left"?(c=K,h=de/2):O.x<T.x?(q="right",c=0,h=de/2):(q="left",c=K+(Se.x+Fe.x)*2,h=de/2),i=i.subtract(ne(c,h,!0)).add(Se).add(Fe),ct(j,"leaflet-tooltip-right"),ct(j,"leaflet-tooltip-left"),ct(j,"leaflet-tooltip-top"),ct(j,"leaflet-tooltip-bottom"),Ue(j,"leaflet-tooltip-"+q),dt(j,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&Rt(this._container,i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(c)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),dx=function(i,c){return new oo(i,c)};Je.include({openTooltip:function(i,c,h){return this._initOverlay(oo,i,c,h).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),zn.include({bindTooltip:function(i,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(oo,this._tooltip,i,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(!(!i&&this._tooltipHandlersAdded)){var c=i?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof _r||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&(Oe(c,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),Oe(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var c=i.latlng,h,p;this._tooltip.options.sticky&&i.originalEvent&&(h=this._map.mouseEventToContainerPoint(i.originalEvent),p=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(c)}});var mh=is.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var c=i&&i.tagName==="DIV"?i:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Xn(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var p=ne(h.bgPos);c.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function ux(i){return new mh(i)}is.Default=Gs;var Ys=zn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:F.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){_(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),st(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Nn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(kn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof H?i:new H(i,i)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var c=this.getPane().children,h=-i(-1/0,1/0),p=0,j=c.length,T;p<j;p++)T=c[p].style.zIndex,c[p]!==this._container&&T&&(h=i(h,+T));isFinite(h)&&(this.options.zIndex=h+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!F.ielt9){Rt(this._container,this.options.opacity);var i=+new Date,c=!1,h=!1;for(var p in this._tiles){var j=this._tiles[p];if(!(!j.current||!j.loaded)){var T=Math.min(1,(i-j.loaded)/200);Rt(j.el,T),T<1?c=!0:(j.active?h=!0:this._onOpaqueTile(j),j.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(W(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=Ze("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,c=this.options.maxZoom;if(i!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===i?(this._levels[h].el.style.zIndex=c-Math.abs(i-h),this._onUpdateLevel(h)):(st(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var p=this._levels[i],j=this._map;return p||(p=this._levels[i]={},p.el=Ze("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=c,p.origin=j.project(j.unproject(j.getPixelOrigin()),i).round(),p.zoom=i,this._setZoomTransform(p,j.getCenter(),j.getZoom()),g(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var i,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)c=this._tiles[i],c.retain=c.current;for(i in this._tiles)if(c=this._tiles[i],c.current&&!c.active){var p=c.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var c in this._tiles)this._tiles[c].coords.z===i&&this._removeTile(c)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)st(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,c,h,p){var j=Math.floor(i/2),T=Math.floor(c/2),O=h-1,q=new H(+j,+T);q.z=+O;var K=this._tileCoordsToKey(q),de=this._tiles[K];return de&&de.active?(de.retain=!0,!0):(de&&de.loaded&&(de.retain=!0),O>p?this._retainParent(j,T,O,p):!1)},_retainChildren:function(i,c,h,p){for(var j=2*i;j<2*i+2;j++)for(var T=2*c;T<2*c+2;T++){var O=new H(j,T);O.z=h+1;var q=this._tileCoordsToKey(O),K=this._tiles[q];if(K&&K.active){K.retain=!0;continue}else K&&K.loaded&&(K.retain=!0);h+1<p&&this._retainChildren(j,T,h+1,p)}},_resetView:function(i){var c=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var c=this.options;return c.minNativeZoom!==void 0&&i<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<i?c.maxNativeZoom:i},_setView:function(i,c,h,p){var j=Math.round(c);this.options.maxZoom!==void 0&&j>this.options.maxZoom||this.options.minZoom!==void 0&&j<this.options.minZoom?j=void 0:j=this._clampZoom(j);var T=this.options.updateWhenZooming&&j!==this._tileZoom;(!p||T)&&(this._tileZoom=j,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),j!==void 0&&this._update(i),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(i,c)},_setZoomTransforms:function(i,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],i,c)},_setZoomTransform:function(i,c,h){var p=this._map.getZoomScale(h,i.zoom),j=i.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(c,h)).round();F.any3d?Ke(i.el,j,p):dt(i.el,j)},_resetGrid:function(){var i=this._map,c=i.options.crs,h=this._tileSize=this.getTileSize(),p=this._tileZoom,j=this._map.getPixelWorldBounds(this._tileZoom);j&&(this._globalTileRange=this._pxBoundsToTileRange(j)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,c.wrapLng[0]],p).x/h.x),Math.ceil(i.project([0,c.wrapLng[1]],p).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([c.wrapLat[0],0],p).y/h.x),Math.ceil(i.project([c.wrapLat[1],0],p).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(i){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),p=c.getZoomScale(h,this._tileZoom),j=c.project(i,this._tileZoom).floor(),T=c.getSize().divideBy(p*2);return new xe(j.subtract(T),j.add(T))},_update:function(i){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(i===void 0&&(i=c.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(i),j=this._pxBoundsToTileRange(p),T=j.getCenter(),O=[],q=this.options.keepBuffer,K=new xe(j.getBottomLeft().subtract([q,-q]),j.getTopRight().add([q,-q]));if(!(isFinite(j.min.x)&&isFinite(j.min.y)&&isFinite(j.max.x)&&isFinite(j.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var de in this._tiles){var Se=this._tiles[de].coords;(Se.z!==this._tileZoom||!K.contains(new H(Se.x,Se.y)))&&(this._tiles[de].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(i,h);return}for(var Fe=j.min.y;Fe<=j.max.y;Fe++)for(var Ve=j.min.x;Ve<=j.max.x;Ve++){var en=new H(Ve,Fe);if(en.z=this._tileZoom,!!this._isValidTile(en)){var At=this._tiles[this._tileCoordsToKey(en)];At?At.current=!0:O.push(en)}}if(O.sort(function(ln,ls){return ln.distanceTo(T)-ls.distanceTo(T)}),O.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var In=document.createDocumentFragment();for(Ve=0;Ve<O.length;Ve++)this._addTile(O[Ve],In);this._level.el.appendChild(In)}}}},_isValidTile:function(i){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(i.x<h.min.x||i.x>h.max.x)||!c.wrapLat&&(i.y<h.min.y||i.y>h.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(i);return D(this.options.bounds).overlaps(p)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var c=this._map,h=this.getTileSize(),p=i.scaleBy(h),j=p.add(h),T=c.unproject(p,i.z),O=c.unproject(j,i.z);return[T,O]},_tileCoordsToBounds:function(i){var c=this._tileCoordsToNwSe(i),h=new oe(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var c=i.split(":"),h=new H(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(i){var c=this._tiles[i];c&&(st(c.el),delete this._tiles[i],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){Ue(i,"leaflet-tile");var c=this.getTileSize();i.style.width=c.x+"px",i.style.height=c.y+"px",i.onselectstart=g,i.onmousemove=g,F.ielt9&&this.options.opacity<1&&Rt(i,this.options.opacity)},_addTile:function(i,c){var h=this._getTilePos(i),p=this._tileCoordsToKey(i),j=this.createTile(this._wrapCoords(i),l(this._tileReady,this,i));this._initTile(j),this.createTile.length<2&&M(l(this._tileReady,this,i,null,j)),dt(j,h),this._tiles[p]={el:j,coords:i,current:!0},c.appendChild(j),this.fire("tileloadstart",{tile:j,coords:i})},_tileReady:function(i,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:i});var p=this._tileCoordsToKey(i);h=this._tiles[p],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Rt(h.el,0),W(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(Ue(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),F.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var c=new H(this._wrapX?m(i.x,this._wrapX):i.x,this._wrapY?m(i.y,this._wrapY):i.y);return c.z=i.z,c},_pxBoundsToTileRange:function(i){var c=this.getTileSize();return new xe(i.min.unscaleBy(c).floor(),i.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}});function hx(i){return new Ys(i)}var os=Ys.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,c){this._url=i,c=_(this,c),c.detectRetina&&F.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,c){return this._url===i&&c===void 0&&(c=!0),this._url=i,c||this.redraw(),this},createTile:function(i,c){var h=document.createElement("img");return Oe(h,"load",l(this._tileOnLoad,this,c,h)),Oe(h,"error",l(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(i),h},getTileUrl:function(i){var c={r:F.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-i.y;this.options.tms&&(c.y=h),c["-y"]=h}return x(this._url,o(c,this.options))},_tileOnLoad:function(i,c){F.ielt9?setTimeout(l(i,this,null,c),0):i(null,c)},_tileOnError:function(i,c,h){var p=this.options.errorTileUrl;p&&c.getAttribute("src")!==p&&(c.src=p),i(h,c)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,p=this.options.zoomOffset;return h&&(i=c-i),i+p},_getSubdomain:function(i){var c=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var i,c;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(c=this._tiles[i].el,c.onload=g,c.onerror=g,!c.complete)){c.src=E;var h=this._tiles[i].coords;st(c),delete this._tiles[i],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(i){var c=this._tiles[i];if(c)return c.el.setAttribute("src",E),Ys.prototype._removeTile.call(this,i)},_tileReady:function(i,c,h){if(!(!this._map||h&&h.getAttribute("src")===E))return Ys.prototype._tileReady.call(this,i,c,h)}});function gh(i,c){return new os(i,c)}var yh=os.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,c){this._url=i;var h=o({},this.defaultWmsParams);for(var p in c)p in this.options||(h[p]=c[p]);c=_(this,c);var j=c.detectRetina&&F.retina?2:1,T=this.getTileSize();h.width=T.x*j,h.height=T.y*j,this.wmsParams=h},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,os.prototype.onAdd.call(this,i)},getTileUrl:function(i){var c=this._tileCoordsToNwSe(i),h=this._crs,p=ve(h.project(c[0]),h.project(c[1])),j=p.min,T=p.max,O=(this._wmsVersion>=1.3&&this._crs===ch?[j.y,j.x,T.y,T.x]:[j.x,j.y,T.x,T.y]).join(","),q=os.prototype.getTileUrl.call(this,i);return q+b(this.wmsParams,q,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+O},setParams:function(i,c){return o(this.wmsParams,i),c||this.redraw(),this}});function fx(i,c){return new yh(i,c)}os.WMS=yh,gh.wms=fx;var Sr=zn.extend({options:{padding:.1},initialize:function(i){_(this,i),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,c){var h=this._map.getZoomScale(c,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),j=this._map.project(this._center,c),T=p.multiplyBy(-h).add(j).subtract(this._map._getNewPixelOrigin(i,c));F.any3d?Ke(this._container,T,h):dt(this._container,T)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var i in this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-i)).round();this._bounds=new xe(h,h.add(c.multiplyBy(1+i*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),xh=Sr.extend({options:{tolerance:0},getEvents:function(){var i=Sr.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Sr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");Oe(i,"mousemove",this._onMouseMove,this),Oe(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Oe(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){W(this._redrawRequest),delete this._ctx,st(this._container),at(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var i;this._redrawBounds=null;for(var c in this._layers)i=this._layers[c],i._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Sr.prototype._update.call(this);var i=this._bounds,c=this._container,h=i.getSize(),p=F.retina?2:1;dt(c,i.min),c.width=p*h.x,c.height=p*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",F.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){Sr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[u(i)]=i;var c=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var c=i._order,h=c.next,p=c.prev;h?h.prev=p:this._drawLast=p,p?p.next=h:this._drawFirst=h,delete i._order,delete this._layers[u(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if(typeof i.options.dashArray=="string"){var c=i.options.dashArray.split(/[, ]+/),h=[],p,j;for(j=0;j<c.length;j++){if(p=Number(c[j]),isNaN(p))return;h.push(p)}i.options._dashArray=h}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var c=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new xe,this._redrawBounds.extend(i._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(i._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var c=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)i=p.layer,(!c||i._pxBounds&&i._pxBounds.intersects(c))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,c){if(this._drawing){var h,p,j,T,O=i._parts,q=O.length,K=this._ctx;if(q){for(K.beginPath(),h=0;h<q;h++){for(p=0,j=O[h].length;p<j;p++)T=O[h][p],K[p?"lineTo":"moveTo"](T.x,T.y);c&&K.closePath()}this._fillStroke(K,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var c=i._point,h=this._ctx,p=Math.max(Math.round(i._radius),1),j=(Math.max(Math.round(i._radiusY),1)||p)/p;j!==1&&(h.save(),h.scale(1,j)),h.beginPath(),h.arc(c.x,c.y/j,p,0,Math.PI*2,!1),j!==1&&h.restore(),this._fillStroke(h,i)}},_fillStroke:function(i,c){var h=c.options;h.fill&&(i.globalAlpha=h.fillOpacity,i.fillStyle=h.fillColor||h.color,i.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(i.setLineDash&&i.setLineDash(c.options&&c.options._dashArray||[]),i.globalAlpha=h.opacity,i.lineWidth=h.weight,i.strokeStyle=h.color,i.lineCap=h.lineCap,i.lineJoin=h.lineJoin,i.stroke())},_onClick:function(i){for(var c=this._map.mouseEventToLayerPoint(i),h,p,j=this._drawFirst;j;j=j.next)h=j.layer,h.options.interactive&&h._containsPoint(c)&&(!(i.type==="click"||i.type==="preclick")||!this._map._draggableMoved(h))&&(p=h);this._fireEvent(p?[p]:!1,i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,c)}},_handleMouseOut:function(i){var c=this._hoveredLayer;c&&(ct(this._container,"leaflet-interactive"),this._fireEvent([c],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,c){if(!this._mouseHoverThrottled){for(var h,p,j=this._drawFirst;j;j=j.next)h=j.layer,h.options.interactive&&h._containsPoint(c)&&(p=h);p!==this._hoveredLayer&&(this._handleMouseOut(i),p&&(Ue(this._container,"leaflet-interactive"),this._fireEvent([p],i,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,i),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,c,h){this._map._fireDOMEvent(c,h||c.type,i)},_bringToFront:function(i){var c=i._order;if(c){var h=c.next,p=c.prev;if(h)h.prev=p;else return;p?p.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(i)}},_bringToBack:function(i){var c=i._order;if(c){var h=c.next,p=c.prev;if(p)p.next=h;else return;h?h.prev=p:p&&(this._drawLast=p),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(i)}}});function vh(i){return F.canvas?new xh(i):null}var Ks=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch{}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),px={_initContainer:function(){this._container=Ze("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Sr.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var c=i._container=Ks("shape");Ue(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",i._path=Ks("path"),c.appendChild(i._path),this._updateStyle(i),this._layers[u(i)]=i},_addPath:function(i){var c=i._container;this._container.appendChild(c),i.options.interactive&&i.addInteractiveTarget(c)},_removePath:function(i){var c=i._container;st(c),i.removeInteractiveTarget(c),delete this._layers[u(i)]},_updateStyle:function(i){var c=i._stroke,h=i._fill,p=i.options,j=i._container;j.stroked=!!p.stroke,j.filled=!!p.fill,p.stroke?(c||(c=i._stroke=Ks("stroke")),j.appendChild(c),c.weight=p.weight+"px",c.color=p.color,c.opacity=p.opacity,p.dashArray?c.dashStyle=k(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=p.lineCap.replace("butt","flat"),c.joinstyle=p.lineJoin):c&&(j.removeChild(c),i._stroke=null),p.fill?(h||(h=i._fill=Ks("fill")),j.appendChild(h),h.color=p.fillColor||p.color,h.opacity=p.fillOpacity):h&&(j.removeChild(h),i._fill=null)},_updateCircle:function(i){var c=i._point.round(),h=Math.round(i._radius),p=Math.round(i._radiusY||h);this._setPath(i,i._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+p+" 0,"+65535*360)},_setPath:function(i,c){i._path.v=c},_bringToFront:function(i){Nn(i._container)},_bringToBack:function(i){kn(i._container)}},lo=F.vml?Ks:fe,Js=Sr.extend({_initContainer:function(){this._container=lo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=lo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){st(this._container),at(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Sr.prototype._update.call(this);var i=this._bounds,c=i.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),dt(h,i.min),h.setAttribute("viewBox",[i.min.x,i.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(i){var c=i._path=lo("path");i.options.className&&Ue(c,i.options.className),i.options.interactive&&Ue(c,"leaflet-interactive"),this._updateStyle(i),this._layers[u(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){st(i._path),i.removeInteractiveTarget(i._path),delete this._layers[u(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var c=i._path,h=i.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(i,c){this._setPath(i,ae(i._parts,c))},_updateCircle:function(i){var c=i._point,h=Math.max(Math.round(i._radius),1),p=Math.max(Math.round(i._radiusY),1)||h,j="a"+h+","+p+" 0 1,0 ",T=i._empty()?"M0 0":"M"+(c.x-h)+","+c.y+j+h*2+",0 "+j+-h*2+",0 ";this._setPath(i,T)},_setPath:function(i,c){i._path.setAttribute("d",c)},_bringToFront:function(i){Nn(i._path)},_bringToBack:function(i){kn(i._path)}});F.vml&&Js.include(px);function _h(i){return F.svg||F.vml?new Js(i):null}Je.include({getRenderer:function(i){var c=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(i){if(i==="overlayPane"||i===void 0)return!1;var c=this._paneRenderers[i];return c===void 0&&(c=this._createRenderer({pane:i}),this._paneRenderers[i]=c),c},_createRenderer:function(i){return this.options.preferCanvas&&vh(i)||_h(i)}});var wh=ss.extend({initialize:function(i,c){ss.prototype.initialize.call(this,this._boundsToLatLngs(i),c)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return i=D(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});function mx(i,c){return new wh(i,c)}Js.create=lo,Js.pointsToPath=ae,jr.geometryToLayer=to,jr.coordsToLatLng=Gl,jr.coordsToLatLngs=no,jr.latLngToCoords=Yl,jr.latLngsToCoords=ro,jr.getFeature=as,jr.asFeature=io,Je.mergeOptions({boxZoom:!0});var jh=ir.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){Oe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){at(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){st(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||i.which!==1&&i.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),zr(),Yi(),this._startPoint=this._map.mouseEventToContainerPoint(i),Oe(document,{contextmenu:Ni,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=Ze("div","leaflet-zoom-box",this._container),Ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var c=new xe(this._point,this._startPoint),h=c.getSize();dt(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(st(this._box),ct(this._container,"leaflet-crosshair")),$r(),Ki(),at(document,{contextmenu:Ni,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if(!(i.which!==1&&i.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new oe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(i){i.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Je.addInitHook("addHandler","boxZoom",jh),Je.mergeOptions({doubleClickZoom:!0});var Sh=ir.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var c=this._map,h=c.getZoom(),p=c.options.zoomDelta,j=i.originalEvent.shiftKey?h-p:h+p;c.options.doubleClickZoom==="center"?c.setZoom(j):c.setZoomAround(i.containerPoint,j)}});Je.addInitHook("addHandler","doubleClickZoom",Sh),Je.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ch=ir.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new Hr(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}Ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ct(this._map._container,"leaflet-grab"),ct(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=D(this._map.options.maxBounds);this._offsetLimit=ve(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,c){return i-(i-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var i=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;i.x<c.min.x&&(i.x=this._viscousLimit(i.x,c.min.x)),i.y<c.min.y&&(i.y=this._viscousLimit(i.y,c.min.y)),i.x>c.max.x&&(i.x=this._viscousLimit(i.x,c.max.x)),i.y>c.max.y&&(i.y=this._viscousLimit(i.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,c=Math.round(i/2),h=this._initialWorldOffset,p=this._draggable._newPos.x,j=(p-c+h)%i+c-h,T=(p+c+h)%i-c-h,O=Math.abs(j+h)<Math.abs(T+h)?j:T;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=O},_onDragEnd:function(i){var c=this._map,h=c.options,p=!h.inertia||i.noInertia||this._times.length<2;if(c.fire("dragend",i),p)c.fire("moveend");else{this._prunePositions(+new Date);var j=this._lastPos.subtract(this._positions[0]),T=(this._lastTime-this._times[0])/1e3,O=h.easeLinearity,q=j.multiplyBy(O/T),K=q.distanceTo([0,0]),de=Math.min(h.inertiaMaxSpeed,K),Se=q.multiplyBy(de/K),Fe=de/(h.inertiaDeceleration*O),Ve=Se.multiplyBy(-Fe/2).round();!Ve.x&&!Ve.y?c.fire("moveend"):(Ve=c._limitOffset(Ve,c.options.maxBounds),M(function(){c.panBy(Ve,{duration:Fe,easeLinearity:O,noMoveStart:!0,animate:!0})}))}}});Je.addInitHook("addHandler","dragging",Ch),Je.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Nh=ir.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),Oe(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),at(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,c=document.documentElement,h=i.scrollTop||c.scrollTop,p=i.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(p,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var c=this._panKeys={},h=this.keyCodes,p,j;for(p=0,j=h.left.length;p<j;p++)c[h.left[p]]=[-1*i,0];for(p=0,j=h.right.length;p<j;p++)c[h.right[p]]=[i,0];for(p=0,j=h.down.length;p<j;p++)c[h.down[p]]=[0,i];for(p=0,j=h.up.length;p<j;p++)c[h.up[p]]=[0,-1*i]},_setZoomDelta:function(i){var c=this._zoomKeys={},h=this.keyCodes,p,j;for(p=0,j=h.zoomIn.length;p<j;p++)c[h.zoomIn[p]]=i;for(p=0,j=h.zoomOut.length;p<j;p++)c[h.zoomOut[p]]=-i},_addHooks:function(){Oe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){at(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!(i.altKey||i.ctrlKey||i.metaKey)){var c=i.keyCode,h=this._map,p;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(p=this._panKeys[c],i.shiftKey&&(p=ne(p).multiplyBy(3)),h.options.maxBounds&&(p=h._limitOffset(ne(p),h.options.maxBounds)),h.options.worldCopyJump){var j=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(p)));h.panTo(j)}else h.panBy(p)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Ni(i)}}});Je.addInitHook("addHandler","keyboard",Nh),Je.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var kh=ir.extend({addHooks:function(){Oe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){at(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var c=Ku(i),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var p=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),p),Ni(i)},_performZoom:function(){var i=this._map,c=i.getZoom(),h=this._map.options.zoomSnap||0;i._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),j=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,T=h?Math.ceil(j/h)*h:j,O=i._limitZoom(c+(this._delta>0?T:-T))-c;this._delta=0,this._startTime=null,O&&(i.options.scrollWheelZoom==="center"?i.setZoom(c+O):i.setZoomAround(this._lastMousePos,c+O))}});Je.addInitHook("addHandler","scrollWheelZoom",kh);var gx=600;Je.mergeOptions({tapHold:F.touchNative&&F.safari&&F.mobile,tapTolerance:15});var bh=ir.extend({addHooks:function(){Oe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){at(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),i.touches.length===1){var c=i.touches[0];this._startPos=this._newPos=new H(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Oe(document,"touchend",Dt),Oe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),gx),Oe(document,"touchend touchcancel contextmenu",this._cancel,this),Oe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){at(document,"touchend",Dt),at(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),at(document,"touchend touchcancel contextmenu",this._cancel,this),at(document,"touchmove",this._onMove,this)},_onMove:function(i){var c=i.touches[0];this._newPos=new H(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,c){var h=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});Je.addInitHook("addHandler","tapHold",bh),Je.mergeOptions({touchZoom:F.touch,bounceAtZoomLimits:!0});var Ih=ir.extend({addHooks:function(){Ue(this._map._container,"leaflet-touch-zoom"),Oe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),at(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var c=this._map;if(!(!i.touches||i.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(p)._divideBy(2))),this._startDist=h.distanceTo(p),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Oe(document,"touchmove",this._onTouchMove,this),Oe(document,"touchend touchcancel",this._onTouchEnd,this),Dt(i)}},_onTouchMove:function(i){if(!(!i.touches||i.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]),j=h.distanceTo(p)/this._startDist;if(this._zoom=c.getScaleZoom(j,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&j<1||this._zoom>c.getMaxZoom()&&j>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,j===1)return}else{var T=h._add(p)._divideBy(2)._subtract(this._centerPoint);if(j===1&&T.x===0&&T.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(T),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),W(this._animRequest);var O=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(O,this,!0),Dt(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,W(this._animRequest),at(document,"touchmove",this._onTouchMove,this),at(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Je.addInitHook("addHandler","touchZoom",Ih),Je.BoxZoom=jh,Je.DoubleClickZoom=Sh,Je.Drag=Ch,Je.Keyboard=Nh,Je.ScrollWheelZoom=kh,Je.TapHold=bh,Je.TouchZoom=Ih,n.Bounds=xe,n.Browser=F,n.CRS=_e,n.Canvas=xh,n.Circle=ql,n.CircleMarker=eo,n.Class=$,n.Control=Dn,n.DivIcon=mh,n.DivOverlay=sr,n.DomEvent=Ry,n.DomUtil=Ja,n.Draggable=Hr,n.Evented=U,n.FeatureGroup=_r,n.GeoJSON=jr,n.GridLayer=Ys,n.Handler=ir,n.Icon=is,n.ImageOverlay=so,n.LatLng=ee,n.LatLngBounds=oe,n.Layer=zn,n.LayerGroup=rs,n.LineUtil=qy,n.Map=Je,n.Marker=Xa,n.Mixin=zy,n.Path=Zr,n.Point=H,n.PolyUtil=$y,n.Polygon=ss,n.Polyline=wr,n.Popup=ao,n.PosAnimation=Ju,n.Projection=Gy,n.Rectangle=wh,n.Renderer=Sr,n.SVG=Js,n.SVGOverlay=ph,n.TileLayer=os,n.Tooltip=oo,n.Transformation=ze,n.Util=V,n.VideoOverlay=fh,n.bind=l,n.bounds=ve,n.canvas=vh,n.circle=nx,n.circleMarker=tx,n.control=Vs,n.divIcon=ux,n.extend=o,n.featureGroup=Qy,n.geoJSON=hh,n.geoJson=sx,n.gridLayer=hx,n.icon=Xy,n.imageOverlay=ax,n.latLng=G,n.latLngBounds=D,n.layerGroup=Jy,n.map=Ay,n.marker=ex,n.point=ne,n.polygon=ix,n.polyline=rx,n.popup=cx,n.rectangle=mx,n.setOptions=_,n.stamp=u,n.svg=_h,n.svgOverlay=lx,n.tileLayer=gh,n.tooltip=dx,n.transformation=me,n.version=s,n.videoOverlay=ox;var yx=window.L;n.noConflict=function(){return window.L=yx,this},window.L=n})})(Md,Md.exports);var Ka=Md.exports;const Zi=wp(Ka);function Wu(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function Hu(e,t){return t==null?function(s,o){const a=v.useRef();return a.current||(a.current=e(s,o)),a}:function(s,o){const a=v.useRef();a.current||(a.current=e(s,o));const l=v.useRef(s),{instance:d}=a.current;return v.useEffect(function(){l.current!==s&&(t(d,s,l.current),l.current=s)},[d,s,o]),a}}function zj(e,t){v.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var a;(a=t.layerContainer)==null||a.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Cy(e){return function(n){const s=zu(),o=e($u(n,s),s);return _y(s.map,n.attribution),Sy(o.current,n.eventHandlers),zj(o.current,s),o}}function $j(e,t){const n=Hu(e,t),s=Cy(n);return Fj(s)}function Wj(e,t){const n=Hu(e),s=Dj(n,t);return Uj(s)}function Hj(e,t){const n=Hu(e,t),s=Cy(n);return Oj(s)}function Zj(e,t,n){const{opacity:s,zIndex:o}=t;s!=null&&s!==n.opacity&&e.setOpacity(s),o!=null&&o!==n.zIndex&&e.setZIndex(o)}function Vj(){return zu().map}function Fd(){return Fd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Fd.apply(this,arguments)}function qj({bounds:e,boundsOptions:t,center:n,children:s,className:o,id:a,placeholder:l,style:d,whenReady:u,zoom:f,...m},g){const[y]=v.useState({className:o,id:a,style:d}),[C,N]=v.useState(null);v.useImperativeHandle(g,()=>(C==null?void 0:C.map)??null,[C]);const _=v.useCallback(w=>{if(w!==null&&C===null){const x=new Ka.Map(w,m);n!=null&&f!=null?x.setView(n,f):e!=null&&x.fitBounds(e,t),u!=null&&x.whenReady(u),N(Aj(x))}},[]);v.useEffect(()=>()=>{C==null||C.map.remove()},[C]);const b=C?hr.createElement(jy,{value:C},s):l??null;return hr.createElement("div",Fd({},y,{ref:_}),b)}const Gj=v.forwardRef(qj),fp=$j(function({position:t,...n},s){const o=new Ka.Marker(t,n);return Wu(o,Mj(s,{overlayContainer:o}))},function(t,n,s){n.position!==s.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),pp=Wj(function(t,n){const s=new Ka.Popup(t,n.overlayContainer);return Wu(s,n)},function(t,n,{position:s},o){v.useEffect(function(){const{instance:l}=t;function d(f){f.popup===l&&(l.update(),o(!0))}function u(f){f.popup===l&&o(!1)}return n.map.on({popupopen:d,popupclose:u}),n.overlayContainer==null?(s!=null&&l.setLatLng(s),l.openOn(n.map)):n.overlayContainer.bindPopup(l),function(){var m;n.map.off({popupopen:d,popupclose:u}),(m=n.overlayContainer)==null||m.unbindPopup(),n.map.removeLayer(l)}},[t,n,o,s])}),Yj=Hj(function({url:t,...n},s){const o=new Ka.TileLayer(t,$u(n,s));return Wu(o,s)},function(t,n,s){Zj(t,n,s);const{url:o}=n;o!=null&&o!==s.url&&t.setUrl(o)});var mp={exports:{}};(function(e,t){(function(n,s){s(t)})(_p,function(n){var s=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var l=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,l?this._withAnimation:this._noAnimation),this._markerCluster=l?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof L.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(a,this._maxZoom),this.fire("layeradd",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var l=a,d=this._zoom;if(a.__parent)for(;l.__parent._zoom>=d;)l=l.__parent;return this._currentShownBounds.contains(l.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,l):this._animationAddLayerNonAnimated(a,l)),this},removeLayer:function(a){return a instanceof L.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,l){if(!L.Util.isArray(a))return this.addLayer(a);var d=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,m=this.options.chunkInterval,g=this.options.chunkProgress,y=a.length,C=0,N=!0,_;if(this._map){var b=new Date().getTime(),w=L.bind(function(){var k=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();C<y;C++){if(f&&C%200===0){var S=new Date().getTime()-k;if(S>m)break}if(_=a[C],_ instanceof L.LayerGroup){N&&(a=a.slice(),N=!1),this._extractNonGroupLayers(_,a),y=a.length;continue}if(!_.getLatLng){u.addLayer(_),l||this.fire("layeradd",{layer:_});continue}if(!this.hasLayer(_)&&(this._addLayer(_,this._maxZoom),l||this.fire("layeradd",{layer:_}),_.__parent&&_.__parent.getChildCount()===2)){var E=_.__parent.getAllChildMarkers(),P=E[0]===_?E[1]:E[0];d.removeLayer(P)}}g&&g(C,y,new Date().getTime()-b),C===y?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(w,this.options.chunkDelay)},this);w()}else for(var x=this._needsClustering;C<y;C++){if(_=a[C],_ instanceof L.LayerGroup){N&&(a=a.slice(),N=!1),this._extractNonGroupLayers(_,a),y=a.length;continue}if(!_.getLatLng){u.addLayer(_);continue}this.hasLayer(_)||x.push(_)}return this},removeLayers:function(a){var l,d,u=a.length,f=this._featureGroup,m=this._nonPointGroup,g=!0;if(!this._map){for(l=0;l<u;l++){if(d=a[l],d instanceof L.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(d,a),u=a.length;continue}this._arraySplice(this._needsClustering,d),m.removeLayer(d),this.hasLayer(d)&&this._needsRemoving.push({layer:d,latlng:d._latlng}),this.fire("layerremove",{layer:d})}return this}if(this._unspiderfy){this._unspiderfy();var y=a.slice(),C=u;for(l=0;l<C;l++){if(d=y[l],d instanceof L.LayerGroup){this._extractNonGroupLayers(d,y),C=y.length;continue}this._unspiderfyLayer(d)}}for(l=0;l<u;l++){if(d=a[l],d instanceof L.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(d,a),u=a.length;continue}if(!d.__parent){m.removeLayer(d),this.fire("layerremove",{layer:d});continue}this._removeLayer(d,!0,!0),this.fire("layerremove",{layer:d}),f.hasLayer(d)&&(f.removeLayer(d),d.clusterShow&&d.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this),delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var l=this._needsClustering.length-1;l>=0;l--)a.extend(this._needsClustering[l].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,l){var d=this._needsClustering.slice(),u=this._needsRemoving,f,m,g;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(d),m=d.length-1;m>=0;m--){for(f=!0,g=u.length-1;g>=0;g--)if(u[g].layer===d[m]){f=!1;break}f&&a.call(l,d[m])}this._nonPointGroup.eachLayer(a,l)},getLayers:function(){var a=[];return this.eachLayer(function(l){a.push(l)}),a},getLayer:function(a){var l=null;return a=parseInt(a,10),this.eachLayer(function(d){L.stamp(d)===a&&(l=d)}),l},hasLayer:function(a){if(!a)return!1;var l,d=this._needsClustering;for(l=d.length-1;l>=0;l--)if(d[l]===a)return!0;for(d=this._needsRemoving,l=d.length-1;l>=0;l--)if(d[l].layer===a)return!1;return!!(a.__parent&&a.__parent._group===this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,l){var d=this._map;typeof l!="function"&&(l=function(){});var u=function(){(d.hasLayer(a)||d.hasLayer(a.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),d.hasLayer(a)?l():a.__parent._icon&&(this.once("spiderfied",l,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?l():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var l,d,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(a),this._nonPointGroup.addTo(a),this._gridClusters||this._generateInitialClusters(),this._maxLat=a.options.crs.projection.MAX_LATITUDE,l=0,d=this._needsRemoving.length;l<d;l++)u=this._needsRemoving[l],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(l=0,d=this._needsRemoving.length;l<d;l++)u=this._needsRemoving[l],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),d=this._needsClustering,this._needsClustering=[],this.addLayers(d,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(a){for(var l=a;l&&!l._icon;)l=l.__parent;return l||null},_arraySplice:function(a,l){for(var d=a.length-1;d>=0;d--)if(a[d]===l)return a.splice(d,1),!0},_removeFromGridUnclustered:function(a,l){for(var d=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());l>=f&&u[l].removeObject(a,d.project(a.getLatLng(),l));l--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var l=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng),l&&a.target.openPopup()}},_moveChild:function(a,l,d){a._latlng=l,this.removeLayer(a),a._latlng=d,this.addLayer(a)},_childMarkerDragEnd:function(a){var l=a.target.__dragStart;delete a.target.__dragStart,l&&this._moveChild(a.target,l,a.target._latlng)},_removeLayer:function(a,l,d){var u=this._gridClusters,f=this._gridUnclustered,m=this._featureGroup,g=this._map,y=Math.floor(this._map.getMinZoom());l&&this._removeFromGridUnclustered(a,this._maxZoom);var C=a.__parent,N=C._markers,_;for(this._arraySplice(N,a);C&&(C._childCount--,C._boundsNeedUpdate=!0,!(C._zoom<y));)l&&C._childCount<=1?(_=C._markers[0]===a?C._markers[1]:C._markers[0],u[C._zoom].removeObject(C,g.project(C._cLatLng,C._zoom)),f[C._zoom].addObject(_,g.project(_.getLatLng(),C._zoom)),this._arraySplice(C.__parent._childClusters,C),C.__parent._markers.push(_),_.__parent=C.__parent,C._icon&&(m.removeLayer(C),d||m.addLayer(_))):C._iconNeedsUpdate=!0,C=C.__parent;delete a.__parent},_isOrIsParent:function(a,l){for(;l;){if(a===l)return!0;l=l.parentNode}return!1},fire:function(a,l,d){if(l&&l.layer instanceof L.MarkerCluster){if(l.originalEvent&&this._isOrIsParent(l.layer._icon,l.originalEvent.relatedTarget))return;a="cluster"+a}L.FeatureGroup.prototype.fire.call(this,a,l,d)},listens:function(a,l){return L.FeatureGroup.prototype.listens.call(this,a,l)||L.FeatureGroup.prototype.listens.call(this,"cluster"+a,l)},_defaultIconCreateFunction:function(a){var l=a.getChildCount(),d=" marker-cluster-";return l<10?d+="small":l<100?d+="medium":d+="large",new L.DivIcon({html:"<div><span>"+l+"</span></div>",className:"marker-cluster"+d,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,l=this.options.spiderfyOnMaxZoom,d=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(l||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),d&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){var l=a.layer,d=l;if(!(a.type==="clusterkeypress"&&a.originalEvent&&a.originalEvent.keyCode!==13)){for(;d._childClusters.length===1;)d=d._childClusters[0];d._zoom===this._maxZoom&&d._childCount===l._childCount&&this.options.spiderfyOnMaxZoom?l.spiderfy():this.options.zoomToBoundsOnClick&&l.zoomToBounds(),this.options.spiderfyOnEveryZoom&&l.spiderfy(),a.originalEvent&&a.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(a){var l=this._map;this._inZoomAnimation||(this._shownPolygon&&l.removeLayer(this._shownPolygon),a.layer.getChildCount()>2&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),l.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(a||d||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a),this._currentShownBounds=a}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),l=Math.floor(this._map.getMinZoom()),d=this.options.maxClusterRadius,u=d;typeof d!="function"&&(u=function(){return d}),this.options.disableClusteringAtZoom!==null&&(a=this.options.disableClusteringAtZoom-1),this._maxZoom=a,this._gridClusters={},this._gridUnclustered={};for(var f=a;f>=l;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,l-1)},_addLayer:function(a,l){var d=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),m,g;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(a),a.on(this._childMarkerEventHandlers,this);l>=f;l--){m=this._map.project(a.getLatLng(),l);var y=d[l].getNearObject(m);if(y){y._addChild(a),a.__parent=y;return}if(y=u[l].getNearObject(m),y){var C=y.__parent;C&&this._removeLayer(y,!1);var N=new this._markerCluster(this,l,y,a);d[l].addObject(N,this._map.project(N._cLatLng,l)),y.__parent=N,a.__parent=N;var _=N;for(g=l-1;g>C._zoom;g--)_=new this._markerCluster(this,g,_),d[g].addObject(_,this._map.project(y.getLatLng(),g));C._addChild(_),this._removeFromGridUnclustered(y,l);return}u[l].addObject(a,m)}this._topClusterLevel._addChild(a),a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue(),this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(a){var l=this._maxLat;return l!==void 0&&(a.getNorth()>=l&&(a._northEast.lat=1/0),a.getSouth()<=-l&&(a._southWest.lat=-1/0)),a},_animationAddLayerNonAnimated:function(a,l){if(l===a)this._featureGroup.addLayer(a);else if(l._childCount===2){l._addToMap();var d=l.getAllChildMarkers();this._featureGroup.removeLayer(d[0]),this._featureGroup.removeLayer(d[1])}else l._updateIcon()},_extractNonGroupLayers:function(a,l){var d=a.getLayers(),u=0,f;for(l=l||[];u<d.length;u++){if(f=d[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,l);continue}l.push(f)}return l},_overrideMarkerIcon:function(a){var l=a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}});return l}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,l){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(a,l){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(a,l){this._animationAddLayerNonAnimated(a,l)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(a,l){var d=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),m;this._ignoreMove=!0,this._topClusterLevel._recursively(d,a,f,function(g){var y=g._latlng,C=g._markers,N;for(d.contains(y)||(y=null),g._isSingleParent()&&a+1===l?(u.removeLayer(g),g._recursivelyAddChildrenToMap(null,l,d)):(g.clusterHide(),g._recursivelyAddChildrenToMap(y,l,d)),m=C.length-1;m>=0;m--)N=C[m],d.contains(N._latlng)||u.removeLayer(N)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(d,l),u.eachLayer(function(g){!(g instanceof L.MarkerCluster)&&g._icon&&g.clusterShow()}),this._topClusterLevel._recursively(d,a,l,function(g){g._recursivelyRestoreChildPositions(l)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(d,a,f,function(g){u.removeLayer(g),g.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(a,l){this._animationZoomOutSingle(this._topClusterLevel,a-1,l),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,l){var d=this,u=this._featureGroup;u.addLayer(a),l!==a&&(l._childCount>2?(l._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(l.getLatLng())),a.clusterHide(),this._enqueue(function(){u.removeLayer(a),a.clusterShow(),d._animationEnd()})):(this._forceLayout(),d._animationStart(),d._animationZoomOutSingle(l,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,l,d){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,l+1,d);var m=this;this._forceLayout(),a._recursivelyBecomeVisible(u,d),this._enqueue(function(){if(a._childCount===1){var g=a._markers[0];this._ignoreMove=!0,g.setLatLng(g.getLatLng()),this._ignoreMove=!1,g.clusterShow&&g.clusterShow()}else a._recursively(u,d,f,function(y){y._recursivelyRemoveChildrenFromMap(u,f,l+1)});m._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)};var o=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(a,l,d,u){L.Marker.prototype.initialize.call(this,d?d._cLatLng||d.getLatLng():new L.LatLng(0,0),{icon:this,pane:a.options.clusterPane}),this._group=a,this._zoom=l,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,d&&this._addChild(d),u&&this._addChild(u)},getAllChildMarkers:function(a,l){a=a||[];for(var d=this._childClusters.length-1;d>=0;d--)this._childClusters[d].getAllChildMarkers(a,l);for(var u=this._markers.length-1;u>=0;u--)l&&this._markers[u].__dragStart||a.push(this._markers[u]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){for(var l=this._childClusters.slice(),d=this._group._map,u=d.getBoundsZoom(this._bounds),f=this._zoom+1,m=d.getZoom(),g;l.length>0&&u>f;){f++;var y=[];for(g=0;g<l.length;g++)y=y.concat(l[g]._childClusters);l=y}u>f?this._group._map.setView(this._latlng,f):u<=m?this._group._map.setView(this._latlng,m+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,l){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(a),a instanceof L.MarkerCluster?(l||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(l||this._markers.push(a),this._childCount++),this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=1/0,a._southWest.lng=1/0),a._northEast&&(a._northEast.lat=-1/0,a._northEast.lng=-1/0)},_recalculateBounds:function(){var a=this._markers,l=this._childClusters,d=0,u=0,f=this._childCount,m,g,y,C;if(f!==0){for(this._resetBounds(),m=0;m<a.length;m++)y=a[m]._latlng,this._bounds.extend(y),d+=y.lat,u+=y.lng;for(m=0;m<l.length;m++)g=l[m],g._boundsNeedUpdate&&g._recalculateBounds(),this._bounds.extend(g._bounds),y=g._wLatLng,C=g._childCount,d+=y.lat*C,u+=y.lng*C;this._latlng=this._wLatLng=new L.LatLng(d/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,l,d){this._recursively(a,this._group._map.getMinZoom(),d-1,function(u){var f=u._markers,m,g;for(m=f.length-1;m>=0;m--)g=f[m],g._icon&&(g._setPos(l),g.clusterHide())},function(u){var f=u._childClusters,m,g;for(m=f.length-1;m>=0;m--)g=f[m],g._icon&&(g._setPos(l),g.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,l,d,u){this._recursively(a,u,l,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),d),f._isSingleParent()&&d-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,l,d)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(a,l){this._recursively(a,this._group._map.getMinZoom(),l,null,function(d){d.clusterShow()})},_recursivelyAddChildrenToMap:function(a,l,d){this._recursively(d,this._group._map.getMinZoom()-1,l,function(u){if(l!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var m=u._markers[f];d.contains(m._latlng)&&(a&&(m._backupLatlng=m.getLatLng(),m.setLatLng(a),m.clusterHide&&m.clusterHide()),u._group._featureGroup.addLayer(m))}},function(u){u._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var l=this._markers.length-1;l>=0;l--){var d=this._markers[l];d._backupLatlng&&(d.setLatLng(d._backupLatlng),delete d._backupLatlng)}if(a-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,l,d,u){var f,m;this._recursively(a,l-1,d-1,function(g){for(m=g._markers.length-1;m>=0;m--)f=g._markers[m],(!u||!u.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(g){for(m=g._childClusters.length-1;m>=0;m--)f=g._childClusters[m],(!u||!u.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(a,l,d,u,f){var m=this._childClusters,g=this._zoom,y,C;if(l<=g&&(u&&u(this),f&&g===d&&f(this)),g<l||g<d)for(y=m.length-1;y>=0;y--)C=m[y],C._boundsNeedUpdate&&C._recalculateBounds(),a.intersects(C._bounds)&&C._recursively(a,l,d,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var a=this.options.opacity;return this.setOpacity(0),this.options.opacity=a,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(a){this._cellSize=a,this._sqCellSize=a*a,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(a,l){var d=this._getCoord(l.x),u=this._getCoord(l.y),f=this._grid,m=f[u]=f[u]||{},g=m[d]=m[d]||[],y=L.Util.stamp(a);this._objectPoint[y]=l,g.push(a)},updateObject:function(a,l){this.removeObject(a),this.addObject(a,l)},removeObject:function(a,l){var d=this._getCoord(l.x),u=this._getCoord(l.y),f=this._grid,m=f[u]=f[u]||{},g=m[d]=m[d]||[],y,C;for(delete this._objectPoint[L.Util.stamp(a)],y=0,C=g.length;y<C;y++)if(g[y]===a)return g.splice(y,1),C===1&&delete m[d],!0},eachObject:function(a,l){var d,u,f,m,g,y,C,N=this._grid;for(d in N){g=N[d];for(u in g)for(y=g[u],f=0,m=y.length;f<m;f++)C=a.call(l,y[f]),C&&(f--,m--)}},getNearObject:function(a){var l=this._getCoord(a.x),d=this._getCoord(a.y),u,f,m,g,y,C,N,_,b=this._objectPoint,w=this._sqCellSize,x=null;for(u=d-1;u<=d+1;u++)if(g=this._grid[u],g){for(f=l-1;f<=l+1;f++)if(y=g[f],y)for(m=0,C=y.length;m<C;m++)N=y[m],_=this._sqDist(b[L.Util.stamp(N)],a),(_<w||_<=w&&x===null)&&(w=_,x=N)}return x},_getCoord:function(a){var l=Math.floor(a/this._cellSize);return isFinite(l)?l:a},_sqDist:function(a,l){var d=l.x-a.x,u=l.y-a.y;return d*d+u*u}},function(){L.QuickHull={getDistant:function(a,l){var d=l[1].lat-l[0].lat,u=l[0].lng-l[1].lng;return u*(a.lat-l[0].lat)+d*(a.lng-l[0].lng)},findMostDistantPointFromBaseLine:function(a,l){var d=0,u=null,f=[],m,g,y;for(m=l.length-1;m>=0;m--){if(g=l[m],y=this.getDistant(g,a),y>0)f.push(g);else continue;y>d&&(d=y,u=g)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(a,l){var d=[],u=this.findMostDistantPointFromBaseLine(a,l);return u.maxPoint?(d=d.concat(this.buildConvexHull([a[0],u.maxPoint],u.newPoints)),d=d.concat(this.buildConvexHull([u.maxPoint,a[1]],u.newPoints)),d):[a[0]]},getConvexHull:function(a){var l=!1,d=!1,u=!1,f=!1,m=null,g=null,y=null,C=null,N=null,_=null,b;for(b=a.length-1;b>=0;b--){var w=a[b];(l===!1||w.lat>l)&&(m=w,l=w.lat),(d===!1||w.lat<d)&&(g=w,d=w.lat),(u===!1||w.lng>u)&&(y=w,u=w.lng),(f===!1||w.lng<f)&&(C=w,f=w.lng)}d!==l?(_=g,N=m):(_=C,N=y);var x=[].concat(this.buildConvexHull([_,N],a),this.buildConvexHull([N,_],a));return x}}}(),L.MarkerCluster.include({getConvexHull:function(){var a=this.getAllChildMarkers(),l=[],d,u;for(u=a.length-1;u>=0;u--)d=a[u].getLatLng(),l.push(d);return L.QuickHull.getConvexHull(l)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var a=this.getAllChildMarkers(null,!0),l=this._group,d=l._map,u=d.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(a.length,u):a.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(a.length,u):(u.y+=10,f=this._generatePointsCircle(a.length,u)),this._animationSpiderfy(a,f)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,l){var d=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a),u=d/this._2PI,f=this._2PI/a,m=[],g,y;for(u=Math.max(u,35),m.length=a,g=0;g<a;g++)y=this._circleStartAngle+g*f,m[g]=new L.Point(l.x+u*Math.cos(y),l.y+u*Math.sin(y))._round();return m},_generatePointsSpiral:function(a,l){var d=this._group.options.spiderfyDistanceMultiplier,u=d*this._spiralLengthStart,f=d*this._spiralFootSeparation,m=d*this._spiralLengthFactor*this._2PI,g=0,y=[],C;for(y.length=a,C=a;C>=0;C--)C<a&&(y[C]=new L.Point(l.x+u*Math.cos(g),l.y+u*Math.sin(g))._round()),g+=f/u+C*5e-4,u+=m/g;return y},_noanimationUnspiderfy:function(){var a=this._group,l=a._map,d=a._featureGroup,u=this.getAllChildMarkers(null,!0),f,m;for(a._ignoreMove=!0,this.setOpacity(1),m=u.length-1;m>=0;m--)f=u[m],d.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(l.removeLayer(f._spiderLeg),delete f._spiderLeg);a.fire("unspiderfied",{cluster:this,markers:u}),a._ignoreMove=!1,a._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(a,l){var d=this._group,u=d._map,f=d._featureGroup,m=this._group.options.spiderLegPolylineOptions,g,y,C,N;for(d._ignoreMove=!0,g=0;g<a.length;g++)N=u.layerPointToLatLng(l[g]),y=a[g],C=new L.Polyline([this._latlng,N],m),u.addLayer(C),y._spiderLeg=C,y._preSpiderfyLatlng=y._latlng,y.setLatLng(N),y.setZIndexOffset&&y.setZIndexOffset(1e6),f.addLayer(y);this.setOpacity(.3),d._ignoreMove=!1,d.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(a,l){var d=this,u=this._group,f=u._map,m=u._featureGroup,g=this._latlng,y=f.latLngToLayerPoint(g),C=L.Path.SVG,N=L.extend({},this._group.options.spiderLegPolylineOptions),_=N.opacity,b,w,x,k,S,E;for(_===void 0&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),C?(N.opacity=0,N.className=(N.className||"")+" leaflet-cluster-spider-leg"):N.opacity=_,u._ignoreMove=!0,b=0;b<a.length;b++)w=a[b],E=f.layerPointToLatLng(l[b]),x=new L.Polyline([g,E],N),f.addLayer(x),w._spiderLeg=x,C&&(k=x._path,S=k.getTotalLength()+.1,k.style.strokeDasharray=S,k.style.strokeDashoffset=S),w.setZIndexOffset&&w.setZIndexOffset(1e6),w.clusterHide&&w.clusterHide(),m.addLayer(w),w._setPos&&w._setPos(y);for(u._forceLayout(),u._animationStart(),b=a.length-1;b>=0;b--)E=f.layerPointToLatLng(l[b]),w=a[b],w._preSpiderfyLatlng=w._latlng,w.setLatLng(E),w.clusterShow&&w.clusterShow(),C&&(x=w._spiderLeg,k=x._path,k.style.strokeDashoffset=0,x.setStyle({opacity:_}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:d,markers:a})},200)},_animationUnspiderfy:function(a){var l=this,d=this._group,u=d._map,f=d._featureGroup,m=a?u._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):u.latLngToLayerPoint(this._latlng),g=this.getAllChildMarkers(null,!0),y=L.Path.SVG,C,N,_,b,w,x;for(d._ignoreMove=!0,d._animationStart(),this.setOpacity(1),N=g.length-1;N>=0;N--)C=g[N],C._preSpiderfyLatlng&&(C.closePopup(),C.setLatLng(C._preSpiderfyLatlng),delete C._preSpiderfyLatlng,x=!0,C._setPos&&(C._setPos(m),x=!1),C.clusterHide&&(C.clusterHide(),x=!1),x&&f.removeLayer(C),y&&(_=C._spiderLeg,b=_._path,w=b.getTotalLength()+.1,b.style.strokeDashoffset=w,_.setStyle({opacity:0})));d._ignoreMove=!1,setTimeout(function(){var k=0;for(N=g.length-1;N>=0;N--)C=g[N],C._spiderLeg&&k++;for(N=g.length-1;N>=0;N--)C=g[N],C._spiderLeg&&(C.clusterShow&&C.clusterShow(),C.setZIndexOffset&&C.setZIndexOffset(0),k>1&&f.removeLayer(C),u.removeLayer(C._spiderLeg),delete C._spiderLeg);d._animationEnd(),d.fire("unspiderfied",{cluster:l,markers:g})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof L.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof L.LayerGroup?a=a._layers:a instanceof L.MarkerCluster?a=a.getAllChildMarkers():a instanceof L.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var l,d;for(l in a)for(d=a[l].__parent;d;)d._iconNeedsUpdate=!0,d=d.__parent},_refreshSingleMarkerModeMarkers:function(a){var l,d;for(l in a)d=a[l],this.hasLayer(d)&&d.setIcon(this._overrideMarkerIcon(d))}}),L.Marker.include({refreshIconOptions:function(a,l){var d=this.options.icon;return L.setOptions(d,a),this.setIcon(d),l&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),n.MarkerClusterGroup=s,n.MarkerCluster=o,Object.defineProperty(n,"__esModule",{value:!0})})})(mp,mp.exports);const Kj="https://nominatim.openstreetmap.org/search",Zu="ev_station_geocoding_cache",Vn=new Map;function Jj(){try{const e=localStorage.getItem(Zu);if(e){const t=JSON.parse(e);return Object.entries(t).forEach(([n,s])=>{Vn.set(n,s)}),console.log(` Loaded ${Vn.size} cached geocoding results from localStorage`),!0}}catch(e){console.warn(" Failed to load geocoding cache from localStorage:",e.message)}return!1}function Pc(){try{const e=Object.fromEntries(Vn);localStorage.setItem(Zu,JSON.stringify(e))}catch(e){console.warn(" Failed to save geocoding cache to localStorage:",e.message)}}Jj();async function Qj(e,t="Vietnam"){if(!e||typeof e!="string")return null;const n=`${e}|${t}`;if(Vn.has(n)){const s=Vn.get(n);return s&&console.log(` Geocoding cache hit for "${e}"`),s}try{const o=e.split(",").map(u=>u.trim())[0]||e,a=[`${e}, Vietnam`,`${o}, ${t}, Vietnam`,`${o} ${t} Vietnam`,e];console.log(` Geocoding address: "${e}" (city: "${t}")`);let l=null,d="";for(const u of a){d=u;const f=await fetch(`${Kj}?q=${encodeURIComponent(u)}&format=json&limit=10&timeout=10&accept-language=vi&countrycodes=vn`,{headers:{Accept:"application/json","User-Agent":"EVStationRental-FE"}});if(f.ok){if(l=await f.json(),Array.isArray(l)&&l.length>0){const m=l.filter(N=>{const _=(N.type||N.class||"").toLowerCase(),b=(N.addresstype||"").toLowerCase();return!["state","province","country"].includes(_)&&!["state","province","country"].includes(b)}),g=m.length>0?m:l,y=g.find(N=>{var w;const _=((w=N.display_name)==null?void 0:w.toLowerCase())||"",b=(t==null?void 0:t.toLowerCase())||"";return b&&_.includes(b)})||g[0],C={lat:parseFloat(y.lat),lng:parseFloat(y.lon)};if(!isNaN(C.lat)&&!isNaN(C.lng))return console.log(` Geocoded "${e}" (via "${d}")  ${C.lat.toFixed(4)}, ${C.lng.toFixed(4)}`),Vn.set(n,C),Pc(),C}await new Promise(m=>setTimeout(m,100))}}return console.warn(` Could not geocode: "${e}" (tried: ${a.join(" | ")})`),Vn.set(n,null),Pc(),null}catch(s){return console.error(` Geocoding error for "${e}":`,s.message),Vn.set(n,null),Pc(),null}}async function Xj(e,t=500){if(!Array.isArray(e)||e.length===0)return console.warn(" geocodeAddressesBatch: Empty or invalid items array"),new Map;const n=new Map;let s=0;for(const o of e){const a=o.address||o.Address||"",l=o.city||"Vietnam";if(!a){console.warn(` Station ${o.id}: No address found - skipping geocoding`),n.set(o.id,null);continue}const d=await Qj(a,l);d&&s++,n.set(o.id,d),e.indexOf(o)<e.length-1&&await new Promise(u=>setTimeout(u,t))}return console.log(` Batch geocoding complete: ${s}/${e.length} stations geocoded`),n}function eS(){var e;return{size:Vn.size,entries:Array.from(Vn.entries()),storageSize:((e=localStorage.getItem(Zu))==null?void 0:e.length)||0}}function tS(e,t="Vietnam"){const n=`${e}|${t}`;return Vn.get(n)||null}delete Zi.Icon.Default.prototype._getIconUrl;Zi.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const nS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),rS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),iS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),sS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function aS({stations:e,userLocation:t,stationCoords:n}){const s=Vj();return v.useEffect(()=>{if(!(!s||!e||e.length===0))try{const o=setTimeout(()=>{if(!s||!s._container)return;const a=[];let l=0;for(const u of e){const f=u.id||u.Id||u.stationId,m=n.get(f);m&&Number.isFinite(m.lat)&&Number.isFinite(m.lng)?(a.push([m.lat,m.lng]),l++):console.warn(` Station ${f} has invalid coords:`,m)}console.log(` Valid station markers for map: ${l}/${e.length}`),console.log(" Station markers array:",a.slice(0,5).map((u,f)=>` [${f}]: [${u[0]}, ${u[1]}]`).join(", "),l>5?`... +${l-5} more`:"");const d=(u,f,m,g)=>{const C=(m-u)*Math.PI/180,N=(g-f)*Math.PI/180,_=Math.sin(C/2)*Math.sin(C/2)+Math.cos(u*Math.PI/180)*Math.cos(m*Math.PI/180)*Math.sin(N/2)*Math.sin(N/2);return 6371*(2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_)))};if(a.length>0)try{if(t)console.log(` Zooming to user location: [${t.lat}, ${t.lng}]`),s.setView([t.lat,t.lng],14,{animate:!0,duration:.5}),console.log(" Zoomed to user location with zoom level 14");else{const u=a;console.log(` Building bounds from ${u.length} coordinates...`);const f=Zi.latLngBounds(u);console.log(` Bounds calculated: NE: ${f.getNorthEast()}, SW: ${f.getSouthWest()}`),console.log(" Calling fitBounds..."),s.fitBounds(f,{padding:[50,50],animate:!0,duration:.5}),console.log(" Fitted map bounds"),console.log(` Map zoom after fitBounds: ${s.getZoom()}`)}}catch(u){console.warn(" Error fitting bounds:",u.message),t&&s.setView([t.lat,t.lng],10)}else t&&s.setView([t.lat,t.lng],12)},100);return()=>clearTimeout(o)}catch(o){console.warn(" Error in MapController:",o.message)}},[s,e,t,n]),null}function oS({isOpen:e,onClose:t,stations:n,onSelectStation:s,selectedStationId:o,userLocation:a}){const[l,d]=v.useState(0),[u,f]=v.useState(new Map),[m,g]=v.useState(null),[y,C]=v.useState(!1),[N,_]=v.useState(!1),[b,w]=v.useState([]),[x,k]=v.useState(()=>{const P=localStorage.getItem("bookmarkedStations");return P?JSON.parse(P):[]}),S=P=>{k(R=>{const B=R.includes(P)?R.filter(A=>A!==P):[...R,P];return localStorage.setItem("bookmarkedStations",JSON.stringify(B)),B})};if(v.useEffect(()=>{if(!e||!n||n.length===0)return;const P=eS();g(P),console.log(" Geocoding cache stats:",P);const R=new Map;let B=0,A=0;const I=[];for(const $ of n){const Q=$.id||$.Id||$.stationId,ie=$.address||$.Address||"",U=$.stationName||$.name||$.Name||"Unknown",H=tS(ie,"Vietnam");H&&Number.isFinite(H.lat)&&Number.isFinite(H.lng)?(R.set(Q,H),B++):H===null?I.push(`${U} (address: "${ie}" - geocoding failed)`):H&&(!Number.isFinite(H.lat)||!Number.isFinite(H.lng))?I.push(`${U} (address: "${ie}" - invalid coords: lat=${H.lat}, lng=${H.lng})`):(A++,I.push(`${U} (address: "${ie}" - not geocoded yet)`))}console.log(` Using ${B}/${n.length} cached coordinates (${A} never attempted)`),I.length>0&&console.log(` Stations without valid coordinates (${I.length}):`,I),console.log(` stationCoords map contents (${R.size} entries):`);const M=new Map;let W=0;for(const[$,Q]of R){if(Q){const ie=`${Q.lat.toFixed(6)},${Q.lng.toFixed(6)}`;M.set(ie,(M.get(ie)||0)+1)}W<10&&(console.log(`  - ID: ${$} => ${Q?`[${Q.lat}, ${Q.lng}]`:"null"}`),W++)}const V=Array.from(M.entries()).filter(([$,Q])=>Q>1);V.length>0&&console.warn(` Found ${V.length} duplicate coordinates:`,V.map(([$,Q])=>`${$} (${Q} stations)`).join(", ")),w(V),f(R),_(!0),A>0?C(!0):C(!1)},[e,n]),!e)return null;const E=a||{lat:10.8231,lng:106.6297};return r.jsxs("div",{className:`map-modal ${e?"active":""}`,children:[r.jsxs("div",{className:"map-modal-header",children:[r.jsxs("h3",{children:[r.jsx("i",{className:"fas fa-map-marked-alt"})," Select Location on Map"]}),r.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:r.jsx("button",{className:"map-modal-close",onClick:t,children:r.jsx("i",{className:"fas fa-times"})})})]}),r.jsx("div",{className:"map-container",children:r.jsxs(Gj,{center:[E.lat,E.lng],zoom:12,style:{height:"100%",width:"100%"},zoomControl:!0,children:[r.jsx(Yj,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.jsx(aS,{stations:n,userLocation:a,stationCoords:u}),a&&r.jsx(fp,{position:[a.lat,a.lng],icon:nS,children:r.jsx(pp,{children:r.jsx("div",{style:{padding:"4px"},children:r.jsx("strong",{children:"Your Location"})})})}),N&&(()=>{let P=0,R=0;const B=n.map((A,I)=>{const M=A.id||A.Id||A.stationId,W=u.get(M),V=A.stationName||A.name||A.Name||"Unknown Station",$=A.address||A.Address||"";if(console.log(` Station ${I}: "${V}" | ID: ${M} | Coords: ${W?`[${W.lat}, ${W.lng}]`:"MISSING"}`),!W)return R++,null;P++;const Q=M===o,ie=x.includes(M),U=Q?sS:ie?iS:rS;return r.jsx(fp,{position:[W.lat,W.lng],icon:U,children:r.jsx(pp,{children:r.jsxs("div",{style:{padding:"8px",minWidth:"200px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#333"},children:V}),r.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#666"},children:$}),r.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:r.jsx("button",{onClick:()=>S(M),style:{background:ie?"#4caf50":"#2196f3",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",flex:1},children:ie?" Bookmarked":" Bookmark"})}),r.jsx("button",{onClick:()=>s(M,V,$),style:{background:"#ff6b35",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",width:"100%"},children:Q?" Selected":"Select Location"})]})})},M)});return console.log(` Total markers rendered: ${P}, skipped: ${R}`),P+R!==n.length&&console.error(` MISMATCH: Expected ${n.length} total but got ${P+R}`),B})()]},l)}),r.jsx("div",{className:"map-modal-footer",children:r.jsxs("p",{children:[r.jsx("i",{className:"fas fa-info-circle"})," Click on a marker to select a station",b.length>0&&r.jsx("span",{style:{color:"#f44336",marginLeft:"16px"}})]})})]})}function Ny({isOpen:e,onClose:t,stations:n=[],userLocation:s=null,onSearch:o,currentSearchData:a=null}){const[l,d]=v.useState(!1),[u,f]=v.useState(()=>{if(a)return{location:a.location||"",locationName:a.locationName||"Select location",pickupDate:a.pickupDate||new Date().toISOString().split("T")[0],pickupTime:a.pickupTime||"15:00",returnDate:a.returnDate||new Date(new Date().getTime()+24*60*60*1e3).toISOString().split("T")[0],returnTime:a.returnTime||"19:00",calendarMode:null,currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear()};const B=new Date,A=new Date(B.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:B.toISOString().split("T")[0],pickupTime:"15:00",returnDate:A.toISOString().split("T")[0],returnTime:"19:00",calendarMode:null,currentMonth:B.getMonth(),currentYear:B.getFullYear()}}),[m,g]=v.useState(""),y=Array.from({length:18},(B,A)=>`${(6+A).toString().padStart(2,"0")}:00`);v.useEffect(()=>{E()},[u.pickupDate,u.pickupTime,u.returnDate,u.returnTime]),v.useEffect(()=>{if(e){const B=document.querySelector(".search-modal-body");B&&(B.scrollTop=0)}},[e]),v.useEffect(()=>{e&&a&&f(B=>({...B,location:a.location||"",locationName:a.locationName||"Select location",pickupDate:a.pickupDate||B.pickupDate,pickupTime:a.pickupTime||"15:00",returnDate:a.returnDate||B.returnDate,returnTime:a.returnTime||"19:00"}))},[e,a]);function C(){d(!1),t()}function N(){d(!0)}function _(B,A,I){f(M=>({...M,location:B,locationName:A})),d(!1)}function b(B){f(A=>({...A,calendarMode:A.calendarMode===B?null:B}))}function w(B){const A=`${B}-time`;f(I=>({...I,calendarMode:I.calendarMode===A?null:A}))}function x(B){f(A=>{let I=A.currentMonth+B,M=A.currentYear;return I>11&&(I=0,M++),I<0&&(I=11,M--),{...A,currentMonth:I,currentYear:M}})}function k(B){f(A=>{const I={...A};if(A.calendarMode==="pickup"){I.pickupDate=B;const M=new Date(`${B}T${A.pickupTime}`);if(new Date(`${A.returnDate}T${A.returnTime}`)<=M){I.returnDate=B;const V=parseInt(A.pickupTime.split(":")[0]),$=Math.min(V+2,23);I.returnTime=`${$.toString().padStart(2,"0")}:00`}}else I.returnDate=B;return I.calendarMode=null,I})}function S(B,A){f(I=>({...I,[B+"Time"]:A,calendarMode:null}))}function E(){try{const B=new Date(`${u.pickupDate}T${u.pickupTime}`),I=new Date(`${u.returnDate}T${u.returnTime}`)-B,M=Math.floor(I/(1e3*60*60));if(M<0)return g("Invalid duration");if(M===0)return g("Less than 1 hour");const W=Math.floor(M/24),V=M%24;let $="";W>0&&($+=`${W} day${W>1?"s":""} `),V>0&&($+=`${V} hour${V>1?"s":""}`),g($.trim()||"0 hours")}catch{g("")}}function P(){if(!u.location){alert("Please select a pick-up location");return}const B=new Date(`${u.pickupDate}T${u.pickupTime}`),A=new Date(`${u.returnDate}T${u.returnTime}`);if(B<new Date){alert("Pick-up date and time must be in the future.");return}if(A<=B){alert("Return date and time must be after pick-up date and time.");return}if((A-B)/(1e3*60*60)<1){alert("Minimum rental duration is 1 hour.");return}o&&o(u)}function R(){const B=new Date(u.currentYear,u.currentMonth,1),A=new Date(u.currentYear,u.currentMonth+1,0),I=new Date;I.setHours(0,0,0,0);const M=[];for(let W=0;W<B.getDay();W++)M.push(r.jsx("div",{className:"calendar-day"},`empty-${W}`));for(let W=1;W<=A.getDate();W++){const V=`${u.currentYear}-${(u.currentMonth+1).toString().padStart(2,"0")}-${W.toString().padStart(2,"0")}`,$=new Date(u.currentYear,u.currentMonth,W),Q=$.toDateString()===I.toDateString(),ie=$<I,U=V===(u.calendarMode==="pickup"?u.pickupDate:u.returnDate),H=["calendar-day"];ie&&H.push("disabled"),Q&&H.push("today"),U&&H.push("selected"),M.push(r.jsx("div",{className:H.join(" "),onClick:()=>{ie||k(V)},children:W},V))}return M}return e?r.jsxs(r.Fragment,{children:[!l&&r.jsx("div",{className:"search-modal-backdrop",onClick:C}),r.jsx(oS,{isOpen:l,onClose:()=>d(!1),stations:n,onSelectStation:_,selectedStationId:u.location,userLocation:s}),r.jsx("div",{className:`search-modal ${e?"active":""} ${l?"with-map":""}`,children:r.jsxs("div",{className:"search-modal-content",children:[r.jsxs("div",{className:"search-modal-header",children:[r.jsx("h3",{children:"Search Cars"}),r.jsx("button",{className:"search-modal-close",onClick:C,children:""})]}),r.jsxs("div",{className:"search-modal-body",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),r.jsxs("div",{className:"search-input",onClick:N,children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),r.jsx("span",{children:u.locationName})]})]}),r.jsxs("div",{className:"search-field-row",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),r.jsxs("div",{className:"search-input",onClick:()=>b("pickup"),children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsx("span",{children:new Date(u.pickupDate).toLocaleDateString()})]}),u.calendarMode==="pickup"&&r.jsxs("div",{className:"calendar-dropdown active",children:[r.jsxs("div",{className:"calendar-header",children:[r.jsx("button",{onClick:()=>x(-1),children:"<"}),r.jsx("span",{children:new Date(u.currentYear,u.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{onClick:()=>x(1),children:">"})]}),r.jsxs("div",{className:"calendar-weekdays",children:[r.jsx("div",{children:"Sun"}),r.jsx("div",{children:"Mon"}),r.jsx("div",{children:"Tue"}),r.jsx("div",{children:"Wed"}),r.jsx("div",{children:"Thu"}),r.jsx("div",{children:"Fri"}),r.jsx("div",{children:"Sat"})]}),r.jsx("div",{className:"calendar-days",children:R()})]})]}),r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),r.jsxs("div",{className:"search-input",onClick:()=>w("pickup"),children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:u.pickupTime})]}),r.jsxs("div",{className:`time-picker-dropdown ${u.calendarMode==="pickup-time"?"active":""}`,children:[r.jsx("div",{className:"time-picker-label",children:"Choose pick-up time"}),r.jsx("div",{className:"time-picker-options",children:y.map(B=>r.jsx("div",{className:`time-option ${B===u.pickupTime?"selected":""}`,onClick:()=>S("pickup",B),children:B},B))})]})]})]}),r.jsxs("div",{className:"search-field-row",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),r.jsxs("div",{className:"search-input",onClick:()=>b("return"),children:[r.jsx("i",{className:"fas fa-calendar-check"}),r.jsx("span",{children:new Date(u.returnDate).toLocaleDateString()})]}),u.calendarMode==="return"&&r.jsxs("div",{className:"calendar-dropdown active",children:[r.jsxs("div",{className:"calendar-header",children:[r.jsx("button",{onClick:()=>x(-1),children:"<"}),r.jsx("span",{children:new Date(u.currentYear,u.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{onClick:()=>x(1),children:">"})]}),r.jsxs("div",{className:"calendar-weekdays",children:[r.jsx("div",{children:"Sun"}),r.jsx("div",{children:"Mon"}),r.jsx("div",{children:"Tue"}),r.jsx("div",{children:"Wed"}),r.jsx("div",{children:"Thu"}),r.jsx("div",{children:"Fri"}),r.jsx("div",{children:"Sat"})]}),r.jsx("div",{className:"calendar-days",children:R()})]})]}),r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-clock"})," Return Time"]}),r.jsxs("div",{className:"search-input",onClick:()=>w("return"),children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:u.returnTime})]}),r.jsxs("div",{className:`time-picker-dropdown ${u.calendarMode==="return-time"?"active":""}`,children:[r.jsx("div",{className:"time-picker-label",children:"Choose return time"}),r.jsx("div",{className:"time-picker-options",children:y.map(B=>r.jsx("div",{className:`time-option ${B===u.returnTime?"selected":""}`,onClick:()=>S("return",B),children:B},B))})]})]})]}),r.jsxs("div",{className:"rental-duration",children:[r.jsx("i",{className:"fas fa-info-circle"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Rental Duration"}),r.jsx("p",{children:m})]})]}),r.jsxs("div",{className:"rental-warning",children:[r.jsx("i",{className:"fas fa-exclamation-circle"}),r.jsx("p",{children:"Minimum rental duration is 1 hour. Same-day rentals are available. To ensure cars are properly prepared and meet environmental standards, please book at least 2 hours in advance."})]}),r.jsxs("button",{className:"btn-search-submit",onClick:P,children:[r.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})]})})]}):null}function lS(){const[e,t]=v.useState([]),[n,s]=v.useState([]),[o,a]=v.useState(!0),[l,d]=v.useState(0),u=v.useRef(null),[f,m]=v.useState(null),[g,y]=v.useState(!1),[C,N]=v.useState(0),_=["/Picture/E car 1.jpg","/Picture/E car 3.png","/Picture/E car 2.png"],b=v.useRef(null),{showToast:w}=Du();v.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(B=>{const A=B.coords.accuracy;m({lat:B.coords.latitude,lng:B.coords.longitude}),console.log(" User location:",B.coords.latitude,B.coords.longitude),console.log(" Accuracy:",A,"meters"),A>100&&console.warn(" Location accuracy is low (>"+A+"m). Position may not be precise.")},B=>{console.error(" Could not get user location:",B.message),m({lat:10.8231,lng:106.6297}),w("Could not detect your location. Using default location.","warning",3e3)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.warn("Geolocation is not supported by this browser"),m({lat:10.8231,lng:106.6297}),w("Your browser does not support geolocation","warning",3e3));const P=async()=>{try{if(!Ad.getAllStations){console.warn("stationApi.getAllStations not available");return}const B=await Ad.getAllStations(1,500);console.log(" Loaded stations in HomePage:",B.length,"items"),t(B||[]),B&&B.length>0&&(console.log(" Geocoding all stations in background..."),Xj(B,300))}catch(B){console.error("Failed to load stations",B)}},R=async()=>{try{if(!tt.getAllCars){console.warn("carApi.getAllCars not available"),a(!1);return}a(!0);const B=await tt.getAllCars(1,100);console.log(" Loaded cars in HomePage:",B.length,"items"),s(B||[])}catch(B){console.error("Failed to load cars",B)}finally{a(!1)}};P(),R()},[]),v.useEffect(()=>{if(g)return;const P=setInterval(()=>{N(R=>(R+1)%_.length)},6e3);return()=>clearInterval(P)},[_.length,g]),v.useEffect(()=>{const P=u.current;if(!P)return;const R=P.querySelector(".car-card-item");if(!R)return;const B=R.offsetWidth,I=l*(B+20);P.style.transform=`translateX(-${I}px)`},[l,n]),v.useEffect(()=>{const P=()=>{const R=b.current;if(!R)return;const B=document.querySelector(".header"),A=B?B.offsetHeight:80;window.scrollY>A+50?(R.classList.add("sticky"),R.style.top=`${A}px`):(R.classList.remove("sticky"),R.style.top="")};return window.addEventListener("scroll",P,{passive:!0}),P(),()=>window.removeEventListener("scroll",P)},[]);function x(){y(!0)}function k(){y(!1)}function S(P){const R={stationId:P.location,stationName:P.locationName,pickupDate:P.pickupDate,pickupTime:P.pickupTime,returnDate:P.returnDate,returnTime:P.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(R))}catch{}const B=new URLSearchParams({location:P.location,"pickup-date":P.pickupDate,"pickup-time":P.pickupTime,"return-date":P.returnDate,"return-time":P.returnTime});window.location.href=`/cars?${B.toString()}`}function E(){const P=u.current;if(!P)return;const R=P.querySelector(".car-card-item");if(!R)return;const B=Math.floor(P.parentElement.offsetWidth/(R.offsetWidth+20))||1,A=Math.min(n.length,10),I=Math.max(0,Math.ceil(A-B));d(M=>Math.min(I,M+1))}return r.jsxs("main",{children:[r.jsxs("section",{className:"hero-slideshow",children:[r.jsx("div",{className:"slideshow-container",children:_.map((P,R)=>r.jsx("div",{className:`slide fade ${R===C?"active":""}`,children:r.jsx("img",{src:P,alt:`Electric Car ${R+1}`})},R))}),r.jsx("div",{className:"search-form-overlay",id:"searchFormOverlay",ref:b,children:r.jsx("div",{className:"container",children:r.jsxs("div",{className:"search-form-wrapper",children:[r.jsx("h2",{children:"Find Your Perfect Rental Car"}),r.jsxs("div",{className:"search-summary",children:[r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Location"}),r.jsx("div",{className:"summary-value",id:"summaryLocation",children:"Select location"})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Date"}),r.jsx("div",{className:"summary-value",children:new Date().toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Time"}),r.jsx("div",{className:"summary-value",children:"15:00"})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Return Date"}),r.jsx("div",{className:"summary-value",children:new Date(Date.now()+24*60*60*1e3).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Return Time"}),r.jsx("div",{className:"summary-value",children:"19:00"})]}),r.jsxs("button",{type:"button",className:"btn-search",onClick:x,children:[r.jsx("i",{className:"fas fa-search"})," SEARCH"]})]})]})})})]}),r.jsx(Ny,{isOpen:g,onClose:k,stations:e,userLocation:f,onSearch:S}),r.jsx("section",{className:"car-section","data-type":"models",children:r.jsxs("div",{className:"container",children:[r.jsx("div",{className:"car-section-header",children:r.jsx("h2",{children:"Our Electric Car Models"})}),r.jsxs("div",{className:"car-carousel-wrapper",children:[r.jsx("button",{className:"carousel-nav prev-carousel",onClick:()=>d(P=>Math.max(0,P-1)),children:r.jsx("i",{className:"fas fa-chevron-left"})}),r.jsx("div",{className:"car-carousel-container",id:"carCarouselContainer",children:r.jsxs("div",{className:"car-carousel-inner",id:"carCarouselInner",ref:u,children:[o&&r.jsx("div",{className:"car-card-item loading-placeholder",style:{textAlign:"center",padding:20},children:"Loading cars..."}),!o&&n.slice(0,10).map((P,R)=>{P.id||P.Id||P.carId;const B=P.name||P.Name||P.model||P.modelName||"Unknown",A=P.imageUrl||P.ImageUrl||P.image||"/Picture/E car 1.jpg",I=parseFloat(P.rentalPricePerHour||P.RentalPricePerHour||0),M=P.seats||P.Seats;return r.jsxs("div",{className:"car-card-item",children:[r.jsx("div",{className:"car-image",children:r.jsx("img",{src:A,alt:B,onError:W=>W.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"car-info",children:[r.jsx("h3",{className:"car-name",children:B}),r.jsxs("div",{className:"car-price-simple",children:[r.jsx("span",{className:"price-amount",children:Kt(I)}),r.jsx("span",{className:"price-label",children:"/hour"})]}),r.jsx("div",{className:"car-specs",children:M?r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-users"})," ",M," Seats"]}):null})]})]},R)})]})}),r.jsx("button",{className:"carousel-nav next-carousel",onClick:()=>E(),children:r.jsx("i",{className:"fas fa-chevron-right"})})]})]})})]})}function cS(){const[e,t]=v.useState([]),[n,s]=v.useState([]),[o,a]=v.useState(!0),[l,d]=v.useState([]),[u,f]=v.useState({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),[m,g]=v.useState("default"),[y,C]=v.useState(()=>{const I=new Date,M=new Date(I.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:I.toISOString().split("T")[0],pickupTime:"07:00",returnDate:M.toISOString().split("T")[0],returnTime:"24:00"}}),[N,_]=v.useState(!1),[b,w]=v.useState(null);v.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(I=>{w({lat:I.coords.latitude,lng:I.coords.longitude})},I=>{console.error(" Could not get user location:",I.message),w({lat:10.8231,lng:106.6297})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):w({lat:10.8231,lng:106.6297}),x(),k()},[]);const x=async()=>{try{const I=await Ad.getAllStations(1,500);d(I||[])}catch(I){console.error("Failed to load stations",I)}},k=async()=>{try{a(!0);let I=null,M=null;try{const V=JSON.parse(localStorage.getItem("rentalContext")||"null");V&&(I=V.stationId,M=V,C($=>({...$,location:V.stationId,locationName:V.stationName,pickupDate:V.pickupDate,pickupTime:V.pickupTime,returnDate:V.returnDate,returnTime:V.returnTime})))}catch{}let W=[];if(I&&M){console.log(" Loading cars for station:",I);try{const V=`${M.pickupDate}T${M.pickupTime}:00`,$=`${M.returnDate}T${M.returnTime}:00`;console.log(" Pickup DateTime (local):",V),console.log(" Return DateTime (local):",$),W=await tt.getAvailableCarsByStation(I,V,$),console.log(" Found",W.length,"cars at this station")}catch(V){console.error("Failed to load cars by station, falling back to all cars",V),W=await tt.getAllCars(1,100)}}else W=await tt.getAllCars(1,100);t(W||[]),s(W||[])}catch(I){console.error(I)}finally{a(!1)}};function S(){_(!0)}function E(){_(!1)}function P(I){C({location:I.location,locationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime});const M={stationId:I.location,stationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(M))}catch{}a(!0);const W=`${I.pickupDate}T${I.pickupTime}:00`,V=`${I.returnDate}T${I.returnTime}:00`;console.log(" Pickup DateTime (local):",W),console.log(" Return DateTime (local):",V),tt.getAvailableCarsByStation(I.location,W,V).then($=>{t($||[]),s($||[]),a(!1),E()}).catch($=>{console.error("Failed to load station cars:",$),alert("Failed to load cars for this station"),a(!1)})}v.useEffect(()=>{let I=[...e];u.brand&&(I=I.filter(M=>(M.brand||"").toLowerCase().includes(u.brand.toLowerCase()))),u.color&&(I=I.filter(M=>(M.color||"").toLowerCase().includes(u.color.toLowerCase()))),u.seats&&(I=I.filter(M=>M.seats===parseInt(u.seats))),u.year&&(I=I.filter(M=>M.year>=parseInt(u.year))),u.priceMin&&(I=I.filter(M=>parseFloat(M.rentalPricePerHour||0)>=parseFloat(u.priceMin))),u.priceMax&&(I=I.filter(M=>parseFloat(M.rentalPricePerHour||0)<=parseFloat(u.priceMax))),m==="name-asc"?I.sort((M,W)=>{const V=`${M.brand||""} ${M.model||""}`.trim().toLowerCase(),$=`${W.brand||""} ${W.model||""}`.trim().toLowerCase();return V.localeCompare($)}):m==="name-desc"?I.sort((M,W)=>{const V=`${M.brand||""} ${M.model||""}`.trim().toLowerCase();return`${W.brand||""} ${W.model||""}`.trim().toLowerCase().localeCompare(V)}):m==="price-asc"?I.sort((M,W)=>{const V=parseFloat(M.rentalPricePerHour||M.RentalPricePerHour||0),$=parseFloat(W.rentalPricePerHour||W.RentalPricePerHour||0);return V-$}):m==="price-desc"&&I.sort((M,W)=>{const V=parseFloat(M.rentalPricePerHour||M.RentalPricePerHour||0);return parseFloat(W.rentalPricePerHour||W.RentalPricePerHour||0)-V}),s(I)},[e,u,m]);const R=()=>{f({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),s(e)},B=[...new Set(e.map(I=>I.brand).filter(Boolean))],A=[...new Set(e.map(I=>I.color).filter(Boolean))];return Array.from({length:18},(I,M)=>`${(6+M).toString().padStart(2,"0")}:00`),r.jsxs("main",{className:"car-list-main",children:[r.jsx("div",{className:"search-form-container",children:r.jsxs("div",{className:"search-summary",children:[r.jsxs("div",{className:"summary-item",onClick:S,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),r.jsx("div",{className:"summary-value",children:y.locationName})]}),r.jsxs("div",{className:"summary-item",onClick:S,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),r.jsx("div",{className:"summary-value",children:new Date(y.pickupDate).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:S,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),r.jsx("div",{className:"summary-value",children:y.pickupTime})]}),r.jsxs("div",{className:"summary-item",onClick:S,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),r.jsx("div",{className:"summary-value",children:new Date(y.returnDate).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:S,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-clock"})," Return Time"]}),r.jsx("div",{className:"summary-value",children:y.returnTime})]}),r.jsxs("button",{className:"btn-search-submit",onClick:S,children:[r.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})}),r.jsxs("div",{className:"container",children:[r.jsxs("aside",{className:"filters-sidebar",children:[r.jsx("h3",{className:"filters-title",children:"Filters"}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Brand"}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:u.brand,onChange:I=>f({...u,brand:I.target.value}),children:[r.jsx("option",{value:"",children:"Any Brand"}),B.map(I=>r.jsx("option",{value:I,children:I},I))]})})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Color"}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:u.color,onChange:I=>f({...u,color:I.target.value}),children:[r.jsx("option",{value:"",children:"Any Color"}),A.map(I=>r.jsx("option",{value:I,children:I},I))]})})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Specifications"}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Seats"}),r.jsxs("select",{value:u.seats,onChange:I=>f({...u,seats:I.target.value}),children:[r.jsx("option",{value:"",children:"Any"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"4",children:"4"}),r.jsx("option",{value:"5",children:"5"}),r.jsx("option",{value:"7",children:"7"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Year (min)"}),r.jsx("input",{type:"number",min:"1900",max:"2100",placeholder:"2020",value:u.year,onChange:I=>f({...u,year:I.target.value})})]})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Price Range"}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Min Price (VND/hour)"}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:u.priceMin,onChange:I=>f({...u,priceMin:I.target.value})})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Max Price (VND/hour)"}),r.jsx("input",{type:"number",min:"0",placeholder:"999,000",value:u.priceMax,onChange:I=>f({...u,priceMax:I.target.value})})]})]}),r.jsx("div",{className:"filter-actions",children:r.jsx("button",{type:"button",className:"btn-reset-filters",onClick:R,children:"Reset Filters"})})]}),r.jsxs("div",{className:"cars-content",children:[r.jsxs("div",{className:"cars-header",children:[r.jsxs("div",{children:[r.jsx("h2",{children:"Available Cars"}),r.jsxs("div",{className:"cars-count",children:["Showing ",n.length," cars"]})]}),r.jsxs("div",{className:"sort-controls",children:[r.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),r.jsxs("select",{id:"sortBy",value:m,onChange:I=>g(I.target.value),className:"sort-select",children:[r.jsx("option",{value:"default",children:"Default"}),r.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),r.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),r.jsx("option",{value:"price-asc",children:"Price (Low to High)"}),r.jsx("option",{value:"price-desc",children:"Price (High to Low)"})]})]})]}),r.jsxs("div",{className:"car-list",children:[o&&r.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading cars..."}),!o&&n.length===0&&r.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"No cars found"}),!o&&n.map((I,M)=>{const W=I.id||I.Id,V=`${I.brand||""} ${I.model||"Car"}`.trim(),$=I.imageUrl||I.image||"/Picture/E car 1.jpg",Q=parseFloat(I.rentalPricePerHour||I.RentalPricePerHour||0),ie=I.seats||I.Seats||5,U=I.year||"",H=I.color||"N/A";return r.jsxs("div",{className:"car-card",onClick:()=>window.location.href=`/cars/${W}`,children:[r.jsx("div",{className:"car-image",children:r.jsx("img",{src:$,alt:V,onError:he=>he.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"car-info",children:[r.jsxs("div",{className:"car-info-top",children:[r.jsxs("div",{children:[r.jsx("div",{className:"car-name",children:V}),r.jsxs("div",{className:"car-location",children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),y.locationName||"Location"]})]}),r.jsxs("div",{className:"car-pricing",children:[r.jsx("div",{className:"car-price",children:Kt(Q)}),r.jsx("div",{className:"car-price-label",children:"/hour"})]})]}),r.jsxs("div",{className:"car-details",children:[r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-palette"})," ",H]}),r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-calendar"})," ",U||"N/A"]}),r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-users"})," ",ie," seats"]})]})]})]},M)})]})]})," "]})," ",r.jsx(Ny,{isOpen:N,onClose:E,stations:l,userLocation:b,onSearch:P,currentSearchData:y})]})}const gp=(e={},t={})=>{const n=[];return(!e.fullName||e.fullName.trim()==="")&&n.push("Full Name"),(!e.email||e.email.trim()==="")&&n.push("Email"),(!e.phoneNumber||e.phoneNumber.trim()==="")&&n.push("Phone Number"),(!e.dateOfBirth||e.dateOfBirth.trim()==="")&&n.push("Date of Birth"),(!t.cccdFront||t.cccdFront.trim()==="")&&n.push("CCCD Front Image"),(!t.cccdBack||t.cccdBack.trim()==="")&&n.push("CCCD Back Image"),(!t.licenseFront||t.licenseFront.trim()==="")&&n.push("Driver License Front Image"),(!t.licenseBack||t.licenseBack.trim()==="")&&n.push("Driver License Back Image"),{isComplete:n.length===0,missingFields:n}};function dS(){const{id:e}=$g(),t=on(),[n,s]=v.useState(null),[o,a]=v.useState(!0),[l,d]=v.useState({}),[u,f]=v.useState({}),[m,g]=v.useState(!1),[y,C]=v.useState({isOpen:!1,type:"error",title:"",message:""});if(v.useEffect(()=>{(async()=>{try{const x=await vt.getMyProfile();d(x||{});const S=await vt.getMe()||{},E={cccdFront:S.cccdImageUrl_Front||"",cccdBack:S.cccdImageUrl_Back||"",licenseFront:S.gplxImageUrl_Front||"",licenseBack:S.gplxImageUrl_Back||""};f(E);const{isComplete:P}=gp(x,E);g(P)}catch(x){console.error(" Error loading profile:",x),g(!1)}})()},[]),v.useEffect(()=>{e&&(async()=>{try{a(!0);const x=await tt.getCarById(e);s(x)}catch(x){console.error(x)}finally{a(!1)}})()},[e]),o)return r.jsx("main",{className:"car-detail-main",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"loading-message",children:"Loading..."})})});if(!n)return r.jsx("main",{className:"car-detail-main",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"error-message",children:"Car not found"})})});const N=n.imageUrl||n.image||"/Picture/E car 1.jpg",_=`${n.brand||""} ${n.model||"Car"}`.trim(),b=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return r.jsxs("main",{className:"car-detail-main",children:[r.jsx(Fr,{isOpen:y.isOpen,onClose:()=>C(w=>({...w,isOpen:!1})),type:y.type,title:y.title,message:y.message}),r.jsxs("div",{className:"container",children:[r.jsxs("button",{className:"back-btn",onClick:()=>t("/cars"),children:[r.jsx("i",{className:"fas fa-arrow-left"})," Back to Cars"]}),r.jsxs("div",{className:"car-detail-grid",children:[r.jsxs("div",{className:"car-left-section",children:[r.jsx("div",{className:"car-image-section",children:r.jsx("div",{className:"main-image",children:r.jsx("img",{src:N,alt:_,onError:w=>w.currentTarget.src="/Picture/E car 1.jpg"})})}),r.jsxs("div",{className:"car-specs",children:[r.jsx("h3",{children:"Car Information"}),r.jsxs("div",{className:"specs-grid",children:[r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-car"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Brand"}),r.jsx("div",{className:"spec-value",children:n.brand||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-palette"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Color"}),r.jsx("div",{className:"spec-value",children:n.color||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-users"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Seats"}),r.jsx("div",{className:"spec-value",children:n.seats||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Year"}),r.jsx("div",{className:"spec-value",children:n.year||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-battery-full"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Battery Range"}),r.jsxs("div",{className:"spec-value",children:[n.batteryCapacity||"N/A"," km"]})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-cog"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Transmission"}),r.jsx("div",{className:"spec-value",children:n.transmission||"Automatic"})]})]})]})]}),n.description&&r.jsxs("div",{className:"car-description",children:[r.jsx("h3",{children:"Description"}),r.jsx("p",{children:n.description||n.Description})]})]}),r.jsx("div",{className:"car-right-section",children:r.jsxs("div",{className:"pricing-card",children:[r.jsxs("div",{className:"car-header",children:[r.jsx("h1",{className:"car-title",children:_}),n.year&&r.jsx("span",{className:"car-year",children:n.year})]}),r.jsxs("div",{className:"price-section",children:[r.jsx("div",{className:"price-label",children:"Rental Price"}),r.jsxs("div",{className:"price-value",children:[Kt(b),"/hour"]}),r.jsxs("div",{className:"price-note",children:["Estimated daily rate: ",Kt(Math.round(b*24)),"/day"]})]}),r.jsxs("div",{className:"rental-info",children:[r.jsx("h3",{children:"Rental Details"}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:"Minimum rental: 1 hour"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-shield-alt"}),r.jsx("span",{children:"Insurance included"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-gas-pump"}),r.jsx("span",{children:"Fuel policy: Same to same"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-map-marked-alt"}),r.jsx("span",{children:"Unlimited mileage"})]})]}),r.jsxs("button",{className:"book-now-btn",onClick:()=>{if(!m){const{missingFields:w}=gp(l,u);C({isOpen:!0,type:"warning",title:" Incomplete Profile",message:`Please complete your profile before booking.

Missing fields:
${w.join(", ")}

You will be redirected to update your profile.`}),setTimeout(()=>{t("/profile")},2e3);return}localStorage.setItem("selectedCarId",n.id||n.Id),t("/payment")},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",m?"Book Now":"Complete Profile First"]})]})})]})]})]})}const nn={createBooking:async(e,t)=>{var n,s,o,a;try{console.log(" Creating booking for user:",t),console.log(" Booking data:",e);const l={carId:e.carId,stationId:e.pickupStationId||e.returnStationId||e.stationId,pickupDateTime:e.pickupDateTime,expectedReturnDateTime:e.expectedReturnDateTime};console.log(" Sending payload:",l);const d=await te.post(`/Bookings/Create-With-Deposit?userId=${encodeURIComponent(t)}`,l);return console.log(" Booking created:",d.data),((n=d.data)==null?void 0:n.data)||d.data||{}}catch(l){throw console.error(" Error creating booking:",((s=l.response)==null?void 0:s.data)||l.message),(a=(o=l.response)==null?void 0:o.data)!=null&&a.errors&&console.error(" Validation errors:",l.response.data.errors),l}},confirmBooking:async(e,t,n="")=>{var s,o;try{console.log(" Confirming booking:",e);const a={bookingId:e,paymentMethod:t,paymentTransactionId:n},l=await te.post("/Bookings/Confirm",a);return console.log(" Booking confirmed:",l.data),((s=l.data)==null?void 0:s.data)||l.data||{}}catch(a){throw console.error(" Error confirming booking:",((o=a.response)==null?void 0:o.data)||a.message),a}},completeBooking:async e=>{var t,n;try{console.log(" Completing booking:",e);const s=await te.post(`/Bookings/Complete-By-${encodeURIComponent(e)}`);return console.log(" Booking completed:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error completing booking:",((n=s.response)==null?void 0:n.data)||s.message),s}},getUserBookings:async e=>{var t;try{console.log(" Fetching bookings for current user");const n=await te.get("/Bookings/My-Bookings");console.log(" Raw /Bookings/My-Bookings response:",n.data);const s=n.data||{};return Array.isArray(s)?(console.log(" Returning bookings (direct array), count:",s.length),s):s.data&&Array.isArray(s.data)?(console.log(" Returning bookings from response.data, count:",s.data.length),s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning bookings from response.data.data, count:",s.data.data.length),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning bookings from response.data.items, count:",s.data.items.length),s.data.items):s.items&&Array.isArray(s.items)?(console.log(" Returning bookings from response.items, count:",s.items.length),s.items):s.bookings&&Array.isArray(s.bookings)?(console.log(" Returning bookings from response.bookings, count:",s.bookings.length),s.bookings):s&&(s.id||s.bookingId||s.bookingStatus)?(console.log(" Response looks like a single booking object, wrapping in array"),[s]):(console.warn(" No bookings array found in /Bookings/My-Bookings response; returning empty array"),[])}catch(n){if(console.error(" Error fetching user bookings:",((t=n.response)==null?void 0:t.data)||n.message),n.response&&n.response.status===401)throw n;return[]}},cancelBooking:async(e,t)=>{var n,s;try{console.log(" Cancelling booking:",e);const o=await te.post(`/Bookings/Cancel-By-${encodeURIComponent(e)}`,null,{params:{userId:t}});return console.log(" Booking cancelled:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error cancelling booking:",((s=o.response)==null?void 0:s.data)||o.message),o}},getBookingById:async e=>{var t,n;try{console.log(" Fetching booking details for ID:",e);const s=await te.get(`/Bookings/Get-By-${encodeURIComponent(e)}`);return console.log(" Booking details:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking details:",((n=s.response)==null?void 0:n.data)||s.message),s}}},fr={getContractByBooking:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Booking/${t}`,`/Contract/Get-By-Booking/${t}`,`/Contracts/By-Booking/${t}`,`/contracts/booking/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},getContractByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contract/Get-By-Renter/${t}`,`/Contracts/By-Renter/${t}`,`/contracts/renter/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createRentalContract:async(e,t=null,n=null)=>{var l;if(!e)throw new Error("bookingId is required");let s=`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(e)}`;t&&(s+=`&renterId=${encodeURIComponent(t)}`);const o=[{url:s,method:"post",data:n},{url:"/Contracts/Create",method:"post",data:{bookingId:e}},{url:"/Contract/Create",method:"post",data:{bookingId:e}}];let a;for(const d of o)try{const u=await te[d.method](d.url,d.data||{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create contract endpoint not found")},sendContractEmail:async(e,t=null)=>{var a,l,d;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e);console.log(" sendContractEmail called with contractId:",e,"email:",t);const s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,"/Contract/SendEmail"];let o;for(const u of s)try{console.log(" Trying endpoint:",u);const f=await te.post(u,t?{email:t}:{}),m=f==null?void 0:f.data;return console.log(" Success on endpoint:",u,"response:",m),m&&typeof m=="object"&&"data"in m?m.data:m}catch(f){console.warn(" Failed on endpoint:",u,"status:",(a=f==null?void 0:f.response)==null?void 0:a.status,"error:",((l=f==null?void 0:f.response)==null?void 0:l.data)||(f==null?void 0:f.message)),o=f;const m=(d=f==null?void 0:f.response)==null?void 0:d.status;if(m&&m!==404&&m!==405)throw f}throw console.error(" All endpoints failed for sendContractEmail"),o||new Error("Send contract email endpoint not found")},isContractConfirmed:async e=>{var s;if(!e)return!1;const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/xac-nhan`,`/Contracts/Get-By-Booking/${t}`,`/Contracts/${t}/Is-Confirmed`,"/Contract/IsConfirmed"];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;return d===!0||(d==null?void 0:d.isConfirmed)===!0||(d==null?void 0:d.IsConfirmed)===!0}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return!1},confirmContractSigning:async e=>{var o;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/ky`,`/Contracts/${t}/Confirm`,"/Contract/ConfirmSigning"];let s;for(const a of n)try{const l=await te.post(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Confirm contract signing endpoint not found")},deleteContract:async e=>{var o;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}`,`/Contracts/${t}`,`/Contract/Delete/${t}`];let s;for(const a of n)try{const l=await te.delete(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Delete contract endpoint not found")},downloadContract:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/${t}/Download`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract endpoint not found")},getContractDownloadByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Get contract download link endpoint not found")},getContractViewingByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/View/${t}`,`/Contract/View/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createContract:async e=>{var s;const t=[{url:"/Contracts/Create",method:"post"},{url:"/Contract/Create",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Create contract endpoint not found")},fillContract:async e=>{var s;const t=[{url:"/Contracts/Fill",method:"post"},{url:"/Contract/Fill",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Fill contract endpoint not found")},requestConfirmation:async(e,t)=>{var a;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e),s=[`/Contracts/Request-Confirmation-By-${n}`,`/Contracts/${n}/Request-Confirmation`,`/Contract/RequestConfirmation/${n}`];let o;for(const l of s)try{const d=await te.post(l,{email:t}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Request confirmation endpoint not found")},confirmContract:async e=>{var s;const t=[{url:"/Contracts/Confirm",method:"post"},{url:"/Contract/Confirm",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Confirm contract endpoint not found")},getContractsByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contracts/Renter/${t}`,`/Contract/Get-By-Renter/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createHopDong:async(e,t,n)=>{var l;if(!t||!n)throw new Error("bookingId and renterId are required");const o=[{url:`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(t)}&renterId=${encodeURIComponent(n)}`,method:"post"},{url:"/Contracts/Create",method:"post"}];let a;for(const d of o)try{const u=await te[d.method](d.url,e),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create HopDong endpoint not found")},sendConfirmationEmail:async(e,t)=>{var a;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e),s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,`/Contract/SendEmail/${n}`];let o;for(const l of s)try{const d=await te.post(l,{email:t}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Send confirmation email endpoint not found")},getContractForConfirmation:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/xac-nhan/${t}`,`/Contracts/Confirmation/${t}`,`/Contract/GetForConfirmation/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},signContract:async e=>{var s;if(!e)throw new Error("token is required");const t=[{url:"/Contracts/hopdong/ky",method:"post"},{url:"/Contracts/Sign",method:"post"},{url:"/Contract/Sign",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,{token:e}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Sign contract endpoint not found")},downloadContractByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract by token endpoint not found")},downloadContractById:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/${t}/download`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract by ID endpoint not found")},downloadLatestContractByUserId:async e=>{var n;if(!e)throw new Error("userId is required");const t=[{url:"/Contracts/user/download-latest-by-userId",params:{userId:e}},{url:"/Contracts/Download-Latest",params:{userId:e}}];for(const s of t)try{return(await te.get(s.url,{params:s.params,responseType:"blob"})).data}catch(o){const a=(n=o==null?void 0:o.response)==null?void 0:n.status;if(a&&a!==404&&a!==405)throw o}throw new Error("Download latest contract by user ID endpoint not found")},downloadMyLatestContract:async()=>{var t;const e=["/Contracts/download-my-contract","/Contracts/download-latest"];for(const n of e)try{return(await te.get(n,{responseType:"blob"})).data}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}throw new Error("Download my latest contract endpoint not found")},getContractByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/Token/${t}`,`/Contract/GetByToken/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null}},Ir={createPayment:async(e,t=0,n="Payment",s=0)=>{var o,a;try{console.log(" Creating payment for booking:",e,"| Type:",t,"| Extra amount:",s);const l={bookingId:e,paymentType:t,description:n};s>0&&(l.extraAmount=s);const d=await te.post("/Payment/create",l);return console.log(" Payment created:",d.data),((o=d.data)==null?void 0:o.data)||d.data||{}}catch(l){throw console.error(" Error creating payment:",((a=l.response)==null?void 0:a.data)||l.message),l}},syncPayment:async e=>{var t,n;try{console.log(" Syncing payment for booking:",e);const s=await te.post(`/Payment/sync/${encodeURIComponent(e)}`);return console.log(" Payment synced:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error syncing payment:",((n=s.response)==null?void 0:n.data)||s.message),s}}};async function uS(e,t={}){if(!e)throw new Error("stationId is required");const{from:n,to:s,token:o}=t||{},a={};n&&(a.from=n),s&&(a.to=s);const l={params:a};o&&(l.headers={Authorization:`Bearer ${o}`});const d=await te.get(`/Payment/station/${encodeURIComponent(e)}/revenue`,l);return(d==null?void 0:d.data)||d}function hS(){const e=on(),{showToast:t}=Du(),[n,s]=v.useState(null),[o,a]=v.useState(null),[l,d]=v.useState(!1),[u,f]=v.useState(!1),[m,g]=v.useState(!1),[y,C]=v.useState(!1),[N,_]=v.useState({isOpen:!1,type:"info",title:"",message:""});v.useEffect(()=>{try{const B=JSON.parse(localStorage.getItem("rentalContext")||"null");if(!B){alert("No rental information found. Please search for a car first."),e("/");return}a(B);const A=localStorage.getItem("selectedCarId");A&&tt.getCarById(A).then(I=>s(I))}catch(B){console.error(B)}},[e]);const b=()=>{if(!o||!n)return 0;const B=new Date(`${o.pickupDate}T${o.pickupTime}`),A=new Date(`${o.returnDate}T${o.returnTime}`),I=Math.ceil((A-B)/(1e3*60*60)),M=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return I*M},w=()=>{if(!o)return 0;const B=new Date(`${o.pickupDate}T${o.pickupTime}`),A=new Date(`${o.returnDate}T${o.returnTime}`);return Math.ceil((A-B)/(1e3*60*60))},x=()=>n?parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0):0,k=()=>b()*.3,S=()=>{const B=new Date,A=String(B.getDate()).padStart(2,"0"),I=String(B.getMonth()+1).padStart(2,"0"),M=B.getFullYear(),W=localStorage.getItem("userFirstName")||"",V=localStorage.getItem("userLastName")||"",$=localStorage.getItem("userDateOfBirth")||"",Q=localStorage.getItem("userIdentityNumber")||"",ie=localStorage.getItem("userAddress")||"",U=localStorage.getItem("userDriverLicenseClass")||"",H=localStorage.getItem("userDriverLicenseNumber")||"",he=localStorage.getItem("userDriverLicenseExpiry")||"",ne=new Date(`${o.pickupDate}T${o.pickupTime}`),xe=new Date(`${o.returnDate}T${o.returnTime}`),ve=Math.ceil((xe-ne)/(1e3*60*60*24)),oe=b(),D=$?new Date($).getFullYear().toString():"";return{soHopDong:`H-${B.getTime()}`,ngayKy:A,thangKy:I,namKy:M.toString(),benA:{hoTen:`${W} ${V}`,namSinh:D,cccdHoacHoChieu:Q,hoKhauThuongTru:ie},xe:{nhanHieu:n.brand||"",bienSo:n.licensePlate||"",loaiXe:n.model||"",mauSon:n.color||"",choNgoi:(n.seats||0).toString(),xeDangKiHan:(n.year||"").toString()},giaThue:{giaThueSo:oe.toString(),giaThueChu:oe.toString(),phuongThucThanhToan:"Chuyn khon",ngayThanhToan:B.toISOString().split("T")[0]},thoiHanThueSo:ve.toString(),thoiHanThueChu:ve.toString(),thoiHanThue:ve,donViThoiHan:"ngay",gplx:{hang:U,so:H,hanSuDung:he}}},E=async()=>{var B,A;if(!l){alert("Please agree to the Terms and Conditions and Privacy Policy to continue.");return}if(!n||!o){alert("Missing booking information. Please try again.");return}C(!0);try{const I=localStorage.getItem("userId");if(!I){alert("User ID not found. Please logout and login again."),e("/");return}const M=new Date(`${o.pickupDate}T${o.pickupTime}`).toISOString(),W=new Date(`${o.returnDate}T${o.returnTime}`).toISOString(),V=o.stationId;console.log(" Using station from rental context:",o.stationName,"- ID:",V);const $={carId:n.id||n.Id,userId:I,pickupStationId:V,returnStationId:V,pickupDateTime:M,expectedReturnDateTime:W,totalAmount:b()};console.log(" Creating booking with user-selected station..."),console.log(" Booking data:",$);const Q=await nn.createBooking($,I),ie=Q.id||Q.Id||Q.bookingId;if(!ie)throw new Error("Booking ID not received from server");console.log(" Booking created:",ie),console.log(" Creating contract...");const U=S(),H=await fr.createRentalContract(ie,I,U),he=(H==null?void 0:H.id)||(H==null?void 0:H.contractId)||H;console.log(" Contract created with ID:",he),console.log(" Full contract response:",H);try{const ne=localStorage.getItem("userEmail");if(ne&&he){console.log(" Waiting 1s before sending email..."),await new Promise(ve=>setTimeout(ve,1e3)),console.log(" Sending contract email to:",ne),console.log(" Contract ID being used:",he);const xe=await fr.sendContractEmail(he,ne);console.log(" Email sent, response:",xe)}}catch(ne){console.warn(" Email failed (non-critical):",ne.message),console.error(" Full error:",ne)}try{console.log(" Creating deposit payment...");const ne=k(),xe=await Ir.createPayment(ie,0,"Cc thu xe");console.log(" Payment created:",xe)}catch(ne){console.warn(" Payment creation failed (non-critical):",ne.message)}_({isOpen:!0,type:"success",title:"Booking Created Successfully! ",message:"The contract has been sent to your email. You have 10 minutes to sign the contract and complete the deposit payment before the reservation expires. You can view details in your Booking History."}),setTimeout(()=>{localStorage.removeItem("selectedCarId"),localStorage.removeItem("rentalContext"),e("/booking-history")},3e3)}catch(I){console.error(" Error:",I);const M=((A=(B=I.response)==null?void 0:B.data)==null?void 0:A.message)||I.message||"Failed to create booking";M.toLowerCase().includes("car not available")?(t("This car is not available, please choose another one!","error",4e3),setTimeout(()=>e("/cars"),2e3)):alert(M)}finally{C(!1)}};if(!o||!n)return r.jsx("div",{className:"loading-container",children:r.jsx("p",{children:"Loading..."})});const P=b(),R=k();return r.jsxs("main",{className:"payment-page",children:[r.jsxs("div",{className:"container",children:[r.jsx("h2",{children:"Confirm Your Reservation"}),r.jsx("div",{className:"payment-layout",children:r.jsxs("div",{className:"payment-info-column",children:[r.jsxs("div",{className:"info-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h3",{className:"section-heading",children:"Rental Information"}),r.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Change]"})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Pick-up Location:"}),r.jsx("span",{className:"info-value",children:o.stationName})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Pick-up Date & Time:"}),r.jsxs("span",{className:"info-value",children:[o.pickupDate," ",o.pickupTime]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Return Date & Time:"}),r.jsxs("span",{className:"info-value",children:[o.returnDate," ",o.returnTime]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Total Rental Time:"}),r.jsxs("span",{className:"info-value",children:[w()," hour",w()!==1?"s":""]})]})]}),r.jsxs("div",{className:"info-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h3",{className:"section-heading",children:"Car Information"}),r.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Pick another car ]"})]}),r.jsxs("div",{className:"car-preview",children:[r.jsx("img",{src:n.imageUrl||n.image||"/Picture/E car 1.jpg",alt:`${n.brand} ${n.model}`,onError:B=>{B.target.src="/Picture/E car 1.jpg"}}),r.jsxs("div",{className:"car-details",children:[r.jsxs("h4",{children:[n.brand," ",n.model]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Color:"})," ",n.color]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Seats:"})," ",n.seats]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Year:"})," ",n.year]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Price:"})," ",Kt(parseFloat(n.rentalPricePerHour||0)),"/hour"]})]})]})]}),r.jsxs("div",{className:"info-section price-summary-section",children:[r.jsx("h3",{className:"section-heading",children:"Price Summary"}),r.jsxs("div",{className:"price-breakdown",children:[r.jsxs("div",{className:"price-row",children:[r.jsx("span",{className:"price-label",children:"Unit Price:"}),r.jsxs("span",{className:"price-value",children:[r.jsx("span",{className:"price-amount",children:Kt(x())}),r.jsx("span",{className:"unit",children:"/hour"})]})]}),r.jsxs("div",{className:"price-row",children:[r.jsx("span",{className:"price-label",children:"Rental Time:"}),r.jsxs("span",{className:"price-value",children:[r.jsxs("span",{className:"price-amount",children:[" ",w()]}),r.jsxs("span",{className:"unit",children:[" hour",w()!==1?"s":""]})]})]}),r.jsx("div",{className:"price-divider"}),r.jsxs("div",{className:"price-row total-row",children:[r.jsx("span",{className:"price-label",children:"Total Rental Cost:"}),r.jsx("span",{className:"price-value-total",children:r.jsx("span",{className:"price-amount",children:Kt(P)})})]}),r.jsxs("div",{className:"price-row deposit-row-summary",children:[r.jsx("span",{className:"price-label",children:"Deposit Required (30%):"}),r.jsx("span",{className:"price-value-deposit",children:r.jsx("span",{className:"price-amount",children:Kt(R)})})]})]})]})]})}),r.jsx("div",{className:"terms-section",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:B=>d(B.target.checked)}),r.jsxs("span",{children:["I agree to the ",r.jsx("button",{type:"button",className:"link-button",onClick:()=>f(!0),children:"Terms and Conditions"})," and ",r.jsx("button",{type:"button",className:"link-button",onClick:()=>g(!0),children:"Privacy Policy"})]})]})}),r.jsx("div",{className:"cta-button-container",children:r.jsx("button",{className:"btn-confirm-booking",onClick:E,disabled:!l||y,children:y?"Creating...":"Confirm and Deposit"})})]}),r.jsx("div",{className:"page-actions",children:r.jsx("div",{className:"page-actions-inner"})}),u&&r.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:r.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Terms and Conditions"}),r.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsx("h4",{children:"1. Rental Agreement"}),r.jsx("p",{children:"By renting a vehicle from our service, you agree to use the vehicle responsibly and return it in the same condition as received."}),r.jsx("h4",{children:"2. Driver Requirements"}),r.jsx("p",{children:"The driver must be at least 21 years old and possess a valid driver's license for at least 1 year."}),r.jsx("h4",{children:"3. Vehicle Usage"}),r.jsx("p",{children:"The vehicle may only be driven by the person(s) listed on the rental agreement. Unauthorized drivers are prohibited."}),r.jsx("h4",{children:"4. Fuel Policy"}),r.jsx("p",{children:"For electric vehicles, please return the car with at least 70% battery charge. Additional charging fees may apply if returned below this level."}),r.jsx("h4",{children:"5. Damage and Liability"}),r.jsx("p",{children:"The renter is responsible for any damage to the vehicle during the rental period, excluding normal wear and tear."}),r.jsx("h4",{children:"6. Cancellation Policy"}),r.jsx("p",{children:"Cancellations made more than 24 hours before pick-up time will receive a full refund. Cancellations within 24 hours will forfeit the deposit."}),r.jsx("h4",{children:"7. Late Returns"}),r.jsx("p",{children:"Late returns will be charged at 1.5x the hourly rate for each additional hour."}),r.jsx("h4",{children:"8. Insurance"}),r.jsx("p",{children:"Basic insurance is included in the rental price. Additional coverage options are available at checkout."})]})]})}),m&&r.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:r.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Privacy Policy"}),r.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsx("h4",{children:"1. Information Collection"}),r.jsx("p",{children:"We collect personal information including name, email, phone number, driver's license details, and payment information necessary to process your rental booking."}),r.jsx("h4",{children:"2. Use of Information"}),r.jsx("p",{children:"Your information is used solely for processing rentals, communication regarding your booking, and improving our services."}),r.jsx("h4",{children:"3. Data Security"}),r.jsx("p",{children:"We implement industry-standard security measures to protect your personal information from unauthorized access, disclosure, or misuse."}),r.jsx("h4",{children:"4. Third-Party Sharing"}),r.jsx("p",{children:"We do not sell or share your personal information with third parties except as required for payment processing or legal compliance."}),r.jsx("h4",{children:"5. Cookies"}),r.jsx("p",{children:"Our website uses cookies to enhance user experience and analyze site traffic. You can disable cookies in your browser settings."}),r.jsx("h4",{children:"6. Data Retention"}),r.jsx("p",{children:"We retain your booking information for 7 years as required by law. You may request deletion of your data at any time."}),r.jsx("h4",{children:"7. Your Rights"}),r.jsx("p",{children:"You have the right to access, correct, or delete your personal information. Contact our support team to exercise these rights."}),r.jsx("h4",{children:"8. Contact"}),r.jsx("p",{children:"For privacy concerns or questions, please contact us at privacy@carental.com"})]})]})}),r.jsx(Fr,{isOpen:N.isOpen,type:N.type,title:N.title,message:N.message,onClose:()=>_({...N,isOpen:!1})})]})}function fS(){const e=on(),[t,n]=v.useState(!0),[s,o]=v.useState(null);return v.useEffect(()=>{console.log(" Payment successful! Checking user role and payment type...");const a=async()=>{try{const d=localStorage.getItem("userRole");console.log(" User role:",d);let u=localStorage.getItem("currentBookingId"),f="user-deposit";if(u||(u=localStorage.getItem("activeCheckInBookingId"),u&&(f="staff-checkin",console.log(" Found check-in booking ID (staff payment):",u))),u||(u=localStorage.getItem("activeCheckOutBookingId"),u&&(f="staff-checkout",console.log(" Found check-out booking ID (staff payment):",u))),!u){console.warn(" No booking ID found in localStorage"),o("Booking ID not found"),n(!1),l(d);return}console.log(" Auto-syncing payment for booking:",u),await Ir.syncPayment(u),console.log(" Payment status synced successfully"),console.log(" Fetching booking details to check status...");const m=await nn.getBookingById(u),g=Number((m==null?void 0:m.bookingStatus)||(m==null?void 0:m.BookingStatus));console.log(" Booking status after payment:",g,"(0=Pending, 1=Active, 2=Waiting Check-in, 3=Checked-in, 4=Check-out Pending, 5=Completed)"),n(!1),setTimeout(()=>{try{localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),localStorage.removeItem("activeCheckInBookingId"),localStorage.removeItem("activeCheckOutBookingId")}catch(y){console.warn("Failed to clear storage:",y)}l(d)},1500)}catch(d){console.error(" Error in payment sync flow:",d),o("Failed to process payment or create contract"),n(!1);const u=localStorage.getItem("userRole");setTimeout(()=>l(u),3e3)}},l=d=>{if(console.log(" Redirecting based on user role:",d,"type:",typeof d),!d){console.warn(" No role found, redirecting to booking history as default"),e("/booking-history");return}const u=String(d).toLowerCase().trim();if(console.log(" Normalized role:",u),u.includes("admin")){console.log(" Redirecting to Admin page"),e("/admin");return}if(u.includes("staff")||u.includes("manager")||u==="stationstaff"||u==="stationmanager"){console.log(" Redirecting to Staff page"),e("/staff");return}if(u.includes("renter")||u.includes("evrenter")||u==="evrenter"){console.log(" Redirecting to Booking History page"),e("/booking-history");return}console.log(" Unknown role, redirecting to booking history as default"),e("/booking-history")};a()},[e]),r.jsx("main",{className:"payment-success-main",children:r.jsx("div",{className:"payment-success-container",children:t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon processing",children:""}),r.jsx("h1",{children:"Processing Payment..."}),r.jsx("p",{children:"Please wait while we confirm your payment."})]}):s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon error",children:""}),r.jsx("h1",{children:"Payment Sync Issue"}),r.jsx("p",{children:s}),r.jsx("p",{className:"small",children:"Redirecting to booking history..."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon success",children:""}),r.jsx("h1",{children:"Payment Successful!"}),r.jsx("p",{children:"Your payment has been processed."}),r.jsx("p",{className:"small",children:"Redirecting to booking history..."})]})})})}function pS(){const e=on(),{showToast:t}=Du(),[n]=qg(),[s,o]=v.useState(!0);return v.useEffect(()=>{(async()=>{console.log(" PaymentCancel component mounted!"),console.log(" Current URL:",window.location.href);try{const l=n.get("orderCode"),d=n.get("status"),u=n.get("cancel");if(console.log(" Payment cancelled:",{orderCode:l,status:d,cancel:u}),u==="true"&&d==="CANCELLED"){const f=localStorage.getItem("currentBookingId");f?(console.log(" Payment cancelled for booking:",f),console.log(" Payment session cleared - booking status unchanged"),localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),t("Payment cancelled. You can retry payment from your booking history.","info",3e3)):(console.warn(" No booking ID found in localStorage"),t("Payment cancelled.","info",3e3)),setTimeout(()=>{e("/booking-history")},2e3)}else t("Invalid payment cancellation.","error",3e3),setTimeout(()=>{e("/booking-history")},1500)}catch(l){console.error(" Error handling payment cancellation:",l),t("An error occurred. Redirecting to home...","error",3e3),setTimeout(()=>{e("/")},2e3)}finally{o(!1)}})()},[n,e,t]),r.jsx("main",{className:"payment-cancel-container",children:r.jsx("div",{className:"payment-cancel-card",children:s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-cancel-icon processing",children:""}),r.jsx("h1",{children:"Processing Cancellation..."}),r.jsx("p",{children:"Clearing payment session. You can retry payment later."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-cancel-icon cancelled",children:""}),r.jsx("h1",{children:"Payment Cancelled"}),r.jsx("p",{children:"Your payment has been cancelled. Your booking is still active and you can retry payment anytime."}),r.jsx("p",{className:"small",style:{fontSize:"13px",color:"#999",marginTop:"20px"},children:"Redirecting to booking history..."})]})})})}const mS=()=>{const e=on(),t=mi(),[n,s]=v.useState(10),[o,a]=v.useState(!1),[l,d]=v.useState(!1),{bookingId:u,depositAmount:f,totalAmount:m,carInfo:g,rentalInfo:y}=t.state||{};v.useEffect(()=>{if(!u){e("/payment");return}const N=setInterval(()=>{s(_=>_<=1?(clearInterval(N),C(),0):_-1)},1e3);return()=>clearInterval(N)},[u]);const C=async()=>{a(!0);try{await new Promise(N=>setTimeout(N,1e3)),console.log(" Payment simulation completed for booking:",u),console.log("  Booking is in Pending status. Admin will confirm after payment verification."),d(!0),setTimeout(()=>{e("/booking-history")},2e3)}catch(N){console.error("Error in payment flow:",N),alert("An error occurred. Redirecting to booking history..."),e("/booking-history")}finally{a(!1)}};return u?r.jsx("main",{className:"transaction-page",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"transaction-content",children:l?r.jsxs("div",{className:"success-section",children:[r.jsx("div",{className:"success-icon",children:r.jsx("i",{className:"fas fa-check-circle"})}),r.jsx("h2",{children:"Booking Created Successfully!"}),r.jsx("p",{children:"Your booking is pending payment confirmation."}),r.jsxs("p",{style:{fontSize:"0.95rem",color:"#666",margin:"1rem 0"},children:["Booking ID: ",r.jsx("strong",{children:u})]}),r.jsx("p",{className:"redirect-text",children:"Redirecting to booking history..."})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"transaction-header",children:[r.jsx("div",{className:"icon-circle",children:r.jsx("i",{className:"fas fa-credit-card"})}),r.jsx("h2",{children:"Complete Your Payment"}),r.jsxs("p",{className:"booking-id",children:["Booking ID: ",r.jsx("span",{children:u})]})]}),r.jsxs("div",{className:"payment-layout",children:[r.jsxs("div",{className:"qr-section",children:[r.jsx("h3",{children:"Scan QR Code to Pay"}),r.jsxs("div",{className:"qr-placeholder",children:[r.jsx("i",{className:"fas fa-qrcode"}),r.jsx("p",{children:"QR Code Here"})]}),r.jsxs("div",{className:"payment-instructions",children:[r.jsx("h4",{children:"Payment Instructions:"}),r.jsxs("ol",{children:[r.jsx("li",{children:"Open your banking app"}),r.jsx("li",{children:"Scan the QR code above"}),r.jsx("li",{children:"Confirm the payment amount"}),r.jsx("li",{children:"Complete the transaction"})]})]})]}),r.jsxs("div",{className:"payment-details",children:[r.jsx("h3",{children:"Payment Details"}),r.jsxs("div",{className:"detail-card",children:[r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Deposit Amount:"}),r.jsx("span",{className:"value highlight",children:Kt(f)})]}),r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Total Rental Cost:"}),r.jsx("span",{className:"value",children:Kt(m)})]}),r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Remaining Balance:"}),r.jsx("span",{className:"value",children:Kt((m||0)-(f||0))})]})]}),g&&r.jsxs("div",{className:"detail-card",children:[r.jsxs("h4",{children:[r.jsx("i",{className:"fas fa-car"})," Vehicle"]}),r.jsx("p",{children:r.jsxs("strong",{children:[g.brand," ",g.model]})}),r.jsxs("p",{children:[g.color,"  ",g.seats," seats  ",g.year]})]}),y&&r.jsxs("div",{className:"detail-card",children:[r.jsxs("h4",{children:[r.jsx("i",{className:"fas fa-calendar-alt"})," Rental Period"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Pick-up:"})," ",y.pickupDate," ",y.pickupTime]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Return:"})," ",y.returnDate," ",y.returnTime]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Location:"})," ",y.stationName]})]}),r.jsxs("div",{className:"countdown-section",children:[r.jsxs("div",{className:"countdown-circle",children:[r.jsx("span",{className:"countdown-number",children:n}),r.jsx("span",{className:"countdown-label",children:"seconds"})]}),r.jsx("p",{className:"countdown-text",children:o?"Processing payment...":"Simulating payment completion in..."})]}),r.jsxs("div",{className:"info-box",children:[r.jsx("i",{className:"fas fa-info-circle"}),r.jsxs("p",{children:["This is a demo. Your booking will be created in ",r.jsx("strong",{children:"Pending"})," status. Admin will confirm after receiving payment. Payment simulation completes after ",n," second",n!==1?"s":"","."]})]})]})]})]})})})}):null},Ud={getAllFeedbacks:async(e=1,t=10)=>{var n,s;try{console.log(" Fetching all feedbacks - page:",e,"size:",t);const o=await te.get("/Feedback/Get-All",{params:{pageNumber:e,pageSize:t}});return console.log(" Feedbacks fetched:",o.data),((n=o.data)==null?void 0:n.data)||o.data||[]}catch(o){throw console.error(" Error fetching feedbacks:",((s=o.response)==null?void 0:s.data)||o.message),o}},getFeedbackById:async e=>{var t,n;try{console.log(" Fetching feedback:",e);const s=await te.get(`/Feedback/Get-By-${encodeURIComponent(e)}`);return console.log(" Feedback fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching feedback:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByCarId:async e=>{var t,n;try{console.log(" Fetching feedbacks for car:",e);const s=await te.get(`/Feedback/Get-By-Car/${encodeURIComponent(e)}`);return console.log(" Car feedbacks fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||[]}catch(s){throw console.error(" Error fetching car feedbacks:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByUserId:async e=>{var t,n;try{console.log(" Fetching feedbacks for user:",e);const s=await te.get(`/Feedback/Get-By-User/${encodeURIComponent(e)}`);return console.log(" User feedbacks fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||[]}catch(s){throw console.error(" Error fetching user feedbacks:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByBookingId:async e=>{var t,n;try{console.log(" Fetching feedback for booking:",e);const s=await te.get(`/Feedback/Get-By-Booking/${encodeURIComponent(e)}`);return console.log(" Booking feedback fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking feedback:",((n=s.response)==null?void 0:n.data)||s.message),s}},createFeedback:async(e,t)=>{var n,s,o,a,l;try{console.log(" Creating feedback for user:",e),console.log(" Feedback data:",t);const d={...t,userId:e};console.log(" Sending payload:",d);const u=await te.post(`/Feedback/Create-By-User/${encodeURIComponent(e)}`,d);return console.log(" Feedback created:",u.data),((n=u.data)==null?void 0:n.data)||u.data||{}}catch(d){throw console.error(" Error creating feedback:",((s=d.response)==null?void 0:s.data)||d.message),console.error(" Full error response:",d.response),console.error(" Error status:",(o=d.response)==null?void 0:o.status),console.error(" Error details:",(l=(a=d.response)==null?void 0:a.data)==null?void 0:l.errors),d}},updateFeedback:async(e,t,n)=>{var s,o;try{console.log(" Updating feedback:",e),console.log(" Updated data:",t);const a=await te.put(`/Feedback/Update-By-${encodeURIComponent(e)}`,t,{params:n?{userId:n}:{}});return console.log(" Feedback updated:",a.data),((s=a.data)==null?void 0:s.data)||a.data||{}}catch(a){throw console.error(" Error updating feedback:",((o=a.response)==null?void 0:o.data)||a.message),a}},deleteFeedback:async(e,t)=>{var n,s;try{console.log(" Deleting feedback:",e);const o=await te.delete(`/Feedback/Delete-By-${encodeURIComponent(e)}`,{params:t?{userId:t}:{}});return console.log(" Feedback deleted:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error deleting feedback:",((s=o.response)==null?void 0:s.data)||o.message),o}},getFeedbackSummaryByCar:async e=>{var t,n;try{console.log(" Fetching feedback summary for car:",e);const s=await te.get(`/Feedback/Get-Summary-By-Car/${encodeURIComponent(e)}`);return console.log(" Feedback summary fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching feedback summary:",((n=s.response)==null?void 0:n.data)||s.message),s}},getAverageRatingByCar:async e=>{var t,n;try{console.log(" Fetching average rating for car:",e);const s=await te.get(`/Feedback/Get-Average-Rating-By-Car/${encodeURIComponent(e)}`);return console.log(" Average rating fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||0}catch(s){throw console.error(" Error fetching average rating:",((n=s.response)==null?void 0:n.data)||s.message),s}}};function gS({isOpen:e,selectedBooking:t,feedbackData:n,setFeedbackData:s,isEditingFeedback:o,currentFeedbackId:a,onClose:l,onSubmitSuccess:d}){const[u,f]=v.useState(!1),[m,g]=v.useState(!1);v.useEffect(()=>{console.log(" FeedbackModal useEffect triggered:",{isOpen:e,feedbackId:t==null?void 0:t.feedbackId,hasComment:!!(n!=null&&n.comment),feedbackData:n}),e&&(t!=null&&t.feedbackId)&&(n!=null&&n.comment)?(console.log(" Entering VIEW mode - showing existing feedback"),f(!0)):e&&(console.log(" Entering EDIT mode - creating/editing feedback"),f(!1))},[e,t==null?void 0:t.feedbackId]);const y=()=>{f(!1)},C=async()=>{var N,_,b;try{const w=localStorage.getItem("userId");if(!w){alert("User ID not found. Please login again.");return}if(!n.carId){alert("Car ID not found for this booking.");return}if(!n.comment.trim()){alert("Please enter your feedback comment.");return}g(!0),console.log(" Submitting feedback:",n),o&&a?(await Ud.updateFeedback(a,n,w),alert("Feedback updated successfully!")):(await Ud.createFeedback(w,n),alert("Feedback submitted successfully!")),s({bookingId:"",carId:"",rating:5,comment:""}),f(!1),l(),d()}catch(w){console.error(" Error submitting feedback:",w);const x=((b=(_=(N=w.response)==null?void 0:N.data)==null?void 0:_.errors)==null?void 0:b[0])||"Failed to submit feedback. Please try again.";alert(x)}finally{g(!1)}};return e?r.jsx("div",{className:"modal-overlay",onClick:l,children:r.jsxs("div",{className:"modal-content",onClick:N=>N.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:u?"Your Feedback":"We want your opinion!"}),r.jsx("button",{className:"modal-close",onClick:l,children:""})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"feedback-form",children:[r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:["Car: ",(t==null?void 0:t.carInfo)||"N/A"]})}),u?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Your Rating"}),r.jsxs("div",{className:"rating-display",children:[r.jsx("div",{className:"stars-display",children:[1,2,3,4,5].map(N=>r.jsx("i",{className:`fas fa-star ${n.rating>=N?"active":"inactive"}`,style:{color:n.rating>=N?"#ffc107":"#ddd"}},N))}),r.jsxs("span",{className:"rating-text",children:[n.rating," / 5"]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Your Comment"}),r.jsx("div",{className:"comment-display",children:r.jsx("p",{children:n.comment})})]}),r.jsxs("div",{className:"feedback-meta",children:[r.jsxs("small",{children:["Created: ",(t==null?void 0:t.feedbackCreatedDate)||"N/A"]}),(t==null?void 0:t.feedbackUpdatedDate)&&t.feedbackUpdatedDate!==t.feedbackCreatedDate&&r.jsxs("small",{children:["Updated: ",t.feedbackUpdatedDate]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Close"}),r.jsxs("button",{className:"btn btn-continue",onClick:y,children:[r.jsx("i",{className:"fas fa-edit"})," Edit Feedback"]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"rating",children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[[1,2,3,4,5].map(N=>r.jsx("button",{type:"button",className:`star-btn ${n.rating>=N?"active":""}`,onClick:()=>s({...n,rating:N}),children:r.jsx("i",{className:`fas fa-star ${n.rating>=N?"":"far"}`})},N)),r.jsxs("span",{className:"rating-text",children:[n.rating," / 5"]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"comment",children:"Comment"}),r.jsx("textarea",{id:"comment",rows:"5",value:n.comment,onChange:N=>s({...n,comment:N.target.value}),placeholder:"Share your experience with this car..."})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancel"}),r.jsx("button",{className:"btn btn-continue",onClick:C,disabled:m,children:m?"Processing...":o?"Update":"Continue"})]})]})]})})]})}):null}function yS(){const e=on(),[t,n]=v.useState([]),[s,o]=v.useState([]),[a,l]=v.useState(!0),[d,u]=v.useState(""),[f,m]=v.useState({}),[g,y]=v.useState(""),[C,N]=v.useState("newest"),[_,b]=v.useState(null),[w,x]=v.useState(!1),[k,S]=v.useState(!1),[E,P]=v.useState({bookingId:"",carId:"",rating:5,comment:""}),[R,B]=v.useState(!1),[A,I]=v.useState(null),[M,W]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[V,$]=v.useState(!1),Q=()=>{S(!1),P({bookingId:"",carId:"",rating:5,comment:""}),B(!1),I(null)},ie=v.useCallback(async()=>{try{l(!0),u("");const D=localStorage.getItem("token");if(!D||D==="null"){console.warn("No auth token found in localStorage"),n([]),u("You are not signed in. Please sign in to view your bookings.");return}const ee=await nn.getUserBookings();console.log(" Bookings loaded - count:",ee==null?void 0:ee.length),console.log(" First booking sample:",ee==null?void 0:ee[0]),console.log(" All bookings:",ee);const G={};for(const _e of ee||[]){const Ie=_e.carId||_e.CarId;if(Ie)try{const Ce=await tt.getCarById(Ie),we=(Ce==null?void 0:Ce.imageUrl)||(Ce==null?void 0:Ce.ImageUrl)||"/Picture/E car 1.jpg";G[Ie]=we,console.log(" Loaded image for car",Ie,":",we)}catch(Ce){console.warn(" Failed to load car image for",Ie,":",Ce.message),G[Ie]="/Picture/E car 1.jpg"}}m(G),n(ee||[])}catch(D){if(console.error("Error loading bookings:",D),D&&D.response&&D.response.status===401){u("Session expired or unauthorized. Please sign in again."),n([]);return}u("Failed to load bookings. Please try again later.")}finally{l(!1)}},[]),U=v.useCallback(()=>{ie()},[ie]),H=v.useCallback(()=>{let D=[...t];g&&(D=D.filter(ee=>String(ee.bookingStatus)===g)),D.sort((ee,G)=>{switch(C){case"oldest":return new Date(ee.createdAt)-new Date(G.createdAt);case"price-high":return(G.totalAmount||0)-(ee.totalAmount||0);case"price-low":return(ee.totalAmount||0)-(G.totalAmount||0);default:return new Date(G.createdAt)-new Date(ee.createdAt)}}),o(D)},[t,g,C]);v.useEffect(()=>{ie()},[ie]),v.useEffect(()=>{t.length>0&&H()},[t,g,C]);const he=D=>{const ee={0:{text:"Pending",class:"status-pending"},1:{text:"Active",class:"status-active"},2:{text:"Waiting for check-in",class:"status-waiting-check-in"},3:{text:"Checked-in",class:"status-checked-in"},4:{text:"Check-out pending",class:"status-check-out-pending"},5:{text:"Completed",class:"status-completed"},6:{text:"Cancelled pending refund",class:"status-cancelled-pending-refund"},7:{text:"Cancelled",class:"status-cancelled"}},G=Number(D);return Number.isNaN(G)||!(G in ee)?(console.warn(" Unknown booking status:",D,"type:",typeof D),ee[0]):ee[G]},ne=D=>{if(!D)return"N/A";try{const ee=new Date(D);return isNaN(ee.getTime())?D:ee.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return D}},xe=async(D,ee)=>{ee&&(ee.preventDefault(),ee.stopPropagation());const G=D.id||D.bookingId||D.bookingIdString;if(!G){alert("Cannot cancel: Booking ID not found");return}if(Number(D.bookingStatus)===7){alert("This booking has already been cancelled.");return}if(window.confirm(`Are you sure you want to cancel booking for "${D.carInfo||"this car"}"?`))try{const Ie=localStorage.getItem("userId");if(!Ie){alert("User ID not found. Please login again.");return}console.log(" Cancelling booking:",G,"for user:",Ie),await nn.cancelBooking(G,Ie),alert("Booking cancelled successfully!"),ie()}catch(Ie){console.error(" Error cancelling booking:",Ie),alert("Failed to cancel booking. Please try again.")}},ve=async(D,ee)=>{var _e,Ie,Ce,we,ze;ee&&(ee.preventDefault(),ee.stopPropagation());const G=D.id||D.bookingId||D.bookingIdString;if(!G){alert("Booking ID not found");return}$(!0);try{console.log(" Creating deposit payment for booking:",G);const me=await Ir.createPayment(G),nt=me.checkoutUrl||((_e=me.data)==null?void 0:_e.checkoutUrl);if(!nt)throw new Error("No checkout URL received");localStorage.setItem("currentBookingId",G),console.log(" Redirecting to PayOS:",nt),window.location.href=nt}catch(me){console.error(" Error initiating payment:",me);let nt=((Ce=(Ie=me.response)==null?void 0:Ie.data)==null?void 0:Ce.message)||me.message||"Failed to initiate payment";(((ze=(we=me.response)==null?void 0:we.data)==null?void 0:ze.errors)||[]).some(fe=>typeof fe=="string"&&fe.toLowerCase().includes("contract"))?(nt="Contract not found or not confirmed for this booking",W({isOpen:!0,type:"error",title:" Contract Required",message:"Please wait for the contract to be confirmed. Check your email for the contract document and ensure it has been processed."})):W({isOpen:!0,type:"error",title:"Payment Error",message:nt})}finally{$(!1)}},oe=(D,ee)=>{var Ie,Ce;if(ee&&(ee.preventDefault(),ee.stopPropagation()),k){console.log(" Modal already open, ignoring click");return}console.log(" Opening feedback modal for booking:",D);const G=D.id||D.bookingId||D.bookingIdString||"",_e=D.carId||((Ie=D.car)==null?void 0:Ie.id)||((Ce=D.car)==null?void 0:Ce.carId)||"";if(!G){alert("Cannot create feedback: Booking ID not found.");return}if(!_e){alert("Cannot create feedback: Car ID not found in booking data. Please contact support.");return}console.log(" Attempting to fetch existing feedback for booking:",G),Ud.getFeedbackByBookingId(G).then(we=>{if(console.log(" Raw feedback response:",we),console.log(" Feedback rating:",we==null?void 0:we.rating),console.log(" Feedback comment:",we==null?void 0:we.comment),!we||!we.comment||we.comment.trim()===""){console.log(" No existing feedback found - entering CREATE mode"),B(!1),I(null),P({bookingId:G,carId:_e,rating:5,comment:""}),b(D),S(!0);return}console.log(" Valid feedback found - entering VIEW/EDIT mode"),B(!0),I(we.feedbackId||we.id),P({bookingId:G,carId:_e,rating:we.rating||5,comment:we.comment||""});const ze={...D,feedbackId:we.feedbackId||we.id,feedbackCreatedDate:we.createdAt,feedbackUpdatedDate:we.updatedAt};console.log(" Setting booking with feedback:",ze),b(ze),S(!0)}).catch(we=>{var ze;console.error(" Error fetching feedback:",((ze=we.response)==null?void 0:ze.data)||we.message),B(!1),I(null),P({bookingId:G,carId:_e,rating:5,comment:""}),b(D),S(!0)})};return r.jsxs("main",{className:"main-content",children:[r.jsxs("div",{className:"container",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("i",{className:"fas fa-history"}),r.jsxs("div",{className:"page-header-text",children:[r.jsx("h1",{children:"Booking History"}),r.jsx("p",{style:{color:"white"},children:"Manage all your car rentals"})]})]}),r.jsxs("div",{className:"filters-section",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Status:"}),r.jsxs("select",{value:g,onChange:D=>y(D.target.value),children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"0",children:"Pending"}),r.jsx("option",{value:"1",children:"Active"}),r.jsx("option",{value:"2",children:"Waiting for check-in"}),r.jsx("option",{value:"3",children:"Checked-in"}),r.jsx("option",{value:"4",children:"Checked-out pending"}),r.jsx("option",{value:"5",children:"Completed"}),r.jsx("option",{value:"6",children:"Cancelled pending refund"}),r.jsx("option",{value:"7",children:"Cancelled"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Sort By:"}),r.jsxs("select",{value:C,onChange:D=>N(D.target.value),children:[r.jsx("option",{value:"newest",children:"Newest"}),r.jsx("option",{value:"oldest",children:"Oldest"}),r.jsx("option",{value:"price-high",children:"Price (High to Low)"}),r.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),r.jsxs("button",{className:"btn-refresh",onClick:ie,children:[r.jsx("i",{className:"fas fa-sync"})," Refresh"]})]}),a&&r.jsxs("div",{className:"loading",children:[r.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading..."]}),!a&&s.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("i",{className:"fas fa-inbox"}),r.jsx("h2",{children:"No Bookings Yet"}),r.jsx("p",{children:"Start booking a car to find your perfect ride"}),r.jsxs("button",{className:"btn btn-primary",onClick:()=>e("/cars"),children:[r.jsx("i",{className:"fas fa-car"})," View Cars"]})]}),!a&&s.length>0&&r.jsx("div",{className:"bookings-list",children:s.map((D,ee)=>{var nt,gn,fe,ae,le,ye;const G=he(D.bookingStatus),_e=ne(D.startTime||D.StartTime||D.pickupDateTime||D.PickupDateTime),Ie=ne(D.endTime||D.EndTime||D.expectedReturnDateTime||D.ExpectedReturnDateTime),Ce=D.carInfo||D.CarInfo||((nt=D.car)!=null&&nt.brand&&((gn=D.car)!=null&&gn.model)?`${D.car.brand} ${D.car.model}`:null)||((fe=D.Car)!=null&&fe.Brand&&((ae=D.Car)!=null&&ae.Model)?`${D.Car.Brand} ${D.Car.Model}`:null)||"Car Rental",we=D.pickupStationName||D.PickupStationName||D.stationName||D.StationName||((le=D.station)==null?void 0:le.name)||((ye=D.Station)==null?void 0:ye.Name)||"N/A",ze=D.carId||D.CarId,me=f[ze]||"/Picture/E car 1.jpg";return D.id||D.bookingId||D.bookingIdString,ee===0&&(console.log(" First booking car image sources:"),console.log("   - carId:",ze),console.log("   - carImagesCache[carId]:",f[ze]),console.log("   - Final carImage:",me),console.log("   - Full booking object:",D)),r.jsxs("div",{className:`booking-card-shopee ${G.class}`,children:[r.jsx("div",{className:"booking-card-header",children:r.jsx("span",{className:`status-badge ${G.class}`,children:G.text})}),r.jsxs("div",{className:"booking-card-body",children:[r.jsx("div",{className:"car-image-container",children:r.jsx("img",{src:me,alt:Ce,onError:ue=>ue.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"booking-details",children:[r.jsx("h3",{className:"car-name",children:Ce}),r.jsxs("div",{className:"booking-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),"Pick-up Location"]}),r.jsx("div",{className:"info-value",children:we})]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-calendar-alt"}),"Start Date & Time"]}),r.jsx("div",{className:"info-value",children:_e})]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-calendar-check"}),"End Date & Time"]}),r.jsx("div",{className:"info-value",children:Ie})]})]})]})]}),r.jsxs("div",{className:"booking-card-footer",children:[r.jsxs("div",{className:"total-price",children:[r.jsx("span",{className:"price-label",children:"Total Amount:"}),r.jsx("span",{className:"price-value",children:Kt(D.totalAmount||D.TotalAmount||0)})]}),r.jsxs("div",{className:"booking-actions",children:[Number(D.bookingStatus)===0&&r.jsxs("button",{className:"btn btn-deposit",onClick:ue=>ve(D,ue),disabled:V,type:"button",children:[r.jsx("i",{className:"fas fa-wallet"})," ",V?"Processing...":"Pay Deposit"]}),Number(D.bookingStatus)===5&&r.jsxs("button",{className:"btn btn-feedback",onClick:ue=>oe(D,ue),type:"button",children:[r.jsx("i",{className:"fas fa-comment"})," ",D.feedbackId?"Edit Feedback":"Feedback"]}),r.jsxs("button",{className:"btn btn-cancel",onClick:ue=>xe(D,ue),disabled:Number(D.bookingStatus)===7,title:Number(D.bookingStatus)===7?"Already cancelled":"Cancel booking",type:"button",children:[r.jsx("i",{className:"fas fa-times-circle"})," Cancel Booking"]})]})]})]},ee)})})]}),w&&_&&r.jsx("div",{className:"modal-overlay",onClick:()=>x(!1),children:r.jsxs("div",{className:"modal-content",onClick:D=>D.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:"Booking Details"}),r.jsx("button",{className:"modal-close",onClick:()=>x(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"detail-section car-section",children:[r.jsx("div",{className:"section-icon",children:""}),r.jsxs("div",{className:"section-content",children:[r.jsx("h3",{children:_.carInfo||"Car Rental"}),r.jsx("div",{className:"status-row",children:r.jsx("span",{className:`status-badge ${he(_.bookingStatus).class}`,children:he(_.bookingStatus).text})})]})]}),r.jsxs("div",{className:"detail-section datetime-section",children:[r.jsxs("div",{className:"datetime-card pickup",children:[r.jsx("div",{className:"datetime-icon",children:""}),r.jsxs("div",{className:"datetime-info",children:[r.jsx("label",{children:"Pick-up"}),r.jsx("p",{className:"location",children:_.pickupStationName||"N/A"}),r.jsx("p",{className:"time",children:ne(_.startTime||_.pickupDateTime)})]})]}),r.jsx("div",{className:"datetime-arrow",children:""}),r.jsxs("div",{className:"datetime-card return",children:[r.jsx("div",{className:"datetime-icon",children:""}),r.jsxs("div",{className:"datetime-info",children:[r.jsx("label",{children:"Return"}),r.jsx("p",{className:"location",children:_.returnStationName||"N/A"}),r.jsx("p",{className:"time",children:ne(_.endTime||_.expectedReturnDateTime)})]})]})]}),r.jsx("div",{className:"detail-section pricing-section",children:r.jsxs("div",{className:"pricing-grid",children:[r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Hourly Rate"}),r.jsxs("p",{children:[Kt(_.hourlyRate||0),"/hour"]})]})]}),r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Daily Rate"}),r.jsxs("p",{children:[Kt(_.dailyRate||0),"/day"]})]})]}),r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Created At"}),r.jsx("p",{children:ne(_.createdAt)})]})]})]})}),r.jsx("div",{className:"detail-section total-section",children:r.jsxs("div",{className:"total-content",children:[r.jsx("span",{className:"total-label",children:"Total Amount"}),r.jsx("span",{className:"total-amount",children:Kt(_.totalAmount||0)})]})})]})]})}),r.jsx(gS,{isOpen:k,selectedBooking:_,feedbackData:E,setFeedbackData:P,isEditingFeedback:R,currentFeedbackId:A,onClose:Q,onSubmitSuccess:U}),r.jsx(Fr,{isOpen:M.isOpen,type:M.type,title:M.title,message:M.message,onClose:()=>W({...M,isOpen:!1})})]})}function xS({toggleSidebar:e,sidebarVisible:t}){return r.jsxs("header",{className:"header-bar",children:[r.jsx("div",{className:"header-left",children:r.jsx("button",{className:"sidebar-toggle","aria-label":t?"Close sidebar":"Open sidebar",onClick:e,children:r.jsx("i",{className:t?"fas fa-times":"fas fa-bars"})})}),r.jsx("div",{className:"header-title",children:"Staff Page"}),r.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function ky({title:e="Menu",menuItems:t=[],isOpen:n=!1,toggleSidebar:s,onSelect:o,activeKey:a}){const l=on();v.useEffect(()=>{n?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[n]);function d(u){try{typeof u.onClick=="function"?u.onClick():u.to&&l(u.to)}catch(f){console.warn("Sidebar navigation error",f)}typeof o=="function"&&o(u.key)}return r.jsxs(r.Fragment,{children:[n&&r.jsx("div",{className:"sidebar-collider",onClick:s}),r.jsxs("div",{className:`sidebar ${n?"active":""}`,children:[r.jsx("h2",{children:e}),r.jsx("div",{style:{marginTop:"60px"}}),Array.isArray(t)&&t.map(u=>r.jsxs("button",{className:a===u.key?"sidebar-item active":"sidebar-item",onClick:()=>d(u),children:[u.icon&&r.jsx("i",{className:u.icon,"aria-hidden":!0}),r.jsx("span",{style:{marginLeft:u.icon?8:0},children:u.label})]},u.key))]})]})}const by=()=>'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2"><path d="M3 9l1-3h16l1 3M3 9v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9M3 9h18M7 13a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/></svg>',Vu=e=>{e&&(e.style.objectFit="contain",e.style.backgroundColor="#f0f0f0",e.src=by())},qu=e=>!e||typeof e=="string"&&e.trim()===""?by():e;function vS({booking:e,onClick:t}){const[n,s]=v.useState(null);v.useEffect(()=>{(async()=>{try{const m=e.carId||e.CarId;if(console.log(" BookingCard - Attempting to load image for booking:",e.id,"carId:",m),!m){console.warn(" BookingCard - No carId found in booking:",e);return}const g=await tt.getCarById(m),y=(g==null?void 0:g.imageUrl)||(g==null?void 0:g.ImageUrl)||"/Picture/E car 1.jpg";s(y),console.log(" BookingCard - Loaded car image:",y)}catch(m){console.warn(" BookingCard - Failed to load car image:",m.message)}})()},[e.carId,e.CarId,e.id]);const a=(f=>{if(!f)return"UNKNOWN";if(typeof f=="string")return f.toLowerCase();if(typeof f=="number")switch(f){case 0:return"pending";case 1:return"booked";case 2:return"waiting-checkin";case 3:return"checked-in";case 4:return"checkout-pending";case 5:return"completed";default:return"unknown"}return"unknown"})(e.status);let l="booking-status-chip ";a==="booked"?l+="booking-status-booked":a==="pending"?l+="booking-status-pending":a==="waiting-checkin"?l+="booking-status-waiting-checkin":a==="checked-in"||a==="checkedin"?l+="booking-status-checkedin":a==="checkout-pending"?l+="booking-status-checkout-pending":a==="completed"?l+="booking-status-completed":a==="cancelled-pending"?l+="booking-status-cancelled-pending":a==="cancelled"?l+="booking-status-cancelled":a==="denied"?l+="booking-status-denied":l+="booking-status-unknown";const d=f=>{Vu(f.currentTarget)},u=n||e.img||qu(e.img);return r.jsxs("div",{className:"booking-card",onClick:t,children:[r.jsx("img",{src:u,alt:e.title,onError:d}),r.jsxs("div",{className:"booking-info",children:[r.jsx("div",{className:"booking-title",children:e.title}),r.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),(()=>{const f=e.statusLabel||a.toUpperCase();return r.jsx("div",{className:l,children:f})})()]})}const Ln={createIncident:async(e,t,n=[])=>{var l;if(!e||!t)throw new Error("bookingId and description are required");const s=new FormData;if(s.append("bookingId",e),s.append("description",t),n&&n.length)for(const d of n)s.append("images",d);const o=["/Incidents/Create","/incidents/Create","/Incidents/CreateIncident"];let a=null;for(const d of o)try{const u=await te.post(d,s,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const m=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(m);throw g.body=f,g}return f.data}return f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create incident endpoint not found")},getIncidentsByBooking:async(e,t=1,n=20)=>{var a;if(!e)return[];const s=encodeURIComponent(e),o=[{url:`/Incidents/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/Incident/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/incidents/get-by-booking/${s}`,opts:{params:{page:t,pageSize:n}}}];for(const l of o)try{const d=await te.get(l.url,l.opts),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;if(!f)continue;return Array.isArray(f)?f:Array.isArray(f==null?void 0:f.items)?f.items:Array.isArray(f==null?void 0:f.data)?f.data:Array.isArray(f==null?void 0:f.incidents)?f.incidents:Array.isArray(f)?f:[]}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)return[]}return[]},getMyIncidents:async()=>{var t;const e=["/Incidents/My-Incidents","/Incidents/My","/Incidents/Get-My"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data,a=o&&typeof o=="object"&&"data"in o?o.data:o;if(!a)continue;return Array.isArray(a)?a:Array.isArray(a==null?void 0:a.items)?a.items:Array.isArray(a==null?void 0:a.data)?a.data:Array.isArray(a)?a:[]}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)return[]}return[]},getAllIncidents:async(e=null,t=null,n=null,s=null,o=1,a=100)=>{try{const l={};e&&(l.stationId=e),t&&(l.status=t),n&&(l.dateFrom=n),s&&(l.dateTo=s),l.page=o,l.pageSize=a;const d=await te.get("/Incidents/Get-All",{params:l}),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;if(!f)return{incidents:[],totalCount:0,page:o,pageSize:a};if(Array.isArray(f))return{incidents:f,totalCount:f.length,page:o,pageSize:a};const m=f.incidents||f.items||f.data||[],g=f.totalCount||f.total||(Array.isArray(m)?m.length:0);return{incidents:Array.isArray(m)?m:[],totalCount:g||0,page:f.page||o,pageSize:f.pageSize||a}}catch{return{incidents:[],totalCount:0,page:o,pageSize:a}}},getIncidentById:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Incidents/Get-By-${t}`,`/Incidents/Get-By-Id/${t}`,`/Incidents/${t}`,`/incident/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(!d)continue;return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},updateIncident:async(e,t)=>{var a;if(!e)throw new Error("incidentId is required");const n=encodeURIComponent(e),s=[`/Incidents/Update-By-${n}`,`/Incidents/Update-By-Id/${n}`,`/Incidents/Update/${n}`,`/Incidents/${n}`];let o=null;for(const l of s)try{const d=await te.put(l,t,{headers:{"Content-Type":"multipart/form-data"}}),u=d==null?void 0:d.data;return(u&&typeof u=="object"&&"data"in u?u.data:u)||u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Update incident endpoint not found")},resolveIncident:async(e,t="",n=0)=>{var l;if(!e)throw new Error("incidentId is required");const s=encodeURIComponent(e),o=[`/Incidents/Resolve-By-${s}`,`/Incidents/Resolve-By-Id/${s}`,`/Incidents/Resolve/${s}`];let a=null;for(const d of o)try{const u=await te.patch(d,{resolutionNotes:t,costIncurred:n}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Resolve incident endpoint not found")},deleteIncident:async e=>{var o;if(!e)throw new Error("incidentId is required");const t=encodeURIComponent(e),n=[`/Incidents/Delete-By-${t}`,`/Incidents/Delete-By-Id/${t}`,`/Incidents/Delete/${t}`,`/Incidents/${t}`];let s=null;for(const a of n)try{const l=await te.delete(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Delete incident endpoint not found")}},De={confirmBooking:nn.confirmBooking,cancelBooking:nn.cancelBooking,completeBooking:nn.completeBooking,getBookingById:nn.getBookingById,createIncident:Ln.createIncident,getIncidentsByBooking:Ln.getIncidentsByBooking,getMyIncidents:Ln.getMyIncidents,getAllIncidents:Ln.getAllIncidents,getIncidentById:Ln.getIncidentById,updateIncident:Ln.updateIncident,resolveIncident:Ln.resolveIncident,deleteIncident:Ln.deleteIncident,post:(e,t={})=>te.post(e,t).then(n=>n.data),get:(e,t={})=>te.get(e,t).then(n=>n.data),put:(e,t={})=>te.put(e,t).then(n=>n.data),patch:(e,t={})=>te.patch(e,t).then(n=>n.data),delete:e=>te.delete(e).then(t=>t.data),createCar:tt.createCar,deleteCar:tt.deleteCar,updateCar:tt.updateCar,updateStatus:tt.updateStatus,updateBatteryLevel:tt.updateBatteryLevel,updateCarDescription:tt.updateCarDescription,getCarsByStation:async e=>{var t;try{const n=await te.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`),s=n==null?void 0:n.data;return Array.isArray(s)?s:s!=null&&s.data&&Array.isArray(s.data)?s.data:(t=s==null?void 0:s.data)!=null&&t.data&&Array.isArray(s.data.data)?s.data.data:s!=null&&s.items&&Array.isArray(s.items)?s.items:(console.warn(" No cars found in response for station:",e),[])}catch(n){return console.warn(" getCarsByStation error (endpoint may not exist):",n.message),[]}},checkInWithContract:async e=>{var t,n;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");try{const s=new FormData;s.append("BookingId",e.bookingId),s.append("StaffId",e.staffId),e.checkInNotes&&s.append("CheckInNotes",e.checkInNotes),e.checkInPhotoFile&&e.checkInPhotoFile instanceof File?s.append("CheckInPhoto",e.checkInPhotoFile,e.checkInPhotoFile.name):s.append("CheckInPhoto","");const o=(()=>{try{return localStorage.getItem("token")}catch{return null}})(),a={};o&&o!=="null"&&(a.Authorization=`Bearer ${o}`);const l=await gt.post(`${Hi}/Bookings/Check-In-With-Contract`,s,{headers:a}),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(s){throw console.error(" checkInWithContract failed:",(t=s==null?void 0:s.response)==null?void 0:t.status,((n=s==null?void 0:s.response)==null?void 0:n.data)||(s==null?void 0:s.message)),s}},checkOutWithPayment:async e=>{var s,o;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-Out-With-Payment","/Bookings/CheckOutWithPayment","/bookings/check-out-with-payment"];let n;for(const a of t){if(e.checkOutPhotoFile&&e.checkOutPhotoFile instanceof File)try{const l=new FormData;l.append("bookingId",e.bookingId),l.append("staffId",e.staffId),e.actualReturnDateTime&&l.append("actualReturnDateTime",e.actualReturnDateTime),e.damageFee!==void 0&&e.damageFee!==null&&l.append("damageFee",String(e.damageFee)),e.checkOutNotes&&l.append("checkOutNotes",e.checkOutNotes),e.checkOutPhotoUrl&&!e.checkOutPhotoUrl.startsWith("blob:")&&l.append("checkOutPhotoUrl",e.checkOutPhotoUrl),l.append("checkOutPhotoFile",e.checkOutPhotoFile);const d=await te.post(a,l,{headers:{"Content-Type":"multipart/form-data"}}),u=d==null?void 0:d.data;if(u&&typeof u=="object"&&"data"in u){if(u.isSuccess===!1){const f=u.message||(Array.isArray(u.errors)?u.errors.join("; "):"Request failed"),m=new Error(f);throw m.body=u,m}return u.data}return u}catch(l){n=l;const d=(s=l==null?void 0:l.response)==null?void 0:s.status;if(d&&d!==404&&d!==405)throw l}try{const{checkOutPhotoFile:l,...d}=e,u=await te.post(a,d,{headers:{"Content-Type":"application/json"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const m=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(m);throw g.body=f,g}return f.data}return f}catch(l){n=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}}throw n||new Error("Check-Out-With-Payment endpoint not found")},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await De.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},getAllStations:async(e=1,t=100)=>{var n;try{const s=await te.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}}),o=s==null?void 0:s.data;return Array.isArray(o)?o:o!=null&&o.data&&Array.isArray(o.data)?o.data:(n=o==null?void 0:o.data)!=null&&n.data&&Array.isArray(o.data.data)?o.data.data:o!=null&&o.items&&Array.isArray(o.items)?o.items:(console.warn(" No stations found in response"),[])}catch(s){return console.warn(" getAllStations error:",s.message),[]}},getBookingsByStation:async(e,t=1,n=100)=>{var o;if(!e)throw new Error("stationId is required");const s=encodeURIComponent(e);try{const a=await te.get(`/Bookings/By-Station/${s}`,{params:{pageNumber:t,pageSize:n}}),l=a==null?void 0:a.data;return Array.isArray(l)?l:l!=null&&l.data&&Array.isArray(l.data)?l.data:(o=l==null?void 0:l.data)!=null&&o.data&&Array.isArray(l.data.data)?l.data.data:l!=null&&l.items&&Array.isArray(l.items)?l.items:(console.warn(" No bookings found in response for station:",e),[])}catch(a){return console.warn(" getBookingsByStation error:",a.message),[]}},getAvailableCarsByStation:async e=>{var n;if(!e)return[];const t=encodeURIComponent(e);try{const s=await te.get(`/Cars/Get-Available-By-Station/${t}`),o=s==null?void 0:s.data;return Array.isArray(o)?o:o!=null&&o.data&&Array.isArray(o.data)?o.data:(n=o==null?void 0:o.data)!=null&&n.data&&Array.isArray(o.data.data)?o.data.data:o!=null&&o.items&&Array.isArray(o.items)?o.items:(console.warn(" No available cars found for station:",e),[])}catch(s){return console.warn(" getAvailableCarsByStation error:",s.message),[]}}};function Iy({booking:e={},onClose:t=()=>{},actions:n=null,children:s}){return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,borderBottom:"1px solid #eee"},children:[r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:(e==null?void 0:e.title)||(e==null?void 0:e.carName)||"Booking"}),r.jsx("div",{style:{color:"#666"},children:(e==null?void 0:e.statusLabel)||(e==null?void 0:e.status)})]}),r.jsxs("div",{children:[n,r.jsx("button",{onClick:t,style:{marginLeft:8,padding:"6px 10px",borderRadius:6},children:"Close"})]})]}),r.jsx("div",{style:{padding:16},children:s}),r.jsx("div",{style:{padding:12,borderTop:"1px solid #eee",textAlign:"right"},children:n})]})}function _S(e){if(e==null)return null;if(typeof e=="number")switch(e){case 1:return"booked";case 2:return"waiting_payment";case 3:return"checked-in";case 4:return"completed";case 0:return"cancelled";default:return String(e)}const t=String(e).toLowerCase();return t==="1"?"booked":t==="2"?"waiting_payment":t==="3"?"checked-in":t==="4"?"completed":t==="0"||t.includes("cancel")?"cancelled":t.includes("book")?"booked":t.includes("wait")?"waiting_payment":t.includes("check")?"checked-in":t.includes("complete")?"completed":t}function Ly(e){if(!e&&e!==0)return"";const t=new Date(e);return isNaN(t)?String(e):t.toLocaleString()}function wS({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:o}){var oe,D;const[a,l]=v.useState(!1),[d,u]=v.useState(!1),[f,m]=v.useState(!1),[g,y]=v.useState(!1),[C,N]=v.useState(""),[_,b]=v.useState(!1),[w,x]=v.useState(!1),[k,S]=v.useState(null),[E,P]=v.useState(!1),[R,B]=v.useState(null),[A,I]=v.useState(""),[M,W]=v.useState(""),[V,$]=v.useState(null),[Q,ie]=v.useState(""),[U,H]=v.useState(null),[he,ne]=v.useState(!1);if(v.useEffect(()=>{if(!e)return;l(!1),u(!1),m(!1),y(!1),N(""),H(null),$(null);const ee=e.carId||e.CarId;ee&&tt.getCarById(ee).then(me=>{const nt=(me==null?void 0:me.imageUrl)||(me==null?void 0:me.ImageUrl)||"/Picture/E car 1.jpg";$(nt),console.log(" Loaded car image:",nt)}).catch(me=>{console.warn(" Failed to load car image:",me.message),$("/Picture/E car 1.jpg")});const G=(me,nt)=>[me,nt].filter(Boolean).join(" "),_e=e.fullName||G(e.firstName,e.lastName);if(!_e||/^customer$/i.test(_e)||_e===""||N(_e),!e.id)return;let Ce=!1;async function we(){b(!0);try{const{firstName:me,lastName:nt}=await De.getUserNameByBookingId(e.id);Ce||N(G(me,nt))}catch{}finally{Ce||b(!1)}}async function ze(){if(!e.userId){console.warn(" No userId in booking");return}ne(!0);try{console.log(" Fetching user details for userId:",e.userId);const me=await vt.getUserById(e.userId);Ce||(H(me),console.log(" Fetched user details:",me),console.log(" CCCD Images:",{cccdFrontUrl:me==null?void 0:me.cccdFrontUrl,identityFrontUrl:me==null?void 0:me.identityFrontUrl,idFrontUrl:me==null?void 0:me.idFrontUrl,cccdImageUrl_Front:me==null?void 0:me.cccdImageUrl_Front,cccdBackUrl:me==null?void 0:me.cccdBackUrl,identityBackUrl:me==null?void 0:me.identityBackUrl,idBackUrl:me==null?void 0:me.idBackUrl,cccdImageUrl_Back:me==null?void 0:me.cccdImageUrl_Back}),console.log(" GPLX Images:",{gplxFrontUrl:me==null?void 0:me.gplxFrontUrl,driverLicenseFrontUrl:me==null?void 0:me.driverLicenseFrontUrl,gplxImageUrl_Front:me==null?void 0:me.gplxImageUrl_Front,gplxBackUrl:me==null?void 0:me.gplxBackUrl,driverLicenseBackUrl:me==null?void 0:me.driverLicenseBackUrl,gplxImageUrl_Back:me==null?void 0:me.gplxImageUrl_Back}))}catch(me){console.warn(" Failed to fetch user details:",(me==null?void 0:me.message)||me),console.error("Full error:",me),Ce||H(null)}finally{Ce||ne(!1)}}return we(),ze(),()=>{Ce=!0}},[e]),!e)return null;const xe=(e==null?void 0:e.status)==="booked"?a&&d&&f&&g:!1,ve=()=>{if(!e)return;const ee=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,ee)};return r.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:r.jsx("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:r.jsxs(Iy,{booking:e,onClose:t,actions:null,children:[r.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("img",{id:"modalImage",src:V||"/Picture/E car 1.jpg",alt:"Vehicle",onError:ee=>ee.currentTarget.src="/Picture/E car 1.jpg",style:{width:"100%",height:160,borderRadius:8,objectFit:"cover",display:"block"}}),r.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),r.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),r.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((oe=e.car)==null?void 0:oe.name)||((D=e.car)==null?void 0:D.Name)||""]}),r.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",C||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(_?"Loading":"")]}),r.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",Ly(e.date)]})]}),r.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Pickup Date:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"pickupDate",style:{fontWeight:600},children:e.pickupDate||e.startDate||e.date||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Return Date:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"returnDate",style:{fontWeight:600},children:e.returnDate||e.endDate||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:he?"Loading...":(U==null?void 0:U.identityNumber)||(U==null?void 0:U.idNumber)||(U==null?void 0:U.cmnd)||e.idString||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Address:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:he?"Loading...":(U==null?void 0:U.address)||e.address||""})})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["CCCD Images: ",he&&"(Loading...)"]}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),U!=null&&U.cccdFrontUrl||U!=null&&U.identityFrontUrl||U!=null&&U.idFrontUrl||U!=null&&U.cccdImageUrl_Front||e.cccdFrontUrl?r.jsx("a",{href:(U==null?void 0:U.cccdFrontUrl)||(U==null?void 0:U.identityFrontUrl)||(U==null?void 0:U.idFrontUrl)||(U==null?void 0:U.cccdImageUrl_Front)||e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(U==null?void 0:U.cccdFrontUrl)||(U==null?void 0:U.identityFrontUrl)||(U==null?void 0:U.idFrontUrl)||(U==null?void 0:U.cccdImageUrl_Front)||e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:a,onChange:ee=>l(ee.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),U!=null&&U.cccdBackUrl||U!=null&&U.identityBackUrl||U!=null&&U.idBackUrl||U!=null&&U.cccdImageUrl_Back||e.cccdBackUrl?r.jsx("a",{href:(U==null?void 0:U.cccdBackUrl)||(U==null?void 0:U.identityBackUrl)||(U==null?void 0:U.idBackUrl)||(U==null?void 0:U.cccdImageUrl_Back)||e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(U==null?void 0:U.cccdBackUrl)||(U==null?void 0:U.identityBackUrl)||(U==null?void 0:U.idBackUrl)||(U==null?void 0:U.cccdImageUrl_Back)||e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:d,onChange:ee=>u(ee.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["Driver License (GPLX) Images: ",he&&"(Loading...)"]}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),U!=null&&U.gplxFrontUrl||U!=null&&U.driverLicenseFrontUrl||U!=null&&U.gplxImageUrl_Front||e.gplxFrontUrl?r.jsx("a",{href:(U==null?void 0:U.gplxFrontUrl)||(U==null?void 0:U.driverLicenseFrontUrl)||(U==null?void 0:U.gplxImageUrl_Front)||e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(U==null?void 0:U.gplxFrontUrl)||(U==null?void 0:U.driverLicenseFrontUrl)||(U==null?void 0:U.gplxImageUrl_Front)||e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:ee=>m(ee.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),U!=null&&U.gplxBackUrl||U!=null&&U.driverLicenseBackUrl||U!=null&&U.gplxImageUrl_Back||e.gplxBackUrl?r.jsx("a",{href:(U==null?void 0:U.gplxBackUrl)||(U==null?void 0:U.driverLicenseBackUrl)||(U==null?void 0:U.gplxImageUrl_Back)||e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(U==null?void 0:U.gplxBackUrl)||(U==null?void 0:U.driverLicenseBackUrl)||(U==null?void 0:U.gplxImageUrl_Back)||e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:g,onChange:ee=>y(ee.target.checked)})," Verified"]})]})]})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{id:"customerPhone",style:{padding:6},children:he?"Loading...":(U==null?void 0:U.phoneNumber)||(U==null?void 0:U.phone)||e.phone||""}),((U==null?void 0:U.phoneNumber)||(U==null?void 0:U.phone)||e.phone)&&r.jsx("a",{href:`tel:${(U==null?void 0:U.phoneNumber)||(U==null?void 0:U.phone)||e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!xe,style:{background:xe?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),r.jsx("button",{onClick:ve,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&r.jsx("button",{onClick:()=>n==null?void 0:n(e,"checkout"),style:{background:"#d32f2f",color:"#fff",width:"100%",padding:"12px",borderRadius:6,border:"none",cursor:"pointer",fontWeight:600,fontSize:14},children:"Check Out"})]}),A&&r.jsx("div",{style:{marginTop:8,color:"#b00020"},children:A})]})]}),r.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[r.jsx("h4",{children:"Transaction Details"}),r.jsxs("ul",{style:{fontSize:"1rem"},children:[r.jsx("li",{children:"Find rental location on map"}),r.jsx("li",{children:"View available vehicles (type, battery, price)"}),r.jsx("li",{children:"Book in advance or on-site"}),r.jsx("li",{children:"Check-in at counter/app"}),r.jsx("li",{children:"Sign electronic contract"}),r.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),r.jsx("li",{children:"Return vehicle at rental location"}),r.jsx("li",{children:"Staff checks and confirms vehicle condition"}),r.jsx("li",{children:"Pay any additional fees"})]})]})]})})})}function jS({bookings:e=[],search:t="",setSearch:n=()=>{},statusFilter:s="",setStatusFilter:o=()=>{},onRowClick:a=()=>{}}){const[l,d]=v.useState(""),[u,f]=v.useState("asc"),m=S=>{l===S?f(E=>E==="asc"?"desc":"asc"):(d(S),f("desc"))},g=(e||[]).filter(S=>(S.title||"").toLowerCase().includes((t||"").toLowerCase())||(S.customer||"").toLowerCase().includes((t||"").toLowerCase())||(S.userName||"").toLowerCase().includes((t||"").toLowerCase())||(S.email||"").toLowerCase().includes((t||"").toLowerCase())).filter(S=>s===""||S.status===s),y=(S,E=[])=>{if(!S)return null;for(const P of E){const R=[P,P[0].toLowerCase()+P.slice(1),P[0].toUpperCase()+P.slice(1)];for(const B of R)try{const A=S[B];if(A!=null&&String(A).trim()!=="")return A}catch{}}return null},C=(()=>{const S=Array.isArray(g)?[...g]:[];if(!l)return S;if(l==="date"){const E=P=>{const R=y(P,["date","bookingDate","createdAt","created","CreatedAt","Created","created_date"])||"",B=Date.parse(String(R));return Number.isFinite(B)?B:0};return S.sort((P,R)=>u==="asc"?E(P)-E(R):E(R)-E(P)),S}return S.sort((E,P)=>{const R=l==="vehicle"?String(E.title||"").toLowerCase():String(E.fullName||E.customer||"").toLowerCase(),B=l==="vehicle"?String(P.title||"").toLowerCase():String(P.fullName||P.customer||"").toLowerCase();return R===B?0:u==="asc"?R.localeCompare(B):B.localeCompare(R)}),S})(),[N,_]=v.useState({}),[b,w]=v.useState({});v.useEffect(()=>{let S=!0;async function E(){try{const P=Array.from(new Set((e||[]).map(A=>{var I,M,W,V;return A.carId||A.CarId||((I=A.car)==null?void 0:I.id)||((M=A.car)==null?void 0:M.Id)||((W=A.vehicle)==null?void 0:W.id)||((V=A.vehicle)==null?void 0:V.Id)}).filter(Boolean)));if(P.length===0)return;const R=await Promise.all(P.map(async A=>{try{const I=await tt.getCarById(A),M=(I==null?void 0:I.imageUrl)||(I==null?void 0:I.ImageUrl)||(I==null?void 0:I.thumbnailUrl)||(I==null?void 0:I.image)||null,W=(I==null?void 0:I.licensePlate)||(I==null?void 0:I.LicensePlate)||(I==null?void 0:I.plate)||(I==null?void 0:I.Plate)||null;return[String(A),{image:M,licensePlate:W}]}catch{return[String(A),{image:null,licensePlate:null}]}}));if(!S)return;const B={};for(const[A,I]of R)B[A]=I;_(B)}catch{}}return E(),()=>{S=!1}},[e]);const x=S=>{if(!S)return"-";try{const E=new Date(S);if(!isNaN(E.getTime()))return E.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+):(\d+)/,"$3-$2-$1 $4:$5:$6")}catch{}return S},k=S=>{var I,M,W,V;if(!S)return{name:null,email:null,phone:null};const E=S.userId||S.UserId||S.customerId||S.CustomerId||S.UserID||S.User||((I=S.user)==null?void 0:I.id),P=E?b[String(E)]||{}:{},R=S.fullName||S.userFullName||S.customerName||S.customer||((M=S.user)==null?void 0:M.fullName)||P.fullName||[S.firstName,S.lastName].filter(Boolean).join(" ")||S.userName||S.UserName||P.userName||null,B=S.email||S.customerEmail||S.userEmail||((W=S.user)==null?void 0:W.email)||P.email||null,A=S.phone||S.customerPhone||((V=S.user)==null?void 0:V.phoneNumber)||S.mobile||S.mobileNumber||P.phone||null;return{name:R,email:B,phone:A}};return v.useEffect(()=>{let S=!0;async function E(){try{const P=Array.from(new Set((e||[]).map(A=>A.userId||A.UserId||A.customerId||A.CustomerId).filter(Boolean)));if(P.length===0)return;const R=await Promise.all(P.map(async A=>{try{const I=await Ol.getUserById(A),M=(I==null?void 0:I.email)||(I==null?void 0:I.Email)||(I==null?void 0:I.userEmail)||(I==null?void 0:I.userName)||null,W=(I==null?void 0:I.phoneNumber)||(I==null?void 0:I.phone)||(I==null?void 0:I.Phone)||(I==null?void 0:I.mobile)||null,V=(I==null?void 0:I.fullName)||(I==null?void 0:I.FullName)||[I==null?void 0:I.firstName,I==null?void 0:I.lastName].filter(Boolean).join(" ")||null;return[String(A),{email:M,phone:W,fullName:V}]}catch{return[String(A),{email:null,phone:null,fullName:null}]}}));if(!S)return;const B={};for(const[A,I]of R)B[A]=I;w(B)}catch{}}return E(),()=>{S=!1}},[e]),v.useEffect(()=>{try{if(!Array.isArray(e)||e.length===0)return;e.slice(0,8).forEach(E=>{const P={id:E.id||E.Id||E.bookingId||E.BookingId,pickupDate:E.pickupDate,rentalStartDate:E.rentalStartDate,startDateTime:E.startDateTime,startDate:E.startDate,pickup:E.pickup,fromDate:E.fromDate,returnDate:E.returnDate,rentalEndDate:E.rentalEndDate,endDateTime:E.endDateTime,endDate:E.endDate,toDate:E.toDate,bookingDate:E.bookingDate,date:E.date,createdAt:E.createdAt,created:E.created};console.debug("BookingTable: booking date fields for",P.id,P)})}catch(S){console.warn("BookingTable debug failed",S)}},[e]),r.jsxs("div",{className:"booking-model",children:[r.jsxs("div",{className:"booking-filter",style:{display:"flex",gap:8,marginBottom:12,alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Search bookings...",value:t,onChange:S=>n(S.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd",flex:"1 1 320px"}}),r.jsxs("select",{value:s,onChange:S=>o(S.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"",children:"All statuses"}),r.jsx("option",{value:"booked",children:"Booked"}),r.jsx("option",{value:"waiting_payment",children:"Waiting Payment"}),r.jsx("option",{value:"checked-in",children:"Checked In"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"booking-table",style:{width:"100%",borderCollapse:"collapse",minWidth:840},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",background:"#fafafa"},children:[r.jsx("th",{style:{padding:"12px 10px"},children:"Vehicle"}),r.jsx("th",{style:{padding:"12px 10px",width:220},children:"Email"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Phone"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Return"}),r.jsx("th",{style:{padding:"12px 10px",cursor:"pointer",userSelect:"none"},onClick:()=>m("date"),children:r.jsxs("span",{style:{display:"inline-flex",gap:8,alignItems:"center"},children:["Booking Date",r.jsx("span",{style:{fontSize:12,color:"#666"},children:l==="date"?u==="asc"?"":"":""})]})}),r.jsx("th",{style:{padding:"12px 10px"},children:"Status"}),r.jsx("th",{style:{padding:"12px 10px",width:120},children:"Actions"})]})}),r.jsxs("tbody",{children:[C.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{padding:24,color:"#666"},children:"No bookings found"})}),C.map(S=>r.jsxs("tr",{className:"booking-row",onClick:()=>a(S),style:{cursor:"pointer",borderBottom:"1px solid #eee"},children:[r.jsxs("td",{style:{padding:"12px 10px",display:"flex",gap:12,alignItems:"center"},children:[r.jsx("img",{src:(()=>{var B,A,I,M;const E=S.carId||S.CarId||((B=S.car)==null?void 0:B.id)||((A=S.car)==null?void 0:A.Id)||((I=S.vehicle)==null?void 0:I.id)||((M=S.vehicle)==null?void 0:M.Id),P=E?N[String(E)]:null;return P&&P.image||S.img||qu(S.img)||"https://via.placeholder.com/100x60?text=Car"})(),onError:E=>{E.target.onerror=null,Vu(E.currentTarget)},alt:"car",style:{width:100,height:60,objectFit:"cover",borderRadius:6,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",background:"#fff"}}),r.jsx("div",{children:r.jsx("div",{style:{fontWeight:600},children:S.title||"Vehicle"})})]}),(()=>{const E=k(S);return r.jsxs(r.Fragment,{children:[r.jsx("td",{style:{padding:"12px 10px"},children:E.email||"-"}),r.jsx("td",{style:{padding:"12px 10px"},children:E.phone||"-"})]})})(),r.jsx("td",{style:{padding:"12px 10px"},children:x(y(S,["ExpectedReturnDateTime","returnDate","rentalEndDate","endDateTime","endDate","toDate","actualReturnDate","actualReturnDateTime","end","end_at","return_at"]))}),r.jsx("td",{style:{padding:"12px 10px"},children:x(y(S,["date","bookingDate","createdAt","created","CreatedAt","Created","created_date"]))}),r.jsx("td",{style:{padding:"12px 10px"},children:r.jsx("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:999,background:S.status==="completed"?"#e6f7ec":S.status==="cancelled"?"#fff0f0":"#f0f6ff",color:S.status==="completed"?"#2b8a3e":S.status==="cancelled"?"#b00020":"#1351b4",fontWeight:600,fontSize:12},children:S.statusLabel||S.status||""})}),r.jsx("td",{style:{padding:"12px 10px"},children:r.jsx("button",{onClick:E=>{E.stopPropagation(),a(S)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:"pointer"},children:"Details"})})]},S.id))]})]})})]})}function yp(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function SS({booking:e,onClose:t,onCheckedIn:n}){const[s,o]=v.useState(""),[a,l]=v.useState(null),[d,u]=v.useState(!1),[f,m]=v.useState(""),[g,y]=v.useState(null),[C,N]=v.useState(null),[_,b]=v.useState(""),[w,x]=v.useState(""),[k,S]=v.useState(""),[E,P]=v.useState(!1),[R,B]=v.useState(!1),[A,I]=v.useState(!1);hr.useEffect(()=>{let V=!0;return(async()=>{try{const $=await De.getServerTime();V&&y($);try{const Q=$?$.getTime()-Date.now():0;console.log(" Server time:",$,"Client time:",new Date,"(ms):",Q)}catch{}}catch{}})(),()=>{V=!1}},[]);async function M(V){var $,Q;if(V.preventDefault(),!!(e!=null&&e.id)){u(!0),m("");try{const ie=localStorage.getItem("token");if(!ie||ie==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let U="";try{U=localStorage.getItem("userId")||""}catch{}if(!U)try{const ve=localStorage.getItem("token");if(ve){const oe=Pr(ve);U=oe["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||oe.sub||oe.userId||oe.UserId||oe.id||oe.Id||""}}catch{}if(!U)throw new Error("Unable to determine userId. Please sign in again.");const H={bookingId:e.id,staffId:U,renterId:e.userId},he=(s||"").trim();he&&(H.checkInNotes=he),a&&(H.checkInPhotoFile=a),console.log(" Check-in payload:",H),console.log(" Staff check-in info:",{bookingId:e.id,staffId:U,renterId:e.userId});const ne=await De.checkInWithContract(H);console.log(" Check-in response:",ne),localStorage.setItem("activeCheckInBookingId",e.id),console.log(" Saved activeCheckInBookingId to localStorage:",e.id),N(ne);const xe=(ne==null?void 0:ne.totalAmount)||(ne==null?void 0:ne.TotalAmount)||0;if(console.log(" Total amount for payment:",xe),xe>0){P(!0);try{const ve=await Ir.createPayment(e.id,1,"Rental payment at check-in");console.log(" Payment created:",ve);const oe=ve||{},D=oe.checkoutUrl||oe.url||oe.payUrl||"";D?(console.log(" Opening Payos checkout in new tab:",D),b(D),window.open(D,"_blank")):(console.warn(" No checkout URL in payment response:",oe),b(""),m("Payment session created but no checkout URL received. Please try again."))}catch(ve){console.error(" Payment creation failed:",ve==null?void 0:ve.message),m(`Check-in succeeded but payment setup failed: ${ve==null?void 0:ve.message}. Please try again.`)}finally{P(!1)}}typeof n=="function"&&n(e.id,H)}catch(ie){const U=(ie==null?void 0:ie.body)||(($=ie==null?void 0:ie.response)==null?void 0:$.data),H=U&&(U.errors||U.Errors)||null,he=(Array.isArray(H)&&H.length?H.join("; "):null)||(U==null?void 0:U.message)||(ie==null?void 0:ie.message)||"Failed to save check-in";m(he);try{console.error(" Check-in failed:",{error:ie==null?void 0:ie.message,status:(ie==null?void 0:ie.status)||((Q=ie==null?void 0:ie.response)==null?void 0:Q.status),body:U})}catch{}}finally{u(!1)}}}async function W(){if(e!=null&&e.id){B(!0),m("");try{console.log(" Syncing payment for booking:",e.id),await Ir.syncPayment(e.id),console.log(" Payment synced successfully");const V=await nn.getBookingById(e.id);console.log(" Updated booking status:",V.bookingStatus),I(!0),m(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(V){console.error(" Payment sync failed:",V),m(`Payment sync failed: ${V.message}`),I(!1)}finally{B(!1)}}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),C?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check-in Successful"}),r.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(C==null?void 0:C.message)||"Check-in successful!"]}),f&&r.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:f}),E&&r.jsx("div",{style:{background:"#e3f2fd",color:"#1565c0",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Creating payment session and redirecting to Payos..."}),_&&!E&&r.jsx("div",{style:{background:"#f3e5f5",color:"#7b1fa2",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment session created. Payos opened in new tab."}),A&&r.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[r.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),r.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Total Amount:"}),r.jsx("strong",{children:yp((C==null?void 0:C.totalAmount)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:14},children:[r.jsx("span",{children:"Deposit (30%):"}),r.jsx("strong",{children:yp((C==null?void 0:C.depositAmount)||0)})]})]})]}),r.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:r.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment Processing"}),E?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:"Preparing payment link..."}),r.jsx("div",{style:{fontSize:12,color:"#999"},children:"You will be redirected to Payos to complete payment."})]}):_?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:" Payment link opened in new tab"}),r.jsx("div",{style:{fontSize:12,color:"#999",marginBottom:16},children:"After customer completes payment, click the button below to sync"}),r.jsx("button",{onClick:W,disabled:R||A,style:{background:A?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:R||A?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:R?" Syncing...":A?" Synced!":" Sync Payment Status"})]}):r.jsx("div",{style:{fontSize:13,color:"#d32f2f",padding:"12px",background:"#ffebee",borderRadius:6},children:" Payment setup incomplete"})]})})]}),r.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",r.jsx("strong",{children:"Note:"})," You will be redirected to Payos to complete payment. After payment completes, you will be redirected to the payment success page."]}),!E&&!_&&r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check In"}),g&&r.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",g.toLocaleString()]}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),r.jsxs("form",{onSubmit:M,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-in Notes"}),r.jsx("textarea",{rows:5,value:s,onChange:V=>o(V.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-in Photo (Optional)"}),r.jsx("input",{type:"file",accept:"image/*",onChange:V=>l(V.target.files[0]||null),placeholder:"Select an image file"}),a&&r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Selected: ",a.name," (",(a.size/1024/1024).toFixed(2)," MB)"]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:d,style:{background:d?"#9e9e9e":"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px",cursor:d?"not-allowed":"pointer"},children:d?"Processing":"Confirm Check In"})]})]})]})]})})}function oa(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function CS({booking:e,onClose:t,onCheckedOut:n}){const[s,o]=v.useState(""),[a,l]=v.useState(0),[d,u]=v.useState(""),[f,m]=v.useState("15:00"),[g,y]=v.useState(null),[C,N]=v.useState(new Date().getMonth()),[_,b]=v.useState(new Date().getFullYear()),[w,x]=v.useState(!1),[k,S]=v.useState(""),[E,P]=v.useState(null),[R,B]=v.useState(null),[A,I]=v.useState(""),[M,W]=v.useState(!1),[V,$]=v.useState(!1),[Q,ie]=v.useState(!1),U=Array.from({length:18},(oe,D)=>`${(6+D).toString().padStart(2,"0")}:00`);hr.useEffect(()=>{let oe=!0;return(async()=>{try{const D=await De.getServerTime();if(oe&&(P(D),D)){const G=D.toISOString().split("T")[0];u(G)}try{const ee=D?D.getTime()-Date.now():0;console.log(" Server time:",D,"Client time:",new Date,"(ms):",ee)}catch{}}catch{}})(),()=>{oe=!1}},[]);function H(){const oe=new Date(_,C,1),D=new Date(_,C+1,0),ee=[];for(let _e=0;_e<oe.getDay();_e++)ee.push(r.jsx("div",{},`empty-${_e}`));const G=new Date;G.setHours(0,0,0,0);for(let _e=1;_e<=D.getDate();_e++){const Ie=`${_}-${(C+1).toString().padStart(2,"0")}-${_e.toString().padStart(2,"0")}`,we=new Date(Ie)<G,ze=Ie===d,me=["calendar-day"];we&&me.push("past"),ze&&me.push("selected"),ee.push(r.jsx("div",{className:me.join(" "),onClick:nt=>{nt.stopPropagation(),we||(u(Ie),y(null))},style:{cursor:we?"not-allowed":"pointer",opacity:we?.4:1,pointerEvents:we?"none":"auto"},children:_e},Ie))}return ee}function he(oe){let D=C+oe,ee=_;D>11&&(D=0,ee++),D<0&&(D=11,ee--),N(D),b(ee)}async function ne(oe){var D,ee;if(oe.preventDefault(),!!(e!=null&&e.id)){x(!0),S("");try{const G=localStorage.getItem("token");if(!G||G==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let _e="";try{_e=localStorage.getItem("userId")||""}catch{}if(!_e)try{const ae=localStorage.getItem("token");if(ae){const le=decodeJwt(ae);_e=le["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||le.sub||le.userId||le.UserId||le.id||le.Id||""}}catch{}if(!_e)throw new Error("Unable to determine userId. Please sign in again.");const Ie={bookingId:e.id,staffId:_e,actualReturnDateTime:d&&f?new Date(`${d}T${f}`).toISOString():new Date().toISOString(),checkOutPhotoUrl:"",damageFee:Number(a)||0},Ce=(s||"").trim();Ce&&(Ie.checkOutNotes=Ce);const we=await De.checkOutWithPayment(Ie);console.log(" Check-out response:",we),localStorage.setItem("activeCheckOutBookingId",e.id),console.log(" Saved activeCheckOutBookingId to localStorage:",e.id),B(we);const ze=await De.getBookingById(e.id);console.log(" Updated booking:",ze),ze&&B(ae=>({...ae,...ze}));const me=Number(a)||0,nt=Number((ze==null?void 0:ze.extraAmount)||0),gn=me+nt;if(console.log(" Payment amounts - Damage:",me,"Backend Extra:",nt,"Total:",gn),gn>0){W(!0);try{const ae=await Ir.createPayment(e.id,2,"Rental payment at check-out",gn);console.log(" Payment created:",ae);const le=ae||{},ye=le.checkoutUrl||le.url||le.payUrl||"";ye?(console.log(" Opening Payos checkout in new tab:",ye),I(ye),window.open(ye,"_blank")):(console.warn(" No checkout URL in payment response:",le),I(""),S("Payment session created but no checkout URL received. Please try again."))}catch(ae){console.error(" Payment creation failed:",ae==null?void 0:ae.message),S(`Check-out succeeded but payment setup failed: ${ae==null?void 0:ae.message}. Please try again.`)}finally{W(!1)}}else{console.log(" No extra amount - creating checkout-only payment (type 3)");try{W(!0);const ae=await Ir.createPayment(e.id,3,"Checkout without payment");console.log(" Checkout-only payment created:",ae),I(""),setTimeout(()=>{typeof n=="function"&&n(e.id,[])},500)}catch(ae){console.error(" Checkout-only payment creation failed:",ae==null?void 0:ae.message),S(`Check-out succeeded but payment record creation failed: ${ae==null?void 0:ae.message}. Please contact support.`)}finally{W(!1)}}let fe=[];try{fe=await De.getIncidentsByBooking(e.id,1,20),console.log(" Fetched incidents immediately after checkout:",fe)}catch(ae){console.warn(" Failed to fetch incidents after checkout:",(ae==null?void 0:ae.message)||ae)}typeof n=="function"&&n(e.id,fe)}catch(G){const _e=(G==null?void 0:G.body)||((D=G==null?void 0:G.response)==null?void 0:D.data),Ie=_e&&(_e.errors||_e.Errors)||null,Ce=(Array.isArray(Ie)&&Ie.length?Ie.join("; "):null)||(_e==null?void 0:_e.message)||(G==null?void 0:G.message)||"Failed to save check-out";S(Ce);try{console.error(" Check-out failed:",{error:G==null?void 0:G.message,status:(G==null?void 0:G.status)||((ee=G==null?void 0:G.response)==null?void 0:ee.status),body:_e})}catch{}}finally{x(!1)}}}async function xe(){if(e!=null&&e.id){W(!0),S("");try{localStorage.setItem("activeCheckOutBookingId",e.id);const oe=Number((R==null?void 0:R.extraAmount)||0),D=Number(a)||0,ee=Math.max(oe,D);console.log(" Creating payment - ExtraAmount:",oe,"DamageFee:",D,"Using:",ee);const G=await Ir.createPayment(e.id,2,"Rental payment at check-out",ee);console.log(" Payment created:",G);const _e=G||{},Ie=_e.checkoutUrl||_e.url||_e.payUrl||"";Ie?(console.log(" Opening Payos checkout:",Ie),I(Ie),window.open(Ie,"_blank")):(console.warn(" No checkout URL in payment response:",_e),S("No checkout URL received. Please try again."))}catch(oe){console.error(" Payment creation failed:",oe==null?void 0:oe.message),S(`Payment setup failed: ${oe==null?void 0:oe.message}`)}finally{W(!1)}}}async function ve(){if(e!=null&&e.id){$(!0),S("");try{console.log(" Syncing payment for booking:",e.id),await Ir.syncPayment(e.id),console.log(" Payment synced successfully");const oe=await nn.getBookingById(e.id);console.log(" Updated booking status:",oe.bookingStatus),ie(!0),S(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(oe){console.error(" Payment sync failed:",oe),S(`Payment sync failed: ${oe.message}`),ie(!1)}finally{$(!1)}}}return r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),R?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check-out Successful"}),r.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(R==null?void 0:R.message)||"Check-out successful!"]}),k&&r.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:k}),Q&&r.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[r.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),r.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Damage Fee:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:oa((R==null?void 0:R.damageFee)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Late Fee:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:oa((R==null?void 0:R.lateFee)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid #eee",paddingTop:8,fontSize:14,fontWeight:600},children:[r.jsx("span",{children:"Total Additional Fees:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:oa(((R==null?void 0:R.damageFee)||0)+((R==null?void 0:R.lateFee)||0))})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,fontSize:14},children:[r.jsx("span",{children:"Refund Amount:"}),r.jsx("strong",{style:{color:"#2e7d32"},children:oa((R==null?void 0:R.refundAmount)??(R==null?void 0:R.RefundAmount)??(R==null?void 0:R.refund)??0)})]})]})]}),r.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:r.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment"}),((R==null?void 0:R.extraAmount)||0)>0?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{fontSize:13,color:"#666",marginBottom:16,lineHeight:1.5},children:["Amount to pay: ",r.jsx("strong",{children:oa((R==null?void 0:R.extraAmount)||0)})]}),A?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:12},children:" Payment link opened in new tab"}),r.jsx("button",{onClick:ve,disabled:V||Q,style:{background:Q?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:V||Q?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:V?" Syncing...":Q?" Synced!":" Sync Payment Status"})]}):r.jsx("button",{onClick:xe,disabled:M,style:{background:"#4CAF50",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:M?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%",marginBottom:8},children:M?" Opening Payment...":" Go to Payment"})]}):r.jsx("div",{style:{fontSize:13,color:"#2e7d32",padding:"12px",background:"#e8f5e9",borderRadius:6},children:" No additional payment needed"})]})})]}),r.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",r.jsx("strong",{children:"Note:"}),' Click "Go to Payment" to open Payos in new tab. After customer completes payment, click "Sync Payment Status" to update booking.']}),r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check Out"}),E&&r.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",E.toLocaleString()]}),k&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:k}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),r.jsxs("form",{onSubmit:ne,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:12,position:"relative"},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Return Date"}),r.jsx("div",{onClick:oe=>{oe.stopPropagation(),y(g==="return"?null:"return")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:d?new Date(d).toLocaleDateString():"Select date"})]}),g==="return"&&r.jsxs("div",{onClick:oe=>oe.stopPropagation(),style:{position:"absolute",top:"100%",left:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:12,marginTop:4,zIndex:10,minWidth:280,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("button",{type:"button",onClick:oe=>{oe.stopPropagation(),he(-1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""}),r.jsx("span",{style:{fontWeight:600},children:new Date(_,C).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{type:"button",onClick:oe=>{oe.stopPropagation(),he(1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,marginBottom:8},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(oe=>r.jsx("div",{style:{textAlign:"center",fontSize:12,fontWeight:600},children:oe},oe))}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:H()})]})]}),r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Return Time"}),r.jsx("div",{onClick:oe=>{oe.stopPropagation(),y(g==="return-time"?null:"return-time")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:f})]}),g==="return-time"&&r.jsx("div",{onClick:oe=>oe.stopPropagation(),style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:8,marginTop:4,zIndex:1001,maxHeight:240,overflow:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:U.map(oe=>r.jsx("div",{onClick:D=>{D.stopPropagation(),m(oe),y(null)},style:{padding:"8px 12px",cursor:"pointer",background:oe===f?"#e3f2fd":"#fff",color:oe===f?"#1976d2":"#333",fontWeight:oe===f?"600":"400",borderRadius:4,marginBottom:4},children:oe},oe))})]})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-out Notes"}),r.jsx("textarea",{rows:4,value:s,onChange:oe=>o(oe.target.value),placeholder:"Notes about the vehicle condition upon return, battery level, etc."})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Damage Fee (VND)"}),r.jsx("input",{type:"number",min:"0",value:a,onChange:oe=>l(oe.target.value),placeholder:"Enter damage fee (based on incidents reviewed)"})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:w,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:w?"Processing":"Confirm Check Out"})]})]})]})]})}var NS={};function kS({bookingId:e,onClose:t,refreshKey:n,initialIncidents:s=[]}){const[o,a]=v.useState([]),[l,d]=v.useState(!1),[u,f]=v.useState(!0),[m,g]=v.useState(""),[y,C]=v.useState(1),N=20;v.useEffect(()=>{if(!e)return;let b=!0;return(async()=>{f(!0),g("");try{!l&&Array.isArray(s)&&s.length>0&&(a(s),d(!0));const x=[0,1e3,3e3];for(let k=0;k<x.length&&b;k++){x[k]>0&&await new Promise(S=>setTimeout(S,x[k]));try{const S=await De.getIncidentsByBooking(e,y,N),E=Array.isArray(S)?S:[];if(console.log(` Incidents loaded (attempt ${k+1}):`,E),E.length>0){if(!b)return;a(E);return}if(k===x.length-1){if(!b)return;a([])}}catch(S){console.warn(" Incident fetch attempt failed:",(S==null?void 0:S.message)||S)}}}catch(x){console.error(" Failed to load incidents:",x),b&&g((x==null?void 0:x.message)||"Failed to load incidents")}finally{b&&f(!1)}})(),()=>{b=!1}},[e,y,n]);const _=b=>{const w=String(b).toLowerCase();return w.includes("resolved")||w.includes("low")?"#2e7d32":w.includes("medium")?"#f57c00":w.includes("high")||w.includes("open")||w.includes("new")?"#d32f2f":"#666"};return r.jsxs("div",{className:"modal-content",style:{width:"min(900px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"16px 16px 0 0"},children:[r.jsx("h3",{style:{margin:0,fontSize:20,fontWeight:700},children:"Related Incidents"}),r.jsx("span",{className:"close-btn",onClick:t,style:{cursor:"pointer",fontSize:24},children:""})]}),u?r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" Loading incidents..."}):m?r.jsxs("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6},children:[" ",m]}):o.length===0?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" No incidents reported for this booking"}),y>1&&!u&&r.jsx("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:r.jsx("button",{onClick:()=>C(1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Reset to Page 1"})})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.map((b,w)=>{var V;const x=b.id||b._id||"",k=b.description||b.title||"",S=k&&k.length>80?k.slice(0,80)+"":k,E=b.status||b.severity||"N/A",P=b.reportedAt||b.reportedDate||b.timestamp||b.createdAt||null,R=b.resolvedAt||b.resolvedDate||null,B=b.costIncurred??b.estimatedCost??null,A=b.staffName||b.staff||b.reportedBy||null,I=b.resolverName||b.resolvedBy||null,M=Array.isArray(b.images)?b.images:[],W=$=>$?typeof $=="string"&&($.startsWith("http://")||$.startsWith("https://"))?$:typeof $=="string"&&$.trim()?`${NS.REACT_APP_API_URL||window.location.origin}/${$.replace(/^\//,"")}`:null:null;return r.jsxs("div",{style:{border:"1px solid #eee",padding:16,borderRadius:6,display:"flex",gap:16},children:[r.jsx("div",{style:{flex:"0 0 120px"},children:M.length>0&&W(M[0])?r.jsx("img",{src:W(M[0]),alt:"incident",style:{width:120,height:90,objectFit:"cover",borderRadius:6},onError:$=>{$.target.style.display="none"}}):r.jsx("div",{style:{width:120,height:90,background:"#fafafa",border:"1px dashed #eee",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:12},children:"No image"})}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[r.jsxs("div",{children:[r.jsx("h4",{style:{margin:"0 0 6px",fontSize:15,fontWeight:700},children:S||`Incident ${((V=x==null?void 0:x.slice)==null?void 0:V.call(x,0,8))||w+1}`}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",x||"N/A"]})]}),r.jsx("div",{style:{textAlign:"right"},children:r.jsx("div",{style:{background:_(E),color:"#fff",padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:700},children:E})})]}),r.jsx("p",{style:{margin:"0 0 10px",fontSize:14,color:"#555",lineHeight:1.5},children:k||"No description"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12,fontSize:13,color:"#666"},children:[r.jsxs("div",{children:[" Est. Cost: ",r.jsx("strong",{style:{color:"#d32f2f"},children:B!==null?`${Number(B).toLocaleString()} VND`:"N/A"})]}),r.jsxs("div",{children:[" Reported: ",r.jsx("strong",{children:P?new Date(P).toLocaleString():"N/A"})]}),r.jsxs("div",{children:[" Resolved: ",r.jsx("strong",{children:R?new Date(R).toLocaleString():"N/A"})]}),r.jsxs("div",{children:[" Staff: ",r.jsx("strong",{children:A||"N/A"})]}),I&&r.jsxs("div",{children:[" Resolver: ",r.jsx("strong",{children:I})]})]})]})]},x||w)})}),!u&&o.length>0&&r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:[r.jsx("button",{onClick:()=>C(b=>Math.max(1,b-1)),disabled:y===1,style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:y===1?"not-allowed":"pointer"},children:" Prev"}),r.jsxs("span",{style:{padding:"6px 12px"},children:["Page ",y]}),r.jsx("button",{onClick:()=>C(b=>b+1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Next "})]})]})}function bS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onContinuePayment:a,onCancelBooking:l,onStatusUpdated:d}){const[u,f]=v.useState(null),[m,g]=v.useState(null),[y,C]=v.useState(null),[N,_]=v.useState(0),[b,w]=v.useState([]),x=v.useCallback(S=>{typeof d=="function"&&d(S)},[d]);hr.useEffect(()=>{if(!(y!=null&&y.id))return;const S={current:!1},E=setInterval(async()=>{try{const P=localStorage.getItem("activeCheckOutBookingId");if(S.current){if(!P){console.log(" Checkout payment completed (user redirected)"),clearInterval(E),C(null),x(y==null?void 0:y.id);return}P&&P!==String(y.id)&&(S.current=!1)}else if(P===String(y.id))S.current=!0,console.log(" Detected active check-out payment flow for",y.id);else return}catch(P){console.warn(" Polling error:",P==null?void 0:P.message)}},2e3);return()=>clearInterval(E)},[y==null?void 0:y.id,x]),hr.useEffect(()=>{if(!(m!=null&&m.id))return;const S={current:!1},E=setInterval(()=>{try{const P=localStorage.getItem("activeCheckInBookingId");if(S.current){if(!P){console.log(" Check-in payment completed (user redirected)"),clearInterval(E),g(null),x(m==null?void 0:m.id);return}P&&P!==String(m.id)&&(S.current=!1)}else if(P===String(m.id))S.current=!0,console.log(" Detected active check-in payment flow for",m.id);else return}catch(P){console.warn(" Polling error (check-in):",P==null?void 0:P.message)}},2e3);return()=>clearInterval(E)},[m==null?void 0:m.id,x]);const k=e.filter(S=>(S.title.toLowerCase().includes(t.toLowerCase())||(S.customer||"").toLowerCase().includes(t.toLowerCase())||(S.userName||"").toLowerCase().includes(t.toLowerCase())||(S.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||S.status===s));return r.jsxs(r.Fragment,{children:[r.jsx(jS,{bookings:k,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onRowClick:S=>f(S)}),r.jsx(wS,{booking:u,onClose:()=>f(null),onProceed:(S,E)=>{S&&(E==="checkout"?(C(S),f(null)):(g(S),f(null)))},onCancel:()=>{u&&(l==null||l(u))},onStatusUpdated:d}),m&&r.jsx(SS,{booking:m,onClose:()=>g(null)}),y&&r.jsxs("div",{style:{display:"flex",gap:24,position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:1e3,alignItems:"center",justifyContent:"center",padding:20,overflow:"auto"},children:[r.jsx("div",{style:{flex:"0 0 auto",width:"720px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:r.jsx(CS,{booking:y,onClose:()=>C(null),onCheckedOut:(S,E=[])=>{_(P=>P+1),w(Array.isArray(E)?E:[]),typeof d=="function"&&d(S)}})}),r.jsx("div",{style:{flex:"0 0 auto",width:"600px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:r.jsx(kS,{bookingId:y==null?void 0:y.id,refreshKey:N,initialIncidents:b,onClose:()=>{C(null),w([])}})})]})]})}function IS({open:e,onClose:t,onSubmit:n,stationId:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,C]=v.useState(""),[N,_]=v.useState(""),[b,w]=v.useState(""),[x,k]=v.useState(""),[S,E]=v.useState(""),[P,R]=v.useState(""),[B,A]=v.useState(""),[I,M]=v.useState("");if(!e)return null;async function W(){if(M(""),!s){M("Please select a station before creating a vehicle.");return}if(!o.trim()||!l.trim()||!y.trim()||!u||!N||!b||!x||!S){M("Please fill all required fields: Brand, Model, Year, License Plate, Battery Capacity, Current Battery, Price/hour, Price/day.");return}const V=Number(u),$=Number(N),Q=Number(b),ie=Number(x),U=Number(S);if(!Number.isFinite(V)||V<1900||V>2100){M("Year must be between 1900 and 2100.");return}if(!Number.isFinite($)||$<0||$>100){M("Battery Capacity must be between 0 and 100 (kWh).");return}if(!Number.isFinite(Q)||Q<0||Q>100){M("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(ie)||ie<=0||!Number.isFinite(U)||U<=0){M("Rental prices must be positive numbers.");return}const H={brand:o.trim(),model:l.trim(),year:V,color:m||void 0,licensePlate:y.trim(),batteryCapacity:$,currentBatteryLevel:Q,rentalPricePerHour:ie,rentalPricePerDate:U,currentStationId:s,imageUrl:P||void 0,description:B||void 0};try{await n(H),a(""),d(""),f(""),g(""),C(""),_(""),w(""),k(""),E(""),R(""),A(""),t()}catch(he){M((he==null?void 0:he.message)||"Failed to create vehicle")}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),I&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[r.jsx("input",{value:o,onChange:V=>a(V.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:l,onChange:V=>d(V.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:u,onChange:V=>f(V.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:m,onChange:V=>g(V.target.value),placeholder:"Color",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:y,onChange:V=>C(V.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:N,onChange:V=>_(V.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:b,onChange:V=>w(V.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:x,onChange:V=>k(V.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:S,onChange:V=>E(V.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:P,onChange:V=>R(V.target.value),placeholder:"Image URL",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}}),r.jsx("input",{value:B,onChange:V=>A(V.target.value),placeholder:"Description",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:W,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function LS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState("");if(v.useEffect(()=>{n&&(a(n.battery??""),d(n.tech??""),f(n.issue??""))},[n]),!e||!n)return null;function m(){s(n.id,{battery:o,tech:l,issue:u}),t()}return r.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"vehicle-modal-content",children:[r.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),r.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),r.jsx("label",{children:"Battery Status"}),r.jsx("input",{value:o,onChange:g=>a(g.target.value),placeholder:"e.g. 80"}),r.jsx("label",{children:"Condition"}),r.jsxs("select",{value:l,onChange:g=>d(g.target.value),children:[r.jsx("option",{children:"Open"}),r.jsx("option",{children:"Running"}),r.jsx("option",{children:"Rented"}),r.jsx("option",{children:"Maintained"})]}),r.jsx("label",{children:"Issue"}),r.jsx("textarea",{value:u,onChange:g=>f(g.target.value)}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:m,children:"Submit Update"})})]})})}function PS({open:e,vehicle:t,onClose:n,onEdit:s,onUpdate:o}){const[a,l]=v.useState(!1),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState(""),[C,N]=v.useState(!0),[_,b]=v.useState(!1);if(!e||!t)return null;const w=t.img,x=()=>{u(t.battery??""),m(t.tech??""),y(t.issue??""),N(t.isAvailable!==!1&&t.isAvailable!==0),l(!0)},k=async()=>{if(o){b(!0);try{await o(t.id,{battery:d,tech:f,issue:g,isAvailable:C}),l(!1)}catch(E){alert((E==null?void 0:E.message)||"Failed to update vehicle")}finally{b(!1)}}},S=()=>{l(!1),u(""),m(""),y(""),N(!0)};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsx("img",{src:w,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),r.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[r.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[r.jsx("h3",{style:{marginTop:4},children:t.name}),r.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Detail:"}),r.jsx("div",{children:t.detail||"N/A"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Battery:"}),a?r.jsx("input",{type:"number",min:"0",max:"100",value:d,onChange:E=>u(E.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):r.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Condition:"}),a?r.jsx("input",{type:"text",value:f,onChange:E=>m(E.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):r.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Active Status:"}),a?r.jsxs("label",{style:{marginLeft:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"8px"},children:[r.jsx("input",{type:"checkbox",checked:C,onChange:E=>N(E.target.checked),style:{cursor:"pointer",width:"18px",height:"18px"}}),r.jsx("span",{style:{fontSize:"14px"},children:C?" Available":" Unavailable"})]}):r.jsx("span",{style:{marginLeft:"8px",fontWeight:"600",color:t.isAvailable!==!1&&t.isAvailable!==0?"#10b981":"#ef4444"},children:t.isAvailable!==!1&&t.isAvailable!==0?" Available":" Unavailable"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[r.jsx("strong",{children:"Issue:"}),a?r.jsx("textarea",{value:g,onChange:E=>y(E.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):r.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),r.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:w,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),r.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:a?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:k,disabled:_,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:_?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:_?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",_?"Saving...":"Save Changes"]}),r.jsxs("button",{onClick:S,disabled:_,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:_?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):o&&r.jsxs("button",{onClick:x,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]})})]})})}function ES({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return r.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[r.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function TS({vehicles:e=[],search:t="",setSearch:n=()=>{},onRowClick:s=()=>{},onEdit:o=()=>{},onRemove:a=()=>{},canDelete:l=!0}){const[d,u]=v.useState({});v.useEffect(()=>{let y=!0;async function C(){try{const N=Array.from(new Set((e||[]).map(w=>w.id).filter(Boolean)));if(N.length===0)return;const _=await Promise.all(N.map(async w=>{try{const x=await tt.getCarById(w),k=(x==null?void 0:x.imageUrl)||(x==null?void 0:x.ImageUrl)||(x==null?void 0:x.thumbnailUrl)||(x==null?void 0:x.image)||null,S=(x==null?void 0:x.licensePlate)||(x==null?void 0:x.LicensePlate)||null;return[String(w),{image:k,licensePlate:S}]}catch{return[String(w),{image:null,licensePlate:null}]}}));if(!y)return;const b={};for(const[w,x]of _)b[w]=x;u(b)}catch{}}return C(),()=>{y=!1}},[e]);const f=(e||[]).filter(y=>{if(!t)return!0;const C=(t||"").toLowerCase();return(y.name||"").toLowerCase().includes(C)||(y.brand||"").toLowerCase().includes(C)||(y.model||"").toLowerCase().includes(C)||(y.licensePlate||"").toLowerCase().includes(C)}),m=y=>y==null||y===""?"-":Number.isFinite(y)?`${y}%`:String(y),g=y=>y==null||y===""?"-":String(y);return r.jsx("div",{className:"vehicle-table-model",children:r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"vehicle-table",style:{width:"100%",borderCollapse:"collapse",minWidth:800},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",background:"#fafafa"},children:[r.jsx("th",{style:{padding:"12px 10px"},children:"Vehicle"}),r.jsx("th",{style:{padding:"12px 10px",width:160},children:"Plate"}),r.jsx("th",{style:{padding:"12px 10px",width:120},children:"Battery"}),r.jsx("th",{style:{padding:"12px 10px",width:120},children:"Capacity"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Status"}),r.jsx("th",{style:{padding:"12px 10px",width:160},children:"Actions"})]})}),r.jsxs("tbody",{children:[f.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,style:{padding:24,color:"#666"},children:"No vehicles found"})}),f.map(y=>r.jsxs("tr",{className:"vehicle-row",style:{borderBottom:"1px solid #eee"},children:[r.jsxs("td",{style:{padding:"12px 10px",display:"flex",gap:12,alignItems:"center"},onClick:()=>s(y),children:[r.jsx("img",{src:d[String(y.id)]&&d[String(y.id)].image||y.img||"https://via.placeholder.com/100x60?text=Car",alt:"car",onError:C=>{C.currentTarget.onerror=null,C.currentTarget.src="https://via.placeholder.com/100x60?text=Car"},style:{width:100,height:60,objectFit:"cover",borderRadius:6,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",background:"#fff"}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600},children:y.name||y.title||"Vehicle"}),r.jsx("div",{style:{fontSize:13,color:"#666"},children:y.brand?`${y.brand}${y.model?"  "+y.model:""}`:y.model||""})]})]}),r.jsx("td",{style:{padding:"12px 10px"},children:d[String(y.id)]&&d[String(y.id)].licensePlate||y.licensePlate||"-"}),r.jsx("td",{style:{padding:"12px 10px"},children:m(y.battery)}),r.jsx("td",{style:{padding:"12px 10px"},children:g(y.capacity)}),r.jsx("td",{style:{padding:"12px 10px"},children:r.jsx("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:999,background:y.tech==="Unavailable"||y.tech==="Removed"?"#fff0f0":"#f0f6ff",color:y.tech==="Unavailable"||y.tech==="Removed"?"#b00020":"#1351b4",fontWeight:600,fontSize:12},children:y.tech||(y.issue?"Issue":"Available")})}),r.jsxs("td",{style:{padding:"12px 10px"},children:[r.jsx("button",{onClick:C=>{C.stopPropagation(),s(y)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:"pointer",marginRight:8},children:"Details"}),l&&r.jsx("button",{onClick:C=>{C.stopPropagation(),window.confirm("Delete this vehicle?")&&a(y.id||y)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #f0c0c0",background:"#fff",cursor:"pointer",color:"#b00020"},children:"Delete"})]})]},y.id||y.licensePlate||Math.random()))]})]})})})}function BS({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:o,canDelete:a=!0,stationSlots:l=null}){const[d,u]=v.useState(null),[f,m]=v.useState(!1),[g,y]=v.useState(!1),[C,N]=v.useState(!1),[_,b]=v.useState(""),w=e.filter(S=>{if(!_)return!0;const E=_.toLowerCase(),P=(S.name||"").toLowerCase(),R=(S.model||"").toLowerCase(),B=(S.brand||"").toLowerCase(),A=(S.licensePlate||"").toLowerCase();return P.includes(E)||R.includes(E)||B.includes(E)||A.includes(E)});function x(S){u(S),N(!0)}function k(S){u(S),m(!0)}return r.jsxs("div",{id:"vehicle",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:_,onChange:S=>b(S.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),o&&l&&r.jsx(ES,{stationSlots:l})]}),r.jsx("div",{children:r.jsx(TS,{vehicles:w,search:_,setSearch:b,onRowClick:S=>k(S),onEdit:S=>{const E=typeof S=="object"?S:w.find(P=>String(P.id)===String(S));E&&(u(E),N(!0))},onRemove:S=>{const E=typeof S=="object"?S.id||S.carId:S;E&&n(E)},canDelete:a})}),r.jsx(IS,{open:g,onClose:()=>y(!1),onSubmit:t,stationId:o}),r.jsx(LS,{open:C,onClose:()=>N(!1),vehicle:d,onSubmit:s}),r.jsx(PS,{open:f,vehicle:d,onClose:()=>m(!1),onEdit:d?()=>x(d):null,onUpdate:s})]})}function RS({open:e,onClose:t,inline:n=!1}){const[s,o]=v.useState(!1),[a,l]=v.useState({}),[d,u]=v.useState({}),[f,m]=v.useState("");if(v.useEffect(()=>{if(!e)return;let E=!0;async function P(){var R,B,A;try{o(!0),m("");let I={},M={};try{I=await vt.getMyProfile()}catch(W){((R=W==null?void 0:W.response)==null?void 0:R.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{M=await vt.getMe()}catch(W){((B=W==null?void 0:W.response)==null?void 0:B.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!E)return;l(I||{}),u(M||{});try{let W=(I==null?void 0:I.id)||(I==null?void 0:I.userId)||(M==null?void 0:M.userId)||(M==null?void 0:M.id);if(!W){const $=typeof localStorage<"u"?localStorage.getItem("token"):null;if($){const Q=Pr($);W=Q["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||Q.nameidentifier||Q.sub||Q.userId||Q.UserId||Q.id||Q.Id}}if(!(M!=null&&M.role)&&!(I!=null&&I.role))try{const $=typeof localStorage<"u"?localStorage.getItem("token"):null;if($){const Q=Pr($),ie=(Q==null?void 0:Q.role)||(Q==null?void 0:Q.Role)||Q["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];ie&&(M={...M,role:ie})}}catch{}const V=!(I!=null&&I.userName)&&!(M!=null&&M.userName)||!(I!=null&&I.address)||!(I!=null&&I.stationName);if(W&&V)try{const $=await vt.getUserById(W);if(!E)return;const Q={...I};Q.userName||(Q.userName=($==null?void 0:$.userName)||($==null?void 0:$.UserName)||($==null?void 0:$.username)||""),Q.address||(Q.address=($==null?void 0:$.address)||($==null?void 0:$.Address)||""),Q.stationName||(Q.stationName=($==null?void 0:$.stationName)||((A=$==null?void 0:$.station)==null?void 0:A.name)||($==null?void 0:$.StationName)||""),l(Q)}catch{}}catch{}if((!I||Object.keys(I).length===0)&&(!M||Object.keys(M).length===0)){const W=typeof localStorage<"u"&&!!localStorage.getItem("token");m(W?"You may not have permission to view this profile.":"You are not logged in. Please log in with a staff account.")}}catch(I){if(!E)return;m((I==null?void 0:I.message)||"Failed to load profile")}finally{E&&o(!1)}}return P(),()=>{E=!1}},[e]),!e)return null;let g=a.userName||a.username||d.userName||d.username||"";if(!g)try{const E=typeof localStorage<"u"?localStorage.getItem("token"):null;if(E){const P=Pr(E);g=(P==null?void 0:P.preferred_username)||(P==null?void 0:P.unique_name)||(P==null?void 0:P.userName)||(P==null?void 0:P.username)||(P==null?void 0:P.name)||""}}catch{}const y=a.firstName?`${a.firstName} ${a.lastName||""}`.trim():a.fullName||d.fullName||d.name||"",C=a.email||d.email||"",N=a.phoneNumber||d.phoneNumber||"",_=a.address||d.address||"",b=a.createdAt||d.createdAt||"",w=a.employeeId||a.id||d.userId||d.id||"",x=a.stationName||a.station||"",k=a.role||d.role||(Array.isArray(d.roles)?d.roles.join(", "):d.roles||""),S=a.avatarUrl||d.avatarUrl||"https://via.placeholder.com/180x180?text=Staff";return n?r.jsxs("div",{className:"staff-profile-page",children:[r.jsx("div",{className:"staff-cover",children:r.jsx("div",{className:"staff-cover-gradient"})}),r.jsx("div",{className:"staff-header",children:r.jsxs("div",{className:"staff-header-inner",children:[r.jsx("div",{className:"staff-avatar",children:r.jsx("img",{src:S,alt:"Avatar"})}),r.jsxs("div",{className:"staff-title",children:[r.jsx("h1",{children:y}),r.jsxs("div",{className:"staff-meta",children:[r.jsx("span",{className:"staff-role",children:k||""}),r.jsx("span",{className:"staff-sep",children:""}),r.jsx("span",{className:"staff-station",children:x})]})]})]})}),r.jsxs("div",{className:"staff-content",children:[r.jsx("div",{className:"staff-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"About"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Full Name"}),r.jsx("span",{className:"value",children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Role"}),r.jsx("span",{className:"value",children:k||""})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Station"}),r.jsx("span",{className:"value",children:x})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Employee ID"}),r.jsx("span",{className:"value",children:w})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Joined"}),r.jsx("span",{className:"value",children:String(b).toString().slice(0,10)||""})]})]})]})}),r.jsx("div",{className:"staff-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"Contact"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Email"}),r.jsx("span",{className:"value",children:C})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Phone"}),r.jsx("span",{className:"value",children:N})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Address"}),r.jsx("span",{className:"value",children:_})]})]})]})})]}),f&&r.jsx("div",{className:"staff-error",children:f})]}):r.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"profile-modal-content",children:[r.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),r.jsx("h2",{children:"Staff Profile"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsx("img",{src:S,alt:"Staff",style:{borderRadius:"50%"}}),s?r.jsx("div",{style:{padding:16},children:"Loading profile"}):r.jsxs("div",{className:"profile-info-grid",children:[r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Name"}),r.jsx("div",{children:y})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Email"}),r.jsx("div",{children:C})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Role"}),r.jsx("div",{children:k||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Phone"}),r.jsx("div",{children:N})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Address"}),r.jsx("div",{children:_})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Joined"}),r.jsx("div",{children:String(b).toString().slice(0,10)||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Employee ID"}),r.jsx("div",{children:w})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Station"}),r.jsx("div",{children:x})]})]})]})})}function AS(){return r.jsx("div",{id:"profile",className:"section",style:{padding:24},children:r.jsx(RS,{open:!0,inline:!0,onClose:()=>{}})})}function Py({incident:e,onClick:t}){var a;const n=l=>{const d={Pending:{background:"#fef3c7",color:"#92400e",icon:"fa-clock"},InProgress:{background:"#dbeafe",color:"#1e40af",icon:"fa-spinner"},Resolved:{background:"#d1fae5",color:"#065f46",icon:"fa-check-circle"}},u=d[l]||d.Pending;return r.jsxs("span",{style:{...u,padding:"4px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px"},children:[r.jsx("i",{className:`fas ${u.icon}`}),l]})},s=l=>l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",o=l=>l==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(l);return r.jsxs("div",{className:"incident-card",onClick:()=>t(e),children:[r.jsxs("div",{className:"incident-card-header",children:[r.jsxs("div",{className:"incident-card-title",children:[r.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b",marginRight:"8px"}}),r.jsxs("span",{children:["Incident #",(a=e.id)==null?void 0:a.slice(0,8)]})]}),n(e.status)]}),r.jsxs("div",{className:"incident-card-body",children:[r.jsx("div",{className:"incident-description",children:e.description}),r.jsxs("div",{className:"incident-metadata",children:[r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsx("span",{children:s(e.reportedAt)})]}),e.bookingId&&r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-ticket-alt"}),r.jsxs("span",{children:["Booking: ",e.bookingId.slice(0,8),"..."]})]}),e.costIncurred!=null&&r.jsxs("div",{className:"incident-meta-item",style:{color:"#dc2626",fontWeight:"600"},children:[r.jsx("i",{className:"fas fa-dollar-sign"}),r.jsx("span",{children:o(e.costIncurred)})]}),e.images&&e.images.length>0&&r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-image"}),r.jsxs("span",{children:[e.images.length," image",e.images.length>1?"s":""]})]})]})]}),r.jsx("div",{className:"incident-card-footer",children:r.jsxs("span",{className:"incident-view-details",children:["View Details ",r.jsx("i",{className:"fas fa-arrow-right"})]})})]})}function MS({open:e,onClose:t,onSubmit:n,bookings:s=[]}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState([]),[m,g]=v.useState([]),[y,C]=v.useState(""),[N,_]=v.useState(!1);if(!e)return null;const b=(s||[]).filter(S=>{const E=String((S==null?void 0:S.status)||"").toLowerCase(),P=String((S==null?void 0:S.statusLabel)||"").toLowerCase(),R=Number(S==null?void 0:S.bookingStatus),B=["checked-in","checkedin","checked_in","checked in","checked"].includes(E),A=Number.isFinite(R)&&R===3,I=P.includes("checked-in")||P.includes("checked in")||P.includes("checked")&&!P.includes("wait")&&!P.includes("waiting")&&!P.includes("pending");return B||A||I}),w=S=>{const E=Array.from(S.target.files||[]),P=new Set(u.map(I=>`${I.name}_${I.size}`)),R=E.filter(I=>{if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(I.type))return C(`Invalid file type: ${I.name}. Only JPG, PNG, GIF allowed.`),!1;if(I.size>26214400)return C(`File too large: ${I.name}. Max 25MB per file.`),!1;const V=`${I.name}_${I.size}`;return P.has(V)?!1:(P.add(V),!0)});if(R.length===0)return;const B=[...u,...R];f(B);const A=R.map(I=>URL.createObjectURL(I));g(I=>[...I,...A])},x=S=>{const E=u.filter((R,B)=>B!==S),P=m.filter((R,B)=>B!==S);try{URL.revokeObjectURL(m[S])}catch{}f(E),g(P)},k=async()=>{if(C(""),!o){C("Please select a booking");return}if(!l.trim()){C("Please provide incident description");return}_(!0);try{const S=new FormData;S.append("bookingId",o),S.append("description",l.trim()),u.forEach(E=>{S.append("images",E)}),await n(S),a(""),d(""),f([]),m.forEach(E=>URL.revokeObjectURL(E)),g([]),t()}catch(S){C((S==null?void 0:S.message)||"Failed to create incident")}finally{_(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"650px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsxs("h3",{style:{marginTop:0,marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b"}}),"Report Incident"]}),y&&r.jsxs("div",{style:{background:"#fee2e2",color:"#b91c1c",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:[r.jsx("i",{className:"fas fa-exclamation-circle"})," ",y]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Select Booking ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),b.length===0?r.jsx("div",{style:{padding:"10px",border:"1px solid #f3f4f6",borderRadius:8,color:"#6b7280"},children:'No bookings in "Checked-in" state available.'}):r.jsxs("select",{value:o,onChange:S=>a(S.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"-- Select Booking --"}),b.map(S=>r.jsxs("option",{value:S.id,children:["Booking #",String(S.id).slice(0,8)," - ",S.title||S.vehicleName||"Vehicle"," (",S.statusLabel||S.status,")"]},S.id))]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Incident Description ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),r.jsx("textarea",{value:l,onChange:S=>d(S.target.value),placeholder:"Describe the incident in detail...",rows:5,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",resize:"vertical",fontFamily:"inherit"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:"Upload Images (Optional)"}),r.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.gif",multiple:!0,onChange:w,disabled:b.length===0,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",cursor:b.length===0?"not-allowed":"pointer",opacity:b.length===0?.6:1}}),r.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:"Max 25MB per file. Formats: JPG, PNG, GIF"})]}),m.length>0&&r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:["Preview (",m.length," image",m.length>1?"s":"",")"]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px"},children:m.map((S,E)=>r.jsxs("div",{style:{position:"relative"},children:[r.jsx("img",{src:S,alt:`Preview ${E+1}`,style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e5e7eb"}}),r.jsx("button",{onClick:()=>x(E),style:{position:"absolute",top:"4px",right:"4px",background:"#dc2626",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("i",{className:"fas fa-times"})})]},E))})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},children:[r.jsx("button",{onClick:t,disabled:N,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:N?"not-allowed":"pointer",opacity:N?.6:1},children:"Cancel"}),r.jsx("button",{onClick:k,disabled:N||b.length===0,style:{padding:"10px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:N?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:N?.6:1},children:N?r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fas fa-spinner fa-spin"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fas fa-plus"}),"Create Incident"]})})]})]})})}function Ey({open:e,incident:t,onClose:n,onUpdate:s,onResolve:o,onDelete:a,canDelete:l=!1,footerExtras:d=null}){var B;const[u,f]=v.useState(!1),[m,g]=v.useState(""),[y,C]=v.useState(""),[N,_]=v.useState(""),[b,w]=v.useState(!1);if(!e||!t)return null;const x=A=>A?new Date(A).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",k=A=>A==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(A),S=()=>{g(t.status||"Pending"),C(t.resolutionNotes||""),_(t.costIncurred||""),f(!0)},E=async()=>{w(!0);try{const A=new FormData;m&&A.append("status",m),y&&A.append("resolutionNotes",y),N&&A.append("costIncurred",N),await s(t.id,A),f(!1)}catch(A){alert((A==null?void 0:A.message)||"Failed to update incident")}finally{w(!1)}},P=async()=>{if(window.confirm("Mark this incident as resolved?")){w(!0);try{await o(t.id,y,N||0),n()}catch(A){alert((A==null?void 0:A.message)||"Failed to resolve incident")}finally{w(!1)}}},R=async()=>{if(window.confirm("Are you sure you want to delete this incident? This action cannot be undone.")){w(!0);try{await a(t.id),n()}catch(A){alert((A==null?void 0:A.message)||"Failed to delete incident")}finally{w(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",background:"#fef9e7",border:"2px solid #d4af37",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsxs("div",{style:{textAlign:"center",borderBottom:"3px double #d4af37",paddingBottom:"20px",marginBottom:"24px"},children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontFamily:"Georgia, serif",color:"#1f2937",fontSize:"28px",fontWeight:"bold"},children:"INCIDENT REPORT"}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",fontFamily:"Georgia, serif"},children:"Official Documentation"}),t.status?r.jsx("div",{style:{display:"inline-block",marginTop:"12px",padding:"6px 16px",background:t.status==="Resolved"?"#d1fae5":t.status==="InProgress"?"#dbeafe":"#fef3c7",color:t.status==="Resolved"?"#065f46":t.status==="InProgress"?"#1e40af":"#92400e",borderRadius:"20px",fontSize:"13px",fontWeight:"600",border:`2px solid ${t.status==="Resolved"?"#10b981":t.status==="InProgress"?"#3b82f6":"#f59e0b"}`},children:(B=t.status)==null?void 0:B.toUpperCase()}):null]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"24px",fontFamily:"Georgia, serif"},children:[r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Report ID:"}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.id})]}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Reported Date:"}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px"},children:x(t.reportedAt)})]}),r.jsxs("div",{children:[r.jsxs("strong",{style:{color:"#4b5563",fontSize:"14px"},children:[t.creatorStation?"Creator Station":"Booking Reference",":"]}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.creatorStation?t.creatorStation:t.bookingId?`${String(t.bookingId).slice(0,16)}...`:""})]}),t.stationId&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Station ID:"}),r.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[t.stationId.slice(0,16),"..."]})]})]}),r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Incident Description:"}),r.jsx("p",{style:{color:"#1f2937",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.description})]}),t.images&&t.images.length>0&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:["Evidence Photos (",t.images.length,"):"]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:t.images.map((A,I)=>r.jsx("a",{href:A,target:"_blank",rel:"noopener noreferrer",style:{display:"block"},children:r.jsx("img",{src:A,alt:`Evidence ${I+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",border:"2px solid #d4af37",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:M=>M.currentTarget.style.transform="scale(1.05)",onMouseOut:M=>M.currentTarget.style.transform="scale(1)"})},I))})]}),u?r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"2px solid #3b82f6"},children:[r.jsx("strong",{style:{fontSize:"16px",display:"block",marginBottom:"12px"},children:"Update Incident:"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Status:"}),r.jsxs("select",{value:m,onChange:A=>g(A.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"},children:[r.jsx("option",{value:"Pending",children:"Pending"}),r.jsx("option",{value:"InProgress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"})]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Resolution Notes:"}),r.jsx("textarea",{value:y,onChange:A=>C(A.target.value),rows:4,placeholder:"Enter resolution details...",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Cost Incurred (VND):"}),r.jsx("input",{type:"number",value:N,onChange:A=>_(A.target.value),placeholder:"0",min:"0",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"}})]})]}):r.jsxs(r.Fragment,{children:[t.resolutionNotes&&r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#d1fae5",borderRadius:"8px",border:"1px solid #10b981"},children:[r.jsx("strong",{style:{color:"#065f46",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Resolution Notes:"}),r.jsx("p",{style:{color:"#047857",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.resolutionNotes})]}),t.costIncurred!=null&&r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#fee2e2",borderRadius:"8px",border:"1px solid #dc2626"},children:[r.jsx("strong",{style:{color:"#991b1b",fontSize:"16px",display:"block",marginBottom:"8px",fontFamily:"Georgia, serif"},children:"Cost Incurred:"}),r.jsx("div",{style:{color:"#dc2626",fontSize:"24px",fontWeight:"bold",fontFamily:"Georgia, serif"},children:k(t.costIncurred)})]})]}),r.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"20px",borderTop:"2px solid #e5e7eb",flexWrap:"wrap"},children:d||(u?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>f(!1),disabled:b,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:b?"not-allowed":"pointer",opacity:b?.6:1},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]}),r.jsxs("button",{onClick:E,disabled:b,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:b?"not-allowed":"pointer",opacity:b?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",b?"Saving...":"Save Changes"]})]}):r.jsxs(r.Fragment,{children:[l&&r.jsxs("button",{onClick:R,disabled:b,style:{padding:"10px 20px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:b?"not-allowed":"pointer",marginRight:"auto"},children:[r.jsx("i",{className:"fas fa-trash"})," Delete"]}),t.status!=="Resolved"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:S,disabled:b,style:{padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit"]}),r.jsxs("button",{onClick:P,disabled:b,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:b?"not-allowed":"pointer"},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",b?"Resolving...":"Mark Resolved"]})]}),r.jsx("button",{onClick:n,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Close"})]}))})]})})}function FS({incidents:e=[],bookings:t=[],onCreateIncident:n,onUpdateIncident:s,onResolveIncident:o,onDeleteIncident:a,onRefresh:l,canDelete:d=!0,stationFilter:u=null}){const[f,m]=v.useState(!1),[g,y]=v.useState(!1),[C,N]=v.useState(null),[_,b]=v.useState(""),[w,x]=v.useState(""),k=e.filter(A=>{if(_&&A.status!==_)return!1;if(w){const I=w.toLowerCase(),M=(A.description||"").toLowerCase(),W=(A.id||"").toLowerCase(),V=(A.bookingId||"").toLowerCase();if(!M.includes(I)&&!W.includes(I)&&!V.includes(I))return!1}return!0}),S=A=>{N(A),y(!0)},E=async A=>{await n(A)},P=async(A,I)=>{await s(A,I),l&&await l(),y(!1)},R=async(A,I,M)=>{await o(A,I,M),l&&await l()},B=async A=>{await a(A),l&&await l()};return r.jsxs("div",{id:"incident",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsxs("button",{className:"incident-add-btn",onClick:()=>m(!0),children:[r.jsx("i",{className:"fas fa-plus"})," Report Incident"]}),r.jsxs("div",{className:"incident-filters",style:{flex:1,display:"flex",gap:"12px"},children:[r.jsxs("select",{className:"incident-filter-select",value:_,onChange:A=>b(A.target.value),children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"Pending",children:"Pending"}),r.jsx("option",{value:"InProgress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"})]}),r.jsx("input",{className:"incident-search-input",type:"text",placeholder:"Search by description, ID, or booking...",value:w,onChange:A=>x(A.target.value)})]})]}),r.jsx("div",{style:{padding:"8px 8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},children:k.length===0?"No incidents found":`Showing ${k.length} incident${k.length>1?"s":""}`}),k.length>0?r.jsx("div",{className:"incident-grid",children:k.map(A=>r.jsx(Py,{incident:A,onClick:S},A.id))}):r.jsxs("div",{className:"incident-empty-state",children:[r.jsx("i",{className:"fas fa-clipboard-check"}),r.jsx("h3",{children:"No Incidents"}),r.jsx("p",{children:w||_?"No incidents match your filters":"No incidents have been reported yet"})]}),r.jsx(MS,{open:f,onClose:()=>m(!1),onSubmit:E,bookings:t}),r.jsx(Ey,{open:g,incident:C,onClose:()=>y(!1),onUpdate:P,onResolve:R,onDelete:B,canDelete:d})]})}const US=[],OS=[];function DS(){var ze,me,nt,gn;const[e,t]=v.useState("booking"),[n,s]=v.useState(US),[o,a]=v.useState(OS),[l,d]=v.useState(()=>{try{const fe=localStorage.getItem("staff_sidebar_visible");return fe==null?!0:fe==="1"}catch{return!0}}),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,C]=v.useState([]),[N,_]=v.useState([]),[b,w]=v.useState(!1),[x,k]=v.useState(""),[S,E]=v.useState(!1),[P,R]=v.useState(!1),[B,A]=v.useState(!1),[I,M]=v.useState(""),[W,V]=v.useState(""),[$,Q]=v.useState(""),[ie,U]=v.useState(null),H=async fe=>{try{await De.confirmBooking(fe.id,"Cash",""),s(ae=>ae.map(le=>le.id===fe.id?{...le,status:"booked"}:le))}catch(ae){M((ae==null?void 0:ae.message)||"Failed to proceed to payment")}},he=async(fe,ae="")=>{var le;try{await De.cancelBooking(fe.id,ae||""),s(ye=>ye.map(ue=>ue.id===fe.id?{...ue,status:"denied"}:ue))}catch(ye){const ue=(le=ye==null?void 0:ye.response)==null?void 0:le.status;if(ue===401||ue===403){alert("You don't have permission to cancel this booking.");return}M((ye==null?void 0:ye.message)||"Failed to cancel booking")}},ne=async(fe,ae)=>{let le=ae;try{if(le==null)try{const ue=await De.getBookingById(fe),Ne=(ue==null?void 0:ue.statusCode)??(ue==null?void 0:ue.StatusCode)??(ue==null?void 0:ue.bookingStatus)??(ue==null?void 0:ue.BookingStatus)??(ue==null?void 0:ue.status)??(ue==null?void 0:ue.Status);if(Ne!=null&&(typeof Ne=="number"||/^\d+$/.test(String(Ne)))){const Qe=Number(Ne);Qe===0?le="pending":Qe===1?le="booked":Qe===2?le="waiting-checkin":Qe===3?le="checked-in":Qe===4?le="checkout-pending":Qe===5?le="completed":Qe===6?le="cancelled-pending":Qe===7&&(le="cancelled")}else{const Qe=String(Ne||"").toLowerCase();Qe.includes("pending")||Qe.includes("wait")?le="pending":Qe.includes("check")&&Qe.includes("in")?le="checked-in":Qe.includes("complete")||Qe.includes("finish")?le="completed":Qe.includes("cancel")?le="cancelled":le="booked"}}catch(ue){console.warn(" Failed to refresh booking status for",fe,(ue==null?void 0:ue.message)||ue)}}catch(ue){console.warn(" Error resolving status for booking update:",(ue==null?void 0:ue.message)||ue)}const ye=le==="pending"?"Pending":le==="booked"?"Active Rental":le==="waiting-checkin"?"Waiting Check-in":le==="checked-in"?"Checked-in":le==="checkout-pending"?"Check-out Pending":le==="completed"?"Completed":le==="cancelled-pending"?"Cancelled (Pending Refund)":le==="cancelled"?"Cancelled":le;le!==void 0&&s(ue=>ue.map(Ne=>Ne.id===fe?{...Ne,status:le,statusLabel:ye}:Ne))},xe=async fe=>{var ae;try{const le=fe.get("bookingId")||"",ye=fe.get("description")||"";let ue=[];try{ue=fe.getAll?fe.getAll("images"):[]}catch{ue=[]}const Ne=await De.createIncident(le,ye,ue);try{alert("Incident gi thnh cng. Cm n bn.")}catch{}return Ne}catch(le){throw console.error(" create incident failed",((ae=le==null?void 0:le.response)==null?void 0:ae.data)||(le==null?void 0:le.message)||le),le}},ve=async fe=>{if(!fe){_([]);return}w(!0);try{const ae=await De.getAllIncidents(fe,null,null,null,1,200),ye=((ae==null?void 0:ae.incidents)||[]||[]).map(ue=>({id:ue.id||ue.Id||ue.incidentId||ue.IncidentId||ue._id&&String(ue._id),description:ue.description||ue.Description||ue.details||"",bookingId:ue.bookingId||ue.BookingId||ue.booking||null,images:ue.images||ue.Images||[],status:ue.status||ue.Status||"Pending",reportedAt:ue.reportedAt||ue.ReportedAt||ue.createdAt||ue.CreatedAt||ue.date||null,costIncurred:ue.costIncurred??ue.CostIncurred??ue.cost??null,stationId:ue.stationId||ue.StationId||null,raw:ue}));_(ye)}catch(ae){console.error(" failed to load incidents for station",ae),_([])}finally{w(!1)}},oe=async(fe,ae)=>{try{await De.updateIncident(fe,ae),await ve(x)}catch(le){throw console.error(" update incident failed",le),le}},D=async(fe,ae,le)=>{try{await De.resolveIncident(fe,ae,Number(le)||0),await ve(x)}catch(ye){throw console.error(" resolve incident failed",ye),ye}},ee=async fe=>{try{await De.deleteIncident(fe),await ve(x)}catch(ae){throw console.error(" delete incident failed",ae),ae}},G=async fe=>{try{if(!x){M("Please select a station before creating a vehicle.");return}const ae={...fe};ae.currentStationId=x,ae.stationId=x,ae.StationId=x,ae.rentalPricePerDate!=null&&ae.rentalPricePerDay==null&&(ae.rentalPricePerDay=ae.rentalPricePerDate),ae.rentalPricePerDay!=null&&ae.rentalPricePerDate==null&&(ae.rentalPricePerDate=ae.rentalPricePerDay),ae.batteryCapacity!=null&&ae.BatteryCapacity==null&&(ae.BatteryCapacity=ae.batteryCapacity),ae.currentBatteryLevel!=null&&ae.CurrentBatteryLevel==null&&(ae.CurrentBatteryLevel=ae.currentBatteryLevel);const le=await De.createCar(ae),ye=le||{},ue=Ne=>({id:Ne.id||Ne.Id||Ne.carId||Ne.CarId,name:Ne.name||Ne.Name||[Ne.brand,Ne.model].filter(Boolean).join(" ")||"Car",model:Ne.model||Ne.Model||null,brand:Ne.brand||Ne.Brand||null,licensePlate:Ne.licensePlate||Ne.LicensePlate||null,img:Ne.imageUrl||Ne.image||Ne.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Ne.name||Ne.Name||Ne.model||"Car")}`,battery:Number.isFinite(Ne.currentBatteryLevel)?Math.round(Ne.currentBatteryLevel):void 0,tech:Ne.condition??Ne.status??Ne.Status??null,issue:Ne.issue??Ne.issueDescription??null,capacity:Ne.batteryCapacity??Ne.BatteryCapacity??Ne.capacity??Ne.capacityKWh??Ne.batteryCapacityKWh??null});return a(Ne=>[...Ne,ue(ye)]),await Ce(x),le}catch(ae){throw M((ae==null?void 0:ae.message)||"Failed to create vehicle"),ae}},_e=async fe=>{var ae;try{await De.deleteCar(fe),a(le=>le.filter(ye=>ye.id!==fe)),await Ce(x)}catch(le){const ye=(ae=le==null?void 0:le.response)==null?void 0:ae.status;if(ye===401||ye===403){V("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const ue=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Ne=!1;for(const Qe of ue)try{await De.updateStatus(fe,Qe),Ne=!0;break}catch{}if(Ne){a(Qe=>Qe.filter(Jn=>Jn.id!==fe));return}}catch{}M((le==null?void 0:le.message)||"Failed to delete vehicle")}},Ie=async(fe,ae)=>{try{if(ae.battery!==void 0&&ae.battery!==""){let le=Number(ae.battery);Number.isNaN(le)||(le=Math.max(0,Math.min(100,Math.round(le))),await De.updateBatteryLevel(fe,le))}if(ae.tech&&await De.updateStatus(fe,ae.tech),ae.issue)try{await De.updateCarDescription(fe,ae.issue)}catch{await De.updateCar(fe,{description:ae.issue})}}catch(le){M((le==null?void 0:le.message)||"Failed to update vehicle")}a(le=>le.map(ye=>ye.id===fe?{...ye,...ae}:ye))},Ce=async fe=>{if(!fe){U(null);return}try{const ae=await De.getCarStatusReport(fe,null);ae&&U({totalCars:ae.totalCars||0,availableCars:ae.availableCars||0})}catch(ae){console.warn("Failed to load station slots:",ae)}};v.useEffect(()=>{l?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[l]),v.useEffect(()=>{try{localStorage.setItem("staff_sidebar_visible",l?"1":"0")}catch{}},[l]);const we=[{key:"booking",label:"Booking",icon:"fas fa-calendar-alt",onClick:()=>t("booking")},{key:"vehicle",label:"Vehicle",icon:"fas fa-car",onClick:()=>t("vehicle")},{key:"incident",label:"Incident",icon:"fas fa-exclamation-triangle",onClick:()=>t("incident")},{key:"profile",label:"Profile",icon:"fas fa-user-circle",onClick:()=>t("profile")}];return v.useEffect(()=>{let fe=!0;async function ae(){try{const ye=await authApi.getMe(),ue=(ye==null?void 0:ye.role)||(ye==null?void 0:ye.Role)||(ye==null?void 0:ye.roleName)||(ye==null?void 0:ye.userRole)||(Array.isArray(ye==null?void 0:ye.roles)?ye.roles[0]:"");fe&&Q(ue||"")}catch{try{const ye=localStorage.getItem("token");if(ye){const ue=decodeJwt(ye),Ne=(ue==null?void 0:ue.role)||(ue==null?void 0:ue.Role)||ue["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];fe&&Q(Ne||"")}}catch{}}}async function le(){try{R(!0);const ye=localStorage.getItem("stationId");if(ye){console.log(" Staff assigned station from localStorage:",ye),fe&&k(ye);try{const Ne=await De.getAllStations(1,100);fe&&C(Ne||[])}catch(Ne){console.warn(" Failed to load stations for display:",Ne)}return}console.warn(" No stationId found in localStorage for staff user");const ue=await De.getAllStations(1,100);if(!fe)return;C(ue||[])}catch(ye){if(!fe)return;M((ye==null?void 0:ye.message)||"Failed to load stations")}finally{fe&&R(!1)}}return ae(),le(),()=>{fe=!1}},[]),v.useEffect(()=>{let fe=!0;async function ae(){try{E(!0);let ye=[];if(x){let be=[],z=[];try{be=await De.getCarsByStation(x)}catch{}try{z=await De.getAvailableCarsByStation(x)}catch{}const Ye=Be=>Array.isArray(Be)?Be:Be?[Be]:[],He=Ye(be),Pe=Ye(z),X=new Map;for(const Be of[...He,...Pe]){const rt=String((Be==null?void 0:Be.id)||(Be==null?void 0:Be.Id)||(Be==null?void 0:Be.carId)||(Be==null?void 0:Be.CarId)||(Be==null?void 0:Be.licensePlate)||(Be==null?void 0:Be.LicensePlate)||Math.random());X.has(rt)||X.set(rt,Be)}ye=Array.from(X.values());try{const Be=await De.getAllCars(1,1e3),rt=Ae=>Ae==null?"":String(Ae).replace(/[{}]/g,"").toLowerCase(),Ot=rt(x),Cn=(Be||[]).filter(Ae=>{var pr,Ur,Pt,et;return[Ae.currentStationId,Ae.CurrentStationId,Ae.currentStationID,Ae.stationId,Ae.StationId,Ae.stationID,(pr=Ae.station)==null?void 0:pr.id,(Ur=Ae.station)==null?void 0:Ur.Id,(Pt=Ae.station)==null?void 0:Pt.stationId,(et=Ae.station)==null?void 0:et.StationId].some(mr=>mr!=null&&rt(mr)===Ot)});for(const Ae of Cn){const Bt=String((Ae==null?void 0:Ae.id)||(Ae==null?void 0:Ae.Id)||(Ae==null?void 0:Ae.carId)||(Ae==null?void 0:Ae.CarId)||(Ae==null?void 0:Ae.licensePlate)||(Ae==null?void 0:Ae.LicensePlate));Bt&&!X.has(Bt)&&X.set(Bt,Ae)}ye=Array.from(X.values())}catch{}}else try{ye=await De.getAllCars(1,1e3)}catch{try{ye=await De.listCars({page:1,pageSize:1e3})}catch{ye=[]}}if(Array.isArray(ye)||(ye=ye?[ye]:[]),!fe)return;const ue=be=>{const z=Number(be);return Number.isFinite(z)&&z>=0&&z<=100?Math.round(z):null},Ne=(ye||[]).map(be=>{var Be,rt,Ot,Cn;const Ye=((...Ae)=>Ae.find(Bt=>Bt!=null&&Bt!==""))(be.currentStationId,be.CurrentStationId,be.currentStationID,be.stationId,be.StationId,be.stationID,(Be=be.station)==null?void 0:Be.id,(rt=be.station)==null?void 0:rt.Id,(Ot=be.station)==null?void 0:Ot.stationId,(Cn=be.station)==null?void 0:Cn.StationId),He=Ae=>Ae==null?"":String(Ae).replace(/[{}]/g,"").toLowerCase(),Pe=Ye||"",X=(()=>{if(!Pe)return null;const Ae=y.find(Bt=>He(Bt.id||Bt.Id)===He(Pe))||null;return Ae&&(Ae.name||Ae.Name)||null})();return{id:be.id||be.Id||be.carId||be.CarId,name:be.name||be.Name||be.model||be.CarName||"Car",model:be.model||be.Model||null,brand:be.brand||be.Brand||null,licensePlate:be.licensePlate||be.LicensePlate||null,img:be.imageUrl||be.image||be.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(be.name||be.Name||"Car")}`,battery:ue(be.currentBatteryLevel??be.CurrentBatteryLevel??be.batteryPercent??be.battery),tech:be.condition??be.status??be.Status??null,issue:be.issue??be.issueDescription??null,capacity:be.batteryCapacity??be.BatteryCapacity??be.capacity??be.capacityKWh??be.batteryCapacityKWh??null,stationId:Pe,stationName:X||null}});a(Ne);const Qe=Ne.filter(be=>be.battery==null),Jn=Ne.filter(be=>be.capacity==null);if(Qe.length>0)try{const be=await Promise.all(Qe.map(async z=>{try{const Ye=await De.getCarBattery(z.id);return{id:z.id,battery:ue(Ye)}}catch{return{id:z.id,battery:null}}}));if(!fe)return;a(z=>z.map(Ye=>{const He=be.find(Pe=>Pe.id===Ye.id);return He&&He.battery!=null?{...Ye,battery:He.battery}:Ye}))}catch{}if(Jn.length>0)try{const be=await Promise.all(Jn.map(async z=>{try{const Ye=await De.getCarCapacity(z.id);return{id:z.id,capacity:Ye}}catch{return{id:z.id,capacity:null}}}));if(!fe)return;a(z=>z.map(Ye=>{const He=be.find(Pe=>Pe.id===Ye.id);return He&&He.capacity!=null?{...Ye,capacity:He.capacity}:Ye}))}catch{}}catch(ye){if(!fe)return;M((ye==null?void 0:ye.message)||"Failed to load vehicles")}finally{fe&&E(!1)}}async function le(){fe&&await Ce(x)}return ae(),le(),()=>{fe=!1}},[x,y]),v.useEffect(()=>{let fe=!0;async function ae(){try{A(!0);let le=[];if(x){console.log(" Loading active bookings for station:",x);try{le=await De.getBookingsByStation(x,1,200),console.log(" Loaded active bookings:",le==null?void 0:le.length)}catch(z){console.error(" Error loading bookings:",z),le=[]}}else console.warn(" No station ID set"),le=[];if(!fe)return;const ye=(le||[]).map(z=>{var Me,je,it,pt,Z,Re,$e,ge,F,qe,lt,Le,yt,Ht,Qt,Zt,Qn,Xt,kt,bt,Fn,gi,qi,gr,yi,xi,vi,_i,wi,yr,Un,Or,Dr,On,Ze,st,Xn,Nn,kn,xr,Ue,ct,vr,er,Rt,ji,tr;const Ye=z.id||z.Id||z.bookingId||z.BookingId,He=((Me=z.car)==null?void 0:Me.brand)||((je=z.car)==null?void 0:je.Brand)||((it=z.vehicle)==null?void 0:it.brand)||((pt=z.vehicle)==null?void 0:pt.Brand)||z.carBrand||z.CarBrand||null,Pe=((Z=z.car)==null?void 0:Z.model)||((Re=z.car)==null?void 0:Re.Model)||(($e=z.vehicle)==null?void 0:$e.model)||((ge=z.vehicle)==null?void 0:ge.Model)||z.carModel||z.CarModel||null;let X=z.carName||z.vehicleName||((F=z.car)==null?void 0:F.name)||((qe=z.car)==null?void 0:qe.Name)||null;!X&&(He||Pe)&&(X=[He,Pe].filter(Boolean).join(" ").trim()||null),!X&&typeof z.carInfo=="string"&&z.carInfo.trim()&&(X=z.carInfo.trim()),!X&&typeof z.CarInfo=="string"&&z.CarInfo.trim()&&(X=z.CarInfo.trim()),X=X||"Booking";const Be=((lt=z.user)==null?void 0:lt.firstName)||((Le=z.customer)==null?void 0:Le.firstName)||z.firstName||z.FirstName||((yt=z.user)==null?void 0:yt.FirstName)||((Ht=z.customer)==null?void 0:Ht.FirstName),rt=((Qt=z.user)==null?void 0:Qt.lastName)||((Zt=z.customer)==null?void 0:Zt.lastName)||z.lastName||z.LastName||((Qn=z.user)==null?void 0:Qn.LastName)||((Xt=z.customer)==null?void 0:Xt.LastName),Ot=[Be,rt].filter(Boolean).join(" "),Cn=Ot||z.customerName||z.userFullName||((kt=z.user)==null?void 0:kt.fullName)||((bt=z.customer)==null?void 0:bt.name)||((Fn=z.user)==null?void 0:Fn.name)||"Customer",Ae=z.userId||z.UserId||((gi=z.user)==null?void 0:gi.id)||((qi=z.user)==null?void 0:qi.Id)||z.customerId||z.CustomerId||z.appUserId||z.AppUserId||z.accountId||z.AccountId||z.UserID||z.ownerId||z.OwnerId||z.createdById||z.CreatedById||"",Bt=((gr=z.user)==null?void 0:gr.userName)||((yi=z.user)==null?void 0:yi.UserName)||((xi=z.user)==null?void 0:xi.username)||z.userName||z.UserName||z.username||null,pr=((vi=z.user)==null?void 0:vi.email)||z.customerEmail||z.email||z.userEmail||"",Ur=((_i=z.user)==null?void 0:_i.address)||z.customerAddress||z.address||"",Pt=z.statusCode??z.StatusCode??z.bookingStatus??z.BookingStatus??z.status??z.Status;let et="booked";if(Pt!=null&&(typeof Pt=="number"||/^\d+$/.test(String(Pt)))){const Ke=Number(Pt);Ke===0?et="pending":Ke===1?et="booked":Ke===2?et="waiting-checkin":Ke===3?et="checked-in":Ke===4?et="checkout-pending":Ke===5?et="completed":Ke===6?et="cancelled-pending":Ke===7&&(et="cancelled")}else{const Ke=String(Pt||"").toLowerCase();Ke.includes("pending")||Ke.includes("wait")?et="pending":Ke.includes("check")&&Ke.includes("in")?et="checked-in":Ke.includes("complete")||Ke.includes("finish")?et="completed":Ke.includes("cancel")?et="cancelled":et="booked"}const mr=et==="pending"?"Pending":et==="booked"?"Active Rental":et==="waiting-checkin"?"Waiting Check-in":et==="checked-in"?"Checked-in":et==="checkout-pending"?"Check-out Pending":et==="completed"?"Completed":et==="cancelled-pending"?"Cancelled (Pending Refund)":et==="cancelled"?"Cancelled":String(Pt||"")||"Booked",Mn=String(Pt||"").toLowerCase(),Vi=Number(Pt)===0||Mn.includes("pending")||Mn.includes("wait")?"waiting-payment":Mn.includes("check")&&Mn.includes("in")&&(Mn.includes("pay")||Mn.includes("payment"))?"checkin-payment":null;let Y=z.date||z.createdAt||z.bookingDate||"";if(Y)try{const Ke=new Date(Y);isNaN(Ke.getTime())||(Y=Ke.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:void 0}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5"))}catch{}const re=z.carImageUrl||((wi=z.car)==null?void 0:wi.imageUrl)||((yr=z.vehicle)==null?void 0:yr.imageUrl)||`https://via.placeholder.com/440x280?text=${encodeURIComponent(X)}`,se=Ke=>{if(!Ke)return null;try{const dt=new Date(Ke);if(!isNaN(dt.getTime()))return dt.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5")}catch{}return Ke},ce=se(z.PickupDateTime||z.pickupDate||z.rentalStartDate||z.startDateTime||z.startDate||z.StartTime||z.startTime||z.Start||z.start),Ee=se(z.ExpectedReturnDateTime||z.returnDate||z.rentalEndDate||z.endDateTime||z.endDate||z.EndTime||z.endTime||z.End||z.end||z.ActualReturnDateTime||z.actualReturnDateTime);return{id:Ye,title:X,firstName:Be||null,lastName:rt||null,fullName:Ot||z.userFullName||((Un=z.user)==null?void 0:Un.fullName)||((Or=z.customer)==null?void 0:Or.name)||((Dr=z.user)==null?void 0:Dr.name)||null,customer:Cn,userId:Ae,userName:Bt,email:pr,address:Ur,status:et,statusLabel:mr,uiStage:Vi,date:Y,pickupDate:ce,returnDate:Ee,img:re,carId:z.carId||z.CarId||((On=z.car)==null?void 0:On.id)||((Ze=z.car)==null?void 0:Ze.Id)||((st=z.vehicle)==null?void 0:st.id)||((Xn=z.vehicle)==null?void 0:Xn.Id)||null,cccdFrontUrl:z.cccdFrontUrl||z.identityFrontUrl||z.idFrontUrl||z.frontImageUrl||z.frontIdUrl||z.cccdFrontImageUrl||((Nn=z.customer)==null?void 0:Nn.cccdFrontUrl)||((kn=z.user)==null?void 0:kn.cccdFrontUrl),cccdBackUrl:z.cccdBackUrl||z.identityBackUrl||z.idBackUrl||z.backImageUrl||z.backIdUrl||z.cccdBackImageUrl||((xr=z.customer)==null?void 0:xr.cccdBackUrl)||((Ue=z.user)==null?void 0:Ue.cccdBackUrl),gplxFrontUrl:z.gplxFrontUrl||z.driverLicenseFrontUrl||z.gplxImageUrl_Front||((ct=z.customer)==null?void 0:ct.gplxImageUrl_Front)||((vr=z.user)==null?void 0:vr.gplxImageUrl_Front),gplxBackUrl:z.gplxBackUrl||z.driverLicenseBackUrl||z.gplxImageUrl_Back||((er=z.customer)==null?void 0:er.gplxImageUrl_Back)||((Rt=z.user)==null?void 0:Rt.gplxImageUrl_Back),idString:z.customerIdNumber||((ji=z.user)==null?void 0:ji.identityNumber)||"",phone:z.customerPhone||((tr=z.user)==null?void 0:tr.phoneNumber)||""}});s(ye);const ue=ye.filter(z=>z.userId&&!(z.firstName&&z.lastName));if(ue.length>0)try{const z=Array.from(new Set(ue.map(Pe=>Pe.userId))),Ye=await Promise.all(z.map(async Pe=>{try{const X=await De.getUserById(Pe),Be=(X==null?void 0:X.firstName)||(X==null?void 0:X.FirstName)||(X==null?void 0:X.givenName)||(X==null?void 0:X.GivenName)||null,rt=(X==null?void 0:X.lastName)||(X==null?void 0:X.LastName)||(X==null?void 0:X.surname)||(X==null?void 0:X.Surname)||null,Ot=(X==null?void 0:X.fullName)||(X==null?void 0:X.FullName)||[Be,rt].filter(Boolean).join(" ")||null,Cn=(X==null?void 0:X.userName)||(X==null?void 0:X.UserName)||(X==null?void 0:X.username)||(X==null?void 0:X.user_name)||null,Ae=(X==null?void 0:X.address)||(X==null?void 0:X.Address)||"";return{uid:Pe,firstName:Be,lastName:rt,fullName:Ot,userName:Cn,address:Ae}}catch{return{uid:Pe,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!fe)return;const He=new Map(Ye.map(Pe=>[Pe.uid,Pe]));s(Pe=>Pe.map(X=>{if(X.userId&&He.has(X.userId)){const Be=He.get(X.userId),rt=X.fullName||Be.fullName||[Be.firstName,Be.lastName].filter(Boolean).join(" ");return{...X,firstName:X.firstName??Be.firstName??null,lastName:X.lastName??Be.lastName??null,fullName:rt||X.customer||X.userName||null,userName:X.userName??Be.userName,address:X.address||Be.address}}return X}))}catch{}const Ne=z=>{var Ye,He,Pe,X;return z.carId||z.CarId||z.vehicleId||z.VehicleId||((Ye=z.car)==null?void 0:Ye.id)||((He=z.car)==null?void 0:He.Id)||((Pe=z.vehicle)==null?void 0:Pe.id)||((X=z.vehicle)==null?void 0:X.Id)},Qe=ye.filter(z=>(!z.title||z.title==="Booking")&&Ne(z));if(Qe.length>0)try{const z=Array.from(new Set(Qe.map(Ne).filter(Boolean))),Ye=await Promise.all(z.map(async Pe=>{try{let X=await De.getCarById(Pe);if(!X||!X.id&&!X.Id)try{X=await De.getCarByIdRest(Pe)}catch{}const Be=(X==null?void 0:X.name)||(X==null?void 0:X.Name)||[X==null?void 0:X.brand,X==null?void 0:X.model].filter(Boolean).join(" ")||null,rt=(X==null?void 0:X.imageUrl)||(X==null?void 0:X.thumbnailUrl)||null;return{cid:Pe,name:Be,img:rt}}catch{return{cid:Pe,name:null,img:null}}})),He=new Map(Ye.map(Pe=>[String(Pe.cid),Pe]));s(Pe=>Pe.map(X=>{const Be=Ne(X),rt=Be!=null?String(Be):null;if(rt&&He.has(rt)){const Ot=He.get(rt);return{...X,title:X.title&&X.title!=="Booking"?X.title:Ot.name||X.title,img:X.img||Ot.img||X.img}}return X}))}catch{}const be=(z=>z.filter(Ye=>!Ye.title||Ye.title==="Booking"))(ye);if(be.length>0)try{const z=await Promise.all(be.map(async He=>{try{const Pe=await De.getVehicleModelFromBooking(He.id),X=(Pe==null?void 0:Pe.name)||[Pe==null?void 0:Pe.brand,Pe==null?void 0:Pe.model].filter(Boolean).join(" ")||null;return{id:He.id,title:X}}catch{return{id:He.id,title:null}}})),Ye=new Map(z.map(He=>[He.id,He.title]));s(He=>He.map(Pe=>Ye.has(Pe.id)&&Ye.get(Pe.id)?{...Pe,title:Ye.get(Pe.id)}:Pe))}catch{}}catch(le){if(!fe)return;M((le==null?void 0:le.message)||"Failed to load bookings")}finally{fe&&A(!1)}}return ae(),()=>{fe=!1}},[x]),v.useEffect(()=>{ve(x)},[x]),r.jsxs("div",{className:"app-layout",children:[r.jsx(xS,{toggleSidebar:()=>d(fe=>!fe),sidebarVisible:l}),r.jsx("div",{className:`sidebar-wrapper ${l?"visible":""}`,children:r.jsx(ky,{title:"FEC Staff",menuItems:we,isOpen:l,toggleSidebar:()=>d(fe=>!fe),onSelect:t,activeKey:e})}),r.jsxs("main",{className:`main-content ${l?"shifted":""}`,children:[W&&r.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:W}),I&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),e==="booking"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((ze=y.find(fe=>(fe.id||fe.Id)===x))==null?void 0:ze.name)||((me=y.find(fe=>(fe.id||fe.Id)===x))==null?void 0:me.Name)||x}),B&&r.jsx("span",{children:"Loading bookings"})]}),!B&&n.length===0&&r.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),r.jsx(bS,{bookings:n,search:u,setSearch:f,statusFilter:m,setStatusFilter:g,onContinuePayment:H,onCancelBooking:he,onStatusUpdated:ne})]}),e==="vehicle"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((nt=y.find(fe=>(fe.id||fe.Id)===x))==null?void 0:nt.name)||((gn=y.find(fe=>(fe.id||fe.Id)===x))==null?void 0:gn.Name)||x}),S&&r.jsx("span",{children:"Loading vehicles"})]}),r.jsx(BS,{vehicles:o,onAdd:G,onRemove:_e,onUpdate:Ie,stationId:x,canDelete:String($).toLowerCase()==="admin",stationSlots:ie})]}),e==="incident"&&r.jsx(FS,{incidents:N,bookings:n,onCreateIncident:xe,onUpdateIncident:oe,onResolveIncident:D,onDeleteIncident:ee,onRefresh:async()=>{await ve(x)},canDelete:!0,stationFilter:x}),e==="profile"&&r.jsx(AS,{})]})]})}const zS="modulepreload",$S=function(e){return"/"+e},xp={},WS=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=$S(u),u in xp)return;xp[u]=!0;const f=u.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":zS,f||(g.as="script"),g.crossOrigin="",g.href=u,d&&g.setAttribute("nonce",d),document.head.appendChild(g),f)return new Promise((y,C)=>{g.addEventListener("load",y),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return o.then(l=>{for(const d of l||[])d.status==="rejected"&&a(d.reason);return t().catch(a)})};function HS({toggleSidebar:e,sidebarVisible:t}){return r.jsxs("header",{className:"header-bar",children:[r.jsx("div",{className:"header-left",children:r.jsx("button",{className:"sidebar-toggle","aria-label":t?"Close sidebar":"Open sidebar",onClick:e,children:r.jsx("i",{className:t?"fas fa-times":"fas fa-bars"})})}),r.jsx("div",{className:"header-title",children:"Admin Page"}),r.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}const Ec={createStation:async e=>{if(!e)throw new Error("station is required");try{const t=await te.post("/Stations/Create",e,{headers:{"Content-Type":"application/json"}}),n=t==null?void 0:t.data;if(n&&typeof n=="object"&&"data"in n){if(n.isSuccess===!1){const s=n.message||(Array.isArray(n.errors)?n.errors.join("; "):"Request failed"),o=new Error(s);throw o.body=n,o}return n.data}return n}catch(t){throw t}},updateStation:async(e,t)=>{if(!e)throw new Error("stationId is required");if(!t)throw new Error("station payload is required");const s=`/Stations/Update-By-${encodeURIComponent(e)}`;try{const o=await te.put(s,t,{headers:{"Content-Type":"application/json"}}),a=o==null?void 0:o.data;if(a&&typeof a=="object"&&"data"in a){if(a.isSuccess===!1){const l=a.message||(Array.isArray(a.errors)?a.errors.join("; "):"Request failed"),d=new Error(l);throw d.body=a,d}return a.data}return a}catch(o){throw o}},deleteStation:async e=>{if(!e)throw new Error("stationId is required");const n=`/Stations/Delete-By-${encodeURIComponent(e)}`;try{const s=await te.delete(n),o=s==null?void 0:s.data;if(o&&typeof o=="object"&&"data"in o){if(o.isSuccess===!1){const a=o.message||(Array.isArray(o.errors)?o.errors.join("; "):"Request failed"),l=new Error(a);throw l.body=o,l}return o.data}return o}catch(s){throw s}}},Tc={getFeedbacks:async(e={page:1,pageSize:10,search:"",sortBy:""})=>{var n;const t={pageNumber:e.page??e.pageNumber??1,pageSize:e.pageSize??10};e.search&&(t.search=e.search),e.sortBy&&(t.sortBy=e.sortBy);try{const s=await te.get("/Feedback/Get-All",{params:t}),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(n=s==null?void 0:s.response)==null?void 0:n.status;if(o&&o!==404&&o!==405)throw s;return{items:[],totalCount:0}}}},Te={confirmBooking:nn.confirmBooking,cancelBooking:nn.cancelBooking,completeBooking:nn.completeBooking,getBookingById:nn.getBookingById,listBookings:async(e={})=>{var t;try{const{page:n=1,pageSize:s=100}=e;console.log(` Listing bookings: page=${n}, pageSize=${s}`);const o=await te.get("/Bookings/Get-All",{params:{pageNumber:n,pageSize:s}}),a=o==null?void 0:o.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(t=a==null?void 0:a.data)!=null&&t.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No bookings array found in listBookings response"),[])}catch(n){return console.error(" Error listing bookings:",n.message),[]}},createCar:tt.createCar,deleteCar:tt.deleteCar,updateCar:tt.updateCar,updateStatus:tt.updateStatus,updateBatteryLevel:tt.updateBatteryLevel,updateCarDescription:tt.updateCarDescription,getAllCars:tt.getAllCars,getCarById:tt.getCarById,getAvailableCarsByStation:tt.getAvailableCarsByStation,getCarStatusReport:De.getCarStatusReport,getCarsByStation:De.getCarsByStation,getAllStations:De.getAllStations,getBookingsByStation:De.getBookingsByStation,createStation:Ec.createStation,updateStation:Ec.updateStation,deleteStation:Ec.deleteStation,getFeedbacks:(Tc==null?void 0:Tc.getFeedbacks)||(async e=>{try{const t=await te.get("/Feedback/Get-All",{params:{pageNumber:(e==null?void 0:e.page)??1,pageSize:(e==null?void 0:e.pageSize)??10,search:(e==null?void 0:e.search)||""}}),n=t==null?void 0:t.data;return n&&typeof n=="object"&&"data"in n?n.data:n||{items:[],totalCount:0}}catch(t){return console.warn(" Failed to load feedbacks:",t.message),{items:[],totalCount:0}}}),getAllUsers:async(e=1,t=100,n=null)=>{var a,l;const s={pageNumber:e,pageSize:t};n&&(s.role=n);const o=[{url:"/Users/Get-All",params:s},{url:"/Admin/Users",params:s},{url:"/users",params:s}];for(const d of o)try{const u=await te.get(d.url,{params:d.params}),f=u==null?void 0:u.data;if(Array.isArray(f))return f;if(Array.isArray((a=f==null?void 0:f.data)==null?void 0:a.data))return f.data.data;if(Array.isArray(f==null?void 0:f.data))return f.data;if(Array.isArray(f==null?void 0:f.items))return f.items}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}return[]},assignStaffRole:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Assign-Staff-Role${s}`,`/Users/${n}/Assign-Staff-Role${s}`,`/Admin/Users/Assign-Staff-Role${s}`];for(const l of o)try{const d=await te.post(l,t?{userId:e,reason:t}:{userId:e}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Assign staff role endpoint not found")},removeStaffRole:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Remove-Staff-Role${s}`,`/Users/${n}/Remove-Staff-Role${s}`,`/Admin/Users/Remove-Staff-Role${s}`];for(const l of o)try{const d=await te.post(l,t?{userId:e,reason:t}:{userId:e}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Remove staff role endpoint not found")},getStaffByStation:async e=>{var s;if(!e)return[];const t=encodeURIComponent(e),n=[`/Admin/Staff/By-Station/${t}`,`/Staff/By-Station/${t}`,{url:"/Admin/Staff/By-Station",params:{stationId:e}}];for(const o of n)try{const a=typeof o=="string"?await te.get(o):await te.get(o.url,{params:o.params}),l=a==null?void 0:a.data;if(Array.isArray(l))return l;if(Array.isArray(l==null?void 0:l.data))return l.data;if(Array.isArray(l==null?void 0:l.items))return l.items}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return[]},getStationByStaff:async e=>{var s;if(!e)throw new Error("staffId is required");const t=encodeURIComponent(e),n=[`/Admin/Staff/${t}/Station`,`/Staff/${t}/Station`,`/Admin/Users/${t}/Station`,`/Users/${t}/Station`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},getCustomerProfile:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Customers/${t}/Profile`,`/Admin/Users/${t}/Profile`,`/Users/${t}/Profile`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Customer profile endpoint not found")},getUserDocuments:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Documents`,`/Users/${t}/Documents`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("User documents endpoint not found")},softDeleteUser:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Soft-Delete${s}`,`/Users/${n}/Soft-Delete${s}`];for(const l of o)try{const d=await te.post(l,t?{reason:t}:{}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Soft delete user endpoint not found")},restoreUser:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Restore`,`/Users/${t}/Restore`];for(const o of n)try{const a=await te.post(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Restore user endpoint not found")},getDeletedAccounts:async(e=1,t=20,n=null)=>{var a;(!e||e<1)&&(e=1),(!t||t<1)&&(t=20);const s=new URLSearchParams({page:e.toString(),pageSize:t.toString()});n&&s.append("role",n);const o=[`/Admin/Users/Deleted-Accounts?${s}`,`/Users/Deleted-Accounts?${s}`];for(const l of o)try{const d=await te.get(l),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;return(f==null?void 0:f.deletedAccounts)||f||[]}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Get deleted accounts endpoint not found")},getAdminDashboard:async()=>{var t;const e=["/Admin/Dashboard","/Dashboard"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}throw new Error("Dashboard endpoint not found")},getFleetOverview:async()=>{var t;const e=["/Admin/Fleet/Overview","/Fleet/Overview"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}return null},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Te.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},transferCar:async(e,t,n="")=>{var a;if(!e||!t)throw new Error("carId and targetStationId are required");const s={carId:e,targetStationId:t};n&&(s.reason=n);const o=["/Admin/Fleet/Transfer-Car","/Fleet/Transfer-Car"];for(const l of o)try{const d=await te.post(l,null,{params:s}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Transfer car endpoint not found")},assignStaffToStation:async(e,t)=>{var s;if(!e||!t)throw new Error("stationId and staffId are required");const n=[{url:`/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}},{url:`/Admin/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}}];for(const o of n)try{const a=await te.post(o.url,null,{params:o.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Assign staff to station endpoint not found")},unassignStaffFromStation:async e=>{var n;if(!e)throw new Error("staffId is required");const t=[{url:"/Stations/Unassign-Staff",params:{staffId:e}},{url:"/Admin/Stations/Unassign-Staff",params:{staffId:e}}];for(const s of t)try{const o=await te.post(s.url,null,{params:s.params}),a=o==null?void 0:o.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(o){const a=(n=o==null?void 0:o.response)==null?void 0:n.status;if(a&&a!==404&&a!==405)throw o}throw new Error("Unassign staff from station endpoint not found")},reassignStaff:async(e,t)=>{var s;if(!e||!t)throw new Error("staffId and toStationId are required");const n=[{url:"/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}},{url:"/Admin/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}}];for(const o of n)try{const a=await te.post(o.url,null,{params:o.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Reassign staff endpoint not found")},post:async(e,t,n={})=>{const s=await te.post(e,t,n);return s==null?void 0:s.data},get:async(e,t={})=>{const n=await te.get(e,t);return n==null?void 0:n.data},put:async(e,t,n={})=>{const s=await te.put(e,t,n);return s==null?void 0:s.data},patch:async(e,t,n={})=>{const s=await te.patch(e,t,n);return s==null?void 0:s.data},delete:async(e,t={})=>{const n=await te.delete(e,t);return n==null?void 0:n.data}};async function ZS(e){if(!e)throw new Error("accessToken is required");const t=`${Hi}/Admin/Dashboard`,n=await fetch(t,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${e}`}});if(!n.ok){const s=await n.text();throw new Error(`Request failed: ${n.status} ${s}`)}return n.json()}Te.getAdminDashboardWithToken=ZS;function VS({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:o}){var ve,oe;const[a,l]=v.useState(!1),[d,u]=v.useState(!1),[f,m]=v.useState(!1),[g,y]=v.useState(!1),[C,N]=v.useState(""),[_,b]=v.useState(!1),[w,x]=v.useState(!1),[k,S]=v.useState(null),[E,P]=v.useState(!1),[R,B]=v.useState(null),[A,I]=v.useState(""),[M,W]=v.useState(""),[V,$]=v.useState(""),[Q,ie]=v.useState(null);if(v.useEffect(()=>{if(!e)return;l(!1),u(!1),m(!1),y(!1),N(""),ie(null);const D=e.carId||e.CarId;D&&tt.getCarById(D).then(we=>{const ze=(we==null?void 0:we.imageUrl)||(we==null?void 0:we.ImageUrl)||"/Picture/E car 1.jpg";ie(ze),console.log(" Loaded car image:",ze)}).catch(we=>{console.warn(" Failed to load car image:",we.message),ie("/Picture/E car 1.jpg")});const ee=(we,ze)=>[we,ze].filter(Boolean).join(" "),G=e.fullName||ee(e.firstName,e.lastName);if(!(!G||/^customer$/i.test(G)||G==="")){N(G);return}if(!e.id)return;let Ie=!1;async function Ce(){b(!0);try{const{firstName:we,lastName:ze}=await Te.getUserNameByBookingId(e.id);Ie||N(ee(we,ze))}catch{}finally{Ie||b(!1)}}return Ce(),()=>{Ie=!0}},[e]),!e)return null;const U=(e==null?void 0:e.status)==="booked"?a&&d:!1,H=()=>{if(!e)return;const D=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,D)},he=async()=>{var D,ee,G,_e,Ie;if(e!=null&&e.id){I(""),x(!0);try{const Ce=await Te.createPayment(e.id,"Rental","Rental payment at check-in");try{localStorage.setItem("currentBookingId",e.id)}catch{}const we=(Ce==null?void 0:Ce.checkoutUrl)||((D=Ce==null?void 0:Ce.data)==null?void 0:D.checkoutUrl)||(Ce==null?void 0:Ce.url)||"",ze=(Ce==null?void 0:Ce.qrCode)||((ee=Ce==null?void 0:Ce.data)==null?void 0:ee.qrCode)||"";if(W(we),$(ze),S(Ce),we)try{window.open(we,"_blank","noopener,noreferrer")}catch{}}catch(Ce){const we=(G=Ce==null?void 0:Ce.response)==null?void 0:G.status;if(we&&we!==400&&we!==409){x(!1),I(((Ie=(_e=Ce==null?void 0:Ce.response)==null?void 0:_e.data)==null?void 0:Ie.message)||(Ce==null?void 0:Ce.message)||"Failed to create payment");return}}x(!1)}},ne=async()=>{var D,ee;if(e!=null&&e.id){I(""),x(!0);try{await Te.syncPaymentStatus(e.id),B(new Date);const G=await Te.getBookingById(e.id),_e=(G==null?void 0:G.statusCode)??(G==null?void 0:G.StatusCode)??(G==null?void 0:G.bookingStatus)??(G==null?void 0:G.BookingStatus)??(G==null?void 0:G.status)??(G==null?void 0:G.Status),Ie=_S(_e);if(Ie&&Ie!==e.status){o==null||o(e.id,Ie),t==null||t();return}alert("Synced. Status unchanged; try again shortly if the gateway is still processing.")}catch(G){I(((ee=(D=G==null?void 0:G.response)==null?void 0:D.data)==null?void 0:ee.message)||(G==null?void 0:G.message)||"Retry sync failed")}finally{x(!1)}}},xe=async()=>{var D,ee;if(e!=null&&e.id){P(!0),I("");try{const G=await Te.getPaymentByBooking(e.id);S(G)}catch(G){I(((ee=(D=G==null?void 0:G.response)==null?void 0:D.data)==null?void 0:ee.message)||(G==null?void 0:G.message)||"Unable to load payment info")}finally{P(!1)}}};return r.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:r.jsx("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:r.jsxs(Iy,{booking:e,onClose:t,actions:null,children:[r.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("img",{id:"modalImage",src:Q||"/Picture/E car 1.jpg",alt:"Vehicle",onError:D=>D.currentTarget.src="/Picture/E car 1.jpg",style:{width:"100%",height:160,borderRadius:8,objectFit:"cover",display:"block"}}),r.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),r.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),r.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((ve=e.car)==null?void 0:ve.name)||((oe=e.car)==null?void 0:oe.Name)||""]}),r.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",C||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(_?"Loading":"")]}),r.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",Ly(e.date)]})]}),r.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:e.idString||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Address:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:e.address||""})})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"CCCD Images:"}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),e.cccdFrontUrl?r.jsx("a",{href:e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:a,onChange:D=>l(D.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),e.cccdBackUrl?r.jsx("a",{href:e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:d,onChange:D=>u(D.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Driver License (GPLX) Images:"}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),e.gplxFrontUrl?r.jsx("a",{href:e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:D=>m(D.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),e.gplxBackUrl?r.jsx("a",{href:e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:g,onChange:D=>y(D.target.checked)})," Verified"]})]})]})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{id:"customerPhone",style:{padding:6},children:e.phone||""}),e.phone&&r.jsx("a",{href:`tel:${e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!U,style:{background:U?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),r.jsx("button",{onClick:H,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:he,disabled:w,style:{background:"#43a047",color:"#fff",padding:"8px 16px",borderRadius:14},children:w?"Processing":"Confirm Check In"}),r.jsx("button",{onClick:ne,disabled:w,style:{background:"#1565c0",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Retry Sync"}),r.jsx("button",{onClick:xe,disabled:E,style:{background:"#455a64",color:"#fff",padding:"8px 16px",borderRadius:14},children:E?"Loading":"View Payment Status"})]})]}),A&&r.jsx("div",{style:{marginTop:8,color:"#b00020"},children:A}),R&&r.jsxs("div",{style:{marginTop:4,color:"#555",fontSize:12},children:["Last sync: ",R.toLocaleTimeString()]}),(V||M)&&r.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #e0e0e0",borderRadius:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Complete Payment"}),V?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("img",{alt:"Pay QR",src:V,style:{width:160,height:160,objectFit:"contain",border:"1px solid #eee",borderRadius:6}}),r.jsx("div",{style:{color:"#555"},children:'Scan the QR to pay. After payment completes, use "Retry Sync" to update the booking.'})]}):r.jsx("div",{style:{color:"#555"},children:'Open the checkout to complete your payment, then return and press "Retry Sync".'}),M&&r.jsx("div",{style:{marginTop:10},children:r.jsx("a",{href:M,target:"_blank",rel:"noreferrer",style:{background:"#1565c0",color:"#fff",padding:"8px 14px",borderRadius:10,textDecoration:"none"},children:"Open Checkout"})})]}),k&&r.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #eee",borderRadius:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Payment"}),r.jsxs("div",{children:["Status: ",String(k.status||k.Status||k.paymentStatus||"")]}),r.jsxs("div",{children:["Gateway: ",String(k.gatewayStatus||k.GatewayStatus||k.providerStatus||"")]}),r.jsxs("div",{children:["Amount: ",k.amount??k.Amount??""]}),r.jsxs("div",{children:["Transaction: ",k.transactionId||k.TransactionId||k.txnId||""]}),r.jsxs("div",{children:["Updated: ",k.updatedAt||k.UpdatedAt||k.lastUpdated||""]})]})]})]}),r.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[r.jsx("h4",{children:"Transaction Details"}),r.jsxs("ul",{style:{fontSize:"1rem"},children:[r.jsx("li",{children:"Find rental location on map"}),r.jsx("li",{children:"View available vehicles (type, battery, price)"}),r.jsx("li",{children:"Book in advance or on-site"}),r.jsx("li",{children:"Check-in at counter/app"}),r.jsx("li",{children:"Sign electronic contract"}),r.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),r.jsx("li",{children:"Return vehicle at rental location"}),r.jsx("li",{children:"Staff checks and confirms vehicle condition"}),r.jsx("li",{children:"Pay any additional fees"})]})]})]})})})}function qS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onContinuePayment:a,onCancelBooking:l,onStatusUpdated:d}){const[u,f]=v.useState(null),[m,g]=v.useState(null),y=Array.isArray(e)?e.filter(P=>(String(P.title||"").toLowerCase().includes(String(t).toLowerCase())||String(P.customer||"").toLowerCase().includes(String(t).toLowerCase())||String(P.userName||"").toLowerCase().includes(String(t).toLowerCase())||String(P.email||"").toLowerCase().includes(String(t).toLowerCase()))&&(s===""||P.status===s)):[],[C,N]=v.useState({}),[_,b]=v.useState(""),[w,x]=v.useState("asc"),k=P=>{_===P?x(R=>R==="asc"?"desc":"asc"):(b(P),x(P==="date"?"desc":"asc"))},S=P=>{var R,B,A,I;return P.carId||P.CarId||P.vehicleId||P.VehicleId||((R=P.car)==null?void 0:R.id)||((B=P.car)==null?void 0:B.Id)||((A=P.vehicle)==null?void 0:A.id)||((I=P.vehicle)==null?void 0:I.Id)||null};v.useEffect(()=>{let P=!0;const R=new Set;for(const B of y){const A=S(B);!(B.img||B.carImage||A&&C[A])&&A&&R.add(String(A))}if(R.size!==0)return(async()=>{const B=Array.from(R).slice(0,50).map(async A=>{try{const I=await Te.getCarById(A),M=(I==null?void 0:I.imageUrl)||(I==null?void 0:I.ImageUrl)||null;return{cid:A,imageUrl:M}}catch{return{cid:A,imageUrl:null}}});try{const A=await Promise.all(B);if(!P)return;N(I=>{const M={...I};for(const W of A)W.imageUrl&&(M[W.cid]=W.imageUrl);return M})}catch{}})(),()=>{P=!1}},[y]);const E=(()=>{const P=Array.isArray(y)?[...y]:[];if(!_)return P;if(_==="date"){const R=B=>{const A=B.date||B.createdAt||B.bookingDate||"",I=Date.parse(String(A));return Number.isFinite(I)?I:0};return P.sort((B,A)=>w==="asc"?R(B)-R(A):R(A)-R(B)),P}return P.sort((R,B)=>{const A=_==="vehicle"?String(R.title||"").toLowerCase():String(R.fullName||R.customer||"").toLowerCase(),I=_==="vehicle"?String(B.title||"").toLowerCase():String(B.fullName||B.customer||"").toLowerCase();return A===I?0:w==="asc"?A.localeCompare(I):I.localeCompare(A)}),P})();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Search bookings...",value:t,onChange:P=>n(P.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd",flex:"1 1 320px"}}),r.jsxs("select",{value:s,onChange:P=>o(P.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"",children:"All statuses"}),r.jsx("option",{value:"booked",children:"Booked"}),r.jsx("option",{value:"waiting_payment",children:"Waiting Payment"}),r.jsx("option",{value:"checked-in",children:"Checked In"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),E&&E.length>0?r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:800},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"2px solid #eee"},children:[r.jsx("th",{style:{padding:"8px 12px"},children:"Image"}),r.jsxs("th",{style:{padding:"8px 12px",cursor:"pointer"},onClick:()=>k("vehicle"),children:["Vehicle ",_==="vehicle"?w==="asc"?"":"":""]}),r.jsxs("th",{style:{padding:"8px 12px",cursor:"pointer"},onClick:()=>k("customer"),children:["Customer ",_==="customer"?w==="asc"?"":"":""]}),r.jsx("th",{style:{padding:"8px 12px"},children:"Phone / Email"}),r.jsx("th",{style:{padding:"8px 12px"},children:"Status"}),r.jsxs("th",{style:{padding:"8px 12px",cursor:"pointer"},onClick:()=>k("date"),children:["Date ",_==="date"?w==="asc"?"":"":""]}),r.jsx("th",{style:{padding:"8px 12px",width:220},children:"Actions"})]})}),r.jsx("tbody",{children:E.map(P=>r.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:r.jsx("img",{src:P.img||P.carImage||C[String(S(P))]||qu(P.img)||"/Picture/E car 1.jpg",alt:P.title,onError:R=>Vu(R.currentTarget),style:{width:100,height:56,objectFit:"cover",borderRadius:6}})}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:P.title}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:P.fullName||[P.firstName,P.lastName].filter(Boolean).join(" ")||P.customer||""}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:P.phone||P.email||""}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:(()=>{const R=(P.status||"").toString().toLowerCase(),B=R.includes("pending")?"booking-status-pending":R.includes("waiting")?"booking-status-waiting-checkin":R.includes("check")&&R.includes("in")?"booking-status-checkedin":R.includes("complete")||R.includes("completed")?"booking-status-completed":R.includes("cancel")||R.includes("denied")?"booking-status-cancelled":"booking-status-booked",A=P.statusLabel||(P.status||"").toString();return r.jsx("span",{className:`booking-status-chip table-status-badge ${B}`,children:A})})()}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:P.date||""}),r.jsx("td",{style:{padding:"8px 12px",verticalAlign:"middle"},children:r.jsx("div",{style:{display:"flex",gap:8},children:r.jsx("button",{onClick:()=>f(P),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:"pointer"},children:"Details"})})})]},P.id))})]})}):r.jsx("div",{style:{padding:24,color:"#666"},children:"No bookings found"})]}),r.jsx(VS,{booking:u,onClose:()=>f(null),onProceed:()=>{u&&(g(u),f(null))},onCancel:()=>{u&&(l==null||l(u))},onStatusUpdated:d}),m&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:()=>g(null),children:""}),r.jsx(vS,{booking:m,onClick:()=>f(m)})]})})]})}function GS({vehicle:e,onOpen:t}){return r.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[r.jsx("img",{src:e.img,alt:e.name}),r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-title",children:e.name}),r.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),r.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),r.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),r.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function YS({open:e,onClose:t,onSubmit:n,stationId:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,C]=v.useState(""),[N,_]=v.useState(""),[b,w]=v.useState(""),[x,k]=v.useState(""),[S,E]=v.useState(""),[P,R]=v.useState(""),[B,A]=v.useState(null),[I,M]=v.useState(""),W=5*1024*1024,V=["image/jpeg","image/png","image/webp","image/jpg"];if(!e)return null;async function $(){var ve;if(M(""),!s){M("Please select a station before creating a vehicle.");return}if(!o.trim()||!l.trim()||!m.trim()||!y.trim()||!u||!N||!b||!x||!S||!P){M("Please fill all required fields: Brand, Model, Color, Year, License Plate, Battery Capacity, Current Battery, Seats, Price/hour, Price/day.");return}const Q=Number(u),ie=Number(N),U=Number(b),H=Number(x),he=Number(S),ne=Number(P);if(!Number.isFinite(Q)||Q<1900||Q>2100){M("Year must be between 1900 and 2100.");return}if(!Number.isFinite(ie)||ie<0||ie>1e4){M("Battery Capacity must be a positive number (kWh).");return}if(!Number.isFinite(U)||U<0||U>100){M("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(H)||H<=0||!Number.isFinite(he)||he<=0){M("Rental prices must be positive numbers.");return}if(!Number.isFinite(ne)||ne<=0){M("Seats must be a positive number.");return}if(B){if(!V.includes(B.type)){M(`Invalid file type. Allowed: ${V.join(", ")}`);return}if(B.size>W){M(`File size must be less than ${W/1024/1024}MB. Current: ${(B.size/1024/1024).toFixed(2)}MB`);return}}const xe=new FormData;xe.append("Brand",o.trim()),xe.append("Model",l.trim()),xe.append("Year",Q),xe.append("Color",m.trim()),xe.append("LicensePlate",y.trim()),xe.append("BatteryCapacity",ie),xe.append("CurrentBatteryLevel",U),xe.append("RentalPricePerHour",H),xe.append("RentalPricePerDay",he),xe.append("Seats",ne),xe.append("CurrentStationId",s),B&&(xe.append("CarImage",B,B.name),console.log(" Added CarImage:",B.name,"size:",B.size,"type:",B.type));try{await n(xe),a(""),d(""),f(""),g(""),C(""),_(""),w(""),k(""),E(""),R(""),A(null),t()}catch(oe){console.error("Create vehicle error:",oe);const D=(ve=oe==null?void 0:oe.response)==null?void 0:ve.data;let ee=(oe==null?void 0:oe.message)||"Failed to create vehicle";if(D)if(typeof D=="string")ee=D;else if(D.message)ee=D.message;else if(D.errors)try{const G=Object.keys(D.errors)[0],_e=D.errors[G];ee=Array.isArray(_e)?_e[0]:String(_e)}catch{ee=JSON.stringify(D.errors)}else ee=JSON.stringify(D);M(ee||"Failed to create vehicle")}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),I&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[r.jsx("input",{value:o,onChange:Q=>a(Q.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:l,onChange:Q=>d(Q.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:u,onChange:Q=>f(Q.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:m,onChange:Q=>g(Q.target.value),placeholder:"Color *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:y,onChange:Q=>C(Q.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:N,onChange:Q=>_(Q.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:b,onChange:Q=>w(Q.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:x,onChange:Q=>k(Q.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:S,onChange:Q=>E(Q.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:P,onChange:Q=>R(Q.target.value),placeholder:"Seats *",type:"number",min:1,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{type:"file",accept:"image/*",onChange:Q=>{var U;const ie=((U=Q.target.files)==null?void 0:U[0])||null;if(ie){if(!V.includes(ie.type)){M(`Invalid file type. Allowed: ${V.join(", ")}`),A(null);return}if(ie.size>W){M(`File size must be less than ${W/1024/1024}MB. Current: ${(ie.size/1024/1024).toFixed(2)}MB`),A(null);return}M(""),A(ie)}else A(null)},placeholder:"Car Image",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:$,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function KS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState("");if(v.useEffect(()=>{n&&(a(n.battery??""),d(n.tech??""),f(n.issue??""))},[n]),!e||!n)return null;function m(){s(n.id,{battery:o,tech:l,issue:u}),t()}return r.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"vehicle-modal-content",children:[r.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),r.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),r.jsx("label",{children:"Battery Status"}),r.jsx("input",{value:o,onChange:g=>a(g.target.value),placeholder:"e.g. 80"}),r.jsx("label",{children:"Condition"}),r.jsxs("select",{value:l,onChange:g=>d(g.target.value),children:[r.jsx("option",{children:"Open"}),r.jsx("option",{children:"Running"}),r.jsx("option",{children:"Rented"}),r.jsx("option",{children:"Maintained"})]}),r.jsx("label",{children:"Issue"}),r.jsx("textarea",{value:u,onChange:g=>f(g.target.value)}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:m,children:"Submit Update"})})]})})}function JS({open:e,vehicle:t,onClose:n,onEdit:s,onTransfer:o,onUpdate:a,onDelete:l}){const[d,u]=v.useState(!1),[f,m]=v.useState(""),[g,y]=v.useState(""),[C,N]=v.useState(""),[_,b]=v.useState(!0),[w,x]=v.useState(!1);if(!e||!t)return null;const k=t.img,S=()=>{m(t.battery??""),y(t.tech??""),N(t.issue??""),b(t.isAvailable!==!1&&t.isAvailable!==0),u(!0)},E=async()=>{if(a){x(!0);try{await a(t.id,{battery:f,tech:g,issue:C,isAvailable:_}),u(!1)}catch(R){alert((R==null?void 0:R.message)||"Failed to update vehicle")}finally{x(!1)}}},P=()=>{u(!1),m(""),y(""),N(""),b(!0)};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsx("img",{src:k,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),r.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[r.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[r.jsx("h3",{style:{marginTop:4},children:t.name}),r.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Detail:"}),r.jsx("div",{children:t.detail||"N/A"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Battery:"}),d?r.jsx("input",{type:"number",min:"0",max:"100",value:f,onChange:R=>m(R.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):r.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Condition:"}),d?r.jsx("input",{type:"text",value:g,onChange:R=>y(R.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):r.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Active Status:"}),d?r.jsxs("label",{style:{marginLeft:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"8px"},children:[r.jsx("input",{type:"checkbox",checked:_,onChange:R=>b(R.target.checked),style:{cursor:"pointer",width:"18px",height:"18px"}}),r.jsx("span",{style:{fontSize:"14px"},children:_?" Available":" Unavailable"})]}):r.jsx("span",{style:{marginLeft:"8px",fontWeight:"600",color:t.isAvailable!==!1&&t.isAvailable!==0?"#10b981":"#ef4444"},children:t.isAvailable!==!1&&t.isAvailable!==0?" Available":" Unavailable"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[r.jsx("strong",{children:"Issue:"}),d?r.jsx("textarea",{value:C,onChange:R=>N(R.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):r.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),r.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:k,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),r.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:d?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:E,disabled:w,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:w?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:w?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",w?"Saving...":"Save Changes"]}),r.jsxs("button",{onClick:P,disabled:w,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:w?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):r.jsxs(r.Fragment,{children:[a&&r.jsxs("button",{onClick:S,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]}),o&&r.jsxs("button",{onClick:()=>{n(),o()},style:{padding:"10px 24px",background:"#8b5cf6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-exchange-alt"})," Transfer Station"]}),l&&r.jsxs("button",{onClick:async()=>{if(confirm("Delete this vehicle?"))try{await l(t.id||t.Id||t.carId),n&&n()}catch(R){alert((R==null?void 0:R.message)||"Delete failed")}},style:{padding:"10px 24px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-trash"})," Delete Vehicle"]})]})})]})})}function QS({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalSlots)??0,n=(e==null?void 0:e.carsCount)??0;return r.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[r.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function XS({open:e,onClose:t,vehicle:n,stations:s,currentStationId:o,onSubmit:a}){const[l,d]=v.useState(""),[u,f]=v.useState("Fleet rebalancing"),[m,g]=v.useState(!1);if(!e||!n)return null;const y=s.filter(N=>{const _=N.id||N.Id;return _&&_!==o}),C=async N=>{if(N.preventDefault(),!l){alert("Please select a station");return}g(!0);try{await a(n,l,u),d(""),f("Fleet rebalancing"),t()}catch(_){console.error("Transfer failed:",_)}finally{g(!1)}};return r.jsx("div",{className:"modal-backdrop",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{className:"modal-content",onClick:N=>N.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 10px 40px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[r.jsxs("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:[r.jsx("i",{className:"fas fa-exchange-alt",style:{marginRight:"8px",color:"#0ea5e9"}}),"Transfer Vehicle"]}),r.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",padding:"0",width:"32px",height:"32px"},children:""})]}),r.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"20px"},children:[r.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:n.name}),r.jsxs("div",{style:{fontSize:"14px",color:"#6b7280"},children:["Current Station: ",n.stationName||"Unknown"]})]}),r.jsxs("form",{onSubmit:C,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsxs("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:["Transfer to Station ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsxs("select",{value:l,onChange:N=>d(N.target.value),required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[r.jsx("option",{value:"",children:"-- Select Station --"}),y.map(N=>{const _=N.id||N.Id,b=N.name||N.Name||`Station ${_}`;return r.jsx("option",{value:_,children:b},_)})]})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:"Reason (optional)"}),r.jsx("textarea",{value:u,onChange:N=>f(N.target.value),placeholder:"Enter reason for transfer...",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[r.jsx("button",{type:"button",onClick:t,disabled:m,style:{flex:1,padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",fontSize:"14px",fontWeight:"500",cursor:m?"not-allowed":"pointer",opacity:m?.6:1},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:m||!l,style:{flex:1,padding:"10px",border:"none",borderRadius:"6px",background:l&&!m?"#0ea5e9":"#9ca3af",color:"white",fontSize:"14px",fontWeight:"500",cursor:l&&!m?"pointer":"not-allowed"},children:m?"Transferring...":"Transfer Vehicle"})]})]})]})})}function e1({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:o,canDelete:a=!0,stationSlots:l=null,onTransferCar:d,stations:u}){const[f,m]=v.useState(null),[g,y]=v.useState(!1),[C,N]=v.useState(!1),[_,b]=v.useState(!1),[w,x]=v.useState(!1),[k,S]=v.useState(null),[E,P]=v.useState(""),R=e.filter(W=>{if(!E)return!0;const V=E.toLowerCase(),$=(W.name||"").toLowerCase(),Q=(W.model||"").toLowerCase(),ie=(W.brand||"").toLowerCase(),U=(W.licensePlate||"").toLowerCase();return $.includes(V)||Q.includes(V)||ie.includes(V)||U.includes(V)});function B(W){m(W),b(!0)}function A(W){m(W),y(!0)}function I(W){S(W),x(!0)}const M=async(W,V,$)=>{d&&await d(W,V,$)};return r.jsxs("div",{id:"vehicle",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>N(!0),children:[r.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),r.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:E,onChange:W=>P(W.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),o&&l&&r.jsx(QS,{stationSlots:l})]}),r.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!R||R.length===0)&&r.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:E?"No vehicles match your search.":"No vehicles available to display."}),R.map((W,V)=>r.jsx("div",{children:r.jsx(GS,{vehicle:W,onOpen:()=>A(W)})},W.id||W.licensePlate||`${W.name}-${W.stationId||""}-${V}`))]}),r.jsx(YS,{open:C,onClose:()=>N(!1),onSubmit:t,stationId:o}),r.jsx(KS,{open:_,onClose:()=>b(!1),vehicle:f,onSubmit:s}),r.jsx(JS,{open:g,vehicle:f,onClose:()=>y(!1),onEdit:f?()=>B(f):null,onTransfer:d&&f?()=>I(f):null,onUpdate:s,onDelete:n}),r.jsx(XS,{open:w,onClose:()=>{x(!1),S(null)},vehicle:k,stations:u||[],currentStationId:o,onSubmit:M})]})}function t1({user:e,onClick:t}){const n=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",s=e.email||e.Email||"",o=e.role||e.Role||e.userRole||"Customer",a=e.phoneNumber||e.PhoneNumber||e.phone||"";return r.jsxs("div",{className:"user-card",onClick:t,children:[r.jsx("div",{className:"user-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsxs("div",{className:"user-info",children:[r.jsx("div",{className:"user-name",children:n}),r.jsx("div",{className:"user-email",children:s}),r.jsx("div",{className:"user-role",children:o}),a!==""&&r.jsx("div",{className:"user-phone",children:a})]})]})}function n1({userId:e,userName:t,onClose:n}){const[s,o]=v.useState([]),[a,l]=v.useState(!0),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState("newest");v.useEffect(()=>{C()},[e]);const C=async()=>{var w,x;try{l(!0),u(""),console.log(" Fetching bookings for user:",e);const k=await nn.getUserBookings(e);console.log(" Bookings loaded:",k),o(k||[])}catch(k){console.error(" Error loading bookings:",k),u(((x=(w=k==null?void 0:k.response)==null?void 0:w.data)==null?void 0:x.message)||"Failed to load booking history")}finally{l(!1)}},N=w=>{const x={0:{text:"Pending",class:"status-pending",color:"#ff9800"},1:{text:"Active",class:"status-active",color:"#2196f3"},2:{text:"Waiting for check-in",class:"status-waiting",color:"#ff5722"},3:{text:"Checked-in",class:"status-checked-in",color:"#4caf50"},4:{text:"Check-out pending",class:"status-checkout-pending",color:"#9c27b0"},5:{text:"Completed",class:"status-completed",color:"#4caf50"},6:{text:"Cancelled pending refund",class:"status-cancelled-refund",color:"#f44336"},7:{text:"Cancelled",class:"status-cancelled",color:"#9e9e9e"}},k=Number(w);return x[k]||x[0]},_=w=>{if(!w)return"N/A";try{const x=new Date(w);return isNaN(x.getTime())?w:x.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return w}};let b=[...s];return f&&(b=b.filter(w=>String(w.bookingStatus)===f)),b.sort((w,x)=>{switch(g){case"oldest":return new Date(w.createdAt)-new Date(x.createdAt);case"price-high":return(x.totalAmount||0)-(w.totalAmount||0);case"price-low":return(w.totalAmount||0)-(x.totalAmount||0);default:return new Date(x.createdAt)-new Date(w.createdAt)}}),r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:n,children:r.jsxs("div",{style:{background:"white",borderRadius:"12px",width:"100%",maxWidth:"900px",maxHeight:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:w=>w.stopPropagation(),children:[r.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,marginBottom:"4px"},children:"Booking History"}),r.jsxs("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:["for ",t]})]}),r.jsx("button",{onClick:n,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#999",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),r.jsxs("div",{style:{padding:"15px 20px",borderBottom:"1px solid #eee",display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("label",{style:{fontWeight:500},children:"Status:"}),r.jsxs("select",{value:f,onChange:w=>m(w.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"0",children:"Pending"}),r.jsx("option",{value:"1",children:"Active"}),r.jsx("option",{value:"2",children:"Waiting for check-in"}),r.jsx("option",{value:"3",children:"Checked-in"}),r.jsx("option",{value:"4",children:"Check-out pending"}),r.jsx("option",{value:"5",children:"Completed"}),r.jsx("option",{value:"6",children:"Cancelled pending refund"}),r.jsx("option",{value:"7",children:"Cancelled"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("label",{style:{fontWeight:500},children:"Sort by:"}),r.jsxs("select",{value:g,onChange:w=>y(w.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[r.jsx("option",{value:"newest",children:"Newest"}),r.jsx("option",{value:"oldest",children:"Oldest"}),r.jsx("option",{value:"price-high",children:"Price (High to Low)"}),r.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),r.jsx("button",{onClick:C,style:{padding:"8px 16px",background:"#1976d2",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:" Refresh"})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[a&&r.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[r.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"10px"}}),"Loading bookings..."]}),d&&r.jsxs("div",{style:{background:"#ffebee",color:"#c62828",padding:"15px",borderRadius:"8px",marginBottom:"15px",border:"1px solid #ef5350"},children:[r.jsx("strong",{children:"Error:"})," ",d]}),!a&&b.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[r.jsx("i",{className:"fas fa-inbox",style:{fontSize:"36px",marginBottom:"15px",display:"block"}}),r.jsx("p",{children:"No bookings found"})]}),!a&&b.length>0&&r.jsx("div",{style:{display:"grid",gap:"15px"},children:b.map((w,x)=>{const k=N(w.bookingStatus),S=_(w.startTime||w.pickupDateTime),E=_(w.endTime||w.expectedReturnDateTime),P=w.carInfo||"Car Rental",R=w.pickupStationName||"N/A",B=w.id||w.bookingId||"N/A";return r.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"15px",background:"#fafafa",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:"15px",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Car"}),r.jsx("div",{style:{fontWeight:500},children:P}),r.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:["Booking ID: ",B]})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Pick-up"}),r.jsx("div",{style:{fontSize:"13px"},children:R}),r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:S})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Return"}),r.jsx("div",{style:{fontSize:"13px"},children:E})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Total"}),r.jsx("div",{style:{fontWeight:600,fontSize:"15px",color:"#1976d2"},children:Kt(w.totalAmount||0)})]}),r.jsx("div",{style:{padding:"6px 12px",background:k.color,color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:500,textAlign:"center",whiteSpace:"nowrap"},children:k.text})]},x)})})]})]})})}function r1({user:e,onClose:t,onAssignStaff:n,onDelete:s}){const[o,a]=v.useState(!1),[l,d]=v.useState(!1);if(!e)return null;const u=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",f=e.email||e.Email||"",m=e.phoneNumber||e.PhoneNumber||e.phone||"",g=e.role||e.Role||e.userRole||"Customer",y=e.id||e.Id||e.userId||e.UserId;if(l)return r.jsx(n1,{userId:y,userName:u,onClose:()=>d(!1)});const C=async()=>{const _=window.prompt("Enter reason for promoting to staff (optional):")||"";if(_!==null){a(!0);try{await(n==null?void 0:n(e,_)),t==null||t()}catch(b){alert((b==null?void 0:b.message)||"Failed to assign staff role")}finally{a(!1)}}},N=async()=>{if(!window.confirm(`Are you sure you want to delete ${u}?`))return;const _=window.prompt("Enter reason for deletion (optional):")||"";a(!0);try{await(s==null?void 0:s(e,_)),t==null||t()}catch(b){alert((b==null?void 0:b.message)||"Failed to delete user")}finally{a(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsxs("div",{style:{textAlign:"center",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{"aria-hidden":!0,style:{width:"120px",height:"120px",borderRadius:"50%",background:"#eceff1",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"15px",color:"#607d8b"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsx("h2",{style:{margin:"10px 0"},children:u}),r.jsx("div",{style:{color:"#666",marginBottom:"20px"},children:g})]}),r.jsxs("div",{style:{padding:"0 20px 20px"},children:[r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:f})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Phone:"}),r.jsx("span",{children:m})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"User ID:"}),r.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:y})]})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[r.jsxs("button",{onClick:()=>d(!0),style:{background:"#1976d2",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:"pointer",opacity:o?.6:1},children:[r.jsx("i",{className:"fas fa-history",style:{marginRight:"6px"}}),"Booking History"]}),r.jsx("button",{onClick:C,disabled:o,style:{background:"#43a047",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:o?"Processing...":"Promote to Staff"}),r.jsx("button",{onClick:N,disabled:o,style:{background:"#d32f2f",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:o?"Processing...":"Delete User"})]})]})})}function i1({open:e,onClose:t,onSuccess:n}){const[s,o]=v.useState(""),[a,l]=v.useState(""),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState(!1),[C,N]=v.useState(""),_=async b=>{var w,x;b.preventDefault(),N(""),y(!0);try{await Te.post("/Auth/Register",{fullName:s,email:a,phoneNumber:d,password:f}),o(""),l(""),u(""),m(""),n==null||n(),t()}catch(k){const S=((x=(w=k==null?void 0:k.response)==null?void 0:w.data)==null?void 0:x.message)||(k==null?void 0:k.message)||"Failed to create user";N(S)}finally{y(!1)}};return e?r.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:r.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h2",{children:"Create New User"}),r.jsxs("form",{onSubmit:_,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:s,onChange:b=>o(b.target.value),placeholder:"Full Name",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:a,onChange:b=>l(b.target.value),placeholder:"Email",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:d,onChange:b=>u(b.target.value),placeholder:"Phone",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:f,onChange:b=>m(b.target.value),placeholder:"Password",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-lock"})]}),C&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:C}),r.jsx("button",{type:"submit",disabled:g,children:g?"Creating Account...":"Create User"})]})]})}):null}function s1({user:e,onClick:t}){const n=e.fullName||e.FullName||"Unknown User",s=e.email||e.Email||"N/A",o=e.userRole||e.role||e.Role||"N/A",a=e.deactivatedAt||"Unknown",l=e.daysDeactivated||0;return r.jsxs("div",{className:"user-card deleted-user-card",onClick:t,children:[r.jsxs("div",{className:"user-card-header",children:[r.jsx("div",{className:"user-avatar deleted",children:r.jsx("i",{className:"fas fa-user-slash"})}),r.jsxs("div",{className:"user-info",children:[r.jsx("h4",{className:"user-name",children:n}),r.jsx("p",{className:"user-email",children:s})]})]}),r.jsxs("div",{className:"user-card-body",children:[r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Role:"}),r.jsx("span",{className:"value",children:o})]}),r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Deleted:"}),r.jsx("span",{className:"value",children:a})]}),r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Days Inactive:"}),r.jsxs("span",{className:"value deleted-badge",children:[l," days"]})]})]}),r.jsx("div",{className:"user-card-footer",children:r.jsxs("span",{className:"user-status deleted-status",children:[r.jsx("i",{className:"fas fa-ban"})," Deleted"]})})]})}function a1({users:e,deletedUsers:t=[],loadingDeleted:n=!1,onAssignStaff:s,onDeleteUser:o,onRestoreUser:a,onUserCreated:l,onLoadDeleted:d}){const[u,f]=v.useState(null),[m,g]=v.useState(null),[y,C]=v.useState(""),[N,_]=v.useState(!1),[b,w]=v.useState("active");v.useEffect(()=>{b==="deleted"&&t.length===0&&!n&&d&&d()},[b,t.length,n,d]);const x=e.filter(E=>{const P=(E.role||E.Role||E.userRole||"").toLowerCase();return(y===""||(E.fullName||E.FullName||"").toLowerCase().includes(y.toLowerCase())||(E.email||E.Email||"").toLowerCase().includes(y.toLowerCase())||(E.userName||E.UserName||"").toLowerCase().includes(y.toLowerCase()))&&P!=="station staff"&&P!=="stationstaff"&&P!=="admin"}),k=t.filter(E=>y===""||(E.fullName||E.FullName||"").toLowerCase().includes(y.toLowerCase())||(E.email||E.Email||"").toLowerCase().includes(y.toLowerCase())||(E.userName||E.UserName||"").toLowerCase().includes(y.toLowerCase())),S=b==="active"?x:k;return r.jsxs("div",{id:"users",className:"section",children:[r.jsxs("div",{className:"filter-bar",children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>_(!0),style:{marginRight:"12px"},children:[r.jsx("i",{className:"fas fa-plus"})," Create User"]}),r.jsxs("div",{className:"view-mode-toggle",style:{marginRight:"12px"},children:[r.jsxs("button",{className:`toggle-btn ${b==="active"?"active":""}`,onClick:()=>w("active"),children:[r.jsx("i",{className:"fas fa-users"})," Active Users"]}),r.jsxs("button",{className:`toggle-btn ${b==="deleted"?"active":""}`,onClick:()=>w("deleted"),children:[r.jsx("i",{className:"fas fa-user-slash"})," Deleted Users"]})]}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or username...",value:y,onChange:E=>C(E.target.value)}),r.jsxs("div",{style:{color:"#666",fontSize:"14px"},children:["Showing ",S.length," ",b==="active"?"active":"deleted"," users"]})]}),n&&b==="deleted"&&r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Loading deleted users..."}),!n&&r.jsxs("div",{className:"user-grid",children:[b==="active"&&x.map(E=>r.jsx(t1,{user:E,onClick:()=>f(E)},E.id||E.Id)),b==="deleted"&&k.map(E=>r.jsx(s1,{user:E,onClick:()=>g(E)},E.userId||E.id||E.Id))]}),S.length===0&&!n&&r.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:["No ",b==="deleted"?"deleted":""," users found"]}),r.jsx(r1,{user:u,onClose:()=>f(null),onAssignStaff:s,onDelete:o}),m&&r.jsx("div",{className:"modal-overlay",onClick:()=>g(null),children:r.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Deleted User Details"}),r.jsx("button",{className:"modal-close",onClick:()=>g(null),children:r.jsx("i",{className:"fas fa-times"})})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"user-detail-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Name:"}),r.jsx("span",{children:m.fullName||m.FullName||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:m.email||m.Email||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Role:"}),r.jsx("span",{children:m.userRole||m.role||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Deleted At:"}),r.jsx("span",{children:m.deactivatedAt||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Days Deactivated:"}),r.jsxs("span",{children:[m.daysDeactivated||0," days"]})]})]}),r.jsx("div",{className:"modal-actions",style:{marginTop:"20px"},children:r.jsxs("button",{className:"btn-restore",onClick:()=>{a&&(a(m),g(null))},children:[r.jsx("i",{className:"fas fa-undo"})," Restore User"]})})]})]})}),r.jsx(i1,{open:N,onClose:()=>_(!1),onSuccess:l})]})}function o1({staff:e,stations:t,onClick:n}){const s=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",o=e.email||e.Email||"",a=e.avatarUrl||e.AvatarUrl||"",l=a||`https://via.placeholder.com/100x100?text=${encodeURIComponent(s.charAt(0))}`,[d,u]=v.useState(!1),f=e.phoneNumber||e.PhoneNumber||e.phone||"",m=e.stationId||e.StationId,g=t.find(N=>(N.id||N.Id)===m),y=g?g.name||g.Name:e.stationName||e.StationName||(m?`Station ${m.substring(0,8)}...`:"Not Assigned"),C=!m&&!e.stationName&&!e.StationName;return r.jsxs("div",{className:"staff-card",onClick:n,children:[a&&!d?r.jsx("img",{src:l,alt:s,className:"staff-avatar",onError:()=>u(!0)}):r.jsx("div",{className:"staff-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsxs("div",{className:"staff-info",children:[r.jsx("div",{className:"staff-name",children:s}),r.jsx("div",{className:"staff-email",children:o}),r.jsxs("div",{className:"staff-station",style:{color:C?"#ff9800":"inherit"},children:[C?"":""," ",y]}),f!==""&&r.jsxs("div",{className:"staff-phone",children:[" ",f]})]})]})}function l1({staff:e,stations:t,onClose:n,onRemoveStaff:s,onAssignStation:o,onUnassignStation:a}){const[l,d]=v.useState(!1),[u,f]=v.useState("");if(!e)return null;const m=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",g=e.email||e.Email||"",y=e.phoneNumber||e.PhoneNumber||e.phone||"",C=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/150x150?text=${encodeURIComponent(m.charAt(0))}`,N=e.id||e.Id||e.userId||e.UserId,_=e.stationId||e.StationId,b=t.find(P=>(P.id||P.Id)===_),w=b?b.name||b.Name:e.stationName||e.StationName||(_?`Station ${_.substring(0,8)}...`:"Not Assigned"),x=_||e.stationName||e.StationName,k=async()=>{if(!window.confirm(`Are you sure you want to remove staff role from ${m}?`))return;const P=window.prompt("Enter reason for removing staff role (optional):")||"";d(!0);try{await(s==null?void 0:s(e,P)),n==null||n()}catch(R){alert((R==null?void 0:R.message)||"Failed to remove staff role")}finally{d(!1)}},S=async()=>{if(!u){alert("Please select a station");return}if(window.confirm(`Assign ${m} to this station?`)){d(!0);try{await(o==null?void 0:o(e,u)),n==null||n()}catch(P){alert((P==null?void 0:P.message)||"Failed to assign station")}finally{d(!1)}}},E=async()=>{if(window.confirm(`Unassign ${m} from ${w}?`)){d(!0);try{await(a==null?void 0:a(e)),n==null||n()}catch(P){alert((P==null?void 0:P.message)||"Failed to unassign station")}finally{d(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[r.jsx("img",{src:C,alt:m,style:{width:"120px",height:"120px",borderRadius:"50%",objectFit:"cover",marginBottom:"15px"}}),r.jsx("h2",{style:{margin:"10px 0"},children:m}),r.jsx("div",{style:{color:"#43a047",fontWeight:600,marginBottom:"20px"},children:"Station Staff"})]}),r.jsxs("div",{style:{padding:"0 20px 20px"},children:[r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:g})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Phone:"}),r.jsx("span",{children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Station:"}),r.jsx("span",{children:w})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"User ID:"}),r.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:N})]})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee"},children:[r.jsx("h4",{style:{marginBottom:"12px",color:"#333"},children:x?"Reassign to Different Station":"Assign to Station"}),r.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:x?"10px":"0"},children:[r.jsxs("select",{value:u,onChange:P=>f(P.target.value),style:{flex:1,padding:"10px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},disabled:l,children:[r.jsx("option",{value:"",children:"Select a station..."}),t.map(P=>r.jsxs("option",{value:P.id||P.Id,disabled:(P.id||P.Id)===_,children:[P.name||P.Name||`Station ${P.id||P.Id}`,(P.id||P.Id)===_?" (Current)":""]},P.id||P.Id))]}),r.jsx("button",{onClick:S,disabled:l||!u,style:{background:"#2196f3",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:l||!u?"not-allowed":"pointer",opacity:l||!u?.6:1,whiteSpace:"nowrap"},children:l?"Assigning...":x?"Reassign":"Assign"})]}),x&&a&&r.jsx("button",{onClick:E,disabled:l,style:{background:"#ff9800",color:"white",padding:"8px 16px",borderRadius:"8px",border:"none",cursor:l?"not-allowed":"pointer",opacity:l?.6:1,fontSize:"13px",width:"100%"},children:l?"Unassigning...":" Unassign from Station"})]}),r.jsx("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"center"},children:r.jsx("button",{onClick:k,disabled:l,style:{background:"#ff9800",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},children:l?"Processing...":"Remove Staff Role"})})]})})}function c1({open:e,onClose:t,stations:n,onSuccess:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,C]=v.useState(""),[N,_]=v.useState(!1),[b,w]=v.useState(""),x=async k=>{var S,E,P,R;k.preventDefault(),w(""),_(!0);try{const B=await Te.post("/Auth/Register",{fullName:o,email:l,phoneNumber:u,password:m}),A=((S=B==null?void 0:B.data)==null?void 0:S.id)||((E=B==null?void 0:B.data)==null?void 0:E.userId);if(!A)throw new Error("Failed to get user ID from registration response");try{await Te.assignStaffRole(A,"Assigned to station staff role during creation")}catch(I){throw console.warn("Failed to assign staff role:",I),new Error("User created but failed to assign staff role")}if(y)try{await Te.assignStaffToStation(y,A)}catch(I){console.warn("Staff role assigned but station assignment failed:",I)}a(""),d(""),f(""),g(""),C(""),s==null||s(),t()}catch(B){const A=((R=(P=B==null?void 0:B.response)==null?void 0:P.data)==null?void 0:R.message)||(B==null?void 0:B.message)||"Failed to create staff member";w(A)}finally{_(!1)}};return e?r.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:r.jsxs("div",{className:"modal-content",onClick:k=>k.stopPropagation(),children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h2",{children:"Create New Staff Member"}),r.jsxs("form",{onSubmit:x,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:o,onChange:k=>a(k.target.value),placeholder:"Full Name",required:!0,disabled:N}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:l,onChange:k=>d(k.target.value),placeholder:"Email",required:!0,disabled:N}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:u,onChange:k=>f(k.target.value),placeholder:"Phone",required:!0,disabled:N}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:m,onChange:k=>g(k.target.value),placeholder:"Password",required:!0,disabled:N}),r.jsx("i",{className:"fas fa-lock"})]}),r.jsxs("div",{className:"input-group",style:{marginBottom:"15px"},children:[r.jsxs("select",{value:y,onChange:k=>C(k.target.value),required:!0,disabled:N,style:{width:"100%",padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",paddingLeft:"40px"},children:[r.jsx("option",{value:"",children:"Select Station"}),n.map(k=>r.jsx("option",{value:k.id||k.Id,children:k.name||k.Name||`Station ${k.id||k.Id}`},k.id||k.Id))]}),r.jsx("i",{className:"fas fa-map-marker-alt",style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",color:"#999"}})]}),b&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:b}),r.jsx("button",{type:"submit",disabled:N,children:N?"Creating Staff Member...":"Create Staff"})]})]})}):null}function d1({users:e,staffByStation:t=[],stations:n,onRemoveStaff:s,onAssignStation:o,onUnassignStation:a,onStaffCreated:l}){const[d,u]=v.useState(null),[f,m]=v.useState(""),[g,y]=v.useState(""),[C,N]=v.useState(!1),b=v.useMemo(()=>{const w=new Map;return t.forEach(x=>{const k=x.userId||x.id||x.Id;k&&w.set(k,x)}),e.forEach(x=>{const k=(x.role||x.Role||x.userRole||"").toLowerCase();if(k==="station staff"||k==="stationstaff"){const S=x.id||x.Id||x.userId;S&&!w.has(S)&&w.set(S,x)}}),Array.from(w.values())},[e,t]).filter(w=>{const x=f===""||(w.fullName||w.FullName||"").toLowerCase().includes(f.toLowerCase())||(w.email||w.Email||"").toLowerCase().includes(f.toLowerCase())||(w.userName||w.UserName||"").toLowerCase().includes(f.toLowerCase()),k=g===""||(w.stationId||w.StationId||"")===g;return x&&k});return r.jsxs("div",{id:"staff",className:"section",children:[r.jsxs("div",{className:"filter-bar",children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>N(!0),style:{marginRight:"12px"},children:[r.jsx("i",{className:"fas fa-plus"})," Create Staff"]}),r.jsx("input",{type:"text",placeholder:"Search staff by name, email, or username...",value:f,onChange:w=>m(w.target.value)}),r.jsxs("select",{value:g,onChange:w=>y(w.target.value),style:{padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"All Stations"}),n.map(w=>r.jsx("option",{value:w.id||w.Id,children:w.name||w.Name||`Station ${w.id||w.Id}`},w.id||w.Id))]}),r.jsxs("div",{style:{color:"#666",fontSize:"14px",whiteSpace:"nowrap"},children:[b.length," staff"]})]}),r.jsx("div",{className:"staff-grid",children:b.map(w=>r.jsx(o1,{staff:w,stations:n,onClick:()=>u(w)},w.id||w.Id))}),b.length===0&&r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No staff members found"}),r.jsx(l1,{staff:d,stations:n,onClose:()=>u(null),onRemoveStaff:s,onAssignStation:o,onUnassignStation:a}),r.jsx(c1,{open:C,onClose:()=>N(!1),stations:n,onSuccess:l})]})}function u1({open:e,onClose:t,inline:n=!1}){const[s,o]=v.useState(!1),[a,l]=v.useState({}),[d,u]=v.useState({}),[f,m]=v.useState("");if(v.useEffect(()=>{if(!e)return;let E=!0;async function P(){var R,B,A;try{o(!0),m("");let I={},M={};try{I=await vt.getMyProfile()}catch(W){((R=W==null?void 0:W.response)==null?void 0:R.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{M=await vt.getMe()}catch(W){((B=W==null?void 0:W.response)==null?void 0:B.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!E)return;l(I||{}),u(M||{});try{let W=(I==null?void 0:I.id)||(I==null?void 0:I.userId)||(M==null?void 0:M.userId)||(M==null?void 0:M.id);if(!W){const $=typeof localStorage<"u"?localStorage.getItem("token"):null;if($){const Q=Pr($);W=Q["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||Q.nameidentifier||Q.sub||Q.userId||Q.UserId||Q.id||Q.Id}}if(!(M!=null&&M.role)&&!(I!=null&&I.role))try{const $=typeof localStorage<"u"?localStorage.getItem("token"):null;if($){const Q=Pr($),ie=(Q==null?void 0:Q.role)||(Q==null?void 0:Q.Role)||Q["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];ie&&(M={...M,role:ie})}}catch{}const V=!(I!=null&&I.userName)&&!(M!=null&&M.userName)||!(I!=null&&I.address)||!(I!=null&&I.stationName);if(W&&V)try{const $=await vt.getUserById(W);if(!E)return;const Q={...I};Q.userName||(Q.userName=($==null?void 0:$.userName)||($==null?void 0:$.UserName)||($==null?void 0:$.username)||""),Q.address||(Q.address=($==null?void 0:$.address)||($==null?void 0:$.Address)||""),Q.stationName||(Q.stationName=($==null?void 0:$.stationName)||((A=$==null?void 0:$.station)==null?void 0:A.name)||($==null?void 0:$.StationName)||""),l(Q)}catch{}}catch{}if((!I||Object.keys(I).length===0)&&(!M||Object.keys(M).length===0)){const W=typeof localStorage<"u"&&!!localStorage.getItem("token");m(W?"You may not have permission to view this profile.":"You are not logged in. Please log in with a admin account.")}}catch(I){if(!E)return;m((I==null?void 0:I.message)||"Failed to load profile")}finally{E&&o(!1)}}return P(),()=>{E=!1}},[e]),!e)return null;let g=a.userName||a.username||d.userName||d.username||"";if(!g)try{const E=typeof localStorage<"u"?localStorage.getItem("token"):null;if(E){const P=Pr(E);g=(P==null?void 0:P.preferred_username)||(P==null?void 0:P.unique_name)||(P==null?void 0:P.userName)||(P==null?void 0:P.username)||(P==null?void 0:P.name)||""}}catch{}const y=a.firstName?`${a.firstName} ${a.lastName||""}`.trim():a.fullName||d.fullName||d.name||"",C=a.email||d.email||"",N=a.phoneNumber||d.phoneNumber||"",_=a.address||d.address||"",b=a.createdAt||d.createdAt||"",w=a.employeeId||a.id||d.userId||d.id||"",x=a.stationName||a.station||"",k=a.role||d.role||(Array.isArray(d.roles)?d.roles.join(", "):d.roles||""),S=a.avatarUrl||d.avatarUrl||"https://via.placeholder.com/180x180?text=Admin";return n?r.jsxs("div",{className:"admin-profile-page",children:[r.jsx("div",{className:"admin-cover",children:r.jsx("div",{className:"admin-cover-gradient"})}),r.jsx("div",{className:"admin-header",children:r.jsxs("div",{className:"admin-header-inner",children:[r.jsx("div",{className:"admin-avatar",children:r.jsx("img",{src:S,alt:"Avatar"})}),r.jsxs("div",{className:"admin-title",children:[r.jsx("h1",{children:y}),r.jsxs("div",{className:"admin-meta",children:[r.jsx("span",{className:"admin-role",children:k||""}),r.jsx("span",{className:"admin-sep",children:""}),r.jsx("span",{className:"admin-station",children:x})]})]})]})}),r.jsxs("div",{className:"admin-content",children:[r.jsx("div",{className:"admin-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"About"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Full Name"}),r.jsx("span",{className:"value",children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Role"}),r.jsx("span",{className:"value",children:k||""})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Station"}),r.jsx("span",{className:"value",children:x})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Employee ID"}),r.jsx("span",{className:"value",children:w})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Joined"}),r.jsx("span",{className:"value",children:String(b).toString().slice(0,10)||""})]})]})]})}),r.jsx("div",{className:"admin-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"Contact"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Email"}),r.jsx("span",{className:"value",children:C})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Phone"}),r.jsx("span",{className:"value",children:N})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Address"}),r.jsx("span",{className:"value",children:_})]})]})]})})]}),f&&r.jsx("div",{className:"admin-error",children:f})]}):r.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"profile-modal-content",children:[r.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),r.jsx("h2",{children:"Admin Profile"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsx("img",{src:S,alt:"Admin",style:{borderRadius:"50%"}}),s?r.jsx("div",{style:{padding:16},children:"Loading profile"}):r.jsxs("div",{className:"profile-info-grid",children:[r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Name"}),r.jsx("div",{children:y})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Email"}),r.jsx("div",{children:C})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Role"}),r.jsx("div",{children:k||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Phone"}),r.jsx("div",{children:N})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Address"}),r.jsx("div",{children:_})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Joined"}),r.jsx("div",{children:String(b).toString().slice(0,10)||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Employee ID"}),r.jsx("div",{children:w})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Station"}),r.jsx("div",{children:x})]})]})]})})}function h1(){return r.jsx("div",{id:"profile",className:"section",style:{padding:24},children:r.jsx(u1,{open:!0,inline:!0,onClose:()=>{}})})}function f1({open:e=!1,incident:t=null,onClose:n=()=>{},onAssigned:s=()=>{}}){const[o,a]=v.useState([]),[l,d]=v.useState(""),[u,f]=v.useState(!1);v.useEffect(()=>{if(!e)return;let C=!0;async function N(){try{const _=await Te.getAllStations(1,200);if(!C)return;a(_||[])}catch(_){console.error("Failed to load stations",_),a([])}}return N(),()=>{C=!1}},[e]),v.useEffect(()=>{t&&d(t.stationId||"")},[t]);const m=((t==null?void 0:t.status)||(t==null?void 0:t.Status)||"").toString().toUpperCase()==="RESOLVED";if(!e||!t)return null;const g=async()=>{var C;if(!l){alert("Please choose a station");return}f(!0);try{try{console.log("[AdminIncidentModal] Assigning",{incidentId:t==null?void 0:t.id,station:l});const w=new FormData;w.append("stationId",l),w.append("StationId",l),w.append("status","Pending"),w.append("Status","Pending");const x=await Ln.updateIncident(t.id,w);console.log("[AdminIncidentModal] FormData assign response:",x),alert("Assigned successfully"),s();return}catch(w){console.warn("[AdminIncidentModal] FormData update failed, will try JSON fallback",w)}const N=encodeURIComponent(t.id),_=[`/Incidents/Update-By-${N}`,`/Incidents/Update-By-Id/${N}`,`/Incidents/Update/${N}`,`/Incidents/${N}`];let b=null;for(const w of _)try{const x={stationId:l,StationId:l,status:"Pending",Status:"Pending"};console.log("[AdminIncidentModal] Trying JSON PUT",{url:w,body:x});const k=await te.put(w,x);console.log("[AdminIncidentModal] JSON PUT response for",w,k==null?void 0:k.status,k==null?void 0:k.data),alert("Assigned successfully"),s();return}catch(x){b=x;const k=(C=x==null?void 0:x.response)==null?void 0:C.status;if(k&&k!==404&&k!==405){console.error("[AdminIncidentModal] Assign JSON PUT failed on",w,x);break}console.warn("[AdminIncidentModal] JSON PUT 404/405 or not found for",w)}throw b||new Error("Assign failed")}catch(N){console.error("Failed to assign station",N),alert((N==null?void 0:N.message)||"Failed to assign")}finally{f(!1)}},y=r.jsxs("div",{style:{width:"100%"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Renter:"})," ",t.renterName||""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Phone:"})," ",t.renterPhone||""]}),r.jsxs("div",{style:{margin:"12px 0"},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Select station to assign"}),m&&r.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:"Assignment disabled for resolved incidents."}),r.jsxs("select",{value:l,onChange:C=>d(C.target.value),style:{width:"100%",padding:8},disabled:m||u,children:[r.jsx("option",{value:"",children:"-- Choose station --"}),o.map(C=>r.jsx("option",{value:C.id||C.Id,children:C.name||C.Name||C.stationName||C.station},C.id||C.Id))]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",width:"100%"},children:[r.jsxs("button",{onClick:n,disabled:u,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:u?"not-allowed":"pointer"},children:[r.jsx("i",{})," Cancel"]}),r.jsxs("button",{onClick:g,disabled:u||m,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:u||m?"not-allowed":"pointer"},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",m?"Assign (disabled)":u?"Assigning":"Assign"]})]})]});return r.jsx(Ey,{open:e,incident:t,onClose:n,onUpdate:async(C,N)=>Ln.updateIncident(C,N),onResolve:async(C,N,_)=>Ln.resolveIncident(C,N,_),footerExtras:y})}function p1(){const[e,t]=v.useState([]),[n,s]=v.useState(!1),[o,a]=v.useState(null),[l,d]=v.useState(!1),u=async()=>{s(!0);try{const g=await Ln.getAllIncidents(null,null,null,null,1,500),C=((g==null?void 0:g.incidents)||[]||[]).map(_=>{var b,w,x,k,S,E,P,R,B,A,I,M;return{id:_.id||_.Id||_.incidentId||_.IncidentId||_._id&&String(_._id),description:_.description||_.Description||_.details||"",stationId:_.stationId||_.StationId||null,status:_.status||_.Status||"Pending",bookingId:_.bookingId||_.BookingId||((b=_.booking)==null?void 0:b.id)||((w=_.booking)==null?void 0:w.BookingId)||null,reportedAt:_.reportedAt||_.ReportedAt||_.createdAt||_.CreatedAt||_.date||null,costIncurred:_.costIncurred??_.CostIncurred??_.cost??null,renterName:_.renterName||_.RenterName||((x=_.raw)==null?void 0:x.renterName)||((k=_.raw)==null?void 0:k.RenterName)||((E=(S=_.booking)==null?void 0:S.user)==null?void 0:E.fullName)||null,renterPhone:_.renterPhone||_.RenterPhone||((P=_.raw)==null?void 0:P.renterPhone)||((R=_.raw)==null?void 0:R.RenterPhone)||((A=(B=_.booking)==null?void 0:B.user)==null?void 0:A.phoneNumber)||null,staffId:_.staffId||_.StaffId||((I=_.raw)==null?void 0:I.staffId)||((M=_.raw)==null?void 0:M.StaffId)||null,images:_.images||_.Images||_.imageUrls||_.ImageUrls||(typeof _.imageUrls=="string"&&_.imageUrls?_.imageUrls.split(";"):null)||[],Images:_.images||_.Images||_.imageUrls||_.ImageUrls||(typeof _.imageUrls=="string"&&_.imageUrls?_.imageUrls.split(";"):null)||[],raw:_}}),N=await Promise.all(C.map(async _=>{var x,k,S;let b=null;const w=_.staffId||((x=_.raw)==null?void 0:x.staffId)||((k=_.raw)==null?void 0:k.StaffId)||((S=_.raw)==null?void 0:S.StaffId);if(w)try{const E=await Te.getStationByStaff(w);b=(E==null?void 0:E.name)||(E==null?void 0:E.stationName)||(E==null?void 0:E.Name)||null}catch{b=null}return{..._,creatorStation:b}}));t(N)}catch(g){console.error("Failed to load incidents",g),t([])}finally{s(!1)}};v.useEffect(()=>{u()},[]);const f=g=>{a(g),d(!0)},m=async()=>{d(!1),a(null),await u()};return r.jsxs("div",{className:"section",children:[r.jsx("h3",{style:{marginTop:0},children:"Incidents"}),n&&r.jsx("div",{children:"Loading incidents"}),!n&&e.length===0&&r.jsx("div",{style:{padding:12},children:"No incidents found."}),!n&&e.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:12},children:e.map(g=>r.jsx(Py,{incident:g,onClick:y=>f(y)},g.id))}),r.jsx(f1,{open:l,incident:o,onClose:()=>{d(!1),a(null)},onAssigned:m})]})}async function m1(e){const t={};e&&(t.headers={Authorization:`Bearer ${e}`});const n=await te.get("/Admin/Dashboard",t);return n==null?void 0:n.data}gt.create({baseURL:Hi,headers:{Accept:"application/json"}});async function g1(e,t,n){const o={params:{}};e&&(o.headers={Authorization:`Bearer ${e}`});const a=await te.get("/Admin/Reports/Car-Utilization",o);return a==null?void 0:a.data}function y1(){const[e,t]=v.useState(!0),[n,s]=v.useState(null),[o,a]=v.useState([]),[l,d]=v.useState([]),[u,f]=v.useState(""),[m,g]=v.useState("asc"),[y,C]=v.useState("none");v.useEffect(()=>{N()},[]);async function N(){t(!0),s(null);try{const k=localStorage.getItem("token"),S=await Te.getAllStations(1,200).catch(()=>[]),E=10,P=[];for(let R=0;R<S.length;R+=E){const A=S.slice(R,R+E).map(async M=>{const W=M.id||M.Id||M.stationId||M.StationId;try{const V=await uS(W,{token:k}),$=(V==null?void 0:V.data)||V||{},Q=$.totalRevenue??$.TotalRevenue??$.total??$.Total??$.revenue??0,ie=$.revenue??$.thisMonth??$.ThisMonth??$.month??$.Month??$.revenueThisMonth??0;return{StationId:W||null,StationName:M.name||M.Name||M.stationName||M.station||`Station ${W}`,TotalRevenue:Q,ThisMonth:ie,raw:$}}catch{return{StationId:W||null,StationName:M.name||M.Name||M.stationName||M.station||`Station ${W}`,TotalRevenue:0,ThisMonth:0,raw:null}}}),I=await Promise.all(A);P.push(...I)}P.sort((R,B)=>{const A=String(R.StationName||"").toLowerCase(),I=String(B.StationName||"").toLowerCase();return A<I?-1:A>I?1:0}),a(P),d(S||[])}catch(k){s((k==null?void 0:k.message)||String(k))}finally{t(!1)}}const _=()=>N(),b=o.filter(k=>{const S=u.trim().toLowerCase();if(!S)return!0;const E=String(k.StationName||k.stationName||k.Station||"").toLowerCase(),P=String(k.StationId||k.stationId||"").toLowerCase();return E.includes(S)||P.includes(S)}),w=(()=>{const k=[...b];return k.sort((S,E)=>{const P=String(S.StationName||"").toLowerCase(),R=String(E.StationName||"").toLowerCase();return P<R?m==="asc"?-1:1:P>R?m==="asc"?1:-1:0}),y&&y!=="none"&&k.sort((S,E)=>{const P=Number(S.TotalRevenue??S.totalRevenue??S.Total??0),R=Number(E.TotalRevenue??E.totalRevenue??E.Total??0);return y==="asc"?P-R:R-P}),k})(),x={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"100%"};return e?r.jsx("div",{style:{padding:12},children:"Loading station revenue"}):n?r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",n]}):r.jsxs("div",{style:{marginTop:16},children:[r.jsx("h3",{style:{margin:0,marginBottom:8},children:"Stations Revenue"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{placeholder:"Search station name or id",value:u,onChange:k=>f(k.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd",flex:1}}),r.jsxs("select",{value:m,onChange:k=>g(k.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"asc",children:"Name: A  Z"}),r.jsx("option",{value:"desc",children:"Name: Z  A"})]}),r.jsxs("select",{value:y,onChange:k=>C(k.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"none",children:"Revenue: (none)"}),r.jsx("option",{value:"desc",children:"Revenue: High  Low"}),r.jsx("option",{value:"asc",children:"Revenue: Low  High"})]}),r.jsx("button",{onClick:_,style:{padding:"8px 12px",borderRadius:6},children:"Refresh"})]}),r.jsxs("div",{style:{display:"grid",gap:12},children:[w.length===0&&r.jsx("div",{style:{color:"#666"},children:"No station revenue data available."}),w.map((k,S)=>r.jsx("div",{style:x,children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700},children:k.StationName||k.stationName||k.Station||"Station"}),r.jsx("div",{style:{color:"#666",fontSize:12},children:k.StationId||k.stationId?String(k.StationId||k.stationId):""})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"This Month"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:x1(k.ThisMonth??k.thisMonth??k.Month??k.month??0)})]})]})},k.StationId||k.stationId||S))]})]})}function x1(e){if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t.toLocaleString(void 0,{style:"currency",currency:"VND",maximumFractionDigits:0}):String(e)}function v1(){const[e,t]=v.useState([]),[n,s]=v.useState(!1),[o,a]=v.useState(null);v.useEffect(()=>{l()},[]);async function l(){s(!0),a(null);try{let u=function(_,b=[]){if(!_||typeof _!="object")return b;if(Array.isArray(_)){b.push(_);for(const w of _)u(w,b);return b}for(const w of Object.keys(_))u(_[w],b);return b};const f=localStorage.getItem("token"),m=await g1(f),g=m&&(m.data||m)||{},y=u(g);let C=[];y.length?(y.sort((_,b)=>b.length-_.length),C=y[0]):Array.isArray(g)?C=g:C=[];const N=C.map(_=>({carId:_.carId??"",brand:_.brand??"",model:_.model??"",licensePlate:_.licensePlate??"",currentStation:_.currentStation??"",totalBookings:Number(_.totalBookings??0)||0,totalHoursUsed:Number(_.totalHoursUsed??0)||0,utilizationRate:Number(_.utilizationRate??0)||0,revenue:Number(_.revenue??0)||0,averageBatteryLevel:Number(_.averageBatteryLevel??0)||0,status:_.status??""}));t(N)}catch(u){a((u==null?void 0:u.message)||String(u))}finally{s(!1)}}const d={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"100%"};return r.jsxs("div",{style:{marginTop:16},children:[r.jsx("h3",{style:{margin:0,marginBottom:8},children:"Station Vehicles"}),r.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:r.jsx("button",{onClick:l,style:{padding:"8px 12px",borderRadius:6},children:"Refresh"})}),n&&r.jsx("div",{style:{padding:12},children:"Loading vehicles"}),o&&r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",o]}),r.jsxs("div",{style:{display:"grid",gap:12},children:[e.length===0&&!n&&r.jsx("div",{style:{color:"#666"},children:"No vehicles found."}),e.map(u=>r.jsxs("div",{style:d,children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700},children:u.brand&&u.model?`${u.brand} ${u.model}`:u.carId||"Vehicle"}),r.jsx("div",{style:{color:"#666",fontSize:12},children:u.licensePlate}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:6},children:u.currentStation})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Utilization"}),r.jsxs("div",{style:{fontSize:16,fontWeight:700},children:[u.utilizationRate,"%"]}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Revenue"}),r.jsx("div",{style:{fontSize:14,fontWeight:700},children:u.revenue}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Status"}),r.jsx("div",{style:{fontSize:14,fontWeight:700},children:u.status})]})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,color:"#444",fontSize:13},children:[r.jsxs("div",{children:["Total bookings: ",r.jsx("strong",{children:u.totalBookings})]}),r.jsxs("div",{children:["Total hours: ",r.jsx("strong",{children:u.totalHoursUsed})]}),r.jsxs("div",{children:["Avg battery: ",r.jsxs("strong",{children:[u.averageBatteryLevel,"%"]})]})]})]},u.carId||u.licensePlate||JSON.stringify(u)))]})]})}function _1(){const[e,t]=v.useState(!0),[n,s]=v.useState(null),[o,a]=v.useState(null);if(v.useEffect(()=>{let y=!0;async function C(){t(!0),s(null);try{const N=localStorage.getItem("token"),_=await m1(N),b=(_==null?void 0:_.data)||_;if(!y)return;a(b)}catch(N){if(!y)return;s((N==null?void 0:N.message)||String(N))}finally{if(!y)return;t(!1)}}return C(),()=>{y=!1}},[]),e)return r.jsx("div",{style:{padding:12},children:"Loading analytics"});if(n)return r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",n]});if(!o)return r.jsx("div",{style:{padding:12},children:"No analytics data"});const l=o.data||o,d=(l==null?void 0:l.overview)||{},u=(l==null?void 0:l.userStatistics)||{},f=(l==null?void 0:l.fleetStatistics)||{},m=(l==null?void 0:l.bookingStatistics)||{};l!=null&&l.revenueStatistics;const g={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"};return r.jsxs("div",{style:{display:"grid",gap:16},children:[r.jsx("h2",{style:{margin:0,marginBottom:6},children:"Analytics"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12},children:[r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Users"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalUsers??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Cars"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalCars??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Bookings"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalBookings??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Active Bookings"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.activeBookings??""})]})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsxs("div",{style:g,children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:r.jsx("div",{style:{fontWeight:700},children:"User Statistics"})}),r.jsx("div",{style:{marginTop:8},children:r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Active"}),r.jsx("div",{style:{fontSize:18,fontWeight:700},children:u.totalActive??""})]}),r.jsxs("div",{style:{flex:2},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"By Role"}),r.jsx("div",{style:{marginTop:6,display:"flex",gap:8},children:u.byRole?Object.entries(u.byRole).map(([y,C])=>r.jsxs("div",{style:{background:"#f5f7fb",padding:"6px 8px",borderRadius:6},children:[r.jsx("div",{style:{fontSize:12,color:"#333"},children:y}),r.jsx("div",{style:{fontWeight:700},children:C})]},y)):r.jsx("div",{children:""})})]})]})})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{fontWeight:700},children:"Fleet Statistics"}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:8},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Cars"}),r.jsx("div",{style:{fontWeight:700},children:f.totalCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Available"}),r.jsx("div",{style:{fontWeight:700},children:f.availableCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"In Use"}),r.jsx("div",{style:{fontWeight:700},children:f.inUseCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Low Battery"}),r.jsx("div",{style:{fontWeight:700},children:f.lowBatteryCars??""})]})]})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{fontWeight:700},children:"Booking Statistics"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:8,marginTop:8},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total"}),r.jsx("div",{style:{fontWeight:700},children:m.total??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Pending"}),r.jsx("div",{style:{fontWeight:700},children:m.pending??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Checked-in"}),r.jsx("div",{style:{fontWeight:700},children:m.checkedIn??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Completed"}),r.jsx("div",{style:{fontWeight:700},children:m.completed??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Cancelled"}),r.jsx("div",{style:{fontWeight:700},children:m.cancelled??""})]})]})]})]})}),r.jsx("div",{style:{marginTop:12},children:r.jsx(w1,{})})]})}function w1(){const[e,t]=v.useState("stations");return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{onClick:()=>t("stations"),style:{padding:"8px 12px",borderRadius:6,background:e==="stations"?"#eef":"#fff"},children:"Stations"}),r.jsx("button",{onClick:()=>t("vehicles"),style:{padding:"8px 12px",borderRadius:6,background:e==="vehicles"?"#eef":"#fff"},children:"Vehicles"})]}),r.jsxs("div",{children:[e==="stations"&&r.jsx(y1,{}),e==="vehicles"&&r.jsx(v1,{})]})]})}function j1({open:e,onClose:t,onSubmit:n}){const[s,o]=v.useState(""),[a,l]=v.useState(""),[d,u]=v.useState(0),[f,m]=v.useState(""),[g,y]=v.useState(!1);if(!e)return null;async function C(N){if(N.preventDefault(),m(""),!s.trim()||!a.trim()){m("Name and address are required");return}y(!0);try{const _={name:s.trim(),address:a.trim(),totalSlots:Number(d)};await n(_),o(""),l(""),u(0),t&&t()}catch(_){m((_==null?void 0:_.message)||"Create failed")}finally{y(!1)}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"520px",width:"92%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:"Create Station"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsx("input",{value:s,onChange:N=>o(N.target.value),placeholder:"Station name"}),r.jsx("input",{value:a,onChange:N=>l(N.target.value),placeholder:"Address"}),r.jsx("input",{type:"number",value:d,onChange:N=>u(N.target.value),placeholder:"Total slots",min:0})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:[r.jsx("button",{onClick:t,style:{padding:"10px 20px"},children:"Cancel"}),r.jsx("button",{onClick:C,disabled:g,style:{padding:"10px 20px"},children:g?"Creating":"Create Station"})]})]})})}function S1({open:e,onClose:t,station:n,onUpdated:s,onDeleted:o}){const[a,l]=v.useState(!1),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState(0),[C,N]=v.useState(!1),[_,b]=v.useState("");if(v.useEffect(()=>{n&&(u(n.name||n.Name||""),m(n.address||n.Address||""),y(n.totalSlots??n.TotalSlots??0))},[n]),!e||!n)return null;const w=n.id||n.Id,x=async()=>{b(""),N(!0);try{const S={name:d.trim(),address:f.trim(),totalSlots:Number(g)},E=await Te.updateStation(w,S);s&&s(E||{...n,...S}),l(!1)}catch(S){b((S==null?void 0:S.message)||"Update failed")}finally{N(!1)}},k=async()=>{if(confirm("Delete this station?")){N(!0);try{await Te.deleteStation(w),o&&o(w),t&&t()}catch(S){b((S==null?void 0:S.message)||"Delete failed")}finally{N(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"640px",width:"96%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:a?"Edit Station":"Station Details"}),_&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:_}),a?r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsx("input",{value:d,onChange:S=>u(S.target.value),placeholder:"Name"}),r.jsx("input",{value:f,onChange:S=>m(S.target.value),placeholder:"Address"}),r.jsx("input",{type:"number",value:g,onChange:S=>y(S.target.value),placeholder:"Total slots",min:0})]}):r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("div",{style:{fontWeight:600},children:n.name||n.Name||`Station ${w}`}),r.jsx("div",{style:{color:"#555"},children:n.address||n.Address||""}),r.jsxs("div",{style:{color:"#555"},children:["Slots: ",n.totalSlots??n.TotalSlots??""]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:a?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l(!1),disabled:C,children:"Cancel"}),r.jsx("button",{onClick:x,disabled:C,children:C?"Saving":"Save"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l(!0),children:"Edit"}),r.jsx("button",{onClick:k,style:{background:"#dc2626",color:"#fff"},children:"Delete"})]})})]})})}function C1({open:e,onClose:t,feedback:n}){var C;if(!e||!n)return null;const[s,o]=v.useState(null),[a,l]=v.useState(null);n.id||n.Id;const d=n.subject||n.title||"Feedback",u=n.message||n.description||n.content||"",f=n.rating??n.rate??null,m=n.comment??"",g=s||n.userName||((C=n.user)==null?void 0:C.fullName)||n.userEmail||n.email||"Anonymous",y=new Date(n.createdAt||n.createdDate||n.created||Date.now()).toLocaleString();return v.useEffect(()=>{let N=!0;async function _(){try{if(n.userId&&!n.userName){const b=await Ol.getUserById(n.userId);if(N&&b){const w=b.fullName||b.name||b.userName||b.displayName||b.email||null;w&&o(w)}}}catch{}try{if(n.carId){const b=await tt.getCarById(n.carId);if(N&&b){const w=b.brand||b.Brand||b.make||b.manufacturer||null,x=b.model||b.Model||b.name||null,k=[w,x].filter(Boolean).join(" ").trim()||null;k&&l(k)}}}catch{}}return _(),()=>{N=!1}},[n]),r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"720px",width:"96%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:d}),r.jsx("div",{style:{color:"#555",marginBottom:12},children:u}),f!=null&&r.jsxs("div",{style:{fontSize:14,color:"#333",marginBottom:8},children:["Rating: ",f," / 5"]}),m&&r.jsxs("div",{style:{color:"#444",marginBottom:8},children:[r.jsx("strong",{children:"Comment:"})," ",m]}),a&&r.jsxs("div",{style:{fontSize:13,color:"#555",marginTop:6},children:["Car: ",a]}),r.jsxs("div",{style:{fontSize:12,color:"#777"},children:["From: ",g,"  ",y]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:r.jsx("button",{onClick:t,children:"Close"})})]})})}function N1({initialSearch:e="",initialPage:t=1,pageSize:n=10}){const[s,o]=v.useState([]),[a,l]=v.useState(!1),[d,u]=v.useState(e),[f,m]=v.useState(t),[g,y]=v.useState(null),[C,N]=v.useState(!1),_=async(b=f,w=n,x=d)=>{l(!0);try{const k=await Te.getFeedbacks({page:b,pageSize:w,search:x}),S=(k==null?void 0:k.items)||(k==null?void 0:k.data)||[];o(S),m(b)}catch(k){console.error("Failed to load feedbacks",k),o([])}finally{l(!1)}};return v.useEffect(()=>{_(1,n,d)},[]),r.jsxs("div",{style:{width:"100%"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:24,margin:0},children:"Feedbacks"}),r.jsx("div",{style:{flex:1}}),r.jsx("input",{placeholder:" Search feedbacks...",value:d,onChange:b=>{u(b.target.value)},onKeyPress:b=>{b.key==="Enter"&&_(1,n,b.target.value)},style:{padding:"10px 14px",border:"1px solid #ddd",borderRadius:6,minWidth:280,fontSize:14}}),r.jsx("button",{onClick:()=>_(1,n,d),style:{padding:"10px 16px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:14,transition:"background-color 0.2s"},onMouseOver:b=>b.target.style.backgroundColor="#2980b9",onMouseOut:b=>b.target.style.backgroundColor="#3498db",children:"Search"})]}),a?r.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:" Loading feedbacks"}):r.jsxs("div",{children:[(!s||s.length===0)&&r.jsx("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,color:"#666"},children:r.jsx("p",{style:{fontSize:16,margin:0},children:"No feedbacks found."})}),(s||[]).length>0&&r.jsx("div",{style:{display:"grid",gap:12},children:(s||[]).map((b,w)=>{var x;return r.jsxs("div",{style:{padding:16,border:"1px solid #e0e0e0",borderRadius:8,backgroundColor:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"flex-start",cursor:"pointer"},onMouseOver:k=>{k.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",k.currentTarget.style.transform="translateY(-2px)"},onMouseOut:k=>{k.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)",k.currentTarget.style.transform="translateY(0)"},children:[r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:6,color:"#333"},children:b.subject||b.title||"Feedback"}),r.jsx("div",{style:{color:"#666",fontSize:14,marginBottom:10,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:(b.message||b.description||b.content||"No message").slice(0,300)}),r.jsxs("div",{style:{fontSize:12,color:"#999",display:"flex",gap:12,alignItems:"center"},children:[r.jsxs("span",{children:[" ",b.userName||((x=b.user)==null?void 0:x.fullName)||b.userEmail||b.email||"Anonymous"]}),r.jsxs("span",{children:[" ",new Date(b.createdAt||b.createdDate||b.created||Date.now()).toLocaleDateString("vi-VN")]})]})]}),r.jsx("button",{onClick:()=>{y(b),N(!0)},style:{marginLeft:16,padding:"8px 14px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:4,fontWeight:600,cursor:"pointer",fontSize:13,whiteSpace:"nowrap",transition:"background-color 0.2s"},onMouseOver:k=>k.target.style.backgroundColor="#27ae60",onMouseOut:k=>k.target.style.backgroundColor="#2ecc71",children:"View"})]},b.id||b.Id||`feedback-${w}`)})}),(s||[]).length>0&&r.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginTop:32,paddingTop:20,paddingBottom:20,borderTop:"1px solid #e0e0e0",position:"sticky",bottom:0,backgroundColor:"white",zIndex:10},children:[r.jsx("button",{disabled:f<=1,onClick:()=>_(Math.max(1,f-1),n,d),style:{padding:"8px 16px",backgroundColor:f<=1?"#eee":"#3498db",color:f<=1?"#999":"white",border:"none",borderRadius:4,cursor:f<=1?"not-allowed":"pointer",fontWeight:600,fontSize:13,transition:"background-color 0.2s"},children:" Previous"}),r.jsxs("div",{style:{fontSize:13,color:"#666",minWidth:60,textAlign:"center"},children:["Page ",r.jsx("strong",{children:f})]}),r.jsx("button",{onClick:()=>_(f+1,n,d),style:{padding:"8px 16px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:600,fontSize:13,transition:"background-color 0.2s"},onMouseOver:b=>b.target.style.backgroundColor="#2980b9",onMouseOut:b=>b.target.style.backgroundColor="#3498db",children:"Next "})]})]}),r.jsx(C1,{open:C,onClose:()=>{N(!1),y(null)},feedback:g})]})}const k1=[],b1=[];function I1(){const[e,t]=v.useState("booking"),[n,s]=v.useState(k1),[o,a]=v.useState(b1),[l,d]=v.useState([]),[u,f]=v.useState([]),[m,g]=v.useState([]),[y,C]=v.useState(()=>{try{const Y=localStorage.getItem("admin_sidebar_visible");return Y==null?!0:Y==="1"}catch{return!0}}),[N,_]=v.useState(""),[b,w]=v.useState(""),[x,k]=v.useState([]),[S,E]=v.useState(""),[P,R]=v.useState(!1),[B,A]=v.useState(!1),[I,M]=v.useState(!1),[W,V]=v.useState(!1),[$,Q]=v.useState(!1),[ie,U]=v.useState(!1),[H,he]=v.useState(""),[ne,xe]=v.useState(""),[ve,oe]=v.useState(""),[D,ee]=v.useState(null),[G,_e]=v.useState(!1),[Ie,Ce]=v.useState(!1),[we,ze]=v.useState(null),[me,nt]=v.useState([]),[gn,fe]=v.useState(!1),[ae,le]=v.useState(""),[ye,ue]=v.useState(1),[Ne,Qe]=v.useState(10),Jn=async Y=>{try{await Te.confirmBooking(Y.id,"Cash",""),s(re=>re.map(se=>se.id===Y.id?{...se,status:"booked"}:se))}catch(re){he((re==null?void 0:re.message)||"Failed to proceed to payment")}},be=async(Y,re="")=>{var se;try{await Te.cancelBooking(Y.id,re||""),s(ce=>ce.map(Ee=>Ee.id===Y.id?{...Ee,status:"denied"}:Ee))}catch(ce){const Ee=(se=ce==null?void 0:ce.response)==null?void 0:se.status;if(Ee===401||Ee===403){alert("You don't have permission to cancel this booking.");return}he((ce==null?void 0:ce.message)||"Failed to cancel booking")}},z=(Y,re)=>{const se=re==="pending"?"Pending":re==="booked"?"Booked":re==="checked-in"?"Check-in Pending":re==="completed"?"Completed":re==="denied"?"Denied":re;s(ce=>ce.map(Ee=>Ee.id===Y?{...Ee,status:re,statusLabel:se}:Ee))},Ye=async Y=>{var re;try{const se=await Te.createCar(Y),ce=se||{},Ee=Me=>({id:Me.id||Me.Id||Me.carId||Me.CarId,name:Me.name||Me.Name||[Me.brand,Me.model].filter(Boolean).join(" ")||"Car",model:Me.model||Me.Model||null,brand:Me.brand||Me.Brand||null,licensePlate:Me.licensePlate||Me.LicensePlate||null,img:Me.imageUrl||Me.image||Me.thumbnailUrl||null,battery:Number.isFinite(Me.currentBatteryLevel)?Math.round(Me.currentBatteryLevel):void 0,tech:Me.condition??Me.status??Me.Status??null,issue:Me.issue??Me.issueDescription??null,capacity:Me.batteryCapacity??Me.BatteryCapacity??Me.capacity??Me.capacityKWh??Me.batteryCapacityKWh??null});return a(Me=>[...Me,Ee(ce)]),S&&await et(S),se}catch(se){console.error("Add vehicle failed:",se);const ce=(re=se==null?void 0:se.response)==null?void 0:re.data;let Ee=(se==null?void 0:se.message)||"Failed to create vehicle";if(ce)if(typeof ce=="string")Ee=ce;else if(ce.message)Ee=ce.message;else if(ce.errors)try{const Me=Object.keys(ce.errors)[0],je=ce.errors[Me];Ee=Array.isArray(je)?je[0]:String(je)}catch{Ee=JSON.stringify(ce.errors)}else Ee=JSON.stringify(ce);throw he(Ee||"Failed to create vehicle"),se}},He=async Y=>{var re;try{await Te.deleteCar(Y),a(se=>se.filter(ce=>ce.id!==Y)),await et(S)}catch(se){const ce=(re=se==null?void 0:se.response)==null?void 0:re.status;if(ce===401||ce===403){xe("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const Ee=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Me=!1;for(const je of Ee)try{await Te.updateStatus(Y,je),Me=!0;break}catch{}if(Me){a(je=>je.filter(it=>it.id!==Y));return}}catch{}he((se==null?void 0:se.message)||"Failed to delete vehicle")}},Pe=async(Y,re)=>{try{if(re.battery!==void 0&&re.battery!==""){let se=Number(re.battery);Number.isNaN(se)||(se=Math.max(0,Math.min(100,Math.round(se))),await Te.updateBatteryLevel(Y,se))}if(re.tech&&await Te.updateStatus(Y,re.tech),re.issue)try{await Te.updateCarDescription(Y,re.issue)}catch{await Te.updateCar(Y,{description:re.issue})}re.isAvailable!==void 0&&await(await WS(async()=>{const{default:ce}=await Promise.resolve().then(()=>Ej);return{default:ce}},void 0)).default.updateCarAvailability(Y,re.isAvailable?1:0)}catch(se){he((se==null?void 0:se.message)||"Failed to update vehicle")}a(se=>se.map(ce=>ce.id===Y?{...ce,...re}:ce))},X=async()=>{V(!0);try{const re=(await Te.getAllUsers(1,1e3)||[]).filter(se=>se.isActive!==!1&&se.IsActive!==!1);d(re)}catch(Y){he((Y==null?void 0:Y.message)||"Failed to load users")}finally{V(!1)}},Be=async()=>{Q(!0);try{const Y=await Te.getDeletedAccounts(1,1e3);f(Y||[])}catch(Y){he((Y==null?void 0:Y.message)||"Failed to load deleted users")}finally{Q(!1)}},rt=async Y=>{if(!Y){g([]);return}U(!0);try{const re=await Te.getStaffByStation(Y);g(re||[])}catch(re){he((re==null?void 0:re.message)||"Failed to load staff by station"),g([])}finally{U(!1)}},Ot=async(Y,re)=>{try{await Te.assignStaffRole(Y.id||Y.Id||Y.userId,re),await X(),S&&await rt(S),alert("User promoted to Station Staff successfully")}catch(se){alert((se==null?void 0:se.message)||"Failed to assign staff role")}},Cn=async(Y,re)=>{try{await Te.removeStaffRole(Y.id||Y.Id||Y.userId,re),await X(),S&&await rt(S),alert("Staff role removed successfully")}catch(se){alert((se==null?void 0:se.message)||"Failed to remove staff role")}},Ae=async(Y,re)=>{try{const se=Y.id||Y.Id||Y.userId;Y.stationId||Y.StationId?await Te.reassignStaff(se,re):await Te.assignStaffToStation(re,se),await X(),S&&await rt(S),alert("Staff assigned to station successfully")}catch(se){alert((se==null?void 0:se.message)||"Failed to assign staff to station")}},Bt=async Y=>{try{const re=Y.id||Y.Id||Y.userId;await Te.unassignStaffFromStation(re),await X(),S&&await rt(S),alert("Staff unassigned from station successfully")}catch(re){alert((re==null?void 0:re.message)||"Failed to unassign staff from station")}},pr=async(Y,re)=>{try{const se=Y.id||Y.Id||Y.userId;await Te.softDeleteUser(se,re),d(ce=>ce.filter(Ee=>(Ee.id||Ee.Id||Ee.userId)!==se)),await X(),alert("User deleted successfully")}catch(se){alert((se==null?void 0:se.message)||"Failed to delete user")}},Ur=async Y=>{try{const re=Y.userId||Y.id||Y.Id;await Te.restoreUser(re),f(se=>se.filter(ce=>(ce.userId||ce.id||ce.Id)!==re)),await Be(),await X(),alert("User restored successfully")}catch(re){alert((re==null?void 0:re.message)||"Failed to restore user")}},Pt=async(Y,re,se)=>{try{await Te.transferCar(Y.id,re,se||"");const ce=x.find(Ee=>(Ee.id||Ee.Id)===re);alert(`Vehicle transferred successfully to ${(ce==null?void 0:ce.name)||(ce==null?void 0:ce.Name)||"target station"}`),await mr(S),await et(S)}catch(ce){throw alert((ce==null?void 0:ce.message)||"Failed to transfer vehicle"),ce}},et=async Y=>{if(!Y){ee(null);return}try{const re=await Te.getCarStatusReport(Y,null);if(re){const se=(x||[]).find(Ee=>String(Ee.id||Ee.Id)===String(Y)),ce=se?se.totalSlots??se.TotalSlots??0:0;ee({totalSlots:ce,carsCount:re.totalCars||0,cars:re.cars||[]})}}catch(re){console.warn("Failed to load station slots:",re)}},mr=async Y=>{try{R(!0);let re=[];if(Y){let je=[],it=[];try{je=await Te.getCarsByStation(Y)}catch{}try{it=await Te.getAvailableCarsByStation(Y)}catch{}const pt=ge=>Array.isArray(ge)?ge:ge?[ge]:[],Z=pt(je),Re=pt(it),$e=new Map;for(const ge of[...Z,...Re]){const F=String((ge==null?void 0:ge.id)||(ge==null?void 0:ge.Id)||(ge==null?void 0:ge.carId)||(ge==null?void 0:ge.CarId)||(ge==null?void 0:ge.licensePlate)||(ge==null?void 0:ge.LicensePlate)||Math.random());$e.has(F)||$e.set(F,ge)}re=Array.from($e.values());try{const ge=await Te.getAllCars(1,1e3),F=Le=>Le==null?"":String(Le).replace(/[{}]/g,"").toLowerCase(),qe=F(Y),lt=(ge||[]).filter(Le=>{var Ht,Qt,Zt,Qn;return[Le.currentStationId,Le.CurrentStationId,Le.currentStationID,Le.stationId,Le.StationId,Le.stationID,(Ht=Le.station)==null?void 0:Ht.id,(Qt=Le.station)==null?void 0:Qt.Id,(Zt=Le.station)==null?void 0:Zt.stationId,(Qn=Le.station)==null?void 0:Qn.StationId].some(Xt=>Xt!=null&&F(Xt)===qe)});for(const Le of lt){const yt=String((Le==null?void 0:Le.id)||(Le==null?void 0:Le.Id)||(Le==null?void 0:Le.carId)||(Le==null?void 0:Le.CarId)||(Le==null?void 0:Le.licensePlate)||(Le==null?void 0:Le.LicensePlate));yt&&!$e.has(yt)&&$e.set(yt,Le)}re=Array.from($e.values())}catch{}}else try{re=await Te.getAllCars(1,1e3)}catch{try{re=await Te.listCars({page:1,pageSize:1e3})}catch{re=[]}}Array.isArray(re)||(re=re?[re]:[]);const se=je=>{const it=Number(je);return Number.isFinite(it)&&it>=0&&it<=100?Math.round(it):null},ce=(re||[]).map(je=>{var ge,F,qe,lt;const pt=((...Le)=>Le.find(yt=>yt!=null&&yt!==""))(je.currentStationId,je.CurrentStationId,je.currentStationID,je.stationId,je.StationId,je.stationID,(ge=je.station)==null?void 0:ge.id,(F=je.station)==null?void 0:F.Id,(qe=je.station)==null?void 0:qe.stationId,(lt=je.station)==null?void 0:lt.StationId),Z=Le=>Le==null?"":String(Le).replace(/[{}]/g,"").toLowerCase(),Re=pt||"",$e=(()=>{if(!Re)return null;const Le=x.find(yt=>Z(yt.id||yt.Id)===Z(Re))||null;return Le&&(Le.name||Le.Name)||null})();return{id:je.id||je.Id||je.carId||je.CarId,name:je.name||je.Name||je.model||je.CarName||"Car",model:je.model||je.Model||null,brand:je.brand||je.Brand||null,licensePlate:je.licensePlate||je.LicensePlate||null,img:je.imageUrl||je.image||je.thumbnailUrl||null,battery:se(je.currentBatteryLevel??je.CurrentBatteryLevel??je.batteryPercent??je.battery),tech:je.condition??je.status??je.Status??null,issue:je.issue??je.issueDescription??null,capacity:je.batteryCapacity??je.BatteryCapacity??je.capacity??je.capacityKWh??je.batteryCapacityKWh??null,stationId:Re,stationName:$e||null}});a(ce);const Ee=ce.filter(je=>je.battery==null),Me=ce.filter(je=>je.capacity==null);if(Ee.length>0)try{const je=await Promise.all(Ee.map(async it=>{try{const pt=await Te.getCarBattery(it.id);return{id:it.id,battery:se(pt)}}catch{return{id:it.id,battery:null}}}));a(it=>it.map(pt=>{const Z=je.find(Re=>Re.id===pt.id);return Z&&Z.battery!=null?{...pt,battery:Z.battery}:pt}))}catch{}if(Me.length>0)try{const je=await Promise.all(Me.map(async it=>{try{const pt=await Te.getCarCapacity(it.id);return{id:it.id,capacity:pt}}catch{return{id:it.id,capacity:null}}}));a(it=>it.map(pt=>{const Z=je.find(Re=>Re.id===pt.id);return Z&&Z.capacity!=null?{...pt,capacity:Z.capacity}:pt}))}catch{}}catch(re){he((re==null?void 0:re.message)||"Failed to load vehicles")}finally{R(!1)}};v.useEffect(()=>{y?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[y]),v.useEffect(()=>{try{localStorage.setItem("admin_sidebar_visible",y?"1":"0")}catch{}},[y]);const Mn=[{key:"booking",label:"Booking",icon:"fas fa-calendar-alt",onClick:()=>t("booking")},{key:"vehicle",label:"Vehicle",icon:"fas fa-car",onClick:()=>t("vehicle")},{key:"user",label:"User",icon:"fas fa-users",onClick:()=>t("user")},{key:"staff",label:"Staff",icon:"fas fa-user-tie",onClick:()=>t("staff")},{key:"station",label:"Stations",icon:"fas fa-map-marker-alt",onClick:()=>t("station")},{key:"feedback",label:"Feedback",icon:"fas fa-comment-dots",onClick:()=>t("feedback")},{key:"incident",label:"Incident",icon:"fas fa-exclamation-triangle",onClick:()=>t("incident")},{key:"analytics",label:"Analytics",icon:"fas fa-chart-line",onClick:()=>t("analytics")},{key:"profile",label:"Profile",icon:"fas fa-user-circle",onClick:()=>t("profile")}];v.useEffect(()=>{let Y=!0;async function re(){try{const ce=await vt.getMe(),Ee=(ce==null?void 0:ce.role)||(ce==null?void 0:ce.Role)||(ce==null?void 0:ce.roleName)||(ce==null?void 0:ce.userRole)||(Array.isArray(ce==null?void 0:ce.roles)?ce.roles[0]:"");Y&&oe(Ee||"")}catch{try{const ce=localStorage.getItem("token");if(ce){const Ee=Pr(ce),Me=(Ee==null?void 0:Ee.role)||(Ee==null?void 0:Ee.Role)||Ee["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];Y&&oe(Me||"")}}catch{}}}async function se(){try{A(!0);const ce=await Te.getAllStations(1,100);if(!Y)return;k(ce||[]),E(Ee=>Ee||"")}catch(ce){if(!Y)return;he((ce==null?void 0:ce.message)||"Failed to load stations")}finally{Y&&A(!1)}}return re(),se(),X(),()=>{Y=!1}},[]),v.useEffect(()=>{let Y=!0;async function re(){Y&&(await mr(S),await et(S))}return re(),()=>{Y=!1}},[S,x]),v.useEffect(()=>{let Y=!0;async function re(){try{M(!0);let se=[];if(S){try{se=await Te.getBookingsByStation(S)}catch{se=[]}if(!se||se.length===0)try{const Z=await Te.listBookings({page:1,pageSize:200}),Re=String(S);se=(Z||[]).filter($e=>{var F,qe;const ge=$e.stationId||$e.StationId||((F=$e.station)==null?void 0:F.id)||((qe=$e.station)==null?void 0:qe.Id)||$e.pickupStationId||$e.PickupStationId;return ge!=null&&String(ge)===Re})}catch{}if(se&&se.length>0){const Z=String(S);se=se.filter(Re=>{var ge,F,qe,lt,Le,yt,Ht;return[Re.stationId,Re.StationId,(ge=Re.station)==null?void 0:ge.id,(F=Re.station)==null?void 0:F.Id,Re.pickupStationId,Re.PickupStationId,Re.pickUpStationId,Re.PickUpStationId,Re.startStationId,Re.StartStationId,Re.originStationId,Re.OriginStationId,Re.fromStationId,Re.FromStationId,(qe=Re.car)==null?void 0:qe.stationId,(lt=Re.car)==null?void 0:lt.StationId,(Le=Re.car)==null?void 0:Le.currentStationId,(yt=Re.vehicle)==null?void 0:yt.stationId,(Ht=Re.vehicle)==null?void 0:Ht.StationId].some(Qt=>Qt!=null&&String(Qt)===Z)})}}else se=await Te.listBookings({page:1,pageSize:100});if(!Y)return;const ce=(se||[]).map(Z=>{var yi,xi,vi,_i,wi,yr,Un,Or,Dr,On,Ze,st,Xn,Nn,kn,xr,Ue,ct,vr,er,Rt,ji,tr,Ke,dt,nr,zr,$r,Gi,Wr,Yi,Ki,Si,Ji,Qi,Ci,Ws,Xi,Ja,Oe,yn,at,Hs,es,ts,ns,rr;const Re=Z.id||Z.Id||Z.bookingId||Z.BookingId,$e=((yi=Z.car)==null?void 0:yi.brand)||((xi=Z.car)==null?void 0:xi.Brand)||((vi=Z.vehicle)==null?void 0:vi.brand)||((_i=Z.vehicle)==null?void 0:_i.Brand)||Z.carBrand||Z.CarBrand||null,ge=((wi=Z.car)==null?void 0:wi.model)||((yr=Z.car)==null?void 0:yr.Model)||((Un=Z.vehicle)==null?void 0:Un.model)||((Or=Z.vehicle)==null?void 0:Or.Model)||Z.carModel||Z.CarModel||null;let F=Z.carName||Z.vehicleName||((Dr=Z.car)==null?void 0:Dr.name)||((On=Z.car)==null?void 0:On.Name)||null;!F&&($e||ge)&&(F=[$e,ge].filter(Boolean).join(" ").trim()||null),!F&&typeof Z.carInfo=="string"&&Z.carInfo.trim()&&(F=Z.carInfo.trim()),!F&&typeof Z.CarInfo=="string"&&Z.CarInfo.trim()&&(F=Z.CarInfo.trim()),F=F||"Booking";const qe=((Ze=Z.user)==null?void 0:Ze.firstName)||((st=Z.customer)==null?void 0:st.firstName)||Z.firstName||Z.FirstName||((Xn=Z.user)==null?void 0:Xn.FirstName)||((Nn=Z.customer)==null?void 0:Nn.FirstName),lt=((kn=Z.user)==null?void 0:kn.lastName)||((xr=Z.customer)==null?void 0:xr.lastName)||Z.lastName||Z.LastName||((Ue=Z.user)==null?void 0:Ue.LastName)||((ct=Z.customer)==null?void 0:ct.LastName),Le=[qe,lt].filter(Boolean).join(" "),yt=Le||Z.customerName||Z.userFullName||((vr=Z.user)==null?void 0:vr.fullName)||((er=Z.customer)==null?void 0:er.name)||((Rt=Z.user)==null?void 0:Rt.name)||"Customer",Ht=Z.userId||Z.UserId||((ji=Z.user)==null?void 0:ji.id)||((tr=Z.user)==null?void 0:tr.Id)||Z.customerId||Z.CustomerId||Z.appUserId||Z.AppUserId||Z.accountId||Z.AccountId||Z.UserID||Z.ownerId||Z.OwnerId||Z.createdById||Z.CreatedById||"",Qt=((Ke=Z.user)==null?void 0:Ke.userName)||((dt=Z.user)==null?void 0:dt.UserName)||((nr=Z.user)==null?void 0:nr.username)||Z.userName||Z.UserName||Z.username||null,Zt=((zr=Z.user)==null?void 0:zr.email)||Z.customerEmail||Z.email||Z.userEmail||"",Qn=(($r=Z.user)==null?void 0:$r.address)||Z.customerAddress||Z.address||"",Xt=Z.statusCode??Z.StatusCode??Z.bookingStatus??Z.BookingStatus??Z.status??Z.Status;let kt="booked",bt="Booked";if(Xt!=null&&(typeof Xt=="number"||/^\d+$/.test(String(Xt)))){const St=Number(Xt);St===0?(kt="pending",bt="Pending"):St===1?(kt="booked",bt="Active"):St===2?(kt="waiting-checkin",bt="Waiting for check-in"):St===3?(kt="checked-in",bt="Checked-in"):St===4?(kt="checkout-pending",bt="Check-out pending"):St===5?(kt="completed",bt="Completed"):St===6?(kt="cancelled-refund",bt="Cancelled pending refund"):St===7&&(kt="cancelled",bt="Cancelled")}else{const St=String(Xt||"").toLowerCase();St.includes("pending")||St.includes("wait")?(kt="pending",bt="Pending"):St.includes("active")?(kt="booked",bt="Active"):St.includes("check")&&St.includes("in")?(kt="checked-in",bt="Checked-in"):St.includes("complete")||St.includes("finish")?(kt="completed",bt="Completed"):St.includes("cancel")?(kt="cancelled",bt="Cancelled"):(kt="booked",bt="Booked")}const Fn=String(Xt||"").toLowerCase(),gi=Number(Xt)===0||Fn.includes("pending")||Fn.includes("wait")?"waiting-payment":Fn.includes("check")&&Fn.includes("in")&&(Fn.includes("pay")||Fn.includes("payment"))?"checkin-payment":null,qi=Z.date||Z.createdAt||Z.bookingDate||"",gr=Z.carImageUrl||((Gi=Z.car)==null?void 0:Gi.imageUrl)||((Wr=Z.vehicle)==null?void 0:Wr.imageUrl)||null;return{id:Re,title:F,firstName:qe||null,lastName:lt||null,fullName:Le||Z.userFullName||((Yi=Z.user)==null?void 0:Yi.fullName)||((Ki=Z.customer)==null?void 0:Ki.name)||((Si=Z.user)==null?void 0:Si.name)||null,customer:yt,userId:Ht,userName:Qt,email:Zt,address:Qn,status:kt,statusLabel:bt,uiStage:gi,date:qi,img:gr,carId:Z.carId||Z.CarId||((Ji=Z.car)==null?void 0:Ji.id)||((Qi=Z.car)==null?void 0:Qi.Id)||((Ci=Z.vehicle)==null?void 0:Ci.id)||((Ws=Z.vehicle)==null?void 0:Ws.Id)||null,cccdFrontUrl:Z.cccdFrontUrl||Z.identityFrontUrl||Z.idFrontUrl||Z.frontImageUrl||Z.frontIdUrl||Z.cccdFrontImageUrl||((Xi=Z.customer)==null?void 0:Xi.cccdFrontUrl)||((Ja=Z.user)==null?void 0:Ja.cccdFrontUrl),cccdBackUrl:Z.cccdBackUrl||Z.identityBackUrl||Z.idBackUrl||Z.backImageUrl||Z.backIdUrl||Z.cccdBackImageUrl||((Oe=Z.customer)==null?void 0:Oe.cccdBackUrl)||((yn=Z.user)==null?void 0:yn.cccdBackUrl),gplxFrontUrl:Z.gplxFrontUrl||Z.driverLicenseFrontUrl||Z.gplxImageUrl_Front||((at=Z.customer)==null?void 0:at.gplxImageUrl_Front)||((Hs=Z.user)==null?void 0:Hs.gplxImageUrl_Front),gplxBackUrl:Z.gplxBackUrl||Z.driverLicenseBackUrl||Z.gplxImageUrl_Back||((es=Z.customer)==null?void 0:es.gplxImageUrl_Back)||((ts=Z.user)==null?void 0:ts.gplxImageUrl_Back),idString:Z.customerIdNumber||((ns=Z.user)==null?void 0:ns.identityNumber)||"",phone:Z.customerPhone||((rr=Z.user)==null?void 0:rr.phoneNumber)||""}});s(ce);const Ee=ce.filter(Z=>Z.userId&&!(Z.firstName&&Z.lastName));if(Ee.length>0)try{const Z=Array.from(new Set(Ee.map(ge=>ge.userId))),Re=await Promise.all(Z.map(async ge=>{try{const F=await vt.getUserById(ge),qe=(F==null?void 0:F.firstName)||(F==null?void 0:F.FirstName)||(F==null?void 0:F.givenName)||(F==null?void 0:F.GivenName)||null,lt=(F==null?void 0:F.lastName)||(F==null?void 0:F.LastName)||(F==null?void 0:F.surname)||(F==null?void 0:F.Surname)||null,Le=(F==null?void 0:F.fullName)||(F==null?void 0:F.FullName)||[qe,lt].filter(Boolean).join(" ")||null,yt=(F==null?void 0:F.userName)||(F==null?void 0:F.UserName)||(F==null?void 0:F.username)||(F==null?void 0:F.user_name)||null,Ht=(F==null?void 0:F.address)||(F==null?void 0:F.Address)||"",Qt=(F==null?void 0:F.identityNumber)||(F==null?void 0:F.identityNo)||(F==null?void 0:F.idNumber)||(F==null?void 0:F.IdNumber)||(F==null?void 0:F.cmnd)||(F==null?void 0:F.CMND)||(F==null?void 0:F.citizenId)||(F==null?void 0:F.CitizenId)||"",Zt=(F==null?void 0:F.phoneNumber)||(F==null?void 0:F.phone)||(F==null?void 0:F.Phone)||(F==null?void 0:F.mobile)||(F==null?void 0:F.Mobile)||(F==null?void 0:F.PhoneNumber)||"";return{uid:ge,firstName:qe,lastName:lt,fullName:Le,userName:yt,address:Ht,idNumber:Qt,phone:Zt}}catch{return{uid:ge,firstName:null,lastName:null,fullName:null,userName:null,address:"",idNumber:"",phone:""}}}));if(!Y)return;const $e=new Map(Re.map(ge=>[ge.uid,ge]));s(ge=>ge.map(F=>{if(F.userId&&$e.has(F.userId)){const qe=$e.get(F.userId),lt=F.fullName||qe.fullName||[qe.firstName,qe.lastName].filter(Boolean).join(" ");return{...F,firstName:F.firstName??qe.firstName??null,lastName:F.lastName??qe.lastName??null,fullName:lt||F.customer||F.userName||null,userName:F.userName??qe.userName,address:F.address||qe.address,idString:F.idString||qe.idNumber||F.idString||"",phone:F.phone||qe.phone||F.phone||""}}return F}))}catch{}const Me=Z=>{var Re,$e,ge,F;return Z.carId||Z.CarId||Z.vehicleId||Z.VehicleId||((Re=Z.car)==null?void 0:Re.id)||(($e=Z.car)==null?void 0:$e.Id)||((ge=Z.vehicle)==null?void 0:ge.id)||((F=Z.vehicle)==null?void 0:F.Id)},je=ce.filter(Z=>(!Z.title||Z.title==="Booking")&&Me(Z));if(je.length>0)try{const Z=Array.from(new Set(je.map(Me).filter(Boolean))),Re=await Promise.all(Z.map(async ge=>{try{let F=await Te.getCarById(ge);if(!F||!F.id&&!F.Id)try{F=await Te.getCarByIdRest(ge)}catch{}const qe=(F==null?void 0:F.name)||(F==null?void 0:F.Name)||[F==null?void 0:F.brand,F==null?void 0:F.model].filter(Boolean).join(" ")||null,lt=(F==null?void 0:F.imageUrl)||(F==null?void 0:F.thumbnailUrl)||null;return{cid:ge,name:qe,img:lt}}catch{return{cid:ge,name:null,img:null}}})),$e=new Map(Re.map(ge=>[String(ge.cid),ge]));s(ge=>ge.map(F=>{const qe=Me(F),lt=qe!=null?String(qe):null;if(lt&&$e.has(lt)){const Le=$e.get(lt);return{...F,title:F.title&&F.title!=="Booking"?F.title:Le.name||F.title,img:F.img||Le.img||F.img}}return F}))}catch{}const pt=(Z=>Z.filter(Re=>!Re.title||Re.title==="Booking"))(ce);if(pt.length>0)try{const Z=await Promise.all(pt.map(async $e=>{try{const ge=await Te.getVehicleModelFromBooking($e.id),F=(ge==null?void 0:ge.name)||[ge==null?void 0:ge.brand,ge==null?void 0:ge.model].filter(Boolean).join(" ")||null;return{id:$e.id,title:F}}catch{return{id:$e.id,title:null}}})),Re=new Map(Z.map($e=>[$e.id,$e.title]));s($e=>$e.map(ge=>Re.has(ge.id)&&Re.get(ge.id)?{...ge,title:Re.get(ge.id)}:ge))}catch{}}catch(se){if(!Y)return;he((se==null?void 0:se.message)||"Failed to load bookings")}finally{Y&&M(!1)}}return re(),()=>{Y=!1}},[S]),v.useEffect(()=>{e==="staff"&&S&&rt(S),e==="feedback"&&Vi()},[e,S]);const Vi=async(Y=ye,re=Ne,se=ae)=>{fe(!0);try{const ce=await Te.getFeedbacks({page:Y,pageSize:re,search:se}),Ee=(ce==null?void 0:ce.items)||(ce==null?void 0:ce.data)||[];nt(Ee),ue(Y),Qe(re)}catch(ce){he((ce==null?void 0:ce.message)||"Failed to load feedbacks"),nt([])}finally{fe(!1)}};return r.jsxs("div",{className:"app-layout",children:[r.jsx(HS,{toggleSidebar:()=>C(Y=>!Y),sidebarVisible:y}),r.jsx("div",{className:`sidebar-wrapper ${y?"visible":""}`,children:r.jsx(ky,{title:"FEC Admin",menuItems:Mn,isOpen:y,toggleSidebar:()=>C(Y=>!Y),onSelect:t,activeKey:e})}),r.jsxs("main",{className:`main-content ${y?"shifted":""}`,children:[ne&&r.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:ne}),H&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:H}),e==="booking"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsxs("select",{value:S,onChange:Y=>E(Y.target.value),disabled:B,children:[r.jsx("option",{value:"",children:"All stations"}),x.map(Y=>{const re=Y.id||Y.Id,se=Y.name||Y.Name||Y.stationName||`Station ${re}`;return r.jsx("option",{value:re,children:se},re)})]}),I&&r.jsx("span",{children:"Loading bookings"})]}),!I&&n.length===0&&r.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),r.jsx(qS,{bookings:n,search:N,setSearch:_,statusFilter:b,setStatusFilter:w,onContinuePayment:Jn,onCancelBooking:be,onStatusUpdated:z})]}),e==="vehicle"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsxs("select",{value:S,onChange:Y=>E(Y.target.value),disabled:B,children:[r.jsx("option",{value:"",children:"All stations"}),x.map(Y=>{const re=Y.id||Y.Id,se=Y.name||Y.Name||Y.stationName||`Station ${re}`;return r.jsx("option",{value:re,children:se},re)})]}),P&&r.jsx("span",{children:"Loading vehicles"})]}),r.jsx(e1,{vehicles:o,onAdd:Ye,onRemove:He,onUpdate:Pe,stationId:S,canDelete:!0,stationSlots:D,onTransferCar:Pt,stations:x})]}),e==="station"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:24,margin:0},children:"Stations Management"}),r.jsx("div",{style:{flex:1}}),r.jsx("button",{onClick:()=>_e(!0),style:{padding:"10px 16px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:14,transition:"background-color 0.2s"},onMouseOver:Y=>Y.target.style.backgroundColor="#27ae60",onMouseOut:Y=>Y.target.style.backgroundColor="#2ecc71",children:"+ Add Station"})]}),r.jsx("div",{style:{width:"100%"},children:!x||x.length===0?r.jsx("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,color:"#666"},children:r.jsx("p",{style:{fontSize:16,margin:0},children:"No stations found. Create one to get started."})}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:x.map(Y=>r.jsxs("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,backgroundColor:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"box-shadow 0.2s, transform 0.2s",cursor:"pointer"},onMouseOver:re=>{re.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",re.currentTarget.style.transform="translateY(-2px)"},onMouseOut:re=>{re.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.05)",re.currentTarget.style.transform="translateY(0)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:12},children:r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:700,fontSize:16,marginBottom:4},children:[" ",Y.name||Y.Name||`Station ${Y.id||Y.Id}`]}),r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:8},children:Y.address||Y.Address||"No address provided"})]})}),Y.phoneNumber&&r.jsxs("div",{style:{fontSize:12,color:"#555",marginBottom:4},children:[" ",Y.phoneNumber]}),Y.capacity&&r.jsxs("div",{style:{fontSize:12,color:"#555",marginBottom:8},children:[" Capacity: ",Y.capacity," vehicles"]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,paddingTop:12,borderTop:"1px solid #eee"},children:[r.jsx("button",{onClick:()=>{ze(Y),Ce(!0)},style:{flex:1,padding:"8px 12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600,transition:"background-color 0.2s"},onMouseOver:re=>re.target.style.backgroundColor="#2980b9",onMouseOut:re=>re.target.style.backgroundColor="#3498db",children:"Details"}),r.jsx("button",{onClick:()=>{E(Y.id||Y.Id),t("booking")},style:{flex:1,padding:"8px 12px",backgroundColor:"#9b59b6",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600,transition:"background-color 0.2s"},onMouseOver:re=>re.target.style.backgroundColor="#8e44ad",onMouseOut:re=>re.target.style.backgroundColor="#9b59b6",children:"Bookings"})]})]},Y.id||Y.Id))})}),r.jsx(j1,{open:G,onClose:()=>_e(!1),onSubmit:async Y=>{const re=await Te.createStation(Y);k(se=>[re,...se||[]]),_e(!1)}}),r.jsx(S1,{open:Ie,onClose:()=>{Ce(!1),ze(null)},station:we,onUpdated:Y=>k(re=>re.map(se=>(se.id||se.Id)===(Y.id||Y.Id)?Y:se)),onDeleted:Y=>k(re=>re.filter(se=>(se.id||se.Id)!==Y))})]}),e==="feedback"&&r.jsx(r.Fragment,{children:r.jsx(N1,{})}),e==="user"&&r.jsxs(r.Fragment,{children:[W&&r.jsx("div",{style:{padding:"10px 12px"},children:"Loading users..."}),r.jsx(a1,{users:l,deletedUsers:u,loadingDeleted:$,onAssignStaff:Ot,onDeleteUser:pr,onRestoreUser:Ur,onUserCreated:X,onLoadDeleted:Be})]}),e==="staff"&&r.jsxs(r.Fragment,{children:[(W||ie)&&r.jsx("div",{style:{padding:"10px 12px"},children:"Loading staff..."}),r.jsx(d1,{users:l,staffByStation:m,stations:x,onRemoveStaff:Cn,onAssignStation:Ae,onUnassignStation:Bt,onStaffCreated:X})]}),e==="incident"&&r.jsx(r.Fragment,{children:r.jsx(p1,{})}),e==="analytics"&&r.jsx(r.Fragment,{children:r.jsx(_1,{})}),e==="profile"&&r.jsx(h1,{})]})]})}const Ty=v.createContext(null);function Da(){return v.useContext(Ty)}function L1({children:e}){const[t,n]=v.useState(()=>{try{return JSON.parse(localStorage.getItem("user"))||null}catch{return null}}),[s,o]=v.useState(()=>localStorage.getItem("token")||null),[a,l]=v.useState(!1),[d,u]=v.useState(!1);v.useEffect(()=>{s?localStorage.setItem("token",s):localStorage.removeItem("token")},[s]),v.useEffect(()=>{t?(localStorage.setItem("user",JSON.stringify(t)),t.email&&localStorage.setItem("userEmail",t.email)):(localStorage.removeItem("user"),localStorage.removeItem("userEmail"))},[t]),v.useEffect(()=>{function C(N){try{if(!N){o(localStorage.getItem("token")||null);const _=localStorage.getItem("user");n(_?JSON.parse(_):null);return}if(N.key==="token"){o(localStorage.getItem("token")||null);return}if(N.key==="user"){const _=localStorage.getItem("user");try{n(_?JSON.parse(_):null)}catch{n(null)}return}if(N.key==="userRole"||N.key==="stationId"){const _=localStorage.getItem("user");try{n(_?JSON.parse(_):null)}catch{}return}}catch(_){console.warn("Error handling storage event in AuthContext:",_)}}return window.addEventListener("storage",C),()=>window.removeEventListener("storage",C)},[]);async function f(C,N){var x,k,S,E;const _=await vt.login(C,N),b=_.token||((x=_.payload)==null?void 0:x.token)||((k=_.raw)==null?void 0:k.token);b&&o(b);const w=((S=_.payload)==null?void 0:S.user)||((E=_.raw)==null?void 0:E.user)||_.payload&&_.payload.user||JSON.parse(localStorage.getItem("user"));return w&&n(w),l(!1),_}async function m(C,N,_,b){return await vt.register({fullName:C,email:N,phoneNumber:_,password:b})}function g(){o(null),n(null),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userEmail"),localStorage.removeItem("stationId"),localStorage.removeItem("userRole")}const y={user:t,token:s,login:f,logout:g,register:m,showLogin:a,setShowLogin:l,showRegister:d,setShowRegister:u};return r.jsx(Ty.Provider,{value:y,children:e})}function vp({children:e,requireStaff:t=!1,requireAdmin:n=!1}){const{user:s,token:o}=Da(),a=(s==null?void 0:s.role)||(s==null?void 0:s.Role)||(s==null?void 0:s.roleName)||(s==null?void 0:s.userRole)||(Array.isArray(s==null?void 0:s.roles)?s.roles[0]:null),l=typeof window<"u"?localStorage.getItem("userRole"):null,d=a||l||"",u=d&&(d.includes("Staff")||d.toLowerCase().includes("staff")||d==="StationManager"||d.toLowerCase().includes("manager")),f=d&&(d.includes("Admin")||d.toLowerCase().includes("admin")||d==="SystemAdmin"||d.toLowerCase().includes("administrator"));return n?!o||!f?r.jsx(Nc,{to:"/",replace:!0}):e:t?!o||!u&&!f?r.jsx(Nc,{to:"/",replace:!0}):e:o?e:r.jsx(Nc,{to:"/",replace:!0})}function P1(){const{user:e,logout:t,setShowLogin:n,setShowRegister:s}=Da(),o=on(),[a,l]=v.useState(!1),[d,u]=v.useState({isOpen:!1,type:"info",title:"",message:""});function f(){l(y=>!y)}v.useEffect(()=>{const y=()=>{console.log(" Navigating to update profile page"),o("/update-profile"),l(!1)};return window.addEventListener("openUpdateProfile",y),()=>window.removeEventListener("openUpdateProfile",y)},[o]),v.useEffect(()=>{function y(C){a&&!C.target.closest(".user-menu")&&l(!1)}return document.addEventListener("click",y),()=>document.removeEventListener("click",y)},[a]);const m=e&&e.userRole==="Station Staff",g=e&&e.userRole==="Admin";return r.jsxs(r.Fragment,{children:[r.jsx("header",{className:"header",children:r.jsxs("div",{className:"container header-container",children:[r.jsx("div",{className:"logo",children:r.jsx("a",{href:"/",children:"FEC"})}),r.jsxs("nav",{className:"nav",children:[r.jsxs("div",{className:"navbar-left",children:[m&&r.jsxs("a",{href:"/staff",className:"staff-portal-btn",children:[r.jsx("i",{className:"fas fa-user-shield"})," Staff Portal"]}),g&&r.jsxs("a",{href:"/admin",className:"admin-portal-btn",children:[r.jsx("i",{className:"fas fa-user-shield"})," Admin Portal"]})]}),r.jsxs("div",{className:"navbar-right",children:[!e&&r.jsx("button",{id:"loginBtn",onClick:()=>n(!0),className:"login-nav-btn",children:"Log in"}),e&&r.jsxs("div",{className:"user-menu",children:[r.jsxs("button",{className:"user-menu-btn",onClick:f,children:[r.jsx("i",{className:"fas fa-user-circle"}),r.jsx("i",{className:"fas fa-chevron-down"})]}),r.jsxs("div",{className:`user-dropdown ${a?"show":""}`,children:[r.jsxs("div",{className:"dropdown-header",children:[r.jsx("i",{className:"fas fa-user-circle"}),r.jsx("span",{id:"userEmail",children:e.email||"User Account"})]}),r.jsx("hr",{}),r.jsxs("a",{href:"/profile",children:[" ",r.jsx("i",{className:"fas fa-user-cog"})," User Profile"]}),r.jsxs("a",{href:"/update-profile",children:[" ",r.jsx("i",{className:"fas fa-edit"})," Update Profile"]}),r.jsxs("a",{href:"/booking-history",children:[" ",r.jsx("i",{className:"fas fa-history"})," Booking History"]}),r.jsxs("a",{href:"#",onClick:y=>{y.preventDefault();const C=(e==null?void 0:e.email)||"User";t(),l(!1),u({isOpen:!0,type:"success",title:"Logged Out Successfully! ",message:`You have been logged out.
Goodbye, ${C}!`,autoCloseMs:2e3}),setTimeout(()=>o("/"),2e3)},children:[" ",r.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})]})]})]})]})]})}),r.jsx(Fr,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,autoCloseMs:d.autoCloseMs,onClose:()=>u(y=>({...y,isOpen:!1}))})]})}function E1(){return r.jsx("footer",{className:"footer",children:r.jsx("div",{className:"container",children:r.jsx("p",{children:" 2025 FEC. All rights reserved."})})})}const T1=()=>{const[e,t]=v.useState({soHopDong:"",ngayKy:new Date().getDate().toString(),thangKy:(new Date().getMonth()+1).toString(),namKy:new Date().getFullYear().toString(),benA:{hoTen:""},xe:{bienSo:""},thoiHanThueSo:"1",thoiHanThueChu:"mt",giaThueSo:"10,000,000",giaThueChu:"mi triu ng",phuongThucThanhToan:"Chuyn khon",ngayThanhToan:"15 hng thng"}),[n,s]=v.useState(""),[o,a]=v.useState(""),[l,d]=v.useState(null),[u,f]=v.useState(!1),m=on(),g=C=>{const{name:N,value:_}=C.target;if(N.includes(".")){const[b,w]=N.split(".");t(x=>({...x,[b]:{...x[b],[w]:_}}))}else t(b=>({...b,[N]:_}))},y=async C=>{C.preventDefault(),f(!0),d(null);try{const N={...e,thoiHanThue:1,donViThoiHan:"thang",gplx:{hang:"B1",so:"123456789",hanSuDung:"31/12/2030"}},_=await fr.createHopDong(N,n,o);_&&_.isSuccess!==!1?(alert("Contract created successfully!"),m(`/contract/${_}`)):d((_==null?void 0:_.message)||"Failed to create contract")}catch(N){d(N.message||"An error occurred."),console.error("Create contract error:",N)}f(!1)};return r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Create New Contract"})}),r.jsx("div",{className:"card-body",children:r.jsxs("form",{onSubmit:y,children:[r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Booking ID"}),r.jsx("input",{type:"text",className:"form-control",value:n,onChange:C=>s(C.target.value),required:!0})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Renter ID"}),r.jsx("input",{type:"text",className:"form-control",value:o,onChange:C=>a(C.target.value),required:!0})]})]}),r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Contract Number"}),r.jsx("input",{type:"text",name:"soHopDong",className:"form-control",value:e.soHopDong,onChange:g,required:!0})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Renter's Full Name"}),r.jsx("input",{type:"text",name:"benA.hoTen",className:"form-control",value:e.benA.hoTen,onChange:g,required:!0})]})]}),r.jsx("div",{className:"row",children:r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"License Plate"}),r.jsx("input",{type:"text",name:"xe.bienSo",className:"form-control",value:e.xe.bienSo,onChange:g,required:!0})]})}),l&&r.jsx("div",{className:"alert alert-danger",children:l}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?"Creating...":"Create Contract"})]})})]})},B1=()=>{const[e,t]=v.useState([]),[n,s]=v.useState(!0),[o,a]=v.useState(null),l=localStorage.getItem("userId")||"3fa85f64-5717-4562-b3fc-2c963f66afa6";v.useEffect(()=>{(async()=>{try{const f=await fr.getContractsByRenter(l);f&&f.length>0?t(f):t([])}catch(f){console.error("Fetch contracts error:",f),a(f.message||"An error occurred while fetching contracts.")}s(!1)})()},[l]);const d=async(u,f)=>{try{const m=await fr.downloadContractById(u),g=window.URL.createObjectURL(new Blob([m])),y=document.createElement("a");y.href=g,y.setAttribute("download",`HopDong_${f||u}.docx`),document.body.appendChild(y),y.click(),y.remove(),window.URL.revokeObjectURL(g)}catch(m){a(m.message||"An error occurred while downloading the contract.")}};return n?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):o?r.jsxs("p",{className:"text-danger",children:["Error: ",o]}):r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[r.jsx("h2",{className:"card-title mb-0",children:"My Contracts"}),r.jsx(kc,{to:"/contract/new",className:"btn btn-primary",children:"Create New Contract"})]}),r.jsx("div",{className:"card-body",children:r.jsxs("table",{className:"table table-striped",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Contract Number"}),r.jsx("th",{children:"Booking ID"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Created At"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.length>0?e.map(u=>r.jsxs("tr",{children:[r.jsx("td",{children:u.soHopDong||"N/A"}),r.jsx("td",{children:r.jsx(kc,{to:`/contract/${u.contractId}`,children:u.bookingId})}),r.jsx("td",{children:r.jsx("span",{className:`badge bg-${u.isConfirmed?"success":"warning"}`,children:u.isConfirmed?"Confirmed":"Pending"})}),r.jsx("td",{children:new Date(u.createdAt).toLocaleDateString()}),r.jsxs("td",{children:[r.jsx(kc,{to:`/contract/${u.contractId}`,className:"btn btn-sm btn-info me-2",children:"View"}),r.jsx("button",{onClick:()=>d(u.contractId,u.soHopDong),className:"btn btn-sm btn-secondary",children:"Download"})]})]},u.contractId)):r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"text-center",children:"No contracts found."})})})]})})]})},R1=()=>{const{id:e}=$g(),[t,n]=v.useState(null),[s,o]=v.useState(!0),[a,l]=v.useState(null),[d,u]=v.useState("");v.useEffect(()=>{(async()=>{try{const g=await fr.getContractByBooking(e);g?n(g):l("Failed to fetch contract")}catch(g){l(g.message||"An error occurred while fetching the contract.")}o(!1)})()},[e]);const f=async()=>{if(!d){l("Please enter an email address.");return}try{await fr.sendConfirmationEmail(t.contractId,d),alert("Confirmation email sent successfully!"),u("")}catch(m){l(m.message||"Failed to send confirmation email.")}};return s?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):a?r.jsxs("p",{className:"text-danger",children:["Error: ",a]}):t?r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Contract Details"})}),r.jsxs("div",{className:"card-body",children:[r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Contract ID:"})," ",t.contractId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Booking ID:"})," ",t.bookingId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Renter ID:"})," ",t.renterId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Status:"}),r.jsx("span",{className:`badge bg-${t.isConfirmed?"success":"warning"} ms-2`,children:t.isConfirmed?"Confirmed":"Pending"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Created At:"})," ",new Date(t.createdAt).toLocaleString()]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Contract Content:"}),r.jsx("pre",{className:"border p-3",children:t.contractContent})]}),!t.isConfirmed&&r.jsxs("div",{className:"mt-4",children:[r.jsx("h5",{children:"Confirm Contract"}),r.jsxs("div",{className:"input-group mb-3",children:[r.jsx("input",{type:"email",className:"form-control",placeholder:"Enter email to receive confirmation link",value:d,onChange:m=>u(m.target.value)}),r.jsx("button",{className:"btn btn-primary",onClick:f,children:"Send Confirmation"})]})]})]})]}):r.jsx("p",{children:"No contract found."})},A1=()=>{const[e]=qg(),t=on(),n=e.get("token"),[s,o]=v.useState(""),[a,l]=v.useState(null),[d,u]=v.useState(!0),[f,m]=v.useState(null),[g,y]=v.useState(!1),[C,N]=v.useState(!1),[_,b]=v.useState(!1),[w,x]=v.useState(!1);v.useEffect(()=>{if(!n){m("No confirmation token provided."),u(!1);return}(async()=>{try{const E=await fr.getContractForConfirmation(n);E?(l(E),o(E.noiDungHtml||E.htmlContent||"")):m("Failed to fetch contract for confirmation.")}catch(E){m(E.message||"An error occurred.")}u(!1)})()},[n]);const k=async()=>{y(!0),m(null);try{console.log(" Signing contract with token:",n);const S=await fr.signContract(n);console.log(" Sign response:",S),console.log(" Response type:",typeof S),console.log(" Response is truthy:",!!S),console.log(" Contract signed successfully!"),x(!0),setTimeout(()=>{N(!0),console.log(" Redirecting to booking history..."),t("/booking-history")},4e3)}catch(S){console.error(" Error signing contract:",S),m(S.message||"An error occurred while signing.")}y(!1)};return d?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):f?r.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1050},children:r.jsxs("div",{style:{textAlign:"center",width:"100%",maxWidth:"680px"},children:[r.jsx("p",{className:"text-danger",style:{fontWeight:700,marginBottom:"1rem"},children:"Bn  k hp ng ny ri!!! Vui lng xem lch s t xe ca bn"}),r.jsx("button",{className:"btn btn-secondary",style:{display:"block",margin:"0 auto",width:"100%",maxWidth:"280px"},onClick:()=>t("/booking-history"),children:"XEM LCH S T XE"})]})}):C?r.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"100vh"},children:r.jsxs("div",{className:"alert alert-success text-center",style:{maxWidth:"600px"},children:[r.jsx("h4",{className:"alert-heading",children:" Sign Successfully!"}),r.jsx("p",{children:"Your contract has been signed successfully."}),r.jsx("p",{style:{fontSize:"14px",color:"#666"},children:"You will be redirected to booking history in a moment..."})]})}):r.jsxs(r.Fragment,{children:[r.jsx(Fr,{isOpen:w,type:"success",title:"Sign Successfully!",message:"Your contract has been signed successfully. You will be redirected to booking history in a moment...",onClose:()=>x(!1),autoCloseMs:4e3}),r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"card-header",children:[r.jsx("h2",{className:"card-title mb-3",children:"Confirm and Sign Contract"}),a&&r.jsx("div",{className:"contract-info",children:r.jsx("div",{className:"row",children:r.jsx("div",{className:"col-md-4"})})})]}),r.jsxs("div",{className:"card-body",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{className:"border p-4 mb-4",style:{maxWidth:"800px",width:"100%",maxHeight:"600px",overflowY:"auto",backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontFamily:"'Times New Roman', serif",fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:s}}),r.jsx("hr",{style:{width:"100%",maxWidth:"800px"}}),r.jsxs("div",{className:"form-check mb-3",style:{maxWidth:"800px",width:"100%"},children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"agreeCheck",checked:_,onChange:S=>b(S.target.checked)}),r.jsx("label",{className:"form-check-label",htmlFor:"agreeCheck",children:"I have read and agree to the terms of the contract."})]}),r.jsx("button",{className:"btn btn-primary btn-lg",style:{maxWidth:"800px",width:"100%"},onClick:k,disabled:g||!_,children:g?"Signing...":"Click to Sign"})]})]})]})},M1=()=>{const[e,t]=v.useState(!1),[n,s]=v.useState(null),[o,a]=v.useState(!1);v.useEffect(()=>{l()},[]);const l=async()=>{var d,u,f,m;t(!0),s(null),a(!1);try{const g=await fr.downloadMyLatestContract(),y=window.URL.createObjectURL(new Blob([g])),C=document.createElement("a");C.href=y,C.setAttribute("download",`latest_contract_${new Date().getTime()}.docx`),document.body.appendChild(C),C.click(),C.remove(),window.URL.revokeObjectURL(y),a(!0)}catch(g){console.error("Download error:",g);const y=((u=(d=g.response)==null?void 0:d.data)==null?void 0:u.message)||g.message||"An error occurred while downloading.";((f=g.response)==null?void 0:f.status)===401?s("Unauthorized: Token khng hp l hoc  ht hn. Vui lng ng nhp li."):((m=g.response)==null?void 0:m.status)===404?s("Khng tm thy hp ng no. Vui lng kim tra li."):s(y)}t(!1)};return r.jsxs("div",{className:"card w-50 mx-auto",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Ti Xung Hp ng Mi Nht"})}),r.jsxs("div",{className:"card-body",children:[r.jsx("p",{children:"Ti xung hp ng mi nht ca bn da trn token ng nhp."}),e&&r.jsxs("div",{className:"alert alert-info",children:[r.jsx("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"ang ti xung..."]}),n&&r.jsxs("div",{className:"alert alert-danger",role:"alert",children:[r.jsx("strong",{children:"Li:"})," ",n,r.jsx("div",{className:"mt-3",children:r.jsx("button",{className:"btn btn-primary btn-sm",type:"button",onClick:l,disabled:e,children:"Th li"})})]}),o&&r.jsx("div",{className:"alert alert-success",role:"alert",children:" Hp ng  c ti xung thnh cng!"}),!e&&!n&&!o&&r.jsx("button",{className:"btn btn-primary",type:"button",onClick:l,children:"Ti Xung"})]})]})};function F1(){const e=mi(),t=e.pathname.startsWith("/staff")||e.pathname.startsWith("/admin");return r.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",flex:1},children:[!t&&r.jsx(P1,{}),r.jsx("main",{style:{flex:1},children:r.jsxs(W0,{children:[r.jsx(Mt,{path:"/",element:r.jsx(lS,{})}),r.jsx(Mt,{path:"/cars",element:r.jsx(cS,{})}),r.jsx(Mt,{path:"/cars/:id",element:r.jsx(dS,{})}),r.jsx(Mt,{path:"/payment",element:r.jsx(hS,{})}),r.jsx(Mt,{path:"/payment-success",element:r.jsx(fS,{})}),r.jsx(Mt,{path:"/payment-cancel",element:r.jsx(pS,{})}),r.jsx(Mt,{path:"/transaction",element:r.jsx(mS,{})}),r.jsx(Mt,{path:"/booking-history",element:r.jsx(yS,{})}),r.jsx(Mt,{path:"/profile",element:r.jsx(Lj,{})}),r.jsx(Mt,{path:"/update-profile",element:r.jsx(Pj,{})}),r.jsx(Mt,{path:"/contract/new",element:r.jsx(T1,{})}),r.jsx(Mt,{path:"/contract/list",element:r.jsx(B1,{})}),r.jsx(Mt,{path:"/contract/:id",element:r.jsx(R1,{})}),r.jsx(Mt,{path:"/contract/download-latest",element:r.jsx(M1,{})}),r.jsx(Mt,{path:"/xac-nhan-hop-dong",element:r.jsx(A1,{})}),r.jsx(Mt,{path:"/staff",element:r.jsx(vp,{requireStaff:!0,children:r.jsx(DS,{})})}),r.jsx(Mt,{path:"/admin",element:r.jsx(vp,{requireAdmin:!0,children:r.jsx(I1,{})})})]})}),!t&&r.jsx(E1,{})]})}function U1(){return r.jsx(J0,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:r.jsx(F1,{})})}function O1({isOpen:e,userEmail:t,onClose:n,onSuccess:s}){const[o,a]=v.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[l,d]=v.useState(!1),[u,f]=v.useState(""),[m,g]=v.useState(!1),[y,C]=v.useState([]);hr.useEffect(()=>{if(e){const x=t||localStorage.getItem("userEmail")||"";console.log(" UpdateProfileModal opened with email:",x),N()}},[e,t]);const N=async()=>{try{g(!0),console.log(" Loading profile data from API...");const x=await vt.getMyProfile();console.log(" Profile data loaded:",x);const k=[];(!x.address||x.address.trim()==="")&&k.push("address"),(!x.driverLicenseNumber||x.driverLicenseNumber.trim()==="")&&k.push("driverLicenseNumber"),(!x.driverLicenseExpiry||x.driverLicenseExpiry.trim()==="")&&k.push("driverLicenseExpiry"),C(k),console.log(" Missing fields:",k),a({firstName:x.firstName||x.FirstName||"",lastName:x.lastName||x.LastName||"",phoneNumber:x.phoneNumber||x.PhoneNumber||"",address:x.address||x.Address||"",dateOfBirth:x.dateOfBirth||x.DateOfBirth||"",yearOfBirth:x.yearOfBirth||x.YearOfBirth||"",identityNumber:x.identityNumber||x.IdentityNumber||"",driverLicenseNumber:x.driverLicenseNumber||x.DriverLicenseNumber||"",driverLicenseExpiry:x.driverLicenseExpiry||x.DriverLicenseExpiry||"",driverLicenseClass:x.driverLicenseClass||x.DriverLicenseClass||""})}catch(x){console.error(" Error loading profile:",x)}finally{g(!1)}},_=x=>{const{name:k,value:S}=x.target;a(E=>({...E,[k]:S})),f("")},b=()=>o.firstName.trim()?o.lastName.trim()?o.phoneNumber.trim()?o.phoneNumber.match(/^[0-9]{10,11}$/)?!o.address||o.address.trim()===""?(f("Address is required"),!1):!o.dateOfBirth||o.dateOfBirth.trim()===""?(f("Date of Birth is required"),!1):!o.driverLicenseNumber||o.driverLicenseNumber.trim()===""?(f("Driver License Number is required"),!1):!o.driverLicenseExpiry||o.driverLicenseExpiry.trim()===""?(f("Driver License Expiry is required"),!1):!0:(f("Phone number must be 10-11 digits"),!1):(f("Phone number is required"),!1):(f("Last name is required"),!1):(f("First name is required"),!1),w=async x=>{var k,S;if(x.preventDefault(),console.log(" Form submitted"),!b()){console.log(" Form validation failed");return}d(!0);try{if(console.log(" Updating profile with data:",o),!localStorage.getItem("userId")){f("User ID not found"),d(!1);return}const P={firstName:o.firstName,lastName:o.lastName,phoneNumber:o.phoneNumber,address:o.address||"",dateOfBirth:o.dateOfBirth||"",yearOfBirth:o.yearOfBirth?parseInt(o.yearOfBirth):null,identityNumber:o.identityNumber||"",driverLicenseNumber:o.driverLicenseNumber||"",driverLicenseExpiry:o.driverLicenseExpiry||"",driverLicenseClass:o.driverLicenseClass||""},R=await Ol.updateMyProfile(P);console.log(" Profile updated successfully:",R),localStorage.setItem("userFirstName",o.firstName),localStorage.setItem("userLastName",o.lastName),localStorage.setItem("userPhone",o.phoneNumber),s&&s(o),console.log(" Closing UpdateProfileModal"),n()}catch(E){console.error(" Error updating profile:",E),f(((S=(k=E.response)==null?void 0:k.data)==null?void 0:S.message)||"Failed to update profile. Please try again.")}finally{d(!1)}};return e?(console.log(" UpdateProfileModal: Rendering with isOpen=true"),m?r.jsx("div",{className:"modal-backdrop modal-backdrop-active",children:r.jsxs("div",{className:"modal-content modal-update-profile",children:[r.jsx("div",{className:"modal-header",children:r.jsx("h2",{children:"Loading Profile..."})}),r.jsx("div",{style:{padding:"20px",textAlign:"center"},children:r.jsx("p",{children:"Loading your profile data..."})})]})}):r.jsx("div",{className:"modal-backdrop modal-backdrop-active",children:r.jsxs("div",{className:"modal-content modal-update-profile",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:" Complete Your Profile"}),r.jsx("p",{className:"modal-subtitle",children:"Please fill in your information to complete registration"}),y.length>0&&r.jsxs("p",{className:"modal-subtitle",style:{marginTop:"10px",fontSize:"12px",color:"rgba(255,255,255,0.8)"},children:[" Missing: ",y.map(x=>x==="address"?"Address":x==="driverLicenseNumber"?"Driver License Number":x==="driverLicenseExpiry"?"Driver License Expiry":x).join(", ")]})]}),r.jsxs("form",{onSubmit:w,className:"update-profile-form",children:[u&&r.jsxs("div",{className:"form-error",children:[" ",u]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"firstName",children:"First Name *"}),r.jsx("input",{type:"text",id:"firstName",name:"firstName",value:o.firstName,onChange:_,placeholder:"John",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),r.jsx("input",{type:"text",id:"lastName",name:"lastName",value:o.lastName,onChange:_,placeholder:"Doe",required:!0})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email (Pre-filled)"}),r.jsx("input",{type:"email",id:"email",value:t||localStorage.getItem("userEmail")||"",disabled:!0,className:"form-control-disabled"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),r.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:o.phoneNumber,onChange:_,placeholder:"0912345678",required:!0})]})]}),r.jsxs("div",{className:`form-group ${y.includes("address")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"address",children:["Address",y.includes("address")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"text",id:"address",name:"address",value:o.address,onChange:_,placeholder:"123 Main St, City, Country",style:y.includes("address")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),r.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:o.dateOfBirth,onChange:_})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth"}),r.jsx("input",{type:"number",id:"yearOfBirth",name:"yearOfBirth",value:o.yearOfBirth,onChange:_,placeholder:"1990",min:"1900",max:new Date().getFullYear()})]})]}),r.jsx("div",{className:"form-divider",children:r.jsx("span",{children:"Driver License Information"})}),r.jsxs("div",{className:`form-group ${y.includes("driverLicenseNumber")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number",y.includes("driverLicenseNumber")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:o.driverLicenseNumber,onChange:_,placeholder:"ABC123456",style:y.includes("driverLicenseNumber")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:`form-group ${y.includes("driverLicenseExpiry")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry",y.includes("driverLicenseExpiry")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:o.driverLicenseExpiry,onChange:_,style:y.includes("driverLicenseExpiry")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),r.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:o.driverLicenseClass,onChange:_,children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"A",children:"Class A"}),r.jsx("option",{value:"A1",children:"Class A1"}),r.jsx("option",{value:"B",children:"Class B"}),r.jsx("option",{value:"C",children:"Class C"}),r.jsx("option",{value:"D",children:"Class D"}),r.jsx("option",{value:"E",children:"Class E"})]})]})]}),r.jsx("div",{className:"form-divider",children:r.jsx("span",{children:"Additional Information (Optional)"})}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"identityNumber",children:"Identity Number (CCCD)"}),r.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:o.identityNumber,onChange:_,placeholder:"123456789012"})]})}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:n,disabled:l,children:"Skip for Now"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?" Updating...":" Save Profile"})]})]})]})})):(console.log(" UpdateProfileModal: isOpen is false, not rendering"),null)}function D1(){const{showLogin:e,setShowLogin:t,login:n,setShowRegister:s}=Da(),[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[y,C]=v.useState(!1),[N,_]=v.useState(!1);if(!e&&!m.isOpen&&!N)return null;const b=async k=>{try{console.log(" Checking profile completeness for user:",k);const S=await vt.getMyProfile();console.log(" Profile data from /Users/Get-My-Profile:",S);const E=[];return(!S.address||S.address.trim()==="")&&E.push("Address"),(!S.dateOfBirth||S.dateOfBirth.trim()==="")&&E.push("Date of Birth"),(!S.driverLicenseNumber||S.driverLicenseNumber.trim()==="")&&E.push("Driver License Number"),(!S.driverLicenseExpiry||S.driverLicenseExpiry.trim()==="")&&E.push("Driver License Expiry"),E.length>0?(console.log(" Incomplete profile fields:",E),!0):(console.log(" Profile is complete"),!1)}catch(S){return console.error(" Error checking profile:",S),!1}};async function w(k){var S,E;k.preventDefault(),f(""),C(!0);try{console.log(" Logging in user:",o);const P=await n(o,l),R=localStorage.getItem("userRole")||(P==null?void 0:P.role);console.log(" User role:",R);const B=R&&(R.includes("Renter")||R.includes("Customer"));if(console.log(" Is renter?",B),B&&await b(localStorage.getItem("userId"))){console.log(" Opening UpdateProfileModal directly"),_(!0),t(!1),C(!1);return}g({isOpen:!0,type:"success",title:"Log in Successful! ",message:"Welcome back!",autoCloseMs:2e3}),a(""),d(""),setTimeout(()=>{t(!1)},500)}catch(P){console.error(" Login error:",P);const R=P.message||((E=(S=P.response)==null?void 0:S.data)==null?void 0:E.message)||"Login failed";f(R),g({isOpen:!0,type:"error",title:"Login Failed ",message:R,autoCloseMs:3e3})}finally{C(!1)}}function x(){t(!1),s(!0)}return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""})," ",r.jsx("br",{}),r.jsxs("form",{onSubmit:w,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:o,onChange:k=>a(k.target.value),placeholder:"Email",required:!0,disabled:y}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:l,onChange:k=>d(k.target.value),placeholder:"Password",required:!0,disabled:y}),r.jsx("i",{className:"fas fa-lock"})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:u}),r.jsx("button",{type:"submit",disabled:y,children:y?"Logging in...":"Log in"}),r.jsx("p",{className:"modal-footer-text",children:r.jsx("a",{href:"#",onClick:k=>{k.preventDefault(),x()},children:"Create new account"})})]})]})}),"// Notification Modal",r.jsx(Fr,{isOpen:m.isOpen,type:m.type,title:m.title,message:m.message,onClose:()=>g({...m,isOpen:!1})}),r.jsx(O1,{isOpen:N,userEmail:localStorage.getItem("userEmail")||o,onClose:()=>{_(!1),g({isOpen:!0,type:"success",title:"Login Successful! ",message:"Your profile has been updated. Welcome!"}),setTimeout(()=>{t(!1),g({...m,isOpen:!1})},1500)},onSuccess:()=>{console.log(" Profile updated successfully after login"),_(!1)}})]})}function z1(){const{showRegister:e,setShowRegister:t,register:n}=Da(),{user:s,logout:o,setShowLogin:a}=Da(),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,C]=v.useState(""),[N,_]=v.useState(""),[b,w]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[x,k]=v.useState(!1);if(!e&&!b.isOpen)return null;async function S(E){var P,R;E.preventDefault(),_(""),k(!0);try{console.log(" Registering user:",u),await n(l,u,m,y),w({isOpen:!0,type:"success",title:"Account Created Successfully! ",message:`Your account has been created.
Email: ${u}

You can now login and complete your profile.`,autoCloseMs:2500}),d(""),f(""),g(""),C(""),setTimeout(()=>{console.log(" Registration complete - closing register modal"),t(!1)},500)}catch(B){console.error(" Registration error:",B);const A=B.message||((R=(P=B.response)==null?void 0:P.data)==null?void 0:R.message)||"Registration failed";_(A),w({isOpen:!0,type:"error",title:"Registration Failed ",message:A,autoCloseMs:3e3})}finally{k(!1)}}return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),r.jsx("h2",{children:"Create a new account"}),r.jsxs("form",{onSubmit:S,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:l,onChange:E=>d(E.target.value),placeholder:"Full Name",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:u,onChange:E=>f(E.target.value),placeholder:"Email",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:m,onChange:E=>g(E.target.value),placeholder:"Phone",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:y,onChange:E=>C(E.target.value),placeholder:"Password",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-lock"})]}),N&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:N}),r.jsx("button",{type:"submit",disabled:x,children:x?"Creating Account...":"Sign Up"}),r.jsx("p",{className:"modal-footer-text",children:r.jsx("a",{href:"#",onClick:E=>{E.preventDefault(),a(!0),t(!1)},children:"Already have an account?"})})]})]})}),r.jsx(Fr,{isOpen:b.isOpen,type:b.type,title:b.title,message:b.message,onClose:()=>w({...b,isOpen:!1})})]})}const $1=Ag(document.getElementById("root"));$1.render(r.jsx(L1,{children:r.jsxs(Bj,{children:[r.jsx(U1,{}),r.jsx(D1,{}),r.jsx(z1,{})]})}));
