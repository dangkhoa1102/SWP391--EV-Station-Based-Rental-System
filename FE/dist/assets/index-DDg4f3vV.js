function Iv(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(s,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var wp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sp={exports:{}},yl={},Cp={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Da=Symbol.for("react.element"),Lv=Symbol.for("react.portal"),Pv=Symbol.for("react.fragment"),Ev=Symbol.for("react.strict_mode"),Tv=Symbol.for("react.profiler"),Bv=Symbol.for("react.provider"),Rv=Symbol.for("react.context"),Av=Symbol.for("react.forward_ref"),Mv=Symbol.for("react.suspense"),Fv=Symbol.for("react.memo"),Uv=Symbol.for("react.lazy"),Bh=Symbol.iterator;function Ov(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var Np={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kp=Object.assign,bp={};function Ms(e,t,n){this.props=e,this.context=t,this.refs=bp,this.updater=n||Np}Ms.prototype.isReactComponent={};Ms.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ms.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ip(){}Ip.prototype=Ms.prototype;function Od(e,t,n){this.props=e,this.context=t,this.refs=bp,this.updater=n||Np}var zd=Od.prototype=new Ip;zd.constructor=Od;kp(zd,Ms.prototype);zd.isPureReactComponent=!0;var Rh=Array.isArray,Lp=Object.prototype.hasOwnProperty,Dd={current:null},Pp={key:!0,ref:!0,__self:!0,__source:!0};function Ep(e,t,n){var s,o={},a=null,l=null;if(t!=null)for(s in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(a=""+t.key),t)Lp.call(t,s)&&!Pp.hasOwnProperty(s)&&(o[s]=t[s]);var d=arguments.length-2;if(d===1)o.children=n;else if(1<d){for(var u=Array(d),f=0;f<d;f++)u[f]=arguments[f+2];o.children=u}if(e&&e.defaultProps)for(s in d=e.defaultProps,d)o[s]===void 0&&(o[s]=d[s]);return{$$typeof:Da,type:e,key:a,ref:l,props:o,_owner:Dd.current}}function zv(e,t){return{$$typeof:Da,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $d(e){return typeof e=="object"&&e!==null&&e.$$typeof===Da}function Dv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Ah=/\/+/g;function Jl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Dv(""+e.key):t.toString(36)}function Po(e,t,n,s,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Da:case Lv:l=!0}}if(l)return l=e,o=o(l),e=s===""?"."+Jl(l,0):s,Rh(o)?(n="",e!=null&&(n=e.replace(Ah,"$&/")+"/"),Po(o,t,n,"",function(f){return f})):o!=null&&($d(o)&&(o=zv(o,n+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(Ah,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=s===""?".":s+":",Rh(e))for(var d=0;d<e.length;d++){a=e[d];var u=s+Jl(a,d);l+=Po(a,t,n,u,o)}else if(u=Ov(e),typeof u=="function")for(e=u.call(e),d=0;!(a=e.next()).done;)a=a.value,u=s+Jl(a,d++),l+=Po(a,t,n,u,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function uo(e,t,n){if(e==null)return e;var s=[],o=0;return Po(e,s,"","",function(a){return t.call(n,a,o++)}),s}function $v(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var nn={current:null},Eo={transition:null},Wv={ReactCurrentDispatcher:nn,ReactCurrentBatchConfig:Eo,ReactCurrentOwner:Dd};function Tp(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:uo,forEach:function(e,t,n){uo(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return uo(e,function(){t++}),t},toArray:function(e){return uo(e,function(t){return t})||[]},only:function(e){if(!$d(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ve.Component=Ms;Ve.Fragment=Pv;Ve.Profiler=Tv;Ve.PureComponent=Od;Ve.StrictMode=Ev;Ve.Suspense=Mv;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wv;Ve.act=Tp;Ve.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=kp({},e.props),o=e.key,a=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,l=Dd.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var d=e.type.defaultProps;for(u in t)Lp.call(t,u)&&!Pp.hasOwnProperty(u)&&(s[u]=t[u]===void 0&&d!==void 0?d[u]:t[u])}var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){d=Array(u);for(var f=0;f<u;f++)d[f]=arguments[f+2];s.children=d}return{$$typeof:Da,type:e.type,key:o,ref:a,props:s,_owner:l}};Ve.createContext=function(e){return e={$$typeof:Rv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Bv,_context:e},e.Consumer=e};Ve.createElement=Ep;Ve.createFactory=function(e){var t=Ep.bind(null,e);return t.type=e,t};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(e){return{$$typeof:Av,render:e}};Ve.isValidElement=$d;Ve.lazy=function(e){return{$$typeof:Uv,_payload:{_status:-1,_result:e},_init:$v}};Ve.memo=function(e,t){return{$$typeof:Fv,type:e,compare:t===void 0?null:t}};Ve.startTransition=function(e){var t=Eo.transition;Eo.transition={};try{e()}finally{Eo.transition=t}};Ve.unstable_act=Tp;Ve.useCallback=function(e,t){return nn.current.useCallback(e,t)};Ve.useContext=function(e){return nn.current.useContext(e)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(e){return nn.current.useDeferredValue(e)};Ve.useEffect=function(e,t){return nn.current.useEffect(e,t)};Ve.useId=function(){return nn.current.useId()};Ve.useImperativeHandle=function(e,t,n){return nn.current.useImperativeHandle(e,t,n)};Ve.useInsertionEffect=function(e,t){return nn.current.useInsertionEffect(e,t)};Ve.useLayoutEffect=function(e,t){return nn.current.useLayoutEffect(e,t)};Ve.useMemo=function(e,t){return nn.current.useMemo(e,t)};Ve.useReducer=function(e,t,n){return nn.current.useReducer(e,t,n)};Ve.useRef=function(e){return nn.current.useRef(e)};Ve.useState=function(e){return nn.current.useState(e)};Ve.useSyncExternalStore=function(e,t,n){return nn.current.useSyncExternalStore(e,t,n)};Ve.useTransition=function(){return nn.current.useTransition()};Ve.version="18.3.1";Cp.exports=Ve;var v=Cp.exports;const hr=jp(v),Hv=Iv({__proto__:null,default:hr},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zv=v,Vv=Symbol.for("react.element"),qv=Symbol.for("react.fragment"),Gv=Object.prototype.hasOwnProperty,Yv=Zv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kv={key:!0,ref:!0,__self:!0,__source:!0};function Bp(e,t,n){var s,o={},a=null,l=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)Gv.call(t,s)&&!Kv.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:Vv,type:e,key:a,ref:l,props:o,_owner:Yv.current}}yl.Fragment=qv;yl.jsx=Bp;yl.jsxs=Bp;Sp.exports=yl;var r=Sp.exports,Rp={exports:{}},jn={},Ap={exports:{}},Mp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,ue){var ne=W.length;W.push(ue);e:for(;0<ne;){var ve=ne-1>>>1,xe=W[ve];if(0<o(xe,ue))W[ve]=ue,W[ne]=xe,ne=ve;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var ue=W[0],ne=W.pop();if(ne!==ue){W[0]=ne;e:for(var ve=0,xe=W.length,ce=xe>>>1;ve<ce;){var z=2*(ve+1)-1,re=W[z],G=z+1,we=W[G];if(0>o(re,ne))G<xe&&0>o(we,re)?(W[ve]=we,W[G]=ne,ve=G):(W[ve]=re,W[z]=ne,ve=z);else if(G<xe&&0>o(we,ne))W[ve]=we,W[G]=ne,ve=G;else break e}}return ue}function o(W,ue){var ne=W.sortIndex-ue.sortIndex;return ne!==0?ne:W.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var u=[],f=[],m=1,g=null,y=3,k=!1,S=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(W){for(var ue=n(f);ue!==null;){if(ue.callback===null)s(f);else if(ue.startTime<=W)s(f),ue.sortIndex=ue.expirationTime,t(u,ue);else break;ue=n(f)}}function b(W){if(_=!1,N(W),!S)if(n(u)!==null)S=!0,ie(P);else{var ue=n(f);ue!==null&&M(b,ue.startTime-W)}}function P(W,ue){S=!1,_&&(_=!1,j(B),B=-1),k=!0;var ne=y;try{for(N(ue),g=n(u);g!==null&&(!(g.expirationTime>ue)||W&&!A());){var ve=g.callback;if(typeof ve=="function"){g.callback=null,y=g.priorityLevel;var xe=ve(g.expirationTime<=ue);ue=e.unstable_now(),typeof xe=="function"?g.callback=xe:g===n(u)&&s(u),N(ue)}else s(u);g=n(u)}if(g!==null)var ce=!0;else{var z=n(f);z!==null&&M(b,z.startTime-ue),ce=!1}return ce}finally{g=null,y=ne,k=!1}}var T=!1,R=null,B=-1,U=5,E=-1;function A(){return!(e.unstable_now()-E<U)}function H(){if(R!==null){var W=e.unstable_now();E=W;var ue=!0;try{ue=R(!0,W)}finally{ue?q():(T=!1,R=null)}}else T=!1}var q;if(typeof x=="function")q=function(){x(H)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Q=O.port2;O.port1.onmessage=H,q=function(){Q.postMessage(null)}}else q=function(){C(H,0)};function ie(W){R=W,T||(T=!0,q())}function M(W,ue){B=C(function(){W(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){S||k||(S=!0,ie(P))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var ue=3;break;default:ue=y}var ne=y;y=ue;try{return W()}finally{y=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,ue){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ne=y;y=W;try{return ue()}finally{y=ne}},e.unstable_scheduleCallback=function(W,ue,ne){var ve=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ve+ne:ve):ne=ve,W){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=ne+xe,W={id:m++,callback:ue,priorityLevel:W,startTime:ne,expirationTime:xe,sortIndex:-1},ne>ve?(W.sortIndex=ne,t(f,W),n(u)===null&&W===n(f)&&(_?(j(B),B=-1):_=!0,M(b,ne-ve))):(W.sortIndex=xe,t(u,W),S||k||(S=!0,ie(P))),W},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(W){var ue=y;return function(){var ne=y;y=ue;try{return W.apply(this,arguments)}finally{y=ne}}}})(Mp);Ap.exports=Mp;var Jv=Ap.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv=v,wn=Jv;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fp=new Set,wa={};function $i(e,t){Is(e,t),Is(e+"Capture",t)}function Is(e,t){for(wa[e]=t,e=0;e<t.length;e++)Fp.add(t[e])}var Er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tc=Object.prototype.hasOwnProperty,Xv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mh={},Fh={};function ex(e){return Tc.call(Fh,e)?!0:Tc.call(Mh,e)?!1:Xv.test(e)?Fh[e]=!0:(Mh[e]=!0,!1)}function tx(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nx(e,t,n,s){if(t===null||typeof t>"u"||tx(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rn(e,t,n,s,o,a,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wt[e]=new rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wt[t]=new rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wt[e]=new rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wt[e]=new rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wt[e]=new rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wt[e]=new rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wt[e]=new rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wt[e]=new rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wt[e]=new rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wd=/[\-:]([a-z])/g;function Hd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wd,Hd);Wt[t]=new rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wd,Hd);Wt[t]=new rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wd,Hd);Wt[t]=new rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wt[e]=new rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wt[e]=new rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zd(e,t,n,s){var o=Wt.hasOwnProperty(t)?Wt[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nx(t,n,o,s)&&(n=null),s||o===null?ex(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,s=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Ar=Qv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ho=Symbol.for("react.element"),ds=Symbol.for("react.portal"),us=Symbol.for("react.fragment"),Vd=Symbol.for("react.strict_mode"),Bc=Symbol.for("react.profiler"),Up=Symbol.for("react.provider"),Op=Symbol.for("react.context"),qd=Symbol.for("react.forward_ref"),Rc=Symbol.for("react.suspense"),Ac=Symbol.for("react.suspense_list"),Gd=Symbol.for("react.memo"),qr=Symbol.for("react.lazy"),zp=Symbol.for("react.offscreen"),Uh=Symbol.iterator;function Qs(e){return e===null||typeof e!="object"?null:(e=Uh&&e[Uh]||e["@@iterator"],typeof e=="function"?e:null)}var xt=Object.assign,Ql;function la(e){if(Ql===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ql=t&&t[1]||""}return`
`+Ql+e}var Xl=!1;function ec(e,t){if(!e||Xl)return"";Xl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var s=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){s=f}e.call(t.prototype)}else{try{throw Error()}catch(f){s=f}e()}}catch(f){if(f&&s&&typeof f.stack=="string"){for(var o=f.stack.split(`
`),a=s.stack.split(`
`),l=o.length-1,d=a.length-1;1<=l&&0<=d&&o[l]!==a[d];)d--;for(;1<=l&&0<=d;l--,d--)if(o[l]!==a[d]){if(l!==1||d!==1)do if(l--,d--,0>d||o[l]!==a[d]){var u=`
`+o[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=d);break}}}finally{Xl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?la(e):""}function rx(e){switch(e.tag){case 5:return la(e.type);case 16:return la("Lazy");case 13:return la("Suspense");case 19:return la("SuspenseList");case 0:case 2:case 15:return e=ec(e.type,!1),e;case 11:return e=ec(e.type.render,!1),e;case 1:return e=ec(e.type,!0),e;default:return""}}function Mc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case us:return"Fragment";case ds:return"Portal";case Bc:return"Profiler";case Vd:return"StrictMode";case Rc:return"Suspense";case Ac:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Op:return(e.displayName||"Context")+".Consumer";case Up:return(e._context.displayName||"Context")+".Provider";case qd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Gd:return t=e.displayName||null,t!==null?t:Mc(e.type)||"Memo";case qr:t=e._payload,e=e._init;try{return Mc(e(t))}catch{}}return null}function ix(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mc(t);case 8:return t===Vd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ci(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sx(e){var t=Dp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(l){s=""+l,a.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fo(e){e._valueTracker||(e._valueTracker=sx(e))}function $p(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Dp(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Zo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fc(e,t){var n=t.checked;return xt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Oh(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=ci(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Wp(e,t){t=t.checked,t!=null&&Zd(e,"checked",t,!1)}function Uc(e,t){Wp(e,t);var n=ci(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Oc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Oc(e,t.type,ci(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function zh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Oc(e,t,n){(t!=="number"||Zo(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ca=Array.isArray;function js(e,t,n,s){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&s&&(e[n].defaultSelected=!0)}else{for(n=""+ci(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function zc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return xt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Dh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(pe(92));if(ca(n)){if(1<n.length)throw Error(pe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ci(n)}}function Hp(e,t){var n=ci(t.value),s=ci(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function $h(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Zp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Zp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var po,Vp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(po=po||document.createElement("div"),po.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=po.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ja(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ha={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ax=["Webkit","ms","Moz","O"];Object.keys(ha).forEach(function(e){ax.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ha[t]=ha[e]})});function qp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ha.hasOwnProperty(e)&&ha[e]?(""+t).trim():t+"px"}function Gp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,o=qp(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,o):e[n]=o}}var ox=xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $c(e,t){if(t){if(ox[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function Wc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hc=null;function Yd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zc=null,Ss=null,Cs=null;function Wh(e){if(e=Ha(e)){if(typeof Zc!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=jl(t),Zc(e.stateNode,e.type,t))}}function Yp(e){Ss?Cs?Cs.push(e):Cs=[e]:Ss=e}function Kp(){if(Ss){var e=Ss,t=Cs;if(Cs=Ss=null,Wh(e),t)for(e=0;e<t.length;e++)Wh(t[e])}}function Jp(e,t){return e(t)}function Qp(){}var tc=!1;function Xp(e,t,n){if(tc)return e(t,n);tc=!0;try{return Jp(e,t,n)}finally{tc=!1,(Ss!==null||Cs!==null)&&(Qp(),Kp())}}function Sa(e,t){var n=e.stateNode;if(n===null)return null;var s=jl(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(pe(231,t,typeof n));return n}var Vc=!1;if(Er)try{var Xs={};Object.defineProperty(Xs,"passive",{get:function(){Vc=!0}}),window.addEventListener("test",Xs,Xs),window.removeEventListener("test",Xs,Xs)}catch{Vc=!1}function lx(e,t,n,s,o,a,l,d,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(m){this.onError(m)}}var fa=!1,Vo=null,qo=!1,qc=null,cx={onError:function(e){fa=!0,Vo=e}};function dx(e,t,n,s,o,a,l,d,u){fa=!1,Vo=null,lx.apply(cx,arguments)}function ux(e,t,n,s,o,a,l,d,u){if(dx.apply(this,arguments),fa){if(fa){var f=Vo;fa=!1,Vo=null}else throw Error(pe(198));qo||(qo=!0,qc=f)}}function Wi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function em(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Hh(e){if(Wi(e)!==e)throw Error(pe(188))}function hx(e){var t=e.alternate;if(!t){if(t=Wi(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var n=e,s=t;;){var o=n.return;if(o===null)break;var a=o.alternate;if(a===null){if(s=o.return,s!==null){n=s;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return Hh(o),e;if(a===s)return Hh(o),t;a=a.sibling}throw Error(pe(188))}if(n.return!==s.return)n=o,s=a;else{for(var l=!1,d=o.child;d;){if(d===n){l=!0,n=o,s=a;break}if(d===s){l=!0,s=o,n=a;break}d=d.sibling}if(!l){for(d=a.child;d;){if(d===n){l=!0,n=a,s=o;break}if(d===s){l=!0,s=a,n=o;break}d=d.sibling}if(!l)throw Error(pe(189))}}if(n.alternate!==s)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?e:t}function tm(e){return e=hx(e),e!==null?nm(e):null}function nm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=nm(e);if(t!==null)return t;e=e.sibling}return null}var rm=wn.unstable_scheduleCallback,Zh=wn.unstable_cancelCallback,fx=wn.unstable_shouldYield,px=wn.unstable_requestPaint,St=wn.unstable_now,mx=wn.unstable_getCurrentPriorityLevel,Kd=wn.unstable_ImmediatePriority,im=wn.unstable_UserBlockingPriority,Go=wn.unstable_NormalPriority,gx=wn.unstable_LowPriority,sm=wn.unstable_IdlePriority,vl=null,dr=null;function yx(e){if(dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(vl,e,void 0,(e.current.flags&128)===128)}catch{}}var qn=Math.clz32?Math.clz32:_x,vx=Math.log,xx=Math.LN2;function _x(e){return e>>>=0,e===0?32:31-(vx(e)/xx|0)|0}var mo=64,go=4194304;function da(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yo(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,o=e.suspendedLanes,a=e.pingedLanes,l=n&268435455;if(l!==0){var d=l&~o;d!==0?s=da(d):(a&=l,a!==0&&(s=da(a)))}else l=n&~o,l!==0?s=da(l):a!==0&&(s=da(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-qn(t),o=1<<n,s|=e[n],t&=~o;return s}function wx(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jx(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-qn(a),d=1<<l,u=o[l];u===-1?(!(d&n)||d&s)&&(o[l]=wx(d,t)):u<=t&&(e.expiredLanes|=d),a&=~d}}function Gc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function am(){var e=mo;return mo<<=1,!(mo&4194240)&&(mo=64),e}function nc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function $a(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qn(t),e[t]=n}function Sx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-qn(n),a=1<<o;t[o]=0,s[o]=-1,e[o]=-1,n&=~a}}function Jd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-qn(n),o=1<<s;o&t|e[s]&t&&(e[s]|=t),n&=~o}}var at=0;function om(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var lm,Qd,cm,dm,um,Yc=!1,yo=[],ei=null,ti=null,ni=null,Ca=new Map,Na=new Map,Yr=[],Cx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vh(e,t){switch(e){case"focusin":case"focusout":ei=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":Ca.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Na.delete(t.pointerId)}}function ea(e,t,n,s,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[o]},t!==null&&(t=Ha(t),t!==null&&Qd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Nx(e,t,n,s,o){switch(t){case"focusin":return ei=ea(ei,e,t,n,s,o),!0;case"dragenter":return ti=ea(ti,e,t,n,s,o),!0;case"mouseover":return ni=ea(ni,e,t,n,s,o),!0;case"pointerover":var a=o.pointerId;return Ca.set(a,ea(Ca.get(a)||null,e,t,n,s,o)),!0;case"gotpointercapture":return a=o.pointerId,Na.set(a,ea(Na.get(a)||null,e,t,n,s,o)),!0}return!1}function hm(e){var t=Li(e.target);if(t!==null){var n=Wi(t);if(n!==null){if(t=n.tag,t===13){if(t=em(n),t!==null){e.blockedOn=t,um(e.priority,function(){cm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function To(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Hc=s,n.target.dispatchEvent(s),Hc=null}else return t=Ha(n),t!==null&&Qd(t),e.blockedOn=n,!1;t.shift()}return!0}function qh(e,t,n){To(e)&&n.delete(t)}function kx(){Yc=!1,ei!==null&&To(ei)&&(ei=null),ti!==null&&To(ti)&&(ti=null),ni!==null&&To(ni)&&(ni=null),Ca.forEach(qh),Na.forEach(qh)}function ta(e,t){e.blockedOn===t&&(e.blockedOn=null,Yc||(Yc=!0,wn.unstable_scheduleCallback(wn.unstable_NormalPriority,kx)))}function ka(e){function t(o){return ta(o,e)}if(0<yo.length){ta(yo[0],e);for(var n=1;n<yo.length;n++){var s=yo[n];s.blockedOn===e&&(s.blockedOn=null)}}for(ei!==null&&ta(ei,e),ti!==null&&ta(ti,e),ni!==null&&ta(ni,e),Ca.forEach(t),Na.forEach(t),n=0;n<Yr.length;n++)s=Yr[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Yr.length&&(n=Yr[0],n.blockedOn===null);)hm(n),n.blockedOn===null&&Yr.shift()}var Ns=Ar.ReactCurrentBatchConfig,Ko=!0;function bx(e,t,n,s){var o=at,a=Ns.transition;Ns.transition=null;try{at=1,Xd(e,t,n,s)}finally{at=o,Ns.transition=a}}function Ix(e,t,n,s){var o=at,a=Ns.transition;Ns.transition=null;try{at=4,Xd(e,t,n,s)}finally{at=o,Ns.transition=a}}function Xd(e,t,n,s){if(Ko){var o=Kc(e,t,n,s);if(o===null)hc(e,t,s,Jo,n),Vh(e,s);else if(Nx(o,e,t,n,s))s.stopPropagation();else if(Vh(e,s),t&4&&-1<Cx.indexOf(e)){for(;o!==null;){var a=Ha(o);if(a!==null&&lm(a),a=Kc(e,t,n,s),a===null&&hc(e,t,s,Jo,n),a===o)break;o=a}o!==null&&s.stopPropagation()}else hc(e,t,s,null,n)}}var Jo=null;function Kc(e,t,n,s){if(Jo=null,e=Yd(s),e=Li(e),e!==null)if(t=Wi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=em(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jo=e,null}function fm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mx()){case Kd:return 1;case im:return 4;case Go:case gx:return 16;case sm:return 536870912;default:return 16}default:return 16}}var Jr=null,eu=null,Bo=null;function pm(){if(Bo)return Bo;var e,t=eu,n=t.length,s,o="value"in Jr?Jr.value:Jr.textContent,a=o.length;for(e=0;e<n&&t[e]===o[e];e++);var l=n-e;for(s=1;s<=l&&t[n-s]===o[a-s];s++);return Bo=o.slice(e,1<s?1-s:void 0)}function Ro(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vo(){return!0}function Gh(){return!1}function Sn(e){function t(n,s,o,a,l){this._reactName=n,this._targetInst=o,this.type=s,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var d in e)e.hasOwnProperty(d)&&(n=e[d],this[d]=n?n(a):a[d]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?vo:Gh,this.isPropagationStopped=Gh,this}return xt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),t}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tu=Sn(Fs),Wa=xt({},Fs,{view:0,detail:0}),Lx=Sn(Wa),rc,ic,na,xl=xt({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==na&&(na&&e.type==="mousemove"?(rc=e.screenX-na.screenX,ic=e.screenY-na.screenY):ic=rc=0,na=e),rc)},movementY:function(e){return"movementY"in e?e.movementY:ic}}),Yh=Sn(xl),Px=xt({},xl,{dataTransfer:0}),Ex=Sn(Px),Tx=xt({},Wa,{relatedTarget:0}),sc=Sn(Tx),Bx=xt({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),Rx=Sn(Bx),Ax=xt({},Fs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Mx=Sn(Ax),Fx=xt({},Fs,{data:0}),Kh=Sn(Fx),Ux={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ox={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zx[e])?!!t[e]:!1}function nu(){return Dx}var $x=xt({},Wa,{key:function(e){if(e.key){var t=Ux[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ro(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ox[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nu,charCode:function(e){return e.type==="keypress"?Ro(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ro(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Wx=Sn($x),Hx=xt({},xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jh=Sn(Hx),Zx=xt({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nu}),Vx=Sn(Zx),qx=xt({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gx=Sn(qx),Yx=xt({},xl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kx=Sn(Yx),Jx=[9,13,27,32],ru=Er&&"CompositionEvent"in window,pa=null;Er&&"documentMode"in document&&(pa=document.documentMode);var Qx=Er&&"TextEvent"in window&&!pa,mm=Er&&(!ru||pa&&8<pa&&11>=pa),Qh=" ",Xh=!1;function gm(e,t){switch(e){case"keyup":return Jx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ym(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hs=!1;function Xx(e,t){switch(e){case"compositionend":return ym(t);case"keypress":return t.which!==32?null:(Xh=!0,Qh);case"textInput":return e=t.data,e===Qh&&Xh?null:e;default:return null}}function e_(e,t){if(hs)return e==="compositionend"||!ru&&gm(e,t)?(e=pm(),Bo=eu=Jr=null,hs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mm&&t.locale!=="ko"?null:t.data;default:return null}}var t_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ef(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!t_[e.type]:t==="textarea"}function vm(e,t,n,s){Yp(s),t=Qo(t,"onChange"),0<t.length&&(n=new tu("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var ma=null,ba=null;function n_(e){Lm(e,0)}function _l(e){var t=ms(e);if($p(t))return e}function r_(e,t){if(e==="change")return t}var xm=!1;if(Er){var ac;if(Er){var oc="oninput"in document;if(!oc){var tf=document.createElement("div");tf.setAttribute("oninput","return;"),oc=typeof tf.oninput=="function"}ac=oc}else ac=!1;xm=ac&&(!document.documentMode||9<document.documentMode)}function nf(){ma&&(ma.detachEvent("onpropertychange",_m),ba=ma=null)}function _m(e){if(e.propertyName==="value"&&_l(ba)){var t=[];vm(t,ba,e,Yd(e)),Xp(n_,t)}}function i_(e,t,n){e==="focusin"?(nf(),ma=t,ba=n,ma.attachEvent("onpropertychange",_m)):e==="focusout"&&nf()}function s_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _l(ba)}function a_(e,t){if(e==="click")return _l(t)}function o_(e,t){if(e==="input"||e==="change")return _l(t)}function l_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yn=typeof Object.is=="function"?Object.is:l_;function Ia(e,t){if(Yn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var o=n[s];if(!Tc.call(t,o)||!Yn(e[o],t[o]))return!1}return!0}function rf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sf(e,t){var n=rf(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rf(n)}}function wm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?wm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jm(){for(var e=window,t=Zo();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Zo(e.document)}return t}function iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function c_(e){var t=jm(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&wm(n.ownerDocument.documentElement,n)){if(s!==null&&iu(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(s.start,o);s=s.end===void 0?a:Math.min(s.end,o),!e.extend&&a>s&&(o=s,s=a,a=o),o=sf(n,a);var l=sf(n,s);o&&l&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var d_=Er&&"documentMode"in document&&11>=document.documentMode,fs=null,Jc=null,ga=null,Qc=!1;function af(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qc||fs==null||fs!==Zo(s)||(s=fs,"selectionStart"in s&&iu(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ga&&Ia(ga,s)||(ga=s,s=Qo(Jc,"onSelect"),0<s.length&&(t=new tu("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=fs)))}function xo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ps={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionend:xo("Transition","TransitionEnd")},lc={},Sm={};Er&&(Sm=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function wl(e){if(lc[e])return lc[e];if(!ps[e])return e;var t=ps[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Sm)return lc[e]=t[n];return e}var Cm=wl("animationend"),Nm=wl("animationiteration"),km=wl("animationstart"),bm=wl("transitionend"),Im=new Map,of="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ui(e,t){Im.set(e,t),$i(t,[e])}for(var cc=0;cc<of.length;cc++){var dc=of[cc],u_=dc.toLowerCase(),h_=dc[0].toUpperCase()+dc.slice(1);ui(u_,"on"+h_)}ui(Cm,"onAnimationEnd");ui(Nm,"onAnimationIteration");ui(km,"onAnimationStart");ui("dblclick","onDoubleClick");ui("focusin","onFocus");ui("focusout","onBlur");ui(bm,"onTransitionEnd");Is("onMouseEnter",["mouseout","mouseover"]);Is("onMouseLeave",["mouseout","mouseover"]);Is("onPointerEnter",["pointerout","pointerover"]);Is("onPointerLeave",["pointerout","pointerover"]);$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$i("onBeforeInput",["compositionend","keypress","textInput","paste"]);$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f_=new Set("cancel close invalid load scroll toggle".split(" ").concat(ua));function lf(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,ux(s,t,void 0,e),e.currentTarget=null}function Lm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],o=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var l=s.length-1;0<=l;l--){var d=s[l],u=d.instance,f=d.currentTarget;if(d=d.listener,u!==a&&o.isPropagationStopped())break e;lf(o,d,f),a=u}else for(l=0;l<s.length;l++){if(d=s[l],u=d.instance,f=d.currentTarget,d=d.listener,u!==a&&o.isPropagationStopped())break e;lf(o,d,f),a=u}}}if(qo)throw e=qc,qo=!1,qc=null,e}function ut(e,t){var n=t[rd];n===void 0&&(n=t[rd]=new Set);var s=e+"__bubble";n.has(s)||(Pm(t,e,2,!1),n.add(s))}function uc(e,t,n){var s=0;t&&(s|=4),Pm(n,e,s,t)}var _o="_reactListening"+Math.random().toString(36).slice(2);function La(e){if(!e[_o]){e[_o]=!0,Fp.forEach(function(n){n!=="selectionchange"&&(f_.has(n)||uc(n,!1,e),uc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_o]||(t[_o]=!0,uc("selectionchange",!1,t))}}function Pm(e,t,n,s){switch(fm(t)){case 1:var o=bx;break;case 4:o=Ix;break;default:o=Xd}n=o.bind(null,t,n,e),o=void 0,!Vc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function hc(e,t,n,s,o){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var d=s.stateNode.containerInfo;if(d===o||d.nodeType===8&&d.parentNode===o)break;if(l===4)for(l=s.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;l=l.return}for(;d!==null;){if(l=Li(d),l===null)return;if(u=l.tag,u===5||u===6){s=a=l;continue e}d=d.parentNode}}s=s.return}Xp(function(){var f=a,m=Yd(n),g=[];e:{var y=Im.get(e);if(y!==void 0){var k=tu,S=e;switch(e){case"keypress":if(Ro(n)===0)break e;case"keydown":case"keyup":k=Wx;break;case"focusin":S="focus",k=sc;break;case"focusout":S="blur",k=sc;break;case"beforeblur":case"afterblur":k=sc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Yh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=Ex;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=Vx;break;case Cm:case Nm:case km:k=Rx;break;case bm:k=Gx;break;case"scroll":k=Lx;break;case"wheel":k=Kx;break;case"copy":case"cut":case"paste":k=Mx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Jh}var _=(t&4)!==0,C=!_&&e==="scroll",j=_?y!==null?y+"Capture":null:y;_=[];for(var x=f,N;x!==null;){N=x;var b=N.stateNode;if(N.tag===5&&b!==null&&(N=b,j!==null&&(b=Sa(x,j),b!=null&&_.push(Pa(x,b,N)))),C)break;x=x.return}0<_.length&&(y=new k(y,S,null,n,m),g.push({event:y,listeners:_}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",k=e==="mouseout"||e==="pointerout",y&&n!==Hc&&(S=n.relatedTarget||n.fromElement)&&(Li(S)||S[Tr]))break e;if((k||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,k?(S=n.relatedTarget||n.toElement,k=f,S=S?Li(S):null,S!==null&&(C=Wi(S),S!==C||S.tag!==5&&S.tag!==6)&&(S=null)):(k=null,S=f),k!==S)){if(_=Yh,b="onMouseLeave",j="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(_=Jh,b="onPointerLeave",j="onPointerEnter",x="pointer"),C=k==null?y:ms(k),N=S==null?y:ms(S),y=new _(b,x+"leave",k,n,m),y.target=C,y.relatedTarget=N,b=null,Li(m)===f&&(_=new _(j,x+"enter",S,n,m),_.target=N,_.relatedTarget=C,b=_),C=b,k&&S)t:{for(_=k,j=S,x=0,N=_;N;N=cs(N))x++;for(N=0,b=j;b;b=cs(b))N++;for(;0<x-N;)_=cs(_),x--;for(;0<N-x;)j=cs(j),N--;for(;x--;){if(_===j||j!==null&&_===j.alternate)break t;_=cs(_),j=cs(j)}_=null}else _=null;k!==null&&cf(g,y,k,_,!1),S!==null&&C!==null&&cf(g,C,S,_,!0)}}e:{if(y=f?ms(f):window,k=y.nodeName&&y.nodeName.toLowerCase(),k==="select"||k==="input"&&y.type==="file")var P=r_;else if(ef(y))if(xm)P=o_;else{P=s_;var T=i_}else(k=y.nodeName)&&k.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(P=a_);if(P&&(P=P(e,f))){vm(g,P,n,m);break e}T&&T(e,y,f),e==="focusout"&&(T=y._wrapperState)&&T.controlled&&y.type==="number"&&Oc(y,"number",y.value)}switch(T=f?ms(f):window,e){case"focusin":(ef(T)||T.contentEditable==="true")&&(fs=T,Jc=f,ga=null);break;case"focusout":ga=Jc=fs=null;break;case"mousedown":Qc=!0;break;case"contextmenu":case"mouseup":case"dragend":Qc=!1,af(g,n,m);break;case"selectionchange":if(d_)break;case"keydown":case"keyup":af(g,n,m)}var R;if(ru)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else hs?gm(e,n)&&(B="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(B="onCompositionStart");B&&(mm&&n.locale!=="ko"&&(hs||B!=="onCompositionStart"?B==="onCompositionEnd"&&hs&&(R=pm()):(Jr=m,eu="value"in Jr?Jr.value:Jr.textContent,hs=!0)),T=Qo(f,B),0<T.length&&(B=new Kh(B,e,null,n,m),g.push({event:B,listeners:T}),R?B.data=R:(R=ym(n),R!==null&&(B.data=R)))),(R=Qx?Xx(e,n):e_(e,n))&&(f=Qo(f,"onBeforeInput"),0<f.length&&(m=new Kh("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:f}),m.data=R))}Lm(g,t)})}function Pa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qo(e,t){for(var n=t+"Capture",s=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=Sa(e,n),a!=null&&s.unshift(Pa(e,a,o)),a=Sa(e,t),a!=null&&s.push(Pa(e,a,o))),e=e.return}return s}function cs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function cf(e,t,n,s,o){for(var a=t._reactName,l=[];n!==null&&n!==s;){var d=n,u=d.alternate,f=d.stateNode;if(u!==null&&u===s)break;d.tag===5&&f!==null&&(d=f,o?(u=Sa(n,a),u!=null&&l.unshift(Pa(n,u,d))):o||(u=Sa(n,a),u!=null&&l.push(Pa(n,u,d)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var p_=/\r\n?/g,m_=/\u0000|\uFFFD/g;function df(e){return(typeof e=="string"?e:""+e).replace(p_,`
`).replace(m_,"")}function wo(e,t,n){if(t=df(t),df(e)!==t&&n)throw Error(pe(425))}function Xo(){}var Xc=null,ed=null;function td(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var nd=typeof setTimeout=="function"?setTimeout:void 0,g_=typeof clearTimeout=="function"?clearTimeout:void 0,uf=typeof Promise=="function"?Promise:void 0,y_=typeof queueMicrotask=="function"?queueMicrotask:typeof uf<"u"?function(e){return uf.resolve(null).then(e).catch(v_)}:nd;function v_(e){setTimeout(function(){throw e})}function fc(e,t){var n=t,s=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(s===0){e.removeChild(o),ka(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=o}while(n);ka(t)}function ri(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Us=Math.random().toString(36).slice(2),cr="__reactFiber$"+Us,Ea="__reactProps$"+Us,Tr="__reactContainer$"+Us,rd="__reactEvents$"+Us,x_="__reactListeners$"+Us,__="__reactHandles$"+Us;function Li(e){var t=e[cr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Tr]||n[cr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=hf(e);e!==null;){if(n=e[cr])return n;e=hf(e)}return t}e=n,n=e.parentNode}return null}function Ha(e){return e=e[cr]||e[Tr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ms(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function jl(e){return e[Ea]||null}var id=[],gs=-1;function hi(e){return{current:e}}function ht(e){0>gs||(e.current=id[gs],id[gs]=null,gs--)}function dt(e,t){gs++,id[gs]=e.current,e.current=t}var di={},Kt=hi(di),dn=hi(!1),Mi=di;function Ls(e,t){var n=e.type.contextTypes;if(!n)return di;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in n)o[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function un(e){return e=e.childContextTypes,e!=null}function el(){ht(dn),ht(Kt)}function ff(e,t,n){if(Kt.current!==di)throw Error(pe(168));dt(Kt,t),dt(dn,n)}function Em(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(pe(108,ix(e)||"Unknown",o));return xt({},n,s)}function tl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||di,Mi=Kt.current,dt(Kt,e),dt(dn,dn.current),!0}function pf(e,t,n){var s=e.stateNode;if(!s)throw Error(pe(169));n?(e=Em(e,t,Mi),s.__reactInternalMemoizedMergedChildContext=e,ht(dn),ht(Kt),dt(Kt,e)):ht(dn),dt(dn,n)}var Nr=null,Sl=!1,pc=!1;function Tm(e){Nr===null?Nr=[e]:Nr.push(e)}function w_(e){Sl=!0,Tm(e)}function fi(){if(!pc&&Nr!==null){pc=!0;var e=0,t=at;try{var n=Nr;for(at=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Nr=null,Sl=!1}catch(o){throw Nr!==null&&(Nr=Nr.slice(e+1)),rm(Kd,fi),o}finally{at=t,pc=!1}}return null}var ys=[],vs=0,nl=null,rl=0,Pn=[],En=0,Fi=null,kr=1,br="";function bi(e,t){ys[vs++]=rl,ys[vs++]=nl,nl=e,rl=t}function Bm(e,t,n){Pn[En++]=kr,Pn[En++]=br,Pn[En++]=Fi,Fi=e;var s=kr;e=br;var o=32-qn(s)-1;s&=~(1<<o),n+=1;var a=32-qn(t)+o;if(30<a){var l=o-o%5;a=(s&(1<<l)-1).toString(32),s>>=l,o-=l,kr=1<<32-qn(t)+o|n<<o|s,br=a+e}else kr=1<<a|n<<o|s,br=e}function su(e){e.return!==null&&(bi(e,1),Bm(e,1,0))}function au(e){for(;e===nl;)nl=ys[--vs],ys[vs]=null,rl=ys[--vs],ys[vs]=null;for(;e===Fi;)Fi=Pn[--En],Pn[En]=null,br=Pn[--En],Pn[En]=null,kr=Pn[--En],Pn[En]=null}var _n=null,xn=null,pt=!1,Zn=null;function Rm(e,t){var n=Tn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function mf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_n=e,xn=ri(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_n=e,xn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Fi!==null?{id:kr,overflow:br}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Tn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,_n=e,xn=null,!0):!1;default:return!1}}function sd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ad(e){if(pt){var t=xn;if(t){var n=t;if(!mf(e,t)){if(sd(e))throw Error(pe(418));t=ri(n.nextSibling);var s=_n;t&&mf(e,t)?Rm(s,n):(e.flags=e.flags&-4097|2,pt=!1,_n=e)}}else{if(sd(e))throw Error(pe(418));e.flags=e.flags&-4097|2,pt=!1,_n=e}}}function gf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_n=e}function jo(e){if(e!==_n)return!1;if(!pt)return gf(e),pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!td(e.type,e.memoizedProps)),t&&(t=xn)){if(sd(e))throw Am(),Error(pe(418));for(;t;)Rm(e,t),t=ri(t.nextSibling)}if(gf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){xn=ri(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}xn=null}}else xn=_n?ri(e.stateNode.nextSibling):null;return!0}function Am(){for(var e=xn;e;)e=ri(e.nextSibling)}function Ps(){xn=_n=null,pt=!1}function ou(e){Zn===null?Zn=[e]:Zn.push(e)}var j_=Ar.ReactCurrentBatchConfig;function ra(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var s=n.stateNode}if(!s)throw Error(pe(147,e));var o=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(l){var d=o.refs;l===null?delete d[a]:d[a]=l},t._stringRef=a,t)}if(typeof e!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,e))}return e}function So(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yf(e){var t=e._init;return t(e._payload)}function Mm(e){function t(j,x){if(e){var N=j.deletions;N===null?(j.deletions=[x],j.flags|=16):N.push(x)}}function n(j,x){if(!e)return null;for(;x!==null;)t(j,x),x=x.sibling;return null}function s(j,x){for(j=new Map;x!==null;)x.key!==null?j.set(x.key,x):j.set(x.index,x),x=x.sibling;return j}function o(j,x){return j=oi(j,x),j.index=0,j.sibling=null,j}function a(j,x,N){return j.index=N,e?(N=j.alternate,N!==null?(N=N.index,N<x?(j.flags|=2,x):N):(j.flags|=2,x)):(j.flags|=1048576,x)}function l(j){return e&&j.alternate===null&&(j.flags|=2),j}function d(j,x,N,b){return x===null||x.tag!==6?(x=wc(N,j.mode,b),x.return=j,x):(x=o(x,N),x.return=j,x)}function u(j,x,N,b){var P=N.type;return P===us?m(j,x,N.props.children,b,N.key):x!==null&&(x.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===qr&&yf(P)===x.type)?(b=o(x,N.props),b.ref=ra(j,x,N),b.return=j,b):(b=Do(N.type,N.key,N.props,null,j.mode,b),b.ref=ra(j,x,N),b.return=j,b)}function f(j,x,N,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==N.containerInfo||x.stateNode.implementation!==N.implementation?(x=jc(N,j.mode,b),x.return=j,x):(x=o(x,N.children||[]),x.return=j,x)}function m(j,x,N,b,P){return x===null||x.tag!==7?(x=Ri(N,j.mode,b,P),x.return=j,x):(x=o(x,N),x.return=j,x)}function g(j,x,N){if(typeof x=="string"&&x!==""||typeof x=="number")return x=wc(""+x,j.mode,N),x.return=j,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ho:return N=Do(x.type,x.key,x.props,null,j.mode,N),N.ref=ra(j,null,x),N.return=j,N;case ds:return x=jc(x,j.mode,N),x.return=j,x;case qr:var b=x._init;return g(j,b(x._payload),N)}if(ca(x)||Qs(x))return x=Ri(x,j.mode,N,null),x.return=j,x;So(j,x)}return null}function y(j,x,N,b){var P=x!==null?x.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return P!==null?null:d(j,x,""+N,b);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ho:return N.key===P?u(j,x,N,b):null;case ds:return N.key===P?f(j,x,N,b):null;case qr:return P=N._init,y(j,x,P(N._payload),b)}if(ca(N)||Qs(N))return P!==null?null:m(j,x,N,b,null);So(j,N)}return null}function k(j,x,N,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return j=j.get(N)||null,d(x,j,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ho:return j=j.get(b.key===null?N:b.key)||null,u(x,j,b,P);case ds:return j=j.get(b.key===null?N:b.key)||null,f(x,j,b,P);case qr:var T=b._init;return k(j,x,N,T(b._payload),P)}if(ca(b)||Qs(b))return j=j.get(N)||null,m(x,j,b,P,null);So(x,b)}return null}function S(j,x,N,b){for(var P=null,T=null,R=x,B=x=0,U=null;R!==null&&B<N.length;B++){R.index>B?(U=R,R=null):U=R.sibling;var E=y(j,R,N[B],b);if(E===null){R===null&&(R=U);break}e&&R&&E.alternate===null&&t(j,R),x=a(E,x,B),T===null?P=E:T.sibling=E,T=E,R=U}if(B===N.length)return n(j,R),pt&&bi(j,B),P;if(R===null){for(;B<N.length;B++)R=g(j,N[B],b),R!==null&&(x=a(R,x,B),T===null?P=R:T.sibling=R,T=R);return pt&&bi(j,B),P}for(R=s(j,R);B<N.length;B++)U=k(R,j,B,N[B],b),U!==null&&(e&&U.alternate!==null&&R.delete(U.key===null?B:U.key),x=a(U,x,B),T===null?P=U:T.sibling=U,T=U);return e&&R.forEach(function(A){return t(j,A)}),pt&&bi(j,B),P}function _(j,x,N,b){var P=Qs(N);if(typeof P!="function")throw Error(pe(150));if(N=P.call(N),N==null)throw Error(pe(151));for(var T=P=null,R=x,B=x=0,U=null,E=N.next();R!==null&&!E.done;B++,E=N.next()){R.index>B?(U=R,R=null):U=R.sibling;var A=y(j,R,E.value,b);if(A===null){R===null&&(R=U);break}e&&R&&A.alternate===null&&t(j,R),x=a(A,x,B),T===null?P=A:T.sibling=A,T=A,R=U}if(E.done)return n(j,R),pt&&bi(j,B),P;if(R===null){for(;!E.done;B++,E=N.next())E=g(j,E.value,b),E!==null&&(x=a(E,x,B),T===null?P=E:T.sibling=E,T=E);return pt&&bi(j,B),P}for(R=s(j,R);!E.done;B++,E=N.next())E=k(R,j,B,E.value,b),E!==null&&(e&&E.alternate!==null&&R.delete(E.key===null?B:E.key),x=a(E,x,B),T===null?P=E:T.sibling=E,T=E);return e&&R.forEach(function(H){return t(j,H)}),pt&&bi(j,B),P}function C(j,x,N,b){if(typeof N=="object"&&N!==null&&N.type===us&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case ho:e:{for(var P=N.key,T=x;T!==null;){if(T.key===P){if(P=N.type,P===us){if(T.tag===7){n(j,T.sibling),x=o(T,N.props.children),x.return=j,j=x;break e}}else if(T.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===qr&&yf(P)===T.type){n(j,T.sibling),x=o(T,N.props),x.ref=ra(j,T,N),x.return=j,j=x;break e}n(j,T);break}else t(j,T);T=T.sibling}N.type===us?(x=Ri(N.props.children,j.mode,b,N.key),x.return=j,j=x):(b=Do(N.type,N.key,N.props,null,j.mode,b),b.ref=ra(j,x,N),b.return=j,j=b)}return l(j);case ds:e:{for(T=N.key;x!==null;){if(x.key===T)if(x.tag===4&&x.stateNode.containerInfo===N.containerInfo&&x.stateNode.implementation===N.implementation){n(j,x.sibling),x=o(x,N.children||[]),x.return=j,j=x;break e}else{n(j,x);break}else t(j,x);x=x.sibling}x=jc(N,j.mode,b),x.return=j,j=x}return l(j);case qr:return T=N._init,C(j,x,T(N._payload),b)}if(ca(N))return S(j,x,N,b);if(Qs(N))return _(j,x,N,b);So(j,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,x!==null&&x.tag===6?(n(j,x.sibling),x=o(x,N),x.return=j,j=x):(n(j,x),x=wc(N,j.mode,b),x.return=j,j=x),l(j)):n(j,x)}return C}var Es=Mm(!0),Fm=Mm(!1),il=hi(null),sl=null,xs=null,lu=null;function cu(){lu=xs=sl=null}function du(e){var t=il.current;ht(il),e._currentValue=t}function od(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function ks(e,t){sl=e,lu=xs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(cn=!0),e.firstContext=null)}function Rn(e){var t=e._currentValue;if(lu!==e)if(e={context:e,memoizedValue:t,next:null},xs===null){if(sl===null)throw Error(pe(308));xs=e,sl.dependencies={lanes:0,firstContext:e}}else xs=xs.next=e;return t}var Pi=null;function uu(e){Pi===null?Pi=[e]:Pi.push(e)}function Um(e,t,n,s){var o=t.interleaved;return o===null?(n.next=n,uu(t)):(n.next=o.next,o.next=n),t.interleaved=n,Br(e,s)}function Br(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Gr=!1;function hu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Om(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ii(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Qe&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,Br(e,n)}return o=s.interleaved,o===null?(t.next=t,uu(s)):(t.next=o.next,o.next=t),s.interleaved=t,Br(e,n)}function Ao(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Jd(e,n)}}function vf(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var o=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?o=a=l:a=a.next=l,n=n.next}while(n!==null);a===null?o=a=t:a=a.next=t}else o=a=t;n={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function al(e,t,n,s){var o=e.updateQueue;Gr=!1;var a=o.firstBaseUpdate,l=o.lastBaseUpdate,d=o.shared.pending;if(d!==null){o.shared.pending=null;var u=d,f=u.next;u.next=null,l===null?a=f:l.next=f,l=u;var m=e.alternate;m!==null&&(m=m.updateQueue,d=m.lastBaseUpdate,d!==l&&(d===null?m.firstBaseUpdate=f:d.next=f,m.lastBaseUpdate=u))}if(a!==null){var g=o.baseState;l=0,m=f=u=null,d=a;do{var y=d.lane,k=d.eventTime;if((s&y)===y){m!==null&&(m=m.next={eventTime:k,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var S=e,_=d;switch(y=t,k=n,_.tag){case 1:if(S=_.payload,typeof S=="function"){g=S.call(k,g,y);break e}g=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=_.payload,y=typeof S=="function"?S.call(k,g,y):S,y==null)break e;g=xt({},g,y);break e;case 2:Gr=!0}}d.callback!==null&&d.lane!==0&&(e.flags|=64,y=o.effects,y===null?o.effects=[d]:y.push(d))}else k={eventTime:k,lane:y,tag:d.tag,payload:d.payload,callback:d.callback,next:null},m===null?(f=m=k,u=g):m=m.next=k,l|=y;if(d=d.next,d===null){if(d=o.shared.pending,d===null)break;y=d,d=y.next,y.next=null,o.lastBaseUpdate=y,o.shared.pending=null}}while(!0);if(m===null&&(u=g),o.baseState=u,o.firstBaseUpdate=f,o.lastBaseUpdate=m,t=o.shared.interleaved,t!==null){o=t;do l|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Oi|=l,e.lanes=l,e.memoizedState=g}}function xf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=n,typeof o!="function")throw Error(pe(191,o));o.call(s)}}}var Za={},ur=hi(Za),Ta=hi(Za),Ba=hi(Za);function Ei(e){if(e===Za)throw Error(pe(174));return e}function fu(e,t){switch(dt(Ba,t),dt(Ta,e),dt(ur,Za),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Dc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Dc(t,e)}ht(ur),dt(ur,t)}function Ts(){ht(ur),ht(Ta),ht(Ba)}function zm(e){Ei(Ba.current);var t=Ei(ur.current),n=Dc(t,e.type);t!==n&&(dt(Ta,e),dt(ur,n))}function pu(e){Ta.current===e&&(ht(ur),ht(Ta))}var yt=hi(0);function ol(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var mc=[];function mu(){for(var e=0;e<mc.length;e++)mc[e]._workInProgressVersionPrimary=null;mc.length=0}var Mo=Ar.ReactCurrentDispatcher,gc=Ar.ReactCurrentBatchConfig,Ui=0,vt=null,Pt=null,Ft=null,ll=!1,ya=!1,Ra=0,S_=0;function Zt(){throw Error(pe(321))}function gu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function yu(e,t,n,s,o,a){if(Ui=a,vt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mo.current=e===null||e.memoizedState===null?b_:I_,e=n(s,o),ya){a=0;do{if(ya=!1,Ra=0,25<=a)throw Error(pe(301));a+=1,Ft=Pt=null,t.updateQueue=null,Mo.current=L_,e=n(s,o)}while(ya)}if(Mo.current=cl,t=Pt!==null&&Pt.next!==null,Ui=0,Ft=Pt=vt=null,ll=!1,t)throw Error(pe(300));return e}function vu(){var e=Ra!==0;return Ra=0,e}function lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?vt.memoizedState=Ft=e:Ft=Ft.next=e,Ft}function An(){if(Pt===null){var e=vt.alternate;e=e!==null?e.memoizedState:null}else e=Pt.next;var t=Ft===null?vt.memoizedState:Ft.next;if(t!==null)Ft=t,Pt=e;else{if(e===null)throw Error(pe(310));Pt=e,e={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Ft===null?vt.memoizedState=Ft=e:Ft=Ft.next=e}return Ft}function Aa(e,t){return typeof t=="function"?t(e):t}function yc(e){var t=An(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=Pt,o=s.baseQueue,a=n.pending;if(a!==null){if(o!==null){var l=o.next;o.next=a.next,a.next=l}s.baseQueue=o=a,n.pending=null}if(o!==null){a=o.next,s=s.baseState;var d=l=null,u=null,f=a;do{var m=f.lane;if((Ui&m)===m)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),s=f.hasEagerState?f.eagerState:e(s,f.action);else{var g={lane:m,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(d=u=g,l=s):u=u.next=g,vt.lanes|=m,Oi|=m}f=f.next}while(f!==null&&f!==a);u===null?l=s:u.next=d,Yn(s,t.memoizedState)||(cn=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=u,n.lastRenderedState=s}if(e=n.interleaved,e!==null){o=e;do a=o.lane,vt.lanes|=a,Oi|=a,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vc(e){var t=An(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=n.dispatch,o=n.pending,a=t.memoizedState;if(o!==null){n.pending=null;var l=o=o.next;do a=e(a,l.action),l=l.next;while(l!==o);Yn(a,t.memoizedState)||(cn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,s]}function Dm(){}function $m(e,t){var n=vt,s=An(),o=t(),a=!Yn(s.memoizedState,o);if(a&&(s.memoizedState=o,cn=!0),s=s.queue,xu(Zm.bind(null,n,s,e),[e]),s.getSnapshot!==t||a||Ft!==null&&Ft.memoizedState.tag&1){if(n.flags|=2048,Ma(9,Hm.bind(null,n,s,o,t),void 0,null),Ut===null)throw Error(pe(349));Ui&30||Wm(n,t,o)}return o}function Wm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Hm(e,t,n,s){t.value=n,t.getSnapshot=s,Vm(t)&&qm(e)}function Zm(e,t,n){return n(function(){Vm(t)&&qm(e)})}function Vm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch{return!0}}function qm(e){var t=Br(e,1);t!==null&&Gn(t,e,1,-1)}function _f(e){var t=lr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:e},t.queue=e,e=e.dispatch=k_.bind(null,vt,e),[t.memoizedState,e]}function Ma(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=vt.updateQueue,t===null?(t={lastEffect:null,stores:null},vt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Gm(){return An().memoizedState}function Fo(e,t,n,s){var o=lr();vt.flags|=e,o.memoizedState=Ma(1|t,n,void 0,s===void 0?null:s)}function Cl(e,t,n,s){var o=An();s=s===void 0?null:s;var a=void 0;if(Pt!==null){var l=Pt.memoizedState;if(a=l.destroy,s!==null&&gu(s,l.deps)){o.memoizedState=Ma(t,n,a,s);return}}vt.flags|=e,o.memoizedState=Ma(1|t,n,a,s)}function wf(e,t){return Fo(8390656,8,e,t)}function xu(e,t){return Cl(2048,8,e,t)}function Ym(e,t){return Cl(4,2,e,t)}function Km(e,t){return Cl(4,4,e,t)}function Jm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Qm(e,t,n){return n=n!=null?n.concat([e]):null,Cl(4,4,Jm.bind(null,t,e),n)}function _u(){}function Xm(e,t){var n=An();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&gu(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function eg(e,t){var n=An();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&gu(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function tg(e,t,n){return Ui&21?(Yn(n,t)||(n=am(),vt.lanes|=n,Oi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,cn=!0),e.memoizedState=n)}function C_(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var s=gc.transition;gc.transition={};try{e(!1),t()}finally{at=n,gc.transition=s}}function ng(){return An().memoizedState}function N_(e,t,n){var s=ai(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},rg(e))ig(t,n);else if(n=Um(e,t,n,s),n!==null){var o=tn();Gn(n,e,s,o),sg(n,t,s)}}function k_(e,t,n){var s=ai(e),o={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(rg(e))ig(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var l=t.lastRenderedState,d=a(l,n);if(o.hasEagerState=!0,o.eagerState=d,Yn(d,l)){var u=t.interleaved;u===null?(o.next=o,uu(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Um(e,t,o,s),n!==null&&(o=tn(),Gn(n,e,s,o),sg(n,t,s))}}function rg(e){var t=e.alternate;return e===vt||t!==null&&t===vt}function ig(e,t){ya=ll=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sg(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Jd(e,n)}}var cl={readContext:Rn,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},b_={readContext:Rn,useCallback:function(e,t){return lr().memoizedState=[e,t===void 0?null:t],e},useContext:Rn,useEffect:wf,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Fo(4194308,4,Jm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=lr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=lr();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=N_.bind(null,vt,e),[s.memoizedState,e]},useRef:function(e){var t=lr();return e={current:e},t.memoizedState=e},useState:_f,useDebugValue:_u,useDeferredValue:function(e){return lr().memoizedState=e},useTransition:function(){var e=_f(!1),t=e[0];return e=C_.bind(null,e[1]),lr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=vt,o=lr();if(pt){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=t(),Ut===null)throw Error(pe(349));Ui&30||Wm(s,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,wf(Zm.bind(null,s,a,e),[e]),s.flags|=2048,Ma(9,Hm.bind(null,s,a,n,t),void 0,null),n},useId:function(){var e=lr(),t=Ut.identifierPrefix;if(pt){var n=br,s=kr;n=(s&~(1<<32-qn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ra++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=S_++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},I_={readContext:Rn,useCallback:Xm,useContext:Rn,useEffect:xu,useImperativeHandle:Qm,useInsertionEffect:Ym,useLayoutEffect:Km,useMemo:eg,useReducer:yc,useRef:Gm,useState:function(){return yc(Aa)},useDebugValue:_u,useDeferredValue:function(e){var t=An();return tg(t,Pt.memoizedState,e)},useTransition:function(){var e=yc(Aa)[0],t=An().memoizedState;return[e,t]},useMutableSource:Dm,useSyncExternalStore:$m,useId:ng,unstable_isNewReconciler:!1},L_={readContext:Rn,useCallback:Xm,useContext:Rn,useEffect:xu,useImperativeHandle:Qm,useInsertionEffect:Ym,useLayoutEffect:Km,useMemo:eg,useReducer:vc,useRef:Gm,useState:function(){return vc(Aa)},useDebugValue:_u,useDeferredValue:function(e){var t=An();return Pt===null?t.memoizedState=e:tg(t,Pt.memoizedState,e)},useTransition:function(){var e=vc(Aa)[0],t=An().memoizedState;return[e,t]},useMutableSource:Dm,useSyncExternalStore:$m,useId:ng,unstable_isNewReconciler:!1};function Wn(e,t){if(e&&e.defaultProps){t=xt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ld(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:xt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Nl={isMounted:function(e){return(e=e._reactInternals)?Wi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=tn(),o=ai(e),a=Lr(s,o);a.payload=t,n!=null&&(a.callback=n),t=ii(e,a,o),t!==null&&(Gn(t,e,o,s),Ao(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=tn(),o=ai(e),a=Lr(s,o);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=ii(e,a,o),t!==null&&(Gn(t,e,o,s),Ao(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tn(),s=ai(e),o=Lr(n,s);o.tag=2,t!=null&&(o.callback=t),t=ii(e,o,s),t!==null&&(Gn(t,e,s,n),Ao(t,e,s))}};function jf(e,t,n,s,o,a,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,l):t.prototype&&t.prototype.isPureReactComponent?!Ia(n,s)||!Ia(o,a):!0}function ag(e,t,n){var s=!1,o=di,a=t.contextType;return typeof a=="object"&&a!==null?a=Rn(a):(o=un(t)?Mi:Kt.current,s=t.contextTypes,a=(s=s!=null)?Ls(e,o):di),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Nl,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function Sf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Nl.enqueueReplaceState(t,t.state,null)}function cd(e,t,n,s){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},hu(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=Rn(a):(a=un(t)?Mi:Kt.current,o.context=Ls(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(ld(e,t,a,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Nl.enqueueReplaceState(o,o.state,null),al(e,n,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Bs(e,t){try{var n="",s=t;do n+=rx(s),s=s.return;while(s);var o=n}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function xc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function dd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var P_=typeof WeakMap=="function"?WeakMap:Map;function og(e,t,n){n=Lr(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){ul||(ul=!0,_d=s),dd(e,t)},n}function lg(e,t,n){n=Lr(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;n.payload=function(){return s(o)},n.callback=function(){dd(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){dd(e,t),typeof s!="function"&&(si===null?si=new Set([this]):si.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Cf(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new P_;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(n)||(o.add(n),e=H_.bind(null,e,t,n),t.then(e,e))}function Nf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function kf(e,t,n,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Lr(-1,1),t.tag=2,ii(n,t,1))),n.lanes|=1),e)}var E_=Ar.ReactCurrentOwner,cn=!1;function Xt(e,t,n,s){t.child=e===null?Fm(t,null,n,s):Es(t,e.child,n,s)}function bf(e,t,n,s,o){n=n.render;var a=t.ref;return ks(t,o),s=yu(e,t,n,s,a,o),n=vu(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Rr(e,t,o)):(pt&&n&&su(t),t.flags|=1,Xt(e,t,s,o),t.child)}function If(e,t,n,s,o){if(e===null){var a=n.type;return typeof a=="function"&&!Iu(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,cg(e,t,a,s,o)):(e=Do(n.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var l=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ia,n(l,s)&&e.ref===t.ref)return Rr(e,t,o)}return t.flags|=1,e=oi(a,s),e.ref=t.ref,e.return=t,t.child=e}function cg(e,t,n,s,o){if(e!==null){var a=e.memoizedProps;if(Ia(a,s)&&e.ref===t.ref)if(cn=!1,t.pendingProps=s=a,(e.lanes&o)!==0)e.flags&131072&&(cn=!0);else return t.lanes=e.lanes,Rr(e,t,o)}return ud(e,t,n,s,o)}function dg(e,t,n){var s=t.pendingProps,o=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(ws,vn),vn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dt(ws,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:n,dt(ws,vn),vn|=s}else a!==null?(s=a.baseLanes|n,t.memoizedState=null):s=n,dt(ws,vn),vn|=s;return Xt(e,t,o,n),t.child}function ug(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ud(e,t,n,s,o){var a=un(n)?Mi:Kt.current;return a=Ls(t,a),ks(t,o),n=yu(e,t,n,s,a,o),s=vu(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Rr(e,t,o)):(pt&&s&&su(t),t.flags|=1,Xt(e,t,n,o),t.child)}function Lf(e,t,n,s,o){if(un(n)){var a=!0;tl(t)}else a=!1;if(ks(t,o),t.stateNode===null)Uo(e,t),ag(t,n,s),cd(t,n,s,o),s=!0;else if(e===null){var l=t.stateNode,d=t.memoizedProps;l.props=d;var u=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Rn(f):(f=un(n)?Mi:Kt.current,f=Ls(t,f));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";g||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(d!==s||u!==f)&&Sf(t,l,s,f),Gr=!1;var y=t.memoizedState;l.state=y,al(t,s,l,o),u=t.memoizedState,d!==s||y!==u||dn.current||Gr?(typeof m=="function"&&(ld(t,n,m,s),u=t.memoizedState),(d=Gr||jf(t,n,d,s,y,u,f))?(g||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=u),l.props=s,l.state=u,l.context=f,s=d):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{l=t.stateNode,Om(e,t),d=t.memoizedProps,f=t.type===t.elementType?d:Wn(t.type,d),l.props=f,g=t.pendingProps,y=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=Rn(u):(u=un(n)?Mi:Kt.current,u=Ls(t,u));var k=n.getDerivedStateFromProps;(m=typeof k=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(d!==g||y!==u)&&Sf(t,l,s,u),Gr=!1,y=t.memoizedState,l.state=y,al(t,s,l,o);var S=t.memoizedState;d!==g||y!==S||dn.current||Gr?(typeof k=="function"&&(ld(t,n,k,s),S=t.memoizedState),(f=Gr||jf(t,n,f,s,y,S,u)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,S,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,S,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=S),l.props=s,l.state=S,l.context=u,s=f):(typeof l.componentDidUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),s=!1)}return hd(e,t,n,s,a,o)}function hd(e,t,n,s,o,a){ug(e,t);var l=(t.flags&128)!==0;if(!s&&!l)return o&&pf(t,n,!1),Rr(e,t,a);s=t.stateNode,E_.current=t;var d=l&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&l?(t.child=Es(t,e.child,null,a),t.child=Es(t,null,d,a)):Xt(e,t,d,a),t.memoizedState=s.state,o&&pf(t,n,!0),t.child}function hg(e){var t=e.stateNode;t.pendingContext?ff(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ff(e,t.context,!1),fu(e,t.containerInfo)}function Pf(e,t,n,s,o){return Ps(),ou(o),t.flags|=256,Xt(e,t,n,s),t.child}var fd={dehydrated:null,treeContext:null,retryLane:0};function pd(e){return{baseLanes:e,cachePool:null,transitions:null}}function fg(e,t,n){var s=t.pendingProps,o=yt.current,a=!1,l=(t.flags&128)!==0,d;if((d=l)||(d=e!==null&&e.memoizedState===null?!1:(o&2)!==0),d?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),dt(yt,o&1),e===null)return ad(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=Il(l,s,0,null),e=Ri(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=pd(n),t.memoizedState=fd,e):wu(t,l));if(o=e.memoizedState,o!==null&&(d=o.dehydrated,d!==null))return T_(e,t,l,s,d,o,n);if(a){a=s.fallback,l=t.mode,o=e.child,d=o.sibling;var u={mode:"hidden",children:s.children};return!(l&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=u,t.deletions=null):(s=oi(o,u),s.subtreeFlags=o.subtreeFlags&14680064),d!==null?a=oi(d,a):(a=Ri(a,l,n,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=e.child.memoizedState,l=l===null?pd(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=fd,s}return a=e.child,e=a.sibling,s=oi(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function wu(e,t){return t=Il({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Co(e,t,n,s){return s!==null&&ou(s),Es(t,e.child,null,n),e=wu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function T_(e,t,n,s,o,a,l){if(n)return t.flags&256?(t.flags&=-257,s=xc(Error(pe(422))),Co(e,t,l,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,o=t.mode,s=Il({mode:"visible",children:s.children},o,0,null),a=Ri(a,o,l,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&Es(t,e.child,null,l),t.child.memoizedState=pd(l),t.memoizedState=fd,a);if(!(t.mode&1))return Co(e,t,l,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var d=s.dgst;return s=d,a=Error(pe(419)),s=xc(a,s,void 0),Co(e,t,l,s)}if(d=(l&e.childLanes)!==0,cn||d){if(s=Ut,s!==null){switch(l&-l){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|l)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,Br(e,o),Gn(s,e,o,-1))}return bu(),s=xc(Error(pe(421))),Co(e,t,l,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Z_.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,xn=ri(o.nextSibling),_n=t,pt=!0,Zn=null,e!==null&&(Pn[En++]=kr,Pn[En++]=br,Pn[En++]=Fi,kr=e.id,br=e.overflow,Fi=t),t=wu(t,s.children),t.flags|=4096,t)}function Ef(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),od(e.return,t,n)}function _c(e,t,n,s,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=o)}function pg(e,t,n){var s=t.pendingProps,o=s.revealOrder,a=s.tail;if(Xt(e,t,s.children,n),s=yt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ef(e,n,t);else if(e.tag===19)Ef(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(dt(yt,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&ol(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),_c(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&ol(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}_c(t,!0,n,null,a);break;case"together":_c(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Oi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,n=oi(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=oi(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function B_(e,t,n){switch(t.tag){case 3:hg(t),Ps();break;case 5:zm(t);break;case 1:un(t.type)&&tl(t);break;case 4:fu(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;dt(il,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(dt(yt,yt.current&1),t.flags|=128,null):n&t.child.childLanes?fg(e,t,n):(dt(yt,yt.current&1),e=Rr(e,t,n),e!==null?e.sibling:null);dt(yt,yt.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return pg(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),dt(yt,yt.current),s)break;return null;case 22:case 23:return t.lanes=0,dg(e,t,n)}return Rr(e,t,n)}var mg,md,gg,yg;mg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};md=function(){};gg=function(e,t,n,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,Ei(ur.current);var a=null;switch(n){case"input":o=Fc(e,o),s=Fc(e,s),a=[];break;case"select":o=xt({},o,{value:void 0}),s=xt({},s,{value:void 0}),a=[];break;case"textarea":o=zc(e,o),s=zc(e,s),a=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Xo)}$c(n,s);var l;n=null;for(f in o)if(!s.hasOwnProperty(f)&&o.hasOwnProperty(f)&&o[f]!=null)if(f==="style"){var d=o[f];for(l in d)d.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(wa.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in s){var u=s[f];if(d=o!=null?o[f]:void 0,s.hasOwnProperty(f)&&u!==d&&(u!=null||d!=null))if(f==="style")if(d){for(l in d)!d.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&d[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(a||(a=[]),a.push(f,n)),n=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,d=d?d.__html:void 0,u!=null&&d!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(wa.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&ut("scroll",e),a||d===u||(a=[])):(a=a||[]).push(f,u))}n&&(a=a||[]).push("style",n);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};yg=function(e,t,n,s){n!==s&&(t.flags|=4)};function ia(e,t){if(!pt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Vt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function R_(e,t,n){var s=t.pendingProps;switch(au(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(t),null;case 1:return un(t.type)&&el(),Vt(t),null;case 3:return s=t.stateNode,Ts(),ht(dn),ht(Kt),mu(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(jo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zn!==null&&(Sd(Zn),Zn=null))),md(e,t),Vt(t),null;case 5:pu(t);var o=Ei(Ba.current);if(n=t.type,e!==null&&t.stateNode!=null)gg(e,t,n,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(pe(166));return Vt(t),null}if(e=Ei(ur.current),jo(t)){s=t.stateNode,n=t.type;var a=t.memoizedProps;switch(s[cr]=t,s[Ea]=a,e=(t.mode&1)!==0,n){case"dialog":ut("cancel",s),ut("close",s);break;case"iframe":case"object":case"embed":ut("load",s);break;case"video":case"audio":for(o=0;o<ua.length;o++)ut(ua[o],s);break;case"source":ut("error",s);break;case"img":case"image":case"link":ut("error",s),ut("load",s);break;case"details":ut("toggle",s);break;case"input":Oh(s,a),ut("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},ut("invalid",s);break;case"textarea":Dh(s,a),ut("invalid",s)}$c(n,a),o=null;for(var l in a)if(a.hasOwnProperty(l)){var d=a[l];l==="children"?typeof d=="string"?s.textContent!==d&&(a.suppressHydrationWarning!==!0&&wo(s.textContent,d,e),o=["children",d]):typeof d=="number"&&s.textContent!==""+d&&(a.suppressHydrationWarning!==!0&&wo(s.textContent,d,e),o=["children",""+d]):wa.hasOwnProperty(l)&&d!=null&&l==="onScroll"&&ut("scroll",s)}switch(n){case"input":fo(s),zh(s,a,!0);break;case"textarea":fo(s),$h(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Xo)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{l=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Zp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=l.createElement(n,{is:s.is}):(e=l.createElement(n),n==="select"&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,n),e[cr]=t,e[Ea]=s,mg(e,t,!1,!1),t.stateNode=e;e:{switch(l=Wc(n,s),n){case"dialog":ut("cancel",e),ut("close",e),o=s;break;case"iframe":case"object":case"embed":ut("load",e),o=s;break;case"video":case"audio":for(o=0;o<ua.length;o++)ut(ua[o],e);o=s;break;case"source":ut("error",e),o=s;break;case"img":case"image":case"link":ut("error",e),ut("load",e),o=s;break;case"details":ut("toggle",e),o=s;break;case"input":Oh(e,s),o=Fc(e,s),ut("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=xt({},s,{value:void 0}),ut("invalid",e);break;case"textarea":Dh(e,s),o=zc(e,s),ut("invalid",e);break;default:o=s}$c(n,o),d=o;for(a in d)if(d.hasOwnProperty(a)){var u=d[a];a==="style"?Gp(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Vp(e,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ja(e,u):typeof u=="number"&&ja(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(wa.hasOwnProperty(a)?u!=null&&a==="onScroll"&&ut("scroll",e):u!=null&&Zd(e,a,u,l))}switch(n){case"input":fo(e),zh(e,s,!1);break;case"textarea":fo(e),$h(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ci(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?js(e,!!s.multiple,a,!1):s.defaultValue!=null&&js(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Xo)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Vt(t),null;case 6:if(e&&t.stateNode!=null)yg(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(pe(166));if(n=Ei(Ba.current),Ei(ur.current),jo(t)){if(s=t.stateNode,n=t.memoizedProps,s[cr]=t,(a=s.nodeValue!==n)&&(e=_n,e!==null))switch(e.tag){case 3:wo(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wo(s.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[cr]=t,t.stateNode=s}return Vt(t),null;case 13:if(ht(yt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pt&&xn!==null&&t.mode&1&&!(t.flags&128))Am(),Ps(),t.flags|=98560,a=!1;else if(a=jo(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(pe(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(pe(317));a[cr]=t}else Ps(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Vt(t),a=!1}else Zn!==null&&(Sd(Zn),Zn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||yt.current&1?Et===0&&(Et=3):bu())),t.updateQueue!==null&&(t.flags|=4),Vt(t),null);case 4:return Ts(),md(e,t),e===null&&La(t.stateNode.containerInfo),Vt(t),null;case 10:return du(t.type._context),Vt(t),null;case 17:return un(t.type)&&el(),Vt(t),null;case 19:if(ht(yt),a=t.memoizedState,a===null)return Vt(t),null;if(s=(t.flags&128)!==0,l=a.rendering,l===null)if(s)ia(a,!1);else{if(Et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=ol(e),l!==null){for(t.flags|=128,ia(a,!1),s=l.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)a=n,e=s,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return dt(yt,yt.current&1|2),t.child}e=e.sibling}a.tail!==null&&St()>Rs&&(t.flags|=128,s=!0,ia(a,!1),t.lanes=4194304)}else{if(!s)if(e=ol(l),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ia(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!pt)return Vt(t),null}else 2*St()-a.renderingStartTime>Rs&&n!==1073741824&&(t.flags|=128,s=!0,ia(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(n=a.last,n!==null?n.sibling=l:t.child=l,a.last=l)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=St(),t.sibling=null,n=yt.current,dt(yt,s?n&1|2:n&1),t):(Vt(t),null);case 22:case 23:return ku(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?vn&1073741824&&(Vt(t),t.subtreeFlags&6&&(t.flags|=8192)):Vt(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function A_(e,t){switch(au(t),t.tag){case 1:return un(t.type)&&el(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ts(),ht(dn),ht(Kt),mu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pu(t),null;case 13:if(ht(yt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));Ps()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ht(yt),null;case 4:return Ts(),null;case 10:return du(t.type._context),null;case 22:case 23:return ku(),null;case 24:return null;default:return null}}var No=!1,qt=!1,M_=typeof WeakSet=="function"?WeakSet:Set,be=null;function _s(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){_t(e,t,s)}else n.current=null}function gd(e,t,n){try{n()}catch(s){_t(e,t,s)}}var Tf=!1;function F_(e,t){if(Xc=Ko,e=jm(),iu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var o=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var l=0,d=-1,u=-1,f=0,m=0,g=e,y=null;t:for(;;){for(var k;g!==n||o!==0&&g.nodeType!==3||(d=l+o),g!==a||s!==0&&g.nodeType!==3||(u=l+s),g.nodeType===3&&(l+=g.nodeValue.length),(k=g.firstChild)!==null;)y=g,g=k;for(;;){if(g===e)break t;if(y===n&&++f===o&&(d=l),y===a&&++m===s&&(u=l),(k=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=k}n=d===-1||u===-1?null:{start:d,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ed={focusedElem:e,selectionRange:n},Ko=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var S=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var _=S.memoizedProps,C=S.memoizedState,j=t.stateNode,x=j.getSnapshotBeforeUpdate(t.elementType===t.type?_:Wn(t.type,_),C);j.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var N=t.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(b){_t(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return S=Tf,Tf=!1,S}function va(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&gd(t,n,a)}o=o.next}while(o!==s)}}function kl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function yd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function vg(e){var t=e.alternate;t!==null&&(e.alternate=null,vg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[cr],delete t[Ea],delete t[rd],delete t[x_],delete t[__])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xg(e){return e.tag===5||e.tag===3||e.tag===4}function Bf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Xo));else if(s!==4&&(e=e.child,e!==null))for(vd(e,t,n),e=e.sibling;e!==null;)vd(e,t,n),e=e.sibling}function xd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(xd(e,t,n),e=e.sibling;e!==null;)xd(e,t,n),e=e.sibling}var Dt=null,Hn=!1;function Vr(e,t,n){for(n=n.child;n!==null;)_g(e,t,n),n=n.sibling}function _g(e,t,n){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(vl,n)}catch{}switch(n.tag){case 5:qt||_s(n,t);case 6:var s=Dt,o=Hn;Dt=null,Vr(e,t,n),Dt=s,Hn=o,Dt!==null&&(Hn?(e=Dt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(Hn?(e=Dt,n=n.stateNode,e.nodeType===8?fc(e.parentNode,n):e.nodeType===1&&fc(e,n),ka(e)):fc(Dt,n.stateNode));break;case 4:s=Dt,o=Hn,Dt=n.stateNode.containerInfo,Hn=!0,Vr(e,t,n),Dt=s,Hn=o;break;case 0:case 11:case 14:case 15:if(!qt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var a=o,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&gd(n,t,l),o=o.next}while(o!==s)}Vr(e,t,n);break;case 1:if(!qt&&(_s(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(d){_t(n,t,d)}Vr(e,t,n);break;case 21:Vr(e,t,n);break;case 22:n.mode&1?(qt=(s=qt)||n.memoizedState!==null,Vr(e,t,n),qt=s):Vr(e,t,n);break;default:Vr(e,t,n)}}function Rf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new M_),t.forEach(function(s){var o=V_.bind(null,e,s);n.has(s)||(n.add(s),s.then(o,o))})}}function $n(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];try{var a=e,l=t,d=l;e:for(;d!==null;){switch(d.tag){case 5:Dt=d.stateNode,Hn=!1;break e;case 3:Dt=d.stateNode.containerInfo,Hn=!0;break e;case 4:Dt=d.stateNode.containerInfo,Hn=!0;break e}d=d.return}if(Dt===null)throw Error(pe(160));_g(a,l,o),Dt=null,Hn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(f){_t(o,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)wg(t,e),t=t.sibling}function wg(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($n(t,e),ar(e),s&4){try{va(3,e,e.return),kl(3,e)}catch(_){_t(e,e.return,_)}try{va(5,e,e.return)}catch(_){_t(e,e.return,_)}}break;case 1:$n(t,e),ar(e),s&512&&n!==null&&_s(n,n.return);break;case 5:if($n(t,e),ar(e),s&512&&n!==null&&_s(n,n.return),e.flags&32){var o=e.stateNode;try{ja(o,"")}catch(_){_t(e,e.return,_)}}if(s&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,l=n!==null?n.memoizedProps:a,d=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{d==="input"&&a.type==="radio"&&a.name!=null&&Wp(o,a),Wc(d,l);var f=Wc(d,a);for(l=0;l<u.length;l+=2){var m=u[l],g=u[l+1];m==="style"?Gp(o,g):m==="dangerouslySetInnerHTML"?Vp(o,g):m==="children"?ja(o,g):Zd(o,m,g,f)}switch(d){case"input":Uc(o,a);break;case"textarea":Hp(o,a);break;case"select":var y=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var k=a.value;k!=null?js(o,!!a.multiple,k,!1):y!==!!a.multiple&&(a.defaultValue!=null?js(o,!!a.multiple,a.defaultValue,!0):js(o,!!a.multiple,a.multiple?[]:"",!1))}o[Ea]=a}catch(_){_t(e,e.return,_)}}break;case 6:if($n(t,e),ar(e),s&4){if(e.stateNode===null)throw Error(pe(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(_){_t(e,e.return,_)}}break;case 3:if($n(t,e),ar(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{ka(t.containerInfo)}catch(_){_t(e,e.return,_)}break;case 4:$n(t,e),ar(e);break;case 13:$n(t,e),ar(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(Cu=St())),s&4&&Rf(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(qt=(f=qt)||m,$n(t,e),qt=f):$n(t,e),ar(e),s&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!m&&e.mode&1)for(be=e,m=e.child;m!==null;){for(g=be=m;be!==null;){switch(y=be,k=y.child,y.tag){case 0:case 11:case 14:case 15:va(4,y,y.return);break;case 1:_s(y,y.return);var S=y.stateNode;if(typeof S.componentWillUnmount=="function"){s=y,n=y.return;try{t=s,S.props=t.memoizedProps,S.state=t.memoizedState,S.componentWillUnmount()}catch(_){_t(s,n,_)}}break;case 5:_s(y,y.return);break;case 22:if(y.memoizedState!==null){Mf(g);continue}}k!==null?(k.return=y,be=k):Mf(g)}m=m.sibling}e:for(m=null,g=e;;){if(g.tag===5){if(m===null){m=g;try{o=g.stateNode,f?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(d=g.stateNode,u=g.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,d.style.display=qp("display",l))}catch(_){_t(e,e.return,_)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=f?"":g.memoizedProps}catch(_){_t(e,e.return,_)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:$n(t,e),ar(e),s&4&&Rf(e);break;case 21:break;default:$n(t,e),ar(e)}}function ar(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(xg(n)){var s=n;break e}n=n.return}throw Error(pe(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ja(o,""),s.flags&=-33);var a=Bf(e);xd(e,a,o);break;case 3:case 4:var l=s.stateNode.containerInfo,d=Bf(e);vd(e,d,l);break;default:throw Error(pe(161))}}catch(u){_t(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function U_(e,t,n){be=e,jg(e)}function jg(e,t,n){for(var s=(e.mode&1)!==0;be!==null;){var o=be,a=o.child;if(o.tag===22&&s){var l=o.memoizedState!==null||No;if(!l){var d=o.alternate,u=d!==null&&d.memoizedState!==null||qt;d=No;var f=qt;if(No=l,(qt=u)&&!f)for(be=o;be!==null;)l=be,u=l.child,l.tag===22&&l.memoizedState!==null?Ff(o):u!==null?(u.return=l,be=u):Ff(o);for(;a!==null;)be=a,jg(a),a=a.sibling;be=o,No=d,qt=f}Af(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,be=a):Af(e)}}function Af(e){for(;be!==null;){var t=be;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:qt||kl(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!qt)if(n===null)s.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Wn(t.type,n.memoizedProps);s.componentDidUpdate(o,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&xf(t,a,s);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}xf(t,l,n)}break;case 5:var d=t.stateNode;if(n===null&&t.flags&4){n=d;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var m=f.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&ka(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}qt||t.flags&512&&yd(t)}catch(y){_t(t,t.return,y)}}if(t===e){be=null;break}if(n=t.sibling,n!==null){n.return=t.return,be=n;break}be=t.return}}function Mf(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var n=t.sibling;if(n!==null){n.return=t.return,be=n;break}be=t.return}}function Ff(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{kl(4,t)}catch(u){_t(t,n,u)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(u){_t(t,o,u)}}var a=t.return;try{yd(t)}catch(u){_t(t,a,u)}break;case 5:var l=t.return;try{yd(t)}catch(u){_t(t,l,u)}}}catch(u){_t(t,t.return,u)}if(t===e){be=null;break}var d=t.sibling;if(d!==null){d.return=t.return,be=d;break}be=t.return}}var O_=Math.ceil,dl=Ar.ReactCurrentDispatcher,ju=Ar.ReactCurrentOwner,Bn=Ar.ReactCurrentBatchConfig,Qe=0,Ut=null,It=null,$t=0,vn=0,ws=hi(0),Et=0,Fa=null,Oi=0,bl=0,Su=0,xa=null,ln=null,Cu=0,Rs=1/0,Cr=null,ul=!1,_d=null,si=null,ko=!1,Qr=null,hl=0,_a=0,wd=null,Oo=-1,zo=0;function tn(){return Qe&6?St():Oo!==-1?Oo:Oo=St()}function ai(e){return e.mode&1?Qe&2&&$t!==0?$t&-$t:j_.transition!==null?(zo===0&&(zo=am()),zo):(e=at,e!==0||(e=window.event,e=e===void 0?16:fm(e.type)),e):1}function Gn(e,t,n,s){if(50<_a)throw _a=0,wd=null,Error(pe(185));$a(e,n,s),(!(Qe&2)||e!==Ut)&&(e===Ut&&(!(Qe&2)&&(bl|=n),Et===4&&Kr(e,$t)),hn(e,s),n===1&&Qe===0&&!(t.mode&1)&&(Rs=St()+500,Sl&&fi()))}function hn(e,t){var n=e.callbackNode;jx(e,t);var s=Yo(e,e===Ut?$t:0);if(s===0)n!==null&&Zh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Zh(n),t===1)e.tag===0?w_(Uf.bind(null,e)):Tm(Uf.bind(null,e)),y_(function(){!(Qe&6)&&fi()}),n=null;else{switch(om(s)){case 1:n=Kd;break;case 4:n=im;break;case 16:n=Go;break;case 536870912:n=sm;break;default:n=Go}n=Pg(n,Sg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Sg(e,t){if(Oo=-1,zo=0,Qe&6)throw Error(pe(327));var n=e.callbackNode;if(bs()&&e.callbackNode!==n)return null;var s=Yo(e,e===Ut?$t:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=fl(e,s);else{t=s;var o=Qe;Qe|=2;var a=Ng();(Ut!==e||$t!==t)&&(Cr=null,Rs=St()+500,Bi(e,t));do try{$_();break}catch(d){Cg(e,d)}while(!0);cu(),dl.current=a,Qe=o,It!==null?t=0:(Ut=null,$t=0,t=Et)}if(t!==0){if(t===2&&(o=Gc(e),o!==0&&(s=o,t=jd(e,o))),t===1)throw n=Fa,Bi(e,0),Kr(e,s),hn(e,St()),n;if(t===6)Kr(e,s);else{if(o=e.current.alternate,!(s&30)&&!z_(o)&&(t=fl(e,s),t===2&&(a=Gc(e),a!==0&&(s=a,t=jd(e,a))),t===1))throw n=Fa,Bi(e,0),Kr(e,s),hn(e,St()),n;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(pe(345));case 2:Ii(e,ln,Cr);break;case 3:if(Kr(e,s),(s&130023424)===s&&(t=Cu+500-St(),10<t)){if(Yo(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){tn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=nd(Ii.bind(null,e,ln,Cr),t);break}Ii(e,ln,Cr);break;case 4:if(Kr(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var l=31-qn(s);a=1<<l,l=t[l],l>o&&(o=l),s&=~a}if(s=o,s=St()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*O_(s/1960))-s,10<s){e.timeoutHandle=nd(Ii.bind(null,e,ln,Cr),s);break}Ii(e,ln,Cr);break;case 5:Ii(e,ln,Cr);break;default:throw Error(pe(329))}}}return hn(e,St()),e.callbackNode===n?Sg.bind(null,e):null}function jd(e,t){var n=xa;return e.current.memoizedState.isDehydrated&&(Bi(e,t).flags|=256),e=fl(e,t),e!==2&&(t=ln,ln=n,t!==null&&Sd(t)),e}function Sd(e){ln===null?ln=e:ln.push.apply(ln,e)}function z_(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var o=n[s],a=o.getSnapshot;o=o.value;try{if(!Yn(a(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kr(e,t){for(t&=~Su,t&=~bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qn(t),s=1<<n;e[n]=-1,t&=~s}}function Uf(e){if(Qe&6)throw Error(pe(327));bs();var t=Yo(e,0);if(!(t&1))return hn(e,St()),null;var n=fl(e,t);if(e.tag!==0&&n===2){var s=Gc(e);s!==0&&(t=s,n=jd(e,s))}if(n===1)throw n=Fa,Bi(e,0),Kr(e,t),hn(e,St()),n;if(n===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ii(e,ln,Cr),hn(e,St()),null}function Nu(e,t){var n=Qe;Qe|=1;try{return e(t)}finally{Qe=n,Qe===0&&(Rs=St()+500,Sl&&fi())}}function zi(e){Qr!==null&&Qr.tag===0&&!(Qe&6)&&bs();var t=Qe;Qe|=1;var n=Bn.transition,s=at;try{if(Bn.transition=null,at=1,e)return e()}finally{at=s,Bn.transition=n,Qe=t,!(Qe&6)&&fi()}}function ku(){vn=ws.current,ht(ws)}function Bi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,g_(n)),It!==null)for(n=It.return;n!==null;){var s=n;switch(au(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&el();break;case 3:Ts(),ht(dn),ht(Kt),mu();break;case 5:pu(s);break;case 4:Ts();break;case 13:ht(yt);break;case 19:ht(yt);break;case 10:du(s.type._context);break;case 22:case 23:ku()}n=n.return}if(Ut=e,It=e=oi(e.current,null),$t=vn=t,Et=0,Fa=null,Su=bl=Oi=0,ln=xa=null,Pi!==null){for(t=0;t<Pi.length;t++)if(n=Pi[t],s=n.interleaved,s!==null){n.interleaved=null;var o=s.next,a=n.pending;if(a!==null){var l=a.next;a.next=o,s.next=l}n.pending=s}Pi=null}return e}function Cg(e,t){do{var n=It;try{if(cu(),Mo.current=cl,ll){for(var s=vt.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}ll=!1}if(Ui=0,Ft=Pt=vt=null,ya=!1,Ra=0,ju.current=null,n===null||n.return===null){Et=1,Fa=t,It=null;break}e:{var a=e,l=n.return,d=n,u=t;if(t=$t,d.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,m=d,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var k=Nf(l);if(k!==null){k.flags&=-257,kf(k,l,d,a,t),k.mode&1&&Cf(a,f,t),t=k,u=f;var S=t.updateQueue;if(S===null){var _=new Set;_.add(u),t.updateQueue=_}else S.add(u);break e}else{if(!(t&1)){Cf(a,f,t),bu();break e}u=Error(pe(426))}}else if(pt&&d.mode&1){var C=Nf(l);if(C!==null){!(C.flags&65536)&&(C.flags|=256),kf(C,l,d,a,t),ou(Bs(u,d));break e}}a=u=Bs(u,d),Et!==4&&(Et=2),xa===null?xa=[a]:xa.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var j=og(a,u,t);vf(a,j);break e;case 1:d=u;var x=a.type,N=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(si===null||!si.has(N)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=lg(a,d,t);vf(a,b);break e}}a=a.return}while(a!==null)}bg(n)}catch(P){t=P,It===n&&n!==null&&(It=n=n.return);continue}break}while(!0)}function Ng(){var e=dl.current;return dl.current=cl,e===null?cl:e}function bu(){(Et===0||Et===3||Et===2)&&(Et=4),Ut===null||!(Oi&268435455)&&!(bl&268435455)||Kr(Ut,$t)}function fl(e,t){var n=Qe;Qe|=2;var s=Ng();(Ut!==e||$t!==t)&&(Cr=null,Bi(e,t));do try{D_();break}catch(o){Cg(e,o)}while(!0);if(cu(),Qe=n,dl.current=s,It!==null)throw Error(pe(261));return Ut=null,$t=0,Et}function D_(){for(;It!==null;)kg(It)}function $_(){for(;It!==null&&!fx();)kg(It)}function kg(e){var t=Lg(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?bg(e):It=t,ju.current=null}function bg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=A_(n,t),n!==null){n.flags&=32767,It=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Et=6,It=null;return}}else if(n=R_(n,t,vn),n!==null){It=n;return}if(t=t.sibling,t!==null){It=t;return}It=t=e}while(t!==null);Et===0&&(Et=5)}function Ii(e,t,n){var s=at,o=Bn.transition;try{Bn.transition=null,at=1,W_(e,t,n,s)}finally{Bn.transition=o,at=s}return null}function W_(e,t,n,s){do bs();while(Qr!==null);if(Qe&6)throw Error(pe(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Sx(e,a),e===Ut&&(It=Ut=null,$t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ko||(ko=!0,Pg(Go,function(){return bs(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Bn.transition,Bn.transition=null;var l=at;at=1;var d=Qe;Qe|=4,ju.current=null,F_(e,n),wg(n,e),c_(ed),Ko=!!Xc,ed=Xc=null,e.current=n,U_(n),px(),Qe=d,at=l,Bn.transition=a}else e.current=n;if(ko&&(ko=!1,Qr=e,hl=o),a=e.pendingLanes,a===0&&(si=null),yx(n.stateNode),hn(e,St()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],s(o.value,{componentStack:o.stack,digest:o.digest});if(ul)throw ul=!1,e=_d,_d=null,e;return hl&1&&e.tag!==0&&bs(),a=e.pendingLanes,a&1?e===wd?_a++:(_a=0,wd=e):_a=0,fi(),null}function bs(){if(Qr!==null){var e=om(hl),t=Bn.transition,n=at;try{if(Bn.transition=null,at=16>e?16:e,Qr===null)var s=!1;else{if(e=Qr,Qr=null,hl=0,Qe&6)throw Error(pe(331));var o=Qe;for(Qe|=4,be=e.current;be!==null;){var a=be,l=a.child;if(be.flags&16){var d=a.deletions;if(d!==null){for(var u=0;u<d.length;u++){var f=d[u];for(be=f;be!==null;){var m=be;switch(m.tag){case 0:case 11:case 15:va(8,m,a)}var g=m.child;if(g!==null)g.return=m,be=g;else for(;be!==null;){m=be;var y=m.sibling,k=m.return;if(vg(m),m===f){be=null;break}if(y!==null){y.return=k,be=y;break}be=k}}}var S=a.alternate;if(S!==null){var _=S.child;if(_!==null){S.child=null;do{var C=_.sibling;_.sibling=null,_=C}while(_!==null)}}be=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,be=l;else e:for(;be!==null;){if(a=be,a.flags&2048)switch(a.tag){case 0:case 11:case 15:va(9,a,a.return)}var j=a.sibling;if(j!==null){j.return=a.return,be=j;break e}be=a.return}}var x=e.current;for(be=x;be!==null;){l=be;var N=l.child;if(l.subtreeFlags&2064&&N!==null)N.return=l,be=N;else e:for(l=x;be!==null;){if(d=be,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:kl(9,d)}}catch(P){_t(d,d.return,P)}if(d===l){be=null;break e}var b=d.sibling;if(b!==null){b.return=d.return,be=b;break e}be=d.return}}if(Qe=o,fi(),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(vl,e)}catch{}s=!0}return s}finally{at=n,Bn.transition=t}}return!1}function Of(e,t,n){t=Bs(n,t),t=og(e,t,1),e=ii(e,t,1),t=tn(),e!==null&&($a(e,1,t),hn(e,t))}function _t(e,t,n){if(e.tag===3)Of(e,e,n);else for(;t!==null;){if(t.tag===3){Of(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(si===null||!si.has(s))){e=Bs(n,e),e=lg(t,e,1),t=ii(t,e,1),e=tn(),t!==null&&($a(t,1,e),hn(t,e));break}}t=t.return}}function H_(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=tn(),e.pingedLanes|=e.suspendedLanes&n,Ut===e&&($t&n)===n&&(Et===4||Et===3&&($t&130023424)===$t&&500>St()-Cu?Bi(e,0):Su|=n),hn(e,t)}function Ig(e,t){t===0&&(e.mode&1?(t=go,go<<=1,!(go&130023424)&&(go=4194304)):t=1);var n=tn();e=Br(e,t),e!==null&&($a(e,t,n),hn(e,n))}function Z_(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ig(e,n)}function V_(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(pe(314))}s!==null&&s.delete(t),Ig(e,n)}var Lg;Lg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||dn.current)cn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return cn=!1,B_(e,t,n);cn=!!(e.flags&131072)}else cn=!1,pt&&t.flags&1048576&&Bm(t,rl,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Uo(e,t),e=t.pendingProps;var o=Ls(t,Kt.current);ks(t,n),o=yu(null,t,s,e,o,n);var a=vu();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,un(s)?(a=!0,tl(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,hu(t),o.updater=Nl,t.stateNode=o,o._reactInternals=t,cd(t,s,e,n),t=hd(null,t,s,!0,a,n)):(t.tag=0,pt&&a&&su(t),Xt(null,t,o,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=G_(s),e=Wn(s,e),o){case 0:t=ud(null,t,s,e,n);break e;case 1:t=Lf(null,t,s,e,n);break e;case 11:t=bf(null,t,s,e,n);break e;case 14:t=If(null,t,s,Wn(s.type,e),n);break e}throw Error(pe(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),ud(e,t,s,o,n);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),Lf(e,t,s,o,n);case 3:e:{if(hg(t),e===null)throw Error(pe(387));s=t.pendingProps,a=t.memoizedState,o=a.element,Om(e,t),al(t,s,null,n);var l=t.memoizedState;if(s=l.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Bs(Error(pe(423)),t),t=Pf(e,t,s,n,o);break e}else if(s!==o){o=Bs(Error(pe(424)),t),t=Pf(e,t,s,n,o);break e}else for(xn=ri(t.stateNode.containerInfo.firstChild),_n=t,pt=!0,Zn=null,n=Fm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ps(),s===o){t=Rr(e,t,n);break e}Xt(e,t,s,n)}t=t.child}return t;case 5:return zm(t),e===null&&ad(t),s=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,l=o.children,td(s,o)?l=null:a!==null&&td(s,a)&&(t.flags|=32),ug(e,t),Xt(e,t,l,n),t.child;case 6:return e===null&&ad(t),null;case 13:return fg(e,t,n);case 4:return fu(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Es(t,null,s,n):Xt(e,t,s,n),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),bf(e,t,s,o,n);case 7:return Xt(e,t,t.pendingProps,n),t.child;case 8:return Xt(e,t,t.pendingProps.children,n),t.child;case 12:return Xt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,a=t.memoizedProps,l=o.value,dt(il,s._currentValue),s._currentValue=l,a!==null)if(Yn(a.value,l)){if(a.children===o.children&&!dn.current){t=Rr(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var d=a.dependencies;if(d!==null){l=a.child;for(var u=d.firstContext;u!==null;){if(u.context===s){if(a.tag===1){u=Lr(-1,n&-n),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var m=f.pending;m===null?u.next=u:(u.next=m.next,m.next=u),f.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),od(a.return,n,t),d.lanes|=n;break}u=u.next}}else if(a.tag===10)l=a.type===t.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(pe(341));l.lanes|=n,d=l.alternate,d!==null&&(d.lanes|=n),od(l,n,t),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===t){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}Xt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,ks(t,n),o=Rn(o),s=s(o),t.flags|=1,Xt(e,t,s,n),t.child;case 14:return s=t.type,o=Wn(s,t.pendingProps),o=Wn(s.type,o),If(e,t,s,o,n);case 15:return cg(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Wn(s,o),Uo(e,t),t.tag=1,un(s)?(e=!0,tl(t)):e=!1,ks(t,n),ag(t,s,o),cd(t,s,o,n),hd(null,t,s,!0,e,n);case 19:return pg(e,t,n);case 22:return dg(e,t,n)}throw Error(pe(156,t.tag))};function Pg(e,t){return rm(e,t)}function q_(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(e,t,n,s){return new q_(e,t,n,s)}function Iu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function G_(e){if(typeof e=="function")return Iu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===qd)return 11;if(e===Gd)return 14}return 2}function oi(e,t){var n=e.alternate;return n===null?(n=Tn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Do(e,t,n,s,o,a){var l=2;if(s=e,typeof e=="function")Iu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case us:return Ri(n.children,o,a,t);case Vd:l=8,o|=8;break;case Bc:return e=Tn(12,n,t,o|2),e.elementType=Bc,e.lanes=a,e;case Rc:return e=Tn(13,n,t,o),e.elementType=Rc,e.lanes=a,e;case Ac:return e=Tn(19,n,t,o),e.elementType=Ac,e.lanes=a,e;case zp:return Il(n,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Up:l=10;break e;case Op:l=9;break e;case qd:l=11;break e;case Gd:l=14;break e;case qr:l=16,s=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=Tn(l,n,t,o),t.elementType=e,t.type=s,t.lanes=a,t}function Ri(e,t,n,s){return e=Tn(7,e,s,t),e.lanes=n,e}function Il(e,t,n,s){return e=Tn(22,e,s,t),e.elementType=zp,e.lanes=n,e.stateNode={isHidden:!1},e}function wc(e,t,n){return e=Tn(6,e,null,t),e.lanes=n,e}function jc(e,t,n){return t=Tn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Y_(e,t,n,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nc(0),this.expirationTimes=nc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nc(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Lu(e,t,n,s,o,a,l,d,u){return e=new Y_(e,t,n,d,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Tn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hu(a),e}function K_(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ds,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Eg(e){if(!e)return di;e=e._reactInternals;e:{if(Wi(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var n=e.type;if(un(n))return Em(e,n,t)}return t}function Tg(e,t,n,s,o,a,l,d,u){return e=Lu(n,s,!0,e,o,a,l,d,u),e.context=Eg(null),n=e.current,s=tn(),o=ai(n),a=Lr(s,o),a.callback=t??null,ii(n,a,o),e.current.lanes=o,$a(e,o,s),hn(e,s),e}function Ll(e,t,n,s){var o=t.current,a=tn(),l=ai(o);return n=Eg(n),t.context===null?t.context=n:t.pendingContext=n,t=Lr(a,l),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ii(o,t,l),e!==null&&(Gn(e,o,l,a),Ao(e,o,l)),l}function pl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pu(e,t){zf(e,t),(e=e.alternate)&&zf(e,t)}function J_(){return null}var Bg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Eu(e){this._internalRoot=e}Pl.prototype.render=Eu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));Ll(e,t,null,null)};Pl.prototype.unmount=Eu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zi(function(){Ll(null,e,null,null)}),t[Tr]=null}};function Pl(e){this._internalRoot=e}Pl.prototype.unstable_scheduleHydration=function(e){if(e){var t=dm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Yr.length&&t!==0&&t<Yr[n].priority;n++);Yr.splice(n,0,e),n===0&&hm(e)}};function Tu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function El(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Df(){}function Q_(e,t,n,s,o){if(o){if(typeof s=="function"){var a=s;s=function(){var f=pl(l);a.call(f)}}var l=Tg(t,s,e,0,null,!1,!1,"",Df);return e._reactRootContainer=l,e[Tr]=l.current,La(e.nodeType===8?e.parentNode:e),zi(),l}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var d=s;s=function(){var f=pl(u);d.call(f)}}var u=Lu(e,0,!1,null,null,!1,!1,"",Df);return e._reactRootContainer=u,e[Tr]=u.current,La(e.nodeType===8?e.parentNode:e),zi(function(){Ll(t,u,n,s)}),u}function Tl(e,t,n,s,o){var a=n._reactRootContainer;if(a){var l=a;if(typeof o=="function"){var d=o;o=function(){var u=pl(l);d.call(u)}}Ll(t,l,e,o)}else l=Q_(n,t,e,o,s);return pl(l)}lm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=da(t.pendingLanes);n!==0&&(Jd(t,n|1),hn(t,St()),!(Qe&6)&&(Rs=St()+500,fi()))}break;case 13:zi(function(){var s=Br(e,1);if(s!==null){var o=tn();Gn(s,e,1,o)}}),Pu(e,1)}};Qd=function(e){if(e.tag===13){var t=Br(e,134217728);if(t!==null){var n=tn();Gn(t,e,134217728,n)}Pu(e,134217728)}};cm=function(e){if(e.tag===13){var t=ai(e),n=Br(e,t);if(n!==null){var s=tn();Gn(n,e,t,s)}Pu(e,t)}};dm=function(){return at};um=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Zc=function(e,t,n){switch(t){case"input":if(Uc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var o=jl(s);if(!o)throw Error(pe(90));$p(s),Uc(s,o)}}}break;case"textarea":Hp(e,n);break;case"select":t=n.value,t!=null&&js(e,!!n.multiple,t,!1)}};Jp=Nu;Qp=zi;var X_={usingClientEntryPoint:!1,Events:[Ha,ms,jl,Yp,Kp,Nu]},sa={findFiberByHostInstance:Li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},e0={bundleType:sa.bundleType,version:sa.version,rendererPackageName:sa.rendererPackageName,rendererConfig:sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ar.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=tm(e),e===null?null:e.stateNode},findFiberByHostInstance:sa.findFiberByHostInstance||J_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{vl=bo.inject(e0),dr=bo}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X_;jn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tu(t))throw Error(pe(200));return K_(e,t,null,n)};jn.createRoot=function(e,t){if(!Tu(e))throw Error(pe(299));var n=!1,s="",o=Bg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Lu(e,1,!1,null,null,n,!1,s,o),e[Tr]=t.current,La(e.nodeType===8?e.parentNode:e),new Eu(t)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=tm(t),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return zi(e)};jn.hydrate=function(e,t,n){if(!El(t))throw Error(pe(200));return Tl(null,e,t,!0,n)};jn.hydrateRoot=function(e,t,n){if(!Tu(e))throw Error(pe(405));var s=n!=null&&n.hydratedSources||null,o=!1,a="",l=Bg;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Tg(t,null,e,1,n??null,o,!1,a,l),e[Tr]=t.current,La(e),s)for(e=0;e<s.length;e++)n=s[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Pl(t)};jn.render=function(e,t,n){if(!El(t))throw Error(pe(200));return Tl(null,e,t,!1,n)};jn.unmountComponentAtNode=function(e){if(!El(e))throw Error(pe(40));return e._reactRootContainer?(zi(function(){Tl(null,null,e,!1,function(){e._reactRootContainer=null,e[Tr]=null})}),!0):!1};jn.unstable_batchedUpdates=Nu;jn.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!El(n))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return Tl(e,t,n,!1,s)};jn.version="18.3.1-next-f1338f8080-20240426";function Rg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rg)}catch(e){console.error(e)}}Rg(),Rp.exports=jn;var Ag=Rp.exports,Mg,$f=Ag;Mg=$f.createRoot,$f.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ua(){return Ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ua.apply(this,arguments)}var Xr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xr||(Xr={}));const Wf="popstate";function t0(e){e===void 0&&(e={});function t(s,o){let{pathname:a,search:l,hash:d}=s.location;return Cd("",{pathname:a,search:l,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){return typeof o=="string"?o:ml(o)}return r0(t,n,null,e)}function Ct(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Fg(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function n0(){return Math.random().toString(36).substr(2,8)}function Hf(e,t){return{usr:e.state,key:e.key,idx:t}}function Cd(e,t,n,s){return n===void 0&&(n=null),Ua({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Os(t):t,{state:n,key:t&&t.key||s||n0()})}function ml(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Os(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function r0(e,t,n,s){s===void 0&&(s={});let{window:o=document.defaultView,v5Compat:a=!1}=s,l=o.history,d=Xr.Pop,u=null,f=m();f==null&&(f=0,l.replaceState(Ua({},l.state,{idx:f}),""));function m(){return(l.state||{idx:null}).idx}function g(){d=Xr.Pop;let C=m(),j=C==null?null:C-f;f=C,u&&u({action:d,location:_.location,delta:j})}function y(C,j){d=Xr.Push;let x=Cd(_.location,C,j);f=m()+1;let N=Hf(x,f),b=_.createHref(x);try{l.pushState(N,"",b)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;o.location.assign(b)}a&&u&&u({action:d,location:_.location,delta:1})}function k(C,j){d=Xr.Replace;let x=Cd(_.location,C,j);f=m();let N=Hf(x,f),b=_.createHref(x);l.replaceState(N,"",b),a&&u&&u({action:d,location:_.location,delta:0})}function S(C){let j=o.location.origin!=="null"?o.location.origin:o.location.href,x=typeof C=="string"?C:ml(C);return x=x.replace(/ $/,"%20"),Ct(j,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,j)}let _={get action(){return d},get location(){return e(o,l)},listen(C){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(Wf,g),u=C,()=>{o.removeEventListener(Wf,g),u=null}},createHref(C){return t(o,C)},createURL:S,encodeLocation(C){let j=S(C);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:y,replace:k,go(C){return l.go(C)}};return _}var Zf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Zf||(Zf={}));function i0(e,t,n){return n===void 0&&(n="/"),s0(e,t,n)}function s0(e,t,n,s){let o=typeof t=="string"?Os(t):t,a=Bu(o.pathname||"/",n);if(a==null)return null;let l=Ug(e);a0(l);let d=null;for(let u=0;d==null&&u<l.length;++u){let f=v0(a);d=m0(l[u],f)}return d}function Ug(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let o=(a,l,d)=>{let u={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};u.relativePath.startsWith("/")&&(Ct(u.relativePath.startsWith(s),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(s.length));let f=li([s,u.relativePath]),m=n.concat(u);a.children&&a.children.length>0&&(Ct(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),Ug(a.children,t,m,f)),!(a.path==null&&!a.index)&&t.push({path:f,score:f0(f,a.index),routesMeta:m})};return e.forEach((a,l)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))o(a,l);else for(let u of Og(a.path))o(a,l,u)}),t}function Og(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return o?[a,""]:[a];let l=Og(s.join("/")),d=[];return d.push(...l.map(u=>u===""?a:[a,u].join("/"))),o&&d.push(...l),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function a0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:p0(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const o0=/^:[\w-]+$/,l0=3,c0=2,d0=1,u0=10,h0=-2,Vf=e=>e==="*";function f0(e,t){let n=e.split("/"),s=n.length;return n.some(Vf)&&(s+=h0),t&&(s+=c0),n.filter(o=>!Vf(o)).reduce((o,a)=>o+(o0.test(a)?l0:a===""?d0:u0),s)}function p0(e,t){return e.length===t.length&&e.slice(0,-1).every((s,o)=>s===t[o])?e[e.length-1]-t[t.length-1]:0}function m0(e,t,n){let{routesMeta:s}=e,o={},a="/",l=[];for(let d=0;d<s.length;++d){let u=s[d],f=d===s.length-1,m=a==="/"?t:t.slice(a.length)||"/",g=g0({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},m),y=u.route;if(!g)return null;Object.assign(o,g.params),l.push({params:o,pathname:li([a,g.pathname]),pathnameBase:j0(li([a,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(a=li([a,g.pathnameBase]))}return l}function g0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=y0(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let a=o[0],l=a.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((f,m,g)=>{let{paramName:y,isOptional:k}=m;if(y==="*"){let _=d[g]||"";l=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const S=d[g];return k&&!S?f[y]=void 0:f[y]=(S||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:e}}function y0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Fg(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,u)=>(s.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),s]}function v0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Fg(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Bu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function x0(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:o=""}=typeof e=="string"?Os(e):e;return{pathname:n?n.startsWith("/")?n:_0(n,t):t,search:S0(s),hash:C0(o)}}function _0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Sc(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function w0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Ru(e,t){let n=w0(e);return t?n.map((s,o)=>o===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Au(e,t,n,s){s===void 0&&(s=!1);let o;typeof e=="string"?o=Os(e):(o=Ua({},e),Ct(!o.pathname||!o.pathname.includes("?"),Sc("?","pathname","search",o)),Ct(!o.pathname||!o.pathname.includes("#"),Sc("#","pathname","hash",o)),Ct(!o.search||!o.search.includes("#"),Sc("#","search","hash",o)));let a=e===""||o.pathname==="",l=a?"/":o.pathname,d;if(l==null)d=n;else{let g=t.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),g-=1;o.pathname=y.join("/")}d=g>=0?t[g]:"/"}let u=x0(o,d),f=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(f||m)&&(u.pathname+="/"),u}const li=e=>e.join("/").replace(/\/\/+/g,"/"),j0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),S0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,C0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function N0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const zg=["post","put","patch","delete"];new Set(zg);const k0=["get",...zg];new Set(k0);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oa(){return Oa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Oa.apply(this,arguments)}const Mu=v.createContext(null),b0=v.createContext(null),pi=v.createContext(null),Bl=v.createContext(null),Mr=v.createContext({outlet:null,matches:[],isDataRoute:!1}),Dg=v.createContext(null);function I0(e,t){let{relative:n}=t===void 0?{}:t;zs()||Ct(!1);let{basename:s,navigator:o}=v.useContext(pi),{hash:a,pathname:l,search:d}=Hg(e,{relative:n}),u=l;return s!=="/"&&(u=l==="/"?s:li([s,l])),o.createHref({pathname:u,search:d,hash:a})}function zs(){return v.useContext(Bl)!=null}function mi(){return zs()||Ct(!1),v.useContext(Bl).location}function $g(e){v.useContext(pi).static||v.useLayoutEffect(e)}function sn(){let{isDataRoute:e}=v.useContext(Mr);return e?D0():L0()}function L0(){zs()||Ct(!1);let e=v.useContext(Mu),{basename:t,future:n,navigator:s}=v.useContext(pi),{matches:o}=v.useContext(Mr),{pathname:a}=mi(),l=JSON.stringify(Ru(o,n.v7_relativeSplatPath)),d=v.useRef(!1);return $g(()=>{d.current=!0}),v.useCallback(function(f,m){if(m===void 0&&(m={}),!d.current)return;if(typeof f=="number"){s.go(f);return}let g=Au(f,JSON.parse(l),a,m.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:li([t,g.pathname])),(m.replace?s.replace:s.push)(g,m.state,m)},[t,s,l,a,e])}function Wg(){let{matches:e}=v.useContext(Mr),t=e[e.length-1];return t?t.params:{}}function Hg(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=v.useContext(pi),{matches:o}=v.useContext(Mr),{pathname:a}=mi(),l=JSON.stringify(Ru(o,s.v7_relativeSplatPath));return v.useMemo(()=>Au(e,JSON.parse(l),a,n==="path"),[e,l,a,n])}function P0(e,t){return E0(e,t)}function E0(e,t,n,s){zs()||Ct(!1);let{navigator:o}=v.useContext(pi),{matches:a}=v.useContext(Mr),l=a[a.length-1],d=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let f=mi(),m;if(t){var g;let C=typeof t=="string"?Os(t):t;u==="/"||(g=C.pathname)!=null&&g.startsWith(u)||Ct(!1),m=C}else m=f;let y=m.pathname||"/",k=y;if(u!=="/"){let C=u.replace(/^\//,"").split("/");k="/"+y.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=i0(e,{pathname:k}),_=M0(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},d,C.params),pathname:li([u,o.encodeLocation?o.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?u:li([u,o.encodeLocation?o.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),a,n,s);return t&&_?v.createElement(Bl.Provider,{value:{location:Oa({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Xr.Pop}},_):_}function T0(){let e=z0(),t=N0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),n?v.createElement("pre",{style:o},n):null,null)}const B0=v.createElement(T0,null);class R0 extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?v.createElement(Mr.Provider,{value:this.props.routeContext},v.createElement(Dg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function A0(e){let{routeContext:t,match:n,children:s}=e,o=v.useContext(Mu);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(Mr.Provider,{value:t},s)}function M0(e,t,n,s){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=s)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,d=(o=n)==null?void 0:o.errors;if(d!=null){let m=l.findIndex(g=>g.route.id&&(d==null?void 0:d[g.route.id])!==void 0);m>=0||Ct(!1),l=l.slice(0,Math.min(l.length,m+1))}let u=!1,f=-1;if(n&&s&&s.v7_partialHydration)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:y,errors:k}=n,S=g.route.loader&&y[g.route.id]===void 0&&(!k||k[g.route.id]===void 0);if(g.route.lazy||S){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((m,g,y)=>{let k,S=!1,_=null,C=null;n&&(k=d&&g.route.id?d[g.route.id]:void 0,_=g.route.errorElement||B0,u&&(f<0&&y===0?($0("route-fallback"),S=!0,C=null):f===y&&(S=!0,C=g.route.hydrateFallbackElement||null)));let j=t.concat(l.slice(0,y+1)),x=()=>{let N;return k?N=_:S?N=C:g.route.Component?N=v.createElement(g.route.Component,null):g.route.element?N=g.route.element:N=m,v.createElement(A0,{match:g,routeContext:{outlet:m,matches:j,isDataRoute:n!=null},children:N})};return n&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?v.createElement(R0,{location:n.location,revalidation:n.revalidation,component:_,error:k,children:x(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):x()},null)}var Zg=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Zg||{}),Vg=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Vg||{});function F0(e){let t=v.useContext(Mu);return t||Ct(!1),t}function U0(e){let t=v.useContext(b0);return t||Ct(!1),t}function O0(e){let t=v.useContext(Mr);return t||Ct(!1),t}function qg(e){let t=O0(),n=t.matches[t.matches.length-1];return n.route.id||Ct(!1),n.route.id}function z0(){var e;let t=v.useContext(Dg),n=U0(),s=qg();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function D0(){let{router:e}=F0(Zg.UseNavigateStable),t=qg(Vg.UseNavigateStable),n=v.useRef(!1);return $g(()=>{n.current=!0}),v.useCallback(function(o,a){a===void 0&&(a={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,Oa({fromRouteId:t},a)))},[e,t])}const qf={};function $0(e,t,n){qf[e]||(qf[e]=!0)}function W0(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Cc(e){let{to:t,replace:n,state:s,relative:o}=e;zs()||Ct(!1);let{future:a,static:l}=v.useContext(pi),{matches:d}=v.useContext(Mr),{pathname:u}=mi(),f=sn(),m=Au(t,Ru(d,a.v7_relativeSplatPath),u,o==="path"),g=JSON.stringify(m);return v.useEffect(()=>f(JSON.parse(g),{replace:n,state:s,relative:o}),[f,g,o,n,s]),null}function Mt(e){Ct(!1)}function H0(e){let{basename:t="/",children:n=null,location:s,navigationType:o=Xr.Pop,navigator:a,static:l=!1,future:d}=e;zs()&&Ct(!1);let u=t.replace(/^\/*/,"/"),f=v.useMemo(()=>({basename:u,navigator:a,static:l,future:Oa({v7_relativeSplatPath:!1},d)}),[u,d,a,l]);typeof s=="string"&&(s=Os(s));let{pathname:m="/",search:g="",hash:y="",state:k=null,key:S="default"}=s,_=v.useMemo(()=>{let C=Bu(m,u);return C==null?null:{location:{pathname:C,search:g,hash:y,state:k,key:S},navigationType:o}},[u,m,g,y,k,S,o]);return _==null?null:v.createElement(pi.Provider,{value:f},v.createElement(Bl.Provider,{children:n,value:_}))}function Z0(e){let{children:t,location:n}=e;return P0(Nd(t),n)}new Promise(()=>{});function Nd(e,t){t===void 0&&(t=[]);let n=[];return v.Children.forEach(e,(s,o)=>{if(!v.isValidElement(s))return;let a=[...t,o];if(s.type===v.Fragment){n.push.apply(n,Nd(s.props.children,a));return}s.type!==Mt&&Ct(!1),!s.props.index||!s.props.children||Ct(!1);let l={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=Nd(s.props.children,a)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kd(){return kd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},kd.apply(this,arguments)}function V0(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,a;for(a=0;a<s.length;a++)o=s[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function q0(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function G0(e,t){return e.button===0&&(!t||t==="_self")&&!q0(e)}function bd(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(o=>[n,o]):[[n,s]])},[]))}function Y0(e,t){let n=bd(e);return t&&t.forEach((s,o)=>{n.has(o)||t.getAll(o).forEach(a=>{n.append(o,a)})}),n}const K0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],J0="6";try{window.__reactRouterVersion=J0}catch{}const Q0="startTransition",Gf=Hv[Q0];function X0(e){let{basename:t,children:n,future:s,window:o}=e,a=v.useRef();a.current==null&&(a.current=t0({window:o,v5Compat:!0}));let l=a.current,[d,u]=v.useState({action:l.action,location:l.location}),{v7_startTransition:f}=s||{},m=v.useCallback(g=>{f&&Gf?Gf(()=>u(g)):u(g)},[u,f]);return v.useLayoutEffect(()=>l.listen(m),[l,m]),v.useEffect(()=>W0(s),[s]),v.createElement(H0,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:l,future:s})}const ew=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Nc=v.forwardRef(function(t,n){let{onClick:s,relative:o,reloadDocument:a,replace:l,state:d,target:u,to:f,preventScrollReset:m,viewTransition:g}=t,y=V0(t,K0),{basename:k}=v.useContext(pi),S,_=!1;if(typeof f=="string"&&tw.test(f)&&(S=f,ew))try{let N=new URL(window.location.href),b=f.startsWith("//")?new URL(N.protocol+f):new URL(f),P=Bu(b.pathname,k);b.origin===N.origin&&P!=null?f=P+b.search+b.hash:_=!0}catch{}let C=I0(f,{relative:o}),j=nw(f,{replace:l,state:d,target:u,preventScrollReset:m,relative:o,viewTransition:g});function x(N){s&&s(N),N.defaultPrevented||j(N)}return v.createElement("a",kd({},y,{href:S||C,onClick:_||a?s:x,ref:n,target:u}))});var Yf;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Yf||(Yf={}));var Kf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Kf||(Kf={}));function nw(e,t){let{target:n,replace:s,state:o,preventScrollReset:a,relative:l,viewTransition:d}=t===void 0?{}:t,u=sn(),f=mi(),m=Hg(e,{relative:l});return v.useCallback(g=>{if(G0(g,n)){g.preventDefault();let y=s!==void 0?s:ml(f)===ml(m);u(e,{replace:y,state:o,preventScrollReset:a,relative:l,viewTransition:d})}},[f,u,m,s,o,n,e,a,l,d])}function Gg(e){let t=v.useRef(bd(e)),n=v.useRef(!1),s=mi(),o=v.useMemo(()=>Y0(s.search,n.current?null:t.current),[s.search]),a=sn(),l=v.useCallback((d,u)=>{const f=bd(typeof d=="function"?d(o):d);n.current=!0,a("?"+f,u)},[a,o]);return[o,l]}function Yg(e,t){return function(){return e.apply(t,arguments)}}const{toString:rw}=Object.prototype,{getPrototypeOf:Fu}=Object,{iterator:Rl,toStringTag:Kg}=Symbol,Al=(e=>t=>{const n=rw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Kn=e=>(e=e.toLowerCase(),t=>Al(t)===e),Ml=e=>t=>typeof t===e,{isArray:Ds}=Array,As=Ml("undefined");function Va(e){return e!==null&&!As(e)&&e.constructor!==null&&!As(e.constructor)&&fn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Jg=Kn("ArrayBuffer");function iw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Jg(e.buffer),t}const sw=Ml("string"),fn=Ml("function"),Qg=Ml("number"),qa=e=>e!==null&&typeof e=="object",aw=e=>e===!0||e===!1,$o=e=>{if(Al(e)!=="object")return!1;const t=Fu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Kg in e)&&!(Rl in e)},ow=e=>{if(!qa(e)||Va(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},lw=Kn("Date"),cw=Kn("File"),dw=Kn("Blob"),uw=Kn("FileList"),hw=e=>qa(e)&&fn(e.pipe),fw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||fn(e.append)&&((t=Al(e))==="formdata"||t==="object"&&fn(e.toString)&&e.toString()==="[object FormData]"))},pw=Kn("URLSearchParams"),[mw,gw,yw,vw]=["ReadableStream","Request","Response","Headers"].map(Kn),xw=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ga(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,o;if(typeof e!="object"&&(e=[e]),Ds(e))for(s=0,o=e.length;s<o;s++)t.call(null,e[s],s,e);else{if(Va(e))return;const a=n?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let d;for(s=0;s<l;s++)d=a[s],t.call(null,e[d],d,e)}}function Xg(e,t){if(Va(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,o;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Ti=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ey=e=>!As(e)&&e!==Ti;function Id(){const{caseless:e,skipUndefined:t}=ey(this)&&this||{},n={},s=(o,a)=>{const l=e&&Xg(n,a)||a;$o(n[l])&&$o(o)?n[l]=Id(n[l],o):$o(o)?n[l]=Id({},o):Ds(o)?n[l]=o.slice():(!t||!As(o))&&(n[l]=o)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&Ga(arguments[o],s);return n}const _w=(e,t,n,{allOwnKeys:s}={})=>(Ga(t,(o,a)=>{n&&fn(o)?e[a]=Yg(o,n):e[a]=o},{allOwnKeys:s}),e),ww=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),jw=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Sw=(e,t,n,s)=>{let o,a,l;const d={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)l=o[a],(!s||s(l,e,t))&&!d[l]&&(t[l]=e[l],d[l]=!0);e=n!==!1&&Fu(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Cw=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},Nw=e=>{if(!e)return null;if(Ds(e))return e;let t=e.length;if(!Qg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},kw=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Fu(Uint8Array)),bw=(e,t)=>{const s=(e&&e[Rl]).call(e);let o;for(;(o=s.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},Iw=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},Lw=Kn("HTMLFormElement"),Pw=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),Jf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Ew=Kn("RegExp"),ty=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Ga(n,(o,a)=>{let l;(l=t(o,a,e))!==!1&&(s[a]=l||o)}),Object.defineProperties(e,s)},Tw=e=>{ty(e,(t,n)=>{if(fn(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(fn(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Bw=(e,t)=>{const n={},s=o=>{o.forEach(a=>{n[a]=!0})};return Ds(e)?s(e):s(String(e).split(t)),n},Rw=()=>{},Aw=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Mw(e){return!!(e&&fn(e.append)&&e[Kg]==="FormData"&&e[Rl])}const Fw=e=>{const t=new Array(10),n=(s,o)=>{if(qa(s)){if(t.indexOf(s)>=0)return;if(Va(s))return s;if(!("toJSON"in s)){t[o]=s;const a=Ds(s)?[]:{};return Ga(s,(l,d)=>{const u=n(l,o+1);!As(u)&&(a[d]=u)}),t[o]=void 0,a}}return s};return n(e,0)},Uw=Kn("AsyncFunction"),Ow=e=>e&&(qa(e)||fn(e))&&fn(e.then)&&fn(e.catch),ny=((e,t)=>e?setImmediate:t?((n,s)=>(Ti.addEventListener("message",({source:o,data:a})=>{o===Ti&&a===n&&s.length&&s.shift()()},!1),o=>{s.push(o),Ti.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",fn(Ti.postMessage)),zw=typeof queueMicrotask<"u"?queueMicrotask.bind(Ti):typeof process<"u"&&process.nextTick||ny,Dw=e=>e!=null&&fn(e[Rl]),J={isArray:Ds,isArrayBuffer:Jg,isBuffer:Va,isFormData:fw,isArrayBufferView:iw,isString:sw,isNumber:Qg,isBoolean:aw,isObject:qa,isPlainObject:$o,isEmptyObject:ow,isReadableStream:mw,isRequest:gw,isResponse:yw,isHeaders:vw,isUndefined:As,isDate:lw,isFile:cw,isBlob:dw,isRegExp:Ew,isFunction:fn,isStream:hw,isURLSearchParams:pw,isTypedArray:kw,isFileList:uw,forEach:Ga,merge:Id,extend:_w,trim:xw,stripBOM:ww,inherits:jw,toFlatObject:Sw,kindOf:Al,kindOfTest:Kn,endsWith:Cw,toArray:Nw,forEachEntry:bw,matchAll:Iw,isHTMLForm:Lw,hasOwnProperty:Jf,hasOwnProp:Jf,reduceDescriptors:ty,freezeMethods:Tw,toObjectSet:Bw,toCamelCase:Pw,noop:Rw,toFiniteNumber:Aw,findKey:Xg,global:Ti,isContextDefined:ey,isSpecCompliantForm:Mw,toJSONObject:Fw,isAsyncFn:Uw,isThenable:Ow,setImmediate:ny,asap:zw,isIterable:Dw};function $e(e,t,n,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}J.inherits($e,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const ry=$e.prototype,iy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{iy[e]={value:e}});Object.defineProperties($e,iy);Object.defineProperty(ry,"isAxiosError",{value:!0});$e.from=(e,t,n,s,o,a)=>{const l=Object.create(ry);J.toFlatObject(e,l,function(m){return m!==Error.prototype},f=>f!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=t==null&&e?e.code:t;return $e.call(l,d,u,n,s,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const $w=null;function Ld(e){return J.isPlainObject(e)||J.isArray(e)}function sy(e){return J.endsWith(e,"[]")?e.slice(0,-2):e}function Qf(e,t,n){return e?e.concat(t).map(function(o,a){return o=sy(o),!n&&a?"["+o+"]":o}).join(n?".":""):t}function Ww(e){return J.isArray(e)&&!e.some(Ld)}const Hw=J.toFlatObject(J,{},null,function(t){return/^is[A-Z]/.test(t)});function Fl(e,t,n){if(!J.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=J.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,C){return!J.isUndefined(C[_])});const s=n.metaTokens,o=n.visitor||m,a=n.dots,l=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(t);if(!J.isFunction(o))throw new TypeError("visitor must be a function");function f(S){if(S===null)return"";if(J.isDate(S))return S.toISOString();if(J.isBoolean(S))return S.toString();if(!u&&J.isBlob(S))throw new $e("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(S)||J.isTypedArray(S)?u&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function m(S,_,C){let j=S;if(S&&!C&&typeof S=="object"){if(J.endsWith(_,"{}"))_=s?_:_.slice(0,-2),S=JSON.stringify(S);else if(J.isArray(S)&&Ww(S)||(J.isFileList(S)||J.endsWith(_,"[]"))&&(j=J.toArray(S)))return _=sy(_),j.forEach(function(N,b){!(J.isUndefined(N)||N===null)&&t.append(l===!0?Qf([_],b,a):l===null?_:_+"[]",f(N))}),!1}return Ld(S)?!0:(t.append(Qf(C,_,a),f(S)),!1)}const g=[],y=Object.assign(Hw,{defaultVisitor:m,convertValue:f,isVisitable:Ld});function k(S,_){if(!J.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+_.join("."));g.push(S),J.forEach(S,function(j,x){(!(J.isUndefined(j)||j===null)&&o.call(t,j,J.isString(x)?x.trim():x,_,y))===!0&&k(j,_?_.concat(x):[x])}),g.pop()}}if(!J.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Xf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Uu(e,t){this._pairs=[],e&&Fl(e,this,t)}const ay=Uu.prototype;ay.append=function(t,n){this._pairs.push([t,n])};ay.toString=function(t){const n=t?function(s){return t.call(this,s,Xf)}:Xf;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function Zw(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function oy(e,t,n){if(!t)return e;const s=n&&n.encode||Zw;J.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(t,n):a=J.isURLSearchParams(t)?t.toString():new Uu(t,n).toString(s),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class ep{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){J.forEach(this.handlers,function(s){s!==null&&t(s)})}}const ly={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Vw=typeof URLSearchParams<"u"?URLSearchParams:Uu,qw=typeof FormData<"u"?FormData:null,Gw=typeof Blob<"u"?Blob:null,Yw={isBrowser:!0,classes:{URLSearchParams:Vw,FormData:qw,Blob:Gw},protocols:["http","https","file","blob","url","data"]},Ou=typeof window<"u"&&typeof document<"u",Pd=typeof navigator=="object"&&navigator||void 0,Kw=Ou&&(!Pd||["ReactNative","NativeScript","NS"].indexOf(Pd.product)<0),Jw=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Qw=Ou&&window.location.href||"http://localhost",Xw=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ou,hasStandardBrowserEnv:Kw,hasStandardBrowserWebWorkerEnv:Jw,navigator:Pd,origin:Qw},Symbol.toStringTag,{value:"Module"})),Gt={...Xw,...Yw};function ej(e,t){return Fl(e,new Gt.classes.URLSearchParams,{visitor:function(n,s,o,a){return Gt.isNode&&J.isBuffer(n)?(this.append(s,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function tj(e){return J.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function nj(e){const t={},n=Object.keys(e);let s;const o=n.length;let a;for(s=0;s<o;s++)a=n[s],t[a]=e[a];return t}function cy(e){function t(n,s,o,a){let l=n[a++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),u=a>=n.length;return l=!l&&J.isArray(o)?o.length:l,u?(J.hasOwnProp(o,l)?o[l]=[o[l],s]:o[l]=s,!d):((!o[l]||!J.isObject(o[l]))&&(o[l]=[]),t(n,s,o[l],a)&&J.isArray(o[l])&&(o[l]=nj(o[l])),!d)}if(J.isFormData(e)&&J.isFunction(e.entries)){const n={};return J.forEachEntry(e,(s,o)=>{t(tj(s),o,n,0)}),n}return null}function rj(e,t,n){if(J.isString(e))try{return(t||JSON.parse)(e),J.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const Ya={transitional:ly,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,a=J.isObject(t);if(a&&J.isHTMLForm(t)&&(t=new FormData(t)),J.isFormData(t))return o?JSON.stringify(cy(t)):t;if(J.isArrayBuffer(t)||J.isBuffer(t)||J.isStream(t)||J.isFile(t)||J.isBlob(t)||J.isReadableStream(t))return t;if(J.isArrayBufferView(t))return t.buffer;if(J.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return ej(t,this.formSerializer).toString();if((d=J.isFileList(t))||s.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Fl(d?{"files[]":t}:t,u&&new u,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),rj(t)):t}],transformResponse:[function(t){const n=this.transitional||Ya.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(J.isResponse(t)||J.isReadableStream(t))return t;if(t&&J.isString(t)&&(s&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(d){if(l)throw d.name==="SyntaxError"?$e.from(d,$e.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Gt.classes.FormData,Blob:Gt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],e=>{Ya.headers[e]={}});const ij=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sj=e=>{const t={};let n,s,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),s=l.substring(o+1).trim(),!(!n||t[n]&&ij[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},tp=Symbol("internals");function aa(e){return e&&String(e).trim().toLowerCase()}function Wo(e){return e===!1||e==null?e:J.isArray(e)?e.map(Wo):String(e)}function aj(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const oj=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function kc(e,t,n,s,o){if(J.isFunction(s))return s.call(this,t,n);if(o&&(t=n),!!J.isString(t)){if(J.isString(s))return t.indexOf(s)!==-1;if(J.isRegExp(s))return s.test(t)}}function lj(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function cj(e,t){const n=J.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(o,a,l){return this[s].call(this,t,o,a,l)},configurable:!0})})}let pn=class{constructor(t){t&&this.set(t)}set(t,n,s){const o=this;function a(d,u,f){const m=aa(u);if(!m)throw new Error("header name must be a non-empty string");const g=J.findKey(o,m);(!g||o[g]===void 0||f===!0||f===void 0&&o[g]!==!1)&&(o[g||u]=Wo(d))}const l=(d,u)=>J.forEach(d,(f,m)=>a(f,m,u));if(J.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(J.isString(t)&&(t=t.trim())&&!oj(t))l(sj(t),n);else if(J.isObject(t)&&J.isIterable(t)){let d={},u,f;for(const m of t){if(!J.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[f=m[0]]=(u=d[f])?J.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}l(d,n)}else t!=null&&a(n,t,s);return this}get(t,n){if(t=aa(t),t){const s=J.findKey(this,t);if(s){const o=this[s];if(!n)return o;if(n===!0)return aj(o);if(J.isFunction(n))return n.call(this,o,s);if(J.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=aa(t),t){const s=J.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||kc(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let o=!1;function a(l){if(l=aa(l),l){const d=J.findKey(s,l);d&&(!n||kc(s,s[d],d,n))&&(delete s[d],o=!0)}}return J.isArray(t)?t.forEach(a):a(t),o}clear(t){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const a=n[s];(!t||kc(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const n=this,s={};return J.forEach(this,(o,a)=>{const l=J.findKey(s,a);if(l){n[l]=Wo(o),delete n[a];return}const d=t?lj(a):String(a).trim();d!==a&&delete n[a],n[d]=Wo(o),s[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return J.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=t&&J.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(o=>s.set(o)),s}static accessor(t){const s=(this[tp]=this[tp]={accessors:{}}).accessors,o=this.prototype;function a(l){const d=aa(l);s[d]||(cj(o,l),s[d]=!0)}return J.isArray(t)?t.forEach(a):a(t),this}};pn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(pn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});J.freezeMethods(pn);function bc(e,t){const n=this||Ya,s=t||n,o=pn.from(s.headers);let a=s.data;return J.forEach(e,function(d){a=d.call(n,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function dy(e){return!!(e&&e.__CANCEL__)}function $s(e,t,n){$e.call(this,e??"canceled",$e.ERR_CANCELED,t,n),this.name="CanceledError"}J.inherits($s,$e,{__CANCEL__:!0});function uy(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new $e("Request failed with status code "+n.status,[$e.ERR_BAD_REQUEST,$e.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function dj(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function uj(e,t){e=e||10;const n=new Array(e),s=new Array(e);let o=0,a=0,l;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),m=s[a];l||(l=f),n[o]=u,s[o]=f;let g=a,y=0;for(;g!==o;)y+=n[g++],g=g%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),f-l<t)return;const k=m&&f-m;return k?Math.round(y*1e3/k):void 0}}function hj(e,t){let n=0,s=1e3/t,o,a;const l=(f,m=Date.now())=>{n=m,o=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const m=Date.now(),g=m-n;g>=s?l(f,m):(o=f,a||(a=setTimeout(()=>{a=null,l(o)},s-g)))},()=>o&&l(o)]}const gl=(e,t,n=3)=>{let s=0;const o=uj(50,250);return hj(a=>{const l=a.loaded,d=a.lengthComputable?a.total:void 0,u=l-s,f=o(u),m=l<=d;s=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:u,rate:f||void 0,estimated:f&&d&&m?(d-l)/f:void 0,event:a,lengthComputable:d!=null,[t?"download":"upload"]:!0};e(g)},n)},np=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},rp=e=>(...t)=>J.asap(()=>e(...t)),fj=Gt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Gt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Gt.origin),Gt.navigator&&/(msie|trident)/i.test(Gt.navigator.userAgent)):()=>!0,pj=Gt.hasStandardBrowserEnv?{write(e,t,n,s,o,a){const l=[e+"="+encodeURIComponent(t)];J.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),J.isString(s)&&l.push("path="+s),J.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function mj(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function gj(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function hy(e,t,n){let s=!mj(t);return e&&(s||n==!1)?gj(e,t):t}const ip=e=>e instanceof pn?{...e}:e;function Di(e,t){t=t||{};const n={};function s(f,m,g,y){return J.isPlainObject(f)&&J.isPlainObject(m)?J.merge.call({caseless:y},f,m):J.isPlainObject(m)?J.merge({},m):J.isArray(m)?m.slice():m}function o(f,m,g,y){if(J.isUndefined(m)){if(!J.isUndefined(f))return s(void 0,f,g,y)}else return s(f,m,g,y)}function a(f,m){if(!J.isUndefined(m))return s(void 0,m)}function l(f,m){if(J.isUndefined(m)){if(!J.isUndefined(f))return s(void 0,f)}else return s(void 0,m)}function d(f,m,g){if(g in t)return s(f,m);if(g in e)return s(void 0,f)}const u={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(f,m,g)=>o(ip(f),ip(m),g,!0)};return J.forEach(Object.keys({...e,...t}),function(m){const g=u[m]||o,y=g(e[m],t[m],m);J.isUndefined(y)&&g!==d||(n[m]=y)}),n}const fy=e=>{const t=Di({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:a,headers:l,auth:d}=t;if(t.headers=l=pn.from(l),t.url=oy(hy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),J.isFormData(n)){if(Gt.hasStandardBrowserEnv||Gt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(J.isFunction(n.getHeaders)){const u=n.getHeaders(),f=["content-type","content-length"];Object.entries(u).forEach(([m,g])=>{f.includes(m.toLowerCase())&&l.set(m,g)})}}if(Gt.hasStandardBrowserEnv&&(s&&J.isFunction(s)&&(s=s(t)),s||s!==!1&&fj(t.url))){const u=o&&a&&pj.read(a);u&&l.set(o,u)}return t},yj=typeof XMLHttpRequest<"u",vj=yj&&function(e){return new Promise(function(n,s){const o=fy(e);let a=o.data;const l=pn.from(o.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:f}=o,m,g,y,k,S;function _(){k&&k(),S&&S(),o.cancelToken&&o.cancelToken.unsubscribe(m),o.signal&&o.signal.removeEventListener("abort",m)}let C=new XMLHttpRequest;C.open(o.method.toUpperCase(),o.url,!0),C.timeout=o.timeout;function j(){if(!C)return;const N=pn.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),P={data:!d||d==="text"||d==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:N,config:e,request:C};uy(function(R){n(R),_()},function(R){s(R),_()},P),C=null}"onloadend"in C?C.onloadend=j:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(j)},C.onabort=function(){C&&(s(new $e("Request aborted",$e.ECONNABORTED,e,C)),C=null)},C.onerror=function(b){const P=b&&b.message?b.message:"Network Error",T=new $e(P,$e.ERR_NETWORK,e,C);T.event=b||null,s(T),C=null},C.ontimeout=function(){let b=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const P=o.transitional||ly;o.timeoutErrorMessage&&(b=o.timeoutErrorMessage),s(new $e(b,P.clarifyTimeoutError?$e.ETIMEDOUT:$e.ECONNABORTED,e,C)),C=null},a===void 0&&l.setContentType(null),"setRequestHeader"in C&&J.forEach(l.toJSON(),function(b,P){C.setRequestHeader(P,b)}),J.isUndefined(o.withCredentials)||(C.withCredentials=!!o.withCredentials),d&&d!=="json"&&(C.responseType=o.responseType),f&&([y,S]=gl(f,!0),C.addEventListener("progress",y)),u&&C.upload&&([g,k]=gl(u),C.upload.addEventListener("progress",g),C.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(m=N=>{C&&(s(!N||N.type?new $s(null,e,C):N),C.abort(),C=null)},o.cancelToken&&o.cancelToken.subscribe(m),o.signal&&(o.signal.aborted?m():o.signal.addEventListener("abort",m)));const x=dj(o.url);if(x&&Gt.protocols.indexOf(x)===-1){s(new $e("Unsupported protocol "+x+":",$e.ERR_BAD_REQUEST,e));return}C.send(a||null)})},xj=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,o;const a=function(f){if(!o){o=!0,d();const m=f instanceof Error?f:this.reason;s.abort(m instanceof $e?m:new $s(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,a(new $e(`timeout ${t} of ms exceeded`,$e.ETIMEDOUT))},t);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:u}=s;return u.unsubscribe=()=>J.asap(d),u}},_j=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,o;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},wj=async function*(e,t){for await(const n of jj(e))yield*_j(n,t)},jj=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},sp=(e,t,n,s)=>{const o=wj(e,t);let a=0,l,d=u=>{l||(l=!0,s&&s(u))};return new ReadableStream({async pull(u){try{const{done:f,value:m}=await o.next();if(f){d(),u.close();return}let g=m.byteLength;if(n){let y=a+=g;n(y)}u.enqueue(new Uint8Array(m))}catch(f){throw d(f),f}},cancel(u){return d(u),o.return()}},{highWaterMark:2})},ap=64*1024,{isFunction:Io}=J,Sj=(({Request:e,Response:t})=>({Request:e,Response:t}))(J.global),{ReadableStream:op,TextEncoder:lp}=J.global,cp=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Cj=e=>{e=J.merge.call({skipUndefined:!0},Sj,e);const{fetch:t,Request:n,Response:s}=e,o=t?Io(t):typeof fetch=="function",a=Io(n),l=Io(s);if(!o)return!1;const d=o&&Io(op),u=o&&(typeof lp=="function"?(S=>_=>S.encode(_))(new lp):async S=>new Uint8Array(await new n(S).arrayBuffer())),f=a&&d&&cp(()=>{let S=!1;const _=new n(Gt.origin,{body:new op,method:"POST",get duplex(){return S=!0,"half"}}).headers.has("Content-Type");return S&&!_}),m=l&&d&&cp(()=>J.isReadableStream(new s("").body)),g={stream:m&&(S=>S.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(S=>{!g[S]&&(g[S]=(_,C)=>{let j=_&&_[S];if(j)return j.call(_);throw new $e(`Response type '${S}' is not supported`,$e.ERR_NOT_SUPPORT,C)})});const y=async S=>{if(S==null)return 0;if(J.isBlob(S))return S.size;if(J.isSpecCompliantForm(S))return(await new n(Gt.origin,{method:"POST",body:S}).arrayBuffer()).byteLength;if(J.isArrayBufferView(S)||J.isArrayBuffer(S))return S.byteLength;if(J.isURLSearchParams(S)&&(S=S+""),J.isString(S))return(await u(S)).byteLength},k=async(S,_)=>{const C=J.toFiniteNumber(S.getContentLength());return C??y(_)};return async S=>{let{url:_,method:C,data:j,signal:x,cancelToken:N,timeout:b,onDownloadProgress:P,onUploadProgress:T,responseType:R,headers:B,withCredentials:U="same-origin",fetchOptions:E}=fy(S),A=t||fetch;R=R?(R+"").toLowerCase():"text";let H=xj([x,N&&N.toAbortSignal()],b),q=null;const O=H&&H.unsubscribe&&(()=>{H.unsubscribe()});let Q;try{if(T&&f&&C!=="get"&&C!=="head"&&(Q=await k(B,j))!==0){let ve=new n(_,{method:"POST",body:j,duplex:"half"}),xe;if(J.isFormData(j)&&(xe=ve.headers.get("content-type"))&&B.setContentType(xe),ve.body){const[ce,z]=np(Q,gl(rp(T)));j=sp(ve.body,ap,ce,z)}}J.isString(U)||(U=U?"include":"omit");const ie=a&&"credentials"in n.prototype,M={...E,signal:H,method:C.toUpperCase(),headers:B.normalize().toJSON(),body:j,duplex:"half",credentials:ie?U:void 0};q=a&&new n(_,M);let W=await(a?A(q,E):A(_,M));const ue=m&&(R==="stream"||R==="response");if(m&&(P||ue&&O)){const ve={};["status","statusText","headers"].forEach(re=>{ve[re]=W[re]});const xe=J.toFiniteNumber(W.headers.get("content-length")),[ce,z]=P&&np(xe,gl(rp(P),!0))||[];W=new s(sp(W.body,ap,ce,()=>{z&&z(),O&&O()}),ve)}R=R||"text";let ne=await g[J.findKey(g,R)||"text"](W,S);return!ue&&O&&O(),await new Promise((ve,xe)=>{uy(ve,xe,{data:ne,headers:pn.from(W.headers),status:W.status,statusText:W.statusText,config:S,request:q})})}catch(ie){throw O&&O(),ie&&ie.name==="TypeError"&&/Load failed|fetch/i.test(ie.message)?Object.assign(new $e("Network Error",$e.ERR_NETWORK,S,q),{cause:ie.cause||ie}):$e.from(ie,ie&&ie.code,S,q)}}},Nj=new Map,py=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:o}=t,a=[s,o,n];let l=a.length,d=l,u,f,m=Nj;for(;d--;)u=a[d],f=m.get(u),f===void 0&&m.set(u,f=d?new Map:Cj(t)),m=f;return f};py();const Ed={http:$w,xhr:vj,fetch:{get:py}};J.forEach(Ed,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const dp=e=>`- ${e}`,kj=e=>J.isFunction(e)||e===null||e===!1,my={getAdapter:(e,t)=>{e=J.isArray(e)?e:[e];const{length:n}=e;let s,o;const a={};for(let l=0;l<n;l++){s=e[l];let d;if(o=s,!kj(s)&&(o=Ed[(d=String(s)).toLowerCase()],o===void 0))throw new $e(`Unknown adapter '${d}'`);if(o&&(J.isFunction(o)||(o=o.get(t))))break;a[d||"#"+l]=o}if(!o){const l=Object.entries(a).map(([u,f])=>`adapter ${u} `+(f===!1?"is not supported by the environment":"is not available in the build"));let d=n?l.length>1?`since :
`+l.map(dp).join(`
`):" "+dp(l[0]):"as no adapter specified";throw new $e("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return o},adapters:Ed};function Ic(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new $s(null,e)}function up(e){return Ic(e),e.headers=pn.from(e.headers),e.data=bc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),my.getAdapter(e.adapter||Ya.adapter,e)(e).then(function(s){return Ic(e),s.data=bc.call(e,e.transformResponse,s),s.headers=pn.from(s.headers),s},function(s){return dy(s)||(Ic(e),s&&s.response&&(s.response.data=bc.call(e,e.transformResponse,s.response),s.response.headers=pn.from(s.response.headers))),Promise.reject(s)})}const gy="1.12.2",Ul={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ul[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const hp={};Ul.transitional=function(t,n,s){function o(a,l){return"[Axios v"+gy+"] Transitional option '"+a+"'"+l+(s?". "+s:"")}return(a,l,d)=>{if(t===!1)throw new $e(o(l," has been removed"+(n?" in "+n:"")),$e.ERR_DEPRECATED);return n&&!hp[l]&&(hp[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,l,d):!0}};Ul.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function bj(e,t,n){if(typeof e!="object")throw new $e("options must be an object",$e.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let o=s.length;for(;o-- >0;){const a=s[o],l=t[a];if(l){const d=e[a],u=d===void 0||l(d,a,e);if(u!==!0)throw new $e("option "+a+" must be "+u,$e.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new $e("Unknown option "+a,$e.ERR_BAD_OPTION)}}const Ho={assertOptions:bj,validators:Ul},or=Ho.validators;let Ai=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ep,response:new ep}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?a&&!String(s.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+a):s.stack=a}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Di(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:a}=n;s!==void 0&&Ho.assertOptions(s,{silentJSONParsing:or.transitional(or.boolean),forcedJSONParsing:or.transitional(or.boolean),clarifyTimeoutError:or.transitional(or.boolean)},!1),o!=null&&(J.isFunction(o)?n.paramsSerializer={serialize:o}:Ho.assertOptions(o,{encode:or.function,serialize:or.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Ho.assertOptions(n,{baseUrl:or.spelling("baseURL"),withXsrfToken:or.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=a&&J.merge(a.common,a[n.method]);a&&J.forEach(["delete","get","head","post","put","patch","common"],S=>{delete a[S]}),n.headers=pn.concat(l,a);const d=[];let u=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(u=u&&_.synchronous,d.unshift(_.fulfilled,_.rejected))});const f=[];this.interceptors.response.forEach(function(_){f.push(_.fulfilled,_.rejected)});let m,g=0,y;if(!u){const S=[up.bind(this),void 0];for(S.unshift(...d),S.push(...f),y=S.length,m=Promise.resolve(n);g<y;)m=m.then(S[g++],S[g++]);return m}y=d.length;let k=n;for(;g<y;){const S=d[g++],_=d[g++];try{k=S(k)}catch(C){_.call(this,C);break}}try{m=up.call(this,k)}catch(S){return Promise.reject(S)}for(g=0,y=f.length;g<y;)m=m.then(f[g++],f[g++]);return m}getUri(t){t=Di(this.defaults,t);const n=hy(t.baseURL,t.url,t.allowAbsoluteUrls);return oy(n,t.params,t.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(t){Ai.prototype[t]=function(n,s){return this.request(Di(s||{},{method:t,url:n,data:(s||{}).data}))}});J.forEach(["post","put","patch"],function(t){function n(s){return function(a,l,d){return this.request(Di(d||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Ai.prototype[t]=n(),Ai.prototype[t+"Form"]=n(!0)});let Ij=class yy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(o=>{if(!s._listeners)return;let a=s._listeners.length;for(;a-- >0;)s._listeners[a](o);s._listeners=null}),this.promise.then=o=>{let a;const l=new Promise(d=>{s.subscribe(d),a=d}).then(o);return l.cancel=function(){s.unsubscribe(a)},l},t(function(a,l,d){s.reason||(s.reason=new $s(a,l,d),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new yy(function(o){t=o}),cancel:t}}};function Lj(e){return function(n){return e.apply(null,n)}}function Pj(e){return J.isObject(e)&&e.isAxiosError===!0}const Td={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Td).forEach(([e,t])=>{Td[t]=e});function vy(e){const t=new Ai(e),n=Yg(Ai.prototype.request,t);return J.extend(n,Ai.prototype,t,{allOwnKeys:!0}),J.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return vy(Di(e,o))},n}const mt=vy(Ya);mt.Axios=Ai;mt.CanceledError=$s;mt.CancelToken=Ij;mt.isCancel=dy;mt.VERSION=gy;mt.toFormData=Fl;mt.AxiosError=$e;mt.Cancel=mt.CanceledError;mt.all=function(t){return Promise.all(t)};mt.spread=Lj;mt.isAxiosError=Pj;mt.mergeConfig=Di;mt.AxiosHeaders=pn;mt.formToJSON=e=>cy(J.isHTMLForm(e)?new FormData(e):e);mt.getAdapter=my.getAdapter;mt.HttpStatusCode=Td;mt.default=mt;const{Axios:qC,AxiosError:GC,CanceledError:YC,isCancel:KC,CancelToken:JC,VERSION:QC,all:XC,Cancel:e1,isAxiosError:t1,spread:n1,toFormData:r1,AxiosHeaders:i1,HttpStatusCode:s1,formToJSON:a1,getAdapter:o1,mergeConfig:l1}=mt,Hi="http://localhost:5054/api",te=mt.create({baseURL:Hi,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});te.interceptors.request.use(e=>{try{const t=localStorage.getItem("token");t&&t!=="null"&&(e.headers.Authorization=`Bearer ${t}`)}catch{}return e},e=>Promise.reject(e));let Lo=!1,Bd=[];const fp=(e,t=null)=>{Bd.forEach(n=>{e?n.reject(e):n.resolve(t)}),Bd=[]};te.interceptors.response.use(e=>e,async e=>{var n,s,o,a,l,d,u,f;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){if(Lo)return new Promise((m,g)=>{Bd.push({resolve:m,reject:g})}).then(m=>(t.headers.Authorization=`Bearer ${m}`,te(t))).catch(m=>Promise.reject(m));t._retry=!0,Lo=!0;try{console.log(" Token expired, refreshing...");const m=localStorage.getItem("refreshToken");if(!m)throw new Error("No refresh token available");const g=await mt.post(`${Hi}/Auth/Refresh-Token`,{refreshToken:m}),y=((o=(s=g.data)==null?void 0:s.data)==null?void 0:o.token)||((a=g.data)==null?void 0:a.token)||((l=g.data)==null?void 0:l.accessToken),k=((u=(d=g.data)==null?void 0:d.data)==null?void 0:u.refreshToken)||((f=g.data)==null?void 0:f.refreshToken);if(y)return console.log(" Token refreshed successfully"),localStorage.setItem("token",y),k&&localStorage.setItem("refreshToken",k),t.headers.Authorization=`Bearer ${y}`,fp(null,y),Lo=!1,te(t);throw new Error("No token in refresh response")}catch(m){return console.error(" Token refresh failed:",m),fp(m,null),Lo=!1,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),window.location.href="/",Promise.reject(m)}}return Promise.reject(e)});const Pr=e=>{if(!e)return{};try{const t=e.split(".");if(t.length<2)return{};const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch(t){return console.warn("decodeJwt failed",t),{}}},wt={register:async({fullName:e,email:t,phoneNumber:n,password:s})=>{const o={FullName:e,Email:t,PhoneNumber:n,Password:s,ConfirmPassword:s};return(await te.post("/Auth/Register",o)).data},login:async(e,t)=>{var n,s,o,a,l,d,u,f,m,g;try{const y=await te.post("/Auth/Login",{Email:e,Password:t}),k=((n=y.data)==null?void 0:n.data)||y.data||{},S=k.token||k.accessToken||((s=y.data)==null?void 0:s.token),_=k.refreshToken||((o=y.data)==null?void 0:o.refreshToken);if(S){localStorage.setItem("token",S);try{const C=Pr(S),j=C["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||C.nameidentifier||C.UserId||C.userId||C.uid||C.nameid||C.sub||C.id||C.Id;j&&localStorage.setItem("userId",j);const x=C["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||C.role||C.Role;x&&localStorage.setItem("userRole",x)}catch(C){console.error(" Error decoding JWT in authApi.login:",C)}}_&&localStorage.setItem("refreshToken",_),k.user&&localStorage.setItem("user",JSON.stringify(k.user)),(a=k.user)!=null&&a.email?localStorage.setItem("userEmail",k.user.email):e&&localStorage.setItem("userEmail",e);try{const C=localStorage.getItem("userRole");if(C&&(C.includes("Staff")||C.includes("staff")||C==="StationManager"||C.includes("Manager"))){const x=await wt.getMyProfile(),N=(x==null?void 0:x.stationId)||(x==null?void 0:x.StationId);N&&localStorage.setItem("stationId",N)}}catch(C){console.warn(" Could not fetch staff profile after login:",C)}return{raw:y.data,token:S,refreshToken:_,payload:k}}catch(y){const k=((d=(l=y.response)==null?void 0:l.data)==null?void 0:d.message)||((u=y.response)!=null&&u.data&&typeof y.response.data=="string"?y.response.data:null)||((m=(f=y.response)==null?void 0:f.data)==null?void 0:m.errors)&&Object.values(y.response.data.errors).flat().join("; ")||y.message||"Login failed",S=new Error(k);throw S.status=(g=y.response)==null?void 0:g.status,S}},logout:async()=>{const e=await te.post("/Auth/Logout");return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),localStorage.removeItem("userRole"),localStorage.removeItem("stationId"),e.data},refreshToken:async()=>{var s,o,a,l,d,u,f;const e=await te.post("/Auth/Refresh-Token"),t=((o=(s=e.data)==null?void 0:s.data)==null?void 0:o.token)||((a=e.data)==null?void 0:a.token)||((l=e.data)==null?void 0:l.accessToken),n=((u=(d=e.data)==null?void 0:d.data)==null?void 0:u.refreshToken)||((f=e.data)==null?void 0:f.refreshToken);return t&&localStorage.setItem("token",t),n&&localStorage.setItem("refreshToken",n),e.data},uploadCCCD:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await te.post("/Auth/cccd",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},uploadGPLX:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await te.post("/Auth/gplx",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},getMe:async()=>{var t;const e=await te.get("/Auth/Me");return((t=e.data)==null?void 0:t.data)||e.data||{}},getMyProfile:async()=>{var t;const e=await te.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},getUserById:async e=>{var t,n;try{const s=await te.get(`/Users/Get-By-${encodeURIComponent(e)}`);return((t=s.data)==null?void 0:t.data)||s.data||{}}catch{try{const o=await te.get(`/Users/${encodeURIComponent(e)}`);return((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error("authApi.getUserById failed:",o),o}}}};function Fr({isOpen:e,type:t="info",title:n,message:s,onClose:o,actionLabel:a="OK",onAction:l,autoCloseMs:d=null}){if(hr.useEffect(()=>{if(!e||!d)return;const m=setTimeout(o,d);return()=>clearTimeout(m)},[e,d,o]),!e)return null;const u=()=>{l&&l(),o()},f={success:"",error:"",info:"",warning:""}[t]||"";return r.jsx("div",{className:`notification-backdrop notification-${t}`,children:r.jsxs("div",{className:`notification-modal notification-${t}`,children:[r.jsxs("div",{className:"notification-header",children:[r.jsx("span",{className:"notification-icon",children:f}),r.jsx("h3",{className:"notification-title",children:n}),r.jsx("button",{className:"notification-close",onClick:o,children:""})]}),r.jsx("div",{className:"notification-body",children:Array.isArray(s)?r.jsx("ul",{children:s.map((m,g)=>r.jsx("li",{children:m},g))}):r.jsx("p",{children:s})}),r.jsxs("div",{className:"notification-footer",children:[r.jsx("button",{className:"btn-close",onClick:o,children:"Close"}),l&&r.jsx("button",{className:`btn-action btn-${t}`,onClick:u,children:a})]})]})})}function xy({documents:e,setDocuments:t,onDocumentUploadSuccess:n}){const[s,o]=v.useState({cccdFront:null,cccdBack:null,licenseFront:null,licenseBack:null}),[a,l]=v.useState({}),[d,u]=v.useState({isOpen:!1,type:"info",title:"",message:""}),f=(y,k)=>{if(!k)return;if(!k.type.startsWith("image/")){u({isOpen:!0,type:"error",title:"Invalid File Type",message:"Please select an image file (JPG, PNG, etc.)"});return}if(k.size>25*1024*1024){u({isOpen:!0,type:"error",title:"File Too Large",message:"Please select a file smaller than 25MB"});return}const S=new FileReader;S.onload=_=>{const C=_.target.result;t(j=>({...j,[y]:C}))},S.readAsDataURL(k),o(_=>({..._,[y]:k}))},m=async()=>{var S,_;const y=s.cccdFront,k=s.cccdBack;if(!y&&!k){u({isOpen:!0,type:"error",title:"No Files Selected",message:"Please select at least one CCCD image"});return}l(C=>({...C,cccdFront:!0,cccdBack:!0}));try{await wt.uploadCCCD(y,k);const j=await wt.getMe()||{};t(x=>({...x,cccdFront:j.cccdImageUrl_Front||"",cccdBack:j.cccdImageUrl_Back||""})),o(x=>({...x,cccdFront:null,cccdBack:null})),u({isOpen:!0,type:"success",title:"Upload Successful",message:" CCCD uploaded successfully!",autoCloseMs:2e3}),n&&n()}catch(C){u({isOpen:!0,type:"error",title:"Upload Failed",message:((_=(S=C.response)==null?void 0:S.data)==null?void 0:_.message)||"Failed to upload CCCD"})}finally{l(C=>({...C,cccdFront:!1,cccdBack:!1}))}},g=async()=>{var S,_;const y=s.licenseFront,k=s.licenseBack;if(!y&&!k){u({isOpen:!0,type:"error",title:"No Files Selected",message:"Please select at least one driver license image"});return}l(C=>({...C,licenseFront:!0,licenseBack:!0}));try{await wt.uploadGPLX(y,k);const j=await wt.getMe()||{};t(x=>({...x,licenseFront:j.gplxImageUrl_Front||"",licenseBack:j.gplxImageUrl_Back||""})),o(x=>({...x,licenseFront:null,licenseBack:null})),u({isOpen:!0,type:"success",title:"Upload Successful",message:" Driver License uploaded successfully!",autoCloseMs:2e3}),n&&n()}catch(C){u({isOpen:!0,type:"error",title:"Upload Failed",message:((_=(S=C.response)==null?void 0:S.data)==null?void 0:_.message)||"Failed to upload driver license"})}finally{l(C=>({...C,licenseFront:!1,licenseBack:!1}))}};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"document-upload-section",children:[r.jsx("h2",{className:"document-upload-title",children:" Upload Documents"}),r.jsx("p",{className:"document-upload-description",children:"Upload clear images of your ID card and driver license (both sides)"}),r.jsxs("div",{className:"document-upload-subsection",children:[r.jsx("h3",{children:"ID Card (CCCD)"}),r.jsxs("div",{className:"documents-grid",children:[r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"ID Card (Front)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("cccdFront-input").click(),children:[e.cccdFront&&e.cccdFront.trim()?r.jsx("img",{src:e.cccdFront,alt:"CCCD Front",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card"}),r.jsx("span",{children:"Click to select"})]}),a.cccdFront&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"cccdFront-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("cccdFront",(k=y.target.files)==null?void 0:k[0])}})]}),r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"ID Card (Back)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("cccdBack-input").click(),children:[e.cccdBack&&e.cccdBack.trim()?r.jsx("img",{src:e.cccdBack,alt:"CCCD Back",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card"}),r.jsx("span",{children:"Click to select"})]}),a.cccdBack&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"cccdBack-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("cccdBack",(k=y.target.files)==null?void 0:k[0])}})]})]}),r.jsxs("button",{type:"button",className:"btn-upload-docs",onClick:m,disabled:!s.cccdFront&&!s.cccdBack||a.cccdFront||a.cccdBack,children:[r.jsx("i",{className:"fas fa-upload"})," Upload ID Card"]})]}),r.jsxs("div",{className:"document-upload-subsection",children:[r.jsx("h3",{children:"Driver License (GPLX)"}),r.jsxs("div",{className:"documents-grid",children:[r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"Driver License (Front)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("licenseFront-input").click(),children:[e.licenseFront&&e.licenseFront.trim()?r.jsx("img",{src:e.licenseFront,alt:"License Front",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card-alt"}),r.jsx("span",{children:"Click to select"})]}),a.licenseFront&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"licenseFront-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("licenseFront",(k=y.target.files)==null?void 0:k[0])}})]}),r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"Driver License (Back)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("licenseBack-input").click(),children:[e.licenseBack&&e.licenseBack.trim()?r.jsx("img",{src:e.licenseBack,alt:"License Back",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card-alt"}),r.jsx("span",{children:"Click to select"})]}),a.licenseBack&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"licenseBack-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("licenseBack",(k=y.target.files)==null?void 0:k[0])}})]})]}),r.jsxs("button",{type:"button",className:"btn-upload-docs",onClick:g,disabled:!s.licenseFront&&!s.licenseBack||a.licenseFront||a.licenseBack,children:[r.jsx("i",{className:"fas fa-upload"})," Upload Driver License"]})]})]}),r.jsx(Fr,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,autoCloseMs:d.autoCloseMs,onClose:()=>u(y=>({...y,isOpen:!1}))})]})}function Ej(){const e=sn(),[t,n]=v.useState({}),[s,o]=v.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""});return v.useEffect(()=>{(async()=>{try{console.log(" Fetching user profile from /api/Users/Get-My-Profile...");const l=await wt.getMyProfile();console.log(" User profile:",l),n(l||{}),console.log(" Fetching document URLs from /api/Auth/me...");const d=await wt.getMe();console.log(" Auth response from /api/Auth/me:",d);const u=d||{};console.log(" Extracted auth data:",u);const f=u.cccdImageUrl_Front&&u.cccdImageUrl_Front.trim()?u.cccdImageUrl_Front:"",m=u.cccdImageUrl_Back&&u.cccdImageUrl_Back.trim()?u.cccdImageUrl_Back:"",g=u.gplxImageUrl_Front&&u.gplxImageUrl_Front.trim()?u.gplxImageUrl_Front:"",y=u.gplxImageUrl_Back&&u.gplxImageUrl_Back.trim()?u.gplxImageUrl_Back:"";console.log(" Loaded document URLs:",{cccdFront:f,cccdBack:m,licenseFront:g,licenseBack:y}),o({cccdFront:f,cccdBack:m,licenseFront:g,licenseBack:y})}catch(l){console.error(" Error loading profile:",l);const d=localStorage.getItem("userEmail"),u=localStorage.getItem("username"),f=localStorage.getItem("userPhone");n({email:d,fullName:u,phoneNumber:f}),o({cccdFront:localStorage.getItem("cccdFront")||"",cccdBack:localStorage.getItem("cccdBack")||"",licenseFront:localStorage.getItem("licenseFront")||"",licenseBack:localStorage.getItem("licenseBack")||""})}})()},[]),r.jsx("main",{className:"profile-main",children:r.jsxs("div",{className:"profile-container",children:[r.jsx("h2",{children:"USER PROFILE"}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Full Name"}),r.jsx("input",{type:"text",value:t.firstName?`${t.firstName} ${t.lastName}`:t.fullName||"",readOnly:!0})]}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:t.email||"",readOnly:!0})]}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Phone Number"}),r.jsx("input",{type:"tel",value:t.phoneNumber||"",readOnly:!0})]}),r.jsx(xy,{documents:s,setDocuments:o,onDocumentUploadSuccess:()=>{console.log(" Document upload successful")}}),r.jsx("div",{className:"profile-actions",children:r.jsxs("button",{className:"btn-update-profile",onClick:()=>e("/update-profile"),children:[r.jsx("i",{className:"fas fa-edit"})," Update Profile Information"]})})]})})}const zu={getMyProfile:async()=>{var t;const e=await te.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},updateMyProfile:async e=>{var t,n;try{console.log(" Updating user profile:",e);const s=await te.put("/Users/Update-My-Profile",e);return console.log(" Profile updated:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error updating profile:",((n=s.response)==null?void 0:n.data)||s.message),s}},changePassword:async(e,t)=>{var n,s;try{console.log(" Changing password");const o=await te.post("/Users/Change-Password",{currentPassword:e,newPassword:t});return console.log(" Password changed successfully"),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error changing password:",((s=o.response)==null?void 0:s.data)||o.message),o}},updateUserAvatar:async(e,t)=>{var n,s;try{console.log(" Updating avatar for user:",e);const o=await te.post(`/Users/${encodeURIComponent(e)}/avatar`,{avatarUrl:t});return console.log(" Avatar updated:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error updating avatar:",((s=o.response)==null?void 0:s.data)||o.message),o}},getUserById:async e=>{var t,n;try{console.log(" Fetching user by ID:",e);const s=await te.get(`/Users/Get-By-${encodeURIComponent(e)}`);return console.log(" User data:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching user:",((n=s.response)==null?void 0:n.data)||s.message),s}},searchUsers:async(e,t=1,n=10)=>{var s,o,a;try{console.log(" Searching users by email:",e);const l=await te.get("/Users/Search",{params:{email:e,pageNumber:t,pageSize:n}});return console.log(" Search results:",l.data),Array.isArray(l.data)?l.data:(s=l.data)!=null&&s.data&&Array.isArray(l.data.data)?l.data.data:(o=l.data)!=null&&o.items&&Array.isArray(l.data.items)?l.data.items:l.data||[]}catch(l){return console.error(" Error searching users:",((a=l.response)==null?void 0:a.data)||l.message),[]}},deactivateUser:async(e,t="")=>{var n;try{const s=encodeURIComponent(e),o=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Users/Deactivate-By-${s}${o}`,`/User/Deactivate-By-${s}${o}`];for(const l of a)try{const d=await te.patch(l,t?{reason:t}:{}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(n=d==null?void 0:d.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Deactivate user endpoint not found")}catch(s){throw console.error(" Error deactivating user:",s.message),s}},activateUser:async e=>{var t;try{const n=encodeURIComponent(e),s=[`/Users/Activate-By-${n}`,`/User/Activate-By-${n}`];for(const o of s)try{const a=await te.patch(o,{}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(t=a==null?void 0:a.response)==null?void 0:t.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Activate user endpoint not found")}catch(n){throw console.error(" Error activating user:",n.message),n}},updateUserRole:async(e,t)=>{var n;try{const s=encodeURIComponent(e),o=[`/Users/Update-Role-By-${s}`,`/User/Update-Role-By-${s}`];for(const a of o)try{const l=await te.patch(a,{role:t}),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){const d=(n=l==null?void 0:l.response)==null?void 0:n.status;if(d&&d!==404&&d!==405)throw l}throw new Error("Update user role endpoint not found")}catch(s){throw console.error(" Error updating user role:",s.message),s}},updateUserProfileByAdmin:async(e,t)=>{var n;try{const s=encodeURIComponent(e),o=[`/Users/Update-Profile-By-${s}`,`/User/Update-Profile-By-${s}`];for(const a of o)try{const l=await te.put(a,t),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){const d=(n=l==null?void 0:l.response)==null?void 0:n.status;if(d&&d!==404&&d!==405)throw l}throw new Error("Update user profile endpoint not found")}catch(s){throw console.error(" Error updating user profile:",s.message),s}},getTotalUserCount:async()=>{var e;try{const t=["/Users/Get-Total-Count","/User/Get-Total-Count"];for(const n of t)try{const s=await te.get(n),o=s==null?void 0:s.data,a=o&&typeof o=="object"&&"data"in o?o.data:o;return(a==null?void 0:a.totalCount)||(a==null?void 0:a.count)||a||0}catch(s){const o=(e=s==null?void 0:s.response)==null?void 0:e.status;if(o&&o!==404&&o!==405)throw s}return 0}catch(t){return console.error(" Error getting total user count:",t.message),0}},getUserStatisticsByRole:async()=>{var e;try{const t=["/Users/Get-Statistics-By-Role","/User/Get-Statistics-By-Role","/Users/Statistics-By-Role"];for(const n of t)try{const s=await te.get(n),o=s==null?void 0:s.data;return(o&&typeof o=="object"&&"data"in o?o.data:o)||{}}catch(s){const o=(e=s==null?void 0:s.response)==null?void 0:e.status;if(o&&o!==404&&o!==405)throw s}return{}}catch(t){return console.error(" Error getting user statistics:",t.message),{}}}};function Tj(){const e=sn(),[t,n]=v.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[s,o]=v.useState(!1),[a,l]=v.useState(!0),[d,u]=v.useState([]),[f,m]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[g,y]=v.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""});v.useEffect(()=>{k()},[]);const k=async()=>{try{l(!0),console.log(" Initializing profile form...");const j=localStorage.getItem("userFirstName")||"",x=localStorage.getItem("userLastName")||"",N=localStorage.getItem("userPhone")||"";console.log(" Profile initialized from localStorage");const b=[],P=localStorage.getItem("userAddress"),T=localStorage.getItem("userDateOfBirth"),R=localStorage.getItem("userDriverLicenseNumber"),B=localStorage.getItem("userDriverLicenseExpiry");console.log(" Checking 4 required fields:"),console.log("  Address:",P),console.log("  DateOfBirth:",T),console.log("  DriverLicenseNumber:",R),console.log("  DriverLicenseExpiry:",B),(!P||P.trim()==="")&&b.push("address"),(!T||T.trim()==="")&&b.push("dateOfBirth"),(!R||R.trim()==="")&&b.push("driverLicenseNumber"),(!B||B.trim()==="")&&b.push("driverLicenseExpiry"),u(b),console.log(" Missing fields:",b),n({firstName:j,lastName:x,phoneNumber:N,address:localStorage.getItem("userAddress")||"",dateOfBirth:localStorage.getItem("userDateOfBirth")||"",yearOfBirth:localStorage.getItem("userYearOfBirth")||"",identityNumber:localStorage.getItem("userIdentityNumber")||"",driverLicenseNumber:localStorage.getItem("userDriverLicenseNumber")||"",driverLicenseExpiry:localStorage.getItem("userDriverLicenseExpiry")||"",driverLicenseClass:localStorage.getItem("userDriverLicenseClass")||""});const E=await wt.getMe()||{};y({cccdFront:E.cccdImageUrl_Front||"",cccdBack:E.cccdImageUrl_Back||"",licenseFront:E.gplxImageUrl_Front||"",licenseBack:E.gplxImageUrl_Back||""})}catch(j){console.error(" Error initializing profile:",j)}finally{l(!1)}},S=j=>{const{name:x,value:N}=j.target,b={...t,[x]:N};if(x==="dateOfBirth"&&N){const P=new Date(N).getFullYear();b.yearOfBirth=String(P),console.log(` Extracted year ${P} from date ${N}`)}n(b)},_=()=>t.firstName.trim()?t.lastName.trim()?t.phoneNumber.trim()?t.phoneNumber.match(/^[0-9]{10,11}$/)?t.address.trim()?t.driverLicenseNumber.trim()?t.driverLicenseExpiry.trim()?!0:(m({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Expiry is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Number is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Address is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number must be 10-11 digits"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Last name is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"First name is required"}),!1),C=async j=>{var x,N;if(j.preventDefault(),!!_()){o(!0);try{console.log(" Updating profile with data:",t);const b={request:"UpdateProfile",firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber,address:t.address||"",dateOfBirth:t.dateOfBirth||"",yearOfBirth:t.yearOfBirth?String(t.yearOfBirth):"",identityNumber:t.identityNumber||"",driverLicenseNumber:t.driverLicenseNumber||"",driverLicenseExpiry:t.driverLicenseExpiry||"",driverLicenseClass:t.driverLicenseClass||""},P=await zu.updateMyProfile(b);console.log(" Profile updated successfully:",P),localStorage.setItem("userFirstName",t.firstName),localStorage.setItem("userLastName",t.lastName),localStorage.setItem("userPhone",t.phoneNumber),localStorage.setItem("userAddress",t.address),localStorage.setItem("userDateOfBirth",t.dateOfBirth),localStorage.setItem("userYearOfBirth",t.yearOfBirth),localStorage.setItem("userIdentityNumber",t.identityNumber),localStorage.setItem("userDriverLicenseNumber",t.driverLicenseNumber),localStorage.setItem("userDriverLicenseExpiry",t.driverLicenseExpiry),localStorage.setItem("userDriverLicenseClass",t.driverLicenseClass),m({isOpen:!0,type:"success",title:"Success! ",message:"Your profile has been updated successfully.",autoCloseMs:2e3,onAction:()=>{e("/")},actionLabel:"Go to Home"})}catch(b){console.error(" Error updating profile:",b),m({isOpen:!0,type:"error",title:"Update Failed",message:((N=(x=b.response)==null?void 0:x.data)==null?void 0:N.message)||"Failed to update profile. Please try again."})}finally{o(!1)}}};return a?r.jsx("div",{className:"update-profile-page",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Loading your profile..."})]})}):r.jsxs("div",{className:"update-profile-page",children:[r.jsx(Fr,{isOpen:f.isOpen,type:f.type,title:f.title,message:f.message,onClose:()=>m({...f,isOpen:!1}),autoCloseMs:f.autoCloseMs||0,onAction:f.onAction,actionLabel:f.actionLabel}),r.jsxs("div",{className:"container",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("h1",{children:" Update Your Profile"}),r.jsx("p",{style:{color:"white"},children:"Keep your information up to date to enjoy our services"})]}),d.length>0&&r.jsxs("div",{className:"warning-banner",children:[r.jsx("span",{className:"warning-icon",children:""}),r.jsxs("div",{children:[r.jsx("strong",{children:"Missing Information"}),r.jsxs("p",{children:["Please complete the following fields: ",d.map(j=>j==="address"?"Address":j==="driverLicenseNumber"?"Driver License Number":j==="driverLicenseExpiry"?"Driver License Expiry":j).join(", ")]})]})]}),r.jsxs("form",{onSubmit:C,className:"update-profile-form",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Basic Information"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"firstName",children:"First Name *"}),r.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:S,placeholder:"John",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),r.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:S,placeholder:"Doe",required:!0})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),r.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:t.phoneNumber,onChange:S,placeholder:"0912345678",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"address",children:["Address *",d.includes("address")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"address",name:"address",value:t.address,onChange:S,placeholder:"123 Main St, City, Country",className:d.includes("address")?"field-missing":"",required:!0})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Birth Information"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),r.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:t.dateOfBirth,onChange:S})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth (Auto-filled)"}),r.jsx("input",{type:"text",id:"yearOfBirth",name:"yearOfBirth",value:t.yearOfBirth,disabled:!0,placeholder:"Will auto-fill from date above",style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Driver License Information *"}),r.jsxs("div",{className:`form-group ${d.includes("driverLicenseNumber")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number *",d.includes("driverLicenseNumber")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:t.driverLicenseNumber,onChange:S,placeholder:"ABC123456",className:d.includes("driverLicenseNumber")?"field-missing":"",required:!0})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:`form-group ${d.includes("driverLicenseExpiry")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry *",d.includes("driverLicenseExpiry")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:t.driverLicenseExpiry,onChange:S,className:d.includes("driverLicenseExpiry")?"field-missing":"",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),r.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:t.driverLicenseClass,onChange:S,children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"A",children:"Class A"}),r.jsx("option",{value:"A1",children:"Class A1"}),r.jsx("option",{value:"B",children:"Class B"}),r.jsx("option",{value:"C",children:"Class C"}),r.jsx("option",{value:"D",children:"Class D"}),r.jsx("option",{value:"E",children:"Class E"})]})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Additional Information"}),r.jsxs("div",{className:`form-group ${d.includes("identityNumber")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"identityNumber",children:["Identity Number (CCCD) *",d.includes("identityNumber")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:t.identityNumber,onChange:S,placeholder:"123456789012",className:d.includes("identityNumber")?"field-missing":"",required:!0})]})]}),r.jsx(xy,{documents:g,setDocuments:y,onDocumentUploadSuccess:()=>{console.log(" Document upload successful")}}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e(-1),disabled:s,children:" Go Back"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?" Saving...":" Save Profile"})]})]})]})]})}const Rd={getAllStations:async(e=1,t=100)=>{var n;try{console.log(" Fetching stations from:",`${Hi}/Stations/Get-All`);const s=await te.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Stations response:",s.data);const o=s.data;return Array.isArray(o)?(console.log(" Returning stations array:",o.length,"items"),o):o.data&&o.data.data&&Array.isArray(o.data.data)?(console.log(" Returning stations from data.data.data:",o.data.data.length,"items"),o.data.data):o.data&&o.data.items&&Array.isArray(o.data.items)?(console.log(" Returning stations from data.data.items:",o.data.items.length,"items"),o.data.items):o.data&&Array.isArray(o.data)?(console.log(" Returning stations from data.data:",o.data.length,"items"),o.data):o.items&&Array.isArray(o.items)?(console.log(" Returning stations from data.items:",o.items.length,"items"),o.items):(console.warn(" No stations found in response"),[])}catch(s){return console.error(" Error fetching stations:",((n=s.response)==null?void 0:n.data)||s.message),[]}}},rt={getAllCars:async(e=1,t=100)=>{var n;try{console.log(" Fetching cars from:",`${Hi}/Cars/Get-All`);const s=await te.get("/Cars/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Cars response:",s.data);const o=s.data;return Array.isArray(o)?(console.log(" Returning cars array:",o.length,"items"),o):o.data&&o.data.data&&Array.isArray(o.data.data)?(console.log(" Returning cars from data.data.data:",o.data.data.length,"items"),o.data.data):o.data&&o.data.items&&Array.isArray(o.data.items)?(console.log(" Returning cars from data.data.items:",o.data.items.length,"items"),o.data.items):o.data&&Array.isArray(o.data)?(console.log(" Returning cars from data.data:",o.data.length,"items"),o.data):o.items&&Array.isArray(o.items)?(console.log(" Returning cars from data.items:",o.items.length,"items"),o.items):(console.warn(" No cars found in response"),[])}catch(s){return console.error(" Error fetching cars:",((n=s.response)==null?void 0:n.data)||s.message),[]}},getCarById:async e=>{var t;try{console.log(" Fetching car details for ID:",e);const n=await te.get(`/Cars/Get-By-${encodeURIComponent(e)}`);console.log(" Car detail response:",n.data);const s=n.data;return s.id||s.Id?(console.log(" Returning car object directly"),s):s.data&&s.data.data&&(s.data.data.id||s.data.data.Id)?(console.log(" Returning car from data.data.data"),s.data.data):s.data&&(s.data.id||s.data.Id)?(console.log(" Returning car from data.data"),s.data):(console.warn(" No car found in response"),null)}catch(n){throw console.error(" Error fetching car details:",((t=n.response)==null?void 0:t.data)||n.message),n}},getAvailableCarsByStation:async(e,t,n)=>{var s;try{console.log(" Fetching available cars for station:",e,"startTime:",t,"endTime:",n);try{const o=await te.get("/Bookings/available-cars-by-station",{params:{stationId:e,startTime:t,endTime:n}});console.log(" Available cars response:",o.data);const a=o.data;if(Array.isArray(a))return console.log(" Returning available cars array:",a.length,"items"),a;if(a.data&&a.data.data&&Array.isArray(a.data.data))return console.log(" Returning available cars from data.data.data:",a.data.data.length,"items"),a.data.data;if(a.data&&a.data.items&&Array.isArray(a.data.items))return console.log(" Returning available cars from data.data.items:",a.data.items.length,"items"),a.data.items;if(a.data&&Array.isArray(a.data))return console.log(" Returning available cars from data.data:",a.data.length,"items"),a.data;if(a.items&&Array.isArray(a.items))return console.log(" Returning available cars from data.items:",a.items.length,"items"),a.items}catch(o){console.warn(" Primary endpoint failed, trying fallback - getting all cars and filtering:",o.message);try{const a=await rt.getAllCars(),l=(a||[]).filter(d=>{var f,m;return(d.currentStationId||d.stationId||((f=d.station)==null?void 0:f.id)||((m=d.station)==null?void 0:m.Id))===e});return console.log(` Filtered ${l.length} cars for station ${e} from ${a.length} total cars`),l}catch(a){return console.warn(" Failed to get all cars for filtering:",a.message),[]}}return console.warn(" No available cars found in response"),[]}catch(o){return console.error(" Error fetching available cars:",((s=o.response)==null?void 0:s.data)||o.message),[]}},createCar:async e=>{var t,n;try{if(e instanceof FormData){const s={headers:{"Content-Type":void 0}};console.log(" Sending FormData with image for car creation");const o=await te.post("/Cars/Create",e,s);return((t=o.data)==null?void 0:t.data)||o.data}else{const s=await te.post("/Cars/Create",e);return((n=s.data)==null?void 0:n.data)||s.data}}catch(s){throw console.error("Error creating car:",s),s}},deleteCar:async e=>{var t;try{const n=await te.delete(`/Cars/Delete-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error deleting car:",n),n}},updateCar:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,t);return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car:",s),s}},updateStatus:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{tech:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car status:",s),s}},updateBatteryLevel:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{battery:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating battery level:",s),s}},updateCarDescription:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{issue:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car description:",s),s}},updateCarAvailability:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{isAvailable:t===1||t===!0});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car availability:",s),s}}},Bj=Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})),Rj=24e3;function Yt(e,t={convertFromUSD:!1}){const{convertFromUSD:n}=t||{},s=Number(e)||0,o=Math.round(n?s*Rj:s);return new Intl.NumberFormat("vi-VN").format(o)+" "}const _y=v.createContext(null);function Aj({children:e}){const[t,n]=v.useState([]),s=v.useCallback((a,l="info",d=3500,u=null)=>{const f=Date.now()+Math.random();let m=null;try{if(u&&typeof u.getBoundingClientRect=="function"){const g=u.getBoundingClientRect(),y=Math.round(g.top+g.height+8),k=Math.round(g.left+g.width/2);m={top:y,left:k}}}catch{m=null}n(g=>[...g,{id:f,message:a,type:l,pos:m}]),setTimeout(()=>{n(g=>g.filter(y=>y.id!==f))},d)},[]),o=v.useCallback(a=>{n(l=>l.filter(d=>d.id!==a))},[]);return r.jsxs(_y.Provider,{value:{showToast:s},children:[e,r.jsx("div",{className:"toast-viewport","aria-live":"polite",children:t.filter(a=>!a.pos).map(a=>r.jsxs("div",{className:`toast ${a.type}`,onClick:()=>o(a.id),children:[r.jsx("div",{className:"toast-message",children:a.message}),r.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},a.id))}),t.filter(a=>a.pos).map(a=>r.jsxs("div",{className:`toast ${a.type} anchored`,style:{position:"fixed",top:`${a.pos.top}px`,left:`${a.pos.left}px`,transform:"translateX(-50%)"},onClick:()=>o(a.id),children:[r.jsx("div",{className:"toast-message",children:a.message}),r.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},a.id))]})}function Du(){const e=v.useContext(_y);if(!e)throw new Error("useToast must be used within ToastProvider");return e}function wy(e,t){const n=v.useRef(t);v.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const Mj=1;function Fj(e){return Object.freeze({__version:Mj,map:e})}function Uj(e,t){return Object.freeze({...e,...t})}const jy=v.createContext(null),Sy=jy.Provider;function $u(){const e=v.useContext(jy);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Oj(e){function t(n,s){const{instance:o,context:a}=e(n).current;return v.useImperativeHandle(s,()=>o),n.children==null?null:hr.createElement(Sy,{value:a},n.children)}return v.forwardRef(t)}function zj(e){function t(n,s){const[o,a]=v.useState(!1),{instance:l}=e(n,a).current;v.useImperativeHandle(s,()=>l),v.useEffect(function(){o&&l.update()},[l,o,n.children]);const d=l._contentNode;return d?Ag.createPortal(n.children,d):null}return v.forwardRef(t)}function Dj(e){function t(n,s){const{instance:o}=e(n).current;return v.useImperativeHandle(s,()=>o),null}return v.forwardRef(t)}function Cy(e,t){const n=v.useRef();v.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function Wu(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function $j(e,t){return function(s,o){const a=$u(),l=e(Wu(s,a),a);return wy(a.map,s.attribution),Cy(l.current,s.eventHandlers),t(l.current,a,s,o),l}}var Ad={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,s){s(t)})(wp,function(n){var s="1.9.4";function o(i){var c,h,p,w;for(h=1,p=arguments.length;h<p;h++){w=arguments[h];for(c in w)i[c]=w[c]}return i}var a=Object.create||function(){function i(){}return function(c){return i.prototype=c,new i}}();function l(i,c){var h=Array.prototype.slice;if(i.bind)return i.bind.apply(i,h.call(arguments,1));var p=h.call(arguments,2);return function(){return i.apply(c,p.length?p.concat(h.call(arguments)):arguments)}}var d=0;function u(i){return"_leaflet_id"in i||(i._leaflet_id=++d),i._leaflet_id}function f(i,c,h){var p,w,I,F;return F=function(){p=!1,w&&(I.apply(h,w),w=!1)},I=function(){p?w=arguments:(i.apply(h,arguments),setTimeout(F,c),p=!0)},I}function m(i,c,h){var p=c[1],w=c[0],I=p-w;return i===p&&h?i:((i-w)%I+I)%I+w}function g(){return!1}function y(i,c){if(c===!1)return i;var h=Math.pow(10,c===void 0?6:c);return Math.round(i*h)/h}function k(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function S(i){return k(i).split(/\s+/)}function _(i,c){Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?a(i.options):{});for(var h in c)i.options[h]=c[h];return i.options}function C(i,c,h){var p=[];for(var w in i)p.push(encodeURIComponent(h?w.toUpperCase():w)+"="+encodeURIComponent(i[w]));return(!c||c.indexOf("?")===-1?"?":"&")+p.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function x(i,c){return i.replace(j,function(h,p){var w=c[p];if(w===void 0)throw new Error("No value provided for variable "+h);return typeof w=="function"&&(w=w(c)),w})}var N=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function b(i,c){for(var h=0;h<i.length;h++)if(i[h]===c)return h;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var R=0;function B(i){var c=+new Date,h=Math.max(0,16-(c-R));return R=c+h,window.setTimeout(i,h)}var U=window.requestAnimationFrame||T("RequestAnimationFrame")||B,E=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function A(i,c,h){if(h&&U===B)i.call(c);else return U.call(window,l(i,c))}function H(i){i&&E.call(window,i)}var q={__proto__:null,extend:o,create:a,bind:l,get lastId(){return d},stamp:u,throttle:f,wrapNum:m,falseFn:g,formatNum:y,trim:k,splitWords:S,setOptions:_,getParamString:C,template:x,isArray:N,indexOf:b,emptyImageUrl:P,requestFn:U,cancelFn:E,requestAnimFrame:A,cancelAnimFrame:H};function O(){}O.extend=function(i){var c=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,p=a(h);p.constructor=c,c.prototype=p;for(var w in this)Object.prototype.hasOwnProperty.call(this,w)&&w!=="prototype"&&w!=="__super__"&&(c[w]=this[w]);return i.statics&&o(c,i.statics),i.includes&&(Q(i.includes),o.apply(null,[p].concat(i.includes))),o(p,i),delete p.statics,delete p.includes,p.options&&(p.options=h.options?a(h.options):{},o(p.options,i.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var I=0,F=p._initHooks.length;I<F;I++)p._initHooks[I].call(this)}},c},O.include=function(i){var c=this.prototype.options;return o(this.prototype,i),i.options&&(this.prototype.options=c,this.mergeOptions(i.options)),this},O.mergeOptions=function(i){return o(this.prototype.options,i),this},O.addInitHook=function(i){var c=Array.prototype.slice.call(arguments,1),h=typeof i=="function"?i:function(){this[i].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function Q(i){if(!(typeof L>"u"||!L||!L.Mixin)){i=N(i)?i:[i];for(var c=0;c<i.length;c++)i[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ie={on:function(i,c,h){if(typeof i=="object")for(var p in i)this._on(p,i[p],c);else{i=S(i);for(var w=0,I=i.length;w<I;w++)this._on(i[w],c,h)}return this},off:function(i,c,h){if(!arguments.length)delete this._events;else if(typeof i=="object")for(var p in i)this._off(p,i[p],c);else{i=S(i);for(var w=arguments.length===1,I=0,F=i.length;I<F;I++)w?this._off(i[I]):this._off(i[I],c,h)}return this},_on:function(i,c,h,p){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(i,c,h)===!1){h===this&&(h=void 0);var w={fn:c,ctx:h};p&&(w.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(w)}},_off:function(i,c,h){var p,w,I;if(this._events&&(p=this._events[i],!!p)){if(arguments.length===1){if(this._firingCount)for(w=0,I=p.length;w<I;w++)p[w].fn=g;delete this._events[i];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var F=this._listens(i,c,h);if(F!==!1){var V=p[F];this._firingCount&&(V.fn=g,this._events[i]=p=p.slice()),p.splice(F,1)}}},fire:function(i,c,h){if(!this.listens(i,h))return this;var p=o({},c,{type:i,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var w=this._events[i];if(w){this._firingCount=this._firingCount+1||1;for(var I=0,F=w.length;I<F;I++){var V=w[I],K=V.fn;V.once&&this.off(i,K,V.ctx),K.call(V.ctx||this,p)}this._firingCount--}}return h&&this._propagateEvent(p),this},listens:function(i,c,h,p){typeof i!="string"&&console.warn('"string" type argument expected');var w=c;typeof c!="function"&&(p=!!c,w=void 0,h=void 0);var I=this._events&&this._events[i];if(I&&I.length&&this._listens(i,w,h)!==!1)return!0;if(p){for(var F in this._eventParents)if(this._eventParents[F].listens(i,c,h,p))return!0}return!1},_listens:function(i,c,h){if(!this._events)return!1;var p=this._events[i]||[];if(!c)return!!p.length;h===this&&(h=void 0);for(var w=0,I=p.length;w<I;w++)if(p[w].fn===c&&p[w].ctx===h)return w;return!1},once:function(i,c,h){if(typeof i=="object")for(var p in i)this._on(p,i[p],c,!0);else{i=S(i);for(var w=0,I=i.length;w<I;w++)this._on(i[w],c,h,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[u(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[u(i)],this},_propagateEvent:function(i){for(var c in this._eventParents)this._eventParents[c].fire(i.type,o({layer:i.target,propagatedFrom:i.target},i),!0)}};ie.addEventListener=ie.on,ie.removeEventListener=ie.clearAllEventListeners=ie.off,ie.addOneTimeEventListener=ie.once,ie.fireEvent=ie.fire,ie.hasEventListeners=ie.listens;var M=O.extend(ie);function W(i,c,h){this.x=h?Math.round(i):i,this.y=h?Math.round(c):c}var ue=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(i){return this.clone()._add(ne(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(ne(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new W(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new W(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ue(this.x),this.y=ue(this.y),this},distanceTo:function(i){i=ne(i);var c=i.x-this.x,h=i.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(i){return i=ne(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=ne(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ne(i,c,h){return i instanceof W?i:N(i)?new W(i[0],i[1]):i==null?i:typeof i=="object"&&"x"in i&&"y"in i?new W(i.x,i.y):new W(i,c,h)}function ve(i,c){if(i)for(var h=c?[i,c]:i,p=0,w=h.length;p<w;p++)this.extend(h[p])}ve.prototype={extend:function(i){var c,h;if(!i)return this;if(i instanceof W||typeof i[0]=="number"||"x"in i)c=h=ne(i);else if(i=xe(i),c=i.min,h=i.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(i){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var c,h;return typeof i[0]=="number"||i instanceof W?i=ne(i):i=xe(i),i instanceof ve?(c=i.min,h=i.max):c=h=i,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(i){i=xe(i);var c=this.min,h=this.max,p=i.min,w=i.max,I=w.x>=c.x&&p.x<=h.x,F=w.y>=c.y&&p.y<=h.y;return I&&F},overlaps:function(i){i=xe(i);var c=this.min,h=this.max,p=i.min,w=i.max,I=w.x>c.x&&p.x<h.x,F=w.y>c.y&&p.y<h.y;return I&&F},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var c=this.min,h=this.max,p=Math.abs(c.x-h.x)*i,w=Math.abs(c.y-h.y)*i;return xe(ne(c.x-p,c.y-w),ne(h.x+p,h.y+w))},equals:function(i){return i?(i=xe(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight())):!1}};function xe(i,c){return!i||i instanceof ve?i:new ve(i,c)}function ce(i,c){if(i)for(var h=c?[i,c]:i,p=0,w=h.length;p<w;p++)this.extend(h[p])}ce.prototype={extend:function(i){var c=this._southWest,h=this._northEast,p,w;if(i instanceof re)p=i,w=i;else if(i instanceof ce){if(p=i._southWest,w=i._northEast,!p||!w)return this}else return i?this.extend(G(i)||z(i)):this;return!c&&!h?(this._southWest=new re(p.lat,p.lng),this._northEast=new re(w.lat,w.lng)):(c.lat=Math.min(p.lat,c.lat),c.lng=Math.min(p.lng,c.lng),h.lat=Math.max(w.lat,h.lat),h.lng=Math.max(w.lng,h.lng)),this},pad:function(i){var c=this._southWest,h=this._northEast,p=Math.abs(c.lat-h.lat)*i,w=Math.abs(c.lng-h.lng)*i;return new ce(new re(c.lat-p,c.lng-w),new re(h.lat+p,h.lng+w))},getCenter:function(){return new re((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new re(this.getNorth(),this.getWest())},getSouthEast:function(){return new re(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){typeof i[0]=="number"||i instanceof re||"lat"in i?i=G(i):i=z(i);var c=this._southWest,h=this._northEast,p,w;return i instanceof ce?(p=i.getSouthWest(),w=i.getNorthEast()):p=w=i,p.lat>=c.lat&&w.lat<=h.lat&&p.lng>=c.lng&&w.lng<=h.lng},intersects:function(i){i=z(i);var c=this._southWest,h=this._northEast,p=i.getSouthWest(),w=i.getNorthEast(),I=w.lat>=c.lat&&p.lat<=h.lat,F=w.lng>=c.lng&&p.lng<=h.lng;return I&&F},overlaps:function(i){i=z(i);var c=this._southWest,h=this._northEast,p=i.getSouthWest(),w=i.getNorthEast(),I=w.lat>c.lat&&p.lat<h.lat,F=w.lng>c.lng&&p.lng<h.lng;return I&&F},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,c){return i?(i=z(i),this._southWest.equals(i.getSouthWest(),c)&&this._northEast.equals(i.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function z(i,c){return i instanceof ce?i:new ce(i,c)}function re(i,c,h){if(isNaN(i)||isNaN(c))throw new Error("Invalid LatLng object: ("+i+", "+c+")");this.lat=+i,this.lng=+c,h!==void 0&&(this.alt=+h)}re.prototype={equals:function(i,c){if(!i)return!1;i=G(i);var h=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return h<=(c===void 0?1e-9:c)},toString:function(i){return"LatLng("+y(this.lat,i)+", "+y(this.lng,i)+")"},distanceTo:function(i){return Le.distance(this,G(i))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(i){var c=180*i/40075017,h=c/Math.cos(Math.PI/180*this.lat);return z([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new re(this.lat,this.lng,this.alt)}};function G(i,c,h){return i instanceof re?i:N(i)&&typeof i[0]!="object"?i.length===3?new re(i[0],i[1],i[2]):i.length===2?new re(i[0],i[1]):null:i==null?i:typeof i=="object"&&"lat"in i?new re(i.lat,"lng"in i?i.lng:i.lon,i.alt):c===void 0?null:new re(i,c,h)}var we={latLngToPoint:function(i,c){var h=this.projection.project(i),p=this.scale(c);return this.transformation._transform(h,p)},pointToLatLng:function(i,c){var h=this.scale(c),p=this.transformation.untransform(i,h);return this.projection.unproject(p)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(i),p=this.transformation.transform(c.min,h),w=this.transformation.transform(c.max,h);return new ve(p,w)},infinite:!1,wrapLatLng:function(i){var c=this.wrapLng?m(i.lng,this.wrapLng,!0):i.lng,h=this.wrapLat?m(i.lat,this.wrapLat,!0):i.lat,p=i.alt;return new re(h,c,p)},wrapLatLngBounds:function(i){var c=i.getCenter(),h=this.wrapLatLng(c),p=c.lat-h.lat,w=c.lng-h.lng;if(p===0&&w===0)return i;var I=i.getSouthWest(),F=i.getNorthEast(),V=new re(I.lat-p,I.lng-w),K=new re(F.lat-p,F.lng-w);return new ce(V,K)}},Le=o({},we,{wrapLng:[-180,180],R:6371e3,distance:function(i,c){var h=Math.PI/180,p=i.lat*h,w=c.lat*h,I=Math.sin((c.lat-i.lat)*h/2),F=Math.sin((c.lng-i.lng)*h/2),V=I*I+Math.cos(p)*Math.cos(w)*F*F,K=2*Math.atan2(Math.sqrt(V),Math.sqrt(1-V));return this.R*K}}),Ce=6378137,je={R:Ce,MAX_LATITUDE:85.0511287798,project:function(i){var c=Math.PI/180,h=this.MAX_LATITUDE,p=Math.max(Math.min(h,i.lat),-h),w=Math.sin(p*c);return new W(this.R*i.lng*c,this.R*Math.log((1+w)/(1-w))/2)},unproject:function(i){var c=180/Math.PI;return new re((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*c,i.x*c/this.R)},bounds:function(){var i=Ce*Math.PI;return new ve([-i,-i],[i,i])}()};function ze(i,c,h,p){if(N(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=c,this._c=h,this._d=p}ze.prototype={transform:function(i,c){return this._transform(i.clone(),c)},_transform:function(i,c){return c=c||1,i.x=c*(this._a*i.x+this._b),i.y=c*(this._c*i.y+this._d),i},untransform:function(i,c){return c=c||1,new W((i.x/c-this._b)/this._a,(i.y/c-this._d)/this._c)}};function me(i,c,h,p){return new ze(i,c,h,p)}var et=o({},Le,{code:"EPSG:3857",projection:je,transformation:function(){var i=.5/(Math.PI*je.R);return me(i,.5,-i,.5)}()}),mn=o({},et,{code:"EPSG:900913"});function he(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function se(i,c){var h="",p,w,I,F,V,K;for(p=0,I=i.length;p<I;p++){for(V=i[p],w=0,F=V.length;w<F;w++)K=V[w],h+=(w?"L":"M")+K.x+" "+K.y;h+=c?D.svg?"z":"x":""}return h||"M0 0"}var ae=document.documentElement.style,ye="ActiveXObject"in window,le=ye&&!document.addEventListener,Ne="msLaunchUri"in navigator&&!("documentMode"in document),Je=ge("webkit"),Jn=ge("android"),Ie=ge("android 2")||ge("android 3"),$=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),qe=Jn&&ge("Google")&&$<537&&!("AudioNode"in window),We=!!window.opera,Ee=!Ne&&ge("chrome"),ee=ge("gecko")&&!Je&&!We&&!ye,Be=!Ee&&ge("safari"),tt=ge("phantom"),Ot="OTransition"in ae,Cn=navigator.platform.indexOf("Win")===0,Ae=ye&&"transition"in ae,Tt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ie,pr="MozPerspective"in ae,Ur=!window.L_DISABLE_3D&&(Ae||Tt||pr)&&!Ot&&!tt,Lt=typeof orientation<"u"||ge("mobile"),Xe=Lt&&Je,mr=Lt&&Tt,Mn=!window.PointerEvent&&window.MSPointerEvent,Vi=!!(window.PointerEvent||Mn),Y="ontouchstart"in window||!!window.TouchEvent,X=!window.L_NO_TOUCH&&(Y||Vi),de=Lt&&We,fe=Lt&&ee,_e=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Bt=function(){var i=!1;try{var c=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return i}(),ke=function(){return!!document.createElement("canvas").getContext}(),nt=!!(document.createElementNS&&he("svg").createSVGRect),ft=!!nt&&function(){var i=document.createElement("div");return i.innerHTML="<svg/>",(i.firstChild&&i.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Z=!nt&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var c=i.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Re=navigator.platform.indexOf("Mac")===0,De=navigator.platform.indexOf("Linux")===0;function ge(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var D={ie:ye,ielt9:le,edge:Ne,webkit:Je,android:Jn,android23:Ie,androidStock:qe,opera:We,chrome:Ee,gecko:ee,safari:Be,phantom:tt,opera12:Ot,win:Cn,ie3d:Ae,webkit3d:Tt,gecko3d:pr,any3d:Ur,mobile:Lt,mobileWebkit:Xe,mobileWebkit3d:mr,msPointer:Mn,pointer:Vi,touch:X,touchNative:Y,mobileOpera:de,mobileGecko:fe,retina:_e,passiveEvents:Bt,canvas:ke,svg:nt,vml:Z,inlineSvg:ft,mac:Re,linux:De},Ge=D.msPointer?"MSPointerDown":"pointerdown",ot=D.msPointer?"MSPointerMove":"pointermove",Pe=D.msPointer?"MSPointerUp":"pointerup",gt=D.msPointer?"MSPointerCancel":"pointercancel",Ht={touchstart:Ge,touchmove:ot,touchend:Pe,touchcancel:gt},gn={touchstart:yi,touchmove:gr,touchend:gr,touchcancel:gr},an={},Qn=!1;function Jt(i,c,h){return c==="touchstart"&&qi(),gn[c]?(h=gn[c].bind(this,h),i.addEventListener(Ht[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function Nt(i,c,h){if(!Ht[c]){console.warn("wrong event specified:",c);return}i.removeEventListener(Ht[c],h,!1)}function kt(i){an[i.pointerId]=i}function Fn(i){an[i.pointerId]&&(an[i.pointerId]=i)}function gi(i){delete an[i.pointerId]}function qi(){Qn||(document.addEventListener(Ge,kt,!0),document.addEventListener(ot,Fn,!0),document.addEventListener(Pe,gi,!0),document.addEventListener(gt,gi,!0),Qn=!0)}function gr(i,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in an)c.touches.push(an[h]);c.changedTouches=[c],i(c)}}function yi(i,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&zt(c),gr(i,c)}function vi(i){var c={},h,p;for(p in i)h=i[p],c[p]=h&&h.bind?h.bind(i):h;return i=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var xi=200;function _i(i,c){i.addEventListener("dblclick",c);var h=0,p;function w(I){if(I.detail!==1){p=I.detail;return}if(!(I.pointerType==="mouse"||I.sourceCapabilities&&!I.sourceCapabilities.firesTouchEvents)){var F=Yu(I);if(!(F.some(function(K){return K instanceof HTMLLabelElement&&K.attributes.for})&&!F.some(function(K){return K instanceof HTMLInputElement||K instanceof HTMLSelectElement}))){var V=Date.now();V-h<=xi?(p++,p===2&&c(vi(I))):p=1,h=V}}}return i.addEventListener("click",w),{dblclick:c,simDblclick:w}}function wi(i,c){i.removeEventListener("dblclick",c.dblclick),i.removeEventListener("click",c.simDblclick)}var yr=tr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Un=tr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Or=Un==="webkitTransition"||Un==="OTransition"?Un+"End":"transitionend";function zr(i){return typeof i=="string"?document.getElementById(i):i}function On(i,c){var h=i.style[c]||i.currentStyle&&i.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(i,null);h=p?p[c]:null}return h==="auto"?null:h}function He(i,c,h){var p=document.createElement(i);return p.className=c||"",h&&h.appendChild(p),p}function it(i){var c=i.parentNode;c&&c.removeChild(i)}function Xn(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function Nn(i){var c=i.parentNode;c&&c.lastChild!==i&&c.appendChild(i)}function kn(i){var c=i.parentNode;c&&c.firstChild!==i&&c.insertBefore(i,c.firstChild)}function vr(i,c){if(i.classList!==void 0)return i.classList.contains(c);var h=er(i);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function Fe(i,c){if(i.classList!==void 0)for(var h=S(c),p=0,w=h.length;p<w;p++)i.classList.add(h[p]);else if(!vr(i,c)){var I=er(i);xr(i,(I?I+" ":"")+c)}}function lt(i,c){i.classList!==void 0?i.classList.remove(c):xr(i,k((" "+er(i)+" ").replace(" "+c+" "," ")))}function xr(i,c){i.className.baseVal===void 0?i.className=c:i.className.baseVal=c}function er(i){return i.correspondingElement&&(i=i.correspondingElement),i.className.baseVal===void 0?i.className:i.className.baseVal}function Rt(i,c){"opacity"in i.style?i.style.opacity=c:"filter"in i.style&&ji(i,c)}function ji(i,c){var h=!1,p="DXImageTransform.Microsoft.Alpha";try{h=i.filters.item(p)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):i.style.filter+=" progid:"+p+"(opacity="+c+")"}function tr(i){for(var c=document.documentElement.style,h=0;h<i.length;h++)if(i[h]in c)return i[h];return!1}function Ye(i,c,h){var p=c||new W(0,0);i.style[yr]=(D.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(h?" scale("+h+")":"")}function ct(i,c){i._leaflet_pos=c,D.any3d?Ye(i,c):(i.style.left=c.x+"px",i.style.top=c.y+"px")}function nr(i){return i._leaflet_pos||new W(0,0)}var Dr,$r,Gi;if("onselectstart"in document)Dr=function(){Ue(window,"selectstart",zt)},$r=function(){st(window,"selectstart",zt)};else{var Wr=tr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Dr=function(){if(Wr){var i=document.documentElement.style;Gi=i[Wr],i[Wr]="none"}},$r=function(){Wr&&(document.documentElement.style[Wr]=Gi,Gi=void 0)}}function Yi(){Ue(window,"dragstart",zt)}function Ki(){st(window,"dragstart",zt)}var Si,Ji;function Qi(i){for(;i.tabIndex===-1;)i=i.parentNode;i.style&&(Ci(),Si=i,Ji=i.style.outlineStyle,i.style.outlineStyle="none",Ue(window,"keydown",Ci))}function Ci(){Si&&(Si.style.outlineStyle=Ji,Si=void 0,Ji=void 0,st(window,"keydown",Ci))}function Ws(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body);return i}function Xi(i){var c=i.getBoundingClientRect();return{x:c.width/i.offsetWidth||1,y:c.height/i.offsetHeight||1,boundingClientRect:c}}var Ja={__proto__:null,TRANSFORM:yr,TRANSITION:Un,TRANSITION_END:Or,get:zr,getStyle:On,create:He,remove:it,empty:Xn,toFront:Nn,toBack:kn,hasClass:vr,addClass:Fe,removeClass:lt,setClass:xr,getClass:er,setOpacity:Rt,testProp:tr,setTransform:Ye,setPosition:ct,getPosition:nr,get disableTextSelection(){return Dr},get enableTextSelection(){return $r},disableImageDrag:Yi,enableImageDrag:Ki,preventOutline:Qi,restoreOutline:Ci,getSizedParentNode:Ws,getScale:Xi};function Ue(i,c,h,p){if(c&&typeof c=="object")for(var w in c)ts(i,w,c[w],h);else{c=S(c);for(var I=0,F=c.length;I<F;I++)ts(i,c[I],h,p)}return this}var yn="_leaflet_events";function st(i,c,h,p){if(arguments.length===1)Hs(i),delete i[yn];else if(c&&typeof c=="object")for(var w in c)ns(i,w,c[w],h);else if(c=S(c),arguments.length===2)Hs(i,function(V){return b(c,V)!==-1});else for(var I=0,F=c.length;I<F;I++)ns(i,c[I],h,p);return this}function Hs(i,c){for(var h in i[yn]){var p=h.split(/\d/)[0];(!c||c(p))&&ns(i,p,null,null,h)}}var es={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ts(i,c,h,p){var w=c+u(h)+(p?"_"+u(p):"");if(i[yn]&&i[yn][w])return this;var I=function(V){return h.call(p||i,V||window.event)},F=I;!D.touchNative&&D.pointer&&c.indexOf("touch")===0?I=Jt(i,c,I):D.touch&&c==="dblclick"?I=_i(i,I):"addEventListener"in i?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?i.addEventListener(es[c]||c,I,D.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(I=function(V){V=V||window.event,Ol(i,V)&&F(V)},i.addEventListener(es[c],I,!1)):i.addEventListener(c,F,!1):i.attachEvent("on"+c,I),i[yn]=i[yn]||{},i[yn][w]=I}function ns(i,c,h,p,w){w=w||c+u(h)+(p?"_"+u(p):"");var I=i[yn]&&i[yn][w];if(!I)return this;!D.touchNative&&D.pointer&&c.indexOf("touch")===0?Nt(i,c,I):D.touch&&c==="dblclick"?wi(i,I):"removeEventListener"in i?i.removeEventListener(es[c]||c,I,!1):i.detachEvent("on"+c,I),i[yn][w]=null}function rr(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function jt(i){return ts(i,"wheel",rr),this}function Zs(i){return Ue(i,"mousedown touchstart dblclick contextmenu",rr),i._leaflet_disable_click=!0,this}function zt(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function Ni(i){return zt(i),rr(i),this}function Yu(i){if(i.composedPath)return i.composedPath();for(var c=[],h=i.target;h;)c.push(h),h=h.parentNode;return c}function Ku(i,c){if(!c)return new W(i.clientX,i.clientY);var h=Xi(c),p=h.boundingClientRect;return new W((i.clientX-p.left)/h.x-c.clientLeft,(i.clientY-p.top)/h.y-c.clientTop)}var Ay=D.linux&&D.chrome?window.devicePixelRatio:D.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ju(i){return D.edge?i.wheelDeltaY/2:i.deltaY&&i.deltaMode===0?-i.deltaY/Ay:i.deltaY&&i.deltaMode===1?-i.deltaY*20:i.deltaY&&i.deltaMode===2?-i.deltaY*60:i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&Math.abs(i.detail)<32765?-i.detail*20:i.detail?i.detail/-32765*60:0}function Ol(i,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==i;)h=h.parentNode}catch{return!1}return h!==i}var My={__proto__:null,on:Ue,off:st,stopPropagation:rr,disableScrollPropagation:jt,disableClickPropagation:Zs,preventDefault:zt,stop:Ni,getPropagationPath:Yu,getMousePosition:Ku,getWheelDelta:Ju,isExternalTarget:Ol,addListener:Ue,removeListener:st},Qu=M.extend({run:function(i,c,h,p){this.stop(),this._el=i,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=nr(i),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=A(this._animate,this),this._step()},_step:function(i){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),i):(this._runFrame(1),this._complete())},_runFrame:function(i,c){var h=this._startPos.add(this._offset.multiplyBy(i));c&&h._round(),ct(this._el,h),this.fire("step")},_complete:function(){H(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),Ke=M.extend({options:{crs:et,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,c){c=_(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(G(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Un&&D.any3d&&!D.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ue(this._proxy,Or,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),i=this._limitCenter(G(i),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=o({animate:h.animate},h.zoom),h.pan=o({animate:h.animate,duration:h.duration},h.pan));var p=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,c,h.zoom):this._tryAnimatedPan(i,h.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(i,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(i,c){return this._loaded?this.setView(this.getCenter(),i,{zoom:c}):(this._zoom=i,this)},zoomIn:function(i,c){return i=i||(D.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,c)},zoomOut:function(i,c){return i=i||(D.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,c)},setZoomAround:function(i,c,h){var p=this.getZoomScale(c),w=this.getSize().divideBy(2),I=i instanceof W?i:this.latLngToContainerPoint(i),F=I.subtract(w).multiplyBy(1-1/p),V=this.containerPointToLatLng(w.add(F));return this.setView(V,c,{zoom:h})},_getBoundsCenterZoom:function(i,c){c=c||{},i=i.getBounds?i.getBounds():z(i);var h=ne(c.paddingTopLeft||c.padding||[0,0]),p=ne(c.paddingBottomRight||c.padding||[0,0]),w=this.getBoundsZoom(i,!1,h.add(p));if(w=typeof c.maxZoom=="number"?Math.min(c.maxZoom,w):w,w===1/0)return{center:i.getCenter(),zoom:w};var I=p.subtract(h).divideBy(2),F=this.project(i.getSouthWest(),w),V=this.project(i.getNorthEast(),w),K=this.unproject(F.add(V).divideBy(2).add(I),w);return{center:K,zoom:w}},fitBounds:function(i,c){if(i=z(i),!i.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(i,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,c){return this.setView(i,this._zoom,{pan:c})},panBy:function(i,c){if(i=ne(i).round(),c=c||{},!i.x&&!i.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Qu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){Fe(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,c,h){if(h=h||{},h.animate===!1||!D.any3d)return this.setView(i,c,h);this._stop();var p=this.project(this.getCenter()),w=this.project(i),I=this.getSize(),F=this._zoom;i=G(i),c=c===void 0?F:c;var V=Math.max(I.x,I.y),K=V*this.getZoomScale(F,c),oe=w.distanceTo(p)||1,Se=1.42,Me=Se*Se;function Ze(bt){var co=bt?-1:1,Cv=bt?K:V,Nv=K*K-V*V+co*Me*Me*oe*oe,kv=2*Cv*Me*oe,Kl=Nv/kv,Th=Math.sqrt(Kl*Kl+1)-Kl,bv=Th<1e-9?-18:Math.log(Th);return bv}function Qt(bt){return(Math.exp(bt)-Math.exp(-bt))/2}function At(bt){return(Math.exp(bt)+Math.exp(-bt))/2}function In(bt){return Qt(bt)/At(bt)}var on=Ze(0);function ls(bt){return V*(At(on)/At(on+Se*bt))}function _v(bt){return V*(At(on)*In(on+Se*bt)-Qt(on))/Me}function wv(bt){return 1-Math.pow(1-bt,1.5)}var jv=Date.now(),Ph=(Ze(1)-on)/Se,Sv=h.duration?1e3*h.duration:1e3*Ph*.8;function Eh(){var bt=(Date.now()-jv)/Sv,co=wv(bt)*Ph;bt<=1?(this._flyToFrame=A(Eh,this),this._move(this.unproject(p.add(w.subtract(p).multiplyBy(_v(co)/oe)),F),this.getScaleZoom(V/ls(co),F),{flyTo:!0})):this._move(i,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Eh.call(this),this},flyToBounds:function(i,c){var h=this._getBoundsCenterZoom(i,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(i){return i=z(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid()?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var c=this.options.minZoom;return this.options.minZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(i):this},setMaxZoom:function(i){var c=this.options.maxZoom;return this.options.maxZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(i):this},panInsideBounds:function(i,c){this._enforcingBounds=!0;var h=this.getCenter(),p=this._limitCenter(h,this._zoom,z(i));return h.equals(p)||this.panTo(p,c),this._enforcingBounds=!1,this},panInside:function(i,c){c=c||{};var h=ne(c.paddingTopLeft||c.padding||[0,0]),p=ne(c.paddingBottomRight||c.padding||[0,0]),w=this.project(this.getCenter()),I=this.project(i),F=this.getPixelBounds(),V=xe([F.min.add(h),F.max.subtract(p)]),K=V.getSize();if(!V.contains(I)){this._enforcingBounds=!0;var oe=I.subtract(V.getCenter()),Se=V.extend(I).getSize().subtract(K);w.x+=oe.x<0?-Se.x:Se.x,w.y+=oe.y<0?-Se.y:Se.y,this.panTo(this.unproject(w),c),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=o({animate:!1,pan:!0},i===!0?{animate:!0}:i);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),p=c.divideBy(2).round(),w=h.divideBy(2).round(),I=p.subtract(w);return!I.x&&!I.y?this:(i.animate&&i.pan?this.panBy(I):(i.pan&&this._rawPanBy(I),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=o({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,i):navigator.geolocation.getCurrentPosition(c,h,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var c=i.code,h=i.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var c=i.coords.latitude,h=i.coords.longitude,p=new re(c,h),w=p.toBounds(i.coords.accuracy*2),I=this._locateOptions;if(I.setView){var F=this.getBoundsZoom(w);this.setView(p,I.maxZoom?Math.min(F,I.maxZoom):F)}var V={latlng:p,bounds:w,timestamp:i.timestamp};for(var K in i.coords)typeof i.coords[K]=="number"&&(V[K]=i.coords[K]);this.fire("locationfound",V)}},addHandler:function(i,c){if(!c)return this;var h=this[i]=new c(this);return this._handlers.push(h),this.options[i]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),it(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(H(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)it(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,c){var h="leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),p=He("div",h,c||this._mapPane);return i&&(this._panes[i]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),c=this.unproject(i.getBottomLeft()),h=this.unproject(i.getTopRight());return new ce(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,c,h){i=z(i),h=ne(h||[0,0]);var p=this.getZoom()||0,w=this.getMinZoom(),I=this.getMaxZoom(),F=i.getNorthWest(),V=i.getSouthEast(),K=this.getSize().subtract(h),oe=xe(this.project(V,p),this.project(F,p)).getSize(),Se=D.any3d?this.options.zoomSnap:1,Me=K.x/oe.x,Ze=K.y/oe.y,Qt=c?Math.max(Me,Ze):Math.min(Me,Ze);return p=this.getScaleZoom(Qt,p),Se&&(p=Math.round(p/(Se/100))*(Se/100),p=c?Math.ceil(p/Se)*Se:Math.floor(p/Se)*Se),Math.max(w,Math.min(I,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,c){var h=this._getTopLeftPoint(i,c);return new ve(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(i===void 0?this.getZoom():i)},getPane:function(i){return typeof i=="string"?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(i)/h.scale(c)},getScaleZoom:function(i,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var p=h.zoom(i*h.scale(c));return isNaN(p)?1/0:p},project:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(G(i),c)},unproject:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ne(i),c)},layerPointToLatLng:function(i){var c=ne(i).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(i){var c=this.project(G(i))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(G(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(z(i))},distance:function(i,c){return this.options.crs.distance(G(i),G(c))},containerPointToLayerPoint:function(i){return ne(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return ne(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var c=this.containerPointToLayerPoint(ne(i));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(i)))},mouseEventToContainerPoint:function(i){return Ku(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var c=this._container=zr(i);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ue(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&D.any3d,Fe(i,"leaflet-container"+(D.touch?" leaflet-touch":"")+(D.retina?" leaflet-retina":"")+(D.ielt9?" leaflet-oldie":"")+(D.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=On(i,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ct(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Fe(i.markerPane,"leaflet-zoom-hide"),Fe(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,c,h){ct(this._mapPane,new W(0,0));var p=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var w=this._zoom!==c;this._moveStart(w,h)._move(i,c)._moveEnd(w),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(i,c){return i&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(i,c,h,p){c===void 0&&(c=this._zoom);var w=this._zoom!==c;return this._zoom=c,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),p?h&&h.pinch&&this.fire("zoom",h):((w||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return H(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){ct(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[u(this._container)]=this;var c=i?st:Ue;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),D.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){H(this._resizeRequest),this._resizeRequest=A(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,c){for(var h=[],p,w=c==="mouseout"||c==="mouseover",I=i.target||i.srcElement,F=!1;I;){if(p=this._targets[u(I)],p&&(c==="click"||c==="preclick")&&this._draggableMoved(p)){F=!0;break}if(p&&p.listens(c,!0)&&(w&&!Ol(I,i)||(h.push(p),w))||I===this._container)break;I=I.parentNode}return!h.length&&!F&&!w&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var c=i.target||i.srcElement;if(!(!this._loaded||c._leaflet_disable_events||i.type==="click"&&this._isClickDisabled(c))){var h=i.type;h==="mousedown"&&Qi(c),this._fireDOMEvent(i,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,c,h){if(i.type==="click"){var p=o({},i);p.type="preclick",this._fireDOMEvent(p,p.type,h)}var w=this._findEventTargets(i,c);if(h){for(var I=[],F=0;F<h.length;F++)h[F].listens(c,!0)&&I.push(h[F]);w=I.concat(w)}if(w.length){c==="contextmenu"&&zt(i);var V=w[0],K={originalEvent:i};if(i.type!=="keypress"&&i.type!=="keydown"&&i.type!=="keyup"){var oe=V.getLatLng&&(!V._radius||V._radius<=10);K.containerPoint=oe?this.latLngToContainerPoint(V.getLatLng()):this.mouseEventToContainerPoint(i),K.layerPoint=this.containerPointToLayerPoint(K.containerPoint),K.latlng=oe?V.getLatLng():this.layerPointToLatLng(K.layerPoint)}for(F=0;F<w.length;F++)if(w[F].fire(c,K,!0),K.originalEvent._stopped||w[F].options.bubblingMouseEvents===!1&&b(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(i){return i=i.dragging&&i.dragging.enabled()?i:this,i.dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,c=this._handlers.length;i<c;i++)this._handlers[i].disable()},whenReady:function(i,c){return this._loaded?i.call(c||this,{target:this}):this.on("load",i,c),this},_getMapPanePos:function(){return nr(this._mapPane)||new W(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,c){var h=i&&c!==void 0?this._getNewPixelOrigin(i,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,c){var h=this.getSize()._divideBy(2);return this.project(i,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,c,h){var p=this._getNewPixelOrigin(h,c);return this.project(i,c)._subtract(p)},_latLngBoundsToNewLayerBounds:function(i,c,h){var p=this._getNewPixelOrigin(h,c);return xe([this.project(i.getSouthWest(),c)._subtract(p),this.project(i.getNorthWest(),c)._subtract(p),this.project(i.getSouthEast(),c)._subtract(p),this.project(i.getNorthEast(),c)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,c,h){if(!h)return i;var p=this.project(i,c),w=this.getSize().divideBy(2),I=new ve(p.subtract(w),p.add(w)),F=this._getBoundsOffset(I,h,c);return Math.abs(F.x)<=1&&Math.abs(F.y)<=1?i:this.unproject(p.add(F),c)},_limitOffset:function(i,c){if(!c)return i;var h=this.getPixelBounds(),p=new ve(h.min.add(i),h.max.add(i));return i.add(this._getBoundsOffset(p,c))},_getBoundsOffset:function(i,c,h){var p=xe(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),w=p.min.subtract(i.min),I=p.max.subtract(i.max),F=this._rebound(w.x,-I.x),V=this._rebound(w.y,-I.y);return new W(F,V)},_rebound:function(i,c){return i+c>0?Math.round(i-c)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(c))},_limitZoom:function(i){var c=this.getMinZoom(),h=this.getMaxZoom(),p=D.any3d?this.options.zoomSnap:1;return p&&(i=Math.round(i/p)*p),Math.max(c,Math.min(h,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){lt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,c){var h=this._getCenterOffset(i)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var i=this._proxy=He("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(c){var h=yr,p=this._proxy.style[h];Ye(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),p===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){it(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),c=this.getZoom();Ye(this._proxy,this.project(i,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(c),w=this._getCenterOffset(i)._divideBy(1-1/p);return h.animate!==!0&&!this.getSize().contains(w)?!1:(A(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(i,c,!0)},this),!0)},_animateZoom:function(i,c,h,p){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=c,Fe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:c,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&lt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Fy(i,c){return new Ke(i,c)}var zn=O.extend({options:{position:"topright"},initialize:function(i){_(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var c=this._map;return c&&c.removeControl(this),this.options.position=i,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var c=this._container=this.onAdd(i),h=this.getPosition(),p=i._controlCorners[h];return Fe(c,"leaflet-control"),h.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(it(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),Vs=function(i){return new zn(i)};Ke.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},c="leaflet-",h=this._controlContainer=He("div",c+"control-container",this._container);function p(w,I){var F=c+w+" "+c+I;i[w+I]=He("div",F,h)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)it(this._controlCorners[i]);it(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Xu=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,c,h,p){return h<p?-1:p<h?1:0}},initialize:function(i,c,h){_(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in i)this._addLayer(i[p],p);for(p in c)this._addLayer(c[p],p,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return zn.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,c){return this._addLayer(i,c),this._map?this._update():this},addOverlay:function(i,c){return this._addLayer(i,c,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(i));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){Fe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(Fe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):lt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return lt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",c=this._container=He("div",i),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Zs(c),jt(c);var p=this._section=He("section",i+"-list");h&&(this._map.on("click",this.collapse,this),Ue(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var w=this._layersLink=He("a",i+"-toggle",c);w.href="#",w.title="Layers",w.setAttribute("role","button"),Ue(w,{keydown:function(I){I.keyCode===13&&this._expandSafely()},click:function(I){zt(I),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=He("div",i+"-base",p),this._separator=He("div",i+"-separator",p),this._overlaysList=He("div",i+"-overlays",p),c.appendChild(p)},_getLayer:function(i){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===i)return this._layers[c]},_addLayer:function(i,c,h){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(p,w){return this.options.sortFunction(p.layer,w.layer,p.name,w.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xn(this._baseLayersList),Xn(this._overlaysList),this._layerControlInputs=[];var i,c,h,p,w=0;for(h=0;h<this._layers.length;h++)p=this._layers[h],this._addItem(p),c=c||p.overlay,i=i||!p.overlay,w+=p.overlay?0:1;return this.options.hideSingleBase&&(i=i&&w>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=c&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var c=this._getLayer(u(i.target)),h=c.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(i,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(c?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=h,p.firstChild},_addItem:function(i){var c=document.createElement("label"),h=this._map.hasLayer(i.layer),p;i.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=h):p=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(p),p.layerId=u(i.layer),Ue(p,"click",this._onInputClick,this);var w=document.createElement("span");w.innerHTML=" "+i.name;var I=document.createElement("span");c.appendChild(I),I.appendChild(p),I.appendChild(w);var F=i.overlay?this._overlaysList:this._baseLayersList;return F.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var i=this._layerControlInputs,c,h,p=[],w=[];this._handlingClick=!0;for(var I=i.length-1;I>=0;I--)c=i[I],h=this._getLayer(c.layerId).layer,c.checked?p.push(h):c.checked||w.push(h);for(I=0;I<w.length;I++)this._map.hasLayer(w[I])&&this._map.removeLayer(w[I]);for(I=0;I<p.length;I++)this._map.hasLayer(p[I])||this._map.addLayer(p[I]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i=this._layerControlInputs,c,h,p=this._map.getZoom(),w=i.length-1;w>=0;w--)c=i[w],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&p<h.options.minZoom||h.options.maxZoom!==void 0&&p>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,Ue(i,"click",zt),this.expand();var c=this;setTimeout(function(){st(i,"click",zt),c._preventClick=!1})}}),Uy=function(i,c,h){return new Xu(i,c,h)},zl=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var c="leaflet-control-zoom",h=He("div",c+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,c,h,p,w){var I=He("a",h,p);return I.innerHTML=i,I.href="#",I.title=c,I.setAttribute("role","button"),I.setAttribute("aria-label",c),Zs(I),Ue(I,"click",Ni),Ue(I,"click",w,this),Ue(I,"click",this._refocusOnMap,this),I},_updateDisabled:function(){var i=this._map,c="leaflet-disabled";lt(this._zoomInButton,c),lt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(Fe(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(Fe(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ke.mergeOptions({zoomControl:!0}),Ke.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zl,this.addControl(this.zoomControl))});var Oy=function(i){return new zl(i)},eh=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var c="leaflet-control-scale",h=He("div",c),p=this.options;return this._addScales(p,c+"-line",h),i.on(p.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),h},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,c,h){i.metric&&(this._mScale=He("div",c,h)),i.imperial&&(this._iScale=He("div",c,h))},_update:function(){var i=this._map,c=i.getSize().y/2,h=i.distance(i.containerPointToLatLng([0,c]),i.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var c=this._getRoundNum(i),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/i)},_updateImperial:function(i){var c=i*3.2808399,h,p,w;c>5280?(h=c/5280,p=this._getRoundNum(h),this._updateScale(this._iScale,p+" mi",p/h)):(w=this._getRoundNum(c),this._updateScale(this._iScale,w+" ft",w/c))},_updateScale:function(i,c,h){i.style.width=Math.round(this.options.maxWidth*h)+"px",i.innerHTML=c},_getRoundNum:function(i){var c=Math.pow(10,(Math.floor(i)+"").length-1),h=i/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),zy=function(i){return new eh(i)},Dy='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Dl=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(D.inlineSvg?Dy+" ":"")+"Leaflet</a>"},initialize:function(i){_(this,i),this._attributions={}},onAdd:function(i){i.attributionControl=this,this._container=He("div","leaflet-control-attribution"),Zs(this._container);for(var c in i._layers)i._layers[c].getAttribution&&this.addAttribution(i._layers[c].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i?(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update(),this):this},removeAttribution:function(i){return i?(this._attributions[i]&&(this._attributions[i]--,this._update()),this):this},_update:function(){if(this._map){var i=[];for(var c in this._attributions)this._attributions[c]&&i.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),i.length&&h.push(i.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});Ke.mergeOptions({attributionControl:!0}),Ke.addInitHook(function(){this.options.attributionControl&&new Dl().addTo(this)});var $y=function(i){return new Dl(i)};zn.Layers=Xu,zn.Zoom=zl,zn.Scale=eh,zn.Attribution=Dl,Vs.layers=Uy,Vs.zoom=Oy,Vs.scale=zy,Vs.attribution=$y;var ir=O.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ir.addTo=function(i,c){return i.addHandler(c,this),this};var Wy={Events:ie},th=D.touch?"touchstart mousedown":"mousedown",Hr=M.extend({options:{clickTolerance:3},initialize:function(i,c,h,p){_(this,p),this._element=i,this._dragStartTarget=c||i,this._preventOutline=h},enable:function(){this._enabled||(Ue(this._dragStartTarget,th,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Hr._dragging===this&&this.finishDrag(!0),st(this._dragStartTarget,th,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(this._enabled&&(this._moved=!1,!vr(this._element,"leaflet-zoom-anim"))){if(i.touches&&i.touches.length!==1){Hr._dragging===this&&this.finishDrag();return}if(!(Hr._dragging||i.shiftKey||i.which!==1&&i.button!==1&&!i.touches)&&(Hr._dragging=this,this._preventOutline&&Qi(this._element),Yi(),Dr(),!this._moving)){this.fire("down");var c=i.touches?i.touches[0]:i,h=Ws(this._element);this._startPoint=new W(c.clientX,c.clientY),this._startPos=nr(this._element),this._parentScale=Xi(h);var p=i.type==="mousedown";Ue(document,p?"mousemove":"touchmove",this._onMove,this),Ue(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var c=i.touches&&i.touches.length===1?i.touches[0]:i,h=new W(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,zt(i),this._moved||(this.fire("dragstart"),this._moved=!0,Fe(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Fe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=i,this._updatePosition())}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),ct(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){lt(document.body,"leaflet-dragging"),this._lastTarget&&(lt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),st(document,"mousemove touchmove",this._onMove,this),st(document,"mouseup touchend touchcancel",this._onUp,this),Ki(),$r();var c=this._moved&&this._moving;this._moving=!1,Hr._dragging=!1,c&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function nh(i,c,h){var p,w=[1,4,2,8],I,F,V,K,oe,Se,Me,Ze;for(I=0,Se=i.length;I<Se;I++)i[I]._code=ki(i[I],c);for(V=0;V<4;V++){for(Me=w[V],p=[],I=0,Se=i.length,F=Se-1;I<Se;F=I++)K=i[I],oe=i[F],K._code&Me?oe._code&Me||(Ze=Qa(oe,K,Me,c,h),Ze._code=ki(Ze,c),p.push(Ze)):(oe._code&Me&&(Ze=Qa(oe,K,Me,c,h),Ze._code=ki(Ze,c),p.push(Ze)),p.push(K));i=p}return i}function rh(i,c){var h,p,w,I,F,V,K,oe,Se;if(!i||i.length===0)throw new Error("latlngs not passed");bn(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Me=G([0,0]),Ze=z(i),Qt=Ze.getNorthWest().distanceTo(Ze.getSouthWest())*Ze.getNorthEast().distanceTo(Ze.getNorthWest());Qt<1700&&(Me=$l(i));var At=i.length,In=[];for(h=0;h<At;h++){var on=G(i[h]);In.push(c.project(G([on.lat-Me.lat,on.lng-Me.lng])))}for(V=K=oe=0,h=0,p=At-1;h<At;p=h++)w=In[h],I=In[p],F=w.y*I.x-I.y*w.x,K+=(w.x+I.x)*F,oe+=(w.y+I.y)*F,V+=F*3;V===0?Se=In[0]:Se=[K/V,oe/V];var ls=c.unproject(ne(Se));return G([ls.lat+Me.lat,ls.lng+Me.lng])}function $l(i){for(var c=0,h=0,p=0,w=0;w<i.length;w++){var I=G(i[w]);c+=I.lat,h+=I.lng,p++}return G([c/p,h/p])}var Hy={__proto__:null,clipPolygon:nh,polygonCenter:rh,centroid:$l};function ih(i,c){if(!c||!i.length)return i.slice();var h=c*c;return i=qy(i,h),i=Vy(i,h),i}function sh(i,c,h){return Math.sqrt(qs(i,c,h,!0))}function Zy(i,c,h){return qs(i,c,h)}function Vy(i,c){var h=i.length,p=typeof Uint8Array<"u"?Uint8Array:Array,w=new p(h);w[0]=w[h-1]=1,Wl(i,w,c,0,h-1);var I,F=[];for(I=0;I<h;I++)w[I]&&F.push(i[I]);return F}function Wl(i,c,h,p,w){var I=0,F,V,K;for(V=p+1;V<=w-1;V++)K=qs(i[V],i[p],i[w],!0),K>I&&(F=V,I=K);I>h&&(c[F]=1,Wl(i,c,h,p,F),Wl(i,c,h,F,w))}function qy(i,c){for(var h=[i[0]],p=1,w=0,I=i.length;p<I;p++)Gy(i[p],i[w])>c&&(h.push(i[p]),w=p);return w<I-1&&h.push(i[I-1]),h}var ah;function oh(i,c,h,p,w){var I=p?ah:ki(i,h),F=ki(c,h),V,K,oe;for(ah=F;;){if(!(I|F))return[i,c];if(I&F)return!1;V=I||F,K=Qa(i,c,V,h,w),oe=ki(K,h),V===I?(i=K,I=oe):(c=K,F=oe)}}function Qa(i,c,h,p,w){var I=c.x-i.x,F=c.y-i.y,V=p.min,K=p.max,oe,Se;return h&8?(oe=i.x+I*(K.y-i.y)/F,Se=K.y):h&4?(oe=i.x+I*(V.y-i.y)/F,Se=V.y):h&2?(oe=K.x,Se=i.y+F*(K.x-i.x)/I):h&1&&(oe=V.x,Se=i.y+F*(V.x-i.x)/I),new W(oe,Se,w)}function ki(i,c){var h=0;return i.x<c.min.x?h|=1:i.x>c.max.x&&(h|=2),i.y<c.min.y?h|=4:i.y>c.max.y&&(h|=8),h}function Gy(i,c){var h=c.x-i.x,p=c.y-i.y;return h*h+p*p}function qs(i,c,h,p){var w=c.x,I=c.y,F=h.x-w,V=h.y-I,K=F*F+V*V,oe;return K>0&&(oe=((i.x-w)*F+(i.y-I)*V)/K,oe>1?(w=h.x,I=h.y):oe>0&&(w+=F*oe,I+=V*oe)),F=i.x-w,V=i.y-I,p?F*F+V*V:new W(w,I)}function bn(i){return!N(i[0])||typeof i[0][0]!="object"&&typeof i[0][0]<"u"}function lh(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),bn(i)}function ch(i,c){var h,p,w,I,F,V,K,oe;if(!i||i.length===0)throw new Error("latlngs not passed");bn(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Se=G([0,0]),Me=z(i),Ze=Me.getNorthWest().distanceTo(Me.getSouthWest())*Me.getNorthEast().distanceTo(Me.getNorthWest());Ze<1700&&(Se=$l(i));var Qt=i.length,At=[];for(h=0;h<Qt;h++){var In=G(i[h]);At.push(c.project(G([In.lat-Se.lat,In.lng-Se.lng])))}for(h=0,p=0;h<Qt-1;h++)p+=At[h].distanceTo(At[h+1])/2;if(p===0)oe=At[0];else for(h=0,I=0;h<Qt-1;h++)if(F=At[h],V=At[h+1],w=F.distanceTo(V),I+=w,I>p){K=(I-p)/w,oe=[V.x-K*(V.x-F.x),V.y-K*(V.y-F.y)];break}var on=c.unproject(ne(oe));return G([on.lat+Se.lat,on.lng+Se.lng])}var Yy={__proto__:null,simplify:ih,pointToSegmentDistance:sh,closestPointOnSegment:Zy,clipSegment:oh,_getEdgeIntersection:Qa,_getBitCode:ki,_sqClosestPointOnSegment:qs,isFlat:bn,_flat:lh,polylineCenter:ch},Hl={project:function(i){return new W(i.lng,i.lat)},unproject:function(i){return new re(i.y,i.x)},bounds:new ve([-180,-90],[180,90])},Zl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ve([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(i){var c=Math.PI/180,h=this.R,p=i.lat*c,w=this.R_MINOR/h,I=Math.sqrt(1-w*w),F=I*Math.sin(p),V=Math.tan(Math.PI/4-p/2)/Math.pow((1-F)/(1+F),I/2);return p=-h*Math.log(Math.max(V,1e-10)),new W(i.lng*c*h,p)},unproject:function(i){for(var c=180/Math.PI,h=this.R,p=this.R_MINOR/h,w=Math.sqrt(1-p*p),I=Math.exp(-i.y/h),F=Math.PI/2-2*Math.atan(I),V=0,K=.1,oe;V<15&&Math.abs(K)>1e-7;V++)oe=w*Math.sin(F),oe=Math.pow((1-oe)/(1+oe),w/2),K=Math.PI/2-2*Math.atan(I*oe)-F,F+=K;return new re(F*c,i.x*c/h)}},Ky={__proto__:null,LonLat:Hl,Mercator:Zl,SphericalMercator:je},Jy=o({},Le,{code:"EPSG:3395",projection:Zl,transformation:function(){var i=.5/(Math.PI*Zl.R);return me(i,.5,-i,.5)}()}),dh=o({},Le,{code:"EPSG:4326",projection:Hl,transformation:me(1/180,1,-1/180,.5)}),Qy=o({},we,{projection:Hl,transformation:me(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,c){var h=c.lng-i.lng,p=c.lat-i.lat;return Math.sqrt(h*h+p*p)},infinite:!0});we.Earth=Le,we.EPSG3395=Jy,we.EPSG3857=et,we.EPSG900913=mn,we.EPSG4326=dh,we.Simple=Qy;var Dn=M.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[u(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[u(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var c=i.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Ke.include({addLayer:function(i){if(!i._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(i);return this._layers[c]?this:(this._layers[c]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i),this)},removeLayer:function(i){var c=u(i);return this._layers[c]?(this._loaded&&i.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this},hasLayer:function(i){return u(i)in this._layers},eachLayer:function(i,c){for(var h in this._layers)i.call(c,this._layers[h]);return this},_addLayers:function(i){i=i?N(i)?i:[i]:[];for(var c=0,h=i.length;c<h;c++)this.addLayer(i[c])},_addZoomLimit:function(i){(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom))&&(this._zoomBoundLayers[u(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var c=u(i);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,c=-1/0,h=this._getZoomSpan();for(var p in this._zoomBoundLayers){var w=this._zoomBoundLayers[p].options;i=w.minZoom===void 0?i:Math.min(i,w.minZoom),c=w.maxZoom===void 0?c:Math.max(c,w.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=i===1/0?void 0:i,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var rs=Dn.extend({initialize:function(i,c){_(this,c),this._layers={};var h,p;if(i)for(h=0,p=i.length;h<p;h++)this.addLayer(i[h])},addLayer:function(i){var c=this.getLayerId(i);return this._layers[c]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var c=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(i){var c=typeof i=="number"?i:this.getLayerId(i);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var c=Array.prototype.slice.call(arguments,1),h,p;for(h in this._layers)p=this._layers[h],p[i]&&p[i].apply(p,c);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,c){for(var h in this._layers)i.call(c,this._layers[h]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return u(i)}}),Xy=function(i,c){return new rs(i,c)},_r=rs.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),rs.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),rs.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new ce;for(var c in this._layers){var h=this._layers[c];i.extend(h.getBounds?h.getBounds():h.getLatLng())}return i}}),ev=function(i,c){return new _r(i,c)},is=O.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){_(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,c){var h=this._getIconUrl(i);if(!h){if(i==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(p,i),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(i,c){var h=this.options,p=h[c+"Size"];typeof p=="number"&&(p=[p,p]);var w=ne(p),I=ne(c==="shadow"&&h.shadowAnchor||h.iconAnchor||w&&w.divideBy(2,!0));i.className="leaflet-marker-"+c+" "+(h.className||""),I&&(i.style.marginLeft=-I.x+"px",i.style.marginTop=-I.y+"px"),w&&(i.style.width=w.x+"px",i.style.height=w.y+"px")},_createImg:function(i,c){return c=c||document.createElement("img"),c.src=i,c},_getIconUrl:function(i){return D.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}});function tv(i){return new is(i)}var Gs=is.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return typeof Gs.imagePath!="string"&&(Gs.imagePath=this._detectIconPath()),(this.options.imagePath||Gs.imagePath)+is.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var c=function(h,p,w){var I=p.exec(h);return I&&I[w]};return i=c(i,/^url\((['"])?(.+)\1\)$/,2),i&&c(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=He("div","leaflet-default-icon-path",document.body),c=On(i,"background-image")||On(i,"backgroundImage");if(document.body.removeChild(i),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),uh=ir.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new Hr(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Fe(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&lt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var c=this._marker,h=c._map,p=this._marker.options.autoPanSpeed,w=this._marker.options.autoPanPadding,I=nr(c._icon),F=h.getPixelBounds(),V=h.getPixelOrigin(),K=xe(F.min._subtract(V).add(w),F.max._subtract(V).subtract(w));if(!K.contains(I)){var oe=ne((Math.max(K.max.x,I.x)-K.max.x)/(F.max.x-K.max.x)-(Math.min(K.min.x,I.x)-K.min.x)/(F.min.x-K.min.x),(Math.max(K.max.y,I.y)-K.max.y)/(F.max.y-K.max.y)-(Math.min(K.min.y,I.y)-K.min.y)/(F.min.y-K.min.y)).multiplyBy(p);h.panBy(oe,{animate:!1}),this._draggable._newPos._add(oe),this._draggable._startPos._add(oe),ct(c._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=A(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&(H(this._panRequest),this._panRequest=A(this._adjustPan.bind(this,i)))},_onDrag:function(i){var c=this._marker,h=c._shadow,p=nr(c._icon),w=c._map.layerPointToLatLng(p);h&&ct(h,p),c._latlng=w,i.latlng=w,i.oldLatLng=this._oldLatLng,c.fire("move",i).fire("drag",i)},_onDragEnd:function(i){H(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),Xa=Dn.extend({options:{icon:new Gs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,c){_(this,c),this._latlng=G(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var c=this._latlng;return this._latlng=G(i),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=i.icon.createIcon(this._icon),p=!1;h!==this._icon&&(this._icon&&this._removeIcon(),p=!0,i.title&&(h.title=i.title),h.tagName==="IMG"&&(h.alt=i.alt||"")),Fe(h,c),i.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ue(h,"focus",this._panOnFocus,this);var w=i.icon.createShadow(this._shadow),I=!1;w!==this._shadow&&(this._removeShadow(),I=!0),w&&(Fe(w,c),w.alt=""),this._shadow=w,i.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),w&&I&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(this._icon,"focus",this._panOnFocus,this),it(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&it(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&ct(this._icon,i),this._shadow&&ct(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(Fe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),uh)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new uh(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&Rt(this._icon,i),this._shadow&&Rt(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var c=this.options.icon.options,h=c.iconSize?ne(c.iconSize):ne(0,0),p=c.iconAnchor?ne(c.iconAnchor):ne(0,0);i.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:h.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function nv(i,c){return new Xa(i,c)}var Zr=Dn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return _(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),eo=Zr.extend({options:{fill:!0,radius:10},initialize:function(i,c){_(this,c),this._latlng=G(i),this._radius=this.options.radius},setLatLng:function(i){var c=this._latlng;return this._latlng=G(i),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var c=i&&i.radius||this._radius;return Zr.prototype.setStyle.call(this,i),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,c=this._radiusY||i,h=this._clickTolerance(),p=[i+h,c+h];this._pxBounds=new ve(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function rv(i,c){return new eo(i,c)}var Vl=eo.extend({initialize:function(i,c,h){if(typeof c=="number"&&(c=o({},h,{radius:c})),_(this,c),this._latlng=G(i),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new ce(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:Zr.prototype.setStyle,_project:function(){var i=this._latlng.lng,c=this._latlng.lat,h=this._map,p=h.options.crs;if(p.distance===Le.distance){var w=Math.PI/180,I=this._mRadius/Le.R/w,F=h.project([c+I,i]),V=h.project([c-I,i]),K=F.add(V).divideBy(2),oe=h.unproject(K).lat,Se=Math.acos((Math.cos(I*w)-Math.sin(c*w)*Math.sin(oe*w))/(Math.cos(c*w)*Math.cos(oe*w)))/w;(isNaN(Se)||Se===0)&&(Se=I/Math.cos(Math.PI/180*c)),this._point=K.subtract(h.getPixelOrigin()),this._radius=isNaN(Se)?0:K.x-h.project([oe,i-Se]).x,this._radiusY=K.y-F.y}else{var Me=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(Me).x}this._updateBounds()}});function iv(i,c,h){return new Vl(i,c,h)}var wr=Zr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,c){_(this,c),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var c=1/0,h=null,p=qs,w,I,F=0,V=this._parts.length;F<V;F++)for(var K=this._parts[F],oe=1,Se=K.length;oe<Se;oe++){w=K[oe-1],I=K[oe];var Me=p(i,w,I,!0);Me<c&&(c=Me,h=p(i,w,I))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ch(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,c){return c=c||this._defaultShape(),i=G(i),c.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new ce,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return bn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var c=[],h=bn(i),p=0,w=i.length;p<w;p++)h?(c[p]=G(i[p]),this._bounds.extend(c[p])):c[p]=this._convertLatLngs(i[p]);return c},_project:function(){var i=new ve;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),c=new W(i,i);this._rawPxBounds&&(this._pxBounds=new ve([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(i,c,h){var p=i[0]instanceof re,w=i.length,I,F;if(p){for(F=[],I=0;I<w;I++)F[I]=this._map.latLngToLayerPoint(i[I]),h.extend(F[I]);c.push(F)}else for(I=0;I<w;I++)this._projectLatlngs(i[I],c,h)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,p,w,I,F,V,K;for(h=0,w=0,I=this._rings.length;h<I;h++)for(K=this._rings[h],p=0,F=K.length;p<F-1;p++)V=oh(K[p],K[p+1],i,p,!0),V&&(c[w]=c[w]||[],c[w].push(V[0]),(V[1]!==K[p+1]||p===F-2)&&(c[w].push(V[1]),w++))}},_simplifyPoints:function(){for(var i=this._parts,c=this.options.smoothFactor,h=0,p=i.length;h<p;h++)i[h]=ih(i[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,c){var h,p,w,I,F,V,K=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(h=0,I=this._parts.length;h<I;h++)for(V=this._parts[h],p=0,F=V.length,w=F-1;p<F;w=p++)if(!(!c&&p===0)&&sh(i,V[w],V[p])<=K)return!0;return!1}});function sv(i,c){return new wr(i,c)}wr._flat=lh;var ss=wr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return rh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var c=wr.prototype._convertLatLngs.call(this,i),h=c.length;return h>=2&&c[0]instanceof re&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(i){wr.prototype._setLatLngs.call(this,i),bn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return bn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,c=this.options.weight,h=new W(c,c);if(i=new ve(i.min.subtract(h),i.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,w=this._rings.length,I;p<w;p++)I=nh(this._rings[p],i,!0),I.length&&this._parts.push(I)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var c=!1,h,p,w,I,F,V,K,oe;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(I=0,K=this._parts.length;I<K;I++)for(h=this._parts[I],F=0,oe=h.length,V=oe-1;F<oe;V=F++)p=h[F],w=h[V],p.y>i.y!=w.y>i.y&&i.x<(w.x-p.x)*(i.y-p.y)/(w.y-p.y)+p.x&&(c=!c);return c||wr.prototype._containsPoint.call(this,i,!0)}});function av(i,c){return new ss(i,c)}var jr=_r.extend({initialize:function(i,c){_(this,c),this._layers={},i&&this.addData(i)},addData:function(i){var c=N(i)?i:i.features,h,p,w;if(c){for(h=0,p=c.length;h<p;h++)w=c[h],(w.geometries||w.geometry||w.features||w.coordinates)&&this.addData(w);return this}var I=this.options;if(I.filter&&!I.filter(i))return this;var F=to(i,I);return F?(F.feature=io(i),F.defaultOptions=F.options,this.resetStyle(F),I.onEachFeature&&I.onEachFeature(i,F),this.addLayer(F)):this},resetStyle:function(i){return i===void 0?this.eachLayer(this.resetStyle,this):(i.options=o({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(c){this._setLayerStyle(c,i)},this)},_setLayerStyle:function(i,c){i.setStyle&&(typeof c=="function"&&(c=c(i.feature)),i.setStyle(c))}});function to(i,c){var h=i.type==="Feature"?i.geometry:i,p=h?h.coordinates:null,w=[],I=c&&c.pointToLayer,F=c&&c.coordsToLatLng||ql,V,K,oe,Se;if(!p&&!h)return null;switch(h.type){case"Point":return V=F(p),hh(I,i,V,c);case"MultiPoint":for(oe=0,Se=p.length;oe<Se;oe++)V=F(p[oe]),w.push(hh(I,i,V,c));return new _r(w);case"LineString":case"MultiLineString":return K=no(p,h.type==="LineString"?0:1,F),new wr(K,c);case"Polygon":case"MultiPolygon":return K=no(p,h.type==="Polygon"?1:2,F),new ss(K,c);case"GeometryCollection":for(oe=0,Se=h.geometries.length;oe<Se;oe++){var Me=to({geometry:h.geometries[oe],type:"Feature",properties:i.properties},c);Me&&w.push(Me)}return new _r(w);case"FeatureCollection":for(oe=0,Se=h.features.length;oe<Se;oe++){var Ze=to(h.features[oe],c);Ze&&w.push(Ze)}return new _r(w);default:throw new Error("Invalid GeoJSON object.")}}function hh(i,c,h,p){return i?i(c,h):new Xa(h,p&&p.markersInheritOptions&&p)}function ql(i){return new re(i[1],i[0],i[2])}function no(i,c,h){for(var p=[],w=0,I=i.length,F;w<I;w++)F=c?no(i[w],c-1,h):(h||ql)(i[w]),p.push(F);return p}function Gl(i,c){return i=G(i),i.alt!==void 0?[y(i.lng,c),y(i.lat,c),y(i.alt,c)]:[y(i.lng,c),y(i.lat,c)]}function ro(i,c,h,p){for(var w=[],I=0,F=i.length;I<F;I++)w.push(c?ro(i[I],bn(i[I])?0:c-1,h,p):Gl(i[I],p));return!c&&h&&w.length>0&&w.push(w[0].slice()),w}function as(i,c){return i.feature?o({},i.feature,{geometry:c}):io(c)}function io(i){return i.type==="Feature"||i.type==="FeatureCollection"?i:{type:"Feature",properties:{},geometry:i}}var Yl={toGeoJSON:function(i){return as(this,{type:"Point",coordinates:Gl(this.getLatLng(),i)})}};Xa.include(Yl),Vl.include(Yl),eo.include(Yl),wr.include({toGeoJSON:function(i){var c=!bn(this._latlngs),h=ro(this._latlngs,c?1:0,!1,i);return as(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ss.include({toGeoJSON:function(i){var c=!bn(this._latlngs),h=c&&!bn(this._latlngs[0]),p=ro(this._latlngs,h?2:c?1:0,!0,i);return c||(p=[p]),as(this,{type:(h?"Multi":"")+"Polygon",coordinates:p})}}),rs.include({toMultiPoint:function(i){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(i).geometry.coordinates)}),as(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(i){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(i);var h=c==="GeometryCollection",p=[];return this.eachLayer(function(w){if(w.toGeoJSON){var I=w.toGeoJSON(i);if(h)p.push(I.geometry);else{var F=io(I);F.type==="FeatureCollection"?p.push.apply(p,F.features):p.push(F)}}}),h?as(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function fh(i,c){return new jr(i,c)}var ov=fh,so=Dn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,c,h){this._url=i,this._bounds=z(c),_(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Fe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){it(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&Nn(this._image),this},bringToBack:function(){return this._map&&kn(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=z(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i=this._url.tagName==="IMG",c=this._image=i?this._url:He("img");if(Fe(c,"leaflet-image-layer"),this._zoomAnimated&&Fe(c,"leaflet-zoom-animated"),this.options.className&&Fe(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(i){var c=this._map.getZoomScale(i.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;Ye(this._image,h,c)},_reset:function(){var i=this._image,c=new ve(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();ct(i,c.min),i.style.width=h.x+"px",i.style.height=h.y+"px"},_updateOpacity:function(){Rt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),lv=function(i,c,h){return new so(i,c,h)},ph=so.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i=this._url.tagName==="VIDEO",c=this._image=i?this._url:He("video");if(Fe(c,"leaflet-image-layer"),this._zoomAnimated&&Fe(c,"leaflet-zoom-animated"),this.options.className&&Fe(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=l(this.fire,this,"load"),i){for(var h=c.getElementsByTagName("source"),p=[],w=0;w<h.length;w++)p.push(h[w].src);this._url=h.length>0?p:[c.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var I=0;I<this._url.length;I++){var F=He("source");F.src=this._url[I],c.appendChild(F)}}});function cv(i,c,h){return new ph(i,c,h)}var mh=so.extend({_initImage:function(){var i=this._image=this._url;Fe(i,"leaflet-image-layer"),this._zoomAnimated&&Fe(i,"leaflet-zoom-animated"),this.options.className&&Fe(i,this.options.className),i.onselectstart=g,i.onmousemove=g}});function dv(i,c,h){return new mh(i,c,h)}var sr=Dn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,c){i&&(i instanceof re||N(i))?(this._latlng=G(i),_(this,c)):(_(this,i),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&Rt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&Rt(this._container,1),this.bringToFront(),this.options.interactive&&(Fe(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(Rt(this._container,0),this._removeTimeout=setTimeout(l(it,void 0,this._container),200)):it(this._container),this.options.interactive&&(lt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=G(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Nn(this._container),this},bringToBack:function(){return this._map&&kn(this._container),this},_prepareOpen:function(i){var c=this._source;if(!c._map)return!1;if(c instanceof _r){c=null;var h=this._source._layers;for(var p in h)if(h[p]._map){c=h[p];break}if(!c)return!1;this._source=c}if(!i)if(c.getCenter)i=c.getCenter();else if(c.getLatLng)i=c.getLatLng();else if(c.getBounds)i=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")i.innerHTML=c;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),c=ne(this.options.offset),h=this._getAnchor();this._zoomAnimated?ct(this._container,i.add(h)):c=c.add(i).add(h);var p=this._containerBottom=-c.y,w=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=p+"px",this._container.style.left=w+"px"}},_getAnchor:function(){return[0,0]}});Ke.include({_initOverlay:function(i,c,h,p){var w=c;return w instanceof i||(w=new i(p).setContent(c)),h&&w.setLatLng(h),w}}),Dn.include({_initOverlay:function(i,c,h,p){var w=h;return w instanceof i?(_(w,p),w._source=this):(w=c&&!p?c:new i(p,this),w.setContent(h)),w}});var ao=sr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,sr.prototype.openOn.call(this,i)},onAdd:function(i){sr.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Zr||this._source.on("preclick",rr))},onRemove:function(i){sr.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Zr||this._source.off("preclick",rr))},getEvents:function(){var i=sr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",c=this._container=He("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=He("div",i+"-content-wrapper",c);if(this._contentNode=He("div",i+"-content",h),Zs(c),jt(this._contentNode),Ue(c,"contextmenu",rr),this._tipContainer=He("div",i+"-tip-container",c),this._tip=He("div",i+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=He("a",i+"-close-button",c);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',Ue(p,"click",function(w){zt(w),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,c=i.style;c.width="",c.whiteSpace="nowrap";var h=i.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var p=i.offsetHeight,w=this.options.maxHeight,I="leaflet-popup-scrolled";w&&p>w?(c.height=w+"px",Fe(i,I)):lt(i,I),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),h=this._getAnchor();ct(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,c=parseInt(On(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,p=this._containerWidth,w=new W(this._containerLeft,-h-this._containerBottom);w._add(nr(this._container));var I=i.layerPointToContainerPoint(w),F=ne(this.options.autoPanPadding),V=ne(this.options.autoPanPaddingTopLeft||F),K=ne(this.options.autoPanPaddingBottomRight||F),oe=i.getSize(),Se=0,Me=0;I.x+p+K.x>oe.x&&(Se=I.x+p-oe.x+K.x),I.x-Se-V.x<0&&(Se=I.x-V.x),I.y+h+K.y>oe.y&&(Me=I.y+h-oe.y+K.y),I.y-Me-V.y<0&&(Me=I.y-V.y),(Se||Me)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([Se,Me]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),uv=function(i,c){return new ao(i,c)};Ke.mergeOptions({closePopupOnClick:!0}),Ke.include({openPopup:function(i,c,h){return this._initOverlay(ao,i,c,h).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),Dn.include({bindPopup:function(i,c){return this._popup=this._initOverlay(ao,this._popup,i,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof _r||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(!(!this._popup||!this._map)){Ni(i);var c=i.layer||i.target;if(this._popup._source===c&&!(c instanceof Zr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=c,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){i.originalEvent.keyCode===13&&this._openPopup(i)}});var oo=sr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){sr.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){sr.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=sr.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip",c=i+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=He("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var c,h,p=this._map,w=this._container,I=p.latLngToContainerPoint(p.getCenter()),F=p.layerPointToContainerPoint(i),V=this.options.direction,K=w.offsetWidth,oe=w.offsetHeight,Se=ne(this.options.offset),Me=this._getAnchor();V==="top"?(c=K/2,h=oe):V==="bottom"?(c=K/2,h=0):V==="center"?(c=K/2,h=oe/2):V==="right"?(c=0,h=oe/2):V==="left"?(c=K,h=oe/2):F.x<I.x?(V="right",c=0,h=oe/2):(V="left",c=K+(Se.x+Me.x)*2,h=oe/2),i=i.subtract(ne(c,h,!0)).add(Se).add(Me),lt(w,"leaflet-tooltip-right"),lt(w,"leaflet-tooltip-left"),lt(w,"leaflet-tooltip-top"),lt(w,"leaflet-tooltip-bottom"),Fe(w,"leaflet-tooltip-"+V),ct(w,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&Rt(this._container,i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(c)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),hv=function(i,c){return new oo(i,c)};Ke.include({openTooltip:function(i,c,h){return this._initOverlay(oo,i,c,h).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),Dn.include({bindTooltip:function(i,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(oo,this._tooltip,i,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(!(!i&&this._tooltipHandlersAdded)){var c=i?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof _r||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&(Ue(c,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),Ue(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var c=i.latlng,h,p;this._tooltip.options.sticky&&i.originalEvent&&(h=this._map.mouseEventToContainerPoint(i.originalEvent),p=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(c)}});var gh=is.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var c=i&&i.tagName==="DIV"?i:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Xn(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var p=ne(h.bgPos);c.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function fv(i){return new gh(i)}is.Default=Gs;var Ys=Dn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:D.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){_(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),it(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Nn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(kn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof W?i:new W(i,i)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var c=this.getPane().children,h=-i(-1/0,1/0),p=0,w=c.length,I;p<w;p++)I=c[p].style.zIndex,c[p]!==this._container&&I&&(h=i(h,+I));isFinite(h)&&(this.options.zIndex=h+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!D.ielt9){Rt(this._container,this.options.opacity);var i=+new Date,c=!1,h=!1;for(var p in this._tiles){var w=this._tiles[p];if(!(!w.current||!w.loaded)){var I=Math.min(1,(i-w.loaded)/200);Rt(w.el,I),I<1?c=!0:(w.active?h=!0:this._onOpaqueTile(w),w.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(H(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=He("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,c=this.options.maxZoom;if(i!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===i?(this._levels[h].el.style.zIndex=c-Math.abs(i-h),this._onUpdateLevel(h)):(it(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var p=this._levels[i],w=this._map;return p||(p=this._levels[i]={},p.el=He("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=c,p.origin=w.project(w.unproject(w.getPixelOrigin()),i).round(),p.zoom=i,this._setZoomTransform(p,w.getCenter(),w.getZoom()),g(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var i,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)c=this._tiles[i],c.retain=c.current;for(i in this._tiles)if(c=this._tiles[i],c.current&&!c.active){var p=c.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var c in this._tiles)this._tiles[c].coords.z===i&&this._removeTile(c)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)it(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,c,h,p){var w=Math.floor(i/2),I=Math.floor(c/2),F=h-1,V=new W(+w,+I);V.z=+F;var K=this._tileCoordsToKey(V),oe=this._tiles[K];return oe&&oe.active?(oe.retain=!0,!0):(oe&&oe.loaded&&(oe.retain=!0),F>p?this._retainParent(w,I,F,p):!1)},_retainChildren:function(i,c,h,p){for(var w=2*i;w<2*i+2;w++)for(var I=2*c;I<2*c+2;I++){var F=new W(w,I);F.z=h+1;var V=this._tileCoordsToKey(F),K=this._tiles[V];if(K&&K.active){K.retain=!0;continue}else K&&K.loaded&&(K.retain=!0);h+1<p&&this._retainChildren(w,I,h+1,p)}},_resetView:function(i){var c=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var c=this.options;return c.minNativeZoom!==void 0&&i<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<i?c.maxNativeZoom:i},_setView:function(i,c,h,p){var w=Math.round(c);this.options.maxZoom!==void 0&&w>this.options.maxZoom||this.options.minZoom!==void 0&&w<this.options.minZoom?w=void 0:w=this._clampZoom(w);var I=this.options.updateWhenZooming&&w!==this._tileZoom;(!p||I)&&(this._tileZoom=w,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),w!==void 0&&this._update(i),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(i,c)},_setZoomTransforms:function(i,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],i,c)},_setZoomTransform:function(i,c,h){var p=this._map.getZoomScale(h,i.zoom),w=i.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(c,h)).round();D.any3d?Ye(i.el,w,p):ct(i.el,w)},_resetGrid:function(){var i=this._map,c=i.options.crs,h=this._tileSize=this.getTileSize(),p=this._tileZoom,w=this._map.getPixelWorldBounds(this._tileZoom);w&&(this._globalTileRange=this._pxBoundsToTileRange(w)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,c.wrapLng[0]],p).x/h.x),Math.ceil(i.project([0,c.wrapLng[1]],p).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([c.wrapLat[0],0],p).y/h.x),Math.ceil(i.project([c.wrapLat[1],0],p).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(i){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),p=c.getZoomScale(h,this._tileZoom),w=c.project(i,this._tileZoom).floor(),I=c.getSize().divideBy(p*2);return new ve(w.subtract(I),w.add(I))},_update:function(i){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(i===void 0&&(i=c.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(i),w=this._pxBoundsToTileRange(p),I=w.getCenter(),F=[],V=this.options.keepBuffer,K=new ve(w.getBottomLeft().subtract([V,-V]),w.getTopRight().add([V,-V]));if(!(isFinite(w.min.x)&&isFinite(w.min.y)&&isFinite(w.max.x)&&isFinite(w.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var oe in this._tiles){var Se=this._tiles[oe].coords;(Se.z!==this._tileZoom||!K.contains(new W(Se.x,Se.y)))&&(this._tiles[oe].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(i,h);return}for(var Me=w.min.y;Me<=w.max.y;Me++)for(var Ze=w.min.x;Ze<=w.max.x;Ze++){var Qt=new W(Ze,Me);if(Qt.z=this._tileZoom,!!this._isValidTile(Qt)){var At=this._tiles[this._tileCoordsToKey(Qt)];At?At.current=!0:F.push(Qt)}}if(F.sort(function(on,ls){return on.distanceTo(I)-ls.distanceTo(I)}),F.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var In=document.createDocumentFragment();for(Ze=0;Ze<F.length;Ze++)this._addTile(F[Ze],In);this._level.el.appendChild(In)}}}},_isValidTile:function(i){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(i.x<h.min.x||i.x>h.max.x)||!c.wrapLat&&(i.y<h.min.y||i.y>h.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(i);return z(this.options.bounds).overlaps(p)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var c=this._map,h=this.getTileSize(),p=i.scaleBy(h),w=p.add(h),I=c.unproject(p,i.z),F=c.unproject(w,i.z);return[I,F]},_tileCoordsToBounds:function(i){var c=this._tileCoordsToNwSe(i),h=new ce(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var c=i.split(":"),h=new W(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(i){var c=this._tiles[i];c&&(it(c.el),delete this._tiles[i],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){Fe(i,"leaflet-tile");var c=this.getTileSize();i.style.width=c.x+"px",i.style.height=c.y+"px",i.onselectstart=g,i.onmousemove=g,D.ielt9&&this.options.opacity<1&&Rt(i,this.options.opacity)},_addTile:function(i,c){var h=this._getTilePos(i),p=this._tileCoordsToKey(i),w=this.createTile(this._wrapCoords(i),l(this._tileReady,this,i));this._initTile(w),this.createTile.length<2&&A(l(this._tileReady,this,i,null,w)),ct(w,h),this._tiles[p]={el:w,coords:i,current:!0},c.appendChild(w),this.fire("tileloadstart",{tile:w,coords:i})},_tileReady:function(i,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:i});var p=this._tileCoordsToKey(i);h=this._tiles[p],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Rt(h.el,0),H(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(Fe(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),D.ielt9||!this._map._fadeAnimated?A(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var c=new W(this._wrapX?m(i.x,this._wrapX):i.x,this._wrapY?m(i.y,this._wrapY):i.y);return c.z=i.z,c},_pxBoundsToTileRange:function(i){var c=this.getTileSize();return new ve(i.min.unscaleBy(c).floor(),i.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}});function pv(i){return new Ys(i)}var os=Ys.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,c){this._url=i,c=_(this,c),c.detectRetina&&D.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,c){return this._url===i&&c===void 0&&(c=!0),this._url=i,c||this.redraw(),this},createTile:function(i,c){var h=document.createElement("img");return Ue(h,"load",l(this._tileOnLoad,this,c,h)),Ue(h,"error",l(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(i),h},getTileUrl:function(i){var c={r:D.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-i.y;this.options.tms&&(c.y=h),c["-y"]=h}return x(this._url,o(c,this.options))},_tileOnLoad:function(i,c){D.ielt9?setTimeout(l(i,this,null,c),0):i(null,c)},_tileOnError:function(i,c,h){var p=this.options.errorTileUrl;p&&c.getAttribute("src")!==p&&(c.src=p),i(h,c)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,p=this.options.zoomOffset;return h&&(i=c-i),i+p},_getSubdomain:function(i){var c=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var i,c;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(c=this._tiles[i].el,c.onload=g,c.onerror=g,!c.complete)){c.src=P;var h=this._tiles[i].coords;it(c),delete this._tiles[i],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(i){var c=this._tiles[i];if(c)return c.el.setAttribute("src",P),Ys.prototype._removeTile.call(this,i)},_tileReady:function(i,c,h){if(!(!this._map||h&&h.getAttribute("src")===P))return Ys.prototype._tileReady.call(this,i,c,h)}});function yh(i,c){return new os(i,c)}var vh=os.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,c){this._url=i;var h=o({},this.defaultWmsParams);for(var p in c)p in this.options||(h[p]=c[p]);c=_(this,c);var w=c.detectRetina&&D.retina?2:1,I=this.getTileSize();h.width=I.x*w,h.height=I.y*w,this.wmsParams=h},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,os.prototype.onAdd.call(this,i)},getTileUrl:function(i){var c=this._tileCoordsToNwSe(i),h=this._crs,p=xe(h.project(c[0]),h.project(c[1])),w=p.min,I=p.max,F=(this._wmsVersion>=1.3&&this._crs===dh?[w.y,w.x,I.y,I.x]:[w.x,w.y,I.x,I.y]).join(","),V=os.prototype.getTileUrl.call(this,i);return V+C(this.wmsParams,V,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+F},setParams:function(i,c){return o(this.wmsParams,i),c||this.redraw(),this}});function mv(i,c){return new vh(i,c)}os.WMS=vh,yh.wms=mv;var Sr=Dn.extend({options:{padding:.1},initialize:function(i){_(this,i),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Fe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,c){var h=this._map.getZoomScale(c,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),w=this._map.project(this._center,c),I=p.multiplyBy(-h).add(w).subtract(this._map._getNewPixelOrigin(i,c));D.any3d?Ye(this._container,I,h):ct(this._container,I)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var i in this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-i)).round();this._bounds=new ve(h,h.add(c.multiplyBy(1+i*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),xh=Sr.extend({options:{tolerance:0},getEvents:function(){var i=Sr.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Sr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");Ue(i,"mousemove",this._onMouseMove,this),Ue(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ue(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){H(this._redrawRequest),delete this._ctx,it(this._container),st(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var i;this._redrawBounds=null;for(var c in this._layers)i=this._layers[c],i._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Sr.prototype._update.call(this);var i=this._bounds,c=this._container,h=i.getSize(),p=D.retina?2:1;ct(c,i.min),c.width=p*h.x,c.height=p*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",D.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){Sr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[u(i)]=i;var c=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var c=i._order,h=c.next,p=c.prev;h?h.prev=p:this._drawLast=p,p?p.next=h:this._drawFirst=h,delete i._order,delete this._layers[u(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if(typeof i.options.dashArray=="string"){var c=i.options.dashArray.split(/[, ]+/),h=[],p,w;for(w=0;w<c.length;w++){if(p=Number(c[w]),isNaN(p))return;h.push(p)}i.options._dashArray=h}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||A(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var c=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ve,this._redrawBounds.extend(i._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(i._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var c=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)i=p.layer,(!c||i._pxBounds&&i._pxBounds.intersects(c))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,c){if(this._drawing){var h,p,w,I,F=i._parts,V=F.length,K=this._ctx;if(V){for(K.beginPath(),h=0;h<V;h++){for(p=0,w=F[h].length;p<w;p++)I=F[h][p],K[p?"lineTo":"moveTo"](I.x,I.y);c&&K.closePath()}this._fillStroke(K,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var c=i._point,h=this._ctx,p=Math.max(Math.round(i._radius),1),w=(Math.max(Math.round(i._radiusY),1)||p)/p;w!==1&&(h.save(),h.scale(1,w)),h.beginPath(),h.arc(c.x,c.y/w,p,0,Math.PI*2,!1),w!==1&&h.restore(),this._fillStroke(h,i)}},_fillStroke:function(i,c){var h=c.options;h.fill&&(i.globalAlpha=h.fillOpacity,i.fillStyle=h.fillColor||h.color,i.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(i.setLineDash&&i.setLineDash(c.options&&c.options._dashArray||[]),i.globalAlpha=h.opacity,i.lineWidth=h.weight,i.strokeStyle=h.color,i.lineCap=h.lineCap,i.lineJoin=h.lineJoin,i.stroke())},_onClick:function(i){for(var c=this._map.mouseEventToLayerPoint(i),h,p,w=this._drawFirst;w;w=w.next)h=w.layer,h.options.interactive&&h._containsPoint(c)&&(!(i.type==="click"||i.type==="preclick")||!this._map._draggableMoved(h))&&(p=h);this._fireEvent(p?[p]:!1,i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,c)}},_handleMouseOut:function(i){var c=this._hoveredLayer;c&&(lt(this._container,"leaflet-interactive"),this._fireEvent([c],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,c){if(!this._mouseHoverThrottled){for(var h,p,w=this._drawFirst;w;w=w.next)h=w.layer,h.options.interactive&&h._containsPoint(c)&&(p=h);p!==this._hoveredLayer&&(this._handleMouseOut(i),p&&(Fe(this._container,"leaflet-interactive"),this._fireEvent([p],i,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,i),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,c,h){this._map._fireDOMEvent(c,h||c.type,i)},_bringToFront:function(i){var c=i._order;if(c){var h=c.next,p=c.prev;if(h)h.prev=p;else return;p?p.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(i)}},_bringToBack:function(i){var c=i._order;if(c){var h=c.next,p=c.prev;if(p)p.next=h;else return;h?h.prev=p:p&&(this._drawLast=p),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(i)}}});function _h(i){return D.canvas?new xh(i):null}var Ks=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch{}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),gv={_initContainer:function(){this._container=He("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Sr.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var c=i._container=Ks("shape");Fe(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",i._path=Ks("path"),c.appendChild(i._path),this._updateStyle(i),this._layers[u(i)]=i},_addPath:function(i){var c=i._container;this._container.appendChild(c),i.options.interactive&&i.addInteractiveTarget(c)},_removePath:function(i){var c=i._container;it(c),i.removeInteractiveTarget(c),delete this._layers[u(i)]},_updateStyle:function(i){var c=i._stroke,h=i._fill,p=i.options,w=i._container;w.stroked=!!p.stroke,w.filled=!!p.fill,p.stroke?(c||(c=i._stroke=Ks("stroke")),w.appendChild(c),c.weight=p.weight+"px",c.color=p.color,c.opacity=p.opacity,p.dashArray?c.dashStyle=N(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=p.lineCap.replace("butt","flat"),c.joinstyle=p.lineJoin):c&&(w.removeChild(c),i._stroke=null),p.fill?(h||(h=i._fill=Ks("fill")),w.appendChild(h),h.color=p.fillColor||p.color,h.opacity=p.fillOpacity):h&&(w.removeChild(h),i._fill=null)},_updateCircle:function(i){var c=i._point.round(),h=Math.round(i._radius),p=Math.round(i._radiusY||h);this._setPath(i,i._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+p+" 0,"+65535*360)},_setPath:function(i,c){i._path.v=c},_bringToFront:function(i){Nn(i._container)},_bringToBack:function(i){kn(i._container)}},lo=D.vml?Ks:he,Js=Sr.extend({_initContainer:function(){this._container=lo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=lo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){it(this._container),st(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Sr.prototype._update.call(this);var i=this._bounds,c=i.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),ct(h,i.min),h.setAttribute("viewBox",[i.min.x,i.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(i){var c=i._path=lo("path");i.options.className&&Fe(c,i.options.className),i.options.interactive&&Fe(c,"leaflet-interactive"),this._updateStyle(i),this._layers[u(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){it(i._path),i.removeInteractiveTarget(i._path),delete this._layers[u(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var c=i._path,h=i.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(i,c){this._setPath(i,se(i._parts,c))},_updateCircle:function(i){var c=i._point,h=Math.max(Math.round(i._radius),1),p=Math.max(Math.round(i._radiusY),1)||h,w="a"+h+","+p+" 0 1,0 ",I=i._empty()?"M0 0":"M"+(c.x-h)+","+c.y+w+h*2+",0 "+w+-h*2+",0 ";this._setPath(i,I)},_setPath:function(i,c){i._path.setAttribute("d",c)},_bringToFront:function(i){Nn(i._path)},_bringToBack:function(i){kn(i._path)}});D.vml&&Js.include(gv);function wh(i){return D.svg||D.vml?new Js(i):null}Ke.include({getRenderer:function(i){var c=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(i){if(i==="overlayPane"||i===void 0)return!1;var c=this._paneRenderers[i];return c===void 0&&(c=this._createRenderer({pane:i}),this._paneRenderers[i]=c),c},_createRenderer:function(i){return this.options.preferCanvas&&_h(i)||wh(i)}});var jh=ss.extend({initialize:function(i,c){ss.prototype.initialize.call(this,this._boundsToLatLngs(i),c)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return i=z(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});function yv(i,c){return new jh(i,c)}Js.create=lo,Js.pointsToPath=se,jr.geometryToLayer=to,jr.coordsToLatLng=ql,jr.coordsToLatLngs=no,jr.latLngToCoords=Gl,jr.latLngsToCoords=ro,jr.getFeature=as,jr.asFeature=io,Ke.mergeOptions({boxZoom:!0});var Sh=ir.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){Ue(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){it(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||i.which!==1&&i.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Dr(),Yi(),this._startPoint=this._map.mouseEventToContainerPoint(i),Ue(document,{contextmenu:Ni,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=He("div","leaflet-zoom-box",this._container),Fe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var c=new ve(this._point,this._startPoint),h=c.getSize();ct(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(it(this._box),lt(this._container,"leaflet-crosshair")),$r(),Ki(),st(document,{contextmenu:Ni,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if(!(i.which!==1&&i.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new ce(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(i){i.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ke.addInitHook("addHandler","boxZoom",Sh),Ke.mergeOptions({doubleClickZoom:!0});var Ch=ir.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var c=this._map,h=c.getZoom(),p=c.options.zoomDelta,w=i.originalEvent.shiftKey?h-p:h+p;c.options.doubleClickZoom==="center"?c.setZoom(w):c.setZoomAround(i.containerPoint,w)}});Ke.addInitHook("addHandler","doubleClickZoom",Ch),Ke.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Nh=ir.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new Hr(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}Fe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){lt(this._map._container,"leaflet-grab"),lt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=z(this._map.options.maxBounds);this._offsetLimit=xe(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,c){return i-(i-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var i=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;i.x<c.min.x&&(i.x=this._viscousLimit(i.x,c.min.x)),i.y<c.min.y&&(i.y=this._viscousLimit(i.y,c.min.y)),i.x>c.max.x&&(i.x=this._viscousLimit(i.x,c.max.x)),i.y>c.max.y&&(i.y=this._viscousLimit(i.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,c=Math.round(i/2),h=this._initialWorldOffset,p=this._draggable._newPos.x,w=(p-c+h)%i+c-h,I=(p+c+h)%i-c-h,F=Math.abs(w+h)<Math.abs(I+h)?w:I;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=F},_onDragEnd:function(i){var c=this._map,h=c.options,p=!h.inertia||i.noInertia||this._times.length<2;if(c.fire("dragend",i),p)c.fire("moveend");else{this._prunePositions(+new Date);var w=this._lastPos.subtract(this._positions[0]),I=(this._lastTime-this._times[0])/1e3,F=h.easeLinearity,V=w.multiplyBy(F/I),K=V.distanceTo([0,0]),oe=Math.min(h.inertiaMaxSpeed,K),Se=V.multiplyBy(oe/K),Me=oe/(h.inertiaDeceleration*F),Ze=Se.multiplyBy(-Me/2).round();!Ze.x&&!Ze.y?c.fire("moveend"):(Ze=c._limitOffset(Ze,c.options.maxBounds),A(function(){c.panBy(Ze,{duration:Me,easeLinearity:F,noMoveStart:!0,animate:!0})}))}}});Ke.addInitHook("addHandler","dragging",Nh),Ke.mergeOptions({keyboard:!0,keyboardPanDelta:80});var kh=ir.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),Ue(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),st(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,c=document.documentElement,h=i.scrollTop||c.scrollTop,p=i.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(p,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var c=this._panKeys={},h=this.keyCodes,p,w;for(p=0,w=h.left.length;p<w;p++)c[h.left[p]]=[-1*i,0];for(p=0,w=h.right.length;p<w;p++)c[h.right[p]]=[i,0];for(p=0,w=h.down.length;p<w;p++)c[h.down[p]]=[0,i];for(p=0,w=h.up.length;p<w;p++)c[h.up[p]]=[0,-1*i]},_setZoomDelta:function(i){var c=this._zoomKeys={},h=this.keyCodes,p,w;for(p=0,w=h.zoomIn.length;p<w;p++)c[h.zoomIn[p]]=i;for(p=0,w=h.zoomOut.length;p<w;p++)c[h.zoomOut[p]]=-i},_addHooks:function(){Ue(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){st(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!(i.altKey||i.ctrlKey||i.metaKey)){var c=i.keyCode,h=this._map,p;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(p=this._panKeys[c],i.shiftKey&&(p=ne(p).multiplyBy(3)),h.options.maxBounds&&(p=h._limitOffset(ne(p),h.options.maxBounds)),h.options.worldCopyJump){var w=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(p)));h.panTo(w)}else h.panBy(p)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Ni(i)}}});Ke.addInitHook("addHandler","keyboard",kh),Ke.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bh=ir.extend({addHooks:function(){Ue(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var c=Ju(i),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var p=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),p),Ni(i)},_performZoom:function(){var i=this._map,c=i.getZoom(),h=this._map.options.zoomSnap||0;i._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),w=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,I=h?Math.ceil(w/h)*h:w,F=i._limitZoom(c+(this._delta>0?I:-I))-c;this._delta=0,this._startTime=null,F&&(i.options.scrollWheelZoom==="center"?i.setZoom(c+F):i.setZoomAround(this._lastMousePos,c+F))}});Ke.addInitHook("addHandler","scrollWheelZoom",bh);var vv=600;Ke.mergeOptions({tapHold:D.touchNative&&D.safari&&D.mobile,tapTolerance:15});var Ih=ir.extend({addHooks:function(){Ue(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),i.touches.length===1){var c=i.touches[0];this._startPos=this._newPos=new W(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Ue(document,"touchend",zt),Ue(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),vv),Ue(document,"touchend touchcancel contextmenu",this._cancel,this),Ue(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){st(document,"touchend",zt),st(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)},_onMove:function(i){var c=i.touches[0];this._newPos=new W(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,c){var h=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});Ke.addInitHook("addHandler","tapHold",Ih),Ke.mergeOptions({touchZoom:D.touch,bounceAtZoomLimits:!0});var Lh=ir.extend({addHooks:function(){Fe(this._map._container,"leaflet-touch-zoom"),Ue(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){lt(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var c=this._map;if(!(!i.touches||i.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(p)._divideBy(2))),this._startDist=h.distanceTo(p),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Ue(document,"touchmove",this._onTouchMove,this),Ue(document,"touchend touchcancel",this._onTouchEnd,this),zt(i)}},_onTouchMove:function(i){if(!(!i.touches||i.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]),w=h.distanceTo(p)/this._startDist;if(this._zoom=c.getScaleZoom(w,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&w<1||this._zoom>c.getMaxZoom()&&w>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,w===1)return}else{var I=h._add(p)._divideBy(2)._subtract(this._centerPoint);if(w===1&&I.x===0&&I.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(I),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),H(this._animRequest);var F=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=A(F,this,!0),zt(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,H(this._animRequest),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ke.addInitHook("addHandler","touchZoom",Lh),Ke.BoxZoom=Sh,Ke.DoubleClickZoom=Ch,Ke.Drag=Nh,Ke.Keyboard=kh,Ke.ScrollWheelZoom=bh,Ke.TapHold=Ih,Ke.TouchZoom=Lh,n.Bounds=ve,n.Browser=D,n.CRS=we,n.Canvas=xh,n.Circle=Vl,n.CircleMarker=eo,n.Class=O,n.Control=zn,n.DivIcon=gh,n.DivOverlay=sr,n.DomEvent=My,n.DomUtil=Ja,n.Draggable=Hr,n.Evented=M,n.FeatureGroup=_r,n.GeoJSON=jr,n.GridLayer=Ys,n.Handler=ir,n.Icon=is,n.ImageOverlay=so,n.LatLng=re,n.LatLngBounds=ce,n.Layer=Dn,n.LayerGroup=rs,n.LineUtil=Yy,n.Map=Ke,n.Marker=Xa,n.Mixin=Wy,n.Path=Zr,n.Point=W,n.PolyUtil=Hy,n.Polygon=ss,n.Polyline=wr,n.Popup=ao,n.PosAnimation=Qu,n.Projection=Ky,n.Rectangle=jh,n.Renderer=Sr,n.SVG=Js,n.SVGOverlay=mh,n.TileLayer=os,n.Tooltip=oo,n.Transformation=ze,n.Util=q,n.VideoOverlay=ph,n.bind=l,n.bounds=xe,n.canvas=_h,n.circle=iv,n.circleMarker=rv,n.control=Vs,n.divIcon=fv,n.extend=o,n.featureGroup=ev,n.geoJSON=fh,n.geoJson=ov,n.gridLayer=pv,n.icon=tv,n.imageOverlay=lv,n.latLng=G,n.latLngBounds=z,n.layerGroup=Xy,n.map=Fy,n.marker=nv,n.point=ne,n.polygon=av,n.polyline=sv,n.popup=uv,n.rectangle=yv,n.setOptions=_,n.stamp=u,n.svg=wh,n.svgOverlay=dv,n.tileLayer=yh,n.tooltip=hv,n.transformation=me,n.version=s,n.videoOverlay=cv;var xv=window.L;n.noConflict=function(){return window.L=xv,this},window.L=n})})(Ad,Ad.exports);var Ka=Ad.exports;const Zi=jp(Ka);function Hu(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function Zu(e,t){return t==null?function(s,o){const a=v.useRef();return a.current||(a.current=e(s,o)),a}:function(s,o){const a=v.useRef();a.current||(a.current=e(s,o));const l=v.useRef(s),{instance:d}=a.current;return v.useEffect(function(){l.current!==s&&(t(d,s,l.current),l.current=s)},[d,s,o]),a}}function Wj(e,t){v.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var a;(a=t.layerContainer)==null||a.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Ny(e){return function(n){const s=$u(),o=e(Wu(n,s),s);return wy(s.map,n.attribution),Cy(o.current,n.eventHandlers),Wj(o.current,s),o}}function Hj(e,t){const n=Zu(e,t),s=Ny(n);return Oj(s)}function Zj(e,t){const n=Zu(e),s=$j(n,t);return zj(s)}function Vj(e,t){const n=Zu(e,t),s=Ny(n);return Dj(s)}function qj(e,t,n){const{opacity:s,zIndex:o}=t;s!=null&&s!==n.opacity&&e.setOpacity(s),o!=null&&o!==n.zIndex&&e.setZIndex(o)}function Gj(){return $u().map}function Md(){return Md=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Md.apply(this,arguments)}function Yj({bounds:e,boundsOptions:t,center:n,children:s,className:o,id:a,placeholder:l,style:d,whenReady:u,zoom:f,...m},g){const[y]=v.useState({className:o,id:a,style:d}),[k,S]=v.useState(null);v.useImperativeHandle(g,()=>(k==null?void 0:k.map)??null,[k]);const _=v.useCallback(j=>{if(j!==null&&k===null){const x=new Ka.Map(j,m);n!=null&&f!=null?x.setView(n,f):e!=null&&x.fitBounds(e,t),u!=null&&x.whenReady(u),S(Fj(x))}},[]);v.useEffect(()=>()=>{k==null||k.map.remove()},[k]);const C=k?hr.createElement(Sy,{value:k},s):l??null;return hr.createElement("div",Md({},y,{ref:_}),C)}const Kj=v.forwardRef(Yj),pp=Hj(function({position:t,...n},s){const o=new Ka.Marker(t,n);return Hu(o,Uj(s,{overlayContainer:o}))},function(t,n,s){n.position!==s.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),mp=Zj(function(t,n){const s=new Ka.Popup(t,n.overlayContainer);return Hu(s,n)},function(t,n,{position:s},o){v.useEffect(function(){const{instance:l}=t;function d(f){f.popup===l&&(l.update(),o(!0))}function u(f){f.popup===l&&o(!1)}return n.map.on({popupopen:d,popupclose:u}),n.overlayContainer==null?(s!=null&&l.setLatLng(s),l.openOn(n.map)):n.overlayContainer.bindPopup(l),function(){var m;n.map.off({popupopen:d,popupclose:u}),(m=n.overlayContainer)==null||m.unbindPopup(),n.map.removeLayer(l)}},[t,n,o,s])}),Jj=Vj(function({url:t,...n},s){const o=new Ka.TileLayer(t,Wu(n,s));return Hu(o,s)},function(t,n,s){qj(t,n,s);const{url:o}=n;o!=null&&o!==s.url&&t.setUrl(o)});var gp={exports:{}};(function(e,t){(function(n,s){s(t)})(wp,function(n){var s=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var l=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,l?this._withAnimation:this._noAnimation),this._markerCluster=l?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof L.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(a,this._maxZoom),this.fire("layeradd",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var l=a,d=this._zoom;if(a.__parent)for(;l.__parent._zoom>=d;)l=l.__parent;return this._currentShownBounds.contains(l.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,l):this._animationAddLayerNonAnimated(a,l)),this},removeLayer:function(a){return a instanceof L.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,l){if(!L.Util.isArray(a))return this.addLayer(a);var d=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,m=this.options.chunkInterval,g=this.options.chunkProgress,y=a.length,k=0,S=!0,_;if(this._map){var C=new Date().getTime(),j=L.bind(function(){var N=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();k<y;k++){if(f&&k%200===0){var b=new Date().getTime()-N;if(b>m)break}if(_=a[k],_ instanceof L.LayerGroup){S&&(a=a.slice(),S=!1),this._extractNonGroupLayers(_,a),y=a.length;continue}if(!_.getLatLng){u.addLayer(_),l||this.fire("layeradd",{layer:_});continue}if(!this.hasLayer(_)&&(this._addLayer(_,this._maxZoom),l||this.fire("layeradd",{layer:_}),_.__parent&&_.__parent.getChildCount()===2)){var P=_.__parent.getAllChildMarkers(),T=P[0]===_?P[1]:P[0];d.removeLayer(T)}}g&&g(k,y,new Date().getTime()-C),k===y?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(j,this.options.chunkDelay)},this);j()}else for(var x=this._needsClustering;k<y;k++){if(_=a[k],_ instanceof L.LayerGroup){S&&(a=a.slice(),S=!1),this._extractNonGroupLayers(_,a),y=a.length;continue}if(!_.getLatLng){u.addLayer(_);continue}this.hasLayer(_)||x.push(_)}return this},removeLayers:function(a){var l,d,u=a.length,f=this._featureGroup,m=this._nonPointGroup,g=!0;if(!this._map){for(l=0;l<u;l++){if(d=a[l],d instanceof L.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(d,a),u=a.length;continue}this._arraySplice(this._needsClustering,d),m.removeLayer(d),this.hasLayer(d)&&this._needsRemoving.push({layer:d,latlng:d._latlng}),this.fire("layerremove",{layer:d})}return this}if(this._unspiderfy){this._unspiderfy();var y=a.slice(),k=u;for(l=0;l<k;l++){if(d=y[l],d instanceof L.LayerGroup){this._extractNonGroupLayers(d,y),k=y.length;continue}this._unspiderfyLayer(d)}}for(l=0;l<u;l++){if(d=a[l],d instanceof L.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(d,a),u=a.length;continue}if(!d.__parent){m.removeLayer(d),this.fire("layerremove",{layer:d});continue}this._removeLayer(d,!0,!0),this.fire("layerremove",{layer:d}),f.hasLayer(d)&&(f.removeLayer(d),d.clusterShow&&d.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this),delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var l=this._needsClustering.length-1;l>=0;l--)a.extend(this._needsClustering[l].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,l){var d=this._needsClustering.slice(),u=this._needsRemoving,f,m,g;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(d),m=d.length-1;m>=0;m--){for(f=!0,g=u.length-1;g>=0;g--)if(u[g].layer===d[m]){f=!1;break}f&&a.call(l,d[m])}this._nonPointGroup.eachLayer(a,l)},getLayers:function(){var a=[];return this.eachLayer(function(l){a.push(l)}),a},getLayer:function(a){var l=null;return a=parseInt(a,10),this.eachLayer(function(d){L.stamp(d)===a&&(l=d)}),l},hasLayer:function(a){if(!a)return!1;var l,d=this._needsClustering;for(l=d.length-1;l>=0;l--)if(d[l]===a)return!0;for(d=this._needsRemoving,l=d.length-1;l>=0;l--)if(d[l].layer===a)return!1;return!!(a.__parent&&a.__parent._group===this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,l){var d=this._map;typeof l!="function"&&(l=function(){});var u=function(){(d.hasLayer(a)||d.hasLayer(a.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),d.hasLayer(a)?l():a.__parent._icon&&(this.once("spiderfied",l,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?l():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var l,d,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(a),this._nonPointGroup.addTo(a),this._gridClusters||this._generateInitialClusters(),this._maxLat=a.options.crs.projection.MAX_LATITUDE,l=0,d=this._needsRemoving.length;l<d;l++)u=this._needsRemoving[l],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(l=0,d=this._needsRemoving.length;l<d;l++)u=this._needsRemoving[l],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),d=this._needsClustering,this._needsClustering=[],this.addLayers(d,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(a){for(var l=a;l&&!l._icon;)l=l.__parent;return l||null},_arraySplice:function(a,l){for(var d=a.length-1;d>=0;d--)if(a[d]===l)return a.splice(d,1),!0},_removeFromGridUnclustered:function(a,l){for(var d=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());l>=f&&u[l].removeObject(a,d.project(a.getLatLng(),l));l--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var l=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng),l&&a.target.openPopup()}},_moveChild:function(a,l,d){a._latlng=l,this.removeLayer(a),a._latlng=d,this.addLayer(a)},_childMarkerDragEnd:function(a){var l=a.target.__dragStart;delete a.target.__dragStart,l&&this._moveChild(a.target,l,a.target._latlng)},_removeLayer:function(a,l,d){var u=this._gridClusters,f=this._gridUnclustered,m=this._featureGroup,g=this._map,y=Math.floor(this._map.getMinZoom());l&&this._removeFromGridUnclustered(a,this._maxZoom);var k=a.__parent,S=k._markers,_;for(this._arraySplice(S,a);k&&(k._childCount--,k._boundsNeedUpdate=!0,!(k._zoom<y));)l&&k._childCount<=1?(_=k._markers[0]===a?k._markers[1]:k._markers[0],u[k._zoom].removeObject(k,g.project(k._cLatLng,k._zoom)),f[k._zoom].addObject(_,g.project(_.getLatLng(),k._zoom)),this._arraySplice(k.__parent._childClusters,k),k.__parent._markers.push(_),_.__parent=k.__parent,k._icon&&(m.removeLayer(k),d||m.addLayer(_))):k._iconNeedsUpdate=!0,k=k.__parent;delete a.__parent},_isOrIsParent:function(a,l){for(;l;){if(a===l)return!0;l=l.parentNode}return!1},fire:function(a,l,d){if(l&&l.layer instanceof L.MarkerCluster){if(l.originalEvent&&this._isOrIsParent(l.layer._icon,l.originalEvent.relatedTarget))return;a="cluster"+a}L.FeatureGroup.prototype.fire.call(this,a,l,d)},listens:function(a,l){return L.FeatureGroup.prototype.listens.call(this,a,l)||L.FeatureGroup.prototype.listens.call(this,"cluster"+a,l)},_defaultIconCreateFunction:function(a){var l=a.getChildCount(),d=" marker-cluster-";return l<10?d+="small":l<100?d+="medium":d+="large",new L.DivIcon({html:"<div><span>"+l+"</span></div>",className:"marker-cluster"+d,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,l=this.options.spiderfyOnMaxZoom,d=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(l||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),d&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){var l=a.layer,d=l;if(!(a.type==="clusterkeypress"&&a.originalEvent&&a.originalEvent.keyCode!==13)){for(;d._childClusters.length===1;)d=d._childClusters[0];d._zoom===this._maxZoom&&d._childCount===l._childCount&&this.options.spiderfyOnMaxZoom?l.spiderfy():this.options.zoomToBoundsOnClick&&l.zoomToBounds(),this.options.spiderfyOnEveryZoom&&l.spiderfy(),a.originalEvent&&a.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(a){var l=this._map;this._inZoomAnimation||(this._shownPolygon&&l.removeLayer(this._shownPolygon),a.layer.getChildCount()>2&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),l.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(a||d||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a),this._currentShownBounds=a}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),l=Math.floor(this._map.getMinZoom()),d=this.options.maxClusterRadius,u=d;typeof d!="function"&&(u=function(){return d}),this.options.disableClusteringAtZoom!==null&&(a=this.options.disableClusteringAtZoom-1),this._maxZoom=a,this._gridClusters={},this._gridUnclustered={};for(var f=a;f>=l;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,l-1)},_addLayer:function(a,l){var d=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),m,g;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(a),a.on(this._childMarkerEventHandlers,this);l>=f;l--){m=this._map.project(a.getLatLng(),l);var y=d[l].getNearObject(m);if(y){y._addChild(a),a.__parent=y;return}if(y=u[l].getNearObject(m),y){var k=y.__parent;k&&this._removeLayer(y,!1);var S=new this._markerCluster(this,l,y,a);d[l].addObject(S,this._map.project(S._cLatLng,l)),y.__parent=S,a.__parent=S;var _=S;for(g=l-1;g>k._zoom;g--)_=new this._markerCluster(this,g,_),d[g].addObject(_,this._map.project(y.getLatLng(),g));k._addChild(_),this._removeFromGridUnclustered(y,l);return}u[l].addObject(a,m)}this._topClusterLevel._addChild(a),a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue(),this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(a){var l=this._maxLat;return l!==void 0&&(a.getNorth()>=l&&(a._northEast.lat=1/0),a.getSouth()<=-l&&(a._southWest.lat=-1/0)),a},_animationAddLayerNonAnimated:function(a,l){if(l===a)this._featureGroup.addLayer(a);else if(l._childCount===2){l._addToMap();var d=l.getAllChildMarkers();this._featureGroup.removeLayer(d[0]),this._featureGroup.removeLayer(d[1])}else l._updateIcon()},_extractNonGroupLayers:function(a,l){var d=a.getLayers(),u=0,f;for(l=l||[];u<d.length;u++){if(f=d[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,l);continue}l.push(f)}return l},_overrideMarkerIcon:function(a){var l=a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}});return l}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,l){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(a,l){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(a,l){this._animationAddLayerNonAnimated(a,l)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(a,l){var d=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),m;this._ignoreMove=!0,this._topClusterLevel._recursively(d,a,f,function(g){var y=g._latlng,k=g._markers,S;for(d.contains(y)||(y=null),g._isSingleParent()&&a+1===l?(u.removeLayer(g),g._recursivelyAddChildrenToMap(null,l,d)):(g.clusterHide(),g._recursivelyAddChildrenToMap(y,l,d)),m=k.length-1;m>=0;m--)S=k[m],d.contains(S._latlng)||u.removeLayer(S)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(d,l),u.eachLayer(function(g){!(g instanceof L.MarkerCluster)&&g._icon&&g.clusterShow()}),this._topClusterLevel._recursively(d,a,l,function(g){g._recursivelyRestoreChildPositions(l)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(d,a,f,function(g){u.removeLayer(g),g.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(a,l){this._animationZoomOutSingle(this._topClusterLevel,a-1,l),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,l){var d=this,u=this._featureGroup;u.addLayer(a),l!==a&&(l._childCount>2?(l._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(l.getLatLng())),a.clusterHide(),this._enqueue(function(){u.removeLayer(a),a.clusterShow(),d._animationEnd()})):(this._forceLayout(),d._animationStart(),d._animationZoomOutSingle(l,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,l,d){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,l+1,d);var m=this;this._forceLayout(),a._recursivelyBecomeVisible(u,d),this._enqueue(function(){if(a._childCount===1){var g=a._markers[0];this._ignoreMove=!0,g.setLatLng(g.getLatLng()),this._ignoreMove=!1,g.clusterShow&&g.clusterShow()}else a._recursively(u,d,f,function(y){y._recursivelyRemoveChildrenFromMap(u,f,l+1)});m._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)};var o=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(a,l,d,u){L.Marker.prototype.initialize.call(this,d?d._cLatLng||d.getLatLng():new L.LatLng(0,0),{icon:this,pane:a.options.clusterPane}),this._group=a,this._zoom=l,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,d&&this._addChild(d),u&&this._addChild(u)},getAllChildMarkers:function(a,l){a=a||[];for(var d=this._childClusters.length-1;d>=0;d--)this._childClusters[d].getAllChildMarkers(a,l);for(var u=this._markers.length-1;u>=0;u--)l&&this._markers[u].__dragStart||a.push(this._markers[u]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){for(var l=this._childClusters.slice(),d=this._group._map,u=d.getBoundsZoom(this._bounds),f=this._zoom+1,m=d.getZoom(),g;l.length>0&&u>f;){f++;var y=[];for(g=0;g<l.length;g++)y=y.concat(l[g]._childClusters);l=y}u>f?this._group._map.setView(this._latlng,f):u<=m?this._group._map.setView(this._latlng,m+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,l){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(a),a instanceof L.MarkerCluster?(l||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(l||this._markers.push(a),this._childCount++),this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=1/0,a._southWest.lng=1/0),a._northEast&&(a._northEast.lat=-1/0,a._northEast.lng=-1/0)},_recalculateBounds:function(){var a=this._markers,l=this._childClusters,d=0,u=0,f=this._childCount,m,g,y,k;if(f!==0){for(this._resetBounds(),m=0;m<a.length;m++)y=a[m]._latlng,this._bounds.extend(y),d+=y.lat,u+=y.lng;for(m=0;m<l.length;m++)g=l[m],g._boundsNeedUpdate&&g._recalculateBounds(),this._bounds.extend(g._bounds),y=g._wLatLng,k=g._childCount,d+=y.lat*k,u+=y.lng*k;this._latlng=this._wLatLng=new L.LatLng(d/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,l,d){this._recursively(a,this._group._map.getMinZoom(),d-1,function(u){var f=u._markers,m,g;for(m=f.length-1;m>=0;m--)g=f[m],g._icon&&(g._setPos(l),g.clusterHide())},function(u){var f=u._childClusters,m,g;for(m=f.length-1;m>=0;m--)g=f[m],g._icon&&(g._setPos(l),g.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,l,d,u){this._recursively(a,u,l,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),d),f._isSingleParent()&&d-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,l,d)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(a,l){this._recursively(a,this._group._map.getMinZoom(),l,null,function(d){d.clusterShow()})},_recursivelyAddChildrenToMap:function(a,l,d){this._recursively(d,this._group._map.getMinZoom()-1,l,function(u){if(l!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var m=u._markers[f];d.contains(m._latlng)&&(a&&(m._backupLatlng=m.getLatLng(),m.setLatLng(a),m.clusterHide&&m.clusterHide()),u._group._featureGroup.addLayer(m))}},function(u){u._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var l=this._markers.length-1;l>=0;l--){var d=this._markers[l];d._backupLatlng&&(d.setLatLng(d._backupLatlng),delete d._backupLatlng)}if(a-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,l,d,u){var f,m;this._recursively(a,l-1,d-1,function(g){for(m=g._markers.length-1;m>=0;m--)f=g._markers[m],(!u||!u.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(g){for(m=g._childClusters.length-1;m>=0;m--)f=g._childClusters[m],(!u||!u.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(a,l,d,u,f){var m=this._childClusters,g=this._zoom,y,k;if(l<=g&&(u&&u(this),f&&g===d&&f(this)),g<l||g<d)for(y=m.length-1;y>=0;y--)k=m[y],k._boundsNeedUpdate&&k._recalculateBounds(),a.intersects(k._bounds)&&k._recursively(a,l,d,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var a=this.options.opacity;return this.setOpacity(0),this.options.opacity=a,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(a){this._cellSize=a,this._sqCellSize=a*a,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(a,l){var d=this._getCoord(l.x),u=this._getCoord(l.y),f=this._grid,m=f[u]=f[u]||{},g=m[d]=m[d]||[],y=L.Util.stamp(a);this._objectPoint[y]=l,g.push(a)},updateObject:function(a,l){this.removeObject(a),this.addObject(a,l)},removeObject:function(a,l){var d=this._getCoord(l.x),u=this._getCoord(l.y),f=this._grid,m=f[u]=f[u]||{},g=m[d]=m[d]||[],y,k;for(delete this._objectPoint[L.Util.stamp(a)],y=0,k=g.length;y<k;y++)if(g[y]===a)return g.splice(y,1),k===1&&delete m[d],!0},eachObject:function(a,l){var d,u,f,m,g,y,k,S=this._grid;for(d in S){g=S[d];for(u in g)for(y=g[u],f=0,m=y.length;f<m;f++)k=a.call(l,y[f]),k&&(f--,m--)}},getNearObject:function(a){var l=this._getCoord(a.x),d=this._getCoord(a.y),u,f,m,g,y,k,S,_,C=this._objectPoint,j=this._sqCellSize,x=null;for(u=d-1;u<=d+1;u++)if(g=this._grid[u],g){for(f=l-1;f<=l+1;f++)if(y=g[f],y)for(m=0,k=y.length;m<k;m++)S=y[m],_=this._sqDist(C[L.Util.stamp(S)],a),(_<j||_<=j&&x===null)&&(j=_,x=S)}return x},_getCoord:function(a){var l=Math.floor(a/this._cellSize);return isFinite(l)?l:a},_sqDist:function(a,l){var d=l.x-a.x,u=l.y-a.y;return d*d+u*u}},function(){L.QuickHull={getDistant:function(a,l){var d=l[1].lat-l[0].lat,u=l[0].lng-l[1].lng;return u*(a.lat-l[0].lat)+d*(a.lng-l[0].lng)},findMostDistantPointFromBaseLine:function(a,l){var d=0,u=null,f=[],m,g,y;for(m=l.length-1;m>=0;m--){if(g=l[m],y=this.getDistant(g,a),y>0)f.push(g);else continue;y>d&&(d=y,u=g)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(a,l){var d=[],u=this.findMostDistantPointFromBaseLine(a,l);return u.maxPoint?(d=d.concat(this.buildConvexHull([a[0],u.maxPoint],u.newPoints)),d=d.concat(this.buildConvexHull([u.maxPoint,a[1]],u.newPoints)),d):[a[0]]},getConvexHull:function(a){var l=!1,d=!1,u=!1,f=!1,m=null,g=null,y=null,k=null,S=null,_=null,C;for(C=a.length-1;C>=0;C--){var j=a[C];(l===!1||j.lat>l)&&(m=j,l=j.lat),(d===!1||j.lat<d)&&(g=j,d=j.lat),(u===!1||j.lng>u)&&(y=j,u=j.lng),(f===!1||j.lng<f)&&(k=j,f=j.lng)}d!==l?(_=g,S=m):(_=k,S=y);var x=[].concat(this.buildConvexHull([_,S],a),this.buildConvexHull([S,_],a));return x}}}(),L.MarkerCluster.include({getConvexHull:function(){var a=this.getAllChildMarkers(),l=[],d,u;for(u=a.length-1;u>=0;u--)d=a[u].getLatLng(),l.push(d);return L.QuickHull.getConvexHull(l)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var a=this.getAllChildMarkers(null,!0),l=this._group,d=l._map,u=d.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(a.length,u):a.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(a.length,u):(u.y+=10,f=this._generatePointsCircle(a.length,u)),this._animationSpiderfy(a,f)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,l){var d=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a),u=d/this._2PI,f=this._2PI/a,m=[],g,y;for(u=Math.max(u,35),m.length=a,g=0;g<a;g++)y=this._circleStartAngle+g*f,m[g]=new L.Point(l.x+u*Math.cos(y),l.y+u*Math.sin(y))._round();return m},_generatePointsSpiral:function(a,l){var d=this._group.options.spiderfyDistanceMultiplier,u=d*this._spiralLengthStart,f=d*this._spiralFootSeparation,m=d*this._spiralLengthFactor*this._2PI,g=0,y=[],k;for(y.length=a,k=a;k>=0;k--)k<a&&(y[k]=new L.Point(l.x+u*Math.cos(g),l.y+u*Math.sin(g))._round()),g+=f/u+k*5e-4,u+=m/g;return y},_noanimationUnspiderfy:function(){var a=this._group,l=a._map,d=a._featureGroup,u=this.getAllChildMarkers(null,!0),f,m;for(a._ignoreMove=!0,this.setOpacity(1),m=u.length-1;m>=0;m--)f=u[m],d.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(l.removeLayer(f._spiderLeg),delete f._spiderLeg);a.fire("unspiderfied",{cluster:this,markers:u}),a._ignoreMove=!1,a._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(a,l){var d=this._group,u=d._map,f=d._featureGroup,m=this._group.options.spiderLegPolylineOptions,g,y,k,S;for(d._ignoreMove=!0,g=0;g<a.length;g++)S=u.layerPointToLatLng(l[g]),y=a[g],k=new L.Polyline([this._latlng,S],m),u.addLayer(k),y._spiderLeg=k,y._preSpiderfyLatlng=y._latlng,y.setLatLng(S),y.setZIndexOffset&&y.setZIndexOffset(1e6),f.addLayer(y);this.setOpacity(.3),d._ignoreMove=!1,d.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(a,l){var d=this,u=this._group,f=u._map,m=u._featureGroup,g=this._latlng,y=f.latLngToLayerPoint(g),k=L.Path.SVG,S=L.extend({},this._group.options.spiderLegPolylineOptions),_=S.opacity,C,j,x,N,b,P;for(_===void 0&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),k?(S.opacity=0,S.className=(S.className||"")+" leaflet-cluster-spider-leg"):S.opacity=_,u._ignoreMove=!0,C=0;C<a.length;C++)j=a[C],P=f.layerPointToLatLng(l[C]),x=new L.Polyline([g,P],S),f.addLayer(x),j._spiderLeg=x,k&&(N=x._path,b=N.getTotalLength()+.1,N.style.strokeDasharray=b,N.style.strokeDashoffset=b),j.setZIndexOffset&&j.setZIndexOffset(1e6),j.clusterHide&&j.clusterHide(),m.addLayer(j),j._setPos&&j._setPos(y);for(u._forceLayout(),u._animationStart(),C=a.length-1;C>=0;C--)P=f.layerPointToLatLng(l[C]),j=a[C],j._preSpiderfyLatlng=j._latlng,j.setLatLng(P),j.clusterShow&&j.clusterShow(),k&&(x=j._spiderLeg,N=x._path,N.style.strokeDashoffset=0,x.setStyle({opacity:_}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:d,markers:a})},200)},_animationUnspiderfy:function(a){var l=this,d=this._group,u=d._map,f=d._featureGroup,m=a?u._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):u.latLngToLayerPoint(this._latlng),g=this.getAllChildMarkers(null,!0),y=L.Path.SVG,k,S,_,C,j,x;for(d._ignoreMove=!0,d._animationStart(),this.setOpacity(1),S=g.length-1;S>=0;S--)k=g[S],k._preSpiderfyLatlng&&(k.closePopup(),k.setLatLng(k._preSpiderfyLatlng),delete k._preSpiderfyLatlng,x=!0,k._setPos&&(k._setPos(m),x=!1),k.clusterHide&&(k.clusterHide(),x=!1),x&&f.removeLayer(k),y&&(_=k._spiderLeg,C=_._path,j=C.getTotalLength()+.1,C.style.strokeDashoffset=j,_.setStyle({opacity:0})));d._ignoreMove=!1,setTimeout(function(){var N=0;for(S=g.length-1;S>=0;S--)k=g[S],k._spiderLeg&&N++;for(S=g.length-1;S>=0;S--)k=g[S],k._spiderLeg&&(k.clusterShow&&k.clusterShow(),k.setZIndexOffset&&k.setZIndexOffset(0),N>1&&f.removeLayer(k),u.removeLayer(k._spiderLeg),delete k._spiderLeg);d._animationEnd(),d.fire("unspiderfied",{cluster:l,markers:g})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof L.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof L.LayerGroup?a=a._layers:a instanceof L.MarkerCluster?a=a.getAllChildMarkers():a instanceof L.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var l,d;for(l in a)for(d=a[l].__parent;d;)d._iconNeedsUpdate=!0,d=d.__parent},_refreshSingleMarkerModeMarkers:function(a){var l,d;for(l in a)d=a[l],this.hasLayer(d)&&d.setIcon(this._overrideMarkerIcon(d))}}),L.Marker.include({refreshIconOptions:function(a,l){var d=this.options.icon;return L.setOptions(d,a),this.setIcon(d),l&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),n.MarkerClusterGroup=s,n.MarkerCluster=o,Object.defineProperty(n,"__esModule",{value:!0})})})(gp,gp.exports);const Qj="https://nominatim.openstreetmap.org/search",Vu="ev_station_geocoding_cache",Vn=new Map;function Xj(){try{const e=localStorage.getItem(Vu);if(e){const t=JSON.parse(e);return Object.entries(t).forEach(([n,s])=>{Vn.set(n,s)}),console.log(` Loaded ${Vn.size} cached geocoding results from localStorage`),!0}}catch(e){console.warn(" Failed to load geocoding cache from localStorage:",e.message)}return!1}function Lc(){try{const e=Object.fromEntries(Vn);localStorage.setItem(Vu,JSON.stringify(e))}catch(e){console.warn(" Failed to save geocoding cache to localStorage:",e.message)}}Xj();async function eS(e,t="Vietnam"){if(!e||typeof e!="string")return null;const n=`${e}|${t}`;if(Vn.has(n)){const s=Vn.get(n);return s&&console.log(` Geocoding cache hit for "${e}"`),s}try{const o=e.split(",").map(u=>u.trim())[0]||e,a=[`${e}, Vietnam`,`${o}, ${t}, Vietnam`,`${o} ${t} Vietnam`,e];console.log(` Geocoding address: "${e}" (city: "${t}")`);let l=null,d="";for(const u of a){d=u;const f=await fetch(`${Qj}?q=${encodeURIComponent(u)}&format=json&limit=10&timeout=10&accept-language=vi&countrycodes=vn`,{headers:{Accept:"application/json","User-Agent":"EVStationRental-FE"}});if(f.ok){if(l=await f.json(),Array.isArray(l)&&l.length>0){const m=l.filter(S=>{const _=(S.type||S.class||"").toLowerCase(),C=(S.addresstype||"").toLowerCase();return!["state","province","country"].includes(_)&&!["state","province","country"].includes(C)}),g=m.length>0?m:l,y=g.find(S=>{var j;const _=((j=S.display_name)==null?void 0:j.toLowerCase())||"",C=(t==null?void 0:t.toLowerCase())||"";return C&&_.includes(C)})||g[0],k={lat:parseFloat(y.lat),lng:parseFloat(y.lon)};if(!isNaN(k.lat)&&!isNaN(k.lng))return console.log(` Geocoded "${e}" (via "${d}")  ${k.lat.toFixed(4)}, ${k.lng.toFixed(4)}`),Vn.set(n,k),Lc(),k}await new Promise(m=>setTimeout(m,100))}}return console.warn(` Could not geocode: "${e}" (tried: ${a.join(" | ")})`),Vn.set(n,null),Lc(),null}catch(s){return console.error(` Geocoding error for "${e}":`,s.message),Vn.set(n,null),Lc(),null}}async function tS(e,t=500){if(!Array.isArray(e)||e.length===0)return console.warn(" geocodeAddressesBatch: Empty or invalid items array"),new Map;const n=new Map;let s=0;for(const o of e){const a=o.address||o.Address||"",l=o.city||"Vietnam";if(!a){console.warn(` Station ${o.id}: No address found - skipping geocoding`),n.set(o.id,null);continue}const d=await eS(a,l);d&&s++,n.set(o.id,d),e.indexOf(o)<e.length-1&&await new Promise(u=>setTimeout(u,t))}return console.log(` Batch geocoding complete: ${s}/${e.length} stations geocoded`),n}function nS(){var e;return{size:Vn.size,entries:Array.from(Vn.entries()),storageSize:((e=localStorage.getItem(Vu))==null?void 0:e.length)||0}}function rS(e,t="Vietnam"){const n=`${e}|${t}`;return Vn.get(n)||null}delete Zi.Icon.Default.prototype._getIconUrl;Zi.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const iS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),sS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),aS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),oS=new Zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function lS({stations:e,userLocation:t,stationCoords:n}){const s=Gj();return v.useEffect(()=>{if(!(!s||!e||e.length===0))try{const o=setTimeout(()=>{if(!s||!s._container)return;const a=[];let l=0;for(const u of e){const f=u.id||u.Id||u.stationId,m=n.get(f);m&&Number.isFinite(m.lat)&&Number.isFinite(m.lng)?(a.push([m.lat,m.lng]),l++):console.warn(` Station ${f} has invalid coords:`,m)}console.log(` Valid station markers for map: ${l}/${e.length}`),console.log(" Station markers array:",a.slice(0,5).map((u,f)=>` [${f}]: [${u[0]}, ${u[1]}]`).join(", "),l>5?`... +${l-5} more`:"");const d=(u,f,m,g)=>{const k=(m-u)*Math.PI/180,S=(g-f)*Math.PI/180,_=Math.sin(k/2)*Math.sin(k/2)+Math.cos(u*Math.PI/180)*Math.cos(m*Math.PI/180)*Math.sin(S/2)*Math.sin(S/2);return 6371*(2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_)))};if(a.length>0)try{if(t)console.log(` Zooming to user location: [${t.lat}, ${t.lng}]`),s.setView([t.lat,t.lng],14,{animate:!0,duration:.5}),console.log(" Zoomed to user location with zoom level 14");else{const u=a;console.log(` Building bounds from ${u.length} coordinates...`);const f=Zi.latLngBounds(u);console.log(` Bounds calculated: NE: ${f.getNorthEast()}, SW: ${f.getSouthWest()}`),console.log(" Calling fitBounds..."),s.fitBounds(f,{padding:[50,50],animate:!0,duration:.5}),console.log(" Fitted map bounds"),console.log(` Map zoom after fitBounds: ${s.getZoom()}`)}}catch(u){console.warn(" Error fitting bounds:",u.message),t&&s.setView([t.lat,t.lng],10)}else t&&s.setView([t.lat,t.lng],12)},100);return()=>clearTimeout(o)}catch(o){console.warn(" Error in MapController:",o.message)}},[s,e,t,n]),null}function cS({isOpen:e,onClose:t,stations:n,onSelectStation:s,selectedStationId:o,userLocation:a}){const[l,d]=v.useState(0),[u,f]=v.useState(new Map),[m,g]=v.useState(null),[y,k]=v.useState(!1),[S,_]=v.useState(!1),[C,j]=v.useState([]),[x,N]=v.useState(()=>{const T=localStorage.getItem("bookmarkedStations");return T?JSON.parse(T):[]}),b=T=>{N(R=>{const B=R.includes(T)?R.filter(U=>U!==T):[...R,T];return localStorage.setItem("bookmarkedStations",JSON.stringify(B)),B})};if(v.useEffect(()=>{if(!e||!n||n.length===0)return;const T=nS();g(T),console.log(" Geocoding cache stats:",T);const R=new Map;let B=0,U=0;const E=[];for(const O of n){const Q=O.id||O.Id||O.stationId,ie=O.address||O.Address||"",M=O.stationName||O.name||O.Name||"Unknown",W=rS(ie,"Vietnam");W&&Number.isFinite(W.lat)&&Number.isFinite(W.lng)?(R.set(Q,W),B++):W===null?E.push(`${M} (address: "${ie}" - geocoding failed)`):W&&(!Number.isFinite(W.lat)||!Number.isFinite(W.lng))?E.push(`${M} (address: "${ie}" - invalid coords: lat=${W.lat}, lng=${W.lng})`):(U++,E.push(`${M} (address: "${ie}" - not geocoded yet)`))}console.log(` Using ${B}/${n.length} cached coordinates (${U} never attempted)`),E.length>0&&console.log(` Stations without valid coordinates (${E.length}):`,E),console.log(` stationCoords map contents (${R.size} entries):`);const A=new Map;let H=0;for(const[O,Q]of R){if(Q){const ie=`${Q.lat.toFixed(6)},${Q.lng.toFixed(6)}`;A.set(ie,(A.get(ie)||0)+1)}H<10&&(console.log(`  - ID: ${O} => ${Q?`[${Q.lat}, ${Q.lng}]`:"null"}`),H++)}const q=Array.from(A.entries()).filter(([O,Q])=>Q>1);q.length>0&&console.warn(` Found ${q.length} duplicate coordinates:`,q.map(([O,Q])=>`${O} (${Q} stations)`).join(", ")),j(q),f(R),_(!0),U>0?k(!0):k(!1)},[e,n]),!e)return null;const P=a||{lat:10.8231,lng:106.6297};return r.jsxs("div",{className:`map-modal ${e?"active":""}`,children:[r.jsxs("div",{className:"map-modal-header",children:[r.jsxs("h3",{children:[r.jsx("i",{className:"fas fa-map-marked-alt"})," Select Location on Map"]}),r.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:r.jsx("button",{className:"map-modal-close",onClick:t,children:r.jsx("i",{className:"fas fa-times"})})})]}),r.jsx("div",{className:"map-container",children:r.jsxs(Kj,{center:[P.lat,P.lng],zoom:12,style:{height:"100%",width:"100%"},zoomControl:!0,children:[r.jsx(Jj,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.jsx(lS,{stations:n,userLocation:a,stationCoords:u}),a&&r.jsx(pp,{position:[a.lat,a.lng],icon:iS,children:r.jsx(mp,{children:r.jsx("div",{style:{padding:"4px"},children:r.jsx("strong",{children:"Your Location"})})})}),S&&(()=>{let T=0,R=0;const B=n.map((U,E)=>{const A=U.id||U.Id||U.stationId,H=u.get(A),q=U.stationName||U.name||U.Name||"Unknown Station",O=U.address||U.Address||"";if(console.log(` Station ${E}: "${q}" | ID: ${A} | Coords: ${H?`[${H.lat}, ${H.lng}]`:"MISSING"}`),!H)return R++,null;T++;const Q=A===o,ie=x.includes(A),M=Q?oS:ie?aS:sS;return r.jsx(pp,{position:[H.lat,H.lng],icon:M,children:r.jsx(mp,{children:r.jsxs("div",{style:{padding:"8px",minWidth:"200px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#333"},children:q}),r.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#666"},children:O}),r.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:r.jsx("button",{onClick:()=>b(A),style:{background:ie?"#4caf50":"#2196f3",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",flex:1},children:ie?" Bookmarked":" Bookmark"})}),r.jsx("button",{onClick:()=>s(A,q,O),style:{background:"#ff6b35",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",width:"100%"},children:Q?" Selected":"Select Location"})]})})},A)});return console.log(` Total markers rendered: ${T}, skipped: ${R}`),T+R!==n.length&&console.error(` MISMATCH: Expected ${n.length} total but got ${T+R}`),B})()]},l)}),r.jsx("div",{className:"map-modal-footer",children:r.jsxs("p",{children:[r.jsx("i",{className:"fas fa-info-circle"})," Click on a marker to select a station",C.length>0&&r.jsx("span",{style:{color:"#f44336",marginLeft:"16px"}})]})})]})}function ky({isOpen:e,onClose:t,stations:n=[],userLocation:s=null,onSearch:o,currentSearchData:a=null}){const[l,d]=v.useState(!1),[u,f]=v.useState(()=>{if(a)return{location:a.location||"",locationName:a.locationName||"Select location",pickupDate:a.pickupDate||new Date().toISOString().split("T")[0],pickupTime:a.pickupTime||"15:00",returnDate:a.returnDate||new Date(new Date().getTime()+24*60*60*1e3).toISOString().split("T")[0],returnTime:a.returnTime||"19:00",calendarMode:null,currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear()};const B=new Date,U=new Date(B.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:B.toISOString().split("T")[0],pickupTime:"15:00",returnDate:U.toISOString().split("T")[0],returnTime:"19:00",calendarMode:null,currentMonth:B.getMonth(),currentYear:B.getFullYear()}}),[m,g]=v.useState(""),y=Array.from({length:18},(B,U)=>`${(6+U).toString().padStart(2,"0")}:00`);v.useEffect(()=>{P()},[u.pickupDate,u.pickupTime,u.returnDate,u.returnTime]),v.useEffect(()=>{if(e){const B=document.querySelector(".search-modal-body");B&&(B.scrollTop=0)}},[e]),v.useEffect(()=>{e&&a&&f(B=>({...B,location:a.location||"",locationName:a.locationName||"Select location",pickupDate:a.pickupDate||B.pickupDate,pickupTime:a.pickupTime||"15:00",returnDate:a.returnDate||B.returnDate,returnTime:a.returnTime||"19:00"}))},[e,a]);function k(){d(!1),t()}function S(){d(!0)}function _(B,U,E){f(A=>({...A,location:B,locationName:U})),d(!1)}function C(B){f(U=>({...U,calendarMode:U.calendarMode===B?null:B}))}function j(B){const U=`${B}-time`;f(E=>({...E,calendarMode:E.calendarMode===U?null:U}))}function x(B){f(U=>{let E=U.currentMonth+B,A=U.currentYear;return E>11&&(E=0,A++),E<0&&(E=11,A--),{...U,currentMonth:E,currentYear:A}})}function N(B){f(U=>{const E={...U};if(U.calendarMode==="pickup"){E.pickupDate=B;const A=new Date(`${B}T${U.pickupTime}`);if(new Date(`${U.returnDate}T${U.returnTime}`)<=A){E.returnDate=B;const q=parseInt(U.pickupTime.split(":")[0]),O=Math.min(q+2,23);E.returnTime=`${O.toString().padStart(2,"0")}:00`}}else E.returnDate=B;return E.calendarMode=null,E})}function b(B,U){f(E=>({...E,[B+"Time"]:U,calendarMode:null}))}function P(){try{const B=new Date(`${u.pickupDate}T${u.pickupTime}`),E=new Date(`${u.returnDate}T${u.returnTime}`)-B,A=Math.floor(E/(1e3*60*60));if(A<0)return g("Invalid duration");if(A===0)return g("Less than 1 hour");const H=Math.floor(A/24),q=A%24;let O="";H>0&&(O+=`${H} day${H>1?"s":""} `),q>0&&(O+=`${q} hour${q>1?"s":""}`),g(O.trim()||"0 hours")}catch{g("")}}function T(){if(!u.location){alert("Please select a pick-up location");return}const B=new Date(`${u.pickupDate}T${u.pickupTime}`),U=new Date(`${u.returnDate}T${u.returnTime}`);if(B<new Date){alert("Pick-up date and time must be in the future.");return}if(U<=B){alert("Return date and time must be after pick-up date and time.");return}if((U-B)/(1e3*60*60)<1){alert("Minimum rental duration is 1 hour.");return}o&&o(u)}function R(){const B=new Date(u.currentYear,u.currentMonth,1),U=new Date(u.currentYear,u.currentMonth+1,0),E=new Date;E.setHours(0,0,0,0);const A=[];for(let H=0;H<B.getDay();H++)A.push(r.jsx("div",{className:"calendar-day"},`empty-${H}`));for(let H=1;H<=U.getDate();H++){const q=`${u.currentYear}-${(u.currentMonth+1).toString().padStart(2,"0")}-${H.toString().padStart(2,"0")}`,O=new Date(u.currentYear,u.currentMonth,H),Q=O.toDateString()===E.toDateString(),ie=O<E,M=q===(u.calendarMode==="pickup"?u.pickupDate:u.returnDate),W=["calendar-day"];ie&&W.push("disabled"),Q&&W.push("today"),M&&W.push("selected"),A.push(r.jsx("div",{className:W.join(" "),onClick:()=>{ie||N(q)},children:H},q))}return A}return e?r.jsxs(r.Fragment,{children:[!l&&r.jsx("div",{className:"search-modal-backdrop",onClick:k}),r.jsx(cS,{isOpen:l,onClose:()=>d(!1),stations:n,onSelectStation:_,selectedStationId:u.location,userLocation:s}),r.jsx("div",{className:`search-modal ${e?"active":""} ${l?"with-map":""}`,children:r.jsxs("div",{className:"search-modal-content",children:[r.jsxs("div",{className:"search-modal-header",children:[r.jsx("h3",{children:"Search Cars"}),r.jsx("button",{className:"search-modal-close",onClick:k,children:""})]}),r.jsxs("div",{className:"search-modal-body",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),r.jsxs("div",{className:"search-input",onClick:S,children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),r.jsx("span",{children:u.locationName})]})]}),r.jsxs("div",{className:"search-field-row",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),r.jsxs("div",{className:"search-input",onClick:()=>C("pickup"),children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsx("span",{children:new Date(u.pickupDate).toLocaleDateString()})]}),u.calendarMode==="pickup"&&r.jsxs("div",{className:"calendar-dropdown active",children:[r.jsxs("div",{className:"calendar-header",children:[r.jsx("button",{onClick:()=>x(-1),children:"<"}),r.jsx("span",{children:new Date(u.currentYear,u.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{onClick:()=>x(1),children:">"})]}),r.jsxs("div",{className:"calendar-weekdays",children:[r.jsx("div",{children:"Sun"}),r.jsx("div",{children:"Mon"}),r.jsx("div",{children:"Tue"}),r.jsx("div",{children:"Wed"}),r.jsx("div",{children:"Thu"}),r.jsx("div",{children:"Fri"}),r.jsx("div",{children:"Sat"})]}),r.jsx("div",{className:"calendar-days",children:R()})]})]}),r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),r.jsxs("div",{className:"search-input",onClick:()=>j("pickup"),children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:u.pickupTime})]}),r.jsxs("div",{className:`time-picker-dropdown ${u.calendarMode==="pickup-time"?"active":""}`,children:[r.jsx("div",{className:"time-picker-label",children:"Choose pick-up time"}),r.jsx("div",{className:"time-picker-options",children:y.map(B=>r.jsx("div",{className:`time-option ${B===u.pickupTime?"selected":""}`,onClick:()=>b("pickup",B),children:B},B))})]})]})]}),r.jsxs("div",{className:"search-field-row",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),r.jsxs("div",{className:"search-input",onClick:()=>C("return"),children:[r.jsx("i",{className:"fas fa-calendar-check"}),r.jsx("span",{children:new Date(u.returnDate).toLocaleDateString()})]}),u.calendarMode==="return"&&r.jsxs("div",{className:"calendar-dropdown active",children:[r.jsxs("div",{className:"calendar-header",children:[r.jsx("button",{onClick:()=>x(-1),children:"<"}),r.jsx("span",{children:new Date(u.currentYear,u.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{onClick:()=>x(1),children:">"})]}),r.jsxs("div",{className:"calendar-weekdays",children:[r.jsx("div",{children:"Sun"}),r.jsx("div",{children:"Mon"}),r.jsx("div",{children:"Tue"}),r.jsx("div",{children:"Wed"}),r.jsx("div",{children:"Thu"}),r.jsx("div",{children:"Fri"}),r.jsx("div",{children:"Sat"})]}),r.jsx("div",{className:"calendar-days",children:R()})]})]}),r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-clock"})," Return Time"]}),r.jsxs("div",{className:"search-input",onClick:()=>j("return"),children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:u.returnTime})]}),r.jsxs("div",{className:`time-picker-dropdown ${u.calendarMode==="return-time"?"active":""}`,children:[r.jsx("div",{className:"time-picker-label",children:"Choose return time"}),r.jsx("div",{className:"time-picker-options",children:y.map(B=>r.jsx("div",{className:`time-option ${B===u.returnTime?"selected":""}`,onClick:()=>b("return",B),children:B},B))})]})]})]}),r.jsxs("div",{className:"rental-duration",children:[r.jsx("i",{className:"fas fa-info-circle"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Rental Duration"}),r.jsx("p",{children:m})]})]}),r.jsxs("div",{className:"rental-warning",children:[r.jsx("i",{className:"fas fa-exclamation-circle"}),r.jsx("p",{children:"Minimum rental duration is 1 hour. Same-day rentals are available. To ensure cars are properly prepared and meet environmental standards, please book at least 2 hours in advance."})]}),r.jsxs("button",{className:"btn-search-submit",onClick:T,children:[r.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})]})})]}):null}function dS(){const[e,t]=v.useState([]),[n,s]=v.useState([]),[o,a]=v.useState(!0),[l,d]=v.useState(0),u=v.useRef(null),[f,m]=v.useState(null),[g,y]=v.useState(!1),[k,S]=v.useState(0),_=["/Picture/E car 1.jpg","/Picture/E car 3.png","/Picture/E car 2.png"],C=v.useRef(null),{showToast:j}=Du();v.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(B=>{const U=B.coords.accuracy;m({lat:B.coords.latitude,lng:B.coords.longitude}),console.log(" User location:",B.coords.latitude,B.coords.longitude),console.log(" Accuracy:",U,"meters"),U>100&&console.warn(" Location accuracy is low (>"+U+"m). Position may not be precise.")},B=>{console.error(" Could not get user location:",B.message),m({lat:10.8231,lng:106.6297}),j("Could not detect your location. Using default location.","warning",3e3)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.warn("Geolocation is not supported by this browser"),m({lat:10.8231,lng:106.6297}),j("Your browser does not support geolocation","warning",3e3));const T=async()=>{try{if(!Rd.getAllStations){console.warn("stationApi.getAllStations not available");return}const B=await Rd.getAllStations(1,500);console.log(" Loaded stations in HomePage:",B.length,"items"),t(B||[]),B&&B.length>0&&(console.log(" Geocoding all stations in background..."),tS(B,300))}catch(B){console.error("Failed to load stations",B)}},R=async()=>{try{if(!rt.getAllCars){console.warn("carApi.getAllCars not available"),a(!1);return}a(!0);const B=await rt.getAllCars(1,100);console.log(" Loaded cars in HomePage:",B.length,"items"),s(B||[])}catch(B){console.error("Failed to load cars",B)}finally{a(!1)}};T(),R()},[]),v.useEffect(()=>{if(g)return;const T=setInterval(()=>{S(R=>(R+1)%_.length)},6e3);return()=>clearInterval(T)},[_.length,g]),v.useEffect(()=>{const T=u.current;if(!T)return;const R=T.querySelector(".car-card-item");if(!R)return;const B=R.offsetWidth,E=l*(B+20);T.style.transform=`translateX(-${E}px)`},[l,n]),v.useEffect(()=>{const T=()=>{const R=C.current;if(!R)return;const B=document.querySelector(".header"),U=B?B.offsetHeight:80;window.scrollY>U+50?(R.classList.add("sticky"),R.style.top=`${U}px`):(R.classList.remove("sticky"),R.style.top="")};return window.addEventListener("scroll",T,{passive:!0}),T(),()=>window.removeEventListener("scroll",T)},[]);function x(){y(!0)}function N(){y(!1)}function b(T){const R={stationId:T.location,stationName:T.locationName,pickupDate:T.pickupDate,pickupTime:T.pickupTime,returnDate:T.returnDate,returnTime:T.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(R))}catch{}const B=new URLSearchParams({location:T.location,"pickup-date":T.pickupDate,"pickup-time":T.pickupTime,"return-date":T.returnDate,"return-time":T.returnTime});window.location.href=`/cars?${B.toString()}`}function P(){const T=u.current;if(!T)return;const R=T.querySelector(".car-card-item");if(!R)return;const B=Math.floor(T.parentElement.offsetWidth/(R.offsetWidth+20))||1,U=Math.min(n.length,10),E=Math.max(0,Math.ceil(U-B));d(A=>Math.min(E,A+1))}return r.jsxs("main",{children:[r.jsxs("section",{className:"hero-slideshow",children:[r.jsx("div",{className:"slideshow-container",children:_.map((T,R)=>r.jsx("div",{className:`slide fade ${R===k?"active":""}`,children:r.jsx("img",{src:T,alt:`Electric Car ${R+1}`})},R))}),r.jsx("div",{className:"search-form-overlay",id:"searchFormOverlay",ref:C,children:r.jsx("div",{className:"container",children:r.jsxs("div",{className:"search-form-wrapper",children:[r.jsx("h2",{children:"Find Your Perfect Rental Car"}),r.jsxs("div",{className:"search-summary",children:[r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Location"}),r.jsx("div",{className:"summary-value",id:"summaryLocation",children:"Select location"})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Date"}),r.jsx("div",{className:"summary-value",children:new Date().toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Time"}),r.jsx("div",{className:"summary-value",children:"15:00"})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Return Date"}),r.jsx("div",{className:"summary-value",children:new Date(Date.now()+24*60*60*1e3).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:x,children:[r.jsx("div",{className:"summary-label",children:"Return Time"}),r.jsx("div",{className:"summary-value",children:"19:00"})]}),r.jsxs("button",{type:"button",className:"btn-search",onClick:x,children:[r.jsx("i",{className:"fas fa-search"})," SEARCH"]})]})]})})})]}),r.jsx(ky,{isOpen:g,onClose:N,stations:e,userLocation:f,onSearch:b}),r.jsx("section",{className:"car-section","data-type":"models",children:r.jsxs("div",{className:"container",children:[r.jsx("div",{className:"car-section-header",children:r.jsx("h2",{children:"Our Electric Car Models"})}),r.jsxs("div",{className:"car-carousel-wrapper",children:[r.jsx("button",{className:"carousel-nav prev-carousel",onClick:()=>d(T=>Math.max(0,T-1)),children:r.jsx("i",{className:"fas fa-chevron-left"})}),r.jsx("div",{className:"car-carousel-container",id:"carCarouselContainer",children:r.jsxs("div",{className:"car-carousel-inner",id:"carCarouselInner",ref:u,children:[o&&r.jsx("div",{className:"car-card-item loading-placeholder",style:{textAlign:"center",padding:20},children:"Loading cars..."}),!o&&n.slice(0,10).map((T,R)=>{T.id||T.Id||T.carId;const B=T.name||T.Name||T.model||T.modelName||"Unknown",U=T.imageUrl||T.ImageUrl||T.image||"/Picture/E car 1.jpg",E=parseFloat(T.rentalPricePerHour||T.RentalPricePerHour||0),A=T.seats||T.Seats;return r.jsxs("div",{className:"car-card-item",children:[r.jsx("div",{className:"car-image",children:r.jsx("img",{src:U,alt:B,onError:H=>H.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"car-info",children:[r.jsx("h3",{className:"car-name",children:B}),r.jsxs("div",{className:"car-price-simple",children:[r.jsx("span",{className:"price-amount",children:Yt(E)}),r.jsx("span",{className:"price-label",children:"/hour"})]}),r.jsx("div",{className:"car-specs",children:A?r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-users"})," ",A," Seats"]}):null})]})]},R)})]})}),r.jsx("button",{className:"carousel-nav next-carousel",onClick:()=>P(),children:r.jsx("i",{className:"fas fa-chevron-right"})})]})]})})]})}function uS(){const[e,t]=v.useState([]),[n,s]=v.useState([]),[o,a]=v.useState(!0),[l,d]=v.useState([]),[u,f]=v.useState({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),[m,g]=v.useState("default"),[y,k]=v.useState(()=>{const E=new Date,A=new Date(E.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:E.toISOString().split("T")[0],pickupTime:"07:00",returnDate:A.toISOString().split("T")[0],returnTime:"24:00"}}),[S,_]=v.useState(!1),[C,j]=v.useState(null);v.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(E=>{j({lat:E.coords.latitude,lng:E.coords.longitude})},E=>{console.error(" Could not get user location:",E.message),j({lat:10.8231,lng:106.6297})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):j({lat:10.8231,lng:106.6297}),x(),N()},[]);const x=async()=>{try{const E=await Rd.getAllStations(1,500);d(E||[])}catch(E){console.error("Failed to load stations",E)}},N=async()=>{try{a(!0);let E=null,A=null;try{const q=JSON.parse(localStorage.getItem("rentalContext")||"null");q&&(E=q.stationId,A=q,k(O=>({...O,location:q.stationId,locationName:q.stationName,pickupDate:q.pickupDate,pickupTime:q.pickupTime,returnDate:q.returnDate,returnTime:q.returnTime})))}catch{}let H=[];if(E&&A){console.log(" Loading cars for station:",E);try{const q=`${A.pickupDate}T${A.pickupTime}:00`,O=`${A.returnDate}T${A.returnTime}:00`;console.log(" Pickup DateTime (local):",q),console.log(" Return DateTime (local):",O),H=await rt.getAvailableCarsByStation(E,q,O),console.log(" Found",H.length,"cars at this station")}catch(q){console.error("Failed to load cars by station, falling back to all cars",q),H=await rt.getAllCars(1,100)}}else H=await rt.getAllCars(1,100);t(H||[]),s(H||[])}catch(E){console.error(E)}finally{a(!1)}};function b(){_(!0)}function P(){_(!1)}function T(E){k({location:E.location,locationName:E.locationName,pickupDate:E.pickupDate,pickupTime:E.pickupTime,returnDate:E.returnDate,returnTime:E.returnTime});const A={stationId:E.location,stationName:E.locationName,pickupDate:E.pickupDate,pickupTime:E.pickupTime,returnDate:E.returnDate,returnTime:E.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(A))}catch{}a(!0);const H=`${E.pickupDate}T${E.pickupTime}:00`,q=`${E.returnDate}T${E.returnTime}:00`;console.log(" Pickup DateTime (local):",H),console.log(" Return DateTime (local):",q),rt.getAvailableCarsByStation(E.location,H,q).then(O=>{t(O||[]),s(O||[]),a(!1),P()}).catch(O=>{console.error("Failed to load station cars:",O),alert("Failed to load cars for this station"),a(!1)})}v.useEffect(()=>{let E=[...e];u.brand&&(E=E.filter(A=>(A.brand||"").toLowerCase().includes(u.brand.toLowerCase()))),u.color&&(E=E.filter(A=>(A.color||"").toLowerCase().includes(u.color.toLowerCase()))),u.seats&&(E=E.filter(A=>A.seats===parseInt(u.seats))),u.year&&(E=E.filter(A=>A.year>=parseInt(u.year))),u.priceMin&&(E=E.filter(A=>parseFloat(A.rentalPricePerHour||0)>=parseFloat(u.priceMin))),u.priceMax&&(E=E.filter(A=>parseFloat(A.rentalPricePerHour||0)<=parseFloat(u.priceMax))),m==="name-asc"?E.sort((A,H)=>{const q=`${A.brand||""} ${A.model||""}`.trim().toLowerCase(),O=`${H.brand||""} ${H.model||""}`.trim().toLowerCase();return q.localeCompare(O)}):m==="name-desc"?E.sort((A,H)=>{const q=`${A.brand||""} ${A.model||""}`.trim().toLowerCase();return`${H.brand||""} ${H.model||""}`.trim().toLowerCase().localeCompare(q)}):m==="price-asc"?E.sort((A,H)=>{const q=parseFloat(A.rentalPricePerHour||A.RentalPricePerHour||0),O=parseFloat(H.rentalPricePerHour||H.RentalPricePerHour||0);return q-O}):m==="price-desc"&&E.sort((A,H)=>{const q=parseFloat(A.rentalPricePerHour||A.RentalPricePerHour||0);return parseFloat(H.rentalPricePerHour||H.RentalPricePerHour||0)-q}),s(E)},[e,u,m]);const R=()=>{f({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),s(e)},B=[...new Set(e.map(E=>E.brand).filter(Boolean))],U=[...new Set(e.map(E=>E.color).filter(Boolean))];return Array.from({length:18},(E,A)=>`${(6+A).toString().padStart(2,"0")}:00`),r.jsxs("main",{className:"car-list-main",children:[r.jsx("div",{className:"search-form-container",children:r.jsxs("div",{className:"search-summary",children:[r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),r.jsx("div",{className:"summary-value",children:y.locationName})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),r.jsx("div",{className:"summary-value",children:new Date(y.pickupDate).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),r.jsx("div",{className:"summary-value",children:y.pickupTime})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),r.jsx("div",{className:"summary-value",children:new Date(y.returnDate).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-clock"})," Return Time"]}),r.jsx("div",{className:"summary-value",children:y.returnTime})]}),r.jsxs("button",{className:"btn-search-submit",onClick:b,children:[r.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})}),r.jsxs("div",{className:"container",children:[r.jsxs("aside",{className:"filters-sidebar",children:[r.jsx("h3",{className:"filters-title",children:"Filters"}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Brand"}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:u.brand,onChange:E=>f({...u,brand:E.target.value}),children:[r.jsx("option",{value:"",children:"Any Brand"}),B.map(E=>r.jsx("option",{value:E,children:E},E))]})})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Color"}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:u.color,onChange:E=>f({...u,color:E.target.value}),children:[r.jsx("option",{value:"",children:"Any Color"}),U.map(E=>r.jsx("option",{value:E,children:E},E))]})})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Specifications"}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Seats"}),r.jsxs("select",{value:u.seats,onChange:E=>f({...u,seats:E.target.value}),children:[r.jsx("option",{value:"",children:"Any"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"4",children:"4"}),r.jsx("option",{value:"5",children:"5"}),r.jsx("option",{value:"7",children:"7"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Year (min)"}),r.jsx("input",{type:"number",min:"1900",max:"2100",placeholder:"2020",value:u.year,onChange:E=>f({...u,year:E.target.value})})]})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Price Range"}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Min Price (VND/hour)"}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:u.priceMin,onChange:E=>f({...u,priceMin:E.target.value})})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Max Price (VND/hour)"}),r.jsx("input",{type:"number",min:"0",placeholder:"999,000",value:u.priceMax,onChange:E=>f({...u,priceMax:E.target.value})})]})]}),r.jsx("div",{className:"filter-actions",children:r.jsx("button",{type:"button",className:"btn-reset-filters",onClick:R,children:"Reset Filters"})})]}),r.jsxs("div",{className:"cars-content",children:[r.jsxs("div",{className:"cars-header",children:[r.jsxs("div",{children:[r.jsx("h2",{children:"Available Cars"}),r.jsxs("div",{className:"cars-count",children:["Showing ",n.length," cars"]})]}),r.jsxs("div",{className:"sort-controls",children:[r.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),r.jsxs("select",{id:"sortBy",value:m,onChange:E=>g(E.target.value),className:"sort-select",children:[r.jsx("option",{value:"default",children:"Default"}),r.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),r.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),r.jsx("option",{value:"price-asc",children:"Price (Low to High)"}),r.jsx("option",{value:"price-desc",children:"Price (High to Low)"})]})]})]}),r.jsxs("div",{className:"car-list",children:[o&&r.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading cars..."}),!o&&n.length===0&&r.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"No cars found"}),!o&&n.map((E,A)=>{const H=E.id||E.Id,q=`${E.brand||""} ${E.model||"Car"}`.trim(),O=E.imageUrl||E.image||"/Picture/E car 1.jpg",Q=parseFloat(E.rentalPricePerHour||E.RentalPricePerHour||0),ie=E.seats||E.Seats||5,M=E.year||"",W=E.color||"N/A";return r.jsxs("div",{className:"car-card",onClick:()=>window.location.href=`/cars/${H}`,children:[r.jsx("div",{className:"car-image",children:r.jsx("img",{src:O,alt:q,onError:ue=>ue.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"car-info",children:[r.jsxs("div",{className:"car-info-top",children:[r.jsxs("div",{children:[r.jsx("div",{className:"car-name",children:q}),r.jsxs("div",{className:"car-location",children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),y.locationName||"Location"]})]}),r.jsxs("div",{className:"car-pricing",children:[r.jsx("div",{className:"car-price",children:Yt(Q)}),r.jsx("div",{className:"car-price-label",children:"/hour"})]})]}),r.jsxs("div",{className:"car-details",children:[r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-palette"})," ",W]}),r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-calendar"})," ",M||"N/A"]}),r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-users"})," ",ie," seats"]})]})]})]},A)})]})]})," "]})," ",r.jsx(ky,{isOpen:S,onClose:P,stations:l,userLocation:C,onSearch:T,currentSearchData:y})]})}const yp=(e={},t={})=>{const n=[];return(!e.fullName||e.fullName.trim()==="")&&n.push("Full Name"),(!e.email||e.email.trim()==="")&&n.push("Email"),(!e.phoneNumber||e.phoneNumber.trim()==="")&&n.push("Phone Number"),(!e.dateOfBirth||e.dateOfBirth.trim()==="")&&n.push("Date of Birth"),(!t.cccdFront||t.cccdFront.trim()==="")&&n.push("CCCD Front Image"),(!t.cccdBack||t.cccdBack.trim()==="")&&n.push("CCCD Back Image"),(!t.licenseFront||t.licenseFront.trim()==="")&&n.push("Driver License Front Image"),(!t.licenseBack||t.licenseBack.trim()==="")&&n.push("Driver License Back Image"),{isComplete:n.length===0,missingFields:n}};function hS(){const{id:e}=Wg(),t=sn(),[n,s]=v.useState(null),[o,a]=v.useState(!0),[l,d]=v.useState({}),[u,f]=v.useState({}),[m,g]=v.useState(!1),[y,k]=v.useState({isOpen:!1,type:"error",title:"",message:""});if(v.useEffect(()=>{(async()=>{try{const x=await wt.getMyProfile();d(x||{});const b=await wt.getMe()||{},P={cccdFront:b.cccdImageUrl_Front||"",cccdBack:b.cccdImageUrl_Back||"",licenseFront:b.gplxImageUrl_Front||"",licenseBack:b.gplxImageUrl_Back||""};f(P);const{isComplete:T}=yp(x,P);g(T)}catch(x){console.error(" Error loading profile:",x),g(!1)}})()},[]),v.useEffect(()=>{e&&(async()=>{try{a(!0);const x=await rt.getCarById(e);s(x)}catch(x){console.error(x)}finally{a(!1)}})()},[e]),o)return r.jsx("main",{className:"car-detail-main",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"loading-message",children:"Loading..."})})});if(!n)return r.jsx("main",{className:"car-detail-main",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"error-message",children:"Car not found"})})});const S=n.imageUrl||n.image||"/Picture/E car 1.jpg",_=`${n.brand||""} ${n.model||"Car"}`.trim(),C=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return r.jsxs("main",{className:"car-detail-main",children:[r.jsx(Fr,{isOpen:y.isOpen,onClose:()=>k(j=>({...j,isOpen:!1})),type:y.type,title:y.title,message:y.message}),r.jsxs("div",{className:"container",children:[r.jsxs("button",{className:"back-btn",onClick:()=>t("/cars"),children:[r.jsx("i",{className:"fas fa-arrow-left"})," Back to Cars"]}),r.jsxs("div",{className:"car-detail-grid",children:[r.jsxs("div",{className:"car-left-section",children:[r.jsx("div",{className:"car-image-section",children:r.jsx("div",{className:"main-image",children:r.jsx("img",{src:S,alt:_,onError:j=>j.currentTarget.src="/Picture/E car 1.jpg"})})}),r.jsxs("div",{className:"car-specs",children:[r.jsx("h3",{children:"Car Information"}),r.jsxs("div",{className:"specs-grid",children:[r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-car"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Brand"}),r.jsx("div",{className:"spec-value",children:n.brand||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-palette"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Color"}),r.jsx("div",{className:"spec-value",children:n.color||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-users"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Seats"}),r.jsx("div",{className:"spec-value",children:n.seats||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Year"}),r.jsx("div",{className:"spec-value",children:n.year||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-battery-full"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Battery Range"}),r.jsxs("div",{className:"spec-value",children:[n.batteryCapacity||"N/A"," km"]})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-cog"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Transmission"}),r.jsx("div",{className:"spec-value",children:n.transmission||"Automatic"})]})]})]})]}),n.description&&r.jsxs("div",{className:"car-description",children:[r.jsx("h3",{children:"Description"}),r.jsx("p",{children:n.description||n.Description})]})]}),r.jsx("div",{className:"car-right-section",children:r.jsxs("div",{className:"pricing-card",children:[r.jsxs("div",{className:"car-header",children:[r.jsx("h1",{className:"car-title",children:_}),n.year&&r.jsx("span",{className:"car-year",children:n.year})]}),r.jsxs("div",{className:"price-section",children:[r.jsx("div",{className:"price-label",children:"Rental Price"}),r.jsxs("div",{className:"price-value",children:[Yt(C),"/hour"]}),r.jsxs("div",{className:"price-note",children:["Estimated daily rate: ",Yt(Math.round(C*24)),"/day"]})]}),r.jsxs("div",{className:"rental-info",children:[r.jsx("h3",{children:"Rental Details"}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:"Minimum rental: 1 hour"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-shield-alt"}),r.jsx("span",{children:"Insurance included"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-gas-pump"}),r.jsx("span",{children:"Fuel policy: Same to same"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-map-marked-alt"}),r.jsx("span",{children:"Unlimited mileage"})]})]}),r.jsxs("button",{className:"book-now-btn",onClick:()=>{if(!m){const{missingFields:j}=yp(l,u);k({isOpen:!0,type:"warning",title:" Incomplete Profile",message:`Please complete your profile before booking.

Missing fields:
${j.join(", ")}

You will be redirected to update your profile.`}),setTimeout(()=>{t("/profile")},2e3);return}localStorage.setItem("selectedCarId",n.id||n.Id),t("/payment")},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",m?"Book Now":"Complete Profile First"]})]})})]})]})]})}const en={createBooking:async(e,t)=>{var n,s,o,a;try{console.log(" Creating booking for user:",t),console.log(" Booking data:",e);const l={carId:e.carId,stationId:e.pickupStationId||e.returnStationId||e.stationId,pickupDateTime:e.pickupDateTime,expectedReturnDateTime:e.expectedReturnDateTime};console.log(" Sending payload:",l);const d=await te.post(`/Bookings/Create-With-Deposit?userId=${encodeURIComponent(t)}`,l);return console.log(" Booking created:",d.data),((n=d.data)==null?void 0:n.data)||d.data||{}}catch(l){throw console.error(" Error creating booking:",((s=l.response)==null?void 0:s.data)||l.message),(a=(o=l.response)==null?void 0:o.data)!=null&&a.errors&&console.error(" Validation errors:",l.response.data.errors),l}},confirmBooking:async(e,t,n="")=>{var s,o;try{console.log(" Confirming booking:",e);const a={bookingId:e,paymentMethod:t,paymentTransactionId:n},l=await te.post("/Bookings/Confirm",a);return console.log(" Booking confirmed:",l.data),((s=l.data)==null?void 0:s.data)||l.data||{}}catch(a){throw console.error(" Error confirming booking:",((o=a.response)==null?void 0:o.data)||a.message),a}},completeBooking:async e=>{var t,n;try{console.log(" Completing booking:",e);const s=await te.post(`/Bookings/Complete-By-${encodeURIComponent(e)}`);return console.log(" Booking completed:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error completing booking:",((n=s.response)==null?void 0:n.data)||s.message),s}},getUserBookings:async e=>{var t;try{console.log(" Fetching bookings for current user");const n=await te.get("/Bookings/My-Bookings");console.log(" Raw /Bookings/My-Bookings response:",n.data);const s=n.data||{};return Array.isArray(s)?(console.log(" Returning bookings (direct array), count:",s.length),s):s.data&&Array.isArray(s.data)?(console.log(" Returning bookings from response.data, count:",s.data.length),s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning bookings from response.data.data, count:",s.data.data.length),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning bookings from response.data.items, count:",s.data.items.length),s.data.items):s.items&&Array.isArray(s.items)?(console.log(" Returning bookings from response.items, count:",s.items.length),s.items):s.bookings&&Array.isArray(s.bookings)?(console.log(" Returning bookings from response.bookings, count:",s.bookings.length),s.bookings):s&&(s.id||s.bookingId||s.bookingStatus)?(console.log(" Response looks like a single booking object, wrapping in array"),[s]):(console.warn(" No bookings array found in /Bookings/My-Bookings response; returning empty array"),[])}catch(n){if(console.error(" Error fetching user bookings:",((t=n.response)==null?void 0:t.data)||n.message),n.response&&n.response.status===401)throw n;return[]}},cancelBooking:async(e,t)=>{var n,s;try{console.log(" Cancelling booking:",e);const o=await te.post(`/Bookings/Cancel-By-${encodeURIComponent(e)}`,null,{params:{userId:t}});return console.log(" Booking cancelled:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error cancelling booking:",((s=o.response)==null?void 0:s.data)||o.message),o}},getBookingById:async e=>{var t,n;try{console.log(" Fetching booking details for ID:",e);const s=await te.get(`/Bookings/Get-By-${encodeURIComponent(e)}`);return console.log(" Booking details:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking details:",((n=s.response)==null?void 0:n.data)||s.message),s}}},fr={getContractByBooking:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Booking/${t}`,`/Contract/Get-By-Booking/${t}`,`/Contracts/By-Booking/${t}`,`/contracts/booking/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},getContractByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contract/Get-By-Renter/${t}`,`/Contracts/By-Renter/${t}`,`/contracts/renter/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createRentalContract:async(e,t=null,n=null)=>{var l;if(!e)throw new Error("bookingId is required");let s=`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(e)}`;t&&(s+=`&renterId=${encodeURIComponent(t)}`);const o=[{url:s,method:"post",data:n},{url:"/Contracts/Create",method:"post",data:{bookingId:e}},{url:"/Contract/Create",method:"post",data:{bookingId:e}}];let a;for(const d of o)try{const u=await te[d.method](d.url,d.data||{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create contract endpoint not found")},sendContractEmail:async(e,t=null)=>{var a,l,d;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e);console.log(" sendContractEmail called with contractId:",e,"email:",t);const s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,"/Contract/SendEmail"];let o;for(const u of s)try{console.log(" Trying endpoint:",u);const f=await te.post(u,t?{email:t}:{}),m=f==null?void 0:f.data;return console.log(" Success on endpoint:",u,"response:",m),m&&typeof m=="object"&&"data"in m?m.data:m}catch(f){console.warn(" Failed on endpoint:",u,"status:",(a=f==null?void 0:f.response)==null?void 0:a.status,"error:",((l=f==null?void 0:f.response)==null?void 0:l.data)||(f==null?void 0:f.message)),o=f;const m=(d=f==null?void 0:f.response)==null?void 0:d.status;if(m&&m!==404&&m!==405)throw f}throw console.error(" All endpoints failed for sendContractEmail"),o||new Error("Send contract email endpoint not found")},isContractConfirmed:async e=>{var s;if(!e)return!1;const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/xac-nhan`,`/Contracts/Get-By-Booking/${t}`,`/Contracts/${t}/Is-Confirmed`,"/Contract/IsConfirmed"];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;return d===!0||(d==null?void 0:d.isConfirmed)===!0||(d==null?void 0:d.IsConfirmed)===!0}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return!1},confirmContractSigning:async e=>{var o;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/ky`,`/Contracts/${t}/Confirm`,"/Contract/ConfirmSigning"];let s;for(const a of n)try{const l=await te.post(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Confirm contract signing endpoint not found")},deleteContract:async e=>{var o;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}`,`/Contracts/${t}`,`/Contract/Delete/${t}`];let s;for(const a of n)try{const l=await te.delete(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Delete contract endpoint not found")},downloadContract:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/${t}/Download`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract endpoint not found")},getContractDownloadByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Get contract download link endpoint not found")},getContractViewingByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/View/${t}`,`/Contract/View/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createContract:async e=>{var s;const t=[{url:"/Contracts/Create",method:"post"},{url:"/Contract/Create",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Create contract endpoint not found")},fillContract:async e=>{var s;const t=[{url:"/Contracts/Fill",method:"post"},{url:"/Contract/Fill",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Fill contract endpoint not found")},requestConfirmation:async(e,t)=>{var a;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e),s=[`/Contracts/Request-Confirmation-By-${n}`,`/Contracts/${n}/Request-Confirmation`,`/Contract/RequestConfirmation/${n}`];let o;for(const l of s)try{const d=await te.post(l,{email:t}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Request confirmation endpoint not found")},confirmContract:async e=>{var s;const t=[{url:"/Contracts/Confirm",method:"post"},{url:"/Contract/Confirm",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Confirm contract endpoint not found")},getContractsByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contracts/Renter/${t}`,`/Contract/Get-By-Renter/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createHopDong:async(e,t,n)=>{var l;if(!t||!n)throw new Error("bookingId and renterId are required");const o=[{url:`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(t)}&renterId=${encodeURIComponent(n)}`,method:"post"},{url:"/Contracts/Create",method:"post"}];let a;for(const d of o)try{const u=await te[d.method](d.url,e),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create HopDong endpoint not found")},sendConfirmationEmail:async(e,t)=>{var a;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e),s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,`/Contract/SendEmail/${n}`];let o;for(const l of s)try{const d=await te.post(l,{email:t}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Send confirmation email endpoint not found")},getContractForConfirmation:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/xac-nhan/${t}`,`/Contracts/Confirmation/${t}`,`/Contract/GetForConfirmation/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},signContract:async e=>{var s;if(!e)throw new Error("token is required");const t=[{url:"/Contracts/hopdong/ky",method:"post"},{url:"/Contracts/Sign",method:"post"},{url:"/Contract/Sign",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,{token:e}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Sign contract endpoint not found")},downloadContractByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract by token endpoint not found")},downloadContractById:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/${t}/download`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract by ID endpoint not found")},downloadLatestContractByUserId:async e=>{var n;if(!e)throw new Error("userId is required");const t=[{url:"/Contracts/user/download-latest-by-userId",params:{userId:e}},{url:"/Contracts/Download-Latest",params:{userId:e}}];for(const s of t)try{return(await te.get(s.url,{params:s.params,responseType:"blob"})).data}catch(o){const a=(n=o==null?void 0:o.response)==null?void 0:n.status;if(a&&a!==404&&a!==405)throw o}throw new Error("Download latest contract by user ID endpoint not found")},getContractByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/Token/${t}`,`/Contract/GetByToken/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null}},Ir={createPayment:async(e,t=0,n="Payment",s=0)=>{var o,a;try{console.log(" Creating payment for booking:",e,"| Type:",t,"| Extra amount:",s);const l={bookingId:e,paymentType:t,description:n};s>0&&(l.extraAmount=s);const d=await te.post("/Payment/create",l);return console.log(" Payment created:",d.data),((o=d.data)==null?void 0:o.data)||d.data||{}}catch(l){throw console.error(" Error creating payment:",((a=l.response)==null?void 0:a.data)||l.message),l}},syncPayment:async e=>{var t,n;try{console.log(" Syncing payment for booking:",e);const s=await te.post(`/Payment/sync/${encodeURIComponent(e)}`);return console.log(" Payment synced:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error syncing payment:",((n=s.response)==null?void 0:n.data)||s.message),s}}};async function fS(e,t={}){if(!e)throw new Error("stationId is required");const{from:n,to:s,token:o}=t||{},a={};n&&(a.from=n),s&&(a.to=s);const l={params:a};o&&(l.headers={Authorization:`Bearer ${o}`});const d=await te.get(`/Payment/station/${encodeURIComponent(e)}/revenue`,l);return(d==null?void 0:d.data)||d}function pS(){const e=sn(),{showToast:t}=Du(),[n,s]=v.useState(null),[o,a]=v.useState(null),[l,d]=v.useState(!1),[u,f]=v.useState(!1),[m,g]=v.useState(!1),[y,k]=v.useState(!1),[S,_]=v.useState({isOpen:!1,type:"info",title:"",message:""});v.useEffect(()=>{try{const B=JSON.parse(localStorage.getItem("rentalContext")||"null");if(!B){alert("No rental information found. Please search for a car first."),e("/");return}a(B);const U=localStorage.getItem("selectedCarId");U&&rt.getCarById(U).then(E=>s(E))}catch(B){console.error(B)}},[e]);const C=()=>{if(!o||!n)return 0;const B=new Date(`${o.pickupDate}T${o.pickupTime}`),U=new Date(`${o.returnDate}T${o.returnTime}`),E=Math.ceil((U-B)/(1e3*60*60)),A=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return E*A},j=()=>{if(!o)return 0;const B=new Date(`${o.pickupDate}T${o.pickupTime}`),U=new Date(`${o.returnDate}T${o.returnTime}`);return Math.ceil((U-B)/(1e3*60*60))},x=()=>n?parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0):0,N=()=>C()*.3,b=()=>{const B=new Date,U=String(B.getDate()).padStart(2,"0"),E=String(B.getMonth()+1).padStart(2,"0"),A=B.getFullYear(),H=localStorage.getItem("userFirstName")||"",q=localStorage.getItem("userLastName")||"",O=localStorage.getItem("userDateOfBirth")||"",Q=localStorage.getItem("userIdentityNumber")||"",ie=localStorage.getItem("userAddress")||"",M=localStorage.getItem("userDriverLicenseClass")||"",W=localStorage.getItem("userDriverLicenseNumber")||"",ue=localStorage.getItem("userDriverLicenseExpiry")||"",ne=new Date(`${o.pickupDate}T${o.pickupTime}`),ve=new Date(`${o.returnDate}T${o.returnTime}`),xe=Math.ceil((ve-ne)/(1e3*60*60*24)),ce=C(),z=O?new Date(O).getFullYear().toString():"";return{soHopDong:`H-${B.getTime()}`,ngayKy:U,thangKy:E,namKy:A.toString(),benA:{hoTen:`${H} ${q}`,namSinh:z,cccdHoacHoChieu:Q,hoKhauThuongTru:ie},xe:{nhanHieu:n.brand||"",bienSo:n.licensePlate||"",loaiXe:n.model||"",mauSon:n.color||"",choNgoi:(n.seats||0).toString(),xeDangKiHan:(n.year||"").toString()},giaThue:{giaThueSo:ce.toString(),giaThueChu:ce.toString(),phuongThucThanhToan:"Chuyn khon",ngayThanhToan:B.toISOString().split("T")[0]},thoiHanThueSo:xe.toString(),thoiHanThueChu:xe.toString(),thoiHanThue:xe,donViThoiHan:"ngay",gplx:{hang:M,so:W,hanSuDung:ue}}},P=async()=>{var B,U;if(!l){alert("Please agree to the Terms and Conditions and Privacy Policy to continue.");return}if(!n||!o){alert("Missing booking information. Please try again.");return}k(!0);try{const E=localStorage.getItem("userId");if(!E){alert("User ID not found. Please logout and login again."),e("/");return}const A=new Date(`${o.pickupDate}T${o.pickupTime}`).toISOString(),H=new Date(`${o.returnDate}T${o.returnTime}`).toISOString(),q=o.stationId;console.log(" Using station from rental context:",o.stationName,"- ID:",q);const O={carId:n.id||n.Id,userId:E,pickupStationId:q,returnStationId:q,pickupDateTime:A,expectedReturnDateTime:H,totalAmount:C()};console.log(" Creating booking with user-selected station..."),console.log(" Booking data:",O);const Q=await en.createBooking(O,E),ie=Q.id||Q.Id||Q.bookingId;if(!ie)throw new Error("Booking ID not received from server");console.log(" Booking created:",ie),console.log(" Creating contract...");const M=b(),W=await fr.createRentalContract(ie,E,M),ue=(W==null?void 0:W.id)||(W==null?void 0:W.contractId)||W;console.log(" Contract created with ID:",ue),console.log(" Full contract response:",W);try{const ne=localStorage.getItem("userEmail");if(ne&&ue){console.log(" Waiting 1s before sending email..."),await new Promise(xe=>setTimeout(xe,1e3)),console.log(" Sending contract email to:",ne),console.log(" Contract ID being used:",ue);const ve=await fr.sendContractEmail(ue,ne);console.log(" Email sent, response:",ve)}}catch(ne){console.warn(" Email failed (non-critical):",ne.message),console.error(" Full error:",ne)}try{console.log(" Creating deposit payment...");const ne=N(),ve=await Ir.createPayment(ie,0,"Cc thu xe");console.log(" Payment created:",ve)}catch(ne){console.warn(" Payment creation failed (non-critical):",ne.message)}_({isOpen:!0,type:"success",title:"Booking Created Successfully! ",message:"The contract has been sent to your email. You have 10 minutes to sign the contract and complete the deposit payment before the reservation expires. You can view details in your Booking History."}),setTimeout(()=>{localStorage.removeItem("selectedCarId"),localStorage.removeItem("rentalContext"),e("/booking-history")},3e3)}catch(E){console.error(" Error:",E);const A=((U=(B=E.response)==null?void 0:B.data)==null?void 0:U.message)||E.message||"Failed to create booking";A.toLowerCase().includes("car not available")?(t("This car is not available, please choose another one!","error",4e3),setTimeout(()=>e("/cars"),2e3)):alert(A)}finally{k(!1)}};if(!o||!n)return r.jsx("div",{className:"loading-container",children:r.jsx("p",{children:"Loading..."})});const T=C(),R=N();return r.jsxs("main",{className:"payment-page",children:[r.jsxs("div",{className:"container",children:[r.jsx("h2",{children:"Confirm Your Reservation"}),r.jsx("div",{className:"payment-layout",children:r.jsxs("div",{className:"payment-info-column",children:[r.jsxs("div",{className:"info-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h3",{className:"section-heading",children:"Rental Information"}),r.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Change]"})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Pick-up Location:"}),r.jsx("span",{className:"info-value",children:o.stationName})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Pick-up Date & Time:"}),r.jsxs("span",{className:"info-value",children:[o.pickupDate," ",o.pickupTime]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Return Date & Time:"}),r.jsxs("span",{className:"info-value",children:[o.returnDate," ",o.returnTime]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Total Rental Time:"}),r.jsxs("span",{className:"info-value",children:[j()," hour",j()!==1?"s":""]})]})]}),r.jsxs("div",{className:"info-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h3",{className:"section-heading",children:"Car Information"}),r.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Pick another car ]"})]}),r.jsxs("div",{className:"car-preview",children:[r.jsx("img",{src:n.imageUrl||n.image||"/Picture/E car 1.jpg",alt:`${n.brand} ${n.model}`,onError:B=>{B.target.src="/Picture/E car 1.jpg"}}),r.jsxs("div",{className:"car-details",children:[r.jsxs("h4",{children:[n.brand," ",n.model]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Color:"})," ",n.color]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Seats:"})," ",n.seats]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Year:"})," ",n.year]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Price:"})," ",Yt(parseFloat(n.rentalPricePerHour||0)),"/hour"]})]})]})]}),r.jsxs("div",{className:"info-section price-summary-section",children:[r.jsx("h3",{className:"section-heading",children:"Price Summary"}),r.jsxs("div",{className:"price-breakdown",children:[r.jsxs("div",{className:"price-row",children:[r.jsx("span",{className:"price-label",children:"Unit Price:"}),r.jsxs("span",{className:"price-value",children:[r.jsx("span",{className:"price-amount",children:Yt(x())}),r.jsx("span",{className:"unit",children:"/hour"})]})]}),r.jsxs("div",{className:"price-row",children:[r.jsx("span",{className:"price-label",children:"Rental Time:"}),r.jsxs("span",{className:"price-value",children:[r.jsxs("span",{className:"price-amount",children:[" ",j()]}),r.jsxs("span",{className:"unit",children:[" hour",j()!==1?"s":""]})]})]}),r.jsx("div",{className:"price-divider"}),r.jsxs("div",{className:"price-row total-row",children:[r.jsx("span",{className:"price-label",children:"Total Rental Cost:"}),r.jsx("span",{className:"price-value-total",children:r.jsx("span",{className:"price-amount",children:Yt(T)})})]}),r.jsxs("div",{className:"price-row deposit-row-summary",children:[r.jsx("span",{className:"price-label",children:"Deposit Required (30%):"}),r.jsx("span",{className:"price-value-deposit",children:r.jsx("span",{className:"price-amount",children:Yt(R)})})]})]})]})]})}),r.jsx("div",{className:"terms-section",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:B=>d(B.target.checked)}),r.jsxs("span",{children:["I agree to the ",r.jsx("button",{type:"button",className:"link-button",onClick:()=>f(!0),children:"Terms and Conditions"})," and ",r.jsx("button",{type:"button",className:"link-button",onClick:()=>g(!0),children:"Privacy Policy"})]})]})}),r.jsx("div",{className:"cta-button-container",children:r.jsx("button",{className:"btn-confirm-booking",onClick:P,disabled:!l||y,children:y?"Creating...":"Confirm and Deposit"})})]}),r.jsx("div",{className:"page-actions",children:r.jsx("div",{className:"page-actions-inner"})}),u&&r.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:r.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Terms and Conditions"}),r.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsx("h4",{children:"1. Rental Agreement"}),r.jsx("p",{children:"By renting a vehicle from our service, you agree to use the vehicle responsibly and return it in the same condition as received."}),r.jsx("h4",{children:"2. Driver Requirements"}),r.jsx("p",{children:"The driver must be at least 21 years old and possess a valid driver's license for at least 1 year."}),r.jsx("h4",{children:"3. Vehicle Usage"}),r.jsx("p",{children:"The vehicle may only be driven by the person(s) listed on the rental agreement. Unauthorized drivers are prohibited."}),r.jsx("h4",{children:"4. Fuel Policy"}),r.jsx("p",{children:"For electric vehicles, please return the car with at least 70% battery charge. Additional charging fees may apply if returned below this level."}),r.jsx("h4",{children:"5. Damage and Liability"}),r.jsx("p",{children:"The renter is responsible for any damage to the vehicle during the rental period, excluding normal wear and tear."}),r.jsx("h4",{children:"6. Cancellation Policy"}),r.jsx("p",{children:"Cancellations made more than 24 hours before pick-up time will receive a full refund. Cancellations within 24 hours will forfeit the deposit."}),r.jsx("h4",{children:"7. Late Returns"}),r.jsx("p",{children:"Late returns will be charged at 1.5x the hourly rate for each additional hour."}),r.jsx("h4",{children:"8. Insurance"}),r.jsx("p",{children:"Basic insurance is included in the rental price. Additional coverage options are available at checkout."})]})]})}),m&&r.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:r.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Privacy Policy"}),r.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsx("h4",{children:"1. Information Collection"}),r.jsx("p",{children:"We collect personal information including name, email, phone number, driver's license details, and payment information necessary to process your rental booking."}),r.jsx("h4",{children:"2. Use of Information"}),r.jsx("p",{children:"Your information is used solely for processing rentals, communication regarding your booking, and improving our services."}),r.jsx("h4",{children:"3. Data Security"}),r.jsx("p",{children:"We implement industry-standard security measures to protect your personal information from unauthorized access, disclosure, or misuse."}),r.jsx("h4",{children:"4. Third-Party Sharing"}),r.jsx("p",{children:"We do not sell or share your personal information with third parties except as required for payment processing or legal compliance."}),r.jsx("h4",{children:"5. Cookies"}),r.jsx("p",{children:"Our website uses cookies to enhance user experience and analyze site traffic. You can disable cookies in your browser settings."}),r.jsx("h4",{children:"6. Data Retention"}),r.jsx("p",{children:"We retain your booking information for 7 years as required by law. You may request deletion of your data at any time."}),r.jsx("h4",{children:"7. Your Rights"}),r.jsx("p",{children:"You have the right to access, correct, or delete your personal information. Contact our support team to exercise these rights."}),r.jsx("h4",{children:"8. Contact"}),r.jsx("p",{children:"For privacy concerns or questions, please contact us at privacy@carental.com"})]})]})}),r.jsx(Fr,{isOpen:S.isOpen,type:S.type,title:S.title,message:S.message,onClose:()=>_({...S,isOpen:!1})})]})}function mS(){const e=sn(),[t,n]=v.useState(!0),[s,o]=v.useState(null);return v.useEffect(()=>{console.log(" Payment successful! Checking user role and payment type...");const a=async()=>{try{const d=localStorage.getItem("userRole");console.log(" User role:",d);let u=localStorage.getItem("currentBookingId"),f="user-deposit";if(u||(u=localStorage.getItem("activeCheckInBookingId"),u&&(f="staff-checkin",console.log(" Found check-in booking ID (staff payment):",u))),u||(u=localStorage.getItem("activeCheckOutBookingId"),u&&(f="staff-checkout",console.log(" Found check-out booking ID (staff payment):",u))),!u){console.warn(" No booking ID found in localStorage"),o("Booking ID not found"),n(!1),l(d);return}console.log(" Auto-syncing payment for booking:",u),await Ir.syncPayment(u),console.log(" Payment status synced successfully"),console.log(" Fetching booking details to check status...");const m=await en.getBookingById(u),g=Number((m==null?void 0:m.bookingStatus)||(m==null?void 0:m.BookingStatus));console.log(" Booking status after payment:",g,"(0=Pending, 1=Active, 2=Waiting Check-in, 3=Checked-in, 4=Check-out Pending, 5=Completed)"),n(!1),setTimeout(()=>{try{localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),localStorage.removeItem("activeCheckInBookingId"),localStorage.removeItem("activeCheckOutBookingId")}catch(y){console.warn("Failed to clear storage:",y)}l(d)},1500)}catch(d){console.error(" Error in payment sync flow:",d),o("Failed to process payment or create contract"),n(!1);const u=localStorage.getItem("userRole");setTimeout(()=>l(u),3e3)}},l=d=>{if(console.log(" Redirecting based on user role:",d,"type:",typeof d),!d){console.warn(" No role found, redirecting to booking history as default"),e("/booking-history");return}const u=String(d).toLowerCase().trim();if(console.log(" Normalized role:",u),u.includes("admin")){console.log(" Redirecting to Admin page"),e("/admin");return}if(u.includes("staff")||u.includes("manager")||u==="stationstaff"||u==="stationmanager"){console.log(" Redirecting to Staff page"),e("/staff");return}if(u.includes("renter")||u.includes("evrenter")||u==="evrenter"){console.log(" Redirecting to Booking History page"),e("/booking-history");return}console.log(" Unknown role, redirecting to booking history as default"),e("/booking-history")};a()},[e]),r.jsx("main",{className:"payment-success-main",children:r.jsx("div",{className:"payment-success-container",children:t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon processing",children:""}),r.jsx("h1",{children:"Processing Payment..."}),r.jsx("p",{children:"Please wait while we confirm your payment."})]}):s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon error",children:""}),r.jsx("h1",{children:"Payment Sync Issue"}),r.jsx("p",{children:s}),r.jsx("p",{className:"small",children:"Redirecting to booking history..."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon success",children:""}),r.jsx("h1",{children:"Payment Successful!"}),r.jsx("p",{children:"Your payment has been processed."}),r.jsx("p",{className:"small",children:"Redirecting to booking history..."})]})})})}function gS(){const e=sn(),{showToast:t}=Du(),[n]=Gg(),[s,o]=v.useState(!0);return v.useEffect(()=>{(async()=>{console.log(" PaymentCancel component mounted!"),console.log(" Current URL:",window.location.href);try{const l=n.get("orderCode"),d=n.get("status"),u=n.get("cancel");if(console.log(" Payment cancelled:",{orderCode:l,status:d,cancel:u}),u==="true"&&d==="CANCELLED"){const f=localStorage.getItem("currentBookingId");f?(console.log(" Payment cancelled for booking:",f),console.log(" Payment session cleared - booking status unchanged"),localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),t("Payment cancelled. You can retry payment from your booking history.","info",3e3)):(console.warn(" No booking ID found in localStorage"),t("Payment cancelled.","info",3e3)),setTimeout(()=>{e("/booking-history")},2e3)}else t("Invalid payment cancellation.","error",3e3),setTimeout(()=>{e("/booking-history")},1500)}catch(l){console.error(" Error handling payment cancellation:",l),t("An error occurred. Redirecting to home...","error",3e3),setTimeout(()=>{e("/")},2e3)}finally{o(!1)}})()},[n,e,t]),r.jsx("main",{className:"payment-cancel-container",children:r.jsx("div",{className:"payment-cancel-card",children:s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-cancel-icon processing",children:""}),r.jsx("h1",{children:"Processing Cancellation..."}),r.jsx("p",{children:"Clearing payment session. You can retry payment later."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-cancel-icon cancelled",children:""}),r.jsx("h1",{children:"Payment Cancelled"}),r.jsx("p",{children:"Your payment has been cancelled. Your booking is still active and you can retry payment anytime."}),r.jsx("p",{className:"small",style:{fontSize:"13px",color:"#999",marginTop:"20px"},children:"Redirecting to booking history..."})]})})})}const yS=()=>{const e=sn(),t=mi(),[n,s]=v.useState(10),[o,a]=v.useState(!1),[l,d]=v.useState(!1),{bookingId:u,depositAmount:f,totalAmount:m,carInfo:g,rentalInfo:y}=t.state||{};v.useEffect(()=>{if(!u){e("/payment");return}const S=setInterval(()=>{s(_=>_<=1?(clearInterval(S),k(),0):_-1)},1e3);return()=>clearInterval(S)},[u]);const k=async()=>{a(!0);try{await new Promise(S=>setTimeout(S,1e3)),console.log(" Payment simulation completed for booking:",u),console.log("  Booking is in Pending status. Admin will confirm after payment verification."),d(!0),setTimeout(()=>{e("/booking-history")},2e3)}catch(S){console.error("Error in payment flow:",S),alert("An error occurred. Redirecting to booking history..."),e("/booking-history")}finally{a(!1)}};return u?r.jsx("main",{className:"transaction-page",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"transaction-content",children:l?r.jsxs("div",{className:"success-section",children:[r.jsx("div",{className:"success-icon",children:r.jsx("i",{className:"fas fa-check-circle"})}),r.jsx("h2",{children:"Booking Created Successfully!"}),r.jsx("p",{children:"Your booking is pending payment confirmation."}),r.jsxs("p",{style:{fontSize:"0.95rem",color:"#666",margin:"1rem 0"},children:["Booking ID: ",r.jsx("strong",{children:u})]}),r.jsx("p",{className:"redirect-text",children:"Redirecting to booking history..."})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"transaction-header",children:[r.jsx("div",{className:"icon-circle",children:r.jsx("i",{className:"fas fa-credit-card"})}),r.jsx("h2",{children:"Complete Your Payment"}),r.jsxs("p",{className:"booking-id",children:["Booking ID: ",r.jsx("span",{children:u})]})]}),r.jsxs("div",{className:"payment-layout",children:[r.jsxs("div",{className:"qr-section",children:[r.jsx("h3",{children:"Scan QR Code to Pay"}),r.jsxs("div",{className:"qr-placeholder",children:[r.jsx("i",{className:"fas fa-qrcode"}),r.jsx("p",{children:"QR Code Here"})]}),r.jsxs("div",{className:"payment-instructions",children:[r.jsx("h4",{children:"Payment Instructions:"}),r.jsxs("ol",{children:[r.jsx("li",{children:"Open your banking app"}),r.jsx("li",{children:"Scan the QR code above"}),r.jsx("li",{children:"Confirm the payment amount"}),r.jsx("li",{children:"Complete the transaction"})]})]})]}),r.jsxs("div",{className:"payment-details",children:[r.jsx("h3",{children:"Payment Details"}),r.jsxs("div",{className:"detail-card",children:[r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Deposit Amount:"}),r.jsx("span",{className:"value highlight",children:Yt(f)})]}),r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Total Rental Cost:"}),r.jsx("span",{className:"value",children:Yt(m)})]}),r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Remaining Balance:"}),r.jsx("span",{className:"value",children:Yt((m||0)-(f||0))})]})]}),g&&r.jsxs("div",{className:"detail-card",children:[r.jsxs("h4",{children:[r.jsx("i",{className:"fas fa-car"})," Vehicle"]}),r.jsx("p",{children:r.jsxs("strong",{children:[g.brand," ",g.model]})}),r.jsxs("p",{children:[g.color,"  ",g.seats," seats  ",g.year]})]}),y&&r.jsxs("div",{className:"detail-card",children:[r.jsxs("h4",{children:[r.jsx("i",{className:"fas fa-calendar-alt"})," Rental Period"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Pick-up:"})," ",y.pickupDate," ",y.pickupTime]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Return:"})," ",y.returnDate," ",y.returnTime]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Location:"})," ",y.stationName]})]}),r.jsxs("div",{className:"countdown-section",children:[r.jsxs("div",{className:"countdown-circle",children:[r.jsx("span",{className:"countdown-number",children:n}),r.jsx("span",{className:"countdown-label",children:"seconds"})]}),r.jsx("p",{className:"countdown-text",children:o?"Processing payment...":"Simulating payment completion in..."})]}),r.jsxs("div",{className:"info-box",children:[r.jsx("i",{className:"fas fa-info-circle"}),r.jsxs("p",{children:["This is a demo. Your booking will be created in ",r.jsx("strong",{children:"Pending"})," status. Admin will confirm after receiving payment. Payment simulation completes after ",n," second",n!==1?"s":"","."]})]})]})]})]})})})}):null},Fd={getAllFeedbacks:async(e=1,t=10)=>{var n,s;try{console.log(" Fetching all feedbacks - page:",e,"size:",t);const o=await te.get("/Feedback/Get-All",{params:{pageNumber:e,pageSize:t}});return console.log(" Feedbacks fetched:",o.data),((n=o.data)==null?void 0:n.data)||o.data||[]}catch(o){throw console.error(" Error fetching feedbacks:",((s=o.response)==null?void 0:s.data)||o.message),o}},getFeedbackById:async e=>{var t,n;try{console.log(" Fetching feedback:",e);const s=await te.get(`/Feedback/Get-By-${encodeURIComponent(e)}`);return console.log(" Feedback fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching feedback:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByCarId:async e=>{var t,n;try{console.log(" Fetching feedbacks for car:",e);const s=await te.get(`/Feedback/Get-By-Car/${encodeURIComponent(e)}`);return console.log(" Car feedbacks fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||[]}catch(s){throw console.error(" Error fetching car feedbacks:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByUserId:async e=>{var t,n;try{console.log(" Fetching feedbacks for user:",e);const s=await te.get(`/Feedback/Get-By-User/${encodeURIComponent(e)}`);return console.log(" User feedbacks fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||[]}catch(s){throw console.error(" Error fetching user feedbacks:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByBookingId:async e=>{var t,n;try{console.log(" Fetching feedback for booking:",e);const s=await te.get(`/Feedback/Get-By-Booking/${encodeURIComponent(e)}`);return console.log(" Booking feedback fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking feedback:",((n=s.response)==null?void 0:n.data)||s.message),s}},createFeedback:async(e,t)=>{var n,s,o,a,l;try{console.log(" Creating feedback for user:",e),console.log(" Feedback data:",t);const d={...t,userId:e};console.log(" Sending payload:",d);const u=await te.post(`/Feedback/Create-By-User/${encodeURIComponent(e)}`,d);return console.log(" Feedback created:",u.data),((n=u.data)==null?void 0:n.data)||u.data||{}}catch(d){throw console.error(" Error creating feedback:",((s=d.response)==null?void 0:s.data)||d.message),console.error(" Full error response:",d.response),console.error(" Error status:",(o=d.response)==null?void 0:o.status),console.error(" Error details:",(l=(a=d.response)==null?void 0:a.data)==null?void 0:l.errors),d}},updateFeedback:async(e,t,n)=>{var s,o;try{console.log(" Updating feedback:",e),console.log(" Updated data:",t);const a=await te.put(`/Feedback/Update-By-${encodeURIComponent(e)}`,t,{params:n?{userId:n}:{}});return console.log(" Feedback updated:",a.data),((s=a.data)==null?void 0:s.data)||a.data||{}}catch(a){throw console.error(" Error updating feedback:",((o=a.response)==null?void 0:o.data)||a.message),a}},deleteFeedback:async(e,t)=>{var n,s;try{console.log(" Deleting feedback:",e);const o=await te.delete(`/Feedback/Delete-By-${encodeURIComponent(e)}`,{params:t?{userId:t}:{}});return console.log(" Feedback deleted:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error deleting feedback:",((s=o.response)==null?void 0:s.data)||o.message),o}},getFeedbackSummaryByCar:async e=>{var t,n;try{console.log(" Fetching feedback summary for car:",e);const s=await te.get(`/Feedback/Get-Summary-By-Car/${encodeURIComponent(e)}`);return console.log(" Feedback summary fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching feedback summary:",((n=s.response)==null?void 0:n.data)||s.message),s}},getAverageRatingByCar:async e=>{var t,n;try{console.log(" Fetching average rating for car:",e);const s=await te.get(`/Feedback/Get-Average-Rating-By-Car/${encodeURIComponent(e)}`);return console.log(" Average rating fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||0}catch(s){throw console.error(" Error fetching average rating:",((n=s.response)==null?void 0:n.data)||s.message),s}}};function vS({isOpen:e,selectedBooking:t,feedbackData:n,setFeedbackData:s,isEditingFeedback:o,currentFeedbackId:a,onClose:l,onSubmitSuccess:d}){const[u,f]=v.useState(!1),[m,g]=v.useState(!1);v.useEffect(()=>{console.log(" FeedbackModal useEffect triggered:",{isOpen:e,feedbackId:t==null?void 0:t.feedbackId,hasComment:!!(n!=null&&n.comment),feedbackData:n}),e&&(t!=null&&t.feedbackId)&&(n!=null&&n.comment)?(console.log(" Entering VIEW mode - showing existing feedback"),f(!0)):e&&(console.log(" Entering EDIT mode - creating/editing feedback"),f(!1))},[e,t==null?void 0:t.feedbackId]);const y=()=>{f(!1)},k=async()=>{var S,_,C;try{const j=localStorage.getItem("userId");if(!j){alert("User ID not found. Please login again.");return}if(!n.carId){alert("Car ID not found for this booking.");return}if(!n.comment.trim()){alert("Please enter your feedback comment.");return}g(!0),console.log(" Submitting feedback:",n),o&&a?(await Fd.updateFeedback(a,n,j),alert("Feedback updated successfully!")):(await Fd.createFeedback(j,n),alert("Feedback submitted successfully!")),s({bookingId:"",carId:"",rating:5,comment:""}),f(!1),l(),d()}catch(j){console.error(" Error submitting feedback:",j);const x=((C=(_=(S=j.response)==null?void 0:S.data)==null?void 0:_.errors)==null?void 0:C[0])||"Failed to submit feedback. Please try again.";alert(x)}finally{g(!1)}};return e?r.jsx("div",{className:"modal-overlay",onClick:l,children:r.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:u?"Your Feedback":"We want your opinion!"}),r.jsx("button",{className:"modal-close",onClick:l,children:""})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"feedback-form",children:[r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:["Car: ",(t==null?void 0:t.carInfo)||"N/A"]})}),u?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Your Rating"}),r.jsxs("div",{className:"rating-display",children:[r.jsx("div",{className:"stars-display",children:[1,2,3,4,5].map(S=>r.jsx("i",{className:`fas fa-star ${n.rating>=S?"active":"inactive"}`,style:{color:n.rating>=S?"#ffc107":"#ddd"}},S))}),r.jsxs("span",{className:"rating-text",children:[n.rating," / 5"]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Your Comment"}),r.jsx("div",{className:"comment-display",children:r.jsx("p",{children:n.comment})})]}),r.jsxs("div",{className:"feedback-meta",children:[r.jsxs("small",{children:["Created: ",(t==null?void 0:t.feedbackCreatedDate)||"N/A"]}),(t==null?void 0:t.feedbackUpdatedDate)&&t.feedbackUpdatedDate!==t.feedbackCreatedDate&&r.jsxs("small",{children:["Updated: ",t.feedbackUpdatedDate]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Close"}),r.jsxs("button",{className:"btn btn-continue",onClick:y,children:[r.jsx("i",{className:"fas fa-edit"})," Edit Feedback"]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"rating",children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[[1,2,3,4,5].map(S=>r.jsx("button",{type:"button",className:`star-btn ${n.rating>=S?"active":""}`,onClick:()=>s({...n,rating:S}),children:r.jsx("i",{className:`fas fa-star ${n.rating>=S?"":"far"}`})},S)),r.jsxs("span",{className:"rating-text",children:[n.rating," / 5"]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"comment",children:"Comment"}),r.jsx("textarea",{id:"comment",rows:"5",value:n.comment,onChange:S=>s({...n,comment:S.target.value}),placeholder:"Share your experience with this car..."})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancel"}),r.jsx("button",{className:"btn btn-continue",onClick:k,disabled:m,children:m?"Processing...":o?"Update":"Continue"})]})]})]})})]})}):null}function xS(){const e=sn(),[t,n]=v.useState([]),[s,o]=v.useState([]),[a,l]=v.useState(!0),[d,u]=v.useState(""),[f,m]=v.useState({}),[g,y]=v.useState(""),[k,S]=v.useState("newest"),[_,C]=v.useState(null),[j,x]=v.useState(!1),[N,b]=v.useState(!1),[P,T]=v.useState({bookingId:"",carId:"",rating:5,comment:""}),[R,B]=v.useState(!1),[U,E]=v.useState(null),[A,H]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[q,O]=v.useState(!1),Q=()=>{b(!1),T({bookingId:"",carId:"",rating:5,comment:""}),B(!1),E(null)},ie=v.useCallback(async()=>{try{l(!0),u("");const z=localStorage.getItem("token");if(!z||z==="null"){console.warn("No auth token found in localStorage"),n([]),u("You are not signed in. Please sign in to view your bookings.");return}const re=await en.getUserBookings();console.log(" Bookings loaded - count:",re==null?void 0:re.length),console.log(" First booking sample:",re==null?void 0:re[0]),console.log(" All bookings:",re);const G={};for(const we of re||[]){const Le=we.carId||we.CarId;if(Le)try{const Ce=await rt.getCarById(Le),je=(Ce==null?void 0:Ce.imageUrl)||(Ce==null?void 0:Ce.ImageUrl)||"/Picture/E car 1.jpg";G[Le]=je,console.log(" Loaded image for car",Le,":",je)}catch(Ce){console.warn(" Failed to load car image for",Le,":",Ce.message),G[Le]="/Picture/E car 1.jpg"}}m(G),n(re||[])}catch(z){if(console.error("Error loading bookings:",z),z&&z.response&&z.response.status===401){u("Session expired or unauthorized. Please sign in again."),n([]);return}u("Failed to load bookings. Please try again later.")}finally{l(!1)}},[]),M=v.useCallback(()=>{ie()},[ie]),W=v.useCallback(()=>{let z=[...t];g&&(z=z.filter(re=>String(re.bookingStatus)===g)),z.sort((re,G)=>{switch(k){case"oldest":return new Date(re.createdAt)-new Date(G.createdAt);case"price-high":return(G.totalAmount||0)-(re.totalAmount||0);case"price-low":return(re.totalAmount||0)-(G.totalAmount||0);default:return new Date(G.createdAt)-new Date(re.createdAt)}}),o(z)},[t,g,k]);v.useEffect(()=>{ie()},[ie]),v.useEffect(()=>{t.length>0&&W()},[t,g,k]);const ue=z=>{const re={0:{text:"Pending",class:"status-pending"},1:{text:"Active",class:"status-active"},2:{text:"Waiting for check-in",class:"status-waiting-check-in"},3:{text:"Checked-in",class:"status-checked-in"},4:{text:"Check-out pending",class:"status-check-out-pending"},5:{text:"Completed",class:"status-completed"},6:{text:"Cancelled pending refund",class:"status-cancelled-pending-refund"},7:{text:"Cancelled",class:"status-cancelled"}},G=Number(z);return Number.isNaN(G)||!(G in re)?(console.warn(" Unknown booking status:",z,"type:",typeof z),re[0]):re[G]},ne=z=>{if(!z)return"N/A";try{const re=new Date(z);return isNaN(re.getTime())?z:re.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return z}},ve=async(z,re)=>{re&&(re.preventDefault(),re.stopPropagation());const G=z.id||z.bookingId||z.bookingIdString;if(!G){alert("Cannot cancel: Booking ID not found");return}if(Number(z.bookingStatus)===7){alert("This booking has already been cancelled.");return}if(window.confirm(`Are you sure you want to cancel booking for "${z.carInfo||"this car"}"?`))try{const Le=localStorage.getItem("userId");if(!Le){alert("User ID not found. Please login again.");return}console.log(" Cancelling booking:",G,"for user:",Le),await en.cancelBooking(G,Le),alert("Booking cancelled successfully!"),ie()}catch(Le){console.error(" Error cancelling booking:",Le),alert("Failed to cancel booking. Please try again.")}},xe=async(z,re)=>{var we,Le,Ce,je,ze;re&&(re.preventDefault(),re.stopPropagation());const G=z.id||z.bookingId||z.bookingIdString;if(!G){alert("Booking ID not found");return}O(!0);try{console.log(" Creating deposit payment for booking:",G);const me=await Ir.createPayment(G),et=me.checkoutUrl||((we=me.data)==null?void 0:we.checkoutUrl);if(!et)throw new Error("No checkout URL received");localStorage.setItem("currentBookingId",G),console.log(" Redirecting to PayOS:",et),window.location.href=et}catch(me){console.error(" Error initiating payment:",me);let et=((Ce=(Le=me.response)==null?void 0:Le.data)==null?void 0:Ce.message)||me.message||"Failed to initiate payment";(((ze=(je=me.response)==null?void 0:je.data)==null?void 0:ze.errors)||[]).some(he=>typeof he=="string"&&he.toLowerCase().includes("contract"))?(et="Contract not found or not confirmed for this booking",H({isOpen:!0,type:"error",title:" Contract Required",message:"Please wait for the contract to be confirmed. Check your email for the contract document and ensure it has been processed."})):H({isOpen:!0,type:"error",title:"Payment Error",message:et})}finally{O(!1)}},ce=(z,re)=>{var Le,Ce;if(re&&(re.preventDefault(),re.stopPropagation()),N){console.log(" Modal already open, ignoring click");return}console.log(" Opening feedback modal for booking:",z);const G=z.id||z.bookingId||z.bookingIdString||"",we=z.carId||((Le=z.car)==null?void 0:Le.id)||((Ce=z.car)==null?void 0:Ce.carId)||"";if(!G){alert("Cannot create feedback: Booking ID not found.");return}if(!we){alert("Cannot create feedback: Car ID not found in booking data. Please contact support.");return}console.log(" Attempting to fetch existing feedback for booking:",G),Fd.getFeedbackByBookingId(G).then(je=>{if(console.log(" Raw feedback response:",je),console.log(" Feedback rating:",je==null?void 0:je.rating),console.log(" Feedback comment:",je==null?void 0:je.comment),!je||!je.comment||je.comment.trim()===""){console.log(" No existing feedback found - entering CREATE mode"),B(!1),E(null),T({bookingId:G,carId:we,rating:5,comment:""}),C(z),b(!0);return}console.log(" Valid feedback found - entering VIEW/EDIT mode"),B(!0),E(je.feedbackId||je.id),T({bookingId:G,carId:we,rating:je.rating||5,comment:je.comment||""});const ze={...z,feedbackId:je.feedbackId||je.id,feedbackCreatedDate:je.createdAt,feedbackUpdatedDate:je.updatedAt};console.log(" Setting booking with feedback:",ze),C(ze),b(!0)}).catch(je=>{var ze;console.error(" Error fetching feedback:",((ze=je.response)==null?void 0:ze.data)||je.message),B(!1),E(null),T({bookingId:G,carId:we,rating:5,comment:""}),C(z),b(!0)})};return r.jsxs("main",{className:"main-content",children:[r.jsxs("div",{className:"container",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("i",{className:"fas fa-history"}),r.jsxs("div",{className:"page-header-text",children:[r.jsx("h1",{children:"Booking History"}),r.jsx("p",{style:{color:"white"},children:"Manage all your car rentals"})]})]}),r.jsxs("div",{className:"filters-section",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Status:"}),r.jsxs("select",{value:g,onChange:z=>y(z.target.value),children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"0",children:"Pending"}),r.jsx("option",{value:"1",children:"Active"}),r.jsx("option",{value:"2",children:"Waiting for check-in"}),r.jsx("option",{value:"3",children:"Checked-in"}),r.jsx("option",{value:"4",children:"Checked-out pending"}),r.jsx("option",{value:"5",children:"Completed"}),r.jsx("option",{value:"6",children:"Cancelled pending refund"}),r.jsx("option",{value:"7",children:"Cancelled"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Sort By:"}),r.jsxs("select",{value:k,onChange:z=>S(z.target.value),children:[r.jsx("option",{value:"newest",children:"Newest"}),r.jsx("option",{value:"oldest",children:"Oldest"}),r.jsx("option",{value:"price-high",children:"Price (High to Low)"}),r.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),r.jsxs("button",{className:"btn-refresh",onClick:ie,children:[r.jsx("i",{className:"fas fa-sync"})," Refresh"]})]}),a&&r.jsxs("div",{className:"loading",children:[r.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading..."]}),!a&&s.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("i",{className:"fas fa-inbox"}),r.jsx("h2",{children:"No Bookings Yet"}),r.jsx("p",{children:"Start booking a car to find your perfect ride"}),r.jsxs("button",{className:"btn btn-primary",onClick:()=>e("/cars"),children:[r.jsx("i",{className:"fas fa-car"})," View Cars"]})]}),!a&&s.length>0&&r.jsx("div",{className:"bookings-list",children:s.map((z,re)=>{var et,mn,he,se,ae,ye;const G=ue(z.bookingStatus),we=ne(z.startTime||z.StartTime||z.pickupDateTime||z.PickupDateTime),Le=ne(z.endTime||z.EndTime||z.expectedReturnDateTime||z.ExpectedReturnDateTime),Ce=z.carInfo||z.CarInfo||((et=z.car)!=null&&et.brand&&((mn=z.car)!=null&&mn.model)?`${z.car.brand} ${z.car.model}`:null)||((he=z.Car)!=null&&he.Brand&&((se=z.Car)!=null&&se.Model)?`${z.Car.Brand} ${z.Car.Model}`:null)||"Car Rental",je=z.pickupStationName||z.PickupStationName||z.stationName||z.StationName||((ae=z.station)==null?void 0:ae.name)||((ye=z.Station)==null?void 0:ye.Name)||"N/A",ze=z.carId||z.CarId,me=f[ze]||"/Picture/E car 1.jpg";return z.id||z.bookingId||z.bookingIdString,re===0&&(console.log(" First booking car image sources:"),console.log("   - carId:",ze),console.log("   - carImagesCache[carId]:",f[ze]),console.log("   - Final carImage:",me),console.log("   - Full booking object:",z)),r.jsxs("div",{className:`booking-card-shopee ${G.class}`,children:[r.jsx("div",{className:"booking-card-header",children:r.jsx("span",{className:`status-badge ${G.class}`,children:G.text})}),r.jsxs("div",{className:"booking-card-body",children:[r.jsx("div",{className:"car-image-container",children:r.jsx("img",{src:me,alt:Ce,onError:le=>le.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"booking-details",children:[r.jsx("h3",{className:"car-name",children:Ce}),r.jsxs("div",{className:"booking-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),"Pick-up Location"]}),r.jsx("div",{className:"info-value",children:je})]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-calendar-alt"}),"Start Date & Time"]}),r.jsx("div",{className:"info-value",children:we})]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-calendar-check"}),"End Date & Time"]}),r.jsx("div",{className:"info-value",children:Le})]})]})]})]}),r.jsxs("div",{className:"booking-card-footer",children:[r.jsxs("div",{className:"total-price",children:[r.jsx("span",{className:"price-label",children:"Total Amount:"}),r.jsx("span",{className:"price-value",children:Yt(z.totalAmount||z.TotalAmount||0)})]}),r.jsxs("div",{className:"booking-actions",children:[Number(z.bookingStatus)===0&&r.jsxs("button",{className:"btn btn-deposit",onClick:le=>xe(z,le),disabled:q,type:"button",children:[r.jsx("i",{className:"fas fa-wallet"})," ",q?"Processing...":"Pay Deposit"]}),Number(z.bookingStatus)===5&&r.jsxs("button",{className:"btn btn-feedback",onClick:le=>ce(z,le),type:"button",children:[r.jsx("i",{className:"fas fa-comment"})," ",z.feedbackId?"Edit Feedback":"Feedback"]}),r.jsxs("button",{className:"btn btn-cancel",onClick:le=>ve(z,le),disabled:Number(z.bookingStatus)===7,title:Number(z.bookingStatus)===7?"Already cancelled":"Cancel booking",type:"button",children:[r.jsx("i",{className:"fas fa-times-circle"})," Cancel Booking"]})]})]})]},re)})})]}),j&&_&&r.jsx("div",{className:"modal-overlay",onClick:()=>x(!1),children:r.jsxs("div",{className:"modal-content",onClick:z=>z.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:"Booking Details"}),r.jsx("button",{className:"modal-close",onClick:()=>x(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"detail-section car-section",children:[r.jsx("div",{className:"section-icon",children:""}),r.jsxs("div",{className:"section-content",children:[r.jsx("h3",{children:_.carInfo||"Car Rental"}),r.jsx("div",{className:"status-row",children:r.jsx("span",{className:`status-badge ${ue(_.bookingStatus).class}`,children:ue(_.bookingStatus).text})})]})]}),r.jsxs("div",{className:"detail-section datetime-section",children:[r.jsxs("div",{className:"datetime-card pickup",children:[r.jsx("div",{className:"datetime-icon",children:""}),r.jsxs("div",{className:"datetime-info",children:[r.jsx("label",{children:"Pick-up"}),r.jsx("p",{className:"location",children:_.pickupStationName||"N/A"}),r.jsx("p",{className:"time",children:ne(_.startTime||_.pickupDateTime)})]})]}),r.jsx("div",{className:"datetime-arrow",children:""}),r.jsxs("div",{className:"datetime-card return",children:[r.jsx("div",{className:"datetime-icon",children:""}),r.jsxs("div",{className:"datetime-info",children:[r.jsx("label",{children:"Return"}),r.jsx("p",{className:"location",children:_.returnStationName||"N/A"}),r.jsx("p",{className:"time",children:ne(_.endTime||_.expectedReturnDateTime)})]})]})]}),r.jsx("div",{className:"detail-section pricing-section",children:r.jsxs("div",{className:"pricing-grid",children:[r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Hourly Rate"}),r.jsxs("p",{children:[Yt(_.hourlyRate||0),"/hour"]})]})]}),r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Daily Rate"}),r.jsxs("p",{children:[Yt(_.dailyRate||0),"/day"]})]})]}),r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Created At"}),r.jsx("p",{children:ne(_.createdAt)})]})]})]})}),r.jsx("div",{className:"detail-section total-section",children:r.jsxs("div",{className:"total-content",children:[r.jsx("span",{className:"total-label",children:"Total Amount"}),r.jsx("span",{className:"total-amount",children:Yt(_.totalAmount||0)})]})})]})]})}),r.jsx(vS,{isOpen:N,selectedBooking:_,feedbackData:P,setFeedbackData:T,isEditingFeedback:R,currentFeedbackId:U,onClose:Q,onSubmitSuccess:M}),r.jsx(Fr,{isOpen:A.isOpen,type:A.type,title:A.title,message:A.message,onClose:()=>H({...A,isOpen:!1})})]})}function _S({toggleSidebar:e,sidebarVisible:t}){return r.jsxs("header",{className:"header-bar",children:[r.jsx("div",{className:"header-left",children:r.jsx("button",{className:"sidebar-toggle","aria-label":t?"Close sidebar":"Open sidebar",onClick:e,children:r.jsx("i",{className:t?"fas fa-times":"fas fa-bars"})})}),r.jsx("div",{className:"header-title",children:"Staff Page"}),r.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function by({title:e="Menu",menuItems:t=[],isOpen:n=!1,toggleSidebar:s,onSelect:o,activeKey:a}){const l=sn();v.useEffect(()=>{n?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[n]);function d(u){try{typeof u.onClick=="function"?u.onClick():u.to&&l(u.to)}catch(f){console.warn("Sidebar navigation error",f)}typeof o=="function"&&o(u.key)}return r.jsxs(r.Fragment,{children:[n&&r.jsx("div",{className:"sidebar-collider",onClick:s}),r.jsxs("div",{className:`sidebar ${n?"active":""}`,children:[r.jsx("h2",{children:e}),r.jsx("div",{style:{marginTop:"60px"}}),Array.isArray(t)&&t.map(u=>r.jsxs("button",{className:a===u.key?"sidebar-item active":"sidebar-item",onClick:()=>d(u),children:[u.icon&&r.jsx("i",{className:u.icon,"aria-hidden":!0}),r.jsx("span",{style:{marginLeft:u.icon?8:0},children:u.label})]},u.key))]})]})}const Iy=()=>'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2"><path d="M3 9l1-3h16l1 3M3 9v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9M3 9h18M7 13a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/></svg>',qu=e=>{e&&(e.style.objectFit="contain",e.style.backgroundColor="#f0f0f0",e.src=Iy())},Gu=e=>!e||typeof e=="string"&&e.trim()===""?Iy():e;function Ud({booking:e,onClick:t}){const[n,s]=v.useState(null);v.useEffect(()=>{(async()=>{try{const m=e.carId||e.CarId;if(console.log(" BookingCard - Attempting to load image for booking:",e.id,"carId:",m),!m){console.warn(" BookingCard - No carId found in booking:",e);return}const g=await rt.getCarById(m),y=(g==null?void 0:g.imageUrl)||(g==null?void 0:g.ImageUrl)||"/Picture/E car 1.jpg";s(y),console.log(" BookingCard - Loaded car image:",y)}catch(m){console.warn(" BookingCard - Failed to load car image:",m.message)}})()},[e.carId,e.CarId,e.id]);const a=(f=>{if(!f)return"UNKNOWN";if(typeof f=="string")return f.toLowerCase();if(typeof f=="number")switch(f){case 0:return"pending";case 1:return"booked";case 2:return"waiting-checkin";case 3:return"checked-in";case 4:return"checkout-pending";case 5:return"completed";default:return"unknown"}return"unknown"})(e.status);let l="booking-status-chip ";a==="booked"?l+="booking-status-booked":a==="pending"?l+="booking-status-pending":a==="waiting-checkin"?l+="booking-status-waiting-checkin":a==="checked-in"||a==="checkedin"?l+="booking-status-checkedin":a==="checkout-pending"?l+="booking-status-checkout-pending":a==="completed"?l+="booking-status-completed":a==="cancelled-pending"?l+="booking-status-cancelled-pending":a==="cancelled"?l+="booking-status-cancelled":a==="denied"?l+="booking-status-denied":l+="booking-status-unknown";const d=f=>{qu(f.currentTarget)},u=n||e.img||Gu(e.img);return r.jsxs("div",{className:"booking-card",onClick:t,children:[r.jsx("img",{src:u,alt:e.title,onError:d}),r.jsxs("div",{className:"booking-info",children:[r.jsx("div",{className:"booking-title",children:e.title}),r.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),(()=>{const f=e.statusLabel||a.toUpperCase();return r.jsx("div",{className:l,children:f})})()]})}function Ly({bookings:e=[],renderBookingCard:t,search:n="",setSearch:s=()=>{},statusFilter:o="",setStatusFilter:a=()=>{},emptyState:l=null}){return r.jsxs("div",{className:"booking-model",children:[r.jsxs("div",{className:"booking-filter",style:{display:"flex",gap:8,marginBottom:12,alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Search bookings...",value:n,onChange:d=>s(d.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd",flex:"1 1 320px"}}),r.jsxs("select",{value:o,onChange:d=>a(d.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"",children:"All statuses"}),r.jsx("option",{value:"booked",children:"Booked"}),r.jsx("option",{value:"waiting_payment",children:"Waiting Payment"}),r.jsx("option",{value:"checked-in",children:"Checked In"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),r.jsx("div",{className:"booking-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(260px,1fr))",gap:16},children:e&&e.length>0?e.map(d=>t(d)):l||r.jsx("div",{style:{padding:24,color:"#666"},children:"No bookings found"})})]})}function wS({booking:e,onClick:t}){const n="booking-status-chip booking-status-pending",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"",o=a=>{qu(a.currentTarget)};return r.jsxs("div",{className:"booking-card waiting-payment",onClick:t,children:[r.jsx("img",{src:Gu(e.img),alt:e.title,onError:o}),r.jsxs("div",{className:"booking-info",children:[r.jsx("div",{className:"booking-title",children:e.title}),r.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),r.jsxs("div",{className:"loading-row",title:"Waiting for payment confirmation",children:[r.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),r.jsx("div",{className:"booking-subtext",children:"Waiting for Payment"})]})]}),r.jsx("div",{className:n,children:"Pending"})]})}function jS({booking:e,onClick:t}){const n="booking-status-chip booking-status-checkedin",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return r.jsxs("div",{className:"booking-card checkin-payment",onClick:t,children:[r.jsx("img",{src:e.img,alt:e.title}),r.jsxs("div",{className:"booking-info",children:[r.jsx("div",{className:"booking-title",children:e.title}),r.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),r.jsx("div",{className:"booking-subtext",children:"Payment In Waiting"})]}),r.jsx("div",{className:n,children:"Payment In Waiting"})]})}const Ln={createIncident:async(e,t,n=[])=>{var l;if(!e||!t)throw new Error("bookingId and description are required");const s=new FormData;if(s.append("bookingId",e),s.append("description",t),n&&n.length)for(const d of n)s.append("images",d);const o=["/Incidents/Create","/incidents/Create","/Incidents/CreateIncident"];let a=null;for(const d of o)try{const u=await te.post(d,s,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const m=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(m);throw g.body=f,g}return f.data}return f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create incident endpoint not found")},getIncidentsByBooking:async(e,t=1,n=20)=>{var a;if(!e)return[];const s=encodeURIComponent(e),o=[{url:`/Incidents/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/Incident/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/incidents/get-by-booking/${s}`,opts:{params:{page:t,pageSize:n}}}];for(const l of o)try{const d=await te.get(l.url,l.opts),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;if(!f)continue;return Array.isArray(f)?f:Array.isArray(f==null?void 0:f.items)?f.items:Array.isArray(f==null?void 0:f.data)?f.data:Array.isArray(f==null?void 0:f.incidents)?f.incidents:Array.isArray(f)?f:[]}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)return[]}return[]},getMyIncidents:async()=>{var t;const e=["/Incidents/My-Incidents","/Incidents/My","/Incidents/Get-My"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data,a=o&&typeof o=="object"&&"data"in o?o.data:o;if(!a)continue;return Array.isArray(a)?a:Array.isArray(a==null?void 0:a.items)?a.items:Array.isArray(a==null?void 0:a.data)?a.data:Array.isArray(a)?a:[]}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)return[]}return[]},getAllIncidents:async(e=null,t=null,n=null,s=null,o=1,a=100)=>{try{const l={};e&&(l.stationId=e),t&&(l.status=t),n&&(l.dateFrom=n),s&&(l.dateTo=s),l.page=o,l.pageSize=a;const d=await te.get("/Incidents/Get-All",{params:l}),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;if(!f)return{incidents:[],totalCount:0,page:o,pageSize:a};if(Array.isArray(f))return{incidents:f,totalCount:f.length,page:o,pageSize:a};const m=f.incidents||f.items||f.data||[],g=f.totalCount||f.total||(Array.isArray(m)?m.length:0);return{incidents:Array.isArray(m)?m:[],totalCount:g||0,page:f.page||o,pageSize:f.pageSize||a}}catch{return{incidents:[],totalCount:0,page:o,pageSize:a}}},getIncidentById:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Incidents/Get-By-${t}`,`/Incidents/Get-By-Id/${t}`,`/Incidents/${t}`,`/incident/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(!d)continue;return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},updateIncident:async(e,t)=>{var a;if(!e)throw new Error("incidentId is required");const n=encodeURIComponent(e),s=[`/Incidents/Update-By-${n}`,`/Incidents/Update-By-Id/${n}`,`/Incidents/Update/${n}`,`/Incidents/${n}`];let o=null;for(const l of s)try{const d=await te.put(l,t,{headers:{"Content-Type":"multipart/form-data"}}),u=d==null?void 0:d.data;return(u&&typeof u=="object"&&"data"in u?u.data:u)||u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Update incident endpoint not found")},resolveIncident:async(e,t="",n=0)=>{var l;if(!e)throw new Error("incidentId is required");const s=encodeURIComponent(e),o=[`/Incidents/Resolve-By-${s}`,`/Incidents/Resolve-By-Id/${s}`,`/Incidents/Resolve/${s}`];let a=null;for(const d of o)try{const u=await te.patch(d,{resolutionNotes:t,costIncurred:n}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Resolve incident endpoint not found")},deleteIncident:async e=>{var o;if(!e)throw new Error("incidentId is required");const t=encodeURIComponent(e),n=[`/Incidents/Delete-By-${t}`,`/Incidents/Delete-By-Id/${t}`,`/Incidents/Delete/${t}`,`/Incidents/${t}`];let s=null;for(const a of n)try{const l=await te.delete(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Delete incident endpoint not found")}},Oe={confirmBooking:en.confirmBooking,cancelBooking:en.cancelBooking,completeBooking:en.completeBooking,getBookingById:en.getBookingById,createIncident:Ln.createIncident,getIncidentsByBooking:Ln.getIncidentsByBooking,getMyIncidents:Ln.getMyIncidents,getAllIncidents:Ln.getAllIncidents,getIncidentById:Ln.getIncidentById,updateIncident:Ln.updateIncident,resolveIncident:Ln.resolveIncident,deleteIncident:Ln.deleteIncident,post:(e,t={})=>te.post(e,t).then(n=>n.data),get:(e,t={})=>te.get(e,t).then(n=>n.data),put:(e,t={})=>te.put(e,t).then(n=>n.data),patch:(e,t={})=>te.patch(e,t).then(n=>n.data),delete:e=>te.delete(e).then(t=>t.data),createCar:rt.createCar,deleteCar:rt.deleteCar,updateCar:rt.updateCar,updateStatus:rt.updateStatus,updateBatteryLevel:rt.updateBatteryLevel,updateCarDescription:rt.updateCarDescription,getCarsByStation:async e=>{var t;try{const n=await te.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`),s=n==null?void 0:n.data;return Array.isArray(s)?s:s!=null&&s.data&&Array.isArray(s.data)?s.data:(t=s==null?void 0:s.data)!=null&&t.data&&Array.isArray(s.data.data)?s.data.data:s!=null&&s.items&&Array.isArray(s.items)?s.items:(console.warn(" No cars found in response for station:",e),[])}catch(n){return console.warn(" getCarsByStation error (endpoint may not exist):",n.message),[]}},checkInWithContract:async e=>{var t,n;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");try{const s=new FormData;s.append("BookingId",e.bookingId),s.append("StaffId",e.staffId),e.checkInNotes&&s.append("CheckInNotes",e.checkInNotes),e.checkInPhotoFile&&e.checkInPhotoFile instanceof File?s.append("CheckInPhoto",e.checkInPhotoFile,e.checkInPhotoFile.name):s.append("CheckInPhoto","");const o=(()=>{try{return localStorage.getItem("token")}catch{return null}})(),a={};o&&o!=="null"&&(a.Authorization=`Bearer ${o}`);const l=await mt.post(`${Hi}/Bookings/Check-In-With-Contract`,s,{headers:a}),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(s){throw console.error(" checkInWithContract failed:",(t=s==null?void 0:s.response)==null?void 0:t.status,((n=s==null?void 0:s.response)==null?void 0:n.data)||(s==null?void 0:s.message)),s}},checkOutWithPayment:async e=>{var s,o;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-Out-With-Payment","/Bookings/CheckOutWithPayment","/bookings/check-out-with-payment"];let n;for(const a of t){if(e.checkOutPhotoFile&&e.checkOutPhotoFile instanceof File)try{const l=new FormData;l.append("bookingId",e.bookingId),l.append("staffId",e.staffId),e.actualReturnDateTime&&l.append("actualReturnDateTime",e.actualReturnDateTime),e.damageFee!==void 0&&e.damageFee!==null&&l.append("damageFee",String(e.damageFee)),e.checkOutNotes&&l.append("checkOutNotes",e.checkOutNotes),e.checkOutPhotoUrl&&!e.checkOutPhotoUrl.startsWith("blob:")&&l.append("checkOutPhotoUrl",e.checkOutPhotoUrl),l.append("checkOutPhotoFile",e.checkOutPhotoFile);const d=await te.post(a,l,{headers:{"Content-Type":"multipart/form-data"}}),u=d==null?void 0:d.data;if(u&&typeof u=="object"&&"data"in u){if(u.isSuccess===!1){const f=u.message||(Array.isArray(u.errors)?u.errors.join("; "):"Request failed"),m=new Error(f);throw m.body=u,m}return u.data}return u}catch(l){n=l;const d=(s=l==null?void 0:l.response)==null?void 0:s.status;if(d&&d!==404&&d!==405)throw l}try{const{checkOutPhotoFile:l,...d}=e,u=await te.post(a,d,{headers:{"Content-Type":"application/json"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const m=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(m);throw g.body=f,g}return f.data}return f}catch(l){n=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}}throw n||new Error("Check-Out-With-Payment endpoint not found")},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Oe.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},getAllStations:async(e=1,t=100)=>{var n;try{const s=await te.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}}),o=s==null?void 0:s.data;return Array.isArray(o)?o:o!=null&&o.data&&Array.isArray(o.data)?o.data:(n=o==null?void 0:o.data)!=null&&n.data&&Array.isArray(o.data.data)?o.data.data:o!=null&&o.items&&Array.isArray(o.items)?o.items:(console.warn(" No stations found in response"),[])}catch(s){return console.warn(" getAllStations error:",s.message),[]}},getBookingsByStation:async(e,t=1,n=100)=>{var o;if(!e)throw new Error("stationId is required");const s=encodeURIComponent(e);try{const a=await te.get(`/Bookings/By-Station/${s}`,{params:{pageNumber:t,pageSize:n}}),l=a==null?void 0:a.data;return Array.isArray(l)?l:l!=null&&l.data&&Array.isArray(l.data)?l.data:(o=l==null?void 0:l.data)!=null&&o.data&&Array.isArray(l.data.data)?l.data.data:l!=null&&l.items&&Array.isArray(l.items)?l.items:(console.warn(" No bookings found in response for station:",e),[])}catch(a){return console.warn(" getBookingsByStation error:",a.message),[]}},getAvailableCarsByStation:async e=>{var n;if(!e)return[];const t=encodeURIComponent(e);try{const s=await te.get(`/Cars/Get-Available-By-Station/${t}`),o=s==null?void 0:s.data;return Array.isArray(o)?o:o!=null&&o.data&&Array.isArray(o.data)?o.data:(n=o==null?void 0:o.data)!=null&&n.data&&Array.isArray(o.data.data)?o.data.data:o!=null&&o.items&&Array.isArray(o.items)?o.items:(console.warn(" No available cars found for station:",e),[])}catch(s){return console.warn(" getAvailableCarsByStation error:",s.message),[]}}};function Py({booking:e={},onClose:t=()=>{},actions:n=null,children:s}){return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,borderBottom:"1px solid #eee"},children:[r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:(e==null?void 0:e.title)||(e==null?void 0:e.carName)||"Booking"}),r.jsx("div",{style:{color:"#666"},children:(e==null?void 0:e.statusLabel)||(e==null?void 0:e.status)})]}),r.jsxs("div",{children:[n,r.jsx("button",{onClick:t,style:{marginLeft:8,padding:"6px 10px",borderRadius:6},children:"Close"})]})]}),r.jsx("div",{style:{padding:16},children:s}),r.jsx("div",{style:{padding:12,borderTop:"1px solid #eee",textAlign:"right"},children:n})]})}function SS(e){if(e==null)return null;if(typeof e=="number")switch(e){case 1:return"booked";case 2:return"waiting_payment";case 3:return"checked-in";case 4:return"completed";case 0:return"cancelled";default:return String(e)}const t=String(e).toLowerCase();return t==="1"?"booked":t==="2"?"waiting_payment":t==="3"?"checked-in":t==="4"?"completed":t==="0"||t.includes("cancel")?"cancelled":t.includes("book")?"booked":t.includes("wait")?"waiting_payment":t.includes("check")?"checked-in":t.includes("complete")?"completed":t}function Ey(e){if(!e&&e!==0)return"";const t=new Date(e);return isNaN(t)?String(e):t.toLocaleString()}function CS({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:o}){var ce,z;const[a,l]=v.useState(!1),[d,u]=v.useState(!1),[f,m]=v.useState(!1),[g,y]=v.useState(!1),[k,S]=v.useState(""),[_,C]=v.useState(!1),[j,x]=v.useState(!1),[N,b]=v.useState(null),[P,T]=v.useState(!1),[R,B]=v.useState(null),[U,E]=v.useState(""),[A,H]=v.useState(""),[q,O]=v.useState(null),[Q,ie]=v.useState(""),[M,W]=v.useState(null),[ue,ne]=v.useState(!1);if(v.useEffect(()=>{if(!e)return;l(!1),u(!1),m(!1),y(!1),S(""),W(null),O(null);const re=e.carId||e.CarId;re&&rt.getCarById(re).then(me=>{const et=(me==null?void 0:me.imageUrl)||(me==null?void 0:me.ImageUrl)||"/Picture/E car 1.jpg";O(et),console.log(" Loaded car image:",et)}).catch(me=>{console.warn(" Failed to load car image:",me.message),O("/Picture/E car 1.jpg")});const G=(me,et)=>[me,et].filter(Boolean).join(" "),we=e.fullName||G(e.firstName,e.lastName);if(!we||/^customer$/i.test(we)||we===""||S(we),!e.id)return;let Ce=!1;async function je(){C(!0);try{const{firstName:me,lastName:et}=await Oe.getUserNameByBookingId(e.id);Ce||S(G(me,et))}catch{}finally{Ce||C(!1)}}async function ze(){if(!e.userId){console.warn(" No userId in booking");return}ne(!0);try{console.log(" Fetching user details for userId:",e.userId);const me=await wt.getUserById(e.userId);Ce||(W(me),console.log(" Fetched user details:",me),console.log(" CCCD Images:",{cccdFrontUrl:me==null?void 0:me.cccdFrontUrl,identityFrontUrl:me==null?void 0:me.identityFrontUrl,idFrontUrl:me==null?void 0:me.idFrontUrl,cccdImageUrl_Front:me==null?void 0:me.cccdImageUrl_Front,cccdBackUrl:me==null?void 0:me.cccdBackUrl,identityBackUrl:me==null?void 0:me.identityBackUrl,idBackUrl:me==null?void 0:me.idBackUrl,cccdImageUrl_Back:me==null?void 0:me.cccdImageUrl_Back}),console.log(" GPLX Images:",{gplxFrontUrl:me==null?void 0:me.gplxFrontUrl,driverLicenseFrontUrl:me==null?void 0:me.driverLicenseFrontUrl,gplxImageUrl_Front:me==null?void 0:me.gplxImageUrl_Front,gplxBackUrl:me==null?void 0:me.gplxBackUrl,driverLicenseBackUrl:me==null?void 0:me.driverLicenseBackUrl,gplxImageUrl_Back:me==null?void 0:me.gplxImageUrl_Back}))}catch(me){console.warn(" Failed to fetch user details:",(me==null?void 0:me.message)||me),console.error("Full error:",me),Ce||W(null)}finally{Ce||ne(!1)}}return je(),ze(),()=>{Ce=!0}},[e]),!e)return null;const ve=(e==null?void 0:e.status)==="booked"?a&&d&&f&&g:!1,xe=()=>{if(!e)return;const re=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,re)};return r.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:r.jsx("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:r.jsxs(Py,{booking:e,onClose:t,actions:null,children:[r.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("img",{id:"modalImage",src:q||"/Picture/E car 1.jpg",alt:"Vehicle",onError:re=>re.currentTarget.src="/Picture/E car 1.jpg",style:{width:"100%",height:160,borderRadius:8,objectFit:"cover",display:"block"}}),r.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),r.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),r.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((ce=e.car)==null?void 0:ce.name)||((z=e.car)==null?void 0:z.Name)||""]}),r.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(_?"Loading":"")]}),r.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",Ey(e.date)]})]}),r.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Pickup Date:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"pickupDate",style:{fontWeight:600},children:e.pickupDate||e.startDate||e.date||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Return Date:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"returnDate",style:{fontWeight:600},children:e.returnDate||e.endDate||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:ue?"Loading...":(M==null?void 0:M.identityNumber)||(M==null?void 0:M.idNumber)||(M==null?void 0:M.cmnd)||e.idString||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Address:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:ue?"Loading...":(M==null?void 0:M.address)||e.address||""})})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["CCCD Images: ",ue&&"(Loading...)"]}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),M!=null&&M.cccdFrontUrl||M!=null&&M.identityFrontUrl||M!=null&&M.idFrontUrl||M!=null&&M.cccdImageUrl_Front||e.cccdFrontUrl?r.jsx("a",{href:(M==null?void 0:M.cccdFrontUrl)||(M==null?void 0:M.identityFrontUrl)||(M==null?void 0:M.idFrontUrl)||(M==null?void 0:M.cccdImageUrl_Front)||e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(M==null?void 0:M.cccdFrontUrl)||(M==null?void 0:M.identityFrontUrl)||(M==null?void 0:M.idFrontUrl)||(M==null?void 0:M.cccdImageUrl_Front)||e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:a,onChange:re=>l(re.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),M!=null&&M.cccdBackUrl||M!=null&&M.identityBackUrl||M!=null&&M.idBackUrl||M!=null&&M.cccdImageUrl_Back||e.cccdBackUrl?r.jsx("a",{href:(M==null?void 0:M.cccdBackUrl)||(M==null?void 0:M.identityBackUrl)||(M==null?void 0:M.idBackUrl)||(M==null?void 0:M.cccdImageUrl_Back)||e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(M==null?void 0:M.cccdBackUrl)||(M==null?void 0:M.identityBackUrl)||(M==null?void 0:M.idBackUrl)||(M==null?void 0:M.cccdImageUrl_Back)||e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:d,onChange:re=>u(re.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["Driver License (GPLX) Images: ",ue&&"(Loading...)"]}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),M!=null&&M.gplxFrontUrl||M!=null&&M.driverLicenseFrontUrl||M!=null&&M.gplxImageUrl_Front||e.gplxFrontUrl?r.jsx("a",{href:(M==null?void 0:M.gplxFrontUrl)||(M==null?void 0:M.driverLicenseFrontUrl)||(M==null?void 0:M.gplxImageUrl_Front)||e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(M==null?void 0:M.gplxFrontUrl)||(M==null?void 0:M.driverLicenseFrontUrl)||(M==null?void 0:M.gplxImageUrl_Front)||e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:re=>m(re.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),M!=null&&M.gplxBackUrl||M!=null&&M.driverLicenseBackUrl||M!=null&&M.gplxImageUrl_Back||e.gplxBackUrl?r.jsx("a",{href:(M==null?void 0:M.gplxBackUrl)||(M==null?void 0:M.driverLicenseBackUrl)||(M==null?void 0:M.gplxImageUrl_Back)||e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(M==null?void 0:M.gplxBackUrl)||(M==null?void 0:M.driverLicenseBackUrl)||(M==null?void 0:M.gplxImageUrl_Back)||e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:g,onChange:re=>y(re.target.checked)})," Verified"]})]})]})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{id:"customerPhone",style:{padding:6},children:ue?"Loading...":(M==null?void 0:M.phoneNumber)||(M==null?void 0:M.phone)||e.phone||""}),((M==null?void 0:M.phoneNumber)||(M==null?void 0:M.phone)||e.phone)&&r.jsx("a",{href:`tel:${(M==null?void 0:M.phoneNumber)||(M==null?void 0:M.phone)||e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!ve,style:{background:ve?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),r.jsx("button",{onClick:xe,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&r.jsx("button",{onClick:()=>n==null?void 0:n(e,"checkout"),style:{background:"#d32f2f",color:"#fff",width:"100%",padding:"12px",borderRadius:6,border:"none",cursor:"pointer",fontWeight:600,fontSize:14},children:"Check Out"})]}),U&&r.jsx("div",{style:{marginTop:8,color:"#b00020"},children:U})]})]}),r.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[r.jsx("h4",{children:"Transaction Details"}),r.jsxs("ul",{style:{fontSize:"1rem"},children:[r.jsx("li",{children:"Find rental location on map"}),r.jsx("li",{children:"View available vehicles (type, battery, price)"}),r.jsx("li",{children:"Book in advance or on-site"}),r.jsx("li",{children:"Check-in at counter/app"}),r.jsx("li",{children:"Sign electronic contract"}),r.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),r.jsx("li",{children:"Return vehicle at rental location"}),r.jsx("li",{children:"Staff checks and confirms vehicle condition"}),r.jsx("li",{children:"Pay any additional fees"})]})]})]})})})}function vp(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function NS({booking:e,onClose:t,onCheckedIn:n}){const[s,o]=v.useState(""),[a,l]=v.useState(null),[d,u]=v.useState(!1),[f,m]=v.useState(""),[g,y]=v.useState(null),[k,S]=v.useState(null),[_,C]=v.useState(""),[j,x]=v.useState(""),[N,b]=v.useState(""),[P,T]=v.useState(!1),[R,B]=v.useState(!1),[U,E]=v.useState(!1);hr.useEffect(()=>{let q=!0;return(async()=>{try{const O=await Oe.getServerTime();q&&y(O);try{const Q=O?O.getTime()-Date.now():0;console.log(" Server time:",O,"Client time:",new Date,"(ms):",Q)}catch{}}catch{}})(),()=>{q=!1}},[]);async function A(q){var O,Q;if(q.preventDefault(),!!(e!=null&&e.id)){u(!0),m("");try{const ie=localStorage.getItem("token");if(!ie||ie==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let M="";try{M=localStorage.getItem("userId")||""}catch{}if(!M)try{const xe=localStorage.getItem("token");if(xe){const ce=Pr(xe);M=ce["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||ce.sub||ce.userId||ce.UserId||ce.id||ce.Id||""}}catch{}if(!M)throw new Error("Unable to determine userId. Please sign in again.");const W={bookingId:e.id,staffId:M,renterId:e.userId},ue=(s||"").trim();ue&&(W.checkInNotes=ue),a&&(W.checkInPhotoFile=a),console.log(" Check-in payload:",W),console.log(" Staff check-in info:",{bookingId:e.id,staffId:M,renterId:e.userId});const ne=await Oe.checkInWithContract(W);console.log(" Check-in response:",ne),localStorage.setItem("activeCheckInBookingId",e.id),console.log(" Saved activeCheckInBookingId to localStorage:",e.id),S(ne);const ve=(ne==null?void 0:ne.totalAmount)||(ne==null?void 0:ne.TotalAmount)||0;if(console.log(" Total amount for payment:",ve),ve>0){T(!0);try{const xe=await Ir.createPayment(e.id,1,"Rental payment at check-in");console.log(" Payment created:",xe);const ce=xe||{},z=ce.checkoutUrl||ce.url||ce.payUrl||"";z?(console.log(" Opening Payos checkout in new tab:",z),C(z),window.open(z,"_blank")):(console.warn(" No checkout URL in payment response:",ce),C(""),m("Payment session created but no checkout URL received. Please try again."))}catch(xe){console.error(" Payment creation failed:",xe==null?void 0:xe.message),m(`Check-in succeeded but payment setup failed: ${xe==null?void 0:xe.message}. Please try again.`)}finally{T(!1)}}typeof n=="function"&&n(e.id,W)}catch(ie){const M=(ie==null?void 0:ie.body)||((O=ie==null?void 0:ie.response)==null?void 0:O.data),W=M&&(M.errors||M.Errors)||null,ue=(Array.isArray(W)&&W.length?W.join("; "):null)||(M==null?void 0:M.message)||(ie==null?void 0:ie.message)||"Failed to save check-in";m(ue);try{console.error(" Check-in failed:",{error:ie==null?void 0:ie.message,status:(ie==null?void 0:ie.status)||((Q=ie==null?void 0:ie.response)==null?void 0:Q.status),body:M})}catch{}}finally{u(!1)}}}async function H(){if(e!=null&&e.id){B(!0),m("");try{console.log(" Syncing payment for booking:",e.id),await Ir.syncPayment(e.id),console.log(" Payment synced successfully");const q=await en.getBookingById(e.id);console.log(" Updated booking status:",q.bookingStatus),E(!0),m(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(q){console.error(" Payment sync failed:",q),m(`Payment sync failed: ${q.message}`),E(!1)}finally{B(!1)}}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),k?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check-in Successful"}),r.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(k==null?void 0:k.message)||"Check-in successful!"]}),f&&r.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:f}),P&&r.jsx("div",{style:{background:"#e3f2fd",color:"#1565c0",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Creating payment session and redirecting to Payos..."}),_&&!P&&r.jsx("div",{style:{background:"#f3e5f5",color:"#7b1fa2",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment session created. Payos opened in new tab."}),U&&r.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[r.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),r.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Total Amount:"}),r.jsx("strong",{children:vp((k==null?void 0:k.totalAmount)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:14},children:[r.jsx("span",{children:"Deposit (30%):"}),r.jsx("strong",{children:vp((k==null?void 0:k.depositAmount)||0)})]})]})]}),r.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:r.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment Processing"}),P?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:"Preparing payment link..."}),r.jsx("div",{style:{fontSize:12,color:"#999"},children:"You will be redirected to Payos to complete payment."})]}):_?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:" Payment link opened in new tab"}),r.jsx("div",{style:{fontSize:12,color:"#999",marginBottom:16},children:"After customer completes payment, click the button below to sync"}),r.jsx("button",{onClick:H,disabled:R||U,style:{background:U?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:R||U?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:R?" Syncing...":U?" Synced!":" Sync Payment Status"})]}):r.jsx("div",{style:{fontSize:13,color:"#d32f2f",padding:"12px",background:"#ffebee",borderRadius:6},children:" Payment setup incomplete"})]})})]}),r.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",r.jsx("strong",{children:"Note:"})," You will be redirected to Payos to complete payment. After payment completes, you will be redirected to the payment success page."]}),!P&&!_&&r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check In"}),g&&r.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",g.toLocaleString()]}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),r.jsxs("form",{onSubmit:A,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-in Notes"}),r.jsx("textarea",{rows:5,value:s,onChange:q=>o(q.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-in Photo (Optional)"}),r.jsx("input",{type:"file",accept:"image/*",onChange:q=>l(q.target.files[0]||null),placeholder:"Select an image file"}),a&&r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Selected: ",a.name," (",(a.size/1024/1024).toFixed(2)," MB)"]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:d,style:{background:d?"#9e9e9e":"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px",cursor:d?"not-allowed":"pointer"},children:d?"Processing":"Confirm Check In"})]})]})]})]})})}function oa(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function kS({booking:e,onClose:t,onCheckedOut:n}){const[s,o]=v.useState(""),[a,l]=v.useState(0),[d,u]=v.useState(""),[f,m]=v.useState("15:00"),[g,y]=v.useState(null),[k,S]=v.useState(new Date().getMonth()),[_,C]=v.useState(new Date().getFullYear()),[j,x]=v.useState(!1),[N,b]=v.useState(""),[P,T]=v.useState(null),[R,B]=v.useState(null),[U,E]=v.useState(""),[A,H]=v.useState(!1),[q,O]=v.useState(!1),[Q,ie]=v.useState(!1),M=Array.from({length:18},(ce,z)=>`${(6+z).toString().padStart(2,"0")}:00`);hr.useEffect(()=>{let ce=!0;return(async()=>{try{const z=await Oe.getServerTime();if(ce&&(T(z),z)){const G=z.toISOString().split("T")[0];u(G)}try{const re=z?z.getTime()-Date.now():0;console.log(" Server time:",z,"Client time:",new Date,"(ms):",re)}catch{}}catch{}})(),()=>{ce=!1}},[]);function W(){const ce=new Date(_,k,1),z=new Date(_,k+1,0),re=[];for(let we=0;we<ce.getDay();we++)re.push(r.jsx("div",{},`empty-${we}`));const G=new Date;G.setHours(0,0,0,0);for(let we=1;we<=z.getDate();we++){const Le=`${_}-${(k+1).toString().padStart(2,"0")}-${we.toString().padStart(2,"0")}`,je=new Date(Le)<G,ze=Le===d,me=["calendar-day"];je&&me.push("past"),ze&&me.push("selected"),re.push(r.jsx("div",{className:me.join(" "),onClick:et=>{et.stopPropagation(),je||(u(Le),y(null))},style:{cursor:je?"not-allowed":"pointer",opacity:je?.4:1,pointerEvents:je?"none":"auto"},children:we},Le))}return re}function ue(ce){let z=k+ce,re=_;z>11&&(z=0,re++),z<0&&(z=11,re--),S(z),C(re)}async function ne(ce){var z,re;if(ce.preventDefault(),!!(e!=null&&e.id)){x(!0),b("");try{const G=localStorage.getItem("token");if(!G||G==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let we="";try{we=localStorage.getItem("userId")||""}catch{}if(!we)try{const se=localStorage.getItem("token");if(se){const ae=decodeJwt(se);we=ae["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||ae.sub||ae.userId||ae.UserId||ae.id||ae.Id||""}}catch{}if(!we)throw new Error("Unable to determine userId. Please sign in again.");const Le={bookingId:e.id,staffId:we,actualReturnDateTime:d&&f?new Date(`${d}T${f}`).toISOString():new Date().toISOString(),checkOutPhotoUrl:"",damageFee:Number(a)||0},Ce=(s||"").trim();Ce&&(Le.checkOutNotes=Ce);const je=await Oe.checkOutWithPayment(Le);console.log(" Check-out response:",je),localStorage.setItem("activeCheckOutBookingId",e.id),console.log(" Saved activeCheckOutBookingId to localStorage:",e.id),B(je);const ze=await Oe.getBookingById(e.id);console.log(" Updated booking:",ze),ze&&B(se=>({...se,...ze}));const me=Number(a)||0,et=Number((ze==null?void 0:ze.extraAmount)||0),mn=me+et;if(console.log(" Payment amounts - Damage:",me,"Backend Extra:",et,"Total:",mn),mn>0){H(!0);try{const se=await Ir.createPayment(e.id,2,"Rental payment at check-out",mn);console.log(" Payment created:",se);const ae=se||{},ye=ae.checkoutUrl||ae.url||ae.payUrl||"";ye?(console.log(" Opening Payos checkout in new tab:",ye),E(ye),window.open(ye,"_blank")):(console.warn(" No checkout URL in payment response:",ae),E(""),b("Payment session created but no checkout URL received. Please try again."))}catch(se){console.error(" Payment creation failed:",se==null?void 0:se.message),b(`Check-out succeeded but payment setup failed: ${se==null?void 0:se.message}. Please try again.`)}finally{H(!1)}}else{console.log(" No extra amount - creating checkout-only payment (type 3)");try{H(!0);const se=await Ir.createPayment(e.id,3,"Checkout without payment");console.log(" Checkout-only payment created:",se),E(""),setTimeout(()=>{typeof n=="function"&&n(e.id,[])},500)}catch(se){console.error(" Checkout-only payment creation failed:",se==null?void 0:se.message),b(`Check-out succeeded but payment record creation failed: ${se==null?void 0:se.message}. Please contact support.`)}finally{H(!1)}}let he=[];try{he=await Oe.getIncidentsByBooking(e.id,1,20),console.log(" Fetched incidents immediately after checkout:",he)}catch(se){console.warn(" Failed to fetch incidents after checkout:",(se==null?void 0:se.message)||se)}typeof n=="function"&&n(e.id,he)}catch(G){const we=(G==null?void 0:G.body)||((z=G==null?void 0:G.response)==null?void 0:z.data),Le=we&&(we.errors||we.Errors)||null,Ce=(Array.isArray(Le)&&Le.length?Le.join("; "):null)||(we==null?void 0:we.message)||(G==null?void 0:G.message)||"Failed to save check-out";b(Ce);try{console.error(" Check-out failed:",{error:G==null?void 0:G.message,status:(G==null?void 0:G.status)||((re=G==null?void 0:G.response)==null?void 0:re.status),body:we})}catch{}}finally{x(!1)}}}async function ve(){if(e!=null&&e.id){H(!0),b("");try{localStorage.setItem("activeCheckOutBookingId",e.id);const ce=Number((R==null?void 0:R.extraAmount)||0),z=Number(a)||0,re=Math.max(ce,z);console.log(" Creating payment - ExtraAmount:",ce,"DamageFee:",z,"Using:",re);const G=await Ir.createPayment(e.id,2,"Rental payment at check-out",re);console.log(" Payment created:",G);const we=G||{},Le=we.checkoutUrl||we.url||we.payUrl||"";Le?(console.log(" Opening Payos checkout:",Le),E(Le),window.open(Le,"_blank")):(console.warn(" No checkout URL in payment response:",we),b("No checkout URL received. Please try again."))}catch(ce){console.error(" Payment creation failed:",ce==null?void 0:ce.message),b(`Payment setup failed: ${ce==null?void 0:ce.message}`)}finally{H(!1)}}}async function xe(){if(e!=null&&e.id){O(!0),b("");try{console.log(" Syncing payment for booking:",e.id),await Ir.syncPayment(e.id),console.log(" Payment synced successfully");const ce=await en.getBookingById(e.id);console.log(" Updated booking status:",ce.bookingStatus),ie(!0),b(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(ce){console.error(" Payment sync failed:",ce),b(`Payment sync failed: ${ce.message}`),ie(!1)}finally{O(!1)}}}return r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),R?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check-out Successful"}),r.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(R==null?void 0:R.message)||"Check-out successful!"]}),N&&r.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:N}),Q&&r.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[r.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),r.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Damage Fee:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:oa((R==null?void 0:R.damageFee)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Late Fee:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:oa((R==null?void 0:R.lateFee)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid #eee",paddingTop:8,fontSize:14,fontWeight:600},children:[r.jsx("span",{children:"Total Additional Fees:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:oa(((R==null?void 0:R.damageFee)||0)+((R==null?void 0:R.lateFee)||0))})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,fontSize:14},children:[r.jsx("span",{children:"Refund Amount:"}),r.jsx("strong",{style:{color:"#2e7d32"},children:oa((R==null?void 0:R.refundAmount)??(R==null?void 0:R.RefundAmount)??(R==null?void 0:R.refund)??0)})]})]})]}),r.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:r.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment"}),((R==null?void 0:R.extraAmount)||0)>0?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{fontSize:13,color:"#666",marginBottom:16,lineHeight:1.5},children:["Amount to pay: ",r.jsx("strong",{children:oa((R==null?void 0:R.extraAmount)||0)})]}),U?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:12},children:" Payment link opened in new tab"}),r.jsx("button",{onClick:xe,disabled:q||Q,style:{background:Q?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:q||Q?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:q?" Syncing...":Q?" Synced!":" Sync Payment Status"})]}):r.jsx("button",{onClick:ve,disabled:A,style:{background:"#4CAF50",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:A?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%",marginBottom:8},children:A?" Opening Payment...":" Go to Payment"})]}):r.jsx("div",{style:{fontSize:13,color:"#2e7d32",padding:"12px",background:"#e8f5e9",borderRadius:6},children:" No additional payment needed"})]})})]}),r.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",r.jsx("strong",{children:"Note:"}),' Click "Go to Payment" to open Payos in new tab. After customer completes payment, click "Sync Payment Status" to update booking.']}),r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check Out"}),P&&r.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",P.toLocaleString()]}),N&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:N}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),r.jsxs("form",{onSubmit:ne,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:12,position:"relative"},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Return Date"}),r.jsx("div",{onClick:ce=>{ce.stopPropagation(),y(g==="return"?null:"return")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:d?new Date(d).toLocaleDateString():"Select date"})]}),g==="return"&&r.jsxs("div",{onClick:ce=>ce.stopPropagation(),style:{position:"absolute",top:"100%",left:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:12,marginTop:4,zIndex:10,minWidth:280,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("button",{type:"button",onClick:ce=>{ce.stopPropagation(),ue(-1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""}),r.jsx("span",{style:{fontWeight:600},children:new Date(_,k).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{type:"button",onClick:ce=>{ce.stopPropagation(),ue(1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,marginBottom:8},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(ce=>r.jsx("div",{style:{textAlign:"center",fontSize:12,fontWeight:600},children:ce},ce))}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:W()})]})]}),r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Return Time"}),r.jsx("div",{onClick:ce=>{ce.stopPropagation(),y(g==="return-time"?null:"return-time")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:f})]}),g==="return-time"&&r.jsx("div",{onClick:ce=>ce.stopPropagation(),style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:8,marginTop:4,zIndex:1001,maxHeight:240,overflow:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:M.map(ce=>r.jsx("div",{onClick:z=>{z.stopPropagation(),m(ce),y(null)},style:{padding:"8px 12px",cursor:"pointer",background:ce===f?"#e3f2fd":"#fff",color:ce===f?"#1976d2":"#333",fontWeight:ce===f?"600":"400",borderRadius:4,marginBottom:4},children:ce},ce))})]})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-out Notes"}),r.jsx("textarea",{rows:4,value:s,onChange:ce=>o(ce.target.value),placeholder:"Notes about the vehicle condition upon return, battery level, etc."})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Damage Fee (VND)"}),r.jsx("input",{type:"number",min:"0",value:a,onChange:ce=>l(ce.target.value),placeholder:"Enter damage fee (based on incidents reviewed)"})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:j,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:j?"Processing":"Confirm Check Out"})]})]})]})]})}var bS={};function IS({bookingId:e,onClose:t,refreshKey:n,initialIncidents:s=[]}){const[o,a]=v.useState([]),[l,d]=v.useState(!1),[u,f]=v.useState(!0),[m,g]=v.useState(""),[y,k]=v.useState(1),S=20;v.useEffect(()=>{if(!e)return;let C=!0;return(async()=>{f(!0),g("");try{!l&&Array.isArray(s)&&s.length>0&&(a(s),d(!0));const x=[0,1e3,3e3];for(let N=0;N<x.length&&C;N++){x[N]>0&&await new Promise(b=>setTimeout(b,x[N]));try{const b=await Oe.getIncidentsByBooking(e,y,S),P=Array.isArray(b)?b:[];if(console.log(` Incidents loaded (attempt ${N+1}):`,P),P.length>0){if(!C)return;a(P);return}if(N===x.length-1){if(!C)return;a([])}}catch(b){console.warn(" Incident fetch attempt failed:",(b==null?void 0:b.message)||b)}}}catch(x){console.error(" Failed to load incidents:",x),C&&g((x==null?void 0:x.message)||"Failed to load incidents")}finally{C&&f(!1)}})(),()=>{C=!1}},[e,y,n]);const _=C=>{const j=String(C).toLowerCase();return j.includes("resolved")||j.includes("low")?"#2e7d32":j.includes("medium")?"#f57c00":j.includes("high")||j.includes("open")||j.includes("new")?"#d32f2f":"#666"};return r.jsxs("div",{className:"modal-content",style:{width:"min(900px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"16px 16px 0 0"},children:[r.jsx("h3",{style:{margin:0,fontSize:20,fontWeight:700},children:"Related Incidents"}),r.jsx("span",{className:"close-btn",onClick:t,style:{cursor:"pointer",fontSize:24},children:""})]}),u?r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" Loading incidents..."}):m?r.jsxs("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6},children:[" ",m]}):o.length===0?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" No incidents reported for this booking"}),y>1&&!u&&r.jsx("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:r.jsx("button",{onClick:()=>k(1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Reset to Page 1"})})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.map((C,j)=>{var q;const x=C.id||C._id||"",N=C.description||C.title||"",b=N&&N.length>80?N.slice(0,80)+"":N,P=C.status||C.severity||"N/A",T=C.reportedAt||C.reportedDate||C.timestamp||C.createdAt||null,R=C.resolvedAt||C.resolvedDate||null,B=C.costIncurred??C.estimatedCost??null,U=C.staffName||C.staff||C.reportedBy||null,E=C.resolverName||C.resolvedBy||null,A=Array.isArray(C.images)?C.images:[],H=O=>O?typeof O=="string"&&(O.startsWith("http://")||O.startsWith("https://"))?O:typeof O=="string"&&O.trim()?`${bS.REACT_APP_API_URL||window.location.origin}/${O.replace(/^\//,"")}`:null:null;return r.jsxs("div",{style:{border:"1px solid #eee",padding:16,borderRadius:6,display:"flex",gap:16},children:[r.jsx("div",{style:{flex:"0 0 120px"},children:A.length>0&&H(A[0])?r.jsx("img",{src:H(A[0]),alt:"incident",style:{width:120,height:90,objectFit:"cover",borderRadius:6},onError:O=>{O.target.style.display="none"}}):r.jsx("div",{style:{width:120,height:90,background:"#fafafa",border:"1px dashed #eee",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:12},children:"No image"})}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[r.jsxs("div",{children:[r.jsx("h4",{style:{margin:"0 0 6px",fontSize:15,fontWeight:700},children:b||`Incident ${((q=x==null?void 0:x.slice)==null?void 0:q.call(x,0,8))||j+1}`}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",x||"N/A"]})]}),r.jsx("div",{style:{textAlign:"right"},children:r.jsx("div",{style:{background:_(P),color:"#fff",padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:700},children:P})})]}),r.jsx("p",{style:{margin:"0 0 10px",fontSize:14,color:"#555",lineHeight:1.5},children:N||"No description"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12,fontSize:13,color:"#666"},children:[r.jsxs("div",{children:[" Est. Cost: ",r.jsx("strong",{style:{color:"#d32f2f"},children:B!==null?`${Number(B).toLocaleString()} VND`:"N/A"})]}),r.jsxs("div",{children:[" Reported: ",r.jsx("strong",{children:T?new Date(T).toLocaleString():"N/A"})]}),r.jsxs("div",{children:[" Resolved: ",r.jsx("strong",{children:R?new Date(R).toLocaleString():"N/A"})]}),r.jsxs("div",{children:[" Staff: ",r.jsx("strong",{children:U||"N/A"})]}),E&&r.jsxs("div",{children:[" Resolver: ",r.jsx("strong",{children:E})]})]})]})]},x||j)})}),!u&&o.length>0&&r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:[r.jsx("button",{onClick:()=>k(C=>Math.max(1,C-1)),disabled:y===1,style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:y===1?"not-allowed":"pointer"},children:" Prev"}),r.jsxs("span",{style:{padding:"6px 12px"},children:["Page ",y]}),r.jsx("button",{onClick:()=>k(C=>C+1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Next "})]})]})}function LS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onContinuePayment:a,onCancelBooking:l,onStatusUpdated:d}){const[u,f]=v.useState(null),[m,g]=v.useState(null),[y,k]=v.useState(null),[S,_]=v.useState(0),[C,j]=v.useState([]),x=v.useCallback(P=>{typeof d=="function"&&d(P)},[d]);hr.useEffect(()=>{if(!(y!=null&&y.id))return;const P={current:!1},T=setInterval(async()=>{try{const R=localStorage.getItem("activeCheckOutBookingId");if(P.current){if(!R){console.log(" Checkout payment completed (user redirected)"),clearInterval(T),k(null),x(y==null?void 0:y.id);return}R&&R!==String(y.id)&&(P.current=!1)}else if(R===String(y.id))P.current=!0,console.log(" Detected active check-out payment flow for",y.id);else return}catch(R){console.warn(" Polling error:",R==null?void 0:R.message)}},2e3);return()=>clearInterval(T)},[y==null?void 0:y.id,x]),hr.useEffect(()=>{if(!(m!=null&&m.id))return;const P={current:!1},T=setInterval(()=>{try{const R=localStorage.getItem("activeCheckInBookingId");if(P.current){if(!R){console.log(" Check-in payment completed (user redirected)"),clearInterval(T),g(null),x(m==null?void 0:m.id);return}R&&R!==String(m.id)&&(P.current=!1)}else if(R===String(m.id))P.current=!0,console.log(" Detected active check-in payment flow for",m.id);else return}catch(R){console.warn(" Polling error (check-in):",R==null?void 0:R.message)}},2e3);return()=>clearInterval(T)},[m==null?void 0:m.id,x]);const N=e.filter(P=>(P.title.toLowerCase().includes(t.toLowerCase())||(P.customer||"").toLowerCase().includes(t.toLowerCase())||(P.userName||"").toLowerCase().includes(t.toLowerCase())||(P.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||P.status===s)),b=P=>P.uiStage==="waiting-payment"?r.jsx(wS,{booking:P,onClick:()=>f(P)},P.id):P.uiStage==="checkin-payment"?r.jsx(jS,{booking:P,onClick:()=>f(P)},P.id):r.jsx(Ud,{booking:P,onClick:()=>f(P)},P.id);return r.jsxs(r.Fragment,{children:[r.jsx(Ly,{bookings:N,renderBookingCard:b,search:t,setSearch:n,statusFilter:s,setStatusFilter:o}),r.jsx(CS,{booking:u,onClose:()=>f(null),onProceed:(P,T)=>{P&&(T==="checkout"?(k(P),f(null)):(g(P),f(null)))},onCancel:()=>{u&&(l==null||l(u))},onStatusUpdated:d}),m&&r.jsx(NS,{booking:m,onClose:()=>g(null)}),y&&r.jsxs("div",{style:{display:"flex",gap:24,position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:1e3,alignItems:"center",justifyContent:"center",padding:20,overflow:"auto"},children:[r.jsx("div",{style:{flex:"0 0 auto",width:"720px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:r.jsx(kS,{booking:y,onClose:()=>k(null),onCheckedOut:(P,T=[])=>{_(R=>R+1),j(Array.isArray(T)?T:[]),typeof d=="function"&&d(P)}})}),r.jsx("div",{style:{flex:"0 0 auto",width:"600px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:r.jsx(IS,{bookingId:y==null?void 0:y.id,refreshKey:S,initialIncidents:C,onClose:()=>{k(null),j([])}})})]})]})}function PS({vehicle:e,onOpen:t}){const n=s=>{qu(s.currentTarget)};return r.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[r.jsx("img",{src:Gu(e.img),alt:e.name,onError:n}),r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-title",children:e.name}),r.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),r.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),r.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),r.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function ES({open:e,onClose:t,onSubmit:n,stationId:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,k]=v.useState(""),[S,_]=v.useState(""),[C,j]=v.useState(""),[x,N]=v.useState(""),[b,P]=v.useState(""),[T,R]=v.useState(""),[B,U]=v.useState(""),[E,A]=v.useState("");if(!e)return null;async function H(){if(A(""),!s){A("Please select a station before creating a vehicle.");return}if(!o.trim()||!l.trim()||!y.trim()||!u||!S||!C||!x||!b){A("Please fill all required fields: Brand, Model, Year, License Plate, Battery Capacity, Current Battery, Price/hour, Price/day.");return}const q=Number(u),O=Number(S),Q=Number(C),ie=Number(x),M=Number(b);if(!Number.isFinite(q)||q<1900||q>2100){A("Year must be between 1900 and 2100.");return}if(!Number.isFinite(O)||O<0||O>100){A("Battery Capacity must be between 0 and 100 (kWh).");return}if(!Number.isFinite(Q)||Q<0||Q>100){A("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(ie)||ie<=0||!Number.isFinite(M)||M<=0){A("Rental prices must be positive numbers.");return}const W={brand:o.trim(),model:l.trim(),year:q,color:m||void 0,licensePlate:y.trim(),batteryCapacity:O,currentBatteryLevel:Q,rentalPricePerHour:ie,rentalPricePerDate:M,currentStationId:s,imageUrl:T||void 0,description:B||void 0};try{await n(W),a(""),d(""),f(""),g(""),k(""),_(""),j(""),N(""),P(""),R(""),U(""),t()}catch(ue){A((ue==null?void 0:ue.message)||"Failed to create vehicle")}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),E&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:E}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[r.jsx("input",{value:o,onChange:q=>a(q.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:l,onChange:q=>d(q.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:u,onChange:q=>f(q.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:m,onChange:q=>g(q.target.value),placeholder:"Color",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:y,onChange:q=>k(q.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:S,onChange:q=>_(q.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:C,onChange:q=>j(q.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:x,onChange:q=>N(q.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:b,onChange:q=>P(q.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:T,onChange:q=>R(q.target.value),placeholder:"Image URL",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}}),r.jsx("input",{value:B,onChange:q=>U(q.target.value),placeholder:"Description",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:H,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function TS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState("");if(v.useEffect(()=>{n&&(a(n.battery??""),d(n.tech??""),f(n.issue??""))},[n]),!e||!n)return null;function m(){s(n.id,{battery:o,tech:l,issue:u}),t()}return r.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"vehicle-modal-content",children:[r.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),r.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),r.jsx("label",{children:"Battery Status"}),r.jsx("input",{value:o,onChange:g=>a(g.target.value),placeholder:"e.g. 80"}),r.jsx("label",{children:"Condition"}),r.jsxs("select",{value:l,onChange:g=>d(g.target.value),children:[r.jsx("option",{children:"Open"}),r.jsx("option",{children:"Running"}),r.jsx("option",{children:"Rented"}),r.jsx("option",{children:"Maintained"})]}),r.jsx("label",{children:"Issue"}),r.jsx("textarea",{value:u,onChange:g=>f(g.target.value)}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:m,children:"Submit Update"})})]})})}function BS({open:e,vehicle:t,onClose:n,onEdit:s,onUpdate:o}){const[a,l]=v.useState(!1),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState(""),[k,S]=v.useState(!0),[_,C]=v.useState(!1);if(!e||!t)return null;const j=t.img,x=()=>{u(t.battery??""),m(t.tech??""),y(t.issue??""),S(t.isAvailable!==!1&&t.isAvailable!==0),l(!0)},N=async()=>{if(o){C(!0);try{await o(t.id,{battery:d,tech:f,issue:g,isAvailable:k}),l(!1)}catch(P){alert((P==null?void 0:P.message)||"Failed to update vehicle")}finally{C(!1)}}},b=()=>{l(!1),u(""),m(""),y(""),S(!0)};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsx("img",{src:j,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),r.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[r.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[r.jsx("h3",{style:{marginTop:4},children:t.name}),r.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Detail:"}),r.jsx("div",{children:t.detail||"N/A"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Battery:"}),a?r.jsx("input",{type:"number",min:"0",max:"100",value:d,onChange:P=>u(P.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):r.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Condition:"}),a?r.jsx("input",{type:"text",value:f,onChange:P=>m(P.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):r.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Active Status:"}),a?r.jsxs("label",{style:{marginLeft:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"8px"},children:[r.jsx("input",{type:"checkbox",checked:k,onChange:P=>S(P.target.checked),style:{cursor:"pointer",width:"18px",height:"18px"}}),r.jsx("span",{style:{fontSize:"14px"},children:k?" Available":" Unavailable"})]}):r.jsx("span",{style:{marginLeft:"8px",fontWeight:"600",color:t.isAvailable!==!1&&t.isAvailable!==0?"#10b981":"#ef4444"},children:t.isAvailable!==!1&&t.isAvailable!==0?" Available":" Unavailable"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[r.jsx("strong",{children:"Issue:"}),a?r.jsx("textarea",{value:g,onChange:P=>y(P.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):r.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),r.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:j,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),r.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:a?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:N,disabled:_,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:_?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:_?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",_?"Saving...":"Save Changes"]}),r.jsxs("button",{onClick:b,disabled:_,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:_?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):o&&r.jsxs("button",{onClick:x,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]})})]})})}function RS({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return r.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[r.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function AS({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:o,canDelete:a=!0,stationSlots:l=null}){const[d,u]=v.useState(null),[f,m]=v.useState(!1),[g,y]=v.useState(!1),[k,S]=v.useState(!1),[_,C]=v.useState(""),j=e.filter(b=>{if(!_)return!0;const P=_.toLowerCase(),T=(b.name||"").toLowerCase(),R=(b.model||"").toLowerCase(),B=(b.brand||"").toLowerCase(),U=(b.licensePlate||"").toLowerCase();return T.includes(P)||R.includes(P)||B.includes(P)||U.includes(P)});function x(b){u(b),S(!0)}function N(b){u(b),m(!0)}return r.jsxs("div",{id:"vehicle",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:_,onChange:b=>C(b.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),o&&l&&r.jsx(RS,{stationSlots:l})]}),r.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!j||j.length===0)&&r.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:_?"No vehicles match your search.":"No vehicles available to display."}),j.map((b,P)=>r.jsx("div",{children:r.jsx(PS,{vehicle:b,onOpen:()=>N(b)})},b.id||b.licensePlate||`${b.name}-${b.stationId||""}-${P}`))]}),r.jsx(ES,{open:g,onClose:()=>y(!1),onSubmit:t,stationId:o}),r.jsx(TS,{open:k,onClose:()=>S(!1),vehicle:d,onSubmit:s}),r.jsx(BS,{open:f,vehicle:d,onClose:()=>m(!1),onEdit:d?()=>x(d):null,onUpdate:s})]})}function MS({open:e,onClose:t,inline:n=!1}){const[s,o]=v.useState(!1),[a,l]=v.useState({}),[d,u]=v.useState({}),[f,m]=v.useState("");if(v.useEffect(()=>{if(!e)return;let P=!0;async function T(){var R,B,U;try{o(!0),m("");let E={},A={};try{E=await wt.getMyProfile()}catch(H){((R=H==null?void 0:H.response)==null?void 0:R.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{A=await wt.getMe()}catch(H){((B=H==null?void 0:H.response)==null?void 0:B.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!P)return;l(E||{}),u(A||{});try{let H=(E==null?void 0:E.id)||(E==null?void 0:E.userId)||(A==null?void 0:A.userId)||(A==null?void 0:A.id);if(!H){const O=typeof localStorage<"u"?localStorage.getItem("token"):null;if(O){const Q=Pr(O);H=Q["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||Q.nameidentifier||Q.sub||Q.userId||Q.UserId||Q.id||Q.Id}}if(!(A!=null&&A.role)&&!(E!=null&&E.role))try{const O=typeof localStorage<"u"?localStorage.getItem("token"):null;if(O){const Q=Pr(O),ie=(Q==null?void 0:Q.role)||(Q==null?void 0:Q.Role)||Q["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];ie&&(A={...A,role:ie})}}catch{}const q=!(E!=null&&E.userName)&&!(A!=null&&A.userName)||!(E!=null&&E.address)||!(E!=null&&E.stationName);if(H&&q)try{const O=await wt.getUserById(H);if(!P)return;const Q={...E};Q.userName||(Q.userName=(O==null?void 0:O.userName)||(O==null?void 0:O.UserName)||(O==null?void 0:O.username)||""),Q.address||(Q.address=(O==null?void 0:O.address)||(O==null?void 0:O.Address)||""),Q.stationName||(Q.stationName=(O==null?void 0:O.stationName)||((U=O==null?void 0:O.station)==null?void 0:U.name)||(O==null?void 0:O.StationName)||""),l(Q)}catch{}}catch{}if((!E||Object.keys(E).length===0)&&(!A||Object.keys(A).length===0)){const H=typeof localStorage<"u"&&!!localStorage.getItem("token");m(H?"You may not have permission to view this profile.":"You are not logged in. Please log in with a staff account.")}}catch(E){if(!P)return;m((E==null?void 0:E.message)||"Failed to load profile")}finally{P&&o(!1)}}return T(),()=>{P=!1}},[e]),!e)return null;let g=a.userName||a.username||d.userName||d.username||"";if(!g)try{const P=typeof localStorage<"u"?localStorage.getItem("token"):null;if(P){const T=Pr(P);g=(T==null?void 0:T.preferred_username)||(T==null?void 0:T.unique_name)||(T==null?void 0:T.userName)||(T==null?void 0:T.username)||(T==null?void 0:T.name)||""}}catch{}const y=a.firstName?`${a.firstName} ${a.lastName||""}`.trim():a.fullName||d.fullName||d.name||"",k=a.email||d.email||"",S=a.phoneNumber||d.phoneNumber||"",_=a.address||d.address||"",C=a.createdAt||d.createdAt||"",j=a.employeeId||a.id||d.userId||d.id||"",x=a.stationName||a.station||"",N=a.role||d.role||(Array.isArray(d.roles)?d.roles.join(", "):d.roles||""),b=a.avatarUrl||d.avatarUrl||"https://via.placeholder.com/180x180?text=Staff";return n?r.jsxs("div",{className:"staff-profile-page",children:[r.jsx("div",{className:"staff-cover",children:r.jsx("div",{className:"staff-cover-gradient"})}),r.jsx("div",{className:"staff-header",children:r.jsxs("div",{className:"staff-header-inner",children:[r.jsx("div",{className:"staff-avatar",children:r.jsx("img",{src:b,alt:"Avatar"})}),r.jsxs("div",{className:"staff-title",children:[r.jsx("h1",{children:y}),r.jsxs("div",{className:"staff-meta",children:[r.jsx("span",{className:"staff-role",children:N||""}),r.jsx("span",{className:"staff-sep",children:""}),r.jsx("span",{className:"staff-station",children:x})]})]})]})}),r.jsxs("div",{className:"staff-content",children:[r.jsx("div",{className:"staff-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"About"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Full Name"}),r.jsx("span",{className:"value",children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Role"}),r.jsx("span",{className:"value",children:N||""})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Station"}),r.jsx("span",{className:"value",children:x})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Employee ID"}),r.jsx("span",{className:"value",children:j})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Joined"}),r.jsx("span",{className:"value",children:String(C).toString().slice(0,10)||""})]})]})]})}),r.jsx("div",{className:"staff-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"Contact"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Email"}),r.jsx("span",{className:"value",children:k})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Phone"}),r.jsx("span",{className:"value",children:S})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Address"}),r.jsx("span",{className:"value",children:_})]})]})]})})]}),f&&r.jsx("div",{className:"staff-error",children:f})]}):r.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"profile-modal-content",children:[r.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),r.jsx("h2",{children:"Staff Profile"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsx("img",{src:b,alt:"Staff",style:{borderRadius:"50%"}}),s?r.jsx("div",{style:{padding:16},children:"Loading profile"}):r.jsxs("div",{className:"profile-info-grid",children:[r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Name"}),r.jsx("div",{children:y})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Email"}),r.jsx("div",{children:k})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Role"}),r.jsx("div",{children:N||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Phone"}),r.jsx("div",{children:S})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Address"}),r.jsx("div",{children:_})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Joined"}),r.jsx("div",{children:String(C).toString().slice(0,10)||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Employee ID"}),r.jsx("div",{children:j})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Station"}),r.jsx("div",{children:x})]})]})]})})}function FS(){return r.jsx("div",{id:"profile",className:"section",style:{padding:24},children:r.jsx(MS,{open:!0,inline:!0,onClose:()=>{}})})}function Ty({incident:e,onClick:t}){var a;const n=l=>{const d={Pending:{background:"#fef3c7",color:"#92400e",icon:"fa-clock"},InProgress:{background:"#dbeafe",color:"#1e40af",icon:"fa-spinner"},Resolved:{background:"#d1fae5",color:"#065f46",icon:"fa-check-circle"}},u=d[l]||d.Pending;return r.jsxs("span",{style:{...u,padding:"4px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px"},children:[r.jsx("i",{className:`fas ${u.icon}`}),l]})},s=l=>l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",o=l=>l==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(l);return r.jsxs("div",{className:"incident-card",onClick:()=>t(e),children:[r.jsxs("div",{className:"incident-card-header",children:[r.jsxs("div",{className:"incident-card-title",children:[r.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b",marginRight:"8px"}}),r.jsxs("span",{children:["Incident #",(a=e.id)==null?void 0:a.slice(0,8)]})]}),n(e.status)]}),r.jsxs("div",{className:"incident-card-body",children:[r.jsx("div",{className:"incident-description",children:e.description}),r.jsxs("div",{className:"incident-metadata",children:[r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsx("span",{children:s(e.reportedAt)})]}),e.bookingId&&r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-ticket-alt"}),r.jsxs("span",{children:["Booking: ",e.bookingId.slice(0,8),"..."]})]}),e.costIncurred!=null&&r.jsxs("div",{className:"incident-meta-item",style:{color:"#dc2626",fontWeight:"600"},children:[r.jsx("i",{className:"fas fa-dollar-sign"}),r.jsx("span",{children:o(e.costIncurred)})]}),e.images&&e.images.length>0&&r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-image"}),r.jsxs("span",{children:[e.images.length," image",e.images.length>1?"s":""]})]})]})]}),r.jsx("div",{className:"incident-card-footer",children:r.jsxs("span",{className:"incident-view-details",children:["View Details ",r.jsx("i",{className:"fas fa-arrow-right"})]})})]})}function US({open:e,onClose:t,onSubmit:n,bookings:s=[]}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState([]),[m,g]=v.useState([]),[y,k]=v.useState(""),[S,_]=v.useState(!1);if(!e)return null;const C=(s||[]).filter(b=>{const P=String((b==null?void 0:b.status)||"").toLowerCase(),T=String((b==null?void 0:b.statusLabel)||"").toLowerCase(),R=Number(b==null?void 0:b.bookingStatus),B=["checked-in","checkedin","checked_in","checked in","checked"].includes(P),U=Number.isFinite(R)&&R===3,E=T.includes("checked-in")||T.includes("checked in")||T.includes("checked")&&!T.includes("wait")&&!T.includes("waiting")&&!T.includes("pending");return B||U||E}),j=b=>{const P=Array.from(b.target.files||[]),T=new Set(u.map(E=>`${E.name}_${E.size}`)),R=P.filter(E=>{if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(E.type))return k(`Invalid file type: ${E.name}. Only JPG, PNG, GIF allowed.`),!1;if(E.size>26214400)return k(`File too large: ${E.name}. Max 25MB per file.`),!1;const q=`${E.name}_${E.size}`;return T.has(q)?!1:(T.add(q),!0)});if(R.length===0)return;const B=[...u,...R];f(B);const U=R.map(E=>URL.createObjectURL(E));g(E=>[...E,...U])},x=b=>{const P=u.filter((R,B)=>B!==b),T=m.filter((R,B)=>B!==b);try{URL.revokeObjectURL(m[b])}catch{}f(P),g(T)},N=async()=>{if(k(""),!o){k("Please select a booking");return}if(!l.trim()){k("Please provide incident description");return}_(!0);try{const b=new FormData;b.append("bookingId",o),b.append("description",l.trim()),u.forEach(P=>{b.append("images",P)}),await n(b),a(""),d(""),f([]),m.forEach(P=>URL.revokeObjectURL(P)),g([]),t()}catch(b){k((b==null?void 0:b.message)||"Failed to create incident")}finally{_(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"650px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsxs("h3",{style:{marginTop:0,marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b"}}),"Report Incident"]}),y&&r.jsxs("div",{style:{background:"#fee2e2",color:"#b91c1c",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:[r.jsx("i",{className:"fas fa-exclamation-circle"})," ",y]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Select Booking ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),C.length===0?r.jsx("div",{style:{padding:"10px",border:"1px solid #f3f4f6",borderRadius:8,color:"#6b7280"},children:'No bookings in "Checked-in" state available.'}):r.jsxs("select",{value:o,onChange:b=>a(b.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"-- Select Booking --"}),C.map(b=>r.jsxs("option",{value:b.id,children:["Booking #",String(b.id).slice(0,8)," - ",b.title||b.vehicleName||"Vehicle"," (",b.statusLabel||b.status,")"]},b.id))]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Incident Description ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),r.jsx("textarea",{value:l,onChange:b=>d(b.target.value),placeholder:"Describe the incident in detail...",rows:5,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",resize:"vertical",fontFamily:"inherit"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:"Upload Images (Optional)"}),r.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.gif",multiple:!0,onChange:j,disabled:C.length===0,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",cursor:C.length===0?"not-allowed":"pointer",opacity:C.length===0?.6:1}}),r.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:"Max 25MB per file. Formats: JPG, PNG, GIF"})]}),m.length>0&&r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:["Preview (",m.length," image",m.length>1?"s":"",")"]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px"},children:m.map((b,P)=>r.jsxs("div",{style:{position:"relative"},children:[r.jsx("img",{src:b,alt:`Preview ${P+1}`,style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e5e7eb"}}),r.jsx("button",{onClick:()=>x(P),style:{position:"absolute",top:"4px",right:"4px",background:"#dc2626",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("i",{className:"fas fa-times"})})]},P))})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},children:[r.jsx("button",{onClick:t,disabled:S,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:S?"not-allowed":"pointer",opacity:S?.6:1},children:"Cancel"}),r.jsx("button",{onClick:N,disabled:S||C.length===0,style:{padding:"10px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:S?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:S?.6:1},children:S?r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fas fa-spinner fa-spin"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fas fa-plus"}),"Create Incident"]})})]})]})})}function By({open:e,incident:t,onClose:n,onUpdate:s,onResolve:o,onDelete:a,canDelete:l=!1,footerExtras:d=null}){var B;const[u,f]=v.useState(!1),[m,g]=v.useState(""),[y,k]=v.useState(""),[S,_]=v.useState(""),[C,j]=v.useState(!1);if(!e||!t)return null;const x=U=>U?new Date(U).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",N=U=>U==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(U),b=()=>{g(t.status||"Pending"),k(t.resolutionNotes||""),_(t.costIncurred||""),f(!0)},P=async()=>{j(!0);try{const U=new FormData;m&&U.append("status",m),y&&U.append("resolutionNotes",y),S&&U.append("costIncurred",S),await s(t.id,U),f(!1)}catch(U){alert((U==null?void 0:U.message)||"Failed to update incident")}finally{j(!1)}},T=async()=>{if(window.confirm("Mark this incident as resolved?")){j(!0);try{await o(t.id,y,S||0),n()}catch(U){alert((U==null?void 0:U.message)||"Failed to resolve incident")}finally{j(!1)}}},R=async()=>{if(window.confirm("Are you sure you want to delete this incident? This action cannot be undone.")){j(!0);try{await a(t.id),n()}catch(U){alert((U==null?void 0:U.message)||"Failed to delete incident")}finally{j(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",background:"#fef9e7",border:"2px solid #d4af37",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsxs("div",{style:{textAlign:"center",borderBottom:"3px double #d4af37",paddingBottom:"20px",marginBottom:"24px"},children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontFamily:"Georgia, serif",color:"#1f2937",fontSize:"28px",fontWeight:"bold"},children:"INCIDENT REPORT"}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",fontFamily:"Georgia, serif"},children:"Official Documentation"}),t.status?r.jsx("div",{style:{display:"inline-block",marginTop:"12px",padding:"6px 16px",background:t.status==="Resolved"?"#d1fae5":t.status==="InProgress"?"#dbeafe":"#fef3c7",color:t.status==="Resolved"?"#065f46":t.status==="InProgress"?"#1e40af":"#92400e",borderRadius:"20px",fontSize:"13px",fontWeight:"600",border:`2px solid ${t.status==="Resolved"?"#10b981":t.status==="InProgress"?"#3b82f6":"#f59e0b"}`},children:(B=t.status)==null?void 0:B.toUpperCase()}):null]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"24px",fontFamily:"Georgia, serif"},children:[r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Report ID:"}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.id})]}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Reported Date:"}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px"},children:x(t.reportedAt)})]}),r.jsxs("div",{children:[r.jsxs("strong",{style:{color:"#4b5563",fontSize:"14px"},children:[t.creatorStation?"Creator Station":"Booking Reference",":"]}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.creatorStation?t.creatorStation:t.bookingId?`${String(t.bookingId).slice(0,16)}...`:""})]}),t.stationId&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Station ID:"}),r.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[t.stationId.slice(0,16),"..."]})]})]}),r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Incident Description:"}),r.jsx("p",{style:{color:"#1f2937",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.description})]}),t.images&&t.images.length>0&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:["Evidence Photos (",t.images.length,"):"]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:t.images.map((U,E)=>r.jsx("a",{href:U,target:"_blank",rel:"noopener noreferrer",style:{display:"block"},children:r.jsx("img",{src:U,alt:`Evidence ${E+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",border:"2px solid #d4af37",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:A=>A.currentTarget.style.transform="scale(1.05)",onMouseOut:A=>A.currentTarget.style.transform="scale(1)"})},E))})]}),u?r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"2px solid #3b82f6"},children:[r.jsx("strong",{style:{fontSize:"16px",display:"block",marginBottom:"12px"},children:"Update Incident:"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Status:"}),r.jsxs("select",{value:m,onChange:U=>g(U.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"},children:[r.jsx("option",{value:"Pending",children:"Pending"}),r.jsx("option",{value:"InProgress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"})]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Resolution Notes:"}),r.jsx("textarea",{value:y,onChange:U=>k(U.target.value),rows:4,placeholder:"Enter resolution details...",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Cost Incurred (VND):"}),r.jsx("input",{type:"number",value:S,onChange:U=>_(U.target.value),placeholder:"0",min:"0",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"}})]})]}):r.jsxs(r.Fragment,{children:[t.resolutionNotes&&r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#d1fae5",borderRadius:"8px",border:"1px solid #10b981"},children:[r.jsx("strong",{style:{color:"#065f46",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Resolution Notes:"}),r.jsx("p",{style:{color:"#047857",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.resolutionNotes})]}),t.costIncurred!=null&&r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#fee2e2",borderRadius:"8px",border:"1px solid #dc2626"},children:[r.jsx("strong",{style:{color:"#991b1b",fontSize:"16px",display:"block",marginBottom:"8px",fontFamily:"Georgia, serif"},children:"Cost Incurred:"}),r.jsx("div",{style:{color:"#dc2626",fontSize:"24px",fontWeight:"bold",fontFamily:"Georgia, serif"},children:N(t.costIncurred)})]})]}),r.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"20px",borderTop:"2px solid #e5e7eb",flexWrap:"wrap"},children:d||(u?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>f(!1),disabled:C,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer",opacity:C?.6:1},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]}),r.jsxs("button",{onClick:P,disabled:C,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer",opacity:C?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",C?"Saving...":"Save Changes"]})]}):r.jsxs(r.Fragment,{children:[l&&r.jsxs("button",{onClick:R,disabled:C,style:{padding:"10px 20px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer",marginRight:"auto"},children:[r.jsx("i",{className:"fas fa-trash"})," Delete"]}),t.status!=="Resolved"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:b,disabled:C,style:{padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit"]}),r.jsxs("button",{onClick:T,disabled:C,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer"},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",C?"Resolving...":"Mark Resolved"]})]}),r.jsx("button",{onClick:n,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Close"})]}))})]})})}function OS({incidents:e=[],bookings:t=[],onCreateIncident:n,onUpdateIncident:s,onResolveIncident:o,onDeleteIncident:a,onRefresh:l,canDelete:d=!0,stationFilter:u=null}){const[f,m]=v.useState(!1),[g,y]=v.useState(!1),[k,S]=v.useState(null),[_,C]=v.useState(""),[j,x]=v.useState(""),N=e.filter(U=>{if(_&&U.status!==_)return!1;if(j){const E=j.toLowerCase(),A=(U.description||"").toLowerCase(),H=(U.id||"").toLowerCase(),q=(U.bookingId||"").toLowerCase();if(!A.includes(E)&&!H.includes(E)&&!q.includes(E))return!1}return!0}),b=U=>{S(U),y(!0)},P=async U=>{await n(U)},T=async(U,E)=>{await s(U,E),l&&await l(),y(!1)},R=async(U,E,A)=>{await o(U,E,A),l&&await l()},B=async U=>{await a(U),l&&await l()};return r.jsxs("div",{id:"incident",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsxs("button",{className:"incident-add-btn",onClick:()=>m(!0),children:[r.jsx("i",{className:"fas fa-plus"})," Report Incident"]}),r.jsxs("div",{className:"incident-filters",style:{flex:1,display:"flex",gap:"12px"},children:[r.jsxs("select",{className:"incident-filter-select",value:_,onChange:U=>C(U.target.value),children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"Pending",children:"Pending"}),r.jsx("option",{value:"InProgress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"})]}),r.jsx("input",{className:"incident-search-input",type:"text",placeholder:"Search by description, ID, or booking...",value:j,onChange:U=>x(U.target.value)})]})]}),r.jsx("div",{style:{padding:"8px 8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},children:N.length===0?"No incidents found":`Showing ${N.length} incident${N.length>1?"s":""}`}),N.length>0?r.jsx("div",{className:"incident-grid",children:N.map(U=>r.jsx(Ty,{incident:U,onClick:b},U.id))}):r.jsxs("div",{className:"incident-empty-state",children:[r.jsx("i",{className:"fas fa-clipboard-check"}),r.jsx("h3",{children:"No Incidents"}),r.jsx("p",{children:j||_?"No incidents match your filters":"No incidents have been reported yet"})]}),r.jsx(US,{open:f,onClose:()=>m(!1),onSubmit:P,bookings:t}),r.jsx(By,{open:g,incident:k,onClose:()=>y(!1),onUpdate:T,onResolve:R,onDelete:B,canDelete:d})]})}const zS=[],DS=[];function $S(){var ze,me,et,mn;const[e,t]=v.useState("booking"),[n,s]=v.useState(zS),[o,a]=v.useState(DS),[l,d]=v.useState(()=>{try{const he=localStorage.getItem("staff_sidebar_visible");return he==null?!0:he==="1"}catch{return!0}}),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,k]=v.useState([]),[S,_]=v.useState([]),[C,j]=v.useState(!1),[x,N]=v.useState(""),[b,P]=v.useState(!1),[T,R]=v.useState(!1),[B,U]=v.useState(!1),[E,A]=v.useState(""),[H,q]=v.useState(""),[O,Q]=v.useState(""),[ie,M]=v.useState(null),W=async he=>{try{await Oe.confirmBooking(he.id,"Cash",""),s(se=>se.map(ae=>ae.id===he.id?{...ae,status:"booked"}:ae))}catch(se){A((se==null?void 0:se.message)||"Failed to proceed to payment")}},ue=async(he,se="")=>{var ae;try{await Oe.cancelBooking(he.id,se||""),s(ye=>ye.map(le=>le.id===he.id?{...le,status:"denied"}:le))}catch(ye){const le=(ae=ye==null?void 0:ye.response)==null?void 0:ae.status;if(le===401||le===403){alert("You don't have permission to cancel this booking.");return}A((ye==null?void 0:ye.message)||"Failed to cancel booking")}},ne=async(he,se)=>{let ae=se;try{if(ae==null)try{const le=await Oe.getBookingById(he),Ne=(le==null?void 0:le.statusCode)??(le==null?void 0:le.StatusCode)??(le==null?void 0:le.bookingStatus)??(le==null?void 0:le.BookingStatus)??(le==null?void 0:le.status)??(le==null?void 0:le.Status);if(Ne!=null&&(typeof Ne=="number"||/^\d+$/.test(String(Ne)))){const Je=Number(Ne);Je===0?ae="pending":Je===1?ae="booked":Je===2?ae="waiting-checkin":Je===3?ae="checked-in":Je===4?ae="checkout-pending":Je===5?ae="completed":Je===6?ae="cancelled-pending":Je===7&&(ae="cancelled")}else{const Je=String(Ne||"").toLowerCase();Je.includes("pending")||Je.includes("wait")?ae="pending":Je.includes("check")&&Je.includes("in")?ae="checked-in":Je.includes("complete")||Je.includes("finish")?ae="completed":Je.includes("cancel")?ae="cancelled":ae="booked"}}catch(le){console.warn(" Failed to refresh booking status for",he,(le==null?void 0:le.message)||le)}}catch(le){console.warn(" Error resolving status for booking update:",(le==null?void 0:le.message)||le)}const ye=ae==="pending"?"Pending":ae==="booked"?"Active Rental":ae==="waiting-checkin"?"Waiting Check-in":ae==="checked-in"?"Checked-in":ae==="checkout-pending"?"Check-out Pending":ae==="completed"?"Completed":ae==="cancelled-pending"?"Cancelled (Pending Refund)":ae==="cancelled"?"Cancelled":ae;ae!==void 0&&s(le=>le.map(Ne=>Ne.id===he?{...Ne,status:ae,statusLabel:ye}:Ne))},ve=async he=>{var se;try{const ae=he.get("bookingId")||"",ye=he.get("description")||"";let le=[];try{le=he.getAll?he.getAll("images"):[]}catch{le=[]}const Ne=await Oe.createIncident(ae,ye,le);try{alert("Incident gi thnh cng. Cm n bn.")}catch{}return Ne}catch(ae){throw console.error(" create incident failed",((se=ae==null?void 0:ae.response)==null?void 0:se.data)||(ae==null?void 0:ae.message)||ae),ae}},xe=async he=>{if(!he){_([]);return}j(!0);try{const se=await Oe.getAllIncidents(he,null,null,null,1,200),ye=((se==null?void 0:se.incidents)||[]||[]).map(le=>({id:le.id||le.Id||le.incidentId||le.IncidentId||le._id&&String(le._id),description:le.description||le.Description||le.details||"",bookingId:le.bookingId||le.BookingId||le.booking||null,images:le.images||le.Images||[],status:le.status||le.Status||"Pending",reportedAt:le.reportedAt||le.ReportedAt||le.createdAt||le.CreatedAt||le.date||null,costIncurred:le.costIncurred??le.CostIncurred??le.cost??null,stationId:le.stationId||le.StationId||null,raw:le}));_(ye)}catch(se){console.error(" failed to load incidents for station",se),_([])}finally{j(!1)}},ce=async(he,se)=>{try{await Oe.updateIncident(he,se),await xe(x)}catch(ae){throw console.error(" update incident failed",ae),ae}},z=async(he,se,ae)=>{try{await Oe.resolveIncident(he,se,Number(ae)||0),await xe(x)}catch(ye){throw console.error(" resolve incident failed",ye),ye}},re=async he=>{try{await Oe.deleteIncident(he),await xe(x)}catch(se){throw console.error(" delete incident failed",se),se}},G=async he=>{try{if(!x){A("Please select a station before creating a vehicle.");return}const se={...he};se.currentStationId=x,se.stationId=x,se.StationId=x,se.rentalPricePerDate!=null&&se.rentalPricePerDay==null&&(se.rentalPricePerDay=se.rentalPricePerDate),se.rentalPricePerDay!=null&&se.rentalPricePerDate==null&&(se.rentalPricePerDate=se.rentalPricePerDay),se.batteryCapacity!=null&&se.BatteryCapacity==null&&(se.BatteryCapacity=se.batteryCapacity),se.currentBatteryLevel!=null&&se.CurrentBatteryLevel==null&&(se.CurrentBatteryLevel=se.currentBatteryLevel);const ae=await Oe.createCar(se),ye=ae||{},le=Ne=>({id:Ne.id||Ne.Id||Ne.carId||Ne.CarId,name:Ne.name||Ne.Name||[Ne.brand,Ne.model].filter(Boolean).join(" ")||"Car",model:Ne.model||Ne.Model||null,brand:Ne.brand||Ne.Brand||null,licensePlate:Ne.licensePlate||Ne.LicensePlate||null,img:Ne.imageUrl||Ne.image||Ne.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Ne.name||Ne.Name||Ne.model||"Car")}`,battery:Number.isFinite(Ne.currentBatteryLevel)?Math.round(Ne.currentBatteryLevel):void 0,tech:Ne.condition??Ne.status??Ne.Status??null,issue:Ne.issue??Ne.issueDescription??null,capacity:Ne.batteryCapacity??Ne.BatteryCapacity??Ne.capacity??Ne.capacityKWh??Ne.batteryCapacityKWh??null});return a(Ne=>[...Ne,le(ye)]),await Ce(x),ae}catch(se){throw A((se==null?void 0:se.message)||"Failed to create vehicle"),se}},we=async he=>{var se;try{await Oe.deleteCar(he),a(ae=>ae.filter(ye=>ye.id!==he)),await Ce(x)}catch(ae){const ye=(se=ae==null?void 0:ae.response)==null?void 0:se.status;if(ye===401||ye===403){q("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const le=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Ne=!1;for(const Je of le)try{await Oe.updateStatus(he,Je),Ne=!0;break}catch{}if(Ne){a(Je=>Je.filter(Jn=>Jn.id!==he));return}}catch{}A((ae==null?void 0:ae.message)||"Failed to delete vehicle")}},Le=async(he,se)=>{try{if(se.battery!==void 0&&se.battery!==""){let ae=Number(se.battery);Number.isNaN(ae)||(ae=Math.max(0,Math.min(100,Math.round(ae))),await Oe.updateBatteryLevel(he,ae))}if(se.tech&&await Oe.updateStatus(he,se.tech),se.issue)try{await Oe.updateCarDescription(he,se.issue)}catch{await Oe.updateCar(he,{description:se.issue})}}catch(ae){A((ae==null?void 0:ae.message)||"Failed to update vehicle")}a(ae=>ae.map(ye=>ye.id===he?{...ye,...se}:ye))},Ce=async he=>{if(!he){M(null);return}try{const se=await Oe.getCarStatusReport(he,null);se&&M({totalCars:se.totalCars||0,availableCars:se.availableCars||0})}catch(se){console.warn("Failed to load station slots:",se)}};v.useEffect(()=>{l?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[l]),v.useEffect(()=>{try{localStorage.setItem("staff_sidebar_visible",l?"1":"0")}catch{}},[l]);const je=[{key:"booking",label:"Booking",icon:"fas fa-calendar-alt",onClick:()=>t("booking")},{key:"vehicle",label:"Vehicle",icon:"fas fa-car",onClick:()=>t("vehicle")},{key:"incident",label:"Incident",icon:"fas fa-exclamation-triangle",onClick:()=>t("incident")},{key:"profile",label:"Profile",icon:"fas fa-user-circle",onClick:()=>t("profile")}];return v.useEffect(()=>{let he=!0;async function se(){try{const ye=await authApi.getMe(),le=(ye==null?void 0:ye.role)||(ye==null?void 0:ye.Role)||(ye==null?void 0:ye.roleName)||(ye==null?void 0:ye.userRole)||(Array.isArray(ye==null?void 0:ye.roles)?ye.roles[0]:"");he&&Q(le||"")}catch{try{const ye=localStorage.getItem("token");if(ye){const le=decodeJwt(ye),Ne=(le==null?void 0:le.role)||(le==null?void 0:le.Role)||le["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];he&&Q(Ne||"")}}catch{}}}async function ae(){try{R(!0);const ye=localStorage.getItem("stationId");if(ye){console.log(" Staff assigned station from localStorage:",ye),he&&N(ye);try{const Ne=await Oe.getAllStations(1,100);he&&k(Ne||[])}catch(Ne){console.warn(" Failed to load stations for display:",Ne)}return}console.warn(" No stationId found in localStorage for staff user");const le=await Oe.getAllStations(1,100);if(!he)return;k(le||[])}catch(ye){if(!he)return;A((ye==null?void 0:ye.message)||"Failed to load stations")}finally{he&&R(!1)}}return se(),ae(),()=>{he=!1}},[]),v.useEffect(()=>{let he=!0;async function se(){try{P(!0);let ye=[];if(x){let Ie=[],$=[];try{Ie=await Oe.getCarsByStation(x)}catch{}try{$=await Oe.getAvailableCarsByStation(x)}catch{}const qe=Be=>Array.isArray(Be)?Be:Be?[Be]:[],We=qe(Ie),Ee=qe($),ee=new Map;for(const Be of[...We,...Ee]){const tt=String((Be==null?void 0:Be.id)||(Be==null?void 0:Be.Id)||(Be==null?void 0:Be.carId)||(Be==null?void 0:Be.CarId)||(Be==null?void 0:Be.licensePlate)||(Be==null?void 0:Be.LicensePlate)||Math.random());ee.has(tt)||ee.set(tt,Be)}ye=Array.from(ee.values());try{const Be=await Oe.getAllCars(1,1e3),tt=Ae=>Ae==null?"":String(Ae).replace(/[{}]/g,"").toLowerCase(),Ot=tt(x),Cn=(Be||[]).filter(Ae=>{var pr,Ur,Lt,Xe;return[Ae.currentStationId,Ae.CurrentStationId,Ae.currentStationID,Ae.stationId,Ae.StationId,Ae.stationID,(pr=Ae.station)==null?void 0:pr.id,(Ur=Ae.station)==null?void 0:Ur.Id,(Lt=Ae.station)==null?void 0:Lt.stationId,(Xe=Ae.station)==null?void 0:Xe.StationId].some(mr=>mr!=null&&tt(mr)===Ot)});for(const Ae of Cn){const Tt=String((Ae==null?void 0:Ae.id)||(Ae==null?void 0:Ae.Id)||(Ae==null?void 0:Ae.carId)||(Ae==null?void 0:Ae.CarId)||(Ae==null?void 0:Ae.licensePlate)||(Ae==null?void 0:Ae.LicensePlate));Tt&&!ee.has(Tt)&&ee.set(Tt,Ae)}ye=Array.from(ee.values())}catch{}}else try{ye=await Oe.getAllCars(1,1e3)}catch{try{ye=await Oe.listCars({page:1,pageSize:1e3})}catch{ye=[]}}if(Array.isArray(ye)||(ye=ye?[ye]:[]),!he)return;const le=Ie=>{const $=Number(Ie);return Number.isFinite($)&&$>=0&&$<=100?Math.round($):null},Ne=(ye||[]).map(Ie=>{var Be,tt,Ot,Cn;const qe=((...Ae)=>Ae.find(Tt=>Tt!=null&&Tt!==""))(Ie.currentStationId,Ie.CurrentStationId,Ie.currentStationID,Ie.stationId,Ie.StationId,Ie.stationID,(Be=Ie.station)==null?void 0:Be.id,(tt=Ie.station)==null?void 0:tt.Id,(Ot=Ie.station)==null?void 0:Ot.stationId,(Cn=Ie.station)==null?void 0:Cn.StationId),We=Ae=>Ae==null?"":String(Ae).replace(/[{}]/g,"").toLowerCase(),Ee=qe||"",ee=(()=>{if(!Ee)return null;const Ae=y.find(Tt=>We(Tt.id||Tt.Id)===We(Ee))||null;return Ae&&(Ae.name||Ae.Name)||null})();return{id:Ie.id||Ie.Id||Ie.carId||Ie.CarId,name:Ie.name||Ie.Name||Ie.model||Ie.CarName||"Car",model:Ie.model||Ie.Model||null,brand:Ie.brand||Ie.Brand||null,licensePlate:Ie.licensePlate||Ie.LicensePlate||null,img:Ie.imageUrl||Ie.image||Ie.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Ie.name||Ie.Name||"Car")}`,battery:le(Ie.currentBatteryLevel??Ie.CurrentBatteryLevel??Ie.batteryPercent??Ie.battery),tech:Ie.condition??Ie.status??Ie.Status??null,issue:Ie.issue??Ie.issueDescription??null,capacity:Ie.batteryCapacity??Ie.BatteryCapacity??Ie.capacity??Ie.capacityKWh??Ie.batteryCapacityKWh??null,stationId:Ee,stationName:ee||null}});a(Ne);const Je=Ne.filter(Ie=>Ie.battery==null),Jn=Ne.filter(Ie=>Ie.capacity==null);if(Je.length>0)try{const Ie=await Promise.all(Je.map(async $=>{try{const qe=await Oe.getCarBattery($.id);return{id:$.id,battery:le(qe)}}catch{return{id:$.id,battery:null}}}));if(!he)return;a($=>$.map(qe=>{const We=Ie.find(Ee=>Ee.id===qe.id);return We&&We.battery!=null?{...qe,battery:We.battery}:qe}))}catch{}if(Jn.length>0)try{const Ie=await Promise.all(Jn.map(async $=>{try{const qe=await Oe.getCarCapacity($.id);return{id:$.id,capacity:qe}}catch{return{id:$.id,capacity:null}}}));if(!he)return;a($=>$.map(qe=>{const We=Ie.find(Ee=>Ee.id===qe.id);return We&&We.capacity!=null?{...qe,capacity:We.capacity}:qe}))}catch{}}catch(ye){if(!he)return;A((ye==null?void 0:ye.message)||"Failed to load vehicles")}finally{he&&P(!1)}}async function ae(){he&&await Ce(x)}return se(),ae(),()=>{he=!1}},[x,y]),v.useEffect(()=>{let he=!0;async function se(){try{U(!0);let ae=[];if(x){console.log(" Loading active bookings for station:",x);try{ae=await Oe.getBookingsByStation(x,1,200),console.log(" Loaded active bookings:",ae==null?void 0:ae.length)}catch($){console.error(" Error loading bookings:",$),ae=[]}}else console.warn(" No station ID set"),ae=[];if(!he)return;const ye=(ae||[]).map($=>{var Bt,ke,nt,ft,Z,Re,De,ge,D,Ge,ot,Pe,gt,Ht,gn,an,Qn,Jt,Nt,kt,Fn,gi,qi,gr,yi,vi,xi,_i,wi,yr,Un,Or,zr,On,He,it,Xn,Nn,kn,vr,Fe,lt,xr,er,Rt,ji,tr;const qe=$.id||$.Id||$.bookingId||$.BookingId,We=((Bt=$.car)==null?void 0:Bt.brand)||((ke=$.car)==null?void 0:ke.Brand)||((nt=$.vehicle)==null?void 0:nt.brand)||((ft=$.vehicle)==null?void 0:ft.Brand)||$.carBrand||$.CarBrand||null,Ee=((Z=$.car)==null?void 0:Z.model)||((Re=$.car)==null?void 0:Re.Model)||((De=$.vehicle)==null?void 0:De.model)||((ge=$.vehicle)==null?void 0:ge.Model)||$.carModel||$.CarModel||null;let ee=$.carName||$.vehicleName||((D=$.car)==null?void 0:D.name)||((Ge=$.car)==null?void 0:Ge.Name)||null;!ee&&(We||Ee)&&(ee=[We,Ee].filter(Boolean).join(" ").trim()||null),!ee&&typeof $.carInfo=="string"&&$.carInfo.trim()&&(ee=$.carInfo.trim()),!ee&&typeof $.CarInfo=="string"&&$.CarInfo.trim()&&(ee=$.CarInfo.trim()),ee=ee||"Booking";const Be=((ot=$.user)==null?void 0:ot.firstName)||((Pe=$.customer)==null?void 0:Pe.firstName)||$.firstName||$.FirstName||((gt=$.user)==null?void 0:gt.FirstName)||((Ht=$.customer)==null?void 0:Ht.FirstName),tt=((gn=$.user)==null?void 0:gn.lastName)||((an=$.customer)==null?void 0:an.lastName)||$.lastName||$.LastName||((Qn=$.user)==null?void 0:Qn.LastName)||((Jt=$.customer)==null?void 0:Jt.LastName),Ot=[Be,tt].filter(Boolean).join(" "),Cn=Ot||$.customerName||$.userFullName||((Nt=$.user)==null?void 0:Nt.fullName)||((kt=$.customer)==null?void 0:kt.name)||((Fn=$.user)==null?void 0:Fn.name)||"Customer",Ae=$.userId||$.UserId||((gi=$.user)==null?void 0:gi.id)||((qi=$.user)==null?void 0:qi.Id)||$.customerId||$.CustomerId||$.appUserId||$.AppUserId||$.accountId||$.AccountId||$.UserID||$.ownerId||$.OwnerId||$.createdById||$.CreatedById||"",Tt=((gr=$.user)==null?void 0:gr.userName)||((yi=$.user)==null?void 0:yi.UserName)||((vi=$.user)==null?void 0:vi.username)||$.userName||$.UserName||$.username||null,pr=((xi=$.user)==null?void 0:xi.email)||$.customerEmail||$.email||$.userEmail||"",Ur=((_i=$.user)==null?void 0:_i.address)||$.customerAddress||$.address||"",Lt=$.statusCode??$.StatusCode??$.bookingStatus??$.BookingStatus??$.status??$.Status;let Xe="booked";if(Lt!=null&&(typeof Lt=="number"||/^\d+$/.test(String(Lt)))){const Ye=Number(Lt);Ye===0?Xe="pending":Ye===1?Xe="booked":Ye===2?Xe="waiting-checkin":Ye===3?Xe="checked-in":Ye===4?Xe="checkout-pending":Ye===5?Xe="completed":Ye===6?Xe="cancelled-pending":Ye===7&&(Xe="cancelled")}else{const Ye=String(Lt||"").toLowerCase();Ye.includes("pending")||Ye.includes("wait")?Xe="pending":Ye.includes("check")&&Ye.includes("in")?Xe="checked-in":Ye.includes("complete")||Ye.includes("finish")?Xe="completed":Ye.includes("cancel")?Xe="cancelled":Xe="booked"}const mr=Xe==="pending"?"Pending":Xe==="booked"?"Active Rental":Xe==="waiting-checkin"?"Waiting Check-in":Xe==="checked-in"?"Checked-in":Xe==="checkout-pending"?"Check-out Pending":Xe==="completed"?"Completed":Xe==="cancelled-pending"?"Cancelled (Pending Refund)":Xe==="cancelled"?"Cancelled":String(Lt||"")||"Booked",Mn=String(Lt||"").toLowerCase(),Vi=Number(Lt)===0||Mn.includes("pending")||Mn.includes("wait")?"waiting-payment":Mn.includes("check")&&Mn.includes("in")&&(Mn.includes("pay")||Mn.includes("payment"))?"checkin-payment":null;let Y=$.date||$.createdAt||$.bookingDate||"";if(Y)try{const Ye=new Date(Y);isNaN(Ye.getTime())||(Y=Ye.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:void 0}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5"))}catch{}const X=$.carImageUrl||((wi=$.car)==null?void 0:wi.imageUrl)||((yr=$.vehicle)==null?void 0:yr.imageUrl)||`https://via.placeholder.com/440x280?text=${encodeURIComponent(ee)}`,de=Ye=>{if(!Ye)return null;try{const ct=new Date(Ye);if(!isNaN(ct.getTime()))return ct.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5")}catch{}return Ye},fe=de($.pickupDate||$.rentalStartDate||$.startDateTime||$.startDate),_e=de($.returnDate||$.rentalEndDate||$.endDateTime||$.endDate);return{id:qe,title:ee,firstName:Be||null,lastName:tt||null,fullName:Ot||$.userFullName||((Un=$.user)==null?void 0:Un.fullName)||((Or=$.customer)==null?void 0:Or.name)||((zr=$.user)==null?void 0:zr.name)||null,customer:Cn,userId:Ae,userName:Tt,email:pr,address:Ur,status:Xe,statusLabel:mr,uiStage:Vi,date:Y,pickupDate:fe,returnDate:_e,img:X,carId:$.carId||$.CarId||((On=$.car)==null?void 0:On.id)||((He=$.car)==null?void 0:He.Id)||((it=$.vehicle)==null?void 0:it.id)||((Xn=$.vehicle)==null?void 0:Xn.Id)||null,cccdFrontUrl:$.cccdFrontUrl||$.identityFrontUrl||$.idFrontUrl||$.frontImageUrl||$.frontIdUrl||$.cccdFrontImageUrl||((Nn=$.customer)==null?void 0:Nn.cccdFrontUrl)||((kn=$.user)==null?void 0:kn.cccdFrontUrl),cccdBackUrl:$.cccdBackUrl||$.identityBackUrl||$.idBackUrl||$.backImageUrl||$.backIdUrl||$.cccdBackImageUrl||((vr=$.customer)==null?void 0:vr.cccdBackUrl)||((Fe=$.user)==null?void 0:Fe.cccdBackUrl),gplxFrontUrl:$.gplxFrontUrl||$.driverLicenseFrontUrl||$.gplxImageUrl_Front||((lt=$.customer)==null?void 0:lt.gplxImageUrl_Front)||((xr=$.user)==null?void 0:xr.gplxImageUrl_Front),gplxBackUrl:$.gplxBackUrl||$.driverLicenseBackUrl||$.gplxImageUrl_Back||((er=$.customer)==null?void 0:er.gplxImageUrl_Back)||((Rt=$.user)==null?void 0:Rt.gplxImageUrl_Back),idString:$.customerIdNumber||((ji=$.user)==null?void 0:ji.identityNumber)||"",phone:$.customerPhone||((tr=$.user)==null?void 0:tr.phoneNumber)||""}});s(ye);const le=ye.filter($=>$.userId&&!($.firstName&&$.lastName));if(le.length>0)try{const $=Array.from(new Set(le.map(Ee=>Ee.userId))),qe=await Promise.all($.map(async Ee=>{try{const ee=await Oe.getUserById(Ee),Be=(ee==null?void 0:ee.firstName)||(ee==null?void 0:ee.FirstName)||(ee==null?void 0:ee.givenName)||(ee==null?void 0:ee.GivenName)||null,tt=(ee==null?void 0:ee.lastName)||(ee==null?void 0:ee.LastName)||(ee==null?void 0:ee.surname)||(ee==null?void 0:ee.Surname)||null,Ot=(ee==null?void 0:ee.fullName)||(ee==null?void 0:ee.FullName)||[Be,tt].filter(Boolean).join(" ")||null,Cn=(ee==null?void 0:ee.userName)||(ee==null?void 0:ee.UserName)||(ee==null?void 0:ee.username)||(ee==null?void 0:ee.user_name)||null,Ae=(ee==null?void 0:ee.address)||(ee==null?void 0:ee.Address)||"";return{uid:Ee,firstName:Be,lastName:tt,fullName:Ot,userName:Cn,address:Ae}}catch{return{uid:Ee,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!he)return;const We=new Map(qe.map(Ee=>[Ee.uid,Ee]));s(Ee=>Ee.map(ee=>{if(ee.userId&&We.has(ee.userId)){const Be=We.get(ee.userId),tt=ee.fullName||Be.fullName||[Be.firstName,Be.lastName].filter(Boolean).join(" ");return{...ee,firstName:ee.firstName??Be.firstName??null,lastName:ee.lastName??Be.lastName??null,fullName:tt||ee.customer||ee.userName||null,userName:ee.userName??Be.userName,address:ee.address||Be.address}}return ee}))}catch{}const Ne=$=>{var qe,We,Ee,ee;return $.carId||$.CarId||$.vehicleId||$.VehicleId||((qe=$.car)==null?void 0:qe.id)||((We=$.car)==null?void 0:We.Id)||((Ee=$.vehicle)==null?void 0:Ee.id)||((ee=$.vehicle)==null?void 0:ee.Id)},Je=ye.filter($=>(!$.title||$.title==="Booking")&&Ne($));if(Je.length>0)try{const $=Array.from(new Set(Je.map(Ne).filter(Boolean))),qe=await Promise.all($.map(async Ee=>{try{let ee=await Oe.getCarById(Ee);if(!ee||!ee.id&&!ee.Id)try{ee=await Oe.getCarByIdRest(Ee)}catch{}const Be=(ee==null?void 0:ee.name)||(ee==null?void 0:ee.Name)||[ee==null?void 0:ee.brand,ee==null?void 0:ee.model].filter(Boolean).join(" ")||null,tt=(ee==null?void 0:ee.imageUrl)||(ee==null?void 0:ee.thumbnailUrl)||null;return{cid:Ee,name:Be,img:tt}}catch{return{cid:Ee,name:null,img:null}}})),We=new Map(qe.map(Ee=>[String(Ee.cid),Ee]));s(Ee=>Ee.map(ee=>{const Be=Ne(ee),tt=Be!=null?String(Be):null;if(tt&&We.has(tt)){const Ot=We.get(tt);return{...ee,title:ee.title&&ee.title!=="Booking"?ee.title:Ot.name||ee.title,img:ee.img||Ot.img||ee.img}}return ee}))}catch{}const Ie=($=>$.filter(qe=>!qe.title||qe.title==="Booking"))(ye);if(Ie.length>0)try{const $=await Promise.all(Ie.map(async We=>{try{const Ee=await Oe.getVehicleModelFromBooking(We.id),ee=(Ee==null?void 0:Ee.name)||[Ee==null?void 0:Ee.brand,Ee==null?void 0:Ee.model].filter(Boolean).join(" ")||null;return{id:We.id,title:ee}}catch{return{id:We.id,title:null}}})),qe=new Map($.map(We=>[We.id,We.title]));s(We=>We.map(Ee=>qe.has(Ee.id)&&qe.get(Ee.id)?{...Ee,title:qe.get(Ee.id)}:Ee))}catch{}}catch(ae){if(!he)return;A((ae==null?void 0:ae.message)||"Failed to load bookings")}finally{he&&U(!1)}}return se(),()=>{he=!1}},[x]),v.useEffect(()=>{xe(x)},[x]),r.jsxs("div",{className:"app-layout",children:[r.jsx(_S,{toggleSidebar:()=>d(he=>!he),sidebarVisible:l}),r.jsx("div",{className:`sidebar-wrapper ${l?"visible":""}`,children:r.jsx(by,{title:"FEC Staff",menuItems:je,isOpen:l,toggleSidebar:()=>d(he=>!he),onSelect:t,activeKey:e})}),r.jsxs("main",{className:`main-content ${l?"shifted":""}`,children:[H&&r.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:H}),E&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:E}),e==="booking"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((ze=y.find(he=>(he.id||he.Id)===x))==null?void 0:ze.name)||((me=y.find(he=>(he.id||he.Id)===x))==null?void 0:me.Name)||x}),B&&r.jsx("span",{children:"Loading bookings"})]}),!B&&n.length===0&&r.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),r.jsx(LS,{bookings:n,search:u,setSearch:f,statusFilter:m,setStatusFilter:g,onContinuePayment:W,onCancelBooking:ue,onStatusUpdated:ne})]}),e==="vehicle"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((et=y.find(he=>(he.id||he.Id)===x))==null?void 0:et.name)||((mn=y.find(he=>(he.id||he.Id)===x))==null?void 0:mn.Name)||x}),b&&r.jsx("span",{children:"Loading vehicles"})]}),r.jsx(AS,{vehicles:o,onAdd:G,onRemove:we,onUpdate:Le,stationId:x,canDelete:String(O).toLowerCase()==="admin",stationSlots:ie})]}),e==="incident"&&r.jsx(OS,{incidents:S,bookings:n,onCreateIncident:ve,onUpdateIncident:ce,onResolveIncident:z,onDeleteIncident:re,onRefresh:async()=>{await xe(x)},canDelete:!0,stationFilter:x}),e==="profile"&&r.jsx(FS,{})]})]})}const WS="modulepreload",HS=function(e){return"/"+e},xp={},ZS=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=HS(u),u in xp)return;xp[u]=!0;const f=u.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":WS,f||(g.as="script"),g.crossOrigin="",g.href=u,d&&g.setAttribute("nonce",d),document.head.appendChild(g),f)return new Promise((y,k)=>{g.addEventListener("load",y),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return o.then(l=>{for(const d of l||[])d.status==="rejected"&&a(d.reason);return t().catch(a)})};function VS({toggleSidebar:e,sidebarVisible:t}){return r.jsxs("header",{className:"header-bar",children:[r.jsx("div",{className:"header-left",children:r.jsx("button",{className:"sidebar-toggle","aria-label":t?"Close sidebar":"Open sidebar",onClick:e,children:r.jsx("i",{className:t?"fas fa-times":"fas fa-bars"})})}),r.jsx("div",{className:"header-title",children:"Admin Page"}),r.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}const Pc={createStation:async e=>{if(!e)throw new Error("station is required");try{const t=await te.post("/Stations/Create",e,{headers:{"Content-Type":"application/json"}}),n=t==null?void 0:t.data;if(n&&typeof n=="object"&&"data"in n){if(n.isSuccess===!1){const s=n.message||(Array.isArray(n.errors)?n.errors.join("; "):"Request failed"),o=new Error(s);throw o.body=n,o}return n.data}return n}catch(t){throw t}},updateStation:async(e,t)=>{if(!e)throw new Error("stationId is required");if(!t)throw new Error("station payload is required");const s=`/Stations/Update-By-${encodeURIComponent(e)}`;try{const o=await te.put(s,t,{headers:{"Content-Type":"application/json"}}),a=o==null?void 0:o.data;if(a&&typeof a=="object"&&"data"in a){if(a.isSuccess===!1){const l=a.message||(Array.isArray(a.errors)?a.errors.join("; "):"Request failed"),d=new Error(l);throw d.body=a,d}return a.data}return a}catch(o){throw o}},deleteStation:async e=>{if(!e)throw new Error("stationId is required");const n=`/Stations/Delete-By-${encodeURIComponent(e)}`;try{const s=await te.delete(n),o=s==null?void 0:s.data;if(o&&typeof o=="object"&&"data"in o){if(o.isSuccess===!1){const a=o.message||(Array.isArray(o.errors)?o.errors.join("; "):"Request failed"),l=new Error(a);throw l.body=o,l}return o.data}return o}catch(s){throw s}}},Ec={getFeedbacks:async(e={page:1,pageSize:10,search:"",sortBy:""})=>{var n;const t={pageNumber:e.page??e.pageNumber??1,pageSize:e.pageSize??10};e.search&&(t.search=e.search),e.sortBy&&(t.sortBy=e.sortBy);try{const s=await te.get("/Feedback/Get-All",{params:t}),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(n=s==null?void 0:s.response)==null?void 0:n.status;if(o&&o!==404&&o!==405)throw s;return{items:[],totalCount:0}}}},Te={confirmBooking:en.confirmBooking,cancelBooking:en.cancelBooking,completeBooking:en.completeBooking,getBookingById:en.getBookingById,listBookings:async(e={})=>{var t;try{const{page:n=1,pageSize:s=100}=e;console.log(` Listing bookings: page=${n}, pageSize=${s}`);const o=await te.get("/Bookings/Get-All",{params:{pageNumber:n,pageSize:s}}),a=o==null?void 0:o.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(t=a==null?void 0:a.data)!=null&&t.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No bookings array found in listBookings response"),[])}catch(n){return console.error(" Error listing bookings:",n.message),[]}},createCar:rt.createCar,deleteCar:rt.deleteCar,updateCar:rt.updateCar,updateStatus:rt.updateStatus,updateBatteryLevel:rt.updateBatteryLevel,updateCarDescription:rt.updateCarDescription,getAllCars:rt.getAllCars,getCarById:rt.getCarById,getAvailableCarsByStation:rt.getAvailableCarsByStation,getCarStatusReport:Oe.getCarStatusReport,getCarsByStation:Oe.getCarsByStation,getAllStations:Oe.getAllStations,getBookingsByStation:Oe.getBookingsByStation,createStation:Pc.createStation,updateStation:Pc.updateStation,deleteStation:Pc.deleteStation,getFeedbacks:(Ec==null?void 0:Ec.getFeedbacks)||(async e=>{try{const t=await te.get("/Feedback/Get-All",{params:{pageNumber:(e==null?void 0:e.page)??1,pageSize:(e==null?void 0:e.pageSize)??10,search:(e==null?void 0:e.search)||""}}),n=t==null?void 0:t.data;return n&&typeof n=="object"&&"data"in n?n.data:n||{items:[],totalCount:0}}catch(t){return console.warn(" Failed to load feedbacks:",t.message),{items:[],totalCount:0}}}),getAllUsers:async(e=1,t=100,n=null)=>{var a,l;const s={pageNumber:e,pageSize:t};n&&(s.role=n);const o=[{url:"/Users/Get-All",params:s},{url:"/Admin/Users",params:s},{url:"/users",params:s}];for(const d of o)try{const u=await te.get(d.url,{params:d.params}),f=u==null?void 0:u.data;if(Array.isArray(f))return f;if(Array.isArray((a=f==null?void 0:f.data)==null?void 0:a.data))return f.data.data;if(Array.isArray(f==null?void 0:f.data))return f.data;if(Array.isArray(f==null?void 0:f.items))return f.items}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}return[]},assignStaffRole:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Assign-Staff-Role${s}`,`/Users/${n}/Assign-Staff-Role${s}`,`/Admin/Users/Assign-Staff-Role${s}`];for(const l of o)try{const d=await te.post(l,t?{userId:e,reason:t}:{userId:e}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Assign staff role endpoint not found")},removeStaffRole:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Remove-Staff-Role${s}`,`/Users/${n}/Remove-Staff-Role${s}`,`/Admin/Users/Remove-Staff-Role${s}`];for(const l of o)try{const d=await te.post(l,t?{userId:e,reason:t}:{userId:e}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Remove staff role endpoint not found")},getStaffByStation:async e=>{var s;if(!e)return[];const t=encodeURIComponent(e),n=[`/Admin/Staff/By-Station/${t}`,`/Staff/By-Station/${t}`,{url:"/Admin/Staff/By-Station",params:{stationId:e}}];for(const o of n)try{const a=typeof o=="string"?await te.get(o):await te.get(o.url,{params:o.params}),l=a==null?void 0:a.data;if(Array.isArray(l))return l;if(Array.isArray(l==null?void 0:l.data))return l.data;if(Array.isArray(l==null?void 0:l.items))return l.items}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return[]},getStationByStaff:async e=>{var s;if(!e)throw new Error("staffId is required");const t=encodeURIComponent(e),n=[`/Admin/Staff/${t}/Station`,`/Staff/${t}/Station`,`/Admin/Users/${t}/Station`,`/Users/${t}/Station`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},getCustomerProfile:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Customers/${t}/Profile`,`/Admin/Users/${t}/Profile`,`/Users/${t}/Profile`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Customer profile endpoint not found")},getUserDocuments:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Documents`,`/Users/${t}/Documents`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("User documents endpoint not found")},softDeleteUser:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Soft-Delete${s}`,`/Users/${n}/Soft-Delete${s}`];for(const l of o)try{const d=await te.post(l,t?{reason:t}:{}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Soft delete user endpoint not found")},restoreUser:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Restore`,`/Users/${t}/Restore`];for(const o of n)try{const a=await te.post(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Restore user endpoint not found")},getDeletedAccounts:async(e=1,t=20,n=null)=>{var a;(!e||e<1)&&(e=1),(!t||t<1)&&(t=20);const s=new URLSearchParams({page:e.toString(),pageSize:t.toString()});n&&s.append("role",n);const o=[`/Admin/Users/Deleted-Accounts?${s}`,`/Users/Deleted-Accounts?${s}`];for(const l of o)try{const d=await te.get(l),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;return(f==null?void 0:f.deletedAccounts)||f||[]}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Get deleted accounts endpoint not found")},getAdminDashboard:async()=>{var t;const e=["/Admin/Dashboard","/Dashboard"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}throw new Error("Dashboard endpoint not found")},getFleetOverview:async()=>{var t;const e=["/Admin/Fleet/Overview","/Fleet/Overview"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}return null},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Te.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},transferCar:async(e,t,n="")=>{var a;if(!e||!t)throw new Error("carId and targetStationId are required");const s={carId:e,targetStationId:t};n&&(s.reason=n);const o=["/Admin/Fleet/Transfer-Car","/Fleet/Transfer-Car"];for(const l of o)try{const d=await te.post(l,null,{params:s}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Transfer car endpoint not found")},assignStaffToStation:async(e,t)=>{var s;if(!e||!t)throw new Error("stationId and staffId are required");const n=[{url:`/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}},{url:`/Admin/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}}];for(const o of n)try{const a=await te.post(o.url,null,{params:o.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Assign staff to station endpoint not found")},unassignStaffFromStation:async e=>{var n;if(!e)throw new Error("staffId is required");const t=[{url:"/Stations/Unassign-Staff",params:{staffId:e}},{url:"/Admin/Stations/Unassign-Staff",params:{staffId:e}}];for(const s of t)try{const o=await te.post(s.url,null,{params:s.params}),a=o==null?void 0:o.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(o){const a=(n=o==null?void 0:o.response)==null?void 0:n.status;if(a&&a!==404&&a!==405)throw o}throw new Error("Unassign staff from station endpoint not found")},reassignStaff:async(e,t)=>{var s;if(!e||!t)throw new Error("staffId and toStationId are required");const n=[{url:"/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}},{url:"/Admin/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}}];for(const o of n)try{const a=await te.post(o.url,null,{params:o.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Reassign staff endpoint not found")},post:async(e,t,n={})=>{const s=await te.post(e,t,n);return s==null?void 0:s.data},get:async(e,t={})=>{const n=await te.get(e,t);return n==null?void 0:n.data},put:async(e,t,n={})=>{const s=await te.put(e,t,n);return s==null?void 0:s.data},patch:async(e,t,n={})=>{const s=await te.patch(e,t,n);return s==null?void 0:s.data},delete:async(e,t={})=>{const n=await te.delete(e,t);return n==null?void 0:n.data}};async function qS(e){if(!e)throw new Error("accessToken is required");const t=`${Hi}/Admin/Dashboard`,n=await fetch(t,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${e}`}});if(!n.ok){const s=await n.text();throw new Error(`Request failed: ${n.status} ${s}`)}return n.json()}Te.getAdminDashboardWithToken=qS;function GS({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:o}){var xe,ce;const[a,l]=v.useState(!1),[d,u]=v.useState(!1),[f,m]=v.useState(!1),[g,y]=v.useState(!1),[k,S]=v.useState(""),[_,C]=v.useState(!1),[j,x]=v.useState(!1),[N,b]=v.useState(null),[P,T]=v.useState(!1),[R,B]=v.useState(null),[U,E]=v.useState(""),[A,H]=v.useState(""),[q,O]=v.useState(""),[Q,ie]=v.useState(null);if(v.useEffect(()=>{if(!e)return;l(!1),u(!1),m(!1),y(!1),S(""),ie(null);const z=e.carId||e.CarId;z&&rt.getCarById(z).then(je=>{const ze=(je==null?void 0:je.imageUrl)||(je==null?void 0:je.ImageUrl)||"/Picture/E car 1.jpg";ie(ze),console.log(" Loaded car image:",ze)}).catch(je=>{console.warn(" Failed to load car image:",je.message),ie("/Picture/E car 1.jpg")});const re=(je,ze)=>[je,ze].filter(Boolean).join(" "),G=e.fullName||re(e.firstName,e.lastName);if(!(!G||/^customer$/i.test(G)||G==="")){S(G);return}if(!e.id)return;let Le=!1;async function Ce(){C(!0);try{const{firstName:je,lastName:ze}=await Te.getUserNameByBookingId(e.id);Le||S(re(je,ze))}catch{}finally{Le||C(!1)}}return Ce(),()=>{Le=!0}},[e]),!e)return null;const M=(e==null?void 0:e.status)==="booked"?a&&d:!1,W=()=>{if(!e)return;const z=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,z)},ue=async()=>{var z,re,G,we,Le;if(e!=null&&e.id){E(""),x(!0);try{const Ce=await Te.createPayment(e.id,"Rental","Rental payment at check-in");try{localStorage.setItem("currentBookingId",e.id)}catch{}const je=(Ce==null?void 0:Ce.checkoutUrl)||((z=Ce==null?void 0:Ce.data)==null?void 0:z.checkoutUrl)||(Ce==null?void 0:Ce.url)||"",ze=(Ce==null?void 0:Ce.qrCode)||((re=Ce==null?void 0:Ce.data)==null?void 0:re.qrCode)||"";if(H(je),O(ze),b(Ce),je)try{window.open(je,"_blank","noopener,noreferrer")}catch{}}catch(Ce){const je=(G=Ce==null?void 0:Ce.response)==null?void 0:G.status;if(je&&je!==400&&je!==409){x(!1),E(((Le=(we=Ce==null?void 0:Ce.response)==null?void 0:we.data)==null?void 0:Le.message)||(Ce==null?void 0:Ce.message)||"Failed to create payment");return}}x(!1)}},ne=async()=>{var z,re;if(e!=null&&e.id){E(""),x(!0);try{await Te.syncPaymentStatus(e.id),B(new Date);const G=await Te.getBookingById(e.id),we=(G==null?void 0:G.statusCode)??(G==null?void 0:G.StatusCode)??(G==null?void 0:G.bookingStatus)??(G==null?void 0:G.BookingStatus)??(G==null?void 0:G.status)??(G==null?void 0:G.Status),Le=SS(we);if(Le&&Le!==e.status){o==null||o(e.id,Le),t==null||t();return}alert("Synced. Status unchanged; try again shortly if the gateway is still processing.")}catch(G){E(((re=(z=G==null?void 0:G.response)==null?void 0:z.data)==null?void 0:re.message)||(G==null?void 0:G.message)||"Retry sync failed")}finally{x(!1)}}},ve=async()=>{var z,re;if(e!=null&&e.id){T(!0),E("");try{const G=await Te.getPaymentByBooking(e.id);b(G)}catch(G){E(((re=(z=G==null?void 0:G.response)==null?void 0:z.data)==null?void 0:re.message)||(G==null?void 0:G.message)||"Unable to load payment info")}finally{T(!1)}}};return r.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:r.jsx("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:r.jsxs(Py,{booking:e,onClose:t,actions:null,children:[r.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("img",{id:"modalImage",src:Q||"/Picture/E car 1.jpg",alt:"Vehicle",onError:z=>z.currentTarget.src="/Picture/E car 1.jpg",style:{width:"100%",height:160,borderRadius:8,objectFit:"cover",display:"block"}}),r.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),r.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),r.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((xe=e.car)==null?void 0:xe.name)||((ce=e.car)==null?void 0:ce.Name)||""]}),r.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(_?"Loading":"")]}),r.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",Ey(e.date)]})]}),r.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:e.idString||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Address:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:e.address||""})})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"CCCD Images:"}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),e.cccdFrontUrl?r.jsx("a",{href:e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:a,onChange:z=>l(z.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),e.cccdBackUrl?r.jsx("a",{href:e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:d,onChange:z=>u(z.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Driver License (GPLX) Images:"}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),e.gplxFrontUrl?r.jsx("a",{href:e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:z=>m(z.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),e.gplxBackUrl?r.jsx("a",{href:e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:g,onChange:z=>y(z.target.checked)})," Verified"]})]})]})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{id:"customerPhone",style:{padding:6},children:e.phone||""}),e.phone&&r.jsx("a",{href:`tel:${e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!M,style:{background:M?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),r.jsx("button",{onClick:W,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:ue,disabled:j,style:{background:"#43a047",color:"#fff",padding:"8px 16px",borderRadius:14},children:j?"Processing":"Confirm Check In"}),r.jsx("button",{onClick:ne,disabled:j,style:{background:"#1565c0",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Retry Sync"}),r.jsx("button",{onClick:ve,disabled:P,style:{background:"#455a64",color:"#fff",padding:"8px 16px",borderRadius:14},children:P?"Loading":"View Payment Status"})]})]}),U&&r.jsx("div",{style:{marginTop:8,color:"#b00020"},children:U}),R&&r.jsxs("div",{style:{marginTop:4,color:"#555",fontSize:12},children:["Last sync: ",R.toLocaleTimeString()]}),(q||A)&&r.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #e0e0e0",borderRadius:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Complete Payment"}),q?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("img",{alt:"Pay QR",src:q,style:{width:160,height:160,objectFit:"contain",border:"1px solid #eee",borderRadius:6}}),r.jsx("div",{style:{color:"#555"},children:'Scan the QR to pay. After payment completes, use "Retry Sync" to update the booking.'})]}):r.jsx("div",{style:{color:"#555"},children:'Open the checkout to complete your payment, then return and press "Retry Sync".'}),A&&r.jsx("div",{style:{marginTop:10},children:r.jsx("a",{href:A,target:"_blank",rel:"noreferrer",style:{background:"#1565c0",color:"#fff",padding:"8px 14px",borderRadius:10,textDecoration:"none"},children:"Open Checkout"})})]}),N&&r.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #eee",borderRadius:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Payment"}),r.jsxs("div",{children:["Status: ",String(N.status||N.Status||N.paymentStatus||"")]}),r.jsxs("div",{children:["Gateway: ",String(N.gatewayStatus||N.GatewayStatus||N.providerStatus||"")]}),r.jsxs("div",{children:["Amount: ",N.amount??N.Amount??""]}),r.jsxs("div",{children:["Transaction: ",N.transactionId||N.TransactionId||N.txnId||""]}),r.jsxs("div",{children:["Updated: ",N.updatedAt||N.UpdatedAt||N.lastUpdated||""]})]})]})]}),r.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[r.jsx("h4",{children:"Transaction Details"}),r.jsxs("ul",{style:{fontSize:"1rem"},children:[r.jsx("li",{children:"Find rental location on map"}),r.jsx("li",{children:"View available vehicles (type, battery, price)"}),r.jsx("li",{children:"Book in advance or on-site"}),r.jsx("li",{children:"Check-in at counter/app"}),r.jsx("li",{children:"Sign electronic contract"}),r.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),r.jsx("li",{children:"Return vehicle at rental location"}),r.jsx("li",{children:"Staff checks and confirms vehicle condition"}),r.jsx("li",{children:"Pay any additional fees"})]})]})]})})})}function YS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onContinuePayment:a,onCancelBooking:l,onStatusUpdated:d}){const[u,f]=v.useState(null),[m,g]=v.useState(null),y=e.filter(S=>(S.title.toLowerCase().includes(t.toLowerCase())||(S.customer||"").toLowerCase().includes(t.toLowerCase())||(S.userName||"").toLowerCase().includes(t.toLowerCase())||(S.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||S.status===s)),k=S=>r.jsx(Ud,{booking:S,onClick:()=>f(S)},S.id);return r.jsxs(r.Fragment,{children:[r.jsx(Ly,{bookings:y,renderBookingCard:k,search:t,setSearch:n,statusFilter:s,setStatusFilter:o}),r.jsx(GS,{booking:u,onClose:()=>f(null),onProceed:()=>{u&&(g(u),f(null))},onCancel:()=>{u&&(l==null||l(u))},onStatusUpdated:d}),m&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:()=>g(null),children:""}),r.jsx(Ud,{booking:m,onClick:()=>f(m)})]})})]})}function KS({vehicle:e,onOpen:t}){return r.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[r.jsx("img",{src:e.img,alt:e.name}),r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-title",children:e.name}),r.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),r.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),r.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),r.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function JS({open:e,onClose:t,onSubmit:n,stationId:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,k]=v.useState(""),[S,_]=v.useState(""),[C,j]=v.useState(""),[x,N]=v.useState(""),[b,P]=v.useState(""),[T,R]=v.useState(""),[B,U]=v.useState(null),[E,A]=v.useState(""),H=5*1024*1024,q=["image/jpeg","image/png","image/webp","image/jpg"];if(!e)return null;async function O(){if(A(""),!s){A("Please select a station before creating a vehicle.");return}if(!o.trim()||!l.trim()||!m.trim()||!y.trim()||!u||!S||!C||!x||!b||!T){A("Please fill all required fields: Brand, Model, Color, Year, License Plate, Battery Capacity, Current Battery, Seats, Price/hour, Price/day.");return}const Q=Number(u),ie=Number(S),M=Number(C),W=Number(x),ue=Number(b),ne=Number(T);if(!Number.isFinite(Q)||Q<1900||Q>2100){A("Year must be between 1900 and 2100.");return}if(!Number.isFinite(ie)||ie<0||ie>1e4){A("Battery Capacity must be a positive number (kWh).");return}if(!Number.isFinite(M)||M<0||M>100){A("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(W)||W<=0||!Number.isFinite(ue)||ue<=0){A("Rental prices must be positive numbers.");return}if(!Number.isFinite(ne)||ne<=0){A("Seats must be a positive number.");return}if(B){if(!q.includes(B.type)){A(`Invalid file type. Allowed: ${q.join(", ")}`);return}if(B.size>H){A(`File size must be less than ${H/1024/1024}MB. Current: ${(B.size/1024/1024).toFixed(2)}MB`);return}}const ve=new FormData;ve.append("Brand",o.trim()),ve.append("Model",l.trim()),ve.append("Year",Q),ve.append("Color",m.trim()),ve.append("LicensePlate",y.trim()),ve.append("BatteryCapacity",ie),ve.append("CurrentBatteryLevel",M),ve.append("RentalPricePerHour",W),ve.append("RentalPricePerDay",ue),ve.append("Seats",ne),ve.append("CurrentStationId",s),B&&(ve.append("CarImage",B,B.name),console.log(" Added CarImage:",B.name,"size:",B.size,"type:",B.type));try{await n(ve),a(""),d(""),f(""),g(""),k(""),_(""),j(""),N(""),P(""),R(""),U(null),t()}catch(xe){A((xe==null?void 0:xe.message)||"Failed to create vehicle")}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),E&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:E}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[r.jsx("input",{value:o,onChange:Q=>a(Q.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:l,onChange:Q=>d(Q.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:u,onChange:Q=>f(Q.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:m,onChange:Q=>g(Q.target.value),placeholder:"Color *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:y,onChange:Q=>k(Q.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:S,onChange:Q=>_(Q.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:C,onChange:Q=>j(Q.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:x,onChange:Q=>N(Q.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:b,onChange:Q=>P(Q.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:T,onChange:Q=>R(Q.target.value),placeholder:"Seats *",type:"number",min:1,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{type:"file",accept:"image/*",onChange:Q=>{var M;const ie=((M=Q.target.files)==null?void 0:M[0])||null;if(ie){if(!q.includes(ie.type)){A(`Invalid file type. Allowed: ${q.join(", ")}`),U(null);return}if(ie.size>H){A(`File size must be less than ${H/1024/1024}MB. Current: ${(ie.size/1024/1024).toFixed(2)}MB`),U(null);return}A(""),U(ie)}else U(null)},placeholder:"Car Image",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:O,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function QS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState("");if(v.useEffect(()=>{n&&(a(n.battery??""),d(n.tech??""),f(n.issue??""))},[n]),!e||!n)return null;function m(){s(n.id,{battery:o,tech:l,issue:u}),t()}return r.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"vehicle-modal-content",children:[r.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),r.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),r.jsx("label",{children:"Battery Status"}),r.jsx("input",{value:o,onChange:g=>a(g.target.value),placeholder:"e.g. 80"}),r.jsx("label",{children:"Condition"}),r.jsxs("select",{value:l,onChange:g=>d(g.target.value),children:[r.jsx("option",{children:"Open"}),r.jsx("option",{children:"Running"}),r.jsx("option",{children:"Rented"}),r.jsx("option",{children:"Maintained"})]}),r.jsx("label",{children:"Issue"}),r.jsx("textarea",{value:u,onChange:g=>f(g.target.value)}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:m,children:"Submit Update"})})]})})}function XS({open:e,vehicle:t,onClose:n,onEdit:s,onTransfer:o,onUpdate:a}){const[l,d]=v.useState(!1),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,k]=v.useState(""),[S,_]=v.useState(!0),[C,j]=v.useState(!1);if(!e||!t)return null;const x=t.img,N=()=>{f(t.battery??""),g(t.tech??""),k(t.issue??""),_(t.isAvailable!==!1&&t.isAvailable!==0),d(!0)},b=async()=>{if(a){j(!0);try{await a(t.id,{battery:u,tech:m,issue:y,isAvailable:S}),d(!1)}catch(T){alert((T==null?void 0:T.message)||"Failed to update vehicle")}finally{j(!1)}}},P=()=>{d(!1),f(""),g(""),k(""),_(!0)};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsx("img",{src:x,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),r.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[r.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[r.jsx("h3",{style:{marginTop:4},children:t.name}),r.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Detail:"}),r.jsx("div",{children:t.detail||"N/A"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Battery:"}),l?r.jsx("input",{type:"number",min:"0",max:"100",value:u,onChange:T=>f(T.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):r.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Condition:"}),l?r.jsx("input",{type:"text",value:m,onChange:T=>g(T.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):r.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Active Status:"}),l?r.jsxs("label",{style:{marginLeft:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"8px"},children:[r.jsx("input",{type:"checkbox",checked:S,onChange:T=>_(T.target.checked),style:{cursor:"pointer",width:"18px",height:"18px"}}),r.jsx("span",{style:{fontSize:"14px"},children:S?" Available":" Unavailable"})]}):r.jsx("span",{style:{marginLeft:"8px",fontWeight:"600",color:t.isAvailable!==!1&&t.isAvailable!==0?"#10b981":"#ef4444"},children:t.isAvailable!==!1&&t.isAvailable!==0?" Available":" Unavailable"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[r.jsx("strong",{children:"Issue:"}),l?r.jsx("textarea",{value:y,onChange:T=>k(T.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):r.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),r.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:x,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),r.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:l?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:b,disabled:C,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:C?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",C?"Saving...":"Save Changes"]}),r.jsxs("button",{onClick:P,disabled:C,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):r.jsxs(r.Fragment,{children:[a&&r.jsxs("button",{onClick:N,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]}),o&&r.jsxs("button",{onClick:()=>{n(),o()},style:{padding:"10px 24px",background:"#8b5cf6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-exchange-alt"})," Transfer Station"]})]})})]})})}function eC({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return r.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[r.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function tC({open:e,onClose:t,vehicle:n,stations:s,currentStationId:o,onSubmit:a}){const[l,d]=v.useState(""),[u,f]=v.useState("Fleet rebalancing"),[m,g]=v.useState(!1);if(!e||!n)return null;const y=s.filter(S=>{const _=S.id||S.Id;return _&&_!==o}),k=async S=>{if(S.preventDefault(),!l){alert("Please select a station");return}g(!0);try{await a(n,l,u),d(""),f("Fleet rebalancing"),t()}catch(_){console.error("Transfer failed:",_)}finally{g(!1)}};return r.jsx("div",{className:"modal-backdrop",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 10px 40px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[r.jsxs("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:[r.jsx("i",{className:"fas fa-exchange-alt",style:{marginRight:"8px",color:"#0ea5e9"}}),"Transfer Vehicle"]}),r.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",padding:"0",width:"32px",height:"32px"},children:""})]}),r.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"20px"},children:[r.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:n.name}),r.jsxs("div",{style:{fontSize:"14px",color:"#6b7280"},children:["Current Station: ",n.stationName||"Unknown"]})]}),r.jsxs("form",{onSubmit:k,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsxs("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:["Transfer to Station ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsxs("select",{value:l,onChange:S=>d(S.target.value),required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[r.jsx("option",{value:"",children:"-- Select Station --"}),y.map(S=>{const _=S.id||S.Id,C=S.name||S.Name||`Station ${_}`;return r.jsx("option",{value:_,children:C},_)})]})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:"Reason (optional)"}),r.jsx("textarea",{value:u,onChange:S=>f(S.target.value),placeholder:"Enter reason for transfer...",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[r.jsx("button",{type:"button",onClick:t,disabled:m,style:{flex:1,padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",fontSize:"14px",fontWeight:"500",cursor:m?"not-allowed":"pointer",opacity:m?.6:1},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:m||!l,style:{flex:1,padding:"10px",border:"none",borderRadius:"6px",background:l&&!m?"#0ea5e9":"#9ca3af",color:"white",fontSize:"14px",fontWeight:"500",cursor:l&&!m?"pointer":"not-allowed"},children:m?"Transferring...":"Transfer Vehicle"})]})]})]})})}function nC({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:o,canDelete:a=!0,stationSlots:l=null,onTransferCar:d,stations:u}){const[f,m]=v.useState(null),[g,y]=v.useState(!1),[k,S]=v.useState(!1),[_,C]=v.useState(!1),[j,x]=v.useState(!1),[N,b]=v.useState(null),[P,T]=v.useState(""),R=e.filter(H=>{if(!P)return!0;const q=P.toLowerCase(),O=(H.name||"").toLowerCase(),Q=(H.model||"").toLowerCase(),ie=(H.brand||"").toLowerCase(),M=(H.licensePlate||"").toLowerCase();return O.includes(q)||Q.includes(q)||ie.includes(q)||M.includes(q)});function B(H){m(H),C(!0)}function U(H){m(H),y(!0)}function E(H){b(H),x(!0)}const A=async(H,q,O)=>{d&&await d(H,q,O)};return r.jsxs("div",{id:"vehicle",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>S(!0),children:[r.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),r.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:P,onChange:H=>T(H.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),o&&l&&r.jsx(eC,{stationSlots:l})]}),r.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!R||R.length===0)&&r.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:P?"No vehicles match your search.":"No vehicles available to display."}),R.map((H,q)=>r.jsx("div",{children:r.jsx(KS,{vehicle:H,onOpen:()=>U(H)})},H.id||H.licensePlate||`${H.name}-${H.stationId||""}-${q}`))]}),r.jsx(JS,{open:k,onClose:()=>S(!1),onSubmit:t,stationId:o}),r.jsx(QS,{open:_,onClose:()=>C(!1),vehicle:f,onSubmit:s}),r.jsx(XS,{open:g,vehicle:f,onClose:()=>y(!1),onEdit:f?()=>B(f):null,onTransfer:d&&f?()=>E(f):null,onUpdate:s}),r.jsx(tC,{open:j,onClose:()=>{x(!1),b(null)},vehicle:N,stations:u||[],currentStationId:o,onSubmit:A})]})}function rC({user:e,onClick:t}){const n=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",s=e.email||e.Email||"",o=e.role||e.Role||e.userRole||"Customer",a=e.phoneNumber||e.PhoneNumber||e.phone||"";return r.jsxs("div",{className:"user-card",onClick:t,children:[r.jsx("div",{className:"user-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsxs("div",{className:"user-info",children:[r.jsx("div",{className:"user-name",children:n}),r.jsx("div",{className:"user-email",children:s}),r.jsx("div",{className:"user-role",children:o}),a!==""&&r.jsx("div",{className:"user-phone",children:a})]})]})}function iC({userId:e,userName:t,onClose:n}){const[s,o]=v.useState([]),[a,l]=v.useState(!0),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState("newest");v.useEffect(()=>{k()},[e]);const k=async()=>{var j,x;try{l(!0),u(""),console.log(" Fetching bookings for user:",e);const N=await en.getUserBookings(e);console.log(" Bookings loaded:",N),o(N||[])}catch(N){console.error(" Error loading bookings:",N),u(((x=(j=N==null?void 0:N.response)==null?void 0:j.data)==null?void 0:x.message)||"Failed to load booking history")}finally{l(!1)}},S=j=>{const x={0:{text:"Pending",class:"status-pending",color:"#ff9800"},1:{text:"Active",class:"status-active",color:"#2196f3"},2:{text:"Waiting for check-in",class:"status-waiting",color:"#ff5722"},3:{text:"Checked-in",class:"status-checked-in",color:"#4caf50"},4:{text:"Check-out pending",class:"status-checkout-pending",color:"#9c27b0"},5:{text:"Completed",class:"status-completed",color:"#4caf50"},6:{text:"Cancelled pending refund",class:"status-cancelled-refund",color:"#f44336"},7:{text:"Cancelled",class:"status-cancelled",color:"#9e9e9e"}},N=Number(j);return x[N]||x[0]},_=j=>{if(!j)return"N/A";try{const x=new Date(j);return isNaN(x.getTime())?j:x.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return j}};let C=[...s];return f&&(C=C.filter(j=>String(j.bookingStatus)===f)),C.sort((j,x)=>{switch(g){case"oldest":return new Date(j.createdAt)-new Date(x.createdAt);case"price-high":return(x.totalAmount||0)-(j.totalAmount||0);case"price-low":return(j.totalAmount||0)-(x.totalAmount||0);default:return new Date(x.createdAt)-new Date(j.createdAt)}}),r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:n,children:r.jsxs("div",{style:{background:"white",borderRadius:"12px",width:"100%",maxWidth:"900px",maxHeight:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,marginBottom:"4px"},children:"Booking History"}),r.jsxs("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:["for ",t]})]}),r.jsx("button",{onClick:n,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#999",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),r.jsxs("div",{style:{padding:"15px 20px",borderBottom:"1px solid #eee",display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("label",{style:{fontWeight:500},children:"Status:"}),r.jsxs("select",{value:f,onChange:j=>m(j.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"0",children:"Pending"}),r.jsx("option",{value:"1",children:"Active"}),r.jsx("option",{value:"2",children:"Waiting for check-in"}),r.jsx("option",{value:"3",children:"Checked-in"}),r.jsx("option",{value:"4",children:"Check-out pending"}),r.jsx("option",{value:"5",children:"Completed"}),r.jsx("option",{value:"6",children:"Cancelled pending refund"}),r.jsx("option",{value:"7",children:"Cancelled"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("label",{style:{fontWeight:500},children:"Sort by:"}),r.jsxs("select",{value:g,onChange:j=>y(j.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[r.jsx("option",{value:"newest",children:"Newest"}),r.jsx("option",{value:"oldest",children:"Oldest"}),r.jsx("option",{value:"price-high",children:"Price (High to Low)"}),r.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),r.jsx("button",{onClick:k,style:{padding:"8px 16px",background:"#1976d2",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:" Refresh"})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[a&&r.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[r.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"10px"}}),"Loading bookings..."]}),d&&r.jsxs("div",{style:{background:"#ffebee",color:"#c62828",padding:"15px",borderRadius:"8px",marginBottom:"15px",border:"1px solid #ef5350"},children:[r.jsx("strong",{children:"Error:"})," ",d]}),!a&&C.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[r.jsx("i",{className:"fas fa-inbox",style:{fontSize:"36px",marginBottom:"15px",display:"block"}}),r.jsx("p",{children:"No bookings found"})]}),!a&&C.length>0&&r.jsx("div",{style:{display:"grid",gap:"15px"},children:C.map((j,x)=>{const N=S(j.bookingStatus),b=_(j.startTime||j.pickupDateTime),P=_(j.endTime||j.expectedReturnDateTime),T=j.carInfo||"Car Rental",R=j.pickupStationName||"N/A",B=j.id||j.bookingId||"N/A";return r.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"15px",background:"#fafafa",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:"15px",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Car"}),r.jsx("div",{style:{fontWeight:500},children:T}),r.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:["Booking ID: ",B]})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Pick-up"}),r.jsx("div",{style:{fontSize:"13px"},children:R}),r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:b})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Return"}),r.jsx("div",{style:{fontSize:"13px"},children:P})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Total"}),r.jsx("div",{style:{fontWeight:600,fontSize:"15px",color:"#1976d2"},children:Yt(j.totalAmount||0)})]}),r.jsx("div",{style:{padding:"6px 12px",background:N.color,color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:500,textAlign:"center",whiteSpace:"nowrap"},children:N.text})]},x)})})]})]})})}function sC({user:e,onClose:t,onAssignStaff:n,onDelete:s}){const[o,a]=v.useState(!1),[l,d]=v.useState(!1);if(!e)return null;const u=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",f=e.email||e.Email||"",m=e.phoneNumber||e.PhoneNumber||e.phone||"",g=e.role||e.Role||e.userRole||"Customer",y=e.id||e.Id||e.userId||e.UserId;if(l)return r.jsx(iC,{userId:y,userName:u,onClose:()=>d(!1)});const k=async()=>{const _=window.prompt("Enter reason for promoting to staff (optional):")||"";if(_!==null){a(!0);try{await(n==null?void 0:n(e,_)),t==null||t()}catch(C){alert((C==null?void 0:C.message)||"Failed to assign staff role")}finally{a(!1)}}},S=async()=>{if(!window.confirm(`Are you sure you want to delete ${u}?`))return;const _=window.prompt("Enter reason for deletion (optional):")||"";a(!0);try{await(s==null?void 0:s(e,_)),t==null||t()}catch(C){alert((C==null?void 0:C.message)||"Failed to delete user")}finally{a(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsxs("div",{style:{textAlign:"center",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{"aria-hidden":!0,style:{width:"120px",height:"120px",borderRadius:"50%",background:"#eceff1",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"15px",color:"#607d8b"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsx("h2",{style:{margin:"10px 0"},children:u}),r.jsx("div",{style:{color:"#666",marginBottom:"20px"},children:g})]}),r.jsxs("div",{style:{padding:"0 20px 20px"},children:[r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:f})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Phone:"}),r.jsx("span",{children:m})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"User ID:"}),r.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:y})]})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[r.jsxs("button",{onClick:()=>d(!0),style:{background:"#1976d2",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:"pointer",opacity:o?.6:1},children:[r.jsx("i",{className:"fas fa-history",style:{marginRight:"6px"}}),"Booking History"]}),r.jsx("button",{onClick:k,disabled:o,style:{background:"#43a047",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:o?"Processing...":"Promote to Staff"}),r.jsx("button",{onClick:S,disabled:o,style:{background:"#d32f2f",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:o?"Processing...":"Delete User"})]})]})})}function aC({open:e,onClose:t,onSuccess:n}){const[s,o]=v.useState(""),[a,l]=v.useState(""),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState(!1),[k,S]=v.useState(""),_=async C=>{var j,x;C.preventDefault(),S(""),y(!0);try{await Te.post("/Auth/Register",{fullName:s,email:a,phoneNumber:d,password:f}),o(""),l(""),u(""),m(""),n==null||n(),t()}catch(N){const b=((x=(j=N==null?void 0:N.response)==null?void 0:j.data)==null?void 0:x.message)||(N==null?void 0:N.message)||"Failed to create user";S(b)}finally{y(!1)}};return e?r.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:r.jsxs("div",{className:"modal-content",onClick:C=>C.stopPropagation(),children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h2",{children:"Create New User"}),r.jsxs("form",{onSubmit:_,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:s,onChange:C=>o(C.target.value),placeholder:"Full Name",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:a,onChange:C=>l(C.target.value),placeholder:"Email",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:d,onChange:C=>u(C.target.value),placeholder:"Phone",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:f,onChange:C=>m(C.target.value),placeholder:"Password",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-lock"})]}),k&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:k}),r.jsx("button",{type:"submit",disabled:g,children:g?"Creating Account...":"Create User"})]})]})}):null}function oC({user:e,onClick:t}){const n=e.fullName||e.FullName||"Unknown User",s=e.email||e.Email||"N/A",o=e.userRole||e.role||e.Role||"N/A",a=e.deactivatedAt||"Unknown",l=e.daysDeactivated||0;return r.jsxs("div",{className:"user-card deleted-user-card",onClick:t,children:[r.jsxs("div",{className:"user-card-header",children:[r.jsx("div",{className:"user-avatar deleted",children:r.jsx("i",{className:"fas fa-user-slash"})}),r.jsxs("div",{className:"user-info",children:[r.jsx("h4",{className:"user-name",children:n}),r.jsx("p",{className:"user-email",children:s})]})]}),r.jsxs("div",{className:"user-card-body",children:[r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Role:"}),r.jsx("span",{className:"value",children:o})]}),r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Deleted:"}),r.jsx("span",{className:"value",children:a})]}),r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Days Inactive:"}),r.jsxs("span",{className:"value deleted-badge",children:[l," days"]})]})]}),r.jsx("div",{className:"user-card-footer",children:r.jsxs("span",{className:"user-status deleted-status",children:[r.jsx("i",{className:"fas fa-ban"})," Deleted"]})})]})}function lC({users:e,deletedUsers:t=[],loadingDeleted:n=!1,onAssignStaff:s,onDeleteUser:o,onRestoreUser:a,onUserCreated:l,onLoadDeleted:d}){const[u,f]=v.useState(null),[m,g]=v.useState(null),[y,k]=v.useState(""),[S,_]=v.useState(!1),[C,j]=v.useState("active");v.useEffect(()=>{C==="deleted"&&t.length===0&&!n&&d&&d()},[C,t.length,n,d]);const x=e.filter(P=>{const T=(P.role||P.Role||P.userRole||"").toLowerCase();return(y===""||(P.fullName||P.FullName||"").toLowerCase().includes(y.toLowerCase())||(P.email||P.Email||"").toLowerCase().includes(y.toLowerCase())||(P.userName||P.UserName||"").toLowerCase().includes(y.toLowerCase()))&&T!=="station staff"&&T!=="stationstaff"&&T!=="admin"}),N=t.filter(P=>y===""||(P.fullName||P.FullName||"").toLowerCase().includes(y.toLowerCase())||(P.email||P.Email||"").toLowerCase().includes(y.toLowerCase())||(P.userName||P.UserName||"").toLowerCase().includes(y.toLowerCase())),b=C==="active"?x:N;return r.jsxs("div",{id:"users",className:"section",children:[r.jsxs("div",{className:"filter-bar",children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>_(!0),style:{marginRight:"12px"},children:[r.jsx("i",{className:"fas fa-plus"})," Create User"]}),r.jsxs("div",{className:"view-mode-toggle",style:{marginRight:"12px"},children:[r.jsxs("button",{className:`toggle-btn ${C==="active"?"active":""}`,onClick:()=>j("active"),children:[r.jsx("i",{className:"fas fa-users"})," Active Users"]}),r.jsxs("button",{className:`toggle-btn ${C==="deleted"?"active":""}`,onClick:()=>j("deleted"),children:[r.jsx("i",{className:"fas fa-user-slash"})," Deleted Users"]})]}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or username...",value:y,onChange:P=>k(P.target.value)}),r.jsxs("div",{style:{color:"#666",fontSize:"14px"},children:["Showing ",b.length," ",C==="active"?"active":"deleted"," users"]})]}),n&&C==="deleted"&&r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Loading deleted users..."}),!n&&r.jsxs("div",{className:"user-grid",children:[C==="active"&&x.map(P=>r.jsx(rC,{user:P,onClick:()=>f(P)},P.id||P.Id)),C==="deleted"&&N.map(P=>r.jsx(oC,{user:P,onClick:()=>g(P)},P.userId||P.id||P.Id))]}),b.length===0&&!n&&r.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:["No ",C==="deleted"?"deleted":""," users found"]}),r.jsx(sC,{user:u,onClose:()=>f(null),onAssignStaff:s,onDelete:o}),m&&r.jsx("div",{className:"modal-overlay",onClick:()=>g(null),children:r.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Deleted User Details"}),r.jsx("button",{className:"modal-close",onClick:()=>g(null),children:r.jsx("i",{className:"fas fa-times"})})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"user-detail-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Name:"}),r.jsx("span",{children:m.fullName||m.FullName||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:m.email||m.Email||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Role:"}),r.jsx("span",{children:m.userRole||m.role||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Deleted At:"}),r.jsx("span",{children:m.deactivatedAt||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Days Deactivated:"}),r.jsxs("span",{children:[m.daysDeactivated||0," days"]})]})]}),r.jsx("div",{className:"modal-actions",style:{marginTop:"20px"},children:r.jsxs("button",{className:"btn-restore",onClick:()=>{a&&(a(m),g(null))},children:[r.jsx("i",{className:"fas fa-undo"})," Restore User"]})})]})]})}),r.jsx(aC,{open:S,onClose:()=>_(!1),onSuccess:l})]})}function cC({staff:e,stations:t,onClick:n}){const s=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",o=e.email||e.Email||"",a=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/100x100?text=${encodeURIComponent(s.charAt(0))}`,l=e.phoneNumber||e.PhoneNumber||e.phone||"",d=e.stationId||e.StationId,u=t.find(g=>(g.id||g.Id)===d),f=u?u.name||u.Name:e.stationName||e.StationName||(d?`Station ${d.substring(0,8)}...`:"Not Assigned"),m=!d&&!e.stationName&&!e.StationName;return r.jsxs("div",{className:"staff-card",onClick:n,children:[r.jsx("img",{src:a,alt:s,className:"staff-avatar"}),r.jsxs("div",{className:"staff-info",children:[r.jsx("div",{className:"staff-name",children:s}),r.jsx("div",{className:"staff-email",children:o}),r.jsxs("div",{className:"staff-station",style:{color:m?"#ff9800":"inherit"},children:[m?"":""," ",f]}),l!==""&&r.jsxs("div",{className:"staff-phone",children:[" ",l]})]})]})}function dC({staff:e,stations:t,onClose:n,onRemoveStaff:s,onAssignStation:o,onUnassignStation:a}){const[l,d]=v.useState(!1),[u,f]=v.useState("");if(!e)return null;const m=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",g=e.email||e.Email||"",y=e.phoneNumber||e.PhoneNumber||e.phone||"",k=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/150x150?text=${encodeURIComponent(m.charAt(0))}`,S=e.id||e.Id||e.userId||e.UserId,_=e.stationId||e.StationId,C=t.find(T=>(T.id||T.Id)===_),j=C?C.name||C.Name:e.stationName||e.StationName||(_?`Station ${_.substring(0,8)}...`:"Not Assigned"),x=_||e.stationName||e.StationName,N=async()=>{if(!window.confirm(`Are you sure you want to remove staff role from ${m}?`))return;const T=window.prompt("Enter reason for removing staff role (optional):")||"";d(!0);try{await(s==null?void 0:s(e,T)),n==null||n()}catch(R){alert((R==null?void 0:R.message)||"Failed to remove staff role")}finally{d(!1)}},b=async()=>{if(!u){alert("Please select a station");return}if(window.confirm(`Assign ${m} to this station?`)){d(!0);try{await(o==null?void 0:o(e,u)),n==null||n()}catch(T){alert((T==null?void 0:T.message)||"Failed to assign station")}finally{d(!1)}}},P=async()=>{if(window.confirm(`Unassign ${m} from ${j}?`)){d(!0);try{await(a==null?void 0:a(e)),n==null||n()}catch(T){alert((T==null?void 0:T.message)||"Failed to unassign station")}finally{d(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[r.jsx("img",{src:k,alt:m,style:{width:"120px",height:"120px",borderRadius:"50%",objectFit:"cover",marginBottom:"15px"}}),r.jsx("h2",{style:{margin:"10px 0"},children:m}),r.jsx("div",{style:{color:"#43a047",fontWeight:600,marginBottom:"20px"},children:"Station Staff"})]}),r.jsxs("div",{style:{padding:"0 20px 20px"},children:[r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:g})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Phone:"}),r.jsx("span",{children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Station:"}),r.jsx("span",{children:j})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"User ID:"}),r.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:S})]})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee"},children:[r.jsx("h4",{style:{marginBottom:"12px",color:"#333"},children:x?"Reassign to Different Station":"Assign to Station"}),r.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:x?"10px":"0"},children:[r.jsxs("select",{value:u,onChange:T=>f(T.target.value),style:{flex:1,padding:"10px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},disabled:l,children:[r.jsx("option",{value:"",children:"Select a station..."}),t.map(T=>r.jsxs("option",{value:T.id||T.Id,disabled:(T.id||T.Id)===_,children:[T.name||T.Name||`Station ${T.id||T.Id}`,(T.id||T.Id)===_?" (Current)":""]},T.id||T.Id))]}),r.jsx("button",{onClick:b,disabled:l||!u,style:{background:"#2196f3",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:l||!u?"not-allowed":"pointer",opacity:l||!u?.6:1,whiteSpace:"nowrap"},children:l?"Assigning...":x?"Reassign":"Assign"})]}),x&&a&&r.jsx("button",{onClick:P,disabled:l,style:{background:"#ff9800",color:"white",padding:"8px 16px",borderRadius:"8px",border:"none",cursor:l?"not-allowed":"pointer",opacity:l?.6:1,fontSize:"13px",width:"100%"},children:l?"Unassigning...":" Unassign from Station"})]}),r.jsx("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"center"},children:r.jsx("button",{onClick:N,disabled:l,style:{background:"#ff9800",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},children:l?"Processing...":"Remove Staff Role"})})]})})}function uC({open:e,onClose:t,stations:n,onSuccess:s}){const[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,k]=v.useState(""),[S,_]=v.useState(!1),[C,j]=v.useState(""),x=async N=>{var b,P,T,R;N.preventDefault(),j(""),_(!0);try{const B=await Te.post("/Auth/Register",{fullName:o,email:l,phoneNumber:u,password:m}),U=((b=B==null?void 0:B.data)==null?void 0:b.id)||((P=B==null?void 0:B.data)==null?void 0:P.userId);if(!U)throw new Error("Failed to get user ID from registration response");try{await Te.assignStaffRole(U,"Assigned to station staff role during creation")}catch(E){throw console.warn("Failed to assign staff role:",E),new Error("User created but failed to assign staff role")}if(y)try{await Te.assignStaffToStation(y,U)}catch(E){console.warn("Staff role assigned but station assignment failed:",E)}a(""),d(""),f(""),g(""),k(""),s==null||s(),t()}catch(B){const U=((R=(T=B==null?void 0:B.response)==null?void 0:T.data)==null?void 0:R.message)||(B==null?void 0:B.message)||"Failed to create staff member";j(U)}finally{_(!1)}};return e?r.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:r.jsxs("div",{className:"modal-content",onClick:N=>N.stopPropagation(),children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h2",{children:"Create New Staff Member"}),r.jsxs("form",{onSubmit:x,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:o,onChange:N=>a(N.target.value),placeholder:"Full Name",required:!0,disabled:S}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:l,onChange:N=>d(N.target.value),placeholder:"Email",required:!0,disabled:S}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:u,onChange:N=>f(N.target.value),placeholder:"Phone",required:!0,disabled:S}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:m,onChange:N=>g(N.target.value),placeholder:"Password",required:!0,disabled:S}),r.jsx("i",{className:"fas fa-lock"})]}),r.jsxs("div",{className:"input-group",style:{marginBottom:"15px"},children:[r.jsxs("select",{value:y,onChange:N=>k(N.target.value),required:!0,disabled:S,style:{width:"100%",padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",paddingLeft:"40px"},children:[r.jsx("option",{value:"",children:"Select Station"}),n.map(N=>r.jsx("option",{value:N.id||N.Id,children:N.name||N.Name||`Station ${N.id||N.Id}`},N.id||N.Id))]}),r.jsx("i",{className:"fas fa-map-marker-alt",style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",color:"#999"}})]}),C&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:C}),r.jsx("button",{type:"submit",disabled:S,children:S?"Creating Staff Member...":"Create Staff"})]})]})}):null}function hC({users:e,staffByStation:t=[],stations:n,onRemoveStaff:s,onAssignStation:o,onUnassignStation:a,onStaffCreated:l}){const[d,u]=v.useState(null),[f,m]=v.useState(""),[g,y]=v.useState(""),[k,S]=v.useState(!1),C=v.useMemo(()=>{const j=new Map;return t.forEach(x=>{const N=x.userId||x.id||x.Id;N&&j.set(N,x)}),e.forEach(x=>{const N=(x.role||x.Role||x.userRole||"").toLowerCase();if(N==="station staff"||N==="stationstaff"){const b=x.id||x.Id||x.userId;b&&!j.has(b)&&j.set(b,x)}}),Array.from(j.values())},[e,t]).filter(j=>{const x=f===""||(j.fullName||j.FullName||"").toLowerCase().includes(f.toLowerCase())||(j.email||j.Email||"").toLowerCase().includes(f.toLowerCase())||(j.userName||j.UserName||"").toLowerCase().includes(f.toLowerCase()),N=g===""||(j.stationId||j.StationId||"")===g;return x&&N});return r.jsxs("div",{id:"staff",className:"section",children:[r.jsxs("div",{className:"filter-bar",children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>S(!0),style:{marginRight:"12px"},children:[r.jsx("i",{className:"fas fa-plus"})," Create Staff"]}),r.jsx("input",{type:"text",placeholder:"Search staff by name, email, or username...",value:f,onChange:j=>m(j.target.value)}),r.jsxs("select",{value:g,onChange:j=>y(j.target.value),style:{padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"All Stations"}),n.map(j=>r.jsx("option",{value:j.id||j.Id,children:j.name||j.Name||`Station ${j.id||j.Id}`},j.id||j.Id))]}),r.jsxs("div",{style:{color:"#666",fontSize:"14px",whiteSpace:"nowrap"},children:[C.length," staff"]})]}),r.jsx("div",{className:"staff-grid",children:C.map(j=>r.jsx(cC,{staff:j,stations:n,onClick:()=>u(j)},j.id||j.Id))}),C.length===0&&r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No staff members found"}),r.jsx(dC,{staff:d,stations:n,onClose:()=>u(null),onRemoveStaff:s,onAssignStation:o,onUnassignStation:a}),r.jsx(uC,{open:k,onClose:()=>S(!1),stations:n,onSuccess:l})]})}function fC({open:e,onClose:t,inline:n=!1}){const[s,o]=v.useState(!1),[a,l]=v.useState({}),[d,u]=v.useState({}),[f,m]=v.useState("");if(v.useEffect(()=>{if(!e)return;let P=!0;async function T(){var R,B,U;try{o(!0),m("");let E={},A={};try{E=await wt.getMyProfile()}catch(H){((R=H==null?void 0:H.response)==null?void 0:R.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{A=await wt.getMe()}catch(H){((B=H==null?void 0:H.response)==null?void 0:B.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!P)return;l(E||{}),u(A||{});try{let H=(E==null?void 0:E.id)||(E==null?void 0:E.userId)||(A==null?void 0:A.userId)||(A==null?void 0:A.id);if(!H){const O=typeof localStorage<"u"?localStorage.getItem("token"):null;if(O){const Q=Pr(O);H=Q["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||Q.nameidentifier||Q.sub||Q.userId||Q.UserId||Q.id||Q.Id}}if(!(A!=null&&A.role)&&!(E!=null&&E.role))try{const O=typeof localStorage<"u"?localStorage.getItem("token"):null;if(O){const Q=Pr(O),ie=(Q==null?void 0:Q.role)||(Q==null?void 0:Q.Role)||Q["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];ie&&(A={...A,role:ie})}}catch{}const q=!(E!=null&&E.userName)&&!(A!=null&&A.userName)||!(E!=null&&E.address)||!(E!=null&&E.stationName);if(H&&q)try{const O=await wt.getUserById(H);if(!P)return;const Q={...E};Q.userName||(Q.userName=(O==null?void 0:O.userName)||(O==null?void 0:O.UserName)||(O==null?void 0:O.username)||""),Q.address||(Q.address=(O==null?void 0:O.address)||(O==null?void 0:O.Address)||""),Q.stationName||(Q.stationName=(O==null?void 0:O.stationName)||((U=O==null?void 0:O.station)==null?void 0:U.name)||(O==null?void 0:O.StationName)||""),l(Q)}catch{}}catch{}if((!E||Object.keys(E).length===0)&&(!A||Object.keys(A).length===0)){const H=typeof localStorage<"u"&&!!localStorage.getItem("token");m(H?"You may not have permission to view this profile.":"You are not logged in. Please log in with a admin account.")}}catch(E){if(!P)return;m((E==null?void 0:E.message)||"Failed to load profile")}finally{P&&o(!1)}}return T(),()=>{P=!1}},[e]),!e)return null;let g=a.userName||a.username||d.userName||d.username||"";if(!g)try{const P=typeof localStorage<"u"?localStorage.getItem("token"):null;if(P){const T=Pr(P);g=(T==null?void 0:T.preferred_username)||(T==null?void 0:T.unique_name)||(T==null?void 0:T.userName)||(T==null?void 0:T.username)||(T==null?void 0:T.name)||""}}catch{}const y=a.firstName?`${a.firstName} ${a.lastName||""}`.trim():a.fullName||d.fullName||d.name||"",k=a.email||d.email||"",S=a.phoneNumber||d.phoneNumber||"",_=a.address||d.address||"",C=a.createdAt||d.createdAt||"",j=a.employeeId||a.id||d.userId||d.id||"",x=a.stationName||a.station||"",N=a.role||d.role||(Array.isArray(d.roles)?d.roles.join(", "):d.roles||""),b=a.avatarUrl||d.avatarUrl||"https://via.placeholder.com/180x180?text=Admin";return n?r.jsxs("div",{className:"admin-profile-page",children:[r.jsx("div",{className:"admin-cover",children:r.jsx("div",{className:"admin-cover-gradient"})}),r.jsx("div",{className:"admin-header",children:r.jsxs("div",{className:"admin-header-inner",children:[r.jsx("div",{className:"admin-avatar",children:r.jsx("img",{src:b,alt:"Avatar"})}),r.jsxs("div",{className:"admin-title",children:[r.jsx("h1",{children:y}),r.jsxs("div",{className:"admin-meta",children:[r.jsx("span",{className:"admin-role",children:N||""}),r.jsx("span",{className:"admin-sep",children:""}),r.jsx("span",{className:"admin-station",children:x})]})]})]})}),r.jsxs("div",{className:"admin-content",children:[r.jsx("div",{className:"admin-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"About"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Full Name"}),r.jsx("span",{className:"value",children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Role"}),r.jsx("span",{className:"value",children:N||""})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Station"}),r.jsx("span",{className:"value",children:x})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Employee ID"}),r.jsx("span",{className:"value",children:j})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Joined"}),r.jsx("span",{className:"value",children:String(C).toString().slice(0,10)||""})]})]})]})}),r.jsx("div",{className:"admin-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"Contact"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Email"}),r.jsx("span",{className:"value",children:k})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Phone"}),r.jsx("span",{className:"value",children:S})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Address"}),r.jsx("span",{className:"value",children:_})]})]})]})})]}),f&&r.jsx("div",{className:"admin-error",children:f})]}):r.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"profile-modal-content",children:[r.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),r.jsx("h2",{children:"Admin Profile"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsx("img",{src:b,alt:"Admin",style:{borderRadius:"50%"}}),s?r.jsx("div",{style:{padding:16},children:"Loading profile"}):r.jsxs("div",{className:"profile-info-grid",children:[r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Name"}),r.jsx("div",{children:y})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Email"}),r.jsx("div",{children:k})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Role"}),r.jsx("div",{children:N||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Phone"}),r.jsx("div",{children:S})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Address"}),r.jsx("div",{children:_})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Joined"}),r.jsx("div",{children:String(C).toString().slice(0,10)||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Employee ID"}),r.jsx("div",{children:j})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Station"}),r.jsx("div",{children:x})]})]})]})})}function pC(){return r.jsx("div",{id:"profile",className:"section",style:{padding:24},children:r.jsx(fC,{open:!0,inline:!0,onClose:()=>{}})})}function mC({open:e=!1,incident:t=null,onClose:n=()=>{},onAssigned:s=()=>{}}){const[o,a]=v.useState([]),[l,d]=v.useState(""),[u,f]=v.useState(!1);if(v.useEffect(()=>{if(!e)return;let y=!0;async function k(){try{const S=await Te.getAllStations(1,200);if(!y)return;a(S||[])}catch(S){console.error("Failed to load stations",S),a([])}}return k(),()=>{y=!1}},[e]),v.useEffect(()=>{t&&d(t.stationId||"")},[t]),!e||!t)return null;const m=async()=>{var y;if(!l){alert("Please choose a station");return}f(!0);try{try{console.log("[AdminIncidentModal] Assigning",{incidentId:t==null?void 0:t.id,station:l});const C=new FormData;C.append("stationId",l),C.append("StationId",l),C.append("status","Pending"),C.append("Status","Pending");const j=await Ln.updateIncident(t.id,C);console.log("[AdminIncidentModal] FormData assign response:",j),alert("Assigned successfully"),s();return}catch(C){console.warn("[AdminIncidentModal] FormData update failed, will try JSON fallback",C)}const k=encodeURIComponent(t.id),S=[`/Incidents/Update-By-${k}`,`/Incidents/Update-By-Id/${k}`,`/Incidents/Update/${k}`,`/Incidents/${k}`];let _=null;for(const C of S)try{const j={stationId:l,StationId:l,status:"Pending",Status:"Pending"};console.log("[AdminIncidentModal] Trying JSON PUT",{url:C,body:j});const x=await te.put(C,j);console.log("[AdminIncidentModal] JSON PUT response for",C,x==null?void 0:x.status,x==null?void 0:x.data),alert("Assigned successfully"),s();return}catch(j){_=j;const x=(y=j==null?void 0:j.response)==null?void 0:y.status;if(x&&x!==404&&x!==405){console.error("[AdminIncidentModal] Assign JSON PUT failed on",C,j);break}console.warn("[AdminIncidentModal] JSON PUT 404/405 or not found for",C)}throw _||new Error("Assign failed")}catch(k){console.error("Failed to assign station",k),alert((k==null?void 0:k.message)||"Failed to assign")}finally{f(!1)}},g=r.jsxs("div",{style:{width:"100%"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Renter:"})," ",t.renterName||""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Phone:"})," ",t.renterPhone||""]}),r.jsxs("div",{style:{margin:"12px 0"},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Select station to assign"}),r.jsxs("select",{value:l,onChange:y=>d(y.target.value),style:{width:"100%",padding:8},children:[r.jsx("option",{value:"",children:"-- Choose station --"}),o.map(y=>r.jsx("option",{value:y.id||y.Id,children:y.name||y.Name||y.stationName||y.station},y.id||y.Id))]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",width:"100%"},children:[r.jsxs("button",{onClick:n,disabled:u,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:u?"not-allowed":"pointer"},children:[r.jsx("i",{})," Cancel"]}),r.jsxs("button",{onClick:m,disabled:u,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:u?"not-allowed":"pointer"},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",u?"Assigning":"Assign"]})]})]});return r.jsx(By,{open:e,incident:t,onClose:n,onUpdate:async(y,k)=>Ln.updateIncident(y,k),onResolve:async(y,k,S)=>Ln.resolveIncident(y,k,S),footerExtras:g})}function gC(){const[e,t]=v.useState([]),[n,s]=v.useState(!1),[o,a]=v.useState(null),[l,d]=v.useState(!1),u=async()=>{s(!0);try{const g=await Ln.getAllIncidents(null,null,null,null,1,500),k=((g==null?void 0:g.incidents)||[]||[]).map(_=>{var C,j,x,N,b,P,T,R,B,U,E,A;return{id:_.id||_.Id||_.incidentId||_.IncidentId||_._id&&String(_._id),description:_.description||_.Description||_.details||"",stationId:_.stationId||_.StationId||null,status:_.status||_.Status||"Pending",bookingId:_.bookingId||_.BookingId||((C=_.booking)==null?void 0:C.id)||((j=_.booking)==null?void 0:j.BookingId)||null,reportedAt:_.reportedAt||_.ReportedAt||_.createdAt||_.CreatedAt||_.date||null,costIncurred:_.costIncurred??_.CostIncurred??_.cost??null,renterName:_.renterName||_.RenterName||((x=_.raw)==null?void 0:x.renterName)||((N=_.raw)==null?void 0:N.RenterName)||((P=(b=_.booking)==null?void 0:b.user)==null?void 0:P.fullName)||null,renterPhone:_.renterPhone||_.RenterPhone||((T=_.raw)==null?void 0:T.renterPhone)||((R=_.raw)==null?void 0:R.RenterPhone)||((U=(B=_.booking)==null?void 0:B.user)==null?void 0:U.phoneNumber)||null,staffId:_.staffId||_.StaffId||((E=_.raw)==null?void 0:E.staffId)||((A=_.raw)==null?void 0:A.StaffId)||null,images:_.images||_.Images||_.imageUrls||_.ImageUrls||(typeof _.imageUrls=="string"&&_.imageUrls?_.imageUrls.split(";"):null)||[],Images:_.images||_.Images||_.imageUrls||_.ImageUrls||(typeof _.imageUrls=="string"&&_.imageUrls?_.imageUrls.split(";"):null)||[],raw:_}}),S=await Promise.all(k.map(async _=>{var x,N,b;let C=null;const j=_.staffId||((x=_.raw)==null?void 0:x.staffId)||((N=_.raw)==null?void 0:N.StaffId)||((b=_.raw)==null?void 0:b.StaffId);if(j)try{const P=await Te.getStationByStaff(j);C=(P==null?void 0:P.name)||(P==null?void 0:P.stationName)||(P==null?void 0:P.Name)||null}catch{C=null}return{..._,creatorStation:C}}));t(S)}catch(g){console.error("Failed to load incidents",g),t([])}finally{s(!1)}};v.useEffect(()=>{u()},[]);const f=g=>{a(g),d(!0)},m=async()=>{d(!1),a(null),await u()};return r.jsxs("div",{className:"section",children:[r.jsx("h3",{style:{marginTop:0},children:"Incidents"}),n&&r.jsx("div",{children:"Loading incidents"}),!n&&e.length===0&&r.jsx("div",{style:{padding:12},children:"No incidents found."}),!n&&e.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:12},children:e.map(g=>r.jsx(Ty,{incident:g,onClick:y=>f(y)},g.id))}),r.jsx(mC,{open:l,incident:o,onClose:()=>{d(!1),a(null)},onAssigned:m})]})}async function yC(e){const t={};e&&(t.headers={Authorization:`Bearer ${e}`});const n=await te.get("/Admin/Dashboard",t);return n==null?void 0:n.data}mt.create({baseURL:Hi,headers:{Accept:"application/json"}});async function vC(e,t,n){const o={params:{}};e&&(o.headers={Authorization:`Bearer ${e}`});const a=await te.get("/Admin/Reports/Car-Utilization",o);return a==null?void 0:a.data}function xC(){const[e,t]=v.useState(!0),[n,s]=v.useState(null),[o,a]=v.useState([]),[l,d]=v.useState([]),[u,f]=v.useState(""),[m,g]=v.useState("asc"),[y,k]=v.useState("none");v.useEffect(()=>{S()},[]);async function S(){t(!0),s(null);try{const N=localStorage.getItem("token"),b=await Te.getAllStations(1,200).catch(()=>[]),P=10,T=[];for(let R=0;R<b.length;R+=P){const U=b.slice(R,R+P).map(async A=>{const H=A.id||A.Id||A.stationId||A.StationId;try{const q=await fS(H,{token:N}),O=(q==null?void 0:q.data)||q||{},Q=O.totalRevenue??O.TotalRevenue??O.total??O.Total??O.revenue??0,ie=O.revenue??O.thisMonth??O.ThisMonth??O.month??O.Month??O.revenueThisMonth??0;return{StationId:H||null,StationName:A.name||A.Name||A.stationName||A.station||`Station ${H}`,TotalRevenue:Q,ThisMonth:ie,raw:O}}catch{return{StationId:H||null,StationName:A.name||A.Name||A.stationName||A.station||`Station ${H}`,TotalRevenue:0,ThisMonth:0,raw:null}}}),E=await Promise.all(U);T.push(...E)}T.sort((R,B)=>{const U=String(R.StationName||"").toLowerCase(),E=String(B.StationName||"").toLowerCase();return U<E?-1:U>E?1:0}),a(T),d(b||[])}catch(N){s((N==null?void 0:N.message)||String(N))}finally{t(!1)}}const _=()=>S(),C=o.filter(N=>{const b=u.trim().toLowerCase();if(!b)return!0;const P=String(N.StationName||N.stationName||N.Station||"").toLowerCase(),T=String(N.StationId||N.stationId||"").toLowerCase();return P.includes(b)||T.includes(b)}),j=(()=>{const N=[...C];return N.sort((b,P)=>{const T=String(b.StationName||"").toLowerCase(),R=String(P.StationName||"").toLowerCase();return T<R?m==="asc"?-1:1:T>R?m==="asc"?1:-1:0}),y&&y!=="none"&&N.sort((b,P)=>{const T=Number(b.TotalRevenue??b.totalRevenue??b.Total??0),R=Number(P.TotalRevenue??P.totalRevenue??P.Total??0);return y==="asc"?T-R:R-T}),N})(),x={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"100%"};return e?r.jsx("div",{style:{padding:12},children:"Loading station revenue"}):n?r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",n]}):r.jsxs("div",{style:{marginTop:16},children:[r.jsx("h3",{style:{margin:0,marginBottom:8},children:"Stations Revenue"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{placeholder:"Search station name or id",value:u,onChange:N=>f(N.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd",flex:1}}),r.jsxs("select",{value:m,onChange:N=>g(N.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"asc",children:"Name: A  Z"}),r.jsx("option",{value:"desc",children:"Name: Z  A"})]}),r.jsxs("select",{value:y,onChange:N=>k(N.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"none",children:"Revenue: (none)"}),r.jsx("option",{value:"desc",children:"Revenue: High  Low"}),r.jsx("option",{value:"asc",children:"Revenue: Low  High"})]}),r.jsx("button",{onClick:_,style:{padding:"8px 12px",borderRadius:6},children:"Refresh"})]}),r.jsxs("div",{style:{display:"grid",gap:12},children:[j.length===0&&r.jsx("div",{style:{color:"#666"},children:"No station revenue data available."}),j.map((N,b)=>r.jsx("div",{style:x,children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700},children:N.StationName||N.stationName||N.Station||"Station"}),r.jsx("div",{style:{color:"#666",fontSize:12},children:N.StationId||N.stationId?String(N.StationId||N.stationId):""})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"This Month"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:_C(N.ThisMonth??N.thisMonth??N.Month??N.month??0)})]})]})},N.StationId||N.stationId||b))]})]})}function _C(e){if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t.toLocaleString(void 0,{style:"currency",currency:"VND",maximumFractionDigits:0}):String(e)}function wC(){const[e,t]=v.useState([]),[n,s]=v.useState(!1),[o,a]=v.useState(null);v.useEffect(()=>{l()},[]);async function l(){s(!0),a(null);try{let u=function(_,C=[]){if(!_||typeof _!="object")return C;if(Array.isArray(_)){C.push(_);for(const j of _)u(j,C);return C}for(const j of Object.keys(_))u(_[j],C);return C};const f=localStorage.getItem("token"),m=await vC(f),g=m&&(m.data||m)||{},y=u(g);let k=[];y.length?(y.sort((_,C)=>C.length-_.length),k=y[0]):Array.isArray(g)?k=g:k=[];const S=k.map(_=>({carId:_.carId??"",brand:_.brand??"",model:_.model??"",licensePlate:_.licensePlate??"",currentStation:_.currentStation??"",totalBookings:Number(_.totalBookings??0)||0,totalHoursUsed:Number(_.totalHoursUsed??0)||0,utilizationRate:Number(_.utilizationRate??0)||0,revenue:Number(_.revenue??0)||0,averageBatteryLevel:Number(_.averageBatteryLevel??0)||0,status:_.status??""}));t(S)}catch(u){a((u==null?void 0:u.message)||String(u))}finally{s(!1)}}const d={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"100%"};return r.jsxs("div",{style:{marginTop:16},children:[r.jsx("h3",{style:{margin:0,marginBottom:8},children:"Station Vehicles"}),r.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:r.jsx("button",{onClick:l,style:{padding:"8px 12px",borderRadius:6},children:"Refresh"})}),n&&r.jsx("div",{style:{padding:12},children:"Loading vehicles"}),o&&r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",o]}),r.jsxs("div",{style:{display:"grid",gap:12},children:[e.length===0&&!n&&r.jsx("div",{style:{color:"#666"},children:"No vehicles found."}),e.map(u=>r.jsxs("div",{style:d,children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700},children:u.brand&&u.model?`${u.brand} ${u.model}`:u.carId||"Vehicle"}),r.jsx("div",{style:{color:"#666",fontSize:12},children:u.licensePlate}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:6},children:u.currentStation})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Utilization"}),r.jsxs("div",{style:{fontSize:16,fontWeight:700},children:[u.utilizationRate,"%"]}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Revenue"}),r.jsx("div",{style:{fontSize:14,fontWeight:700},children:u.revenue}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Status"}),r.jsx("div",{style:{fontSize:14,fontWeight:700},children:u.status})]})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,color:"#444",fontSize:13},children:[r.jsxs("div",{children:["Total bookings: ",r.jsx("strong",{children:u.totalBookings})]}),r.jsxs("div",{children:["Total hours: ",r.jsx("strong",{children:u.totalHoursUsed})]}),r.jsxs("div",{children:["Avg battery: ",r.jsxs("strong",{children:[u.averageBatteryLevel,"%"]})]})]})]},u.carId||u.licensePlate||JSON.stringify(u)))]})]})}function jC(){const[e,t]=v.useState(!0),[n,s]=v.useState(null),[o,a]=v.useState(null);if(v.useEffect(()=>{let y=!0;async function k(){t(!0),s(null);try{const S=localStorage.getItem("token"),_=await yC(S),C=(_==null?void 0:_.data)||_;if(!y)return;a(C)}catch(S){if(!y)return;s((S==null?void 0:S.message)||String(S))}finally{if(!y)return;t(!1)}}return k(),()=>{y=!1}},[]),e)return r.jsx("div",{style:{padding:12},children:"Loading analytics"});if(n)return r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",n]});if(!o)return r.jsx("div",{style:{padding:12},children:"No analytics data"});const l=o.data||o,d=(l==null?void 0:l.overview)||{},u=(l==null?void 0:l.userStatistics)||{},f=(l==null?void 0:l.fleetStatistics)||{},m=(l==null?void 0:l.bookingStatistics)||{};l!=null&&l.revenueStatistics;const g={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"};return r.jsxs("div",{style:{display:"grid",gap:16},children:[r.jsx("h2",{style:{margin:0,marginBottom:6},children:"Analytics"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12},children:[r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Users"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalUsers??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Cars"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalCars??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Bookings"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalBookings??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Active Bookings"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.activeBookings??""})]})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsxs("div",{style:g,children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:r.jsx("div",{style:{fontWeight:700},children:"User Statistics"})}),r.jsx("div",{style:{marginTop:8},children:r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Active"}),r.jsx("div",{style:{fontSize:18,fontWeight:700},children:u.totalActive??""})]}),r.jsxs("div",{style:{flex:2},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"By Role"}),r.jsx("div",{style:{marginTop:6,display:"flex",gap:8},children:u.byRole?Object.entries(u.byRole).map(([y,k])=>r.jsxs("div",{style:{background:"#f5f7fb",padding:"6px 8px",borderRadius:6},children:[r.jsx("div",{style:{fontSize:12,color:"#333"},children:y}),r.jsx("div",{style:{fontWeight:700},children:k})]},y)):r.jsx("div",{children:""})})]})]})})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{fontWeight:700},children:"Fleet Statistics"}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:8},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Cars"}),r.jsx("div",{style:{fontWeight:700},children:f.totalCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Available"}),r.jsx("div",{style:{fontWeight:700},children:f.availableCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"In Use"}),r.jsx("div",{style:{fontWeight:700},children:f.inUseCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Low Battery"}),r.jsx("div",{style:{fontWeight:700},children:f.lowBatteryCars??""})]})]})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{fontWeight:700},children:"Booking Statistics"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:8,marginTop:8},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total"}),r.jsx("div",{style:{fontWeight:700},children:m.total??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Pending"}),r.jsx("div",{style:{fontWeight:700},children:m.pending??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Checked-in"}),r.jsx("div",{style:{fontWeight:700},children:m.checkedIn??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Completed"}),r.jsx("div",{style:{fontWeight:700},children:m.completed??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Cancelled"}),r.jsx("div",{style:{fontWeight:700},children:m.cancelled??""})]})]})]})]})}),r.jsx("div",{style:{marginTop:12},children:r.jsx(SC,{})})]})}function SC(){const[e,t]=v.useState("stations");return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{onClick:()=>t("stations"),style:{padding:"8px 12px",borderRadius:6,background:e==="stations"?"#eef":"#fff"},children:"Stations"}),r.jsx("button",{onClick:()=>t("vehicles"),style:{padding:"8px 12px",borderRadius:6,background:e==="vehicles"?"#eef":"#fff"},children:"Vehicles"})]}),r.jsxs("div",{children:[e==="stations"&&r.jsx(xC,{}),e==="vehicles"&&r.jsx(wC,{})]})]})}function CC({open:e,onClose:t,onSubmit:n}){const[s,o]=v.useState(""),[a,l]=v.useState(""),[d,u]=v.useState(0),[f,m]=v.useState(""),[g,y]=v.useState(!1);if(!e)return null;async function k(S){if(S.preventDefault(),m(""),!s.trim()||!a.trim()){m("Name and address are required");return}y(!0);try{const _={name:s.trim(),address:a.trim(),totalSlots:Number(d)};await n(_),o(""),l(""),u(0),t&&t()}catch(_){m((_==null?void 0:_.message)||"Create failed")}finally{y(!1)}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"520px",width:"92%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:"Create Station"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsx("input",{value:s,onChange:S=>o(S.target.value),placeholder:"Station name"}),r.jsx("input",{value:a,onChange:S=>l(S.target.value),placeholder:"Address"}),r.jsx("input",{type:"number",value:d,onChange:S=>u(S.target.value),placeholder:"Total slots",min:0})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:[r.jsx("button",{onClick:t,style:{padding:"10px 20px"},children:"Cancel"}),r.jsx("button",{onClick:k,disabled:g,style:{padding:"10px 20px"},children:g?"Creating":"Create Station"})]})]})})}function NC({open:e,onClose:t,station:n,onUpdated:s,onDeleted:o}){const[a,l]=v.useState(!1),[d,u]=v.useState(""),[f,m]=v.useState(""),[g,y]=v.useState(0),[k,S]=v.useState(!1),[_,C]=v.useState("");if(v.useEffect(()=>{n&&(u(n.name||n.Name||""),m(n.address||n.Address||""),y(n.totalSlots??n.TotalSlots??0))},[n]),!e||!n)return null;const j=n.id||n.Id,x=async()=>{C(""),S(!0);try{const b={name:d.trim(),address:f.trim(),totalSlots:Number(g)},P=await Te.updateStation(j,b);s&&s(P||{...n,...b}),l(!1)}catch(b){C((b==null?void 0:b.message)||"Update failed")}finally{S(!1)}},N=async()=>{if(confirm("Delete this station?")){S(!0);try{await Te.deleteStation(j),o&&o(j),t&&t()}catch(b){C((b==null?void 0:b.message)||"Delete failed")}finally{S(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"640px",width:"96%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:a?"Edit Station":"Station Details"}),_&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:_}),a?r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsx("input",{value:d,onChange:b=>u(b.target.value),placeholder:"Name"}),r.jsx("input",{value:f,onChange:b=>m(b.target.value),placeholder:"Address"}),r.jsx("input",{type:"number",value:g,onChange:b=>y(b.target.value),placeholder:"Total slots",min:0})]}):r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("div",{style:{fontWeight:600},children:n.name||n.Name||`Station ${j}`}),r.jsx("div",{style:{color:"#555"},children:n.address||n.Address||""}),r.jsxs("div",{style:{color:"#555"},children:["Slots: ",n.totalSlots??n.TotalSlots??""]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:a?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l(!1),disabled:k,children:"Cancel"}),r.jsx("button",{onClick:x,disabled:k,children:k?"Saving":"Save"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l(!0),children:"Edit"}),r.jsx("button",{onClick:N,style:{background:"#dc2626",color:"#fff"},children:"Delete"})]})})]})})}function kC({open:e,onClose:t,feedback:n}){var k;if(!e||!n)return null;const[s,o]=v.useState(null),[a,l]=v.useState(null);n.id||n.Id;const d=n.subject||n.title||"Feedback",u=n.message||n.description||n.content||"",f=n.rating??n.rate??null,m=n.comment??"",g=s||n.userName||((k=n.user)==null?void 0:k.fullName)||n.userEmail||n.email||"Anonymous",y=new Date(n.createdAt||n.createdDate||n.created||Date.now()).toLocaleString();return v.useEffect(()=>{let S=!0;async function _(){try{if(n.userId&&!n.userName){const C=await zu.getUserById(n.userId);if(S&&C){const j=C.fullName||C.name||C.userName||C.displayName||C.email||null;j&&o(j)}}}catch{}try{if(n.carId){const C=await rt.getCarById(n.carId);if(S&&C){const j=C.brand||C.Brand||C.make||C.manufacturer||null,x=C.model||C.Model||C.name||null,N=[j,x].filter(Boolean).join(" ").trim()||null;N&&l(N)}}}catch{}}return _(),()=>{S=!1}},[n]),r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"720px",width:"96%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:d}),r.jsx("div",{style:{color:"#555",marginBottom:12},children:u}),f!=null&&r.jsxs("div",{style:{fontSize:14,color:"#333",marginBottom:8},children:["Rating: ",f," / 5"]}),m&&r.jsxs("div",{style:{color:"#444",marginBottom:8},children:[r.jsx("strong",{children:"Comment:"})," ",m]}),a&&r.jsxs("div",{style:{fontSize:13,color:"#555",marginTop:6},children:["Car: ",a]}),r.jsxs("div",{style:{fontSize:12,color:"#777"},children:["From: ",g,"  ",y]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:r.jsx("button",{onClick:t,children:"Close"})})]})})}function bC({initialSearch:e="",initialPage:t=1,pageSize:n=10}){const[s,o]=v.useState([]),[a,l]=v.useState(!1),[d,u]=v.useState(e),[f,m]=v.useState(t),[g,y]=v.useState(null),[k,S]=v.useState(!1),_=async(C=f,j=n,x=d)=>{l(!0);try{const N=await Te.getFeedbacks({page:C,pageSize:j,search:x}),b=(N==null?void 0:N.items)||(N==null?void 0:N.data)||[];o(b),m(C)}catch(N){console.error("Failed to load feedbacks",N),o([])}finally{l(!1)}};return v.useEffect(()=>{_(1,n,d)},[]),r.jsxs("div",{style:{width:"100%"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:24,margin:0},children:"Feedbacks"}),r.jsx("div",{style:{flex:1}}),r.jsx("input",{placeholder:" Search feedbacks...",value:d,onChange:C=>{u(C.target.value)},onKeyPress:C=>{C.key==="Enter"&&_(1,n,C.target.value)},style:{padding:"10px 14px",border:"1px solid #ddd",borderRadius:6,minWidth:280,fontSize:14}}),r.jsx("button",{onClick:()=>_(1,n,d),style:{padding:"10px 16px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:14,transition:"background-color 0.2s"},onMouseOver:C=>C.target.style.backgroundColor="#2980b9",onMouseOut:C=>C.target.style.backgroundColor="#3498db",children:"Search"})]}),a?r.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:" Loading feedbacks"}):r.jsxs("div",{children:[(!s||s.length===0)&&r.jsx("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,color:"#666"},children:r.jsx("p",{style:{fontSize:16,margin:0},children:"No feedbacks found."})}),(s||[]).length>0&&r.jsx("div",{style:{display:"grid",gap:12},children:(s||[]).map((C,j)=>{var x;return r.jsxs("div",{style:{padding:16,border:"1px solid #e0e0e0",borderRadius:8,backgroundColor:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"flex-start",cursor:"pointer"},onMouseOver:N=>{N.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",N.currentTarget.style.transform="translateY(-2px)"},onMouseOut:N=>{N.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)",N.currentTarget.style.transform="translateY(0)"},children:[r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:6,color:"#333"},children:C.subject||C.title||"Feedback"}),r.jsx("div",{style:{color:"#666",fontSize:14,marginBottom:10,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:(C.message||C.description||C.content||"No message").slice(0,300)}),r.jsxs("div",{style:{fontSize:12,color:"#999",display:"flex",gap:12,alignItems:"center"},children:[r.jsxs("span",{children:[" ",C.userName||((x=C.user)==null?void 0:x.fullName)||C.userEmail||C.email||"Anonymous"]}),r.jsxs("span",{children:[" ",new Date(C.createdAt||C.createdDate||C.created||Date.now()).toLocaleDateString("vi-VN")]})]})]}),r.jsx("button",{onClick:()=>{y(C),S(!0)},style:{marginLeft:16,padding:"8px 14px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:4,fontWeight:600,cursor:"pointer",fontSize:13,whiteSpace:"nowrap",transition:"background-color 0.2s"},onMouseOver:N=>N.target.style.backgroundColor="#27ae60",onMouseOut:N=>N.target.style.backgroundColor="#2ecc71",children:"View"})]},C.id||C.Id||`feedback-${j}`)})}),(s||[]).length>0&&r.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginTop:32,paddingTop:20,paddingBottom:20,borderTop:"1px solid #e0e0e0",position:"sticky",bottom:0,backgroundColor:"white",zIndex:10},children:[r.jsx("button",{disabled:f<=1,onClick:()=>_(Math.max(1,f-1),n,d),style:{padding:"8px 16px",backgroundColor:f<=1?"#eee":"#3498db",color:f<=1?"#999":"white",border:"none",borderRadius:4,cursor:f<=1?"not-allowed":"pointer",fontWeight:600,fontSize:13,transition:"background-color 0.2s"},children:" Previous"}),r.jsxs("div",{style:{fontSize:13,color:"#666",minWidth:60,textAlign:"center"},children:["Page ",r.jsx("strong",{children:f})]}),r.jsx("button",{onClick:()=>_(f+1,n,d),style:{padding:"8px 16px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:600,fontSize:13,transition:"background-color 0.2s"},onMouseOver:C=>C.target.style.backgroundColor="#2980b9",onMouseOut:C=>C.target.style.backgroundColor="#3498db",children:"Next "})]})]}),r.jsx(kC,{open:k,onClose:()=>{S(!1),y(null)},feedback:g})]})}const IC=[],LC=[];function PC(){const[e,t]=v.useState("booking"),[n,s]=v.useState(IC),[o,a]=v.useState(LC),[l,d]=v.useState([]),[u,f]=v.useState([]),[m,g]=v.useState([]),[y,k]=v.useState(()=>{try{const Y=localStorage.getItem("admin_sidebar_visible");return Y==null?!0:Y==="1"}catch{return!0}}),[S,_]=v.useState(""),[C,j]=v.useState(""),[x,N]=v.useState([]),[b,P]=v.useState(""),[T,R]=v.useState(!1),[B,U]=v.useState(!1),[E,A]=v.useState(!1),[H,q]=v.useState(!1),[O,Q]=v.useState(!1),[ie,M]=v.useState(!1),[W,ue]=v.useState(""),[ne,ve]=v.useState(""),[xe,ce]=v.useState(""),[z,re]=v.useState(null),[G,we]=v.useState(!1),[Le,Ce]=v.useState(!1),[je,ze]=v.useState(null),[me,et]=v.useState([]),[mn,he]=v.useState(!1),[se,ae]=v.useState(""),[ye,le]=v.useState(1),[Ne,Je]=v.useState(10),Jn=async Y=>{try{await Te.confirmBooking(Y.id,"Cash",""),s(X=>X.map(de=>de.id===Y.id?{...de,status:"booked"}:de))}catch(X){ue((X==null?void 0:X.message)||"Failed to proceed to payment")}},Ie=async(Y,X="")=>{var de;try{await Te.cancelBooking(Y.id,X||""),s(fe=>fe.map(_e=>_e.id===Y.id?{..._e,status:"denied"}:_e))}catch(fe){const _e=(de=fe==null?void 0:fe.response)==null?void 0:de.status;if(_e===401||_e===403){alert("You don't have permission to cancel this booking.");return}ue((fe==null?void 0:fe.message)||"Failed to cancel booking")}},$=(Y,X)=>{const de=X==="pending"?"Pending":X==="booked"?"Booked":X==="checked-in"?"Check-in Pending":X==="completed"?"Completed":X==="denied"?"Denied":X;s(fe=>fe.map(_e=>_e.id===Y?{..._e,status:X,statusLabel:de}:_e))},qe=async Y=>{try{const X=await Te.createCar(Y),de=X||{},fe=_e=>({id:_e.id||_e.Id||_e.carId||_e.CarId,name:_e.name||_e.Name||[_e.brand,_e.model].filter(Boolean).join(" ")||"Car",model:_e.model||_e.Model||null,brand:_e.brand||_e.Brand||null,licensePlate:_e.licensePlate||_e.LicensePlate||null,img:_e.imageUrl||_e.image||_e.thumbnailUrl||null,battery:Number.isFinite(_e.currentBatteryLevel)?Math.round(_e.currentBatteryLevel):void 0,tech:_e.condition??_e.status??_e.Status??null,issue:_e.issue??_e.issueDescription??null,capacity:_e.batteryCapacity??_e.BatteryCapacity??_e.capacity??_e.capacityKWh??_e.batteryCapacityKWh??null});return a(_e=>[..._e,fe(de)]),b&&await Xe(b),X}catch(X){throw ue((X==null?void 0:X.message)||"Failed to create vehicle"),X}},We=async Y=>{var X;try{await Te.deleteCar(Y),a(de=>de.filter(fe=>fe.id!==Y)),await Xe(b)}catch(de){const fe=(X=de==null?void 0:de.response)==null?void 0:X.status;if(fe===401||fe===403){ve("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const _e=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Bt=!1;for(const ke of _e)try{await Te.updateStatus(Y,ke),Bt=!0;break}catch{}if(Bt){a(ke=>ke.filter(nt=>nt.id!==Y));return}}catch{}ue((de==null?void 0:de.message)||"Failed to delete vehicle")}},Ee=async(Y,X)=>{try{if(X.battery!==void 0&&X.battery!==""){let de=Number(X.battery);Number.isNaN(de)||(de=Math.max(0,Math.min(100,Math.round(de))),await Te.updateBatteryLevel(Y,de))}if(X.tech&&await Te.updateStatus(Y,X.tech),X.issue)try{await Te.updateCarDescription(Y,X.issue)}catch{await Te.updateCar(Y,{description:X.issue})}X.isAvailable!==void 0&&await(await ZS(async()=>{const{default:fe}=await Promise.resolve().then(()=>Bj);return{default:fe}},void 0)).default.updateCarAvailability(Y,X.isAvailable?1:0)}catch(de){ue((de==null?void 0:de.message)||"Failed to update vehicle")}a(de=>de.map(fe=>fe.id===Y?{...fe,...X}:fe))},ee=async()=>{q(!0);try{const X=(await Te.getAllUsers(1,1e3)||[]).filter(de=>de.isActive!==!1&&de.IsActive!==!1);d(X)}catch(Y){ue((Y==null?void 0:Y.message)||"Failed to load users")}finally{q(!1)}},Be=async()=>{Q(!0);try{const Y=await Te.getDeletedAccounts(1,1e3);f(Y||[])}catch(Y){ue((Y==null?void 0:Y.message)||"Failed to load deleted users")}finally{Q(!1)}},tt=async Y=>{if(!Y){g([]);return}M(!0);try{const X=await Te.getStaffByStation(Y);g(X||[])}catch(X){ue((X==null?void 0:X.message)||"Failed to load staff by station"),g([])}finally{M(!1)}},Ot=async(Y,X)=>{try{await Te.assignStaffRole(Y.id||Y.Id||Y.userId,X),await ee(),b&&await tt(b),alert("User promoted to Station Staff successfully")}catch(de){alert((de==null?void 0:de.message)||"Failed to assign staff role")}},Cn=async(Y,X)=>{try{await Te.removeStaffRole(Y.id||Y.Id||Y.userId,X),await ee(),b&&await tt(b),alert("Staff role removed successfully")}catch(de){alert((de==null?void 0:de.message)||"Failed to remove staff role")}},Ae=async(Y,X)=>{try{const de=Y.id||Y.Id||Y.userId;Y.stationId||Y.StationId?await Te.reassignStaff(de,X):await Te.assignStaffToStation(X,de),await ee(),b&&await tt(b),alert("Staff assigned to station successfully")}catch(de){alert((de==null?void 0:de.message)||"Failed to assign staff to station")}},Tt=async Y=>{try{const X=Y.id||Y.Id||Y.userId;await Te.unassignStaffFromStation(X),await ee(),b&&await tt(b),alert("Staff unassigned from station successfully")}catch(X){alert((X==null?void 0:X.message)||"Failed to unassign staff from station")}},pr=async(Y,X)=>{try{const de=Y.id||Y.Id||Y.userId;await Te.softDeleteUser(de,X),d(fe=>fe.filter(_e=>(_e.id||_e.Id||_e.userId)!==de)),await ee(),alert("User deleted successfully")}catch(de){alert((de==null?void 0:de.message)||"Failed to delete user")}},Ur=async Y=>{try{const X=Y.userId||Y.id||Y.Id;await Te.restoreUser(X),f(de=>de.filter(fe=>(fe.userId||fe.id||fe.Id)!==X)),await Be(),await ee(),alert("User restored successfully")}catch(X){alert((X==null?void 0:X.message)||"Failed to restore user")}},Lt=async(Y,X,de)=>{try{await Te.transferCar(Y.id,X,de||"");const fe=x.find(_e=>(_e.id||_e.Id)===X);alert(`Vehicle transferred successfully to ${(fe==null?void 0:fe.name)||(fe==null?void 0:fe.Name)||"target station"}`),await mr(b),await Xe(b)}catch(fe){throw alert((fe==null?void 0:fe.message)||"Failed to transfer vehicle"),fe}},Xe=async Y=>{if(!Y){re(null);return}try{const X=await Te.getCarStatusReport(Y,null);X&&re({totalCars:X.totalCars||0,availableCars:X.availableCars||0})}catch(X){console.warn("Failed to load station slots:",X)}},mr=async Y=>{try{R(!0);let X=[];if(Y){let ke=[],nt=[];try{ke=await Te.getCarsByStation(Y)}catch{}try{nt=await Te.getAvailableCarsByStation(Y)}catch{}const ft=ge=>Array.isArray(ge)?ge:ge?[ge]:[],Z=ft(ke),Re=ft(nt),De=new Map;for(const ge of[...Z,...Re]){const D=String((ge==null?void 0:ge.id)||(ge==null?void 0:ge.Id)||(ge==null?void 0:ge.carId)||(ge==null?void 0:ge.CarId)||(ge==null?void 0:ge.licensePlate)||(ge==null?void 0:ge.LicensePlate)||Math.random());De.has(D)||De.set(D,ge)}X=Array.from(De.values());try{const ge=await Te.getAllCars(1,1e3),D=Pe=>Pe==null?"":String(Pe).replace(/[{}]/g,"").toLowerCase(),Ge=D(Y),ot=(ge||[]).filter(Pe=>{var Ht,gn,an,Qn;return[Pe.currentStationId,Pe.CurrentStationId,Pe.currentStationID,Pe.stationId,Pe.StationId,Pe.stationID,(Ht=Pe.station)==null?void 0:Ht.id,(gn=Pe.station)==null?void 0:gn.Id,(an=Pe.station)==null?void 0:an.stationId,(Qn=Pe.station)==null?void 0:Qn.StationId].some(Jt=>Jt!=null&&D(Jt)===Ge)});for(const Pe of ot){const gt=String((Pe==null?void 0:Pe.id)||(Pe==null?void 0:Pe.Id)||(Pe==null?void 0:Pe.carId)||(Pe==null?void 0:Pe.CarId)||(Pe==null?void 0:Pe.licensePlate)||(Pe==null?void 0:Pe.LicensePlate));gt&&!De.has(gt)&&De.set(gt,Pe)}X=Array.from(De.values())}catch{}}else try{X=await Te.getAllCars(1,1e3)}catch{try{X=await Te.listCars({page:1,pageSize:1e3})}catch{X=[]}}Array.isArray(X)||(X=X?[X]:[]);const de=ke=>{const nt=Number(ke);return Number.isFinite(nt)&&nt>=0&&nt<=100?Math.round(nt):null},fe=(X||[]).map(ke=>{var ge,D,Ge,ot;const ft=((...Pe)=>Pe.find(gt=>gt!=null&&gt!==""))(ke.currentStationId,ke.CurrentStationId,ke.currentStationID,ke.stationId,ke.StationId,ke.stationID,(ge=ke.station)==null?void 0:ge.id,(D=ke.station)==null?void 0:D.Id,(Ge=ke.station)==null?void 0:Ge.stationId,(ot=ke.station)==null?void 0:ot.StationId),Z=Pe=>Pe==null?"":String(Pe).replace(/[{}]/g,"").toLowerCase(),Re=ft||"",De=(()=>{if(!Re)return null;const Pe=x.find(gt=>Z(gt.id||gt.Id)===Z(Re))||null;return Pe&&(Pe.name||Pe.Name)||null})();return{id:ke.id||ke.Id||ke.carId||ke.CarId,name:ke.name||ke.Name||ke.model||ke.CarName||"Car",model:ke.model||ke.Model||null,brand:ke.brand||ke.Brand||null,licensePlate:ke.licensePlate||ke.LicensePlate||null,img:ke.imageUrl||ke.image||ke.thumbnailUrl||null,battery:de(ke.currentBatteryLevel??ke.CurrentBatteryLevel??ke.batteryPercent??ke.battery),tech:ke.condition??ke.status??ke.Status??null,issue:ke.issue??ke.issueDescription??null,capacity:ke.batteryCapacity??ke.BatteryCapacity??ke.capacity??ke.capacityKWh??ke.batteryCapacityKWh??null,stationId:Re,stationName:De||null}});a(fe);const _e=fe.filter(ke=>ke.battery==null),Bt=fe.filter(ke=>ke.capacity==null);if(_e.length>0)try{const ke=await Promise.all(_e.map(async nt=>{try{const ft=await Te.getCarBattery(nt.id);return{id:nt.id,battery:de(ft)}}catch{return{id:nt.id,battery:null}}}));a(nt=>nt.map(ft=>{const Z=ke.find(Re=>Re.id===ft.id);return Z&&Z.battery!=null?{...ft,battery:Z.battery}:ft}))}catch{}if(Bt.length>0)try{const ke=await Promise.all(Bt.map(async nt=>{try{const ft=await Te.getCarCapacity(nt.id);return{id:nt.id,capacity:ft}}catch{return{id:nt.id,capacity:null}}}));a(nt=>nt.map(ft=>{const Z=ke.find(Re=>Re.id===ft.id);return Z&&Z.capacity!=null?{...ft,capacity:Z.capacity}:ft}))}catch{}}catch(X){ue((X==null?void 0:X.message)||"Failed to load vehicles")}finally{R(!1)}};v.useEffect(()=>{y?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[y]),v.useEffect(()=>{try{localStorage.setItem("admin_sidebar_visible",y?"1":"0")}catch{}},[y]);const Mn=[{key:"booking",label:"Booking",icon:"fas fa-calendar-alt",onClick:()=>t("booking")},{key:"vehicle",label:"Vehicle",icon:"fas fa-car",onClick:()=>t("vehicle")},{key:"user",label:"User",icon:"fas fa-users",onClick:()=>t("user")},{key:"staff",label:"Staff",icon:"fas fa-user-tie",onClick:()=>t("staff")},{key:"station",label:"Stations",icon:"fas fa-map-marker-alt",onClick:()=>t("station")},{key:"feedback",label:"Feedback",icon:"fas fa-comment-dots",onClick:()=>t("feedback")},{key:"incident",label:"Incident",icon:"fas fa-exclamation-triangle",onClick:()=>t("incident")},{key:"analytics",label:"Analytics",icon:"fas fa-chart-line",onClick:()=>t("analytics")},{key:"profile",label:"Profile",icon:"fas fa-user-circle",onClick:()=>t("profile")}];v.useEffect(()=>{let Y=!0;async function X(){try{const fe=await wt.getMe(),_e=(fe==null?void 0:fe.role)||(fe==null?void 0:fe.Role)||(fe==null?void 0:fe.roleName)||(fe==null?void 0:fe.userRole)||(Array.isArray(fe==null?void 0:fe.roles)?fe.roles[0]:"");Y&&ce(_e||"")}catch{try{const fe=localStorage.getItem("token");if(fe){const _e=Pr(fe),Bt=(_e==null?void 0:_e.role)||(_e==null?void 0:_e.Role)||_e["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];Y&&ce(Bt||"")}}catch{}}}async function de(){try{U(!0);const fe=await Te.getAllStations(1,100);if(!Y)return;N(fe||[]);const _e=fe&&fe[0]&&(fe[0].id||fe[0].Id)||"";P(Bt=>Bt||_e)}catch(fe){if(!Y)return;ue((fe==null?void 0:fe.message)||"Failed to load stations")}finally{Y&&U(!1)}}return X(),de(),ee(),()=>{Y=!1}},[]),v.useEffect(()=>{let Y=!0;async function X(){Y&&(await mr(b),await Xe(b))}return X(),()=>{Y=!1}},[b,x]),v.useEffect(()=>{let Y=!0;async function X(){try{A(!0);let de=[];if(b){try{de=await Te.getBookingsByStation(b)}catch{de=[]}if(!de||de.length===0)try{const Z=await Te.listBookings({page:1,pageSize:200}),Re=String(b);de=(Z||[]).filter(De=>{var D,Ge;const ge=De.stationId||De.StationId||((D=De.station)==null?void 0:D.id)||((Ge=De.station)==null?void 0:Ge.Id)||De.pickupStationId||De.PickupStationId;return ge!=null&&String(ge)===Re})}catch{}if(de&&de.length>0){const Z=String(b);de=de.filter(Re=>{var ge,D,Ge,ot,Pe,gt,Ht;return[Re.stationId,Re.StationId,(ge=Re.station)==null?void 0:ge.id,(D=Re.station)==null?void 0:D.Id,Re.pickupStationId,Re.PickupStationId,Re.pickUpStationId,Re.PickUpStationId,Re.startStationId,Re.StartStationId,Re.originStationId,Re.OriginStationId,Re.fromStationId,Re.FromStationId,(Ge=Re.car)==null?void 0:Ge.stationId,(ot=Re.car)==null?void 0:ot.StationId,(Pe=Re.car)==null?void 0:Pe.currentStationId,(gt=Re.vehicle)==null?void 0:gt.stationId,(Ht=Re.vehicle)==null?void 0:Ht.StationId].some(gn=>gn!=null&&String(gn)===Z)})}}else de=await Te.listBookings({page:1,pageSize:100});if(!Y)return;const fe=(de||[]).map(Z=>{var yi,vi,xi,_i,wi,yr,Un,Or,zr,On,He,it,Xn,Nn,kn,vr,Fe,lt,xr,er,Rt,ji,tr,Ye,ct,nr,Dr,$r,Gi,Wr,Yi,Ki,Si,Ji,Qi,Ci,Ws,Xi,Ja,Ue,yn,st,Hs,es,ts,ns,rr;const Re=Z.id||Z.Id||Z.bookingId||Z.BookingId,De=((yi=Z.car)==null?void 0:yi.brand)||((vi=Z.car)==null?void 0:vi.Brand)||((xi=Z.vehicle)==null?void 0:xi.brand)||((_i=Z.vehicle)==null?void 0:_i.Brand)||Z.carBrand||Z.CarBrand||null,ge=((wi=Z.car)==null?void 0:wi.model)||((yr=Z.car)==null?void 0:yr.Model)||((Un=Z.vehicle)==null?void 0:Un.model)||((Or=Z.vehicle)==null?void 0:Or.Model)||Z.carModel||Z.CarModel||null;let D=Z.carName||Z.vehicleName||((zr=Z.car)==null?void 0:zr.name)||((On=Z.car)==null?void 0:On.Name)||null;!D&&(De||ge)&&(D=[De,ge].filter(Boolean).join(" ").trim()||null),!D&&typeof Z.carInfo=="string"&&Z.carInfo.trim()&&(D=Z.carInfo.trim()),!D&&typeof Z.CarInfo=="string"&&Z.CarInfo.trim()&&(D=Z.CarInfo.trim()),D=D||"Booking";const Ge=((He=Z.user)==null?void 0:He.firstName)||((it=Z.customer)==null?void 0:it.firstName)||Z.firstName||Z.FirstName||((Xn=Z.user)==null?void 0:Xn.FirstName)||((Nn=Z.customer)==null?void 0:Nn.FirstName),ot=((kn=Z.user)==null?void 0:kn.lastName)||((vr=Z.customer)==null?void 0:vr.lastName)||Z.lastName||Z.LastName||((Fe=Z.user)==null?void 0:Fe.LastName)||((lt=Z.customer)==null?void 0:lt.LastName),Pe=[Ge,ot].filter(Boolean).join(" "),gt=Pe||Z.customerName||Z.userFullName||((xr=Z.user)==null?void 0:xr.fullName)||((er=Z.customer)==null?void 0:er.name)||((Rt=Z.user)==null?void 0:Rt.name)||"Customer",Ht=Z.userId||Z.UserId||((ji=Z.user)==null?void 0:ji.id)||((tr=Z.user)==null?void 0:tr.Id)||Z.customerId||Z.CustomerId||Z.appUserId||Z.AppUserId||Z.accountId||Z.AccountId||Z.UserID||Z.ownerId||Z.OwnerId||Z.createdById||Z.CreatedById||"",gn=((Ye=Z.user)==null?void 0:Ye.userName)||((ct=Z.user)==null?void 0:ct.UserName)||((nr=Z.user)==null?void 0:nr.username)||Z.userName||Z.UserName||Z.username||null,an=((Dr=Z.user)==null?void 0:Dr.email)||Z.customerEmail||Z.email||Z.userEmail||"",Qn=(($r=Z.user)==null?void 0:$r.address)||Z.customerAddress||Z.address||"",Jt=Z.statusCode??Z.StatusCode??Z.bookingStatus??Z.BookingStatus??Z.status??Z.Status;let Nt="booked",kt="Booked";if(Jt!=null&&(typeof Jt=="number"||/^\d+$/.test(String(Jt)))){const jt=Number(Jt);jt===0?(Nt="pending",kt="Pending"):jt===1?(Nt="booked",kt="Active"):jt===2?(Nt="waiting-checkin",kt="Waiting for check-in"):jt===3?(Nt="checked-in",kt="Checked-in"):jt===4?(Nt="checkout-pending",kt="Check-out pending"):jt===5?(Nt="completed",kt="Completed"):jt===6?(Nt="cancelled-refund",kt="Cancelled pending refund"):jt===7&&(Nt="cancelled",kt="Cancelled")}else{const jt=String(Jt||"").toLowerCase();jt.includes("pending")||jt.includes("wait")?(Nt="pending",kt="Pending"):jt.includes("active")?(Nt="booked",kt="Active"):jt.includes("check")&&jt.includes("in")?(Nt="checked-in",kt="Checked-in"):jt.includes("complete")||jt.includes("finish")?(Nt="completed",kt="Completed"):jt.includes("cancel")?(Nt="cancelled",kt="Cancelled"):(Nt="booked",kt="Booked")}const Fn=String(Jt||"").toLowerCase(),gi=Number(Jt)===0||Fn.includes("pending")||Fn.includes("wait")?"waiting-payment":Fn.includes("check")&&Fn.includes("in")&&(Fn.includes("pay")||Fn.includes("payment"))?"checkin-payment":null,qi=Z.date||Z.createdAt||Z.bookingDate||"",gr=Z.carImageUrl||((Gi=Z.car)==null?void 0:Gi.imageUrl)||((Wr=Z.vehicle)==null?void 0:Wr.imageUrl)||null;return{id:Re,title:D,firstName:Ge||null,lastName:ot||null,fullName:Pe||Z.userFullName||((Yi=Z.user)==null?void 0:Yi.fullName)||((Ki=Z.customer)==null?void 0:Ki.name)||((Si=Z.user)==null?void 0:Si.name)||null,customer:gt,userId:Ht,userName:gn,email:an,address:Qn,status:Nt,statusLabel:kt,uiStage:gi,date:qi,img:gr,carId:Z.carId||Z.CarId||((Ji=Z.car)==null?void 0:Ji.id)||((Qi=Z.car)==null?void 0:Qi.Id)||((Ci=Z.vehicle)==null?void 0:Ci.id)||((Ws=Z.vehicle)==null?void 0:Ws.Id)||null,cccdFrontUrl:Z.cccdFrontUrl||Z.identityFrontUrl||Z.idFrontUrl||Z.frontImageUrl||Z.frontIdUrl||Z.cccdFrontImageUrl||((Xi=Z.customer)==null?void 0:Xi.cccdFrontUrl)||((Ja=Z.user)==null?void 0:Ja.cccdFrontUrl),cccdBackUrl:Z.cccdBackUrl||Z.identityBackUrl||Z.idBackUrl||Z.backImageUrl||Z.backIdUrl||Z.cccdBackImageUrl||((Ue=Z.customer)==null?void 0:Ue.cccdBackUrl)||((yn=Z.user)==null?void 0:yn.cccdBackUrl),gplxFrontUrl:Z.gplxFrontUrl||Z.driverLicenseFrontUrl||Z.gplxImageUrl_Front||((st=Z.customer)==null?void 0:st.gplxImageUrl_Front)||((Hs=Z.user)==null?void 0:Hs.gplxImageUrl_Front),gplxBackUrl:Z.gplxBackUrl||Z.driverLicenseBackUrl||Z.gplxImageUrl_Back||((es=Z.customer)==null?void 0:es.gplxImageUrl_Back)||((ts=Z.user)==null?void 0:ts.gplxImageUrl_Back),idString:Z.customerIdNumber||((ns=Z.user)==null?void 0:ns.identityNumber)||"",phone:Z.customerPhone||((rr=Z.user)==null?void 0:rr.phoneNumber)||""}});s(fe);const _e=fe.filter(Z=>Z.userId&&!(Z.firstName&&Z.lastName));if(_e.length>0)try{const Z=Array.from(new Set(_e.map(ge=>ge.userId))),Re=await Promise.all(Z.map(async ge=>{try{const D=await Te.getUserById(ge),Ge=(D==null?void 0:D.firstName)||(D==null?void 0:D.FirstName)||(D==null?void 0:D.givenName)||(D==null?void 0:D.GivenName)||null,ot=(D==null?void 0:D.lastName)||(D==null?void 0:D.LastName)||(D==null?void 0:D.surname)||(D==null?void 0:D.Surname)||null,Pe=(D==null?void 0:D.fullName)||(D==null?void 0:D.FullName)||[Ge,ot].filter(Boolean).join(" ")||null,gt=(D==null?void 0:D.userName)||(D==null?void 0:D.UserName)||(D==null?void 0:D.username)||(D==null?void 0:D.user_name)||null,Ht=(D==null?void 0:D.address)||(D==null?void 0:D.Address)||"";return{uid:ge,firstName:Ge,lastName:ot,fullName:Pe,userName:gt,address:Ht}}catch{return{uid:ge,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!Y)return;const De=new Map(Re.map(ge=>[ge.uid,ge]));s(ge=>ge.map(D=>{if(D.userId&&De.has(D.userId)){const Ge=De.get(D.userId),ot=D.fullName||Ge.fullName||[Ge.firstName,Ge.lastName].filter(Boolean).join(" ");return{...D,firstName:D.firstName??Ge.firstName??null,lastName:D.lastName??Ge.lastName??null,fullName:ot||D.customer||D.userName||null,userName:D.userName??Ge.userName,address:D.address||Ge.address}}return D}))}catch{}const Bt=Z=>{var Re,De,ge,D;return Z.carId||Z.CarId||Z.vehicleId||Z.VehicleId||((Re=Z.car)==null?void 0:Re.id)||((De=Z.car)==null?void 0:De.Id)||((ge=Z.vehicle)==null?void 0:ge.id)||((D=Z.vehicle)==null?void 0:D.Id)},ke=fe.filter(Z=>(!Z.title||Z.title==="Booking")&&Bt(Z));if(ke.length>0)try{const Z=Array.from(new Set(ke.map(Bt).filter(Boolean))),Re=await Promise.all(Z.map(async ge=>{try{let D=await Te.getCarById(ge);if(!D||!D.id&&!D.Id)try{D=await Te.getCarByIdRest(ge)}catch{}const Ge=(D==null?void 0:D.name)||(D==null?void 0:D.Name)||[D==null?void 0:D.brand,D==null?void 0:D.model].filter(Boolean).join(" ")||null,ot=(D==null?void 0:D.imageUrl)||(D==null?void 0:D.thumbnailUrl)||null;return{cid:ge,name:Ge,img:ot}}catch{return{cid:ge,name:null,img:null}}})),De=new Map(Re.map(ge=>[String(ge.cid),ge]));s(ge=>ge.map(D=>{const Ge=Bt(D),ot=Ge!=null?String(Ge):null;if(ot&&De.has(ot)){const Pe=De.get(ot);return{...D,title:D.title&&D.title!=="Booking"?D.title:Pe.name||D.title,img:D.img||Pe.img||D.img}}return D}))}catch{}const ft=(Z=>Z.filter(Re=>!Re.title||Re.title==="Booking"))(fe);if(ft.length>0)try{const Z=await Promise.all(ft.map(async De=>{try{const ge=await Te.getVehicleModelFromBooking(De.id),D=(ge==null?void 0:ge.name)||[ge==null?void 0:ge.brand,ge==null?void 0:ge.model].filter(Boolean).join(" ")||null;return{id:De.id,title:D}}catch{return{id:De.id,title:null}}})),Re=new Map(Z.map(De=>[De.id,De.title]));s(De=>De.map(ge=>Re.has(ge.id)&&Re.get(ge.id)?{...ge,title:Re.get(ge.id)}:ge))}catch{}}catch(de){if(!Y)return;ue((de==null?void 0:de.message)||"Failed to load bookings")}finally{Y&&A(!1)}}return X(),()=>{Y=!1}},[b]),v.useEffect(()=>{e==="staff"&&b&&tt(b),e==="feedback"&&Vi()},[e,b]);const Vi=async(Y=ye,X=Ne,de=se)=>{he(!0);try{const fe=await Te.getFeedbacks({page:Y,pageSize:X,search:de}),_e=(fe==null?void 0:fe.items)||(fe==null?void 0:fe.data)||[];et(_e),le(Y),Je(X)}catch(fe){ue((fe==null?void 0:fe.message)||"Failed to load feedbacks"),et([])}finally{he(!1)}};return r.jsxs("div",{className:"app-layout",children:[r.jsx(VS,{toggleSidebar:()=>k(Y=>!Y),sidebarVisible:y}),r.jsx("div",{className:`sidebar-wrapper ${y?"visible":""}`,children:r.jsx(by,{title:"FEC Admin",menuItems:Mn,isOpen:y,toggleSidebar:()=>k(Y=>!Y),onSelect:t,activeKey:e})}),r.jsxs("main",{className:`main-content ${y?"shifted":""}`,children:[ne&&r.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:ne}),W&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:W}),e==="booking"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsxs("select",{value:b,onChange:Y=>P(Y.target.value),disabled:B,children:[r.jsx("option",{value:"",children:"All stations"}),x.map(Y=>{const X=Y.id||Y.Id,de=Y.name||Y.Name||Y.stationName||`Station ${X}`;return r.jsx("option",{value:X,children:de},X)})]}),E&&r.jsx("span",{children:"Loading bookings"})]}),!E&&n.length===0&&r.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),r.jsx(YS,{bookings:n,search:S,setSearch:_,statusFilter:C,setStatusFilter:j,onContinuePayment:Jn,onCancelBooking:Ie,onStatusUpdated:$})]}),e==="vehicle"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsxs("select",{value:b,onChange:Y=>P(Y.target.value),disabled:B,children:[r.jsx("option",{value:"",children:"All stations"}),x.map(Y=>{const X=Y.id||Y.Id,de=Y.name||Y.Name||Y.stationName||`Station ${X}`;return r.jsx("option",{value:X,children:de},X)})]}),T&&r.jsx("span",{children:"Loading vehicles"})]}),r.jsx(nC,{vehicles:o,onAdd:qe,onRemove:We,onUpdate:Ee,stationId:b,canDelete:!0,stationSlots:z,onTransferCar:Lt,stations:x})]}),e==="station"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:24,margin:0},children:"Stations Management"}),r.jsx("div",{style:{flex:1}}),r.jsx("button",{onClick:()=>we(!0),style:{padding:"10px 16px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:14,transition:"background-color 0.2s"},onMouseOver:Y=>Y.target.style.backgroundColor="#27ae60",onMouseOut:Y=>Y.target.style.backgroundColor="#2ecc71",children:"+ Add Station"})]}),r.jsx("div",{style:{width:"100%"},children:!x||x.length===0?r.jsx("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,color:"#666"},children:r.jsx("p",{style:{fontSize:16,margin:0},children:"No stations found. Create one to get started."})}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:x.map(Y=>r.jsxs("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,backgroundColor:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"box-shadow 0.2s, transform 0.2s",cursor:"pointer"},onMouseOver:X=>{X.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",X.currentTarget.style.transform="translateY(-2px)"},onMouseOut:X=>{X.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.05)",X.currentTarget.style.transform="translateY(0)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:12},children:r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:700,fontSize:16,marginBottom:4},children:[" ",Y.name||Y.Name||`Station ${Y.id||Y.Id}`]}),r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:8},children:Y.address||Y.Address||"No address provided"})]})}),Y.phoneNumber&&r.jsxs("div",{style:{fontSize:12,color:"#555",marginBottom:4},children:[" ",Y.phoneNumber]}),Y.capacity&&r.jsxs("div",{style:{fontSize:12,color:"#555",marginBottom:8},children:[" Capacity: ",Y.capacity," vehicles"]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,paddingTop:12,borderTop:"1px solid #eee"},children:[r.jsx("button",{onClick:()=>{ze(Y),Ce(!0)},style:{flex:1,padding:"8px 12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600,transition:"background-color 0.2s"},onMouseOver:X=>X.target.style.backgroundColor="#2980b9",onMouseOut:X=>X.target.style.backgroundColor="#3498db",children:"Details"}),r.jsx("button",{onClick:()=>{P(Y.id||Y.Id),t("booking")},style:{flex:1,padding:"8px 12px",backgroundColor:"#9b59b6",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600,transition:"background-color 0.2s"},onMouseOver:X=>X.target.style.backgroundColor="#8e44ad",onMouseOut:X=>X.target.style.backgroundColor="#9b59b6",children:"Bookings"})]})]},Y.id||Y.Id))})}),r.jsx(CC,{open:G,onClose:()=>we(!1),onSubmit:async Y=>{const X=await Te.createStation(Y);N(de=>[X,...de||[]]),we(!1)}}),r.jsx(NC,{open:Le,onClose:()=>{Ce(!1),ze(null)},station:je,onUpdated:Y=>N(X=>X.map(de=>(de.id||de.Id)===(Y.id||Y.Id)?Y:de)),onDeleted:Y=>N(X=>X.filter(de=>(de.id||de.Id)!==Y))})]}),e==="feedback"&&r.jsx(r.Fragment,{children:r.jsx(bC,{})}),e==="user"&&r.jsxs(r.Fragment,{children:[H&&r.jsx("div",{style:{padding:"10px 12px"},children:"Loading users..."}),r.jsx(lC,{users:l,deletedUsers:u,loadingDeleted:O,onAssignStaff:Ot,onDeleteUser:pr,onRestoreUser:Ur,onUserCreated:ee,onLoadDeleted:Be})]}),e==="staff"&&r.jsxs(r.Fragment,{children:[(H||ie)&&r.jsx("div",{style:{padding:"10px 12px"},children:"Loading staff..."}),r.jsx(hC,{users:l,staffByStation:m,stations:x,onRemoveStaff:Cn,onAssignStation:Ae,onUnassignStation:Tt,onStaffCreated:ee})]}),e==="incident"&&r.jsx(r.Fragment,{children:r.jsx(gC,{})}),e==="analytics"&&r.jsx(r.Fragment,{children:r.jsx(jC,{})}),e==="profile"&&r.jsx(pC,{})]})]})}const Ry=v.createContext(null);function za(){return v.useContext(Ry)}function EC({children:e}){const[t,n]=v.useState(()=>{try{return JSON.parse(localStorage.getItem("user"))||null}catch{return null}}),[s,o]=v.useState(()=>localStorage.getItem("token")||null),[a,l]=v.useState(!1),[d,u]=v.useState(!1);v.useEffect(()=>{s?localStorage.setItem("token",s):localStorage.removeItem("token")},[s]),v.useEffect(()=>{t?(localStorage.setItem("user",JSON.stringify(t)),t.email&&localStorage.setItem("userEmail",t.email)):(localStorage.removeItem("user"),localStorage.removeItem("userEmail"))},[t]),v.useEffect(()=>{function k(S){try{if(!S){o(localStorage.getItem("token")||null);const _=localStorage.getItem("user");n(_?JSON.parse(_):null);return}if(S.key==="token"){o(localStorage.getItem("token")||null);return}if(S.key==="user"){const _=localStorage.getItem("user");try{n(_?JSON.parse(_):null)}catch{n(null)}return}if(S.key==="userRole"||S.key==="stationId"){const _=localStorage.getItem("user");try{n(_?JSON.parse(_):null)}catch{}return}}catch(_){console.warn("Error handling storage event in AuthContext:",_)}}return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[]);async function f(k,S){var x,N,b,P;const _=await wt.login(k,S),C=_.token||((x=_.payload)==null?void 0:x.token)||((N=_.raw)==null?void 0:N.token);C&&o(C);const j=((b=_.payload)==null?void 0:b.user)||((P=_.raw)==null?void 0:P.user)||_.payload&&_.payload.user||JSON.parse(localStorage.getItem("user"));return j&&n(j),l(!1),_}async function m(k,S,_,C){return await wt.register({fullName:k,email:S,phoneNumber:_,password:C})}function g(){o(null),n(null),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userEmail"),localStorage.removeItem("stationId"),localStorage.removeItem("userRole")}const y={user:t,token:s,login:f,logout:g,register:m,showLogin:a,setShowLogin:l,showRegister:d,setShowRegister:u};return r.jsx(Ry.Provider,{value:y,children:e})}function _p({children:e,requireStaff:t=!1,requireAdmin:n=!1}){const{user:s,token:o}=za(),a=(s==null?void 0:s.role)||(s==null?void 0:s.Role)||(s==null?void 0:s.roleName)||(s==null?void 0:s.userRole)||(Array.isArray(s==null?void 0:s.roles)?s.roles[0]:null),l=typeof window<"u"?localStorage.getItem("userRole"):null,d=a||l||"",u=d&&(d.includes("Staff")||d.toLowerCase().includes("staff")||d==="StationManager"||d.toLowerCase().includes("manager")),f=d&&(d.includes("Admin")||d.toLowerCase().includes("admin")||d==="SystemAdmin"||d.toLowerCase().includes("administrator"));return n?!o||!f?r.jsx(Cc,{to:"/",replace:!0}):e:t?!o||!u&&!f?r.jsx(Cc,{to:"/",replace:!0}):e:o?e:r.jsx(Cc,{to:"/",replace:!0})}function TC(){const{user:e,logout:t,setShowLogin:n,setShowRegister:s}=za(),o=sn(),[a,l]=v.useState(!1),[d,u]=v.useState({isOpen:!1,type:"info",title:"",message:""});function f(){l(y=>!y)}v.useEffect(()=>{const y=()=>{console.log(" Navigating to update profile page"),o("/update-profile"),l(!1)};return window.addEventListener("openUpdateProfile",y),()=>window.removeEventListener("openUpdateProfile",y)},[o]),v.useEffect(()=>{function y(k){a&&!k.target.closest(".user-menu")&&l(!1)}return document.addEventListener("click",y),()=>document.removeEventListener("click",y)},[a]);const m=e&&e.userRole==="Station Staff",g=e&&e.userRole==="Admin";return r.jsxs(r.Fragment,{children:[r.jsx("header",{className:"header",children:r.jsxs("div",{className:"container header-container",children:[r.jsx("div",{className:"logo",children:r.jsx("a",{href:"/",children:"FEC"})}),r.jsxs("nav",{className:"nav",children:[r.jsxs("div",{className:"navbar-left",children:[m&&r.jsxs("a",{href:"/staff",className:"staff-portal-btn",children:[r.jsx("i",{className:"fas fa-user-shield"})," Staff Portal"]}),g&&r.jsxs("a",{href:"/admin",className:"admin-portal-btn",children:[r.jsx("i",{className:"fas fa-user-shield"})," Admin Portal"]})]}),r.jsxs("div",{className:"navbar-right",children:[!e&&r.jsx("button",{id:"loginBtn",onClick:()=>n(!0),className:"login-nav-btn",children:"Log in"}),e&&r.jsxs("div",{className:"user-menu",children:[r.jsxs("button",{className:"user-menu-btn",onClick:f,children:[r.jsx("i",{className:"fas fa-user-circle"}),r.jsx("i",{className:"fas fa-chevron-down"})]}),r.jsxs("div",{className:`user-dropdown ${a?"show":""}`,children:[r.jsxs("div",{className:"dropdown-header",children:[r.jsx("i",{className:"fas fa-user-circle"}),r.jsx("span",{id:"userEmail",children:e.email||"User Account"})]}),r.jsx("hr",{}),r.jsxs("a",{href:"/profile",children:[" ",r.jsx("i",{className:"fas fa-user-cog"})," User Profile"]}),r.jsxs("a",{href:"/update-profile",children:[" ",r.jsx("i",{className:"fas fa-edit"})," Update Profile"]}),r.jsxs("a",{href:"/booking-history",children:[" ",r.jsx("i",{className:"fas fa-history"})," Booking History"]}),r.jsxs("a",{href:"#",onClick:y=>{y.preventDefault();const k=(e==null?void 0:e.email)||"User";t(),l(!1),u({isOpen:!0,type:"success",title:"Logged Out Successfully! ",message:`You have been logged out.
Goodbye, ${k}!`,autoCloseMs:2e3}),setTimeout(()=>o("/"),2e3)},children:[" ",r.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})]})]})]})]})]})}),r.jsx(Fr,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,autoCloseMs:d.autoCloseMs,onClose:()=>u(y=>({...y,isOpen:!1}))})]})}function BC(){return r.jsx("footer",{className:"footer",children:r.jsx("div",{className:"container",children:r.jsx("p",{children:" 2025 FEC. All rights reserved."})})})}const RC=()=>{const[e,t]=v.useState({soHopDong:"",ngayKy:new Date().getDate().toString(),thangKy:(new Date().getMonth()+1).toString(),namKy:new Date().getFullYear().toString(),benA:{hoTen:""},xe:{bienSo:""},thoiHanThueSo:"1",thoiHanThueChu:"mt",giaThueSo:"10,000,000",giaThueChu:"mi triu ng",phuongThucThanhToan:"Chuyn khon",ngayThanhToan:"15 hng thng"}),[n,s]=v.useState(""),[o,a]=v.useState(""),[l,d]=v.useState(null),[u,f]=v.useState(!1),m=sn(),g=k=>{const{name:S,value:_}=k.target;if(S.includes(".")){const[C,j]=S.split(".");t(x=>({...x,[C]:{...x[C],[j]:_}}))}else t(C=>({...C,[S]:_}))},y=async k=>{k.preventDefault(),f(!0),d(null);try{const S={...e,thoiHanThue:1,donViThoiHan:"thang",gplx:{hang:"B1",so:"123456789",hanSuDung:"31/12/2030"}},_=await fr.createHopDong(S,n,o);_&&_.isSuccess!==!1?(alert("Contract created successfully!"),m(`/contract/${_}`)):d((_==null?void 0:_.message)||"Failed to create contract")}catch(S){d(S.message||"An error occurred."),console.error("Create contract error:",S)}f(!1)};return r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Create New Contract"})}),r.jsx("div",{className:"card-body",children:r.jsxs("form",{onSubmit:y,children:[r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Booking ID"}),r.jsx("input",{type:"text",className:"form-control",value:n,onChange:k=>s(k.target.value),required:!0})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Renter ID"}),r.jsx("input",{type:"text",className:"form-control",value:o,onChange:k=>a(k.target.value),required:!0})]})]}),r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Contract Number"}),r.jsx("input",{type:"text",name:"soHopDong",className:"form-control",value:e.soHopDong,onChange:g,required:!0})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Renter's Full Name"}),r.jsx("input",{type:"text",name:"benA.hoTen",className:"form-control",value:e.benA.hoTen,onChange:g,required:!0})]})]}),r.jsx("div",{className:"row",children:r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"License Plate"}),r.jsx("input",{type:"text",name:"xe.bienSo",className:"form-control",value:e.xe.bienSo,onChange:g,required:!0})]})}),l&&r.jsx("div",{className:"alert alert-danger",children:l}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?"Creating...":"Create Contract"})]})})]})},AC=()=>{const[e,t]=v.useState([]),[n,s]=v.useState(!0),[o,a]=v.useState(null),l=localStorage.getItem("userId")||"3fa85f64-5717-4562-b3fc-2c963f66afa6";v.useEffect(()=>{(async()=>{try{const f=await fr.getContractsByRenter(l);f&&f.length>0?t(f):t([])}catch(f){console.error("Fetch contracts error:",f),a(f.message||"An error occurred while fetching contracts.")}s(!1)})()},[l]);const d=async(u,f)=>{try{const m=await fr.downloadContractById(u),g=window.URL.createObjectURL(new Blob([m])),y=document.createElement("a");y.href=g,y.setAttribute("download",`HopDong_${f||u}.docx`),document.body.appendChild(y),y.click(),y.remove(),window.URL.revokeObjectURL(g)}catch(m){a(m.message||"An error occurred while downloading the contract.")}};return n?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):o?r.jsxs("p",{className:"text-danger",children:["Error: ",o]}):r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[r.jsx("h2",{className:"card-title mb-0",children:"My Contracts"}),r.jsx(Nc,{to:"/contract/new",className:"btn btn-primary",children:"Create New Contract"})]}),r.jsx("div",{className:"card-body",children:r.jsxs("table",{className:"table table-striped",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Contract Number"}),r.jsx("th",{children:"Booking ID"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Created At"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.length>0?e.map(u=>r.jsxs("tr",{children:[r.jsx("td",{children:u.soHopDong||"N/A"}),r.jsx("td",{children:r.jsx(Nc,{to:`/contract/${u.contractId}`,children:u.bookingId})}),r.jsx("td",{children:r.jsx("span",{className:`badge bg-${u.isConfirmed?"success":"warning"}`,children:u.isConfirmed?"Confirmed":"Pending"})}),r.jsx("td",{children:new Date(u.createdAt).toLocaleDateString()}),r.jsxs("td",{children:[r.jsx(Nc,{to:`/contract/${u.contractId}`,className:"btn btn-sm btn-info me-2",children:"View"}),r.jsx("button",{onClick:()=>d(u.contractId,u.soHopDong),className:"btn btn-sm btn-secondary",children:"Download"})]})]},u.contractId)):r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"text-center",children:"No contracts found."})})})]})})]})},MC=()=>{const{id:e}=Wg(),[t,n]=v.useState(null),[s,o]=v.useState(!0),[a,l]=v.useState(null),[d,u]=v.useState("");v.useEffect(()=>{(async()=>{try{const g=await fr.getContractByBooking(e);g?n(g):l("Failed to fetch contract")}catch(g){l(g.message||"An error occurred while fetching the contract.")}o(!1)})()},[e]);const f=async()=>{if(!d){l("Please enter an email address.");return}try{await fr.sendConfirmationEmail(t.contractId,d),alert("Confirmation email sent successfully!"),u("")}catch(m){l(m.message||"Failed to send confirmation email.")}};return s?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):a?r.jsxs("p",{className:"text-danger",children:["Error: ",a]}):t?r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Contract Details"})}),r.jsxs("div",{className:"card-body",children:[r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Contract ID:"})," ",t.contractId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Booking ID:"})," ",t.bookingId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Renter ID:"})," ",t.renterId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Status:"}),r.jsx("span",{className:`badge bg-${t.isConfirmed?"success":"warning"} ms-2`,children:t.isConfirmed?"Confirmed":"Pending"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Created At:"})," ",new Date(t.createdAt).toLocaleString()]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Contract Content:"}),r.jsx("pre",{className:"border p-3",children:t.contractContent})]}),!t.isConfirmed&&r.jsxs("div",{className:"mt-4",children:[r.jsx("h5",{children:"Confirm Contract"}),r.jsxs("div",{className:"input-group mb-3",children:[r.jsx("input",{type:"email",className:"form-control",placeholder:"Enter email to receive confirmation link",value:d,onChange:m=>u(m.target.value)}),r.jsx("button",{className:"btn btn-primary",onClick:f,children:"Send Confirmation"})]})]})]})]}):r.jsx("p",{children:"No contract found."})},FC=()=>{const[e]=Gg(),t=sn(),n=e.get("token"),[s,o]=v.useState(""),[a,l]=v.useState(null),[d,u]=v.useState(!0),[f,m]=v.useState(null),[g,y]=v.useState(!1),[k,S]=v.useState(!1),[_,C]=v.useState(!1),[j,x]=v.useState(!1);v.useEffect(()=>{if(!n){m("No confirmation token provided."),u(!1);return}(async()=>{try{const P=await fr.getContractForConfirmation(n);P?(l(P),o(P.noiDungHtml||P.htmlContent||"")):m("Failed to fetch contract for confirmation.")}catch(P){m(P.message||"An error occurred.")}u(!1)})()},[n]);const N=async()=>{y(!0),m(null);try{console.log(" Signing contract with token:",n);const b=await fr.signContract(n);console.log(" Sign response:",b),console.log(" Response type:",typeof b),console.log(" Response is truthy:",!!b),console.log(" Contract signed successfully!"),S(!0),x(!0),setTimeout(()=>{console.log(" Redirecting to booking history..."),t("/booking-history")},4e3)}catch(b){console.error(" Error signing contract:",b),m(b.message||"An error occurred while signing.")}y(!1)};return d?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):f?r.jsxs("p",{className:"text-danger",children:["Error: ",f]}):k?r.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"100vh"},children:r.jsxs("div",{className:"alert alert-success text-center",style:{maxWidth:"600px"},children:[r.jsx("h4",{className:"alert-heading",children:" Sign Successfully!"}),r.jsx("p",{children:"Your contract has been signed successfully."}),r.jsx("p",{style:{fontSize:"14px",color:"#666"},children:"You will be redirected to booking history in a moment..."})]})}):r.jsxs(r.Fragment,{children:[r.jsx(Fr,{isOpen:j,type:"success",title:"Sign Successfully!",message:"Your contract has been signed successfully. You will be redirected to booking history in a moment...",onClose:()=>x(!1),autoCloseMs:4e3}),r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"card-header",children:[r.jsx("h2",{className:"card-title mb-3",children:"Confirm and Sign Contract"}),a&&r.jsx("div",{className:"contract-info",children:r.jsx("div",{className:"row",children:r.jsxs("div",{className:"col-md-4",children:[r.jsx("strong",{children:"Renter:"})," ",a.nguoiKy||"N/A"]})})})]}),r.jsxs("div",{className:"card-body",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{className:"border p-4 mb-4",style:{maxWidth:"800px",width:"100%",maxHeight:"600px",overflowY:"auto",backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontFamily:"'Times New Roman', serif",fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:s}}),r.jsx("hr",{style:{width:"100%",maxWidth:"800px"}}),r.jsxs("div",{className:"form-check mb-3",style:{maxWidth:"800px",width:"100%"},children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"agreeCheck",checked:_,onChange:b=>C(b.target.checked)}),r.jsx("label",{className:"form-check-label",htmlFor:"agreeCheck",children:"I have read and agree to the terms of the contract."})]}),r.jsx("button",{className:"btn btn-primary btn-lg",style:{maxWidth:"800px",width:"100%"},onClick:N,disabled:g||!_,children:g?"Signing...":"Click to Sign"})]})]})]})},UC=()=>{const[e,t]=v.useState(""),[n,s]=v.useState(!1),[o,a]=v.useState(null),l=async()=>{var d,u,f;if(!e){a("Please enter a User ID.");return}s(!0),a(null);try{const m=await fr.downloadLatestContractByUserId(e),g=window.URL.createObjectURL(new Blob([m])),y=document.createElement("a");y.href=g,y.setAttribute("download",`latest_contract_${e}.docx`),document.body.appendChild(y),y.click(),y.remove(),window.URL.revokeObjectURL(g)}catch(m){const g=((u=(d=m.response)==null?void 0:d.data)==null?void 0:u.message)||m.message||"An error occurred while downloading.";((f=m.response)==null?void 0:f.status)===401?a("Download failed: The server returned a 401 Unauthorized error. This may mean the API requires authentication."):a(g)}s(!1)};return r.jsxs("div",{className:"card w-50 mx-auto",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Download Latest Contract"})}),r.jsxs("div",{className:"card-body",children:[r.jsx("p",{children:"Enter the User ID to download their most recent contract."}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"text",className:"form-control",placeholder:"Enter User ID...",value:e,onChange:d=>t(d.target.value)}),r.jsx("button",{className:"btn btn-primary",type:"button",onClick:l,disabled:n,children:n?"Downloading...":"Download"})]}),o&&r.jsx("p",{className:"text-danger mt-3",children:o})]})]})};function OC(){const e=mi(),t=e.pathname.startsWith("/staff")||e.pathname.startsWith("/admin");return r.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",flex:1},children:[!t&&r.jsx(TC,{}),r.jsx("main",{style:{flex:1},children:r.jsxs(Z0,{children:[r.jsx(Mt,{path:"/",element:r.jsx(dS,{})}),r.jsx(Mt,{path:"/cars",element:r.jsx(uS,{})}),r.jsx(Mt,{path:"/cars/:id",element:r.jsx(hS,{})}),r.jsx(Mt,{path:"/payment",element:r.jsx(pS,{})}),r.jsx(Mt,{path:"/payment-success",element:r.jsx(mS,{})}),r.jsx(Mt,{path:"/payment-cancel",element:r.jsx(gS,{})}),r.jsx(Mt,{path:"/transaction",element:r.jsx(yS,{})}),r.jsx(Mt,{path:"/booking-history",element:r.jsx(xS,{})}),r.jsx(Mt,{path:"/profile",element:r.jsx(Ej,{})}),r.jsx(Mt,{path:"/update-profile",element:r.jsx(Tj,{})}),r.jsx(Mt,{path:"/contract/new",element:r.jsx(RC,{})}),r.jsx(Mt,{path:"/contract/list",element:r.jsx(AC,{})}),r.jsx(Mt,{path:"/contract/:id",element:r.jsx(MC,{})}),r.jsx(Mt,{path:"/contract/download-latest",element:r.jsx(UC,{})}),r.jsx(Mt,{path:"/xac-nhan-hop-dong",element:r.jsx(FC,{})}),r.jsx(Mt,{path:"/staff",element:r.jsx(_p,{requireStaff:!0,children:r.jsx($S,{})})}),r.jsx(Mt,{path:"/admin",element:r.jsx(_p,{requireAdmin:!0,children:r.jsx(PC,{})})})]})}),!t&&r.jsx(BC,{})]})}function zC(){return r.jsx(X0,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:r.jsx(OC,{})})}function DC({isOpen:e,userEmail:t,onClose:n,onSuccess:s}){const[o,a]=v.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[l,d]=v.useState(!1),[u,f]=v.useState(""),[m,g]=v.useState(!1),[y,k]=v.useState([]);hr.useEffect(()=>{if(e){const x=t||localStorage.getItem("userEmail")||"";console.log(" UpdateProfileModal opened with email:",x),S()}},[e,t]);const S=async()=>{try{g(!0),console.log(" Loading profile data from API...");const x=await wt.getMyProfile();console.log(" Profile data loaded:",x);const N=[];(!x.address||x.address.trim()==="")&&N.push("address"),(!x.driverLicenseNumber||x.driverLicenseNumber.trim()==="")&&N.push("driverLicenseNumber"),(!x.driverLicenseExpiry||x.driverLicenseExpiry.trim()==="")&&N.push("driverLicenseExpiry"),k(N),console.log(" Missing fields:",N),a({firstName:x.firstName||x.FirstName||"",lastName:x.lastName||x.LastName||"",phoneNumber:x.phoneNumber||x.PhoneNumber||"",address:x.address||x.Address||"",dateOfBirth:x.dateOfBirth||x.DateOfBirth||"",yearOfBirth:x.yearOfBirth||x.YearOfBirth||"",identityNumber:x.identityNumber||x.IdentityNumber||"",driverLicenseNumber:x.driverLicenseNumber||x.DriverLicenseNumber||"",driverLicenseExpiry:x.driverLicenseExpiry||x.DriverLicenseExpiry||"",driverLicenseClass:x.driverLicenseClass||x.DriverLicenseClass||""})}catch(x){console.error(" Error loading profile:",x)}finally{g(!1)}},_=x=>{const{name:N,value:b}=x.target;a(P=>({...P,[N]:b})),f("")},C=()=>o.firstName.trim()?o.lastName.trim()?o.phoneNumber.trim()?o.phoneNumber.match(/^[0-9]{10,11}$/)?!o.address||o.address.trim()===""?(f("Address is required"),!1):!o.dateOfBirth||o.dateOfBirth.trim()===""?(f("Date of Birth is required"),!1):!o.driverLicenseNumber||o.driverLicenseNumber.trim()===""?(f("Driver License Number is required"),!1):!o.driverLicenseExpiry||o.driverLicenseExpiry.trim()===""?(f("Driver License Expiry is required"),!1):!0:(f("Phone number must be 10-11 digits"),!1):(f("Phone number is required"),!1):(f("Last name is required"),!1):(f("First name is required"),!1),j=async x=>{var N,b;if(x.preventDefault(),console.log(" Form submitted"),!C()){console.log(" Form validation failed");return}d(!0);try{if(console.log(" Updating profile with data:",o),!localStorage.getItem("userId")){f("User ID not found"),d(!1);return}const T={firstName:o.firstName,lastName:o.lastName,phoneNumber:o.phoneNumber,address:o.address||"",dateOfBirth:o.dateOfBirth||"",yearOfBirth:o.yearOfBirth?parseInt(o.yearOfBirth):null,identityNumber:o.identityNumber||"",driverLicenseNumber:o.driverLicenseNumber||"",driverLicenseExpiry:o.driverLicenseExpiry||"",driverLicenseClass:o.driverLicenseClass||""},R=await zu.updateMyProfile(T);console.log(" Profile updated successfully:",R),localStorage.setItem("userFirstName",o.firstName),localStorage.setItem("userLastName",o.lastName),localStorage.setItem("userPhone",o.phoneNumber),s&&s(o),console.log(" Closing UpdateProfileModal"),n()}catch(P){console.error(" Error updating profile:",P),f(((b=(N=P.response)==null?void 0:N.data)==null?void 0:b.message)||"Failed to update profile. Please try again.")}finally{d(!1)}};return e?(console.log(" UpdateProfileModal: Rendering with isOpen=true"),m?r.jsx("div",{className:"modal-backdrop modal-backdrop-active",children:r.jsxs("div",{className:"modal-content modal-update-profile",children:[r.jsx("div",{className:"modal-header",children:r.jsx("h2",{children:"Loading Profile..."})}),r.jsx("div",{style:{padding:"20px",textAlign:"center"},children:r.jsx("p",{children:"Loading your profile data..."})})]})}):r.jsx("div",{className:"modal-backdrop modal-backdrop-active",children:r.jsxs("div",{className:"modal-content modal-update-profile",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:" Complete Your Profile"}),r.jsx("p",{className:"modal-subtitle",children:"Please fill in your information to complete registration"}),y.length>0&&r.jsxs("p",{className:"modal-subtitle",style:{marginTop:"10px",fontSize:"12px",color:"rgba(255,255,255,0.8)"},children:[" Missing: ",y.map(x=>x==="address"?"Address":x==="driverLicenseNumber"?"Driver License Number":x==="driverLicenseExpiry"?"Driver License Expiry":x).join(", ")]})]}),r.jsxs("form",{onSubmit:j,className:"update-profile-form",children:[u&&r.jsxs("div",{className:"form-error",children:[" ",u]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"firstName",children:"First Name *"}),r.jsx("input",{type:"text",id:"firstName",name:"firstName",value:o.firstName,onChange:_,placeholder:"John",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),r.jsx("input",{type:"text",id:"lastName",name:"lastName",value:o.lastName,onChange:_,placeholder:"Doe",required:!0})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email (Pre-filled)"}),r.jsx("input",{type:"email",id:"email",value:t||localStorage.getItem("userEmail")||"",disabled:!0,className:"form-control-disabled"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),r.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:o.phoneNumber,onChange:_,placeholder:"0912345678",required:!0})]})]}),r.jsxs("div",{className:`form-group ${y.includes("address")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"address",children:["Address",y.includes("address")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"text",id:"address",name:"address",value:o.address,onChange:_,placeholder:"123 Main St, City, Country",style:y.includes("address")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),r.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:o.dateOfBirth,onChange:_})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth"}),r.jsx("input",{type:"number",id:"yearOfBirth",name:"yearOfBirth",value:o.yearOfBirth,onChange:_,placeholder:"1990",min:"1900",max:new Date().getFullYear()})]})]}),r.jsx("div",{className:"form-divider",children:r.jsx("span",{children:"Driver License Information"})}),r.jsxs("div",{className:`form-group ${y.includes("driverLicenseNumber")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number",y.includes("driverLicenseNumber")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:o.driverLicenseNumber,onChange:_,placeholder:"ABC123456",style:y.includes("driverLicenseNumber")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:`form-group ${y.includes("driverLicenseExpiry")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry",y.includes("driverLicenseExpiry")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:o.driverLicenseExpiry,onChange:_,style:y.includes("driverLicenseExpiry")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),r.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:o.driverLicenseClass,onChange:_,children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"A",children:"Class A"}),r.jsx("option",{value:"A1",children:"Class A1"}),r.jsx("option",{value:"B",children:"Class B"}),r.jsx("option",{value:"C",children:"Class C"}),r.jsx("option",{value:"D",children:"Class D"}),r.jsx("option",{value:"E",children:"Class E"})]})]})]}),r.jsx("div",{className:"form-divider",children:r.jsx("span",{children:"Additional Information (Optional)"})}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"identityNumber",children:"Identity Number (CCCD)"}),r.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:o.identityNumber,onChange:_,placeholder:"123456789012"})]})}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:n,disabled:l,children:"Skip for Now"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?" Updating...":" Save Profile"})]})]})]})})):(console.log(" UpdateProfileModal: isOpen is false, not rendering"),null)}function $C(){const{showLogin:e,setShowLogin:t,login:n,setShowRegister:s}=za(),[o,a]=v.useState(""),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[y,k]=v.useState(!1),[S,_]=v.useState(!1);if(!e&&!m.isOpen&&!S)return null;const C=async N=>{try{console.log(" Checking profile completeness for user:",N);const b=await wt.getMyProfile();console.log(" Profile data from /Users/Get-My-Profile:",b);const P=[];return(!b.address||b.address.trim()==="")&&P.push("Address"),(!b.dateOfBirth||b.dateOfBirth.trim()==="")&&P.push("Date of Birth"),(!b.driverLicenseNumber||b.driverLicenseNumber.trim()==="")&&P.push("Driver License Number"),(!b.driverLicenseExpiry||b.driverLicenseExpiry.trim()==="")&&P.push("Driver License Expiry"),P.length>0?(console.log(" Incomplete profile fields:",P),!0):(console.log(" Profile is complete"),!1)}catch(b){return console.error(" Error checking profile:",b),!1}};async function j(N){var b,P;N.preventDefault(),f(""),k(!0);try{console.log(" Logging in user:",o);const T=await n(o,l),R=localStorage.getItem("userRole")||(T==null?void 0:T.role);console.log(" User role:",R);const B=R&&(R.includes("Renter")||R.includes("Customer"));if(console.log(" Is renter?",B),B&&await C(localStorage.getItem("userId"))){console.log(" Opening UpdateProfileModal directly"),_(!0),t(!1),k(!1);return}g({isOpen:!0,type:"success",title:"Log in Successful! ",message:"Welcome back!",autoCloseMs:2e3}),a(""),d(""),setTimeout(()=>{t(!1)},500)}catch(T){console.error(" Login error:",T);const R=T.message||((P=(b=T.response)==null?void 0:b.data)==null?void 0:P.message)||"Login failed";f(R),g({isOpen:!0,type:"error",title:"Login Failed ",message:R,autoCloseMs:3e3})}finally{k(!1)}}function x(){t(!1),s(!0)}return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""})," ",r.jsx("br",{}),r.jsxs("form",{onSubmit:j,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:o,onChange:N=>a(N.target.value),placeholder:"Email",required:!0,disabled:y}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:l,onChange:N=>d(N.target.value),placeholder:"Password",required:!0,disabled:y}),r.jsx("i",{className:"fas fa-lock"})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:u}),r.jsx("button",{type:"submit",disabled:y,children:y?"Logging in...":"Log in"}),r.jsx("p",{className:"modal-footer-text",children:r.jsx("a",{href:"#",onClick:N=>{N.preventDefault(),x()},children:"Create new account"})})]})]})}),"// Notification Modal",r.jsx(Fr,{isOpen:m.isOpen,type:m.type,title:m.title,message:m.message,onClose:()=>g({...m,isOpen:!1})}),r.jsx(DC,{isOpen:S,userEmail:localStorage.getItem("userEmail")||o,onClose:()=>{_(!1),g({isOpen:!0,type:"success",title:"Login Successful! ",message:"Your profile has been updated. Welcome!"}),setTimeout(()=>{t(!1),g({...m,isOpen:!1})},1500)},onSuccess:()=>{console.log(" Profile updated successfully after login"),_(!1)}})]})}function WC(){const{showRegister:e,setShowRegister:t,register:n}=za(),{user:s,logout:o,setShowLogin:a}=za(),[l,d]=v.useState(""),[u,f]=v.useState(""),[m,g]=v.useState(""),[y,k]=v.useState(""),[S,_]=v.useState(""),[C,j]=v.useState({isOpen:!1,type:"info",title:"",message:""}),[x,N]=v.useState(!1);if(!e&&!C.isOpen)return null;async function b(P){var T,R;P.preventDefault(),_(""),N(!0);try{console.log(" Registering user:",u),await n(l,u,m,y),j({isOpen:!0,type:"success",title:"Account Created Successfully! ",message:`Your account has been created.
Email: ${u}

You can now login and complete your profile.`,autoCloseMs:2500}),d(""),f(""),g(""),k(""),setTimeout(()=>{console.log(" Registration complete - closing register modal"),t(!1)},500)}catch(B){console.error(" Registration error:",B);const U=B.message||((R=(T=B.response)==null?void 0:T.data)==null?void 0:R.message)||"Registration failed";_(U),j({isOpen:!0,type:"error",title:"Registration Failed ",message:U,autoCloseMs:3e3})}finally{N(!1)}}return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),r.jsx("h2",{children:"Create a new account"}),r.jsxs("form",{onSubmit:b,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:l,onChange:P=>d(P.target.value),placeholder:"Full Name",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:u,onChange:P=>f(P.target.value),placeholder:"Email",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:m,onChange:P=>g(P.target.value),placeholder:"Phone",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:y,onChange:P=>k(P.target.value),placeholder:"Password",required:!0,disabled:x}),r.jsx("i",{className:"fas fa-lock"})]}),S&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:S}),r.jsx("button",{type:"submit",disabled:x,children:x?"Creating Account...":"Sign Up"}),r.jsx("p",{className:"modal-footer-text",children:r.jsx("a",{href:"#",onClick:P=>{P.preventDefault(),a(!0),t(!1)},children:"Already have an account?"})})]})]})}),r.jsx(Fr,{isOpen:C.isOpen,type:C.type,title:C.title,message:C.message,onClose:()=>j({...C,isOpen:!1})})]})}const HC=Mg(document.getElementById("root"));HC.render(r.jsx(EC,{children:r.jsxs(Aj,{children:[r.jsx(zC,{}),r.jsx($C,{}),r.jsx(WC,{})]})}));
