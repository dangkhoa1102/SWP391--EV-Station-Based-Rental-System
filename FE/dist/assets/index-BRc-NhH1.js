function rv(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ip(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sp={exports:{}},Qo={},ap={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ga=Symbol.for("react.element"),sv=Symbol.for("react.portal"),av=Symbol.for("react.fragment"),ov=Symbol.for("react.strict_mode"),lv=Symbol.for("react.profiler"),cv=Symbol.for("react.provider"),dv=Symbol.for("react.context"),uv=Symbol.for("react.forward_ref"),fv=Symbol.for("react.suspense"),hv=Symbol.for("react.memo"),pv=Symbol.for("react.lazy"),xf=Symbol.iterator;function mv(e){return e===null||typeof e!="object"?null:(e=xf&&e[xf]||e["@@iterator"],typeof e=="function"?e:null)}var op={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lp=Object.assign,cp={};function hs(e,t,n){this.props=e,this.context=t,this.refs=cp,this.updater=n||op}hs.prototype.isReactComponent={};hs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};hs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function dp(){}dp.prototype=hs.prototype;function Pd(e,t,n){this.props=e,this.context=t,this.refs=cp,this.updater=n||op}var bd=Pd.prototype=new dp;bd.constructor=Pd;lp(bd,hs.prototype);bd.isPureReactComponent=!0;var _f=Array.isArray,up=Object.prototype.hasOwnProperty,Id={current:null},fp={key:!0,ref:!0,__self:!0,__source:!0};function hp(e,t,n){var s,a={},l=null,c=null;if(t!=null)for(s in t.ref!==void 0&&(c=t.ref),t.key!==void 0&&(l=""+t.key),t)up.call(t,s)&&!fp.hasOwnProperty(s)&&(a[s]=t[s]);var u=arguments.length-2;if(u===1)a.children=n;else if(1<u){for(var f=Array(u),p=0;p<u;p++)f[p]=arguments[p+2];a.children=f}if(e&&e.defaultProps)for(s in u=e.defaultProps,u)a[s]===void 0&&(a[s]=u[s]);return{$$typeof:ga,type:e,key:l,ref:c,props:a,_owner:Id.current}}function gv(e,t){return{$$typeof:ga,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ld(e){return typeof e=="object"&&e!==null&&e.$$typeof===ga}function yv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var wf=/\/+/g;function Vl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yv(""+e.key):t.toString(36)}function uo(e,t,n,s,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var c=!1;if(e===null)c=!0;else switch(l){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case ga:case sv:c=!0}}if(c)return c=e,a=a(c),e=s===""?"."+Vl(c,0):s,_f(a)?(n="",e!=null&&(n=e.replace(wf,"$&/")+"/"),uo(a,t,n,"",function(p){return p})):a!=null&&(Ld(a)&&(a=gv(a,n+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(wf,"$&/")+"/")+e)),t.push(a)),1;if(c=0,s=s===""?".":s+":",_f(e))for(var u=0;u<e.length;u++){l=e[u];var f=s+Vl(l,u);c+=uo(l,t,n,f,a)}else if(f=mv(e),typeof f=="function")for(e=f.call(e),u=0;!(l=e.next()).done;)l=l.value,f=s+Vl(l,u++),c+=uo(l,t,n,f,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function Ha(e,t,n){if(e==null)return e;var s=[],a=0;return uo(e,s,"","",function(l){return t.call(n,l,a++)}),s}function vv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ht={current:null},fo={transition:null},xv={ReactCurrentDispatcher:Ht,ReactCurrentBatchConfig:fo,ReactCurrentOwner:Id};function pp(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:Ha,forEach:function(e,t,n){Ha(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ha(e,function(){t++}),t},toArray:function(e){return Ha(e,function(t){return t})||[]},only:function(e){if(!Ld(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};De.Component=hs;De.Fragment=av;De.Profiler=lv;De.PureComponent=Pd;De.StrictMode=ov;De.Suspense=fv;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xv;De.act=pp;De.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=lp({},e.props),a=e.key,l=e.ref,c=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,c=Id.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(f in t)up.call(t,f)&&!fp.hasOwnProperty(f)&&(s[f]=t[f]===void 0&&u!==void 0?u[f]:t[f])}var f=arguments.length-2;if(f===1)s.children=n;else if(1<f){u=Array(f);for(var p=0;p<f;p++)u[p]=arguments[p+2];s.children=u}return{$$typeof:ga,type:e.type,key:a,ref:l,props:s,_owner:c}};De.createContext=function(e){return e={$$typeof:dv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cv,_context:e},e.Consumer=e};De.createElement=hp;De.createFactory=function(e){var t=hp.bind(null,e);return t.type=e,t};De.createRef=function(){return{current:null}};De.forwardRef=function(e){return{$$typeof:uv,render:e}};De.isValidElement=Ld;De.lazy=function(e){return{$$typeof:pv,_payload:{_status:-1,_result:e},_init:vv}};De.memo=function(e,t){return{$$typeof:hv,type:e,compare:t===void 0?null:t}};De.startTransition=function(e){var t=fo.transition;fo.transition={};try{e()}finally{fo.transition=t}};De.unstable_act=pp;De.useCallback=function(e,t){return Ht.current.useCallback(e,t)};De.useContext=function(e){return Ht.current.useContext(e)};De.useDebugValue=function(){};De.useDeferredValue=function(e){return Ht.current.useDeferredValue(e)};De.useEffect=function(e,t){return Ht.current.useEffect(e,t)};De.useId=function(){return Ht.current.useId()};De.useImperativeHandle=function(e,t,n){return Ht.current.useImperativeHandle(e,t,n)};De.useInsertionEffect=function(e,t){return Ht.current.useInsertionEffect(e,t)};De.useLayoutEffect=function(e,t){return Ht.current.useLayoutEffect(e,t)};De.useMemo=function(e,t){return Ht.current.useMemo(e,t)};De.useReducer=function(e,t,n){return Ht.current.useReducer(e,t,n)};De.useRef=function(e){return Ht.current.useRef(e)};De.useState=function(e){return Ht.current.useState(e)};De.useSyncExternalStore=function(e,t,n){return Ht.current.useSyncExternalStore(e,t,n)};De.useTransition=function(){return Ht.current.useTransition()};De.version="18.3.1";ap.exports=De;var y=ap.exports;const Kn=ip(y),_v=rv({__proto__:null,default:Kn},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wv=y,jv=Symbol.for("react.element"),Sv=Symbol.for("react.fragment"),Nv=Object.prototype.hasOwnProperty,Cv=wv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kv={key:!0,ref:!0,__self:!0,__source:!0};function mp(e,t,n){var s,a={},l=null,c=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(c=t.ref);for(s in t)Nv.call(t,s)&&!kv.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:jv,type:e,key:l,ref:c,props:a,_owner:Cv.current}}Qo.Fragment=Sv;Qo.jsx=mp;Qo.jsxs=mp;sp.exports=Qo;var i=sp.exports,gp={exports:{}},ln={},yp={exports:{}},vp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,fe){var re=W.length;W.push(fe);e:for(;0<re;){var U=re-1>>>1,ie=W[U];if(0<a(ie,fe))W[U]=fe,W[re]=ie,re=U;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var fe=W[0],re=W.pop();if(re!==fe){W[0]=re;e:for(var U=0,ie=W.length,Z=ie>>>1;U<Z;){var se=2*(U+1)-1,ne=W[se],ce=se+1,ke=W[ce];if(0>a(ne,re))ce<ie&&0>a(ke,ne)?(W[U]=ke,W[ce]=re,U=ce):(W[U]=ne,W[se]=re,U=se);else if(ce<ie&&0>a(ke,re))W[U]=ke,W[ce]=re,U=ce;else break e}}return fe}function a(W,fe){var re=W.sortIndex-fe.sortIndex;return re!==0?re:W.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var f=[],p=[],g=1,x=null,j=3,k=!1,C=!1,S=!1,P=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var fe=n(p);fe!==null;){if(fe.callback===null)s(p);else if(fe.startTime<=W)s(p),fe.sortIndex=fe.expirationTime,t(f,fe);else break;fe=n(p)}}function b(W){if(S=!1,w(W),!C)if(n(f)!==null)C=!0,oe(B);else{var fe=n(p);fe!==null&&Ne(b,fe.startTime-W)}}function B(W,fe){C=!1,S&&(S=!1,_(R),R=-1),k=!0;var re=j;try{for(w(fe),x=n(f);x!==null&&(!(x.expirationTime>fe)||W&&!D());){var U=x.callback;if(typeof U=="function"){x.callback=null,j=x.priorityLevel;var ie=U(x.expirationTime<=fe);fe=e.unstable_now(),typeof ie=="function"?x.callback=ie:x===n(f)&&s(f),w(fe)}else s(f);x=n(f)}if(x!==null)var Z=!0;else{var se=n(p);se!==null&&Ne(b,se.startTime-fe),Z=!1}return Z}finally{x=null,j=re,k=!1}}var T=!1,F=null,R=-1,O=5,I=-1;function D(){return!(e.unstable_now()-I<O)}function q(){if(F!==null){var W=e.unstable_now();I=W;var fe=!0;try{fe=F(!0,W)}finally{fe?te():(T=!1,F=null)}}else T=!1}var te;if(typeof v=="function")te=function(){v(q)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,E=G.port2;G.port1.onmessage=q,te=function(){E.postMessage(null)}}else te=function(){P(q,0)};function oe(W){F=W,T||(T=!0,te())}function Ne(W,fe){R=P(function(){W(e.unstable_now())},fe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){C||k||(C=!0,oe(B))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return j},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(W){switch(j){case 1:case 2:case 3:var fe=3;break;default:fe=j}var re=j;j=fe;try{return W()}finally{j=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,fe){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var re=j;j=W;try{return fe()}finally{j=re}},e.unstable_scheduleCallback=function(W,fe,re){var U=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?U+re:U):re=U,W){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=re+ie,W={id:g++,callback:fe,priorityLevel:W,startTime:re,expirationTime:ie,sortIndex:-1},re>U?(W.sortIndex=re,t(p,W),n(f)===null&&W===n(p)&&(S?(_(R),R=-1):S=!0,Ne(b,re-U))):(W.sortIndex=ie,t(f,W),C||k||(C=!0,oe(B))),W},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(W){var fe=j;return function(){var re=j;j=fe;try{return W.apply(this,arguments)}finally{j=re}}}})(vp);yp.exports=vp;var Pv=yp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv=y,on=Pv;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xp=new Set,Qs={};function bi(e,t){ss(e,t),ss(e+"Capture",t)}function ss(e,t){for(Qs[e]=t,e=0;e<t.length;e++)xp.add(t[e])}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sc=Object.prototype.hasOwnProperty,Iv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jf={},Sf={};function Lv(e){return Sc.call(Sf,e)?!0:Sc.call(jf,e)?!1:Iv.test(e)?Sf[e]=!0:(jf[e]=!0,!1)}function Ev(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Tv(e,t,n,s){if(t===null||typeof t>"u"||Ev(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zt(e,t,n,s,a,l,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=c}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){It[e]=new Zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];It[t]=new Zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){It[e]=new Zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){It[e]=new Zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){It[e]=new Zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){It[e]=new Zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){It[e]=new Zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){It[e]=new Zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){It[e]=new Zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ed=/[\-:]([a-z])/g;function Td(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ed,Td);It[t]=new Zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ed,Td);It[t]=new Zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ed,Td);It[t]=new Zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){It[e]=new Zt(e,1,!1,e.toLowerCase(),null,!1,!1)});It.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){It[e]=new Zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Bd(e,t,n,s){var a=It.hasOwnProperty(t)?It[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Tv(t,n,a,s)&&(n=null),s||a===null?Lv(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,s=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var hr=bv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Za=Symbol.for("react.element"),zi=Symbol.for("react.portal"),$i=Symbol.for("react.fragment"),Rd=Symbol.for("react.strict_mode"),Nc=Symbol.for("react.profiler"),_p=Symbol.for("react.provider"),wp=Symbol.for("react.context"),Ad=Symbol.for("react.forward_ref"),Cc=Symbol.for("react.suspense"),kc=Symbol.for("react.suspense_list"),Fd=Symbol.for("react.memo"),Lr=Symbol.for("react.lazy"),jp=Symbol.for("react.offscreen"),Nf=Symbol.iterator;function Is(e){return e===null||typeof e!="object"?null:(e=Nf&&e[Nf]||e["@@iterator"],typeof e=="function"?e:null)}var dt=Object.assign,ql;function Ms(e){if(ql===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ql=t&&t[1]||""}return`
`+ql+e}var Gl=!1;function Yl(e,t){if(!e||Gl)return"";Gl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var s=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){s=p}e.call(t.prototype)}else{try{throw Error()}catch(p){s=p}e()}}catch(p){if(p&&s&&typeof p.stack=="string"){for(var a=p.stack.split(`
`),l=s.stack.split(`
`),c=a.length-1,u=l.length-1;1<=c&&0<=u&&a[c]!==l[u];)u--;for(;1<=c&&0<=u;c--,u--)if(a[c]!==l[u]){if(c!==1||u!==1)do if(c--,u--,0>u||a[c]!==l[u]){var f=`
`+a[c].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=c&&0<=u);break}}}finally{Gl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ms(e):""}function Bv(e){switch(e.tag){case 5:return Ms(e.type);case 16:return Ms("Lazy");case 13:return Ms("Suspense");case 19:return Ms("SuspenseList");case 0:case 2:case 15:return e=Yl(e.type,!1),e;case 11:return e=Yl(e.type.render,!1),e;case 1:return e=Yl(e.type,!0),e;default:return""}}function Pc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $i:return"Fragment";case zi:return"Portal";case Nc:return"Profiler";case Rd:return"StrictMode";case Cc:return"Suspense";case kc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case wp:return(e.displayName||"Context")+".Consumer";case _p:return(e._context.displayName||"Context")+".Provider";case Ad:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Fd:return t=e.displayName||null,t!==null?t:Pc(e.type)||"Memo";case Lr:t=e._payload,e=e._init;try{return Pc(e(t))}catch{}}return null}function Rv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pc(t);case 8:return t===Rd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Sp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Av(e){var t=Sp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(c){s=""+c,l.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(c){s=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Va(e){e._valueTracker||(e._valueTracker=Av(e))}function Np(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Sp(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function ko(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function bc(e,t){var n=t.checked;return dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Cf(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Vr(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Cp(e,t){t=t.checked,t!=null&&Bd(e,"checked",t,!1)}function Ic(e,t){Cp(e,t);var n=Vr(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Lc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Lc(e,t.type,Vr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function kf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Lc(e,t,n){(t!=="number"||ko(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Os=Array.isArray;function Xi(e,t,n,s){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Vr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Ec(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Pf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(pe(92));if(Os(n)){if(1<n.length)throw Error(pe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Vr(n)}}function kp(e,t){var n=Vr(t.value),s=Vr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function bf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Pp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Pp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qa,bp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qa=qa||document.createElement("div"),qa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Js(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var $s={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fv=["Webkit","ms","Moz","O"];Object.keys($s).forEach(function(e){Fv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),$s[t]=$s[e]})});function Ip(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||$s.hasOwnProperty(e)&&$s[e]?(""+t).trim():t+"px"}function Lp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=Ip(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,a):e[n]=a}}var Uv=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bc(e,t){if(t){if(Uv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function Rc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ac=null;function Ud(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fc=null,es=null,ts=null;function If(e){if(e=xa(e)){if(typeof Fc!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=nl(t),Fc(e.stateNode,e.type,t))}}function Ep(e){es?ts?ts.push(e):ts=[e]:es=e}function Tp(){if(es){var e=es,t=ts;if(ts=es=null,If(e),t)for(e=0;e<t.length;e++)If(t[e])}}function Bp(e,t){return e(t)}function Rp(){}var Kl=!1;function Ap(e,t,n){if(Kl)return e(t,n);Kl=!0;try{return Bp(e,t,n)}finally{Kl=!1,(es!==null||ts!==null)&&(Rp(),Tp())}}function Xs(e,t){var n=e.stateNode;if(n===null)return null;var s=nl(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(pe(231,t,typeof n));return n}var Uc=!1;if(cr)try{var Ls={};Object.defineProperty(Ls,"passive",{get:function(){Uc=!0}}),window.addEventListener("test",Ls,Ls),window.removeEventListener("test",Ls,Ls)}catch{Uc=!1}function Mv(e,t,n,s,a,l,c,u,f){var p=Array.prototype.slice.call(arguments,3);try{t.apply(n,p)}catch(g){this.onError(g)}}var Ws=!1,Po=null,bo=!1,Mc=null,Ov={onError:function(e){Ws=!0,Po=e}};function Dv(e,t,n,s,a,l,c,u,f){Ws=!1,Po=null,Mv.apply(Ov,arguments)}function zv(e,t,n,s,a,l,c,u,f){if(Dv.apply(this,arguments),Ws){if(Ws){var p=Po;Ws=!1,Po=null}else throw Error(pe(198));bo||(bo=!0,Mc=p)}}function Ii(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Fp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lf(e){if(Ii(e)!==e)throw Error(pe(188))}function $v(e){var t=e.alternate;if(!t){if(t=Ii(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var n=e,s=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return Lf(a),e;if(l===s)return Lf(a),t;l=l.sibling}throw Error(pe(188))}if(n.return!==s.return)n=a,s=l;else{for(var c=!1,u=a.child;u;){if(u===n){c=!0,n=a,s=l;break}if(u===s){c=!0,s=a,n=l;break}u=u.sibling}if(!c){for(u=l.child;u;){if(u===n){c=!0,n=l,s=a;break}if(u===s){c=!0,s=l,n=a;break}u=u.sibling}if(!c)throw Error(pe(189))}}if(n.alternate!==s)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?e:t}function Up(e){return e=$v(e),e!==null?Mp(e):null}function Mp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Mp(e);if(t!==null)return t;e=e.sibling}return null}var Op=on.unstable_scheduleCallback,Ef=on.unstable_cancelCallback,Wv=on.unstable_shouldYield,Hv=on.unstable_requestPaint,pt=on.unstable_now,Zv=on.unstable_getCurrentPriorityLevel,Md=on.unstable_ImmediatePriority,Dp=on.unstable_UserBlockingPriority,Io=on.unstable_NormalPriority,Vv=on.unstable_LowPriority,zp=on.unstable_IdlePriority,Jo=null,Gn=null;function qv(e){if(Gn&&typeof Gn.onCommitFiberRoot=="function")try{Gn.onCommitFiberRoot(Jo,e,void 0,(e.current.flags&128)===128)}catch{}}var Bn=Math.clz32?Math.clz32:Kv,Gv=Math.log,Yv=Math.LN2;function Kv(e){return e>>>=0,e===0?32:31-(Gv(e)/Yv|0)|0}var Ga=64,Ya=4194304;function Ds(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Lo(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,a=e.suspendedLanes,l=e.pingedLanes,c=n&268435455;if(c!==0){var u=c&~a;u!==0?s=Ds(u):(l&=c,l!==0&&(s=Ds(l)))}else c=n&~a,c!==0?s=Ds(c):l!==0&&(s=Ds(l));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-Bn(t),a=1<<n,s|=e[n],t&=~a;return s}function Qv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jv(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var c=31-Bn(l),u=1<<c,f=a[c];f===-1?(!(u&n)||u&s)&&(a[c]=Qv(u,t)):f<=t&&(e.expiredLanes|=u),l&=~u}}function Oc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $p(){var e=Ga;return Ga<<=1,!(Ga&4194240)&&(Ga=64),e}function Ql(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ya(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bn(t),e[t]=n}function Xv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Bn(n),l=1<<a;t[a]=0,s[a]=-1,e[a]=-1,n&=~l}}function Od(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Bn(n),a=1<<s;a&t|e[s]&t&&(e[s]|=t),n&=~a}}var Qe=0;function Wp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Hp,Dd,Zp,Vp,qp,Dc=!1,Ka=[],Ur=null,Mr=null,Or=null,ea=new Map,ta=new Map,Tr=[],ex="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tf(e,t){switch(e){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":Or=null;break;case"pointerover":case"pointerout":ea.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ta.delete(t.pointerId)}}function Es(e,t,n,s,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:l,targetContainers:[a]},t!==null&&(t=xa(t),t!==null&&Dd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function tx(e,t,n,s,a){switch(t){case"focusin":return Ur=Es(Ur,e,t,n,s,a),!0;case"dragenter":return Mr=Es(Mr,e,t,n,s,a),!0;case"mouseover":return Or=Es(Or,e,t,n,s,a),!0;case"pointerover":var l=a.pointerId;return ea.set(l,Es(ea.get(l)||null,e,t,n,s,a)),!0;case"gotpointercapture":return l=a.pointerId,ta.set(l,Es(ta.get(l)||null,e,t,n,s,a)),!0}return!1}function Gp(e){var t=pi(e.target);if(t!==null){var n=Ii(t);if(n!==null){if(t=n.tag,t===13){if(t=Fp(n),t!==null){e.blockedOn=t,qp(e.priority,function(){Zp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ho(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=zc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Ac=s,n.target.dispatchEvent(s),Ac=null}else return t=xa(n),t!==null&&Dd(t),e.blockedOn=n,!1;t.shift()}return!0}function Bf(e,t,n){ho(e)&&n.delete(t)}function nx(){Dc=!1,Ur!==null&&ho(Ur)&&(Ur=null),Mr!==null&&ho(Mr)&&(Mr=null),Or!==null&&ho(Or)&&(Or=null),ea.forEach(Bf),ta.forEach(Bf)}function Ts(e,t){e.blockedOn===t&&(e.blockedOn=null,Dc||(Dc=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,nx)))}function na(e){function t(a){return Ts(a,e)}if(0<Ka.length){Ts(Ka[0],e);for(var n=1;n<Ka.length;n++){var s=Ka[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Ur!==null&&Ts(Ur,e),Mr!==null&&Ts(Mr,e),Or!==null&&Ts(Or,e),ea.forEach(t),ta.forEach(t),n=0;n<Tr.length;n++)s=Tr[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Tr.length&&(n=Tr[0],n.blockedOn===null);)Gp(n),n.blockedOn===null&&Tr.shift()}var ns=hr.ReactCurrentBatchConfig,Eo=!0;function rx(e,t,n,s){var a=Qe,l=ns.transition;ns.transition=null;try{Qe=1,zd(e,t,n,s)}finally{Qe=a,ns.transition=l}}function ix(e,t,n,s){var a=Qe,l=ns.transition;ns.transition=null;try{Qe=4,zd(e,t,n,s)}finally{Qe=a,ns.transition=l}}function zd(e,t,n,s){if(Eo){var a=zc(e,t,n,s);if(a===null)oc(e,t,s,To,n),Tf(e,s);else if(tx(a,e,t,n,s))s.stopPropagation();else if(Tf(e,s),t&4&&-1<ex.indexOf(e)){for(;a!==null;){var l=xa(a);if(l!==null&&Hp(l),l=zc(e,t,n,s),l===null&&oc(e,t,s,To,n),l===a)break;a=l}a!==null&&s.stopPropagation()}else oc(e,t,s,null,n)}}var To=null;function zc(e,t,n,s){if(To=null,e=Ud(s),e=pi(e),e!==null)if(t=Ii(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Fp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return To=e,null}function Yp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zv()){case Md:return 1;case Dp:return 4;case Io:case Vv:return 16;case zp:return 536870912;default:return 16}default:return 16}}var Rr=null,$d=null,po=null;function Kp(){if(po)return po;var e,t=$d,n=t.length,s,a="value"in Rr?Rr.value:Rr.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var c=n-e;for(s=1;s<=c&&t[n-s]===a[l-s];s++);return po=a.slice(e,1<s?1-s:void 0)}function mo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Qa(){return!0}function Rf(){return!1}function cn(e){function t(n,s,a,l,c){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=l,this.target=c,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(l):l[u]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Qa:Rf,this.isPropagationStopped=Rf,this}return dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Qa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Qa)},persist:function(){},isPersistent:Qa}),t}var ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wd=cn(ps),va=dt({},ps,{view:0,detail:0}),sx=cn(va),Jl,Xl,Bs,Xo=dt({},va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bs&&(Bs&&e.type==="mousemove"?(Jl=e.screenX-Bs.screenX,Xl=e.screenY-Bs.screenY):Xl=Jl=0,Bs=e),Jl)},movementY:function(e){return"movementY"in e?e.movementY:Xl}}),Af=cn(Xo),ax=dt({},Xo,{dataTransfer:0}),ox=cn(ax),lx=dt({},va,{relatedTarget:0}),ec=cn(lx),cx=dt({},ps,{animationName:0,elapsedTime:0,pseudoElement:0}),dx=cn(cx),ux=dt({},ps,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fx=cn(ux),hx=dt({},ps,{data:0}),Ff=cn(hx),px={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gx[e])?!!t[e]:!1}function Hd(){return yx}var vx=dt({},va,{key:function(e){if(e.key){var t=px[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=mo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hd,charCode:function(e){return e.type==="keypress"?mo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xx=cn(vx),_x=dt({},Xo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uf=cn(_x),wx=dt({},va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hd}),jx=cn(wx),Sx=dt({},ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nx=cn(Sx),Cx=dt({},Xo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kx=cn(Cx),Px=[9,13,27,32],Zd=cr&&"CompositionEvent"in window,Hs=null;cr&&"documentMode"in document&&(Hs=document.documentMode);var bx=cr&&"TextEvent"in window&&!Hs,Qp=cr&&(!Zd||Hs&&8<Hs&&11>=Hs),Mf=" ",Of=!1;function Jp(e,t){switch(e){case"keyup":return Px.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wi=!1;function Ix(e,t){switch(e){case"compositionend":return Xp(t);case"keypress":return t.which!==32?null:(Of=!0,Mf);case"textInput":return e=t.data,e===Mf&&Of?null:e;default:return null}}function Lx(e,t){if(Wi)return e==="compositionend"||!Zd&&Jp(e,t)?(e=Kp(),po=$d=Rr=null,Wi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qp&&t.locale!=="ko"?null:t.data;default:return null}}var Ex={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Df(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ex[e.type]:t==="textarea"}function em(e,t,n,s){Ep(s),t=Bo(t,"onChange"),0<t.length&&(n=new Wd("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Zs=null,ra=null;function Tx(e){um(e,0)}function el(e){var t=Vi(e);if(Np(t))return e}function Bx(e,t){if(e==="change")return t}var tm=!1;if(cr){var tc;if(cr){var nc="oninput"in document;if(!nc){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),nc=typeof zf.oninput=="function"}tc=nc}else tc=!1;tm=tc&&(!document.documentMode||9<document.documentMode)}function $f(){Zs&&(Zs.detachEvent("onpropertychange",nm),ra=Zs=null)}function nm(e){if(e.propertyName==="value"&&el(ra)){var t=[];em(t,ra,e,Ud(e)),Ap(Tx,t)}}function Rx(e,t,n){e==="focusin"?($f(),Zs=t,ra=n,Zs.attachEvent("onpropertychange",nm)):e==="focusout"&&$f()}function Ax(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return el(ra)}function Fx(e,t){if(e==="click")return el(t)}function Ux(e,t){if(e==="input"||e==="change")return el(t)}function Mx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var An=typeof Object.is=="function"?Object.is:Mx;function ia(e,t){if(An(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!Sc.call(t,a)||!An(e[a],t[a]))return!1}return!0}function Wf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hf(e,t){var n=Wf(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wf(n)}}function rm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function im(){for(var e=window,t=ko();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ko(e.document)}return t}function Vd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ox(e){var t=im(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&rm(n.ownerDocument.documentElement,n)){if(s!==null&&Vd(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(s.start,a);s=s.end===void 0?l:Math.min(s.end,a),!e.extend&&l>s&&(a=s,s=l,l=a),a=Hf(n,l);var c=Hf(n,s);a&&c&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>s?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dx=cr&&"documentMode"in document&&11>=document.documentMode,Hi=null,$c=null,Vs=null,Wc=!1;function Zf(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wc||Hi==null||Hi!==ko(s)||(s=Hi,"selectionStart"in s&&Vd(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Vs&&ia(Vs,s)||(Vs=s,s=Bo($c,"onSelect"),0<s.length&&(t=new Wd("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Hi)))}function Ja(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Zi={animationend:Ja("Animation","AnimationEnd"),animationiteration:Ja("Animation","AnimationIteration"),animationstart:Ja("Animation","AnimationStart"),transitionend:Ja("Transition","TransitionEnd")},rc={},sm={};cr&&(sm=document.createElement("div").style,"AnimationEvent"in window||(delete Zi.animationend.animation,delete Zi.animationiteration.animation,delete Zi.animationstart.animation),"TransitionEvent"in window||delete Zi.transitionend.transition);function tl(e){if(rc[e])return rc[e];if(!Zi[e])return e;var t=Zi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in sm)return rc[e]=t[n];return e}var am=tl("animationend"),om=tl("animationiteration"),lm=tl("animationstart"),cm=tl("transitionend"),dm=new Map,Vf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(e,t){dm.set(e,t),bi(t,[e])}for(var ic=0;ic<Vf.length;ic++){var sc=Vf[ic],zx=sc.toLowerCase(),$x=sc[0].toUpperCase()+sc.slice(1);Gr(zx,"on"+$x)}Gr(am,"onAnimationEnd");Gr(om,"onAnimationIteration");Gr(lm,"onAnimationStart");Gr("dblclick","onDoubleClick");Gr("focusin","onFocus");Gr("focusout","onBlur");Gr(cm,"onTransitionEnd");ss("onMouseEnter",["mouseout","mouseover"]);ss("onMouseLeave",["mouseout","mouseover"]);ss("onPointerEnter",["pointerout","pointerover"]);ss("onPointerLeave",["pointerout","pointerover"]);bi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bi("onBeforeInput",["compositionend","keypress","textInput","paste"]);bi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wx=new Set("cancel close invalid load scroll toggle".split(" ").concat(zs));function qf(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,zv(s,t,void 0,e),e.currentTarget=null}function um(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],a=s.event;s=s.listeners;e:{var l=void 0;if(t)for(var c=s.length-1;0<=c;c--){var u=s[c],f=u.instance,p=u.currentTarget;if(u=u.listener,f!==l&&a.isPropagationStopped())break e;qf(a,u,p),l=f}else for(c=0;c<s.length;c++){if(u=s[c],f=u.instance,p=u.currentTarget,u=u.listener,f!==l&&a.isPropagationStopped())break e;qf(a,u,p),l=f}}}if(bo)throw e=Mc,bo=!1,Mc=null,e}function rt(e,t){var n=t[Gc];n===void 0&&(n=t[Gc]=new Set);var s=e+"__bubble";n.has(s)||(fm(t,e,2,!1),n.add(s))}function ac(e,t,n){var s=0;t&&(s|=4),fm(n,e,s,t)}var Xa="_reactListening"+Math.random().toString(36).slice(2);function sa(e){if(!e[Xa]){e[Xa]=!0,xp.forEach(function(n){n!=="selectionchange"&&(Wx.has(n)||ac(n,!1,e),ac(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Xa]||(t[Xa]=!0,ac("selectionchange",!1,t))}}function fm(e,t,n,s){switch(Yp(t)){case 1:var a=rx;break;case 4:a=ix;break;default:a=zd}n=a.bind(null,t,n,e),a=void 0,!Uc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function oc(e,t,n,s,a){var l=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var c=s.tag;if(c===3||c===4){var u=s.stateNode.containerInfo;if(u===a||u.nodeType===8&&u.parentNode===a)break;if(c===4)for(c=s.return;c!==null;){var f=c.tag;if((f===3||f===4)&&(f=c.stateNode.containerInfo,f===a||f.nodeType===8&&f.parentNode===a))return;c=c.return}for(;u!==null;){if(c=pi(u),c===null)return;if(f=c.tag,f===5||f===6){s=l=c;continue e}u=u.parentNode}}s=s.return}Ap(function(){var p=l,g=Ud(n),x=[];e:{var j=dm.get(e);if(j!==void 0){var k=Wd,C=e;switch(e){case"keypress":if(mo(n)===0)break e;case"keydown":case"keyup":k=xx;break;case"focusin":C="focus",k=ec;break;case"focusout":C="blur",k=ec;break;case"beforeblur":case"afterblur":k=ec;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Af;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=ox;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=jx;break;case am:case om:case lm:k=dx;break;case cm:k=Nx;break;case"scroll":k=sx;break;case"wheel":k=kx;break;case"copy":case"cut":case"paste":k=fx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Uf}var S=(t&4)!==0,P=!S&&e==="scroll",_=S?j!==null?j+"Capture":null:j;S=[];for(var v=p,w;v!==null;){w=v;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,_!==null&&(b=Xs(v,_),b!=null&&S.push(aa(v,b,w)))),P)break;v=v.return}0<S.length&&(j=new k(j,C,null,n,g),x.push({event:j,listeners:S}))}}if(!(t&7)){e:{if(j=e==="mouseover"||e==="pointerover",k=e==="mouseout"||e==="pointerout",j&&n!==Ac&&(C=n.relatedTarget||n.fromElement)&&(pi(C)||C[dr]))break e;if((k||j)&&(j=g.window===g?g:(j=g.ownerDocument)?j.defaultView||j.parentWindow:window,k?(C=n.relatedTarget||n.toElement,k=p,C=C?pi(C):null,C!==null&&(P=Ii(C),C!==P||C.tag!==5&&C.tag!==6)&&(C=null)):(k=null,C=p),k!==C)){if(S=Af,b="onMouseLeave",_="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(S=Uf,b="onPointerLeave",_="onPointerEnter",v="pointer"),P=k==null?j:Vi(k),w=C==null?j:Vi(C),j=new S(b,v+"leave",k,n,g),j.target=P,j.relatedTarget=w,b=null,pi(g)===p&&(S=new S(_,v+"enter",C,n,g),S.target=w,S.relatedTarget=P,b=S),P=b,k&&C)t:{for(S=k,_=C,v=0,w=S;w;w=Di(w))v++;for(w=0,b=_;b;b=Di(b))w++;for(;0<v-w;)S=Di(S),v--;for(;0<w-v;)_=Di(_),w--;for(;v--;){if(S===_||_!==null&&S===_.alternate)break t;S=Di(S),_=Di(_)}S=null}else S=null;k!==null&&Gf(x,j,k,S,!1),C!==null&&P!==null&&Gf(x,P,C,S,!0)}}e:{if(j=p?Vi(p):window,k=j.nodeName&&j.nodeName.toLowerCase(),k==="select"||k==="input"&&j.type==="file")var B=Bx;else if(Df(j))if(tm)B=Ux;else{B=Ax;var T=Rx}else(k=j.nodeName)&&k.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(B=Fx);if(B&&(B=B(e,p))){em(x,B,n,g);break e}T&&T(e,j,p),e==="focusout"&&(T=j._wrapperState)&&T.controlled&&j.type==="number"&&Lc(j,"number",j.value)}switch(T=p?Vi(p):window,e){case"focusin":(Df(T)||T.contentEditable==="true")&&(Hi=T,$c=p,Vs=null);break;case"focusout":Vs=$c=Hi=null;break;case"mousedown":Wc=!0;break;case"contextmenu":case"mouseup":case"dragend":Wc=!1,Zf(x,n,g);break;case"selectionchange":if(Dx)break;case"keydown":case"keyup":Zf(x,n,g)}var F;if(Zd)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Wi?Jp(e,n)&&(R="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(Qp&&n.locale!=="ko"&&(Wi||R!=="onCompositionStart"?R==="onCompositionEnd"&&Wi&&(F=Kp()):(Rr=g,$d="value"in Rr?Rr.value:Rr.textContent,Wi=!0)),T=Bo(p,R),0<T.length&&(R=new Ff(R,e,null,n,g),x.push({event:R,listeners:T}),F?R.data=F:(F=Xp(n),F!==null&&(R.data=F)))),(F=bx?Ix(e,n):Lx(e,n))&&(p=Bo(p,"onBeforeInput"),0<p.length&&(g=new Ff("onBeforeInput","beforeinput",null,n,g),x.push({event:g,listeners:p}),g.data=F))}um(x,t)})}function aa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Bo(e,t){for(var n=t+"Capture",s=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=Xs(e,n),l!=null&&s.unshift(aa(e,l,a)),l=Xs(e,t),l!=null&&s.push(aa(e,l,a))),e=e.return}return s}function Di(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gf(e,t,n,s,a){for(var l=t._reactName,c=[];n!==null&&n!==s;){var u=n,f=u.alternate,p=u.stateNode;if(f!==null&&f===s)break;u.tag===5&&p!==null&&(u=p,a?(f=Xs(n,l),f!=null&&c.unshift(aa(n,f,u))):a||(f=Xs(n,l),f!=null&&c.push(aa(n,f,u)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var Hx=/\r\n?/g,Zx=/\u0000|\uFFFD/g;function Yf(e){return(typeof e=="string"?e:""+e).replace(Hx,`
`).replace(Zx,"")}function eo(e,t,n){if(t=Yf(t),Yf(e)!==t&&n)throw Error(pe(425))}function Ro(){}var Hc=null,Zc=null;function Vc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qc=typeof setTimeout=="function"?setTimeout:void 0,Vx=typeof clearTimeout=="function"?clearTimeout:void 0,Kf=typeof Promise=="function"?Promise:void 0,qx=typeof queueMicrotask=="function"?queueMicrotask:typeof Kf<"u"?function(e){return Kf.resolve(null).then(e).catch(Gx)}:qc;function Gx(e){setTimeout(function(){throw e})}function lc(e,t){var n=t,s=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){e.removeChild(a),na(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);na(t)}function Dr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Qf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ms=Math.random().toString(36).slice(2),qn="__reactFiber$"+ms,oa="__reactProps$"+ms,dr="__reactContainer$"+ms,Gc="__reactEvents$"+ms,Yx="__reactListeners$"+ms,Kx="__reactHandles$"+ms;function pi(e){var t=e[qn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[dr]||n[qn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Qf(e);e!==null;){if(n=e[qn])return n;e=Qf(e)}return t}e=n,n=e.parentNode}return null}function xa(e){return e=e[qn]||e[dr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function nl(e){return e[oa]||null}var Yc=[],qi=-1;function Yr(e){return{current:e}}function it(e){0>qi||(e.current=Yc[qi],Yc[qi]=null,qi--)}function et(e,t){qi++,Yc[qi]=e.current,e.current=t}var qr={},Ft=Yr(qr),Kt=Yr(!1),ji=qr;function as(e,t){var n=e.type.contextTypes;if(!n)return qr;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Qt(e){return e=e.childContextTypes,e!=null}function Ao(){it(Kt),it(Ft)}function Jf(e,t,n){if(Ft.current!==qr)throw Error(pe(168));et(Ft,t),et(Kt,n)}function hm(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(pe(108,Rv(e)||"Unknown",a));return dt({},n,s)}function Fo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||qr,ji=Ft.current,et(Ft,e),et(Kt,Kt.current),!0}function Xf(e,t,n){var s=e.stateNode;if(!s)throw Error(pe(169));n?(e=hm(e,t,ji),s.__reactInternalMemoizedMergedChildContext=e,it(Kt),it(Ft),et(Ft,e)):it(Kt),et(Kt,n)}var sr=null,rl=!1,cc=!1;function pm(e){sr===null?sr=[e]:sr.push(e)}function Qx(e){rl=!0,pm(e)}function Kr(){if(!cc&&sr!==null){cc=!0;var e=0,t=Qe;try{var n=sr;for(Qe=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}sr=null,rl=!1}catch(a){throw sr!==null&&(sr=sr.slice(e+1)),Op(Md,Kr),a}finally{Qe=t,cc=!1}}return null}var Gi=[],Yi=0,Uo=null,Mo=0,gn=[],yn=0,Si=null,ar=1,or="";function fi(e,t){Gi[Yi++]=Mo,Gi[Yi++]=Uo,Uo=e,Mo=t}function mm(e,t,n){gn[yn++]=ar,gn[yn++]=or,gn[yn++]=Si,Si=e;var s=ar;e=or;var a=32-Bn(s)-1;s&=~(1<<a),n+=1;var l=32-Bn(t)+a;if(30<l){var c=a-a%5;l=(s&(1<<c)-1).toString(32),s>>=c,a-=c,ar=1<<32-Bn(t)+a|n<<a|s,or=l+e}else ar=1<<l|n<<a|s,or=e}function qd(e){e.return!==null&&(fi(e,1),mm(e,1,0))}function Gd(e){for(;e===Uo;)Uo=Gi[--Yi],Gi[Yi]=null,Mo=Gi[--Yi],Gi[Yi]=null;for(;e===Si;)Si=gn[--yn],gn[yn]=null,or=gn[--yn],gn[yn]=null,ar=gn[--yn],gn[yn]=null}var an=null,sn=null,st=!1,En=null;function gm(e,t){var n=vn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function eh(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,an=e,sn=Dr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,an=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Si!==null?{id:ar,overflow:or}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=vn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,an=e,sn=null,!0):!1;default:return!1}}function Kc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Qc(e){if(st){var t=sn;if(t){var n=t;if(!eh(e,t)){if(Kc(e))throw Error(pe(418));t=Dr(n.nextSibling);var s=an;t&&eh(e,t)?gm(s,n):(e.flags=e.flags&-4097|2,st=!1,an=e)}}else{if(Kc(e))throw Error(pe(418));e.flags=e.flags&-4097|2,st=!1,an=e}}}function th(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;an=e}function to(e){if(e!==an)return!1;if(!st)return th(e),st=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vc(e.type,e.memoizedProps)),t&&(t=sn)){if(Kc(e))throw ym(),Error(pe(418));for(;t;)gm(e,t),t=Dr(t.nextSibling)}if(th(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){sn=Dr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=an?Dr(e.stateNode.nextSibling):null;return!0}function ym(){for(var e=sn;e;)e=Dr(e.nextSibling)}function os(){sn=an=null,st=!1}function Yd(e){En===null?En=[e]:En.push(e)}var Jx=hr.ReactCurrentBatchConfig;function Rs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var s=n.stateNode}if(!s)throw Error(pe(147,e));var a=s,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(c){var u=a.refs;c===null?delete u[l]:u[l]=c},t._stringRef=l,t)}if(typeof e!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,e))}return e}function no(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function nh(e){var t=e._init;return t(e._payload)}function vm(e){function t(_,v){if(e){var w=_.deletions;w===null?(_.deletions=[v],_.flags|=16):w.push(v)}}function n(_,v){if(!e)return null;for(;v!==null;)t(_,v),v=v.sibling;return null}function s(_,v){for(_=new Map;v!==null;)v.key!==null?_.set(v.key,v):_.set(v.index,v),v=v.sibling;return _}function a(_,v){return _=Hr(_,v),_.index=0,_.sibling=null,_}function l(_,v,w){return _.index=w,e?(w=_.alternate,w!==null?(w=w.index,w<v?(_.flags|=2,v):w):(_.flags|=2,v)):(_.flags|=1048576,v)}function c(_){return e&&_.alternate===null&&(_.flags|=2),_}function u(_,v,w,b){return v===null||v.tag!==6?(v=gc(w,_.mode,b),v.return=_,v):(v=a(v,w),v.return=_,v)}function f(_,v,w,b){var B=w.type;return B===$i?g(_,v,w.props.children,b,w.key):v!==null&&(v.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Lr&&nh(B)===v.type)?(b=a(v,w.props),b.ref=Rs(_,v,w),b.return=_,b):(b=jo(w.type,w.key,w.props,null,_.mode,b),b.ref=Rs(_,v,w),b.return=_,b)}function p(_,v,w,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=yc(w,_.mode,b),v.return=_,v):(v=a(v,w.children||[]),v.return=_,v)}function g(_,v,w,b,B){return v===null||v.tag!==7?(v=xi(w,_.mode,b,B),v.return=_,v):(v=a(v,w),v.return=_,v)}function x(_,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=gc(""+v,_.mode,w),v.return=_,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Za:return w=jo(v.type,v.key,v.props,null,_.mode,w),w.ref=Rs(_,null,v),w.return=_,w;case zi:return v=yc(v,_.mode,w),v.return=_,v;case Lr:var b=v._init;return x(_,b(v._payload),w)}if(Os(v)||Is(v))return v=xi(v,_.mode,w,null),v.return=_,v;no(_,v)}return null}function j(_,v,w,b){var B=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return B!==null?null:u(_,v,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Za:return w.key===B?f(_,v,w,b):null;case zi:return w.key===B?p(_,v,w,b):null;case Lr:return B=w._init,j(_,v,B(w._payload),b)}if(Os(w)||Is(w))return B!==null?null:g(_,v,w,b,null);no(_,w)}return null}function k(_,v,w,b,B){if(typeof b=="string"&&b!==""||typeof b=="number")return _=_.get(w)||null,u(v,_,""+b,B);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Za:return _=_.get(b.key===null?w:b.key)||null,f(v,_,b,B);case zi:return _=_.get(b.key===null?w:b.key)||null,p(v,_,b,B);case Lr:var T=b._init;return k(_,v,w,T(b._payload),B)}if(Os(b)||Is(b))return _=_.get(w)||null,g(v,_,b,B,null);no(v,b)}return null}function C(_,v,w,b){for(var B=null,T=null,F=v,R=v=0,O=null;F!==null&&R<w.length;R++){F.index>R?(O=F,F=null):O=F.sibling;var I=j(_,F,w[R],b);if(I===null){F===null&&(F=O);break}e&&F&&I.alternate===null&&t(_,F),v=l(I,v,R),T===null?B=I:T.sibling=I,T=I,F=O}if(R===w.length)return n(_,F),st&&fi(_,R),B;if(F===null){for(;R<w.length;R++)F=x(_,w[R],b),F!==null&&(v=l(F,v,R),T===null?B=F:T.sibling=F,T=F);return st&&fi(_,R),B}for(F=s(_,F);R<w.length;R++)O=k(F,_,R,w[R],b),O!==null&&(e&&O.alternate!==null&&F.delete(O.key===null?R:O.key),v=l(O,v,R),T===null?B=O:T.sibling=O,T=O);return e&&F.forEach(function(D){return t(_,D)}),st&&fi(_,R),B}function S(_,v,w,b){var B=Is(w);if(typeof B!="function")throw Error(pe(150));if(w=B.call(w),w==null)throw Error(pe(151));for(var T=B=null,F=v,R=v=0,O=null,I=w.next();F!==null&&!I.done;R++,I=w.next()){F.index>R?(O=F,F=null):O=F.sibling;var D=j(_,F,I.value,b);if(D===null){F===null&&(F=O);break}e&&F&&D.alternate===null&&t(_,F),v=l(D,v,R),T===null?B=D:T.sibling=D,T=D,F=O}if(I.done)return n(_,F),st&&fi(_,R),B;if(F===null){for(;!I.done;R++,I=w.next())I=x(_,I.value,b),I!==null&&(v=l(I,v,R),T===null?B=I:T.sibling=I,T=I);return st&&fi(_,R),B}for(F=s(_,F);!I.done;R++,I=w.next())I=k(F,_,R,I.value,b),I!==null&&(e&&I.alternate!==null&&F.delete(I.key===null?R:I.key),v=l(I,v,R),T===null?B=I:T.sibling=I,T=I);return e&&F.forEach(function(q){return t(_,q)}),st&&fi(_,R),B}function P(_,v,w,b){if(typeof w=="object"&&w!==null&&w.type===$i&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Za:e:{for(var B=w.key,T=v;T!==null;){if(T.key===B){if(B=w.type,B===$i){if(T.tag===7){n(_,T.sibling),v=a(T,w.props.children),v.return=_,_=v;break e}}else if(T.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Lr&&nh(B)===T.type){n(_,T.sibling),v=a(T,w.props),v.ref=Rs(_,T,w),v.return=_,_=v;break e}n(_,T);break}else t(_,T);T=T.sibling}w.type===$i?(v=xi(w.props.children,_.mode,b,w.key),v.return=_,_=v):(b=jo(w.type,w.key,w.props,null,_.mode,b),b.ref=Rs(_,v,w),b.return=_,_=b)}return c(_);case zi:e:{for(T=w.key;v!==null;){if(v.key===T)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(_,v.sibling),v=a(v,w.children||[]),v.return=_,_=v;break e}else{n(_,v);break}else t(_,v);v=v.sibling}v=yc(w,_.mode,b),v.return=_,_=v}return c(_);case Lr:return T=w._init,P(_,v,T(w._payload),b)}if(Os(w))return C(_,v,w,b);if(Is(w))return S(_,v,w,b);no(_,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(_,v.sibling),v=a(v,w),v.return=_,_=v):(n(_,v),v=gc(w,_.mode,b),v.return=_,_=v),c(_)):n(_,v)}return P}var ls=vm(!0),xm=vm(!1),Oo=Yr(null),Do=null,Ki=null,Kd=null;function Qd(){Kd=Ki=Do=null}function Jd(e){var t=Oo.current;it(Oo),e._currentValue=t}function Jc(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function rs(e,t){Do=e,Kd=Ki=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yt=!0),e.firstContext=null)}function _n(e){var t=e._currentValue;if(Kd!==e)if(e={context:e,memoizedValue:t,next:null},Ki===null){if(Do===null)throw Error(pe(308));Ki=e,Do.dependencies={lanes:0,firstContext:e}}else Ki=Ki.next=e;return t}var mi=null;function Xd(e){mi===null?mi=[e]:mi.push(e)}function _m(e,t,n,s){var a=t.interleaved;return a===null?(n.next=n,Xd(t)):(n.next=a.next,a.next=n),t.interleaved=n,ur(e,s)}function ur(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Er=!1;function eu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Ze&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,ur(e,n)}return a=s.interleaved,a===null?(t.next=t,Xd(s)):(t.next=a.next,a.next=t),s.interleaved=t,ur(e,n)}function go(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Od(e,n)}}function rh(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=c:l=l.next=c,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zo(e,t,n,s){var a=e.updateQueue;Er=!1;var l=a.firstBaseUpdate,c=a.lastBaseUpdate,u=a.shared.pending;if(u!==null){a.shared.pending=null;var f=u,p=f.next;f.next=null,c===null?l=p:c.next=p,c=f;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==c&&(u===null?g.firstBaseUpdate=p:u.next=p,g.lastBaseUpdate=f))}if(l!==null){var x=a.baseState;c=0,g=p=f=null,u=l;do{var j=u.lane,k=u.eventTime;if((s&j)===j){g!==null&&(g=g.next={eventTime:k,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=e,S=u;switch(j=t,k=n,S.tag){case 1:if(C=S.payload,typeof C=="function"){x=C.call(k,x,j);break e}x=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=S.payload,j=typeof C=="function"?C.call(k,x,j):C,j==null)break e;x=dt({},x,j);break e;case 2:Er=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,j=a.effects,j===null?a.effects=[u]:j.push(u))}else k={eventTime:k,lane:j,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(p=g=k,f=x):g=g.next=k,c|=j;if(u=u.next,u===null){if(u=a.shared.pending,u===null)break;j=u,u=j.next,j.next=null,a.lastBaseUpdate=j,a.shared.pending=null}}while(!0);if(g===null&&(f=x),a.baseState=f,a.firstBaseUpdate=p,a.lastBaseUpdate=g,t=a.shared.interleaved,t!==null){a=t;do c|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);Ci|=c,e.lanes=c,e.memoizedState=x}}function ih(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(pe(191,a));a.call(s)}}}var _a={},Yn=Yr(_a),la=Yr(_a),ca=Yr(_a);function gi(e){if(e===_a)throw Error(pe(174));return e}function tu(e,t){switch(et(ca,t),et(la,e),et(Yn,_a),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Tc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Tc(t,e)}it(Yn),et(Yn,t)}function cs(){it(Yn),it(la),it(ca)}function jm(e){gi(ca.current);var t=gi(Yn.current),n=Tc(t,e.type);t!==n&&(et(la,e),et(Yn,n))}function nu(e){la.current===e&&(it(Yn),it(la))}var lt=Yr(0);function $o(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var dc=[];function ru(){for(var e=0;e<dc.length;e++)dc[e]._workInProgressVersionPrimary=null;dc.length=0}var yo=hr.ReactCurrentDispatcher,uc=hr.ReactCurrentBatchConfig,Ni=0,ct=null,xt=null,St=null,Wo=!1,qs=!1,da=0,Xx=0;function Et(){throw Error(pe(321))}function iu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!An(e[n],t[n]))return!1;return!0}function su(e,t,n,s,a,l){if(Ni=l,ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yo.current=e===null||e.memoizedState===null?r0:i0,e=n(s,a),qs){l=0;do{if(qs=!1,da=0,25<=l)throw Error(pe(301));l+=1,St=xt=null,t.updateQueue=null,yo.current=s0,e=n(s,a)}while(qs)}if(yo.current=Ho,t=xt!==null&&xt.next!==null,Ni=0,St=xt=ct=null,Wo=!1,t)throw Error(pe(300));return e}function au(){var e=da!==0;return da=0,e}function Zn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?ct.memoizedState=St=e:St=St.next=e,St}function wn(){if(xt===null){var e=ct.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=St===null?ct.memoizedState:St.next;if(t!==null)St=t,xt=e;else{if(e===null)throw Error(pe(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},St===null?ct.memoizedState=St=e:St=St.next=e}return St}function ua(e,t){return typeof t=="function"?t(e):t}function fc(e){var t=wn(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=xt,a=s.baseQueue,l=n.pending;if(l!==null){if(a!==null){var c=a.next;a.next=l.next,l.next=c}s.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,s=s.baseState;var u=c=null,f=null,p=l;do{var g=p.lane;if((Ni&g)===g)f!==null&&(f=f.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),s=p.hasEagerState?p.eagerState:e(s,p.action);else{var x={lane:g,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};f===null?(u=f=x,c=s):f=f.next=x,ct.lanes|=g,Ci|=g}p=p.next}while(p!==null&&p!==l);f===null?c=s:f.next=u,An(s,t.memoizedState)||(Yt=!0),t.memoizedState=s,t.baseState=c,t.baseQueue=f,n.lastRenderedState=s}if(e=n.interleaved,e!==null){a=e;do l=a.lane,ct.lanes|=l,Ci|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function hc(e){var t=wn(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var c=a=a.next;do l=e(l,c.action),c=c.next;while(c!==a);An(l,t.memoizedState)||(Yt=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,s]}function Sm(){}function Nm(e,t){var n=ct,s=wn(),a=t(),l=!An(s.memoizedState,a);if(l&&(s.memoizedState=a,Yt=!0),s=s.queue,ou(Pm.bind(null,n,s,e),[e]),s.getSnapshot!==t||l||St!==null&&St.memoizedState.tag&1){if(n.flags|=2048,fa(9,km.bind(null,n,s,a,t),void 0,null),Nt===null)throw Error(pe(349));Ni&30||Cm(n,t,a)}return a}function Cm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function km(e,t,n,s){t.value=n,t.getSnapshot=s,bm(t)&&Im(e)}function Pm(e,t,n){return n(function(){bm(t)&&Im(e)})}function bm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!An(e,n)}catch{return!0}}function Im(e){var t=ur(e,1);t!==null&&Rn(t,e,1,-1)}function sh(e){var t=Zn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:e},t.queue=e,e=e.dispatch=n0.bind(null,ct,e),[t.memoizedState,e]}function fa(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Lm(){return wn().memoizedState}function vo(e,t,n,s){var a=Zn();ct.flags|=e,a.memoizedState=fa(1|t,n,void 0,s===void 0?null:s)}function il(e,t,n,s){var a=wn();s=s===void 0?null:s;var l=void 0;if(xt!==null){var c=xt.memoizedState;if(l=c.destroy,s!==null&&iu(s,c.deps)){a.memoizedState=fa(t,n,l,s);return}}ct.flags|=e,a.memoizedState=fa(1|t,n,l,s)}function ah(e,t){return vo(8390656,8,e,t)}function ou(e,t){return il(2048,8,e,t)}function Em(e,t){return il(4,2,e,t)}function Tm(e,t){return il(4,4,e,t)}function Bm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Rm(e,t,n){return n=n!=null?n.concat([e]):null,il(4,4,Bm.bind(null,t,e),n)}function lu(){}function Am(e,t){var n=wn();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&iu(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Fm(e,t){var n=wn();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&iu(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Um(e,t,n){return Ni&21?(An(n,t)||(n=$p(),ct.lanes|=n,Ci|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yt=!0),e.memoizedState=n)}function e0(e,t){var n=Qe;Qe=n!==0&&4>n?n:4,e(!0);var s=uc.transition;uc.transition={};try{e(!1),t()}finally{Qe=n,uc.transition=s}}function Mm(){return wn().memoizedState}function t0(e,t,n){var s=Wr(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Om(e))Dm(t,n);else if(n=_m(e,t,n,s),n!==null){var a=Wt();Rn(n,e,s,a),zm(n,t,s)}}function n0(e,t,n){var s=Wr(e),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Om(e))Dm(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var c=t.lastRenderedState,u=l(c,n);if(a.hasEagerState=!0,a.eagerState=u,An(u,c)){var f=t.interleaved;f===null?(a.next=a,Xd(t)):(a.next=f.next,f.next=a),t.interleaved=a;return}}catch{}finally{}n=_m(e,t,a,s),n!==null&&(a=Wt(),Rn(n,e,s,a),zm(n,t,s))}}function Om(e){var t=e.alternate;return e===ct||t!==null&&t===ct}function Dm(e,t){qs=Wo=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zm(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Od(e,n)}}var Ho={readContext:_n,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},r0={readContext:_n,useCallback:function(e,t){return Zn().memoizedState=[e,t===void 0?null:t],e},useContext:_n,useEffect:ah,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,vo(4194308,4,Bm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return vo(4,2,e,t)},useMemo:function(e,t){var n=Zn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Zn();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=t0.bind(null,ct,e),[s.memoizedState,e]},useRef:function(e){var t=Zn();return e={current:e},t.memoizedState=e},useState:sh,useDebugValue:lu,useDeferredValue:function(e){return Zn().memoizedState=e},useTransition:function(){var e=sh(!1),t=e[0];return e=e0.bind(null,e[1]),Zn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=ct,a=Zn();if(st){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=t(),Nt===null)throw Error(pe(349));Ni&30||Cm(s,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,ah(Pm.bind(null,s,l,e),[e]),s.flags|=2048,fa(9,km.bind(null,s,l,n,t),void 0,null),n},useId:function(){var e=Zn(),t=Nt.identifierPrefix;if(st){var n=or,s=ar;n=(s&~(1<<32-Bn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=da++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Xx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},i0={readContext:_n,useCallback:Am,useContext:_n,useEffect:ou,useImperativeHandle:Rm,useInsertionEffect:Em,useLayoutEffect:Tm,useMemo:Fm,useReducer:fc,useRef:Lm,useState:function(){return fc(ua)},useDebugValue:lu,useDeferredValue:function(e){var t=wn();return Um(t,xt.memoizedState,e)},useTransition:function(){var e=fc(ua)[0],t=wn().memoizedState;return[e,t]},useMutableSource:Sm,useSyncExternalStore:Nm,useId:Mm,unstable_isNewReconciler:!1},s0={readContext:_n,useCallback:Am,useContext:_n,useEffect:ou,useImperativeHandle:Rm,useInsertionEffect:Em,useLayoutEffect:Tm,useMemo:Fm,useReducer:hc,useRef:Lm,useState:function(){return hc(ua)},useDebugValue:lu,useDeferredValue:function(e){var t=wn();return xt===null?t.memoizedState=e:Um(t,xt.memoizedState,e)},useTransition:function(){var e=hc(ua)[0],t=wn().memoizedState;return[e,t]},useMutableSource:Sm,useSyncExternalStore:Nm,useId:Mm,unstable_isNewReconciler:!1};function In(e,t){if(e&&e.defaultProps){t=dt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Xc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:dt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var sl={isMounted:function(e){return(e=e._reactInternals)?Ii(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Wt(),a=Wr(e),l=lr(s,a);l.payload=t,n!=null&&(l.callback=n),t=zr(e,l,a),t!==null&&(Rn(t,e,a,s),go(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Wt(),a=Wr(e),l=lr(s,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=zr(e,l,a),t!==null&&(Rn(t,e,a,s),go(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Wt(),s=Wr(e),a=lr(n,s);a.tag=2,t!=null&&(a.callback=t),t=zr(e,a,s),t!==null&&(Rn(t,e,s,n),go(t,e,s))}};function oh(e,t,n,s,a,l,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,l,c):t.prototype&&t.prototype.isPureReactComponent?!ia(n,s)||!ia(a,l):!0}function $m(e,t,n){var s=!1,a=qr,l=t.contextType;return typeof l=="object"&&l!==null?l=_n(l):(a=Qt(t)?ji:Ft.current,s=t.contextTypes,l=(s=s!=null)?as(e,a):qr),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=sl,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function lh(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&sl.enqueueReplaceState(t,t.state,null)}function ed(e,t,n,s){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},eu(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=_n(l):(l=Qt(t)?ji:Ft.current,a.context=as(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Xc(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&sl.enqueueReplaceState(a,a.state,null),zo(e,n,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ds(e,t){try{var n="",s=t;do n+=Bv(s),s=s.return;while(s);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function pc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function td(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var a0=typeof WeakMap=="function"?WeakMap:Map;function Wm(e,t,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Vo||(Vo=!0,ud=s),td(e,t)},n}function Hm(e,t,n){n=lr(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;n.payload=function(){return s(a)},n.callback=function(){td(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){td(e,t),typeof s!="function"&&($r===null?$r=new Set([this]):$r.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function ch(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new a0;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(n)||(a.add(n),e=_0.bind(null,e,t,n),t.then(e,e))}function dh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function uh(e,t,n,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=lr(-1,1),t.tag=2,zr(n,t,1))),n.lanes|=1),e)}var o0=hr.ReactCurrentOwner,Yt=!1;function zt(e,t,n,s){t.child=e===null?xm(t,null,n,s):ls(t,e.child,n,s)}function fh(e,t,n,s,a){n=n.render;var l=t.ref;return rs(t,a),s=su(e,t,n,s,l,a),n=au(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fr(e,t,a)):(st&&n&&qd(t),t.flags|=1,zt(e,t,s,a),t.child)}function hh(e,t,n,s,a){if(e===null){var l=n.type;return typeof l=="function"&&!gu(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Zm(e,t,l,s,a)):(e=jo(n.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var c=l.memoizedProps;if(n=n.compare,n=n!==null?n:ia,n(c,s)&&e.ref===t.ref)return fr(e,t,a)}return t.flags|=1,e=Hr(l,s),e.ref=t.ref,e.return=t,t.child=e}function Zm(e,t,n,s,a){if(e!==null){var l=e.memoizedProps;if(ia(l,s)&&e.ref===t.ref)if(Yt=!1,t.pendingProps=s=l,(e.lanes&a)!==0)e.flags&131072&&(Yt=!0);else return t.lanes=e.lanes,fr(e,t,a)}return nd(e,t,n,s,a)}function Vm(e,t,n){var s=t.pendingProps,a=s.children,l=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(Ji,rn),rn|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,et(Ji,rn),rn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:n,et(Ji,rn),rn|=s}else l!==null?(s=l.baseLanes|n,t.memoizedState=null):s=n,et(Ji,rn),rn|=s;return zt(e,t,a,n),t.child}function qm(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function nd(e,t,n,s,a){var l=Qt(n)?ji:Ft.current;return l=as(t,l),rs(t,a),n=su(e,t,n,s,l,a),s=au(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fr(e,t,a)):(st&&s&&qd(t),t.flags|=1,zt(e,t,n,a),t.child)}function ph(e,t,n,s,a){if(Qt(n)){var l=!0;Fo(t)}else l=!1;if(rs(t,a),t.stateNode===null)xo(e,t),$m(t,n,s),ed(t,n,s,a),s=!0;else if(e===null){var c=t.stateNode,u=t.memoizedProps;c.props=u;var f=c.context,p=n.contextType;typeof p=="object"&&p!==null?p=_n(p):(p=Qt(n)?ji:Ft.current,p=as(t,p));var g=n.getDerivedStateFromProps,x=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function";x||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(u!==s||f!==p)&&lh(t,c,s,p),Er=!1;var j=t.memoizedState;c.state=j,zo(t,s,c,a),f=t.memoizedState,u!==s||j!==f||Kt.current||Er?(typeof g=="function"&&(Xc(t,n,g,s),f=t.memoizedState),(u=Er||oh(t,n,u,s,j,f,p))?(x||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=f),c.props=s,c.state=f,c.context=p,s=u):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,wm(e,t),u=t.memoizedProps,p=t.type===t.elementType?u:In(t.type,u),c.props=p,x=t.pendingProps,j=c.context,f=n.contextType,typeof f=="object"&&f!==null?f=_n(f):(f=Qt(n)?ji:Ft.current,f=as(t,f));var k=n.getDerivedStateFromProps;(g=typeof k=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(u!==x||j!==f)&&lh(t,c,s,f),Er=!1,j=t.memoizedState,c.state=j,zo(t,s,c,a);var C=t.memoizedState;u!==x||j!==C||Kt.current||Er?(typeof k=="function"&&(Xc(t,n,k,s),C=t.memoizedState),(p=Er||oh(t,n,p,s,j,C,f)||!1)?(g||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,C,f),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,C,f)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=C),c.props=s,c.state=C,c.context=f,s=p):(typeof c.componentDidUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),s=!1)}return rd(e,t,n,s,l,a)}function rd(e,t,n,s,a,l){qm(e,t);var c=(t.flags&128)!==0;if(!s&&!c)return a&&Xf(t,n,!1),fr(e,t,l);s=t.stateNode,o0.current=t;var u=c&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&c?(t.child=ls(t,e.child,null,l),t.child=ls(t,null,u,l)):zt(e,t,u,l),t.memoizedState=s.state,a&&Xf(t,n,!0),t.child}function Gm(e){var t=e.stateNode;t.pendingContext?Jf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Jf(e,t.context,!1),tu(e,t.containerInfo)}function mh(e,t,n,s,a){return os(),Yd(a),t.flags|=256,zt(e,t,n,s),t.child}var id={dehydrated:null,treeContext:null,retryLane:0};function sd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ym(e,t,n){var s=t.pendingProps,a=lt.current,l=!1,c=(t.flags&128)!==0,u;if((u=c)||(u=e!==null&&e.memoizedState===null?!1:(a&2)!==0),u?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),et(lt,a&1),e===null)return Qc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=s.children,e=s.fallback,l?(s=t.mode,l=t.child,c={mode:"hidden",children:c},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=c):l=ll(c,s,0,null),e=xi(e,s,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=sd(n),t.memoizedState=id,e):cu(t,c));if(a=e.memoizedState,a!==null&&(u=a.dehydrated,u!==null))return l0(e,t,c,s,u,a,n);if(l){l=s.fallback,c=t.mode,a=e.child,u=a.sibling;var f={mode:"hidden",children:s.children};return!(c&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=f,t.deletions=null):(s=Hr(a,f),s.subtreeFlags=a.subtreeFlags&14680064),u!==null?l=Hr(u,l):(l=xi(l,c,n,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,c=e.child.memoizedState,c=c===null?sd(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},l.memoizedState=c,l.childLanes=e.childLanes&~n,t.memoizedState=id,s}return l=e.child,e=l.sibling,s=Hr(l,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function cu(e,t){return t=ll({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ro(e,t,n,s){return s!==null&&Yd(s),ls(t,e.child,null,n),e=cu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function l0(e,t,n,s,a,l,c){if(n)return t.flags&256?(t.flags&=-257,s=pc(Error(pe(422))),ro(e,t,c,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=s.fallback,a=t.mode,s=ll({mode:"visible",children:s.children},a,0,null),l=xi(l,a,c,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,t.mode&1&&ls(t,e.child,null,c),t.child.memoizedState=sd(c),t.memoizedState=id,l);if(!(t.mode&1))return ro(e,t,c,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var u=s.dgst;return s=u,l=Error(pe(419)),s=pc(l,s,void 0),ro(e,t,c,s)}if(u=(c&e.childLanes)!==0,Yt||u){if(s=Nt,s!==null){switch(c&-c){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|c)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,ur(e,a),Rn(s,e,a,-1))}return mu(),s=pc(Error(pe(421))),ro(e,t,c,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=w0.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,sn=Dr(a.nextSibling),an=t,st=!0,En=null,e!==null&&(gn[yn++]=ar,gn[yn++]=or,gn[yn++]=Si,ar=e.id,or=e.overflow,Si=t),t=cu(t,s.children),t.flags|=4096,t)}function gh(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Jc(e.return,t,n)}function mc(e,t,n,s,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=n,l.tailMode=a)}function Km(e,t,n){var s=t.pendingProps,a=s.revealOrder,l=s.tail;if(zt(e,t,s.children,n),s=lt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gh(e,n,t);else if(e.tag===19)gh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(et(lt,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&$o(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),mc(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&$o(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}mc(t,!0,n,null,l);break;case"together":mc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ci|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,n=Hr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Hr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function c0(e,t,n){switch(t.tag){case 3:Gm(t),os();break;case 5:jm(t);break;case 1:Qt(t.type)&&Fo(t);break;case 4:tu(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;et(Oo,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(et(lt,lt.current&1),t.flags|=128,null):n&t.child.childLanes?Ym(e,t,n):(et(lt,lt.current&1),e=fr(e,t,n),e!==null?e.sibling:null);et(lt,lt.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return Km(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),et(lt,lt.current),s)break;return null;case 22:case 23:return t.lanes=0,Vm(e,t,n)}return fr(e,t,n)}var Qm,ad,Jm,Xm;Qm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ad=function(){};Jm=function(e,t,n,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,gi(Yn.current);var l=null;switch(n){case"input":a=bc(e,a),s=bc(e,s),l=[];break;case"select":a=dt({},a,{value:void 0}),s=dt({},s,{value:void 0}),l=[];break;case"textarea":a=Ec(e,a),s=Ec(e,s),l=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Ro)}Bc(n,s);var c;n=null;for(p in a)if(!s.hasOwnProperty(p)&&a.hasOwnProperty(p)&&a[p]!=null)if(p==="style"){var u=a[p];for(c in u)u.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Qs.hasOwnProperty(p)?l||(l=[]):(l=l||[]).push(p,null));for(p in s){var f=s[p];if(u=a!=null?a[p]:void 0,s.hasOwnProperty(p)&&f!==u&&(f!=null||u!=null))if(p==="style")if(u){for(c in u)!u.hasOwnProperty(c)||f&&f.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in f)f.hasOwnProperty(c)&&u[c]!==f[c]&&(n||(n={}),n[c]=f[c])}else n||(l||(l=[]),l.push(p,n)),n=f;else p==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,u=u?u.__html:void 0,f!=null&&u!==f&&(l=l||[]).push(p,f)):p==="children"?typeof f!="string"&&typeof f!="number"||(l=l||[]).push(p,""+f):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Qs.hasOwnProperty(p)?(f!=null&&p==="onScroll"&&rt("scroll",e),l||u===f||(l=[])):(l=l||[]).push(p,f))}n&&(l=l||[]).push("style",n);var p=l;(t.updateQueue=p)&&(t.flags|=4)}};Xm=function(e,t,n,s){n!==s&&(t.flags|=4)};function As(e,t){if(!st)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function d0(e,t,n){var s=t.pendingProps;switch(Gd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(t),null;case 1:return Qt(t.type)&&Ao(),Tt(t),null;case 3:return s=t.stateNode,cs(),it(Kt),it(Ft),ru(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(to(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,En!==null&&(pd(En),En=null))),ad(e,t),Tt(t),null;case 5:nu(t);var a=gi(ca.current);if(n=t.type,e!==null&&t.stateNode!=null)Jm(e,t,n,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(pe(166));return Tt(t),null}if(e=gi(Yn.current),to(t)){s=t.stateNode,n=t.type;var l=t.memoizedProps;switch(s[qn]=t,s[oa]=l,e=(t.mode&1)!==0,n){case"dialog":rt("cancel",s),rt("close",s);break;case"iframe":case"object":case"embed":rt("load",s);break;case"video":case"audio":for(a=0;a<zs.length;a++)rt(zs[a],s);break;case"source":rt("error",s);break;case"img":case"image":case"link":rt("error",s),rt("load",s);break;case"details":rt("toggle",s);break;case"input":Cf(s,l),rt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},rt("invalid",s);break;case"textarea":Pf(s,l),rt("invalid",s)}Bc(n,l),a=null;for(var c in l)if(l.hasOwnProperty(c)){var u=l[c];c==="children"?typeof u=="string"?s.textContent!==u&&(l.suppressHydrationWarning!==!0&&eo(s.textContent,u,e),a=["children",u]):typeof u=="number"&&s.textContent!==""+u&&(l.suppressHydrationWarning!==!0&&eo(s.textContent,u,e),a=["children",""+u]):Qs.hasOwnProperty(c)&&u!=null&&c==="onScroll"&&rt("scroll",s)}switch(n){case"input":Va(s),kf(s,l,!0);break;case"textarea":Va(s),bf(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=Ro)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{c=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Pp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=c.createElement(n,{is:s.is}):(e=c.createElement(n),n==="select"&&(c=e,s.multiple?c.multiple=!0:s.size&&(c.size=s.size))):e=c.createElementNS(e,n),e[qn]=t,e[oa]=s,Qm(e,t,!1,!1),t.stateNode=e;e:{switch(c=Rc(n,s),n){case"dialog":rt("cancel",e),rt("close",e),a=s;break;case"iframe":case"object":case"embed":rt("load",e),a=s;break;case"video":case"audio":for(a=0;a<zs.length;a++)rt(zs[a],e);a=s;break;case"source":rt("error",e),a=s;break;case"img":case"image":case"link":rt("error",e),rt("load",e),a=s;break;case"details":rt("toggle",e),a=s;break;case"input":Cf(e,s),a=bc(e,s),rt("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=dt({},s,{value:void 0}),rt("invalid",e);break;case"textarea":Pf(e,s),a=Ec(e,s),rt("invalid",e);break;default:a=s}Bc(n,a),u=a;for(l in u)if(u.hasOwnProperty(l)){var f=u[l];l==="style"?Lp(e,f):l==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&bp(e,f)):l==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Js(e,f):typeof f=="number"&&Js(e,""+f):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Qs.hasOwnProperty(l)?f!=null&&l==="onScroll"&&rt("scroll",e):f!=null&&Bd(e,l,f,c))}switch(n){case"input":Va(e),kf(e,s,!1);break;case"textarea":Va(e),bf(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Vr(s.value));break;case"select":e.multiple=!!s.multiple,l=s.value,l!=null?Xi(e,!!s.multiple,l,!1):s.defaultValue!=null&&Xi(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ro)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tt(t),null;case 6:if(e&&t.stateNode!=null)Xm(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(pe(166));if(n=gi(ca.current),gi(Yn.current),to(t)){if(s=t.stateNode,n=t.memoizedProps,s[qn]=t,(l=s.nodeValue!==n)&&(e=an,e!==null))switch(e.tag){case 3:eo(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eo(s.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[qn]=t,t.stateNode=s}return Tt(t),null;case 13:if(it(lt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(st&&sn!==null&&t.mode&1&&!(t.flags&128))ym(),os(),t.flags|=98560,l=!1;else if(l=to(t),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(pe(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(pe(317));l[qn]=t}else os(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tt(t),l=!1}else En!==null&&(pd(En),En=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||lt.current&1?_t===0&&(_t=3):mu())),t.updateQueue!==null&&(t.flags|=4),Tt(t),null);case 4:return cs(),ad(e,t),e===null&&sa(t.stateNode.containerInfo),Tt(t),null;case 10:return Jd(t.type._context),Tt(t),null;case 17:return Qt(t.type)&&Ao(),Tt(t),null;case 19:if(it(lt),l=t.memoizedState,l===null)return Tt(t),null;if(s=(t.flags&128)!==0,c=l.rendering,c===null)if(s)As(l,!1);else{if(_t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(c=$o(e),c!==null){for(t.flags|=128,As(l,!1),s=c.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)l=n,e=s,l.flags&=14680066,c=l.alternate,c===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=c.childLanes,l.lanes=c.lanes,l.child=c.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=c.memoizedProps,l.memoizedState=c.memoizedState,l.updateQueue=c.updateQueue,l.type=c.type,e=c.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return et(lt,lt.current&1|2),t.child}e=e.sibling}l.tail!==null&&pt()>us&&(t.flags|=128,s=!0,As(l,!1),t.lanes=4194304)}else{if(!s)if(e=$o(c),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),As(l,!0),l.tail===null&&l.tailMode==="hidden"&&!c.alternate&&!st)return Tt(t),null}else 2*pt()-l.renderingStartTime>us&&n!==1073741824&&(t.flags|=128,s=!0,As(l,!1),t.lanes=4194304);l.isBackwards?(c.sibling=t.child,t.child=c):(n=l.last,n!==null?n.sibling=c:t.child=c,l.last=c)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=pt(),t.sibling=null,n=lt.current,et(lt,s?n&1|2:n&1),t):(Tt(t),null);case 22:case 23:return pu(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?rn&1073741824&&(Tt(t),t.subtreeFlags&6&&(t.flags|=8192)):Tt(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function u0(e,t){switch(Gd(t),t.tag){case 1:return Qt(t.type)&&Ao(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cs(),it(Kt),it(Ft),ru(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nu(t),null;case 13:if(it(lt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));os()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(lt),null;case 4:return cs(),null;case 10:return Jd(t.type._context),null;case 22:case 23:return pu(),null;case 24:return null;default:return null}}var io=!1,Bt=!1,f0=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Qi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){ut(e,t,s)}else n.current=null}function od(e,t,n){try{n()}catch(s){ut(e,t,s)}}var yh=!1;function h0(e,t){if(Hc=Eo,e=im(),Vd(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var c=0,u=-1,f=-1,p=0,g=0,x=e,j=null;t:for(;;){for(var k;x!==n||a!==0&&x.nodeType!==3||(u=c+a),x!==l||s!==0&&x.nodeType!==3||(f=c+s),x.nodeType===3&&(c+=x.nodeValue.length),(k=x.firstChild)!==null;)j=x,x=k;for(;;){if(x===e)break t;if(j===n&&++p===a&&(u=c),j===l&&++g===s&&(f=c),(k=x.nextSibling)!==null)break;x=j,j=x.parentNode}x=k}n=u===-1||f===-1?null:{start:u,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zc={focusedElem:e,selectionRange:n},Eo=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var S=C.memoizedProps,P=C.memoizedState,_=t.stateNode,v=_.getSnapshotBeforeUpdate(t.elementType===t.type?S:In(t.type,S),P);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(b){ut(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return C=yh,yh=!1,C}function Gs(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&od(t,n,l)}a=a.next}while(a!==s)}}function al(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function ld(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function eg(e){var t=e.alternate;t!==null&&(e.alternate=null,eg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qn],delete t[oa],delete t[Gc],delete t[Yx],delete t[Kx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function tg(e){return e.tag===5||e.tag===3||e.tag===4}function vh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||tg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ro));else if(s!==4&&(e=e.child,e!==null))for(cd(e,t,n),e=e.sibling;e!==null;)cd(e,t,n),e=e.sibling}function dd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(dd(e,t,n),e=e.sibling;e!==null;)dd(e,t,n),e=e.sibling}var Pt=null,Ln=!1;function br(e,t,n){for(n=n.child;n!==null;)ng(e,t,n),n=n.sibling}function ng(e,t,n){if(Gn&&typeof Gn.onCommitFiberUnmount=="function")try{Gn.onCommitFiberUnmount(Jo,n)}catch{}switch(n.tag){case 5:Bt||Qi(n,t);case 6:var s=Pt,a=Ln;Pt=null,br(e,t,n),Pt=s,Ln=a,Pt!==null&&(Ln?(e=Pt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Pt.removeChild(n.stateNode));break;case 18:Pt!==null&&(Ln?(e=Pt,n=n.stateNode,e.nodeType===8?lc(e.parentNode,n):e.nodeType===1&&lc(e,n),na(e)):lc(Pt,n.stateNode));break;case 4:s=Pt,a=Ln,Pt=n.stateNode.containerInfo,Ln=!0,br(e,t,n),Pt=s,Ln=a;break;case 0:case 11:case 14:case 15:if(!Bt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var l=a,c=l.destroy;l=l.tag,c!==void 0&&(l&2||l&4)&&od(n,t,c),a=a.next}while(a!==s)}br(e,t,n);break;case 1:if(!Bt&&(Qi(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(u){ut(n,t,u)}br(e,t,n);break;case 21:br(e,t,n);break;case 22:n.mode&1?(Bt=(s=Bt)||n.memoizedState!==null,br(e,t,n),Bt=s):br(e,t,n);break;default:br(e,t,n)}}function xh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new f0),t.forEach(function(s){var a=j0.bind(null,e,s);n.has(s)||(n.add(s),s.then(a,a))})}}function bn(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var l=e,c=t,u=c;e:for(;u!==null;){switch(u.tag){case 5:Pt=u.stateNode,Ln=!1;break e;case 3:Pt=u.stateNode.containerInfo,Ln=!0;break e;case 4:Pt=u.stateNode.containerInfo,Ln=!0;break e}u=u.return}if(Pt===null)throw Error(pe(160));ng(l,c,a),Pt=null,Ln=!1;var f=a.alternate;f!==null&&(f.return=null),a.return=null}catch(p){ut(a,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)rg(t,e),t=t.sibling}function rg(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bn(t,e),Wn(e),s&4){try{Gs(3,e,e.return),al(3,e)}catch(S){ut(e,e.return,S)}try{Gs(5,e,e.return)}catch(S){ut(e,e.return,S)}}break;case 1:bn(t,e),Wn(e),s&512&&n!==null&&Qi(n,n.return);break;case 5:if(bn(t,e),Wn(e),s&512&&n!==null&&Qi(n,n.return),e.flags&32){var a=e.stateNode;try{Js(a,"")}catch(S){ut(e,e.return,S)}}if(s&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,c=n!==null?n.memoizedProps:l,u=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{u==="input"&&l.type==="radio"&&l.name!=null&&Cp(a,l),Rc(u,c);var p=Rc(u,l);for(c=0;c<f.length;c+=2){var g=f[c],x=f[c+1];g==="style"?Lp(a,x):g==="dangerouslySetInnerHTML"?bp(a,x):g==="children"?Js(a,x):Bd(a,g,x,p)}switch(u){case"input":Ic(a,l);break;case"textarea":kp(a,l);break;case"select":var j=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var k=l.value;k!=null?Xi(a,!!l.multiple,k,!1):j!==!!l.multiple&&(l.defaultValue!=null?Xi(a,!!l.multiple,l.defaultValue,!0):Xi(a,!!l.multiple,l.multiple?[]:"",!1))}a[oa]=l}catch(S){ut(e,e.return,S)}}break;case 6:if(bn(t,e),Wn(e),s&4){if(e.stateNode===null)throw Error(pe(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(S){ut(e,e.return,S)}}break;case 3:if(bn(t,e),Wn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{na(t.containerInfo)}catch(S){ut(e,e.return,S)}break;case 4:bn(t,e),Wn(e);break;case 13:bn(t,e),Wn(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(fu=pt())),s&4&&xh(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(Bt=(p=Bt)||g,bn(t,e),Bt=p):bn(t,e),Wn(e),s&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!g&&e.mode&1)for(Ce=e,g=e.child;g!==null;){for(x=Ce=g;Ce!==null;){switch(j=Ce,k=j.child,j.tag){case 0:case 11:case 14:case 15:Gs(4,j,j.return);break;case 1:Qi(j,j.return);var C=j.stateNode;if(typeof C.componentWillUnmount=="function"){s=j,n=j.return;try{t=s,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(S){ut(s,n,S)}}break;case 5:Qi(j,j.return);break;case 22:if(j.memoizedState!==null){wh(x);continue}}k!==null?(k.return=j,Ce=k):wh(x)}g=g.sibling}e:for(g=null,x=e;;){if(x.tag===5){if(g===null){g=x;try{a=x.stateNode,p?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(u=x.stateNode,f=x.memoizedProps.style,c=f!=null&&f.hasOwnProperty("display")?f.display:null,u.style.display=Ip("display",c))}catch(S){ut(e,e.return,S)}}}else if(x.tag===6){if(g===null)try{x.stateNode.nodeValue=p?"":x.memoizedProps}catch(S){ut(e,e.return,S)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===e)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===e)break e;for(;x.sibling===null;){if(x.return===null||x.return===e)break e;g===x&&(g=null),x=x.return}g===x&&(g=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:bn(t,e),Wn(e),s&4&&xh(e);break;case 21:break;default:bn(t,e),Wn(e)}}function Wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(tg(n)){var s=n;break e}n=n.return}throw Error(pe(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Js(a,""),s.flags&=-33);var l=vh(e);dd(e,l,a);break;case 3:case 4:var c=s.stateNode.containerInfo,u=vh(e);cd(e,u,c);break;default:throw Error(pe(161))}}catch(f){ut(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function p0(e,t,n){Ce=e,ig(e)}function ig(e,t,n){for(var s=(e.mode&1)!==0;Ce!==null;){var a=Ce,l=a.child;if(a.tag===22&&s){var c=a.memoizedState!==null||io;if(!c){var u=a.alternate,f=u!==null&&u.memoizedState!==null||Bt;u=io;var p=Bt;if(io=c,(Bt=f)&&!p)for(Ce=a;Ce!==null;)c=Ce,f=c.child,c.tag===22&&c.memoizedState!==null?jh(a):f!==null?(f.return=c,Ce=f):jh(a);for(;l!==null;)Ce=l,ig(l),l=l.sibling;Ce=a,io=u,Bt=p}_h(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,Ce=l):_h(e)}}function _h(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bt||al(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Bt)if(n===null)s.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:In(t.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&ih(t,l,s);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}ih(t,c,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var f=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var g=p.memoizedState;if(g!==null){var x=g.dehydrated;x!==null&&na(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Bt||t.flags&512&&ld(t)}catch(j){ut(t,t.return,j)}}if(t===e){Ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function wh(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function jh(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{al(4,t)}catch(f){ut(t,n,f)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(f){ut(t,a,f)}}var l=t.return;try{ld(t)}catch(f){ut(t,l,f)}break;case 5:var c=t.return;try{ld(t)}catch(f){ut(t,c,f)}}}catch(f){ut(t,t.return,f)}if(t===e){Ce=null;break}var u=t.sibling;if(u!==null){u.return=t.return,Ce=u;break}Ce=t.return}}var m0=Math.ceil,Zo=hr.ReactCurrentDispatcher,du=hr.ReactCurrentOwner,xn=hr.ReactCurrentBatchConfig,Ze=0,Nt=null,vt=null,bt=0,rn=0,Ji=Yr(0),_t=0,ha=null,Ci=0,ol=0,uu=0,Ys=null,Gt=null,fu=0,us=1/0,ir=null,Vo=!1,ud=null,$r=null,so=!1,Ar=null,qo=0,Ks=0,fd=null,_o=-1,wo=0;function Wt(){return Ze&6?pt():_o!==-1?_o:_o=pt()}function Wr(e){return e.mode&1?Ze&2&&bt!==0?bt&-bt:Jx.transition!==null?(wo===0&&(wo=$p()),wo):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:Yp(e.type)),e):1}function Rn(e,t,n,s){if(50<Ks)throw Ks=0,fd=null,Error(pe(185));ya(e,n,s),(!(Ze&2)||e!==Nt)&&(e===Nt&&(!(Ze&2)&&(ol|=n),_t===4&&Br(e,bt)),Jt(e,s),n===1&&Ze===0&&!(t.mode&1)&&(us=pt()+500,rl&&Kr()))}function Jt(e,t){var n=e.callbackNode;Jv(e,t);var s=Lo(e,e===Nt?bt:0);if(s===0)n!==null&&Ef(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Ef(n),t===1)e.tag===0?Qx(Sh.bind(null,e)):pm(Sh.bind(null,e)),qx(function(){!(Ze&6)&&Kr()}),n=null;else{switch(Wp(s)){case 1:n=Md;break;case 4:n=Dp;break;case 16:n=Io;break;case 536870912:n=zp;break;default:n=Io}n=fg(n,sg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sg(e,t){if(_o=-1,wo=0,Ze&6)throw Error(pe(327));var n=e.callbackNode;if(is()&&e.callbackNode!==n)return null;var s=Lo(e,e===Nt?bt:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Go(e,s);else{t=s;var a=Ze;Ze|=2;var l=og();(Nt!==e||bt!==t)&&(ir=null,us=pt()+500,vi(e,t));do try{v0();break}catch(u){ag(e,u)}while(!0);Qd(),Zo.current=l,Ze=a,vt!==null?t=0:(Nt=null,bt=0,t=_t)}if(t!==0){if(t===2&&(a=Oc(e),a!==0&&(s=a,t=hd(e,a))),t===1)throw n=ha,vi(e,0),Br(e,s),Jt(e,pt()),n;if(t===6)Br(e,s);else{if(a=e.current.alternate,!(s&30)&&!g0(a)&&(t=Go(e,s),t===2&&(l=Oc(e),l!==0&&(s=l,t=hd(e,l))),t===1))throw n=ha,vi(e,0),Br(e,s),Jt(e,pt()),n;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(pe(345));case 2:hi(e,Gt,ir);break;case 3:if(Br(e,s),(s&130023424)===s&&(t=fu+500-pt(),10<t)){if(Lo(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){Wt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=qc(hi.bind(null,e,Gt,ir),t);break}hi(e,Gt,ir);break;case 4:if(Br(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var c=31-Bn(s);l=1<<c,c=t[c],c>a&&(a=c),s&=~l}if(s=a,s=pt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*m0(s/1960))-s,10<s){e.timeoutHandle=qc(hi.bind(null,e,Gt,ir),s);break}hi(e,Gt,ir);break;case 5:hi(e,Gt,ir);break;default:throw Error(pe(329))}}}return Jt(e,pt()),e.callbackNode===n?sg.bind(null,e):null}function hd(e,t){var n=Ys;return e.current.memoizedState.isDehydrated&&(vi(e,t).flags|=256),e=Go(e,t),e!==2&&(t=Gt,Gt=n,t!==null&&pd(t)),e}function pd(e){Gt===null?Gt=e:Gt.push.apply(Gt,e)}function g0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],l=a.getSnapshot;a=a.value;try{if(!An(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Br(e,t){for(t&=~uu,t&=~ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Bn(t),s=1<<n;e[n]=-1,t&=~s}}function Sh(e){if(Ze&6)throw Error(pe(327));is();var t=Lo(e,0);if(!(t&1))return Jt(e,pt()),null;var n=Go(e,t);if(e.tag!==0&&n===2){var s=Oc(e);s!==0&&(t=s,n=hd(e,s))}if(n===1)throw n=ha,vi(e,0),Br(e,t),Jt(e,pt()),n;if(n===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,hi(e,Gt,ir),Jt(e,pt()),null}function hu(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(us=pt()+500,rl&&Kr())}}function ki(e){Ar!==null&&Ar.tag===0&&!(Ze&6)&&is();var t=Ze;Ze|=1;var n=xn.transition,s=Qe;try{if(xn.transition=null,Qe=1,e)return e()}finally{Qe=s,xn.transition=n,Ze=t,!(Ze&6)&&Kr()}}function pu(){rn=Ji.current,it(Ji)}function vi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Vx(n)),vt!==null)for(n=vt.return;n!==null;){var s=n;switch(Gd(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ao();break;case 3:cs(),it(Kt),it(Ft),ru();break;case 5:nu(s);break;case 4:cs();break;case 13:it(lt);break;case 19:it(lt);break;case 10:Jd(s.type._context);break;case 22:case 23:pu()}n=n.return}if(Nt=e,vt=e=Hr(e.current,null),bt=rn=t,_t=0,ha=null,uu=ol=Ci=0,Gt=Ys=null,mi!==null){for(t=0;t<mi.length;t++)if(n=mi[t],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,l=n.pending;if(l!==null){var c=l.next;l.next=a,s.next=c}n.pending=s}mi=null}return e}function ag(e,t){do{var n=vt;try{if(Qd(),yo.current=Ho,Wo){for(var s=ct.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Wo=!1}if(Ni=0,St=xt=ct=null,qs=!1,da=0,du.current=null,n===null||n.return===null){_t=1,ha=t,vt=null;break}e:{var l=e,c=n.return,u=n,f=t;if(t=bt,u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var p=f,g=u,x=g.tag;if(!(g.mode&1)&&(x===0||x===11||x===15)){var j=g.alternate;j?(g.updateQueue=j.updateQueue,g.memoizedState=j.memoizedState,g.lanes=j.lanes):(g.updateQueue=null,g.memoizedState=null)}var k=dh(c);if(k!==null){k.flags&=-257,uh(k,c,u,l,t),k.mode&1&&ch(l,p,t),t=k,f=p;var C=t.updateQueue;if(C===null){var S=new Set;S.add(f),t.updateQueue=S}else C.add(f);break e}else{if(!(t&1)){ch(l,p,t),mu();break e}f=Error(pe(426))}}else if(st&&u.mode&1){var P=dh(c);if(P!==null){!(P.flags&65536)&&(P.flags|=256),uh(P,c,u,l,t),Yd(ds(f,u));break e}}l=f=ds(f,u),_t!==4&&(_t=2),Ys===null?Ys=[l]:Ys.push(l),l=c;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var _=Wm(l,f,t);rh(l,_);break e;case 1:u=f;var v=l.type,w=l.stateNode;if(!(l.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&($r===null||!$r.has(w)))){l.flags|=65536,t&=-t,l.lanes|=t;var b=Hm(l,u,t);rh(l,b);break e}}l=l.return}while(l!==null)}cg(n)}catch(B){t=B,vt===n&&n!==null&&(vt=n=n.return);continue}break}while(!0)}function og(){var e=Zo.current;return Zo.current=Ho,e===null?Ho:e}function mu(){(_t===0||_t===3||_t===2)&&(_t=4),Nt===null||!(Ci&268435455)&&!(ol&268435455)||Br(Nt,bt)}function Go(e,t){var n=Ze;Ze|=2;var s=og();(Nt!==e||bt!==t)&&(ir=null,vi(e,t));do try{y0();break}catch(a){ag(e,a)}while(!0);if(Qd(),Ze=n,Zo.current=s,vt!==null)throw Error(pe(261));return Nt=null,bt=0,_t}function y0(){for(;vt!==null;)lg(vt)}function v0(){for(;vt!==null&&!Wv();)lg(vt)}function lg(e){var t=ug(e.alternate,e,rn);e.memoizedProps=e.pendingProps,t===null?cg(e):vt=t,du.current=null}function cg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=u0(n,t),n!==null){n.flags&=32767,vt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,vt=null;return}}else if(n=d0(n,t,rn),n!==null){vt=n;return}if(t=t.sibling,t!==null){vt=t;return}vt=t=e}while(t!==null);_t===0&&(_t=5)}function hi(e,t,n){var s=Qe,a=xn.transition;try{xn.transition=null,Qe=1,x0(e,t,n,s)}finally{xn.transition=a,Qe=s}return null}function x0(e,t,n,s){do is();while(Ar!==null);if(Ze&6)throw Error(pe(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(Xv(e,l),e===Nt&&(vt=Nt=null,bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||so||(so=!0,fg(Io,function(){return is(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=xn.transition,xn.transition=null;var c=Qe;Qe=1;var u=Ze;Ze|=4,du.current=null,h0(e,n),rg(n,e),Ox(Zc),Eo=!!Hc,Zc=Hc=null,e.current=n,p0(n),Hv(),Ze=u,Qe=c,xn.transition=l}else e.current=n;if(so&&(so=!1,Ar=e,qo=a),l=e.pendingLanes,l===0&&($r=null),qv(n.stateNode),Jt(e,pt()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(Vo)throw Vo=!1,e=ud,ud=null,e;return qo&1&&e.tag!==0&&is(),l=e.pendingLanes,l&1?e===fd?Ks++:(Ks=0,fd=e):Ks=0,Kr(),null}function is(){if(Ar!==null){var e=Wp(qo),t=xn.transition,n=Qe;try{if(xn.transition=null,Qe=16>e?16:e,Ar===null)var s=!1;else{if(e=Ar,Ar=null,qo=0,Ze&6)throw Error(pe(331));var a=Ze;for(Ze|=4,Ce=e.current;Ce!==null;){var l=Ce,c=l.child;if(Ce.flags&16){var u=l.deletions;if(u!==null){for(var f=0;f<u.length;f++){var p=u[f];for(Ce=p;Ce!==null;){var g=Ce;switch(g.tag){case 0:case 11:case 15:Gs(8,g,l)}var x=g.child;if(x!==null)x.return=g,Ce=x;else for(;Ce!==null;){g=Ce;var j=g.sibling,k=g.return;if(eg(g),g===p){Ce=null;break}if(j!==null){j.return=k,Ce=j;break}Ce=k}}}var C=l.alternate;if(C!==null){var S=C.child;if(S!==null){C.child=null;do{var P=S.sibling;S.sibling=null,S=P}while(S!==null)}}Ce=l}}if(l.subtreeFlags&2064&&c!==null)c.return=l,Ce=c;else e:for(;Ce!==null;){if(l=Ce,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Gs(9,l,l.return)}var _=l.sibling;if(_!==null){_.return=l.return,Ce=_;break e}Ce=l.return}}var v=e.current;for(Ce=v;Ce!==null;){c=Ce;var w=c.child;if(c.subtreeFlags&2064&&w!==null)w.return=c,Ce=w;else e:for(c=v;Ce!==null;){if(u=Ce,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:al(9,u)}}catch(B){ut(u,u.return,B)}if(u===c){Ce=null;break e}var b=u.sibling;if(b!==null){b.return=u.return,Ce=b;break e}Ce=u.return}}if(Ze=a,Kr(),Gn&&typeof Gn.onPostCommitFiberRoot=="function")try{Gn.onPostCommitFiberRoot(Jo,e)}catch{}s=!0}return s}finally{Qe=n,xn.transition=t}}return!1}function Nh(e,t,n){t=ds(n,t),t=Wm(e,t,1),e=zr(e,t,1),t=Wt(),e!==null&&(ya(e,1,t),Jt(e,t))}function ut(e,t,n){if(e.tag===3)Nh(e,e,n);else for(;t!==null;){if(t.tag===3){Nh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&($r===null||!$r.has(s))){e=ds(n,e),e=Hm(t,e,1),t=zr(t,e,1),e=Wt(),t!==null&&(ya(t,1,e),Jt(t,e));break}}t=t.return}}function _0(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=Wt(),e.pingedLanes|=e.suspendedLanes&n,Nt===e&&(bt&n)===n&&(_t===4||_t===3&&(bt&130023424)===bt&&500>pt()-fu?vi(e,0):uu|=n),Jt(e,t)}function dg(e,t){t===0&&(e.mode&1?(t=Ya,Ya<<=1,!(Ya&130023424)&&(Ya=4194304)):t=1);var n=Wt();e=ur(e,t),e!==null&&(ya(e,t,n),Jt(e,n))}function w0(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),dg(e,n)}function j0(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(pe(314))}s!==null&&s.delete(t),dg(e,n)}var ug;ug=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)Yt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Yt=!1,c0(e,t,n);Yt=!!(e.flags&131072)}else Yt=!1,st&&t.flags&1048576&&mm(t,Mo,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;xo(e,t),e=t.pendingProps;var a=as(t,Ft.current);rs(t,n),a=su(null,t,s,e,a,n);var l=au();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qt(s)?(l=!0,Fo(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,eu(t),a.updater=sl,t.stateNode=a,a._reactInternals=t,ed(t,s,e,n),t=rd(null,t,s,!0,l,n)):(t.tag=0,st&&l&&qd(t),zt(null,t,a,n),t=t.child),t;case 16:s=t.elementType;e:{switch(xo(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=N0(s),e=In(s,e),a){case 0:t=nd(null,t,s,e,n);break e;case 1:t=ph(null,t,s,e,n);break e;case 11:t=fh(null,t,s,e,n);break e;case 14:t=hh(null,t,s,In(s.type,e),n);break e}throw Error(pe(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:In(s,a),nd(e,t,s,a,n);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:In(s,a),ph(e,t,s,a,n);case 3:e:{if(Gm(t),e===null)throw Error(pe(387));s=t.pendingProps,l=t.memoizedState,a=l.element,wm(e,t),zo(t,s,null,n);var c=t.memoizedState;if(s=c.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=ds(Error(pe(423)),t),t=mh(e,t,s,n,a);break e}else if(s!==a){a=ds(Error(pe(424)),t),t=mh(e,t,s,n,a);break e}else for(sn=Dr(t.stateNode.containerInfo.firstChild),an=t,st=!0,En=null,n=xm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(os(),s===a){t=fr(e,t,n);break e}zt(e,t,s,n)}t=t.child}return t;case 5:return jm(t),e===null&&Qc(t),s=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,c=a.children,Vc(s,a)?c=null:l!==null&&Vc(s,l)&&(t.flags|=32),qm(e,t),zt(e,t,c,n),t.child;case 6:return e===null&&Qc(t),null;case 13:return Ym(e,t,n);case 4:return tu(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=ls(t,null,s,n):zt(e,t,s,n),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:In(s,a),fh(e,t,s,a,n);case 7:return zt(e,t,t.pendingProps,n),t.child;case 8:return zt(e,t,t.pendingProps.children,n),t.child;case 12:return zt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,l=t.memoizedProps,c=a.value,et(Oo,s._currentValue),s._currentValue=c,l!==null)if(An(l.value,c)){if(l.children===a.children&&!Kt.current){t=fr(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var u=l.dependencies;if(u!==null){c=l.child;for(var f=u.firstContext;f!==null;){if(f.context===s){if(l.tag===1){f=lr(-1,n&-n),f.tag=2;var p=l.updateQueue;if(p!==null){p=p.shared;var g=p.pending;g===null?f.next=f:(f.next=g.next,g.next=f),p.pending=f}}l.lanes|=n,f=l.alternate,f!==null&&(f.lanes|=n),Jc(l.return,n,t),u.lanes|=n;break}f=f.next}}else if(l.tag===10)c=l.type===t.type?null:l.child;else if(l.tag===18){if(c=l.return,c===null)throw Error(pe(341));c.lanes|=n,u=c.alternate,u!==null&&(u.lanes|=n),Jc(c,n,t),c=l.sibling}else c=l.child;if(c!==null)c.return=l;else for(c=l;c!==null;){if(c===t){c=null;break}if(l=c.sibling,l!==null){l.return=c.return,c=l;break}c=c.return}l=c}zt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,rs(t,n),a=_n(a),s=s(a),t.flags|=1,zt(e,t,s,n),t.child;case 14:return s=t.type,a=In(s,t.pendingProps),a=In(s.type,a),hh(e,t,s,a,n);case 15:return Zm(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:In(s,a),xo(e,t),t.tag=1,Qt(s)?(e=!0,Fo(t)):e=!1,rs(t,n),$m(t,s,a),ed(t,s,a,n),rd(null,t,s,!0,e,n);case 19:return Km(e,t,n);case 22:return Vm(e,t,n)}throw Error(pe(156,t.tag))};function fg(e,t){return Op(e,t)}function S0(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vn(e,t,n,s){return new S0(e,t,n,s)}function gu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function N0(e){if(typeof e=="function")return gu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ad)return 11;if(e===Fd)return 14}return 2}function Hr(e,t){var n=e.alternate;return n===null?(n=vn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jo(e,t,n,s,a,l){var c=2;if(s=e,typeof e=="function")gu(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case $i:return xi(n.children,a,l,t);case Rd:c=8,a|=8;break;case Nc:return e=vn(12,n,t,a|2),e.elementType=Nc,e.lanes=l,e;case Cc:return e=vn(13,n,t,a),e.elementType=Cc,e.lanes=l,e;case kc:return e=vn(19,n,t,a),e.elementType=kc,e.lanes=l,e;case jp:return ll(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _p:c=10;break e;case wp:c=9;break e;case Ad:c=11;break e;case Fd:c=14;break e;case Lr:c=16,s=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=vn(c,n,t,a),t.elementType=e,t.type=s,t.lanes=l,t}function xi(e,t,n,s){return e=vn(7,e,s,t),e.lanes=n,e}function ll(e,t,n,s){return e=vn(22,e,s,t),e.elementType=jp,e.lanes=n,e.stateNode={isHidden:!1},e}function gc(e,t,n){return e=vn(6,e,null,t),e.lanes=n,e}function yc(e,t,n){return t=vn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function C0(e,t,n,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ql(0),this.expirationTimes=Ql(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ql(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function yu(e,t,n,s,a,l,c,u,f){return e=new C0(e,t,n,u,f),t===1?(t=1,l===!0&&(t|=8)):t=0,l=vn(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},eu(l),e}function k0(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zi,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function hg(e){if(!e)return qr;e=e._reactInternals;e:{if(Ii(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var n=e.type;if(Qt(n))return hm(e,n,t)}return t}function pg(e,t,n,s,a,l,c,u,f){return e=yu(n,s,!0,e,a,l,c,u,f),e.context=hg(null),n=e.current,s=Wt(),a=Wr(n),l=lr(s,a),l.callback=t??null,zr(n,l,a),e.current.lanes=a,ya(e,a,s),Jt(e,s),e}function cl(e,t,n,s){var a=t.current,l=Wt(),c=Wr(a);return n=hg(n),t.context===null?t.context=n:t.pendingContext=n,t=lr(l,c),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=zr(a,t,c),e!==null&&(Rn(e,a,c,l),go(e,a,c)),c}function Yo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ch(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function vu(e,t){Ch(e,t),(e=e.alternate)&&Ch(e,t)}function P0(){return null}var mg=typeof reportError=="function"?reportError:function(e){console.error(e)};function xu(e){this._internalRoot=e}dl.prototype.render=xu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));cl(e,t,null,null)};dl.prototype.unmount=xu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ki(function(){cl(null,e,null,null)}),t[dr]=null}};function dl(e){this._internalRoot=e}dl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Vp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Tr.length&&t!==0&&t<Tr[n].priority;n++);Tr.splice(n,0,e),n===0&&Gp(e)}};function _u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ul(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function kh(){}function b0(e,t,n,s,a){if(a){if(typeof s=="function"){var l=s;s=function(){var p=Yo(c);l.call(p)}}var c=pg(t,s,e,0,null,!1,!1,"",kh);return e._reactRootContainer=c,e[dr]=c.current,sa(e.nodeType===8?e.parentNode:e),ki(),c}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var u=s;s=function(){var p=Yo(f);u.call(p)}}var f=yu(e,0,!1,null,null,!1,!1,"",kh);return e._reactRootContainer=f,e[dr]=f.current,sa(e.nodeType===8?e.parentNode:e),ki(function(){cl(t,f,n,s)}),f}function fl(e,t,n,s,a){var l=n._reactRootContainer;if(l){var c=l;if(typeof a=="function"){var u=a;a=function(){var f=Yo(c);u.call(f)}}cl(t,c,e,a)}else c=b0(n,t,e,a,s);return Yo(c)}Hp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ds(t.pendingLanes);n!==0&&(Od(t,n|1),Jt(t,pt()),!(Ze&6)&&(us=pt()+500,Kr()))}break;case 13:ki(function(){var s=ur(e,1);if(s!==null){var a=Wt();Rn(s,e,1,a)}}),vu(e,1)}};Dd=function(e){if(e.tag===13){var t=ur(e,134217728);if(t!==null){var n=Wt();Rn(t,e,134217728,n)}vu(e,134217728)}};Zp=function(e){if(e.tag===13){var t=Wr(e),n=ur(e,t);if(n!==null){var s=Wt();Rn(n,e,t,s)}vu(e,t)}};Vp=function(){return Qe};qp=function(e,t){var n=Qe;try{return Qe=e,t()}finally{Qe=n}};Fc=function(e,t,n){switch(t){case"input":if(Ic(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var a=nl(s);if(!a)throw Error(pe(90));Np(s),Ic(s,a)}}}break;case"textarea":kp(e,n);break;case"select":t=n.value,t!=null&&Xi(e,!!n.multiple,t,!1)}};Bp=hu;Rp=ki;var I0={usingClientEntryPoint:!1,Events:[xa,Vi,nl,Ep,Tp,hu]},Fs={findFiberByHostInstance:pi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},L0={bundleType:Fs.bundleType,version:Fs.version,rendererPackageName:Fs.rendererPackageName,rendererConfig:Fs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Up(e),e===null?null:e.stateNode},findFiberByHostInstance:Fs.findFiberByHostInstance||P0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ao.isDisabled&&ao.supportsFiber)try{Jo=ao.inject(L0),Gn=ao}catch{}}ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I0;ln.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_u(t))throw Error(pe(200));return k0(e,t,null,n)};ln.createRoot=function(e,t){if(!_u(e))throw Error(pe(299));var n=!1,s="",a=mg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=yu(e,1,!1,null,null,n,!1,s,a),e[dr]=t.current,sa(e.nodeType===8?e.parentNode:e),new xu(t)};ln.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=Up(t),e=e===null?null:e.stateNode,e};ln.flushSync=function(e){return ki(e)};ln.hydrate=function(e,t,n){if(!ul(t))throw Error(pe(200));return fl(null,e,t,!0,n)};ln.hydrateRoot=function(e,t,n){if(!_u(e))throw Error(pe(405));var s=n!=null&&n.hydratedSources||null,a=!1,l="",c=mg;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=pg(t,null,e,1,n??null,a,!1,l,c),e[dr]=t.current,sa(e),s)for(e=0;e<s.length;e++)n=s[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new dl(t)};ln.render=function(e,t,n){if(!ul(t))throw Error(pe(200));return fl(null,e,t,!1,n)};ln.unmountComponentAtNode=function(e){if(!ul(e))throw Error(pe(40));return e._reactRootContainer?(ki(function(){fl(null,null,e,!1,function(){e._reactRootContainer=null,e[dr]=null})}),!0):!1};ln.unstable_batchedUpdates=hu;ln.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!ul(n))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return fl(e,t,n,!1,s)};ln.version="18.3.1-next-f1338f8080-20240426";function gg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gg)}catch(e){console.error(e)}}gg(),gp.exports=ln;var yg=gp.exports,vg,Ph=yg;vg=Ph.createRoot,Ph.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pa(){return pa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},pa.apply(this,arguments)}var Fr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Fr||(Fr={}));const bh="popstate";function E0(e){e===void 0&&(e={});function t(s,a){let{pathname:l,search:c,hash:u}=s.location;return md("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:_g(a)}return B0(t,n,null,e)}function wt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function xg(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function T0(){return Math.random().toString(36).substr(2,8)}function Ih(e,t){return{usr:e.state,key:e.key,idx:t}}function md(e,t,n,s){return n===void 0&&(n=null),pa({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?gs(t):t,{state:n,key:t&&t.key||s||T0()})}function _g(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function gs(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function B0(e,t,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,c=a.history,u=Fr.Pop,f=null,p=g();p==null&&(p=0,c.replaceState(pa({},c.state,{idx:p}),""));function g(){return(c.state||{idx:null}).idx}function x(){u=Fr.Pop;let P=g(),_=P==null?null:P-p;p=P,f&&f({action:u,location:S.location,delta:_})}function j(P,_){u=Fr.Push;let v=md(S.location,P,_);p=g()+1;let w=Ih(v,p),b=S.createHref(v);try{c.pushState(w,"",b)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;a.location.assign(b)}l&&f&&f({action:u,location:S.location,delta:1})}function k(P,_){u=Fr.Replace;let v=md(S.location,P,_);p=g();let w=Ih(v,p),b=S.createHref(v);c.replaceState(w,"",b),l&&f&&f({action:u,location:S.location,delta:0})}function C(P){let _=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof P=="string"?P:_g(P);return v=v.replace(/ $/,"%20"),wt(_,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,_)}let S={get action(){return u},get location(){return e(a,c)},listen(P){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(bh,x),f=P,()=>{a.removeEventListener(bh,x),f=null}},createHref(P){return t(a,P)},createURL:C,encodeLocation(P){let _=C(P);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:j,replace:k,go(P){return c.go(P)}};return S}var Lh;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Lh||(Lh={}));function R0(e,t,n){return n===void 0&&(n="/"),A0(e,t,n)}function A0(e,t,n,s){let a=typeof t=="string"?gs(t):t,l=Sg(a.pathname||"/",n);if(l==null)return null;let c=wg(e);F0(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let p=G0(l);u=Z0(c[f],p)}return u}function wg(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(l,c,u)=>{let f={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};f.relativePath.startsWith("/")&&(wt(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let p=_i([s,f.relativePath]),g=n.concat(f);l.children&&l.children.length>0&&(wt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),wg(l.children,t,g,p)),!(l.path==null&&!l.index)&&t.push({path:p,score:W0(p,l.index),routesMeta:g})};return e.forEach((l,c)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))a(l,c);else for(let f of jg(l.path))a(l,c,f)}),t}function jg(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let c=jg(s.join("/")),u=[];return u.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&u.push(...c),u.map(f=>e.startsWith("/")&&f===""?"/":f)}function F0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:H0(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const U0=/^:[\w-]+$/,M0=3,O0=2,D0=1,z0=10,$0=-2,Eh=e=>e==="*";function W0(e,t){let n=e.split("/"),s=n.length;return n.some(Eh)&&(s+=$0),t&&(s+=O0),n.filter(a=>!Eh(a)).reduce((a,l)=>a+(U0.test(l)?M0:l===""?D0:z0),s)}function H0(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function Z0(e,t,n){let{routesMeta:s}=e,a={},l="/",c=[];for(let u=0;u<s.length;++u){let f=s[u],p=u===s.length-1,g=l==="/"?t:t.slice(l.length)||"/",x=V0({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},g),j=f.route;if(!x)return null;Object.assign(a,x.params),c.push({params:a,pathname:_i([l,x.pathname]),pathnameBase:e_(_i([l,x.pathnameBase])),route:j}),x.pathnameBase!=="/"&&(l=_i([l,x.pathnameBase]))}return c}function V0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=q0(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:s.reduce((p,g,x)=>{let{paramName:j,isOptional:k}=g;if(j==="*"){let S=u[x]||"";c=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const C=u[x];return k&&!C?p[j]=void 0:p[j]=(C||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:e}}function q0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),xg(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function G0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return xg(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Sg(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function Y0(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:a=""}=typeof e=="string"?gs(e):e;return{pathname:n?n.startsWith("/")?n:K0(n,t):t,search:t_(s),hash:n_(a)}}function K0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function vc(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Q0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function J0(e,t){let n=Q0(e);return t?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function X0(e,t,n,s){s===void 0&&(s=!1);let a;typeof e=="string"?a=gs(e):(a=pa({},e),wt(!a.pathname||!a.pathname.includes("?"),vc("?","pathname","search",a)),wt(!a.pathname||!a.pathname.includes("#"),vc("#","pathname","hash",a)),wt(!a.search||!a.search.includes("#"),vc("#","search","hash",a)));let l=e===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=n;else{let x=t.length-1;if(!s&&c.startsWith("..")){let j=c.split("/");for(;j[0]==="..";)j.shift(),x-=1;a.pathname=j.join("/")}u=x>=0?t[x]:"/"}let f=Y0(a,u),p=c&&c!=="/"&&c.endsWith("/"),g=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||g)&&(f.pathname+="/"),f}const _i=e=>e.join("/").replace(/\/\/+/g,"/"),e_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),t_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,n_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function r_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Ng=["post","put","patch","delete"];new Set(Ng);const i_=["get",...Ng];new Set(i_);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ma(){return ma=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ma.apply(this,arguments)}const wu=y.createContext(null),s_=y.createContext(null),hl=y.createContext(null),pl=y.createContext(null),Li=y.createContext({outlet:null,matches:[],isDataRoute:!1}),Cg=y.createContext(null);function ml(){return y.useContext(pl)!=null}function wa(){return ml()||wt(!1),y.useContext(pl).location}function kg(e){y.useContext(hl).static||y.useLayoutEffect(e)}function pr(){let{isDataRoute:e}=y.useContext(Li);return e?x_():a_()}function a_(){ml()||wt(!1);let e=y.useContext(wu),{basename:t,future:n,navigator:s}=y.useContext(hl),{matches:a}=y.useContext(Li),{pathname:l}=wa(),c=JSON.stringify(J0(a,n.v7_relativeSplatPath)),u=y.useRef(!1);return kg(()=>{u.current=!0}),y.useCallback(function(p,g){if(g===void 0&&(g={}),!u.current)return;if(typeof p=="number"){s.go(p);return}let x=X0(p,JSON.parse(c),l,g.relative==="path");e==null&&t!=="/"&&(x.pathname=x.pathname==="/"?t:_i([t,x.pathname])),(g.replace?s.replace:s.push)(x,g.state,g)},[t,s,c,l,e])}function o_(){let{matches:e}=y.useContext(Li),t=e[e.length-1];return t?t.params:{}}function l_(e,t){return c_(e,t)}function c_(e,t,n,s){ml()||wt(!1);let{navigator:a}=y.useContext(hl),{matches:l}=y.useContext(Li),c=l[l.length-1],u=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let p=wa(),g;if(t){var x;let P=typeof t=="string"?gs(t):t;f==="/"||(x=P.pathname)!=null&&x.startsWith(f)||wt(!1),g=P}else g=p;let j=g.pathname||"/",k=j;if(f!=="/"){let P=f.replace(/^\//,"").split("/");k="/"+j.replace(/^\//,"").split("/").slice(P.length).join("/")}let C=R0(e,{pathname:k}),S=p_(C&&C.map(P=>Object.assign({},P,{params:Object.assign({},u,P.params),pathname:_i([f,a.encodeLocation?a.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?f:_i([f,a.encodeLocation?a.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),l,n,s);return t&&S?y.createElement(pl.Provider,{value:{location:ma({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Fr.Pop}},S):S}function d_(){let e=v_(),t=r_(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),n?y.createElement("pre",{style:a},n):null,null)}const u_=y.createElement(d_,null);class f_ extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?y.createElement(Li.Provider,{value:this.props.routeContext},y.createElement(Cg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function h_(e){let{routeContext:t,match:n,children:s}=e,a=y.useContext(wu);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(Li.Provider,{value:t},s)}function p_(e,t,n,s){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=s)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let c=e,u=(a=n)==null?void 0:a.errors;if(u!=null){let g=c.findIndex(x=>x.route.id&&(u==null?void 0:u[x.route.id])!==void 0);g>=0||wt(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,p=-1;if(n&&s&&s.v7_partialHydration)for(let g=0;g<c.length;g++){let x=c[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=g),x.route.id){let{loaderData:j,errors:k}=n,C=x.route.loader&&j[x.route.id]===void 0&&(!k||k[x.route.id]===void 0);if(x.route.lazy||C){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((g,x,j)=>{let k,C=!1,S=null,P=null;n&&(k=u&&x.route.id?u[x.route.id]:void 0,S=x.route.errorElement||u_,f&&(p<0&&j===0?(__("route-fallback"),C=!0,P=null):p===j&&(C=!0,P=x.route.hydrateFallbackElement||null)));let _=t.concat(c.slice(0,j+1)),v=()=>{let w;return k?w=S:C?w=P:x.route.Component?w=y.createElement(x.route.Component,null):x.route.element?w=x.route.element:w=g,y.createElement(h_,{match:x,routeContext:{outlet:g,matches:_,isDataRoute:n!=null},children:w})};return n&&(x.route.ErrorBoundary||x.route.errorElement||j===0)?y.createElement(f_,{location:n.location,revalidation:n.revalidation,component:S,error:k,children:v(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):v()},null)}var Pg=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Pg||{}),bg=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(bg||{});function m_(e){let t=y.useContext(wu);return t||wt(!1),t}function g_(e){let t=y.useContext(s_);return t||wt(!1),t}function y_(e){let t=y.useContext(Li);return t||wt(!1),t}function Ig(e){let t=y_(),n=t.matches[t.matches.length-1];return n.route.id||wt(!1),n.route.id}function v_(){var e;let t=y.useContext(Cg),n=g_(),s=Ig();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function x_(){let{router:e}=m_(Pg.UseNavigateStable),t=Ig(bg.UseNavigateStable),n=y.useRef(!1);return kg(()=>{n.current=!0}),y.useCallback(function(a,l){l===void 0&&(l={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,ma({fromRouteId:t},l)))},[e,t])}const Th={};function __(e,t,n){Th[e]||(Th[e]=!0)}function w_(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function nn(e){wt(!1)}function j_(e){let{basename:t="/",children:n=null,location:s,navigationType:a=Fr.Pop,navigator:l,static:c=!1,future:u}=e;ml()&&wt(!1);let f=t.replace(/^\/*/,"/"),p=y.useMemo(()=>({basename:f,navigator:l,static:c,future:ma({v7_relativeSplatPath:!1},u)}),[f,u,l,c]);typeof s=="string"&&(s=gs(s));let{pathname:g="/",search:x="",hash:j="",state:k=null,key:C="default"}=s,S=y.useMemo(()=>{let P=Sg(g,f);return P==null?null:{location:{pathname:P,search:x,hash:j,state:k,key:C},navigationType:a}},[f,g,x,j,k,C,a]);return S==null?null:y.createElement(hl.Provider,{value:p},y.createElement(pl.Provider,{children:n,value:S}))}function S_(e){let{children:t,location:n}=e;return l_(gd(t),n)}new Promise(()=>{});function gd(e,t){t===void 0&&(t=[]);let n=[];return y.Children.forEach(e,(s,a)=>{if(!y.isValidElement(s))return;let l=[...t,a];if(s.type===y.Fragment){n.push.apply(n,gd(s.props.children,l));return}s.type!==nn&&wt(!1),!s.props.index||!s.props.children||wt(!1);let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=gd(s.props.children,l)),n.push(c)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yd(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(a=>[n,a]):[[n,s]])},[]))}function N_(e,t){let n=yd(e);return t&&t.forEach((s,a)=>{n.has(a)||t.getAll(a).forEach(l=>{n.append(a,l)})}),n}const C_="6";try{window.__reactRouterVersion=C_}catch{}const k_="startTransition",Bh=_v[k_];function P_(e){let{basename:t,children:n,future:s,window:a}=e,l=y.useRef();l.current==null&&(l.current=E0({window:a,v5Compat:!0}));let c=l.current,[u,f]=y.useState({action:c.action,location:c.location}),{v7_startTransition:p}=s||{},g=y.useCallback(x=>{p&&Bh?Bh(()=>f(x)):f(x)},[f,p]);return y.useLayoutEffect(()=>c.listen(g),[c,g]),y.useEffect(()=>w_(s),[s]),y.createElement(j_,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:c,future:s})}var Rh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Rh||(Rh={}));var Ah;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ah||(Ah={}));function b_(e){let t=y.useRef(yd(e)),n=y.useRef(!1),s=wa(),a=y.useMemo(()=>N_(s.search,n.current?null:t.current),[s.search]),l=pr(),c=y.useCallback((u,f)=>{const p=yd(typeof u=="function"?u(a):u);n.current=!0,l("?"+p,f)},[l,a]);return[a,c]}function Lg(e,t){return function(){return e.apply(t,arguments)}}const{toString:I_}=Object.prototype,{getPrototypeOf:ju}=Object,{iterator:gl,toStringTag:Eg}=Symbol,yl=(e=>t=>{const n=I_.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Fn=e=>(e=e.toLowerCase(),t=>yl(t)===e),vl=e=>t=>typeof t===e,{isArray:ys}=Array,fs=vl("undefined");function ja(e){return e!==null&&!fs(e)&&e.constructor!==null&&!fs(e.constructor)&&Xt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Tg=Fn("ArrayBuffer");function L_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Tg(e.buffer),t}const E_=vl("string"),Xt=vl("function"),Bg=vl("number"),Sa=e=>e!==null&&typeof e=="object",T_=e=>e===!0||e===!1,So=e=>{if(yl(e)!=="object")return!1;const t=ju(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Eg in e)&&!(gl in e)},B_=e=>{if(!Sa(e)||ja(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},R_=Fn("Date"),A_=Fn("File"),F_=Fn("Blob"),U_=Fn("FileList"),M_=e=>Sa(e)&&Xt(e.pipe),O_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Xt(e.append)&&((t=yl(e))==="formdata"||t==="object"&&Xt(e.toString)&&e.toString()==="[object FormData]"))},D_=Fn("URLSearchParams"),[z_,$_,W_,H_]=["ReadableStream","Request","Response","Headers"].map(Fn),Z_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Na(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),ys(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{if(ja(e))return;const l=n?Object.getOwnPropertyNames(e):Object.keys(e),c=l.length;let u;for(s=0;s<c;s++)u=l[s],t.call(null,e[u],u,e)}}function Rg(e,t){if(ja(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,a;for(;s-- >0;)if(a=n[s],t===a.toLowerCase())return a;return null}const yi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ag=e=>!fs(e)&&e!==yi;function vd(){const{caseless:e,skipUndefined:t}=Ag(this)&&this||{},n={},s=(a,l)=>{const c=e&&Rg(n,l)||l;So(n[c])&&So(a)?n[c]=vd(n[c],a):So(a)?n[c]=vd({},a):ys(a)?n[c]=a.slice():(!t||!fs(a))&&(n[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Na(arguments[a],s);return n}const V_=(e,t,n,{allOwnKeys:s}={})=>(Na(t,(a,l)=>{n&&Xt(a)?e[l]=Lg(a,n):e[l]=a},{allOwnKeys:s}),e),q_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),G_=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Y_=(e,t,n,s)=>{let a,l,c;const u={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),l=a.length;l-- >0;)c=a[l],(!s||s(c,e,t))&&!u[c]&&(t[c]=e[c],u[c]=!0);e=n!==!1&&ju(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},K_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},Q_=e=>{if(!e)return null;if(ys(e))return e;let t=e.length;if(!Bg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},J_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ju(Uint8Array)),X_=(e,t)=>{const s=(e&&e[gl]).call(e);let a;for(;(a=s.next())&&!a.done;){const l=a.value;t.call(e,l[0],l[1])}},ew=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},tw=Fn("HTMLFormElement"),nw=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,a){return s.toUpperCase()+a}),Fh=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),rw=Fn("RegExp"),Fg=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Na(n,(a,l)=>{let c;(c=t(a,l,e))!==!1&&(s[l]=c||a)}),Object.defineProperties(e,s)},iw=e=>{Fg(e,(t,n)=>{if(Xt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(Xt(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},sw=(e,t)=>{const n={},s=a=>{a.forEach(l=>{n[l]=!0})};return ys(e)?s(e):s(String(e).split(t)),n},aw=()=>{},ow=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function lw(e){return!!(e&&Xt(e.append)&&e[Eg]==="FormData"&&e[gl])}const cw=e=>{const t=new Array(10),n=(s,a)=>{if(Sa(s)){if(t.indexOf(s)>=0)return;if(ja(s))return s;if(!("toJSON"in s)){t[a]=s;const l=ys(s)?[]:{};return Na(s,(c,u)=>{const f=n(c,a+1);!fs(f)&&(l[u]=f)}),t[a]=void 0,l}}return s};return n(e,0)},dw=Fn("AsyncFunction"),uw=e=>e&&(Sa(e)||Xt(e))&&Xt(e.then)&&Xt(e.catch),Ug=((e,t)=>e?setImmediate:t?((n,s)=>(yi.addEventListener("message",({source:a,data:l})=>{a===yi&&l===n&&s.length&&s.shift()()},!1),a=>{s.push(a),yi.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Xt(yi.postMessage)),fw=typeof queueMicrotask<"u"?queueMicrotask.bind(yi):typeof process<"u"&&process.nextTick||Ug,hw=e=>e!=null&&Xt(e[gl]),K={isArray:ys,isArrayBuffer:Tg,isBuffer:ja,isFormData:O_,isArrayBufferView:L_,isString:E_,isNumber:Bg,isBoolean:T_,isObject:Sa,isPlainObject:So,isEmptyObject:B_,isReadableStream:z_,isRequest:$_,isResponse:W_,isHeaders:H_,isUndefined:fs,isDate:R_,isFile:A_,isBlob:F_,isRegExp:rw,isFunction:Xt,isStream:M_,isURLSearchParams:D_,isTypedArray:J_,isFileList:U_,forEach:Na,merge:vd,extend:V_,trim:Z_,stripBOM:q_,inherits:G_,toFlatObject:Y_,kindOf:yl,kindOfTest:Fn,endsWith:K_,toArray:Q_,forEachEntry:X_,matchAll:ew,isHTMLForm:tw,hasOwnProperty:Fh,hasOwnProp:Fh,reduceDescriptors:Fg,freezeMethods:iw,toObjectSet:sw,toCamelCase:nw,noop:aw,toFiniteNumber:ow,findKey:Rg,global:yi,isContextDefined:Ag,isSpecCompliantForm:lw,toJSONObject:cw,isAsyncFn:dw,isThenable:uw,setImmediate:Ug,asap:fw,isIterable:hw};function Fe(e,t,n,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}K.inherits(Fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:K.toJSONObject(this.config),code:this.code,status:this.status}}});const Mg=Fe.prototype,Og={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Og[e]={value:e}});Object.defineProperties(Fe,Og);Object.defineProperty(Mg,"isAxiosError",{value:!0});Fe.from=(e,t,n,s,a,l)=>{const c=Object.create(Mg);K.toFlatObject(e,c,function(g){return g!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",f=t==null&&e?e.code:t;return Fe.call(c,u,f,n,s,a),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",l&&Object.assign(c,l),c};const pw=null;function xd(e){return K.isPlainObject(e)||K.isArray(e)}function Dg(e){return K.endsWith(e,"[]")?e.slice(0,-2):e}function Uh(e,t,n){return e?e.concat(t).map(function(a,l){return a=Dg(a),!n&&l?"["+a+"]":a}).join(n?".":""):t}function mw(e){return K.isArray(e)&&!e.some(xd)}const gw=K.toFlatObject(K,{},null,function(t){return/^is[A-Z]/.test(t)});function xl(e,t,n){if(!K.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=K.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,P){return!K.isUndefined(P[S])});const s=n.metaTokens,a=n.visitor||g,l=n.dots,c=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&K.isSpecCompliantForm(t);if(!K.isFunction(a))throw new TypeError("visitor must be a function");function p(C){if(C===null)return"";if(K.isDate(C))return C.toISOString();if(K.isBoolean(C))return C.toString();if(!f&&K.isBlob(C))throw new Fe("Blob is not supported. Use a Buffer instead.");return K.isArrayBuffer(C)||K.isTypedArray(C)?f&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function g(C,S,P){let _=C;if(C&&!P&&typeof C=="object"){if(K.endsWith(S,"{}"))S=s?S:S.slice(0,-2),C=JSON.stringify(C);else if(K.isArray(C)&&mw(C)||(K.isFileList(C)||K.endsWith(S,"[]"))&&(_=K.toArray(C)))return S=Dg(S),_.forEach(function(w,b){!(K.isUndefined(w)||w===null)&&t.append(c===!0?Uh([S],b,l):c===null?S:S+"[]",p(w))}),!1}return xd(C)?!0:(t.append(Uh(P,S,l),p(C)),!1)}const x=[],j=Object.assign(gw,{defaultVisitor:g,convertValue:p,isVisitable:xd});function k(C,S){if(!K.isUndefined(C)){if(x.indexOf(C)!==-1)throw Error("Circular reference detected in "+S.join("."));x.push(C),K.forEach(C,function(_,v){(!(K.isUndefined(_)||_===null)&&a.call(t,_,K.isString(v)?v.trim():v,S,j))===!0&&k(_,S?S.concat(v):[v])}),x.pop()}}if(!K.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Mh(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Su(e,t){this._pairs=[],e&&xl(e,this,t)}const zg=Su.prototype;zg.append=function(t,n){this._pairs.push([t,n])};zg.toString=function(t){const n=t?function(s){return t.call(this,s,Mh)}:Mh;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function yw(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function $g(e,t,n){if(!t)return e;const s=n&&n.encode||yw;K.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let l;if(a?l=a(t,n):l=K.isURLSearchParams(t)?t.toString():new Su(t,n).toString(s),l){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class Oh{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){K.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Wg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vw=typeof URLSearchParams<"u"?URLSearchParams:Su,xw=typeof FormData<"u"?FormData:null,_w=typeof Blob<"u"?Blob:null,ww={isBrowser:!0,classes:{URLSearchParams:vw,FormData:xw,Blob:_w},protocols:["http","https","file","blob","url","data"]},Nu=typeof window<"u"&&typeof document<"u",_d=typeof navigator=="object"&&navigator||void 0,jw=Nu&&(!_d||["ReactNative","NativeScript","NS"].indexOf(_d.product)<0),Sw=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Nw=Nu&&window.location.href||"http://localhost",Cw=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Nu,hasStandardBrowserEnv:jw,hasStandardBrowserWebWorkerEnv:Sw,navigator:_d,origin:Nw},Symbol.toStringTag,{value:"Module"})),Rt={...Cw,...ww};function kw(e,t){return xl(e,new Rt.classes.URLSearchParams,{visitor:function(n,s,a,l){return Rt.isNode&&K.isBuffer(n)?(this.append(s,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function Pw(e){return K.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function bw(e){const t={},n=Object.keys(e);let s;const a=n.length;let l;for(s=0;s<a;s++)l=n[s],t[l]=e[l];return t}function Hg(e){function t(n,s,a,l){let c=n[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),f=l>=n.length;return c=!c&&K.isArray(a)?a.length:c,f?(K.hasOwnProp(a,c)?a[c]=[a[c],s]:a[c]=s,!u):((!a[c]||!K.isObject(a[c]))&&(a[c]=[]),t(n,s,a[c],l)&&K.isArray(a[c])&&(a[c]=bw(a[c])),!u)}if(K.isFormData(e)&&K.isFunction(e.entries)){const n={};return K.forEachEntry(e,(s,a)=>{t(Pw(s),a,n,0)}),n}return null}function Iw(e,t,n){if(K.isString(e))try{return(t||JSON.parse)(e),K.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const Ca={transitional:Wg,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",a=s.indexOf("application/json")>-1,l=K.isObject(t);if(l&&K.isHTMLForm(t)&&(t=new FormData(t)),K.isFormData(t))return a?JSON.stringify(Hg(t)):t;if(K.isArrayBuffer(t)||K.isBuffer(t)||K.isStream(t)||K.isFile(t)||K.isBlob(t)||K.isReadableStream(t))return t;if(K.isArrayBufferView(t))return t.buffer;if(K.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return kw(t,this.formSerializer).toString();if((u=K.isFileList(t))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return xl(u?{"files[]":t}:t,f&&new f,this.formSerializer)}}return l||a?(n.setContentType("application/json",!1),Iw(t)):t}],transformResponse:[function(t){const n=this.transitional||Ca.transitional,s=n&&n.forcedJSONParsing,a=this.responseType==="json";if(K.isResponse(t)||K.isReadableStream(t))return t;if(t&&K.isString(t)&&(s&&!this.responseType||a)){const c=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?Fe.from(u,Fe.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rt.classes.FormData,Blob:Rt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};K.forEach(["delete","get","head","post","put","patch"],e=>{Ca.headers[e]={}});const Lw=K.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ew=e=>{const t={};let n,s,a;return e&&e.split(`
`).forEach(function(c){a=c.indexOf(":"),n=c.substring(0,a).trim().toLowerCase(),s=c.substring(a+1).trim(),!(!n||t[n]&&Lw[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},Dh=Symbol("internals");function Us(e){return e&&String(e).trim().toLowerCase()}function No(e){return e===!1||e==null?e:K.isArray(e)?e.map(No):String(e)}function Tw(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const Bw=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function xc(e,t,n,s,a){if(K.isFunction(s))return s.call(this,t,n);if(a&&(t=n),!!K.isString(t)){if(K.isString(s))return t.indexOf(s)!==-1;if(K.isRegExp(s))return s.test(t)}}function Rw(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function Aw(e,t){const n=K.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(a,l,c){return this[s].call(this,t,a,l,c)},configurable:!0})})}let en=class{constructor(t){t&&this.set(t)}set(t,n,s){const a=this;function l(u,f,p){const g=Us(f);if(!g)throw new Error("header name must be a non-empty string");const x=K.findKey(a,g);(!x||a[x]===void 0||p===!0||p===void 0&&a[x]!==!1)&&(a[x||f]=No(u))}const c=(u,f)=>K.forEach(u,(p,g)=>l(p,g,f));if(K.isPlainObject(t)||t instanceof this.constructor)c(t,n);else if(K.isString(t)&&(t=t.trim())&&!Bw(t))c(Ew(t),n);else if(K.isObject(t)&&K.isIterable(t)){let u={},f,p;for(const g of t){if(!K.isArray(g))throw TypeError("Object iterator must return a key-value pair");u[p=g[0]]=(f=u[p])?K.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}c(u,n)}else t!=null&&l(n,t,s);return this}get(t,n){if(t=Us(t),t){const s=K.findKey(this,t);if(s){const a=this[s];if(!n)return a;if(n===!0)return Tw(a);if(K.isFunction(n))return n.call(this,a,s);if(K.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Us(t),t){const s=K.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||xc(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let a=!1;function l(c){if(c=Us(c),c){const u=K.findKey(s,c);u&&(!n||xc(s,s[u],u,n))&&(delete s[u],a=!0)}}return K.isArray(t)?t.forEach(l):l(t),a}clear(t){const n=Object.keys(this);let s=n.length,a=!1;for(;s--;){const l=n[s];(!t||xc(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const n=this,s={};return K.forEach(this,(a,l)=>{const c=K.findKey(s,l);if(c){n[c]=No(a),delete n[l];return}const u=t?Rw(l):String(l).trim();u!==l&&delete n[l],n[u]=No(a),s[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return K.forEach(this,(s,a)=>{s!=null&&s!==!1&&(n[a]=t&&K.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Dh]=this[Dh]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=Us(c);s[u]||(Aw(a,c),s[u]=!0)}return K.isArray(t)?t.forEach(l):l(t),this}};en.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);K.reduceDescriptors(en.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});K.freezeMethods(en);function _c(e,t){const n=this||Ca,s=t||n,a=en.from(s.headers);let l=s.data;return K.forEach(e,function(u){l=u.call(n,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function Zg(e){return!!(e&&e.__CANCEL__)}function vs(e,t,n){Fe.call(this,e??"canceled",Fe.ERR_CANCELED,t,n),this.name="CanceledError"}K.inherits(vs,Fe,{__CANCEL__:!0});function Vg(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new Fe("Request failed with status code "+n.status,[Fe.ERR_BAD_REQUEST,Fe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Fw(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Uw(e,t){e=e||10;const n=new Array(e),s=new Array(e);let a=0,l=0,c;return t=t!==void 0?t:1e3,function(f){const p=Date.now(),g=s[l];c||(c=p),n[a]=f,s[a]=p;let x=l,j=0;for(;x!==a;)j+=n[x++],x=x%e;if(a=(a+1)%e,a===l&&(l=(l+1)%e),p-c<t)return;const k=g&&p-g;return k?Math.round(j*1e3/k):void 0}}function Mw(e,t){let n=0,s=1e3/t,a,l;const c=(p,g=Date.now())=>{n=g,a=null,l&&(clearTimeout(l),l=null),e(...p)};return[(...p)=>{const g=Date.now(),x=g-n;x>=s?c(p,g):(a=p,l||(l=setTimeout(()=>{l=null,c(a)},s-x)))},()=>a&&c(a)]}const Ko=(e,t,n=3)=>{let s=0;const a=Uw(50,250);return Mw(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,f=c-s,p=a(f),g=c<=u;s=c;const x={loaded:c,total:u,progress:u?c/u:void 0,bytes:f,rate:p||void 0,estimated:p&&u&&g?(u-c)/p:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(x)},n)},zh=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},$h=e=>(...t)=>K.asap(()=>e(...t)),Ow=Rt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Rt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Rt.origin),Rt.navigator&&/(msie|trident)/i.test(Rt.navigator.userAgent)):()=>!0,Dw=Rt.hasStandardBrowserEnv?{write(e,t,n,s,a,l){const c=[e+"="+encodeURIComponent(t)];K.isNumber(n)&&c.push("expires="+new Date(n).toGMTString()),K.isString(s)&&c.push("path="+s),K.isString(a)&&c.push("domain="+a),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function zw(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function $w(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function qg(e,t,n){let s=!zw(t);return e&&(s||n==!1)?$w(e,t):t}const Wh=e=>e instanceof en?{...e}:e;function Pi(e,t){t=t||{};const n={};function s(p,g,x,j){return K.isPlainObject(p)&&K.isPlainObject(g)?K.merge.call({caseless:j},p,g):K.isPlainObject(g)?K.merge({},g):K.isArray(g)?g.slice():g}function a(p,g,x,j){if(K.isUndefined(g)){if(!K.isUndefined(p))return s(void 0,p,x,j)}else return s(p,g,x,j)}function l(p,g){if(!K.isUndefined(g))return s(void 0,g)}function c(p,g){if(K.isUndefined(g)){if(!K.isUndefined(p))return s(void 0,p)}else return s(void 0,g)}function u(p,g,x){if(x in t)return s(p,g);if(x in e)return s(void 0,p)}const f={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(p,g,x)=>a(Wh(p),Wh(g),x,!0)};return K.forEach(Object.keys({...e,...t}),function(g){const x=f[g]||a,j=x(e[g],t[g],g);K.isUndefined(j)&&x!==u||(n[g]=j)}),n}const Gg=e=>{const t=Pi({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=en.from(c),t.url=$g(qg(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),K.isFormData(n)){if(Rt.hasStandardBrowserEnv||Rt.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(K.isFunction(n.getHeaders)){const f=n.getHeaders(),p=["content-type","content-length"];Object.entries(f).forEach(([g,x])=>{p.includes(g.toLowerCase())&&c.set(g,x)})}}if(Rt.hasStandardBrowserEnv&&(s&&K.isFunction(s)&&(s=s(t)),s||s!==!1&&Ow(t.url))){const f=a&&l&&Dw.read(l);f&&c.set(a,f)}return t},Ww=typeof XMLHttpRequest<"u",Hw=Ww&&function(e){return new Promise(function(n,s){const a=Gg(e);let l=a.data;const c=en.from(a.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:p}=a,g,x,j,k,C;function S(){k&&k(),C&&C(),a.cancelToken&&a.cancelToken.unsubscribe(g),a.signal&&a.signal.removeEventListener("abort",g)}let P=new XMLHttpRequest;P.open(a.method.toUpperCase(),a.url,!0),P.timeout=a.timeout;function _(){if(!P)return;const w=en.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),B={data:!u||u==="text"||u==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:w,config:e,request:P};Vg(function(F){n(F),S()},function(F){s(F),S()},B),P=null}"onloadend"in P?P.onloadend=_:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(_)},P.onabort=function(){P&&(s(new Fe("Request aborted",Fe.ECONNABORTED,e,P)),P=null)},P.onerror=function(b){const B=b&&b.message?b.message:"Network Error",T=new Fe(B,Fe.ERR_NETWORK,e,P);T.event=b||null,s(T),P=null},P.ontimeout=function(){let b=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const B=a.transitional||Wg;a.timeoutErrorMessage&&(b=a.timeoutErrorMessage),s(new Fe(b,B.clarifyTimeoutError?Fe.ETIMEDOUT:Fe.ECONNABORTED,e,P)),P=null},l===void 0&&c.setContentType(null),"setRequestHeader"in P&&K.forEach(c.toJSON(),function(b,B){P.setRequestHeader(B,b)}),K.isUndefined(a.withCredentials)||(P.withCredentials=!!a.withCredentials),u&&u!=="json"&&(P.responseType=a.responseType),p&&([j,C]=Ko(p,!0),P.addEventListener("progress",j)),f&&P.upload&&([x,k]=Ko(f),P.upload.addEventListener("progress",x),P.upload.addEventListener("loadend",k)),(a.cancelToken||a.signal)&&(g=w=>{P&&(s(!w||w.type?new vs(null,e,P):w),P.abort(),P=null)},a.cancelToken&&a.cancelToken.subscribe(g),a.signal&&(a.signal.aborted?g():a.signal.addEventListener("abort",g)));const v=Fw(a.url);if(v&&Rt.protocols.indexOf(v)===-1){s(new Fe("Unsupported protocol "+v+":",Fe.ERR_BAD_REQUEST,e));return}P.send(l||null)})},Zw=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,a;const l=function(p){if(!a){a=!0,u();const g=p instanceof Error?p:this.reason;s.abort(g instanceof Fe?g:new vs(g instanceof Error?g.message:g))}};let c=t&&setTimeout(()=>{c=null,l(new Fe(`timeout ${t} of ms exceeded`,Fe.ETIMEDOUT))},t);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(l):p.removeEventListener("abort",l)}),e=null)};e.forEach(p=>p.addEventListener("abort",l));const{signal:f}=s;return f.unsubscribe=()=>K.asap(u),f}},Vw=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,a;for(;s<n;)a=s+t,yield e.slice(s,a),s=a},qw=async function*(e,t){for await(const n of Gw(e))yield*Vw(n,t)},Gw=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},Hh=(e,t,n,s)=>{const a=qw(e,t);let l=0,c,u=f=>{c||(c=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:p,value:g}=await a.next();if(p){u(),f.close();return}let x=g.byteLength;if(n){let j=l+=x;n(j)}f.enqueue(new Uint8Array(g))}catch(p){throw u(p),p}},cancel(f){return u(f),a.return()}},{highWaterMark:2})},Zh=64*1024,{isFunction:oo}=K,Yw=(({Request:e,Response:t})=>({Request:e,Response:t}))(K.global),{ReadableStream:Vh,TextEncoder:qh}=K.global,Gh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Kw=e=>{e=K.merge.call({skipUndefined:!0},Yw,e);const{fetch:t,Request:n,Response:s}=e,a=t?oo(t):typeof fetch=="function",l=oo(n),c=oo(s);if(!a)return!1;const u=a&&oo(Vh),f=a&&(typeof qh=="function"?(C=>S=>C.encode(S))(new qh):async C=>new Uint8Array(await new n(C).arrayBuffer())),p=l&&u&&Gh(()=>{let C=!1;const S=new n(Rt.origin,{body:new Vh,method:"POST",get duplex(){return C=!0,"half"}}).headers.has("Content-Type");return C&&!S}),g=c&&u&&Gh(()=>K.isReadableStream(new s("").body)),x={stream:g&&(C=>C.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(C=>{!x[C]&&(x[C]=(S,P)=>{let _=S&&S[C];if(_)return _.call(S);throw new Fe(`Response type '${C}' is not supported`,Fe.ERR_NOT_SUPPORT,P)})});const j=async C=>{if(C==null)return 0;if(K.isBlob(C))return C.size;if(K.isSpecCompliantForm(C))return(await new n(Rt.origin,{method:"POST",body:C}).arrayBuffer()).byteLength;if(K.isArrayBufferView(C)||K.isArrayBuffer(C))return C.byteLength;if(K.isURLSearchParams(C)&&(C=C+""),K.isString(C))return(await f(C)).byteLength},k=async(C,S)=>{const P=K.toFiniteNumber(C.getContentLength());return P??j(S)};return async C=>{let{url:S,method:P,data:_,signal:v,cancelToken:w,timeout:b,onDownloadProgress:B,onUploadProgress:T,responseType:F,headers:R,withCredentials:O="same-origin",fetchOptions:I}=Gg(C),D=t||fetch;F=F?(F+"").toLowerCase():"text";let q=Zw([v,w&&w.toAbortSignal()],b),te=null;const G=q&&q.unsubscribe&&(()=>{q.unsubscribe()});let E;try{if(T&&p&&P!=="get"&&P!=="head"&&(E=await k(R,_))!==0){let U=new n(S,{method:"POST",body:_,duplex:"half"}),ie;if(K.isFormData(_)&&(ie=U.headers.get("content-type"))&&R.setContentType(ie),U.body){const[Z,se]=zh(E,Ko($h(T)));_=Hh(U.body,Zh,Z,se)}}K.isString(O)||(O=O?"include":"omit");const oe=l&&"credentials"in n.prototype,Ne={...I,signal:q,method:P.toUpperCase(),headers:R.normalize().toJSON(),body:_,duplex:"half",credentials:oe?O:void 0};te=l&&new n(S,Ne);let W=await(l?D(te,I):D(S,Ne));const fe=g&&(F==="stream"||F==="response");if(g&&(B||fe&&G)){const U={};["status","statusText","headers"].forEach(ne=>{U[ne]=W[ne]});const ie=K.toFiniteNumber(W.headers.get("content-length")),[Z,se]=B&&zh(ie,Ko($h(B),!0))||[];W=new s(Hh(W.body,Zh,Z,()=>{se&&se(),G&&G()}),U)}F=F||"text";let re=await x[K.findKey(x,F)||"text"](W,C);return!fe&&G&&G(),await new Promise((U,ie)=>{Vg(U,ie,{data:re,headers:en.from(W.headers),status:W.status,statusText:W.statusText,config:C,request:te})})}catch(oe){throw G&&G(),oe&&oe.name==="TypeError"&&/Load failed|fetch/i.test(oe.message)?Object.assign(new Fe("Network Error",Fe.ERR_NETWORK,C,te),{cause:oe.cause||oe}):Fe.from(oe,oe&&oe.code,C,te)}}},Qw=new Map,Yg=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:a}=t,l=[s,a,n];let c=l.length,u=c,f,p,g=Qw;for(;u--;)f=l[u],p=g.get(f),p===void 0&&g.set(f,p=u?new Map:Kw(t)),g=p;return p};Yg();const wd={http:pw,xhr:Hw,fetch:{get:Yg}};K.forEach(wd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Yh=e=>`- ${e}`,Jw=e=>K.isFunction(e)||e===null||e===!1,Kg={getAdapter:(e,t)=>{e=K.isArray(e)?e:[e];const{length:n}=e;let s,a;const l={};for(let c=0;c<n;c++){s=e[c];let u;if(a=s,!Jw(s)&&(a=wd[(u=String(s)).toLowerCase()],a===void 0))throw new Fe(`Unknown adapter '${u}'`);if(a&&(K.isFunction(a)||(a=a.get(t))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([f,p])=>`adapter ${f} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=n?c.length>1?`since :
`+c.map(Yh).join(`
`):" "+Yh(c[0]):"as no adapter specified";throw new Fe("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a},adapters:wd};function wc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new vs(null,e)}function Kh(e){return wc(e),e.headers=en.from(e.headers),e.data=_c.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Kg.getAdapter(e.adapter||Ca.adapter,e)(e).then(function(s){return wc(e),s.data=_c.call(e,e.transformResponse,s),s.headers=en.from(s.headers),s},function(s){return Zg(s)||(wc(e),s&&s.response&&(s.response.data=_c.call(e,e.transformResponse,s.response),s.response.headers=en.from(s.response.headers))),Promise.reject(s)})}const Qg="1.12.2",_l={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{_l[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const Qh={};_l.transitional=function(t,n,s){function a(l,c){return"[Axios v"+Qg+"] Transitional option '"+l+"'"+c+(s?". "+s:"")}return(l,c,u)=>{if(t===!1)throw new Fe(a(c," has been removed"+(n?" in "+n:"")),Fe.ERR_DEPRECATED);return n&&!Qh[c]&&(Qh[c]=!0,console.warn(a(c," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(l,c,u):!0}};_l.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Xw(e,t,n){if(typeof e!="object")throw new Fe("options must be an object",Fe.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const l=s[a],c=t[l];if(c){const u=e[l],f=u===void 0||c(u,l,e);if(f!==!0)throw new Fe("option "+l+" must be "+f,Fe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Fe("Unknown option "+l,Fe.ERR_BAD_OPTION)}}const Co={assertOptions:Xw,validators:_l},Hn=Co.validators;let wi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Oh,response:new Oh}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Pi(this.defaults,n);const{transitional:s,paramsSerializer:a,headers:l}=n;s!==void 0&&Co.assertOptions(s,{silentJSONParsing:Hn.transitional(Hn.boolean),forcedJSONParsing:Hn.transitional(Hn.boolean),clarifyTimeoutError:Hn.transitional(Hn.boolean)},!1),a!=null&&(K.isFunction(a)?n.paramsSerializer={serialize:a}:Co.assertOptions(a,{encode:Hn.function,serialize:Hn.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Co.assertOptions(n,{baseUrl:Hn.spelling("baseURL"),withXsrfToken:Hn.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let c=l&&K.merge(l.common,l[n.method]);l&&K.forEach(["delete","get","head","post","put","patch","common"],C=>{delete l[C]}),n.headers=en.concat(c,l);const u=[];let f=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(n)===!1||(f=f&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const p=[];this.interceptors.response.forEach(function(S){p.push(S.fulfilled,S.rejected)});let g,x=0,j;if(!f){const C=[Kh.bind(this),void 0];for(C.unshift(...u),C.push(...p),j=C.length,g=Promise.resolve(n);x<j;)g=g.then(C[x++],C[x++]);return g}j=u.length;let k=n;for(;x<j;){const C=u[x++],S=u[x++];try{k=C(k)}catch(P){S.call(this,P);break}}try{g=Kh.call(this,k)}catch(C){return Promise.reject(C)}for(x=0,j=p.length;x<j;)g=g.then(p[x++],p[x++]);return g}getUri(t){t=Pi(this.defaults,t);const n=qg(t.baseURL,t.url,t.allowAbsoluteUrls);return $g(n,t.params,t.paramsSerializer)}};K.forEach(["delete","get","head","options"],function(t){wi.prototype[t]=function(n,s){return this.request(Pi(s||{},{method:t,url:n,data:(s||{}).data}))}});K.forEach(["post","put","patch"],function(t){function n(s){return function(l,c,u){return this.request(Pi(u||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}wi.prototype[t]=n(),wi.prototype[t+"Form"]=n(!0)});let ej=class Jg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const s=this;this.promise.then(a=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](a);s._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{s.subscribe(u),l=u}).then(a);return c.cancel=function(){s.unsubscribe(l)},c},t(function(l,c,u){s.reason||(s.reason=new vs(l,c,u),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Jg(function(a){t=a}),cancel:t}}};function tj(e){return function(n){return e.apply(null,n)}}function nj(e){return K.isObject(e)&&e.isAxiosError===!0}const jd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jd).forEach(([e,t])=>{jd[t]=e});function Xg(e){const t=new wi(e),n=Lg(wi.prototype.request,t);return K.extend(n,wi.prototype,t,{allOwnKeys:!0}),K.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return Xg(Pi(e,a))},n}const ft=Xg(Ca);ft.Axios=wi;ft.CanceledError=vs;ft.CancelToken=ej;ft.isCancel=Zg;ft.VERSION=Qg;ft.toFormData=xl;ft.AxiosError=Fe;ft.Cancel=ft.CanceledError;ft.all=function(t){return Promise.all(t)};ft.spread=tj;ft.isAxiosError=nj;ft.mergeConfig=Pi;ft.AxiosHeaders=en;ft.formToJSON=e=>Hg(K.isHTMLForm(e)?new FormData(e):e);ft.getAdapter=Kg.getAdapter;ft.HttpStatusCode=jd;ft.default=ft;const{Axios:t1,AxiosError:n1,CanceledError:r1,isCancel:i1,CancelToken:s1,VERSION:a1,all:o1,Cancel:l1,isAxiosError:c1,spread:d1,toFormData:u1,AxiosHeaders:f1,HttpStatusCode:h1,formToJSON:p1,getAdapter:m1,mergeConfig:g1}=ft,wl="http://localhost:5054/api",de=ft.create({baseURL:wl,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});de.interceptors.request.use(e=>{try{const t=localStorage.getItem("token");t&&t!=="null"&&(e.headers.Authorization=`Bearer ${t}`)}catch{}return e},e=>Promise.reject(e));let lo=!1,Sd=[];const Jh=(e,t=null)=>{Sd.forEach(n=>{e?n.reject(e):n.resolve(t)}),Sd=[]};de.interceptors.response.use(e=>e,async e=>{var n,s,a,l,c,u,f,p;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){if(lo)return new Promise((g,x)=>{Sd.push({resolve:g,reject:x})}).then(g=>(t.headers.Authorization=`Bearer ${g}`,de(t))).catch(g=>Promise.reject(g));t._retry=!0,lo=!0;try{console.log(" Token expired, refreshing...");const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const x=await ft.post(`${wl}/Auth/Refresh-Token`,{refreshToken:g}),j=((a=(s=x.data)==null?void 0:s.data)==null?void 0:a.token)||((l=x.data)==null?void 0:l.token)||((c=x.data)==null?void 0:c.accessToken),k=((f=(u=x.data)==null?void 0:u.data)==null?void 0:f.refreshToken)||((p=x.data)==null?void 0:p.refreshToken);if(j)return console.log(" Token refreshed successfully"),localStorage.setItem("token",j),k&&localStorage.setItem("refreshToken",k),t.headers.Authorization=`Bearer ${j}`,Jh(null,j),lo=!1,de(t);throw new Error("No token in refresh response")}catch(g){return console.error(" Token refresh failed:",g),Jh(g,null),lo=!1,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),window.location.href="/",Promise.reject(g)}}return Promise.reject(e)});const rj=e=>{if(!e)return{};try{const t=e.split(".");if(t.length<2)return{};const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch(t){return console.warn("decodeJwt failed",t),{}}},Vn={register:async({fullName:e,email:t,phoneNumber:n,password:s})=>{const a={FullName:e,Email:t,PhoneNumber:n,Password:s,ConfirmPassword:s};return(await de.post("/Auth/Register",a)).data},login:async(e,t)=>{var c,u,f;const n=await de.post("/Auth/Login",{Email:e,Password:t}),s=((c=n.data)==null?void 0:c.data)||n.data||{},a=s.token||s.accessToken||((u=n.data)==null?void 0:u.token),l=s.refreshToken||((f=n.data)==null?void 0:f.refreshToken);if(a){localStorage.setItem("token",a);try{const p=rj(a),g=p["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||p.nameidentifier||p.UserId||p.userId||p.uid||p.nameid||p.sub||p.id||p.Id;g&&localStorage.setItem("userId",g);const x=p["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||p.role||p.Role;x&&localStorage.setItem("userRole",x)}catch(p){console.error(" Error decoding JWT in authApi.login:",p)}}l&&localStorage.setItem("refreshToken",l),s.user&&localStorage.setItem("user",JSON.stringify(s.user));try{const p=localStorage.getItem("userRole");if(p&&(p.includes("Staff")||p.includes("staff")||p==="StationManager"||p.includes("Manager"))){const x=await Vn.getMyProfile(),j=(x==null?void 0:x.stationId)||(x==null?void 0:x.StationId);j&&localStorage.setItem("stationId",j)}}catch(p){console.warn(" Could not fetch staff profile after login:",p)}return{raw:n.data,token:a,refreshToken:l,payload:s}},logout:async()=>{const e=await de.post("/Auth/Logout");return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),localStorage.removeItem("userRole"),localStorage.removeItem("stationId"),e.data},refreshToken:async()=>{var s,a,l,c,u,f,p;const e=await de.post("/Auth/Refresh-Token"),t=((a=(s=e.data)==null?void 0:s.data)==null?void 0:a.token)||((l=e.data)==null?void 0:l.token)||((c=e.data)==null?void 0:c.accessToken),n=((f=(u=e.data)==null?void 0:u.data)==null?void 0:f.refreshToken)||((p=e.data)==null?void 0:p.refreshToken);return t&&localStorage.setItem("token",t),n&&localStorage.setItem("refreshToken",n),e.data},uploadCCCD:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await de.post("/Auth/cccd",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},uploadGPLX:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await de.post("/Auth/gplx",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},getMe:async()=>{var t;const e=await de.get("/Auth/Me");return((t=e.data)==null?void 0:t.data)||e.data||{}},getMyProfile:async()=>{var t;const e=await de.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},getUserById:async e=>{var t,n;try{const s=await de.get(`/Users/Get-By-${encodeURIComponent(e)}`);return((t=s.data)==null?void 0:t.data)||s.data||{}}catch{try{const a=await de.get(`/Users/${encodeURIComponent(e)}`);return((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error("authApi.getUserById failed:",a),a}}}};function ij(){const[e,t]=y.useState({}),[n,s]=y.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""}),[a,l]=y.useState({}),[c,u]=y.useState({cccdFront:null,cccdBack:null,licenseFront:null,licenseBack:null}),f={cccdFront:y.useRef(null),cccdBack:y.useRef(null),licenseFront:y.useRef(null),licenseBack:y.useRef(null)},p=y.useRef({});y.useEffect(()=>{(async()=>{try{console.log(" Fetching user profile from /api/Users/Get-My-Profile...");const C=await Vn.getMyProfile();console.log(" User profile:",C),t(C||{}),console.log(" Fetching document URLs from /api/Auth/me...");const S=await Vn.getMe();console.log(" Auth response from /api/Auth/me:",S);const P=S||{};console.log(" Extracted auth data:",P);const _=P.cccdImageUrl_Front&&P.cccdImageUrl_Front.trim()?P.cccdImageUrl_Front:"",v=P.cccdImageUrl_Back&&P.cccdImageUrl_Back.trim()?P.cccdImageUrl_Back:"",w=P.gplxImageUrl_Front&&P.gplxImageUrl_Front.trim()?P.gplxImageUrl_Front:"",b=P.gplxImageUrl_Back&&P.gplxImageUrl_Back.trim()?P.gplxImageUrl_Back:"";console.log(" Loaded document URLs:",{cccdFront:_,cccdBack:v,licenseFront:w,licenseBack:b}),s({cccdFront:_,cccdBack:v,licenseFront:w,licenseBack:b}),p.current={cccdFront:_,cccdBack:v,licenseFront:w,licenseBack:b}}catch(C){console.error(" Error loading profile:",C);const S=localStorage.getItem("userEmail"),P=localStorage.getItem("username"),_=localStorage.getItem("userPhone");t({email:S,fullName:P,phoneNumber:_}),s({cccdFront:localStorage.getItem("cccdFront")||"",cccdBack:localStorage.getItem("cccdBack")||"",licenseFront:localStorage.getItem("licenseFront")||"",licenseBack:localStorage.getItem("licenseBack")||""})}})()},[]);const g=async(k,C)=>{if(!C)return;if(!C.type.startsWith("image/")){alert("Please select an image file");return}if(C.size>5*1024*1024){alert("File must be <5MB");return}u(P=>({...P,[k]:C}));const S=new FileReader;S.onload=P=>{s(_=>({..._,[k]:P.target.result}))},S.readAsDataURL(C),console.log(` File selected for ${k}:`,C.name)},x=async()=>{var S,P;const k=c.cccdFront,C=c.cccdBack;if(!k&&!C){alert("Please select at least one CCCD image");return}l(_=>({..._,cccdFront:!0,cccdBack:!0}));try{console.log(" Uploading CCCD documents..."),await Vn.uploadCCCD(k,C);const v=await Vn.getMe()||{},w=v.cccdImageUrl_Front||"",b=v.cccdImageUrl_Back||"";s(B=>({...B,cccdFront:w,cccdBack:b})),u(B=>({...B,cccdFront:null,cccdBack:null})),alert(" CCCD uploaded successfully!")}catch(_){console.error(" Error uploading CCCD:",_),alert(` Upload failed: ${((P=(S=_.response)==null?void 0:S.data)==null?void 0:P.message)||_.message}`)}finally{l(_=>({..._,cccdFront:!1,cccdBack:!1}))}},j=async()=>{var S,P;const k=c.licenseFront,C=c.licenseBack;if(!k&&!C){alert("Please select at least one license image");return}l(_=>({..._,licenseFront:!0,licenseBack:!0}));try{console.log(" Uploading license documents..."),await Vn.uploadGPLX(k,C);const v=await Vn.getMe()||{},w=v.gplxImageUrl_Front||"",b=v.gplxImageUrl_Back||"";s(B=>({...B,licenseFront:w,licenseBack:b})),u(B=>({...B,licenseFront:null,licenseBack:null})),alert(" License uploaded successfully!")}catch(_){console.error(" Error uploading license:",_),alert(` Upload failed: ${((P=(S=_.response)==null?void 0:S.data)==null?void 0:P.message)||_.message}`)}finally{l(_=>({..._,licenseFront:!1,licenseBack:!1}))}};return i.jsx("main",{className:"profile-main",children:i.jsxs("div",{className:"profile-container",children:[i.jsx("h2",{children:"USER PROFILE"}),i.jsxs("div",{className:"profile-field",children:[i.jsx("label",{children:"Full Name"}),i.jsx("input",{type:"text",value:e.firstName?`${e.firstName} ${e.lastName}`:e.fullName||"",readOnly:!0})]}),i.jsxs("div",{className:"profile-field",children:[i.jsx("label",{children:"Email"}),i.jsx("input",{type:"email",value:e.email||"",readOnly:!0})]}),i.jsxs("div",{className:"profile-field",children:[i.jsx("label",{children:"Phone Number"}),i.jsx("input",{type:"tel",value:e.phoneNumber||"",readOnly:!0})]}),i.jsxs("div",{className:"documents-section",children:[i.jsx("h3",{children:"Upload ID Card (CCCD)"}),i.jsx("p",{className:"documents-note",children:"Please upload clear images of your ID card (both sides)"}),i.jsxs("div",{className:"documents-grid",children:[i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"ID (Front)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.cccdFront.current)==null?void 0:k.click()},children:[n.cccdFront&&n.cccdFront.trim()?i.jsx("img",{src:n.cccdFront,alt:"CCCD Front",className:"doc-preview",onLoad:()=>console.log(" cccdFront image loaded"),onError:k=>console.error(" Failed to load cccdFront"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card"}),i.jsx("span",{children:c.cccdFront?c.cccdFront.name:"Click to select"})]}),a.cccdFront&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.cccdFront,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("cccdFront",(C=k.target.files)==null?void 0:C[0])}})]}),i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"ID (Back)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.cccdBack.current)==null?void 0:k.click()},children:[n.cccdBack&&n.cccdBack.trim()?i.jsx("img",{src:n.cccdBack,alt:"CCCD Back",className:"doc-preview",onLoad:()=>console.log(" cccdBack image loaded"),onError:k=>console.error(" Failed to load cccdBack"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card"}),i.jsx("span",{children:c.cccdBack?c.cccdBack.name:"Click to select"})]}),a.cccdBack&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.cccdBack,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("cccdBack",(C=k.target.files)==null?void 0:C[0])}})]})]}),i.jsxs("button",{className:"btn-upload-docs",onClick:x,disabled:!c.cccdFront&&!c.cccdBack,children:[i.jsx("i",{className:"fas fa-upload"})," Upload ID Card"]})]}),i.jsxs("div",{className:"documents-section",children:[i.jsx("h3",{children:"Upload Driver License (GPLX)"}),i.jsx("p",{className:"documents-note",children:"Please upload clear images of your driver's license (both sides)"}),i.jsxs("div",{className:"documents-grid",children:[i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"Driver license (Front)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.licenseFront.current)==null?void 0:k.click()},children:[n.licenseFront&&n.licenseFront.trim()?i.jsx("img",{src:n.licenseFront,alt:"License Front",className:"doc-preview",onLoad:()=>console.log(" licenseFront image loaded"),onError:k=>console.error(" Failed to load licenseFront"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card-alt"}),i.jsx("span",{children:c.licenseFront?c.licenseFront.name:"Click to select"})]}),a.licenseFront&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.licenseFront,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("licenseFront",(C=k.target.files)==null?void 0:C[0])}})]}),i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"Driver license (Back)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.licenseBack.current)==null?void 0:k.click()},children:[n.licenseBack&&n.licenseBack.trim()?i.jsx("img",{src:n.licenseBack,alt:"License Back",className:"doc-preview",onLoad:()=>console.log(" licenseBack image loaded"),onError:k=>console.error(" Failed to load licenseBack"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card-alt"}),i.jsx("span",{children:c.licenseBack?c.licenseBack.name:"Click to select"})]}),a.licenseBack&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.licenseBack,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("licenseBack",(C=k.target.files)==null?void 0:C[0])}})]})]}),i.jsxs("button",{className:"btn-upload-docs",onClick:j,disabled:!c.licenseFront&&!c.licenseBack,children:[i.jsx("i",{className:"fas fa-upload"})," Upload Driver License"]})]})]})})}const sj={getMyProfile:async()=>{var t;const e=await de.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},updateMyProfile:async e=>{var t,n;try{console.log(" Updating user profile:",e);const s=await de.put("/Users/Update-My-Profile",e);return console.log(" Profile updated:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error updating profile:",((n=s.response)==null?void 0:n.data)||s.message),s}},changePassword:async(e,t)=>{var n,s;try{console.log(" Changing password");const a=await de.post("/Users/Change-Password",{currentPassword:e,newPassword:t});return console.log(" Password changed successfully"),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error changing password:",((s=a.response)==null?void 0:s.data)||a.message),a}},updateUserAvatar:async(e,t)=>{var n,s;try{console.log(" Updating avatar for user:",e);const a=await de.post(`/Users/${encodeURIComponent(e)}/avatar`,{avatarUrl:t});return console.log(" Avatar updated:",a.data),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error updating avatar:",((s=a.response)==null?void 0:s.data)||a.message),a}},getUserById:async e=>{var t,n;try{console.log(" Fetching user by ID:",e);const s=await de.get(`/Users/Get-By-${encodeURIComponent(e)}`);return console.log(" User data:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching user:",((n=s.response)==null?void 0:n.data)||s.message),s}},searchUsers:async(e,t=1,n=10)=>{var s,a,l;try{console.log(" Searching users by email:",e);const c=await de.get("/Users/Search",{params:{email:e,pageNumber:t,pageSize:n}});return console.log(" Search results:",c.data),Array.isArray(c.data)?c.data:(s=c.data)!=null&&s.data&&Array.isArray(c.data.data)?c.data.data:(a=c.data)!=null&&a.items&&Array.isArray(c.data.items)?c.data.items:c.data||[]}catch(c){return console.error(" Error searching users:",((l=c.response)==null?void 0:l.data)||c.message),[]}},deactivateUser:async(e,t="")=>{var n;try{const s=encodeURIComponent(e),a=t?`?reason=${encodeURIComponent(t)}`:"",l=[`/Users/Deactivate-By-${s}${a}`,`/User/Deactivate-By-${s}${a}`];for(const c of l)try{const u=await de.patch(c,t?{reason:t}:{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(n=u==null?void 0:u.response)==null?void 0:n.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Deactivate user endpoint not found")}catch(s){throw console.error(" Error deactivating user:",s.message),s}},activateUser:async e=>{var t;try{const n=encodeURIComponent(e),s=[`/Users/Activate-By-${n}`,`/User/Activate-By-${n}`];for(const a of s)try{const l=await de.patch(a,{}),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(t=l==null?void 0:l.response)==null?void 0:t.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Activate user endpoint not found")}catch(n){throw console.error(" Error activating user:",n.message),n}},updateUserRole:async(e,t)=>{var n;try{const s=encodeURIComponent(e),a=[`/Users/Update-Role-By-${s}`,`/User/Update-Role-By-${s}`];for(const l of a)try{const c=await de.patch(l,{role:t}),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){const u=(n=c==null?void 0:c.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw c}throw new Error("Update user role endpoint not found")}catch(s){throw console.error(" Error updating user role:",s.message),s}},updateUserProfileByAdmin:async(e,t)=>{var n;try{const s=encodeURIComponent(e),a=[`/Users/Update-Profile-By-${s}`,`/User/Update-Profile-By-${s}`];for(const l of a)try{const c=await de.put(l,t),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){const u=(n=c==null?void 0:c.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw c}throw new Error("Update user profile endpoint not found")}catch(s){throw console.error(" Error updating user profile:",s.message),s}},getTotalUserCount:async()=>{var e;try{const t=["/Users/Get-Total-Count","/User/Get-Total-Count"];for(const n of t)try{const s=await de.get(n),a=s==null?void 0:s.data,l=a&&typeof a=="object"&&"data"in a?a.data:a;return(l==null?void 0:l.totalCount)||(l==null?void 0:l.count)||l||0}catch(s){const a=(e=s==null?void 0:s.response)==null?void 0:e.status;if(a&&a!==404&&a!==405)throw s}return 0}catch(t){return console.error(" Error getting total user count:",t.message),0}},getUserStatisticsByRole:async()=>{var e;try{const t=["/Users/Get-Statistics-By-Role","/User/Get-Statistics-By-Role","/Users/Statistics-By-Role"];for(const n of t)try{const s=await de.get(n),a=s==null?void 0:s.data;return(a&&typeof a=="object"&&"data"in a?a.data:a)||{}}catch(s){const a=(e=s==null?void 0:s.response)==null?void 0:e.status;if(a&&a!==404&&a!==405)throw s}return{}}catch(t){return console.error(" Error getting user statistics:",t.message),{}}}};function ka({isOpen:e,type:t="info",title:n,message:s,onClose:a,actionLabel:l="OK",onAction:c,autoCloseMs:u=null}){if(Kn.useEffect(()=>{if(!e||!u)return;const g=setTimeout(a,u);return()=>clearTimeout(g)},[e,u,a]),!e)return null;const f=()=>{c&&c(),a()},p={success:"",error:"",info:"",warning:""}[t]||"";return i.jsx("div",{className:`notification-backdrop notification-${t}`,children:i.jsxs("div",{className:`notification-modal notification-${t}`,children:[i.jsxs("div",{className:"notification-header",children:[i.jsx("span",{className:"notification-icon",children:p}),i.jsx("h3",{className:"notification-title",children:n}),i.jsx("button",{className:"notification-close",onClick:a,children:""})]}),i.jsx("div",{className:"notification-body",children:Array.isArray(s)?i.jsx("ul",{children:s.map((g,x)=>i.jsx("li",{children:g},x))}):i.jsx("p",{children:s})}),i.jsxs("div",{className:"notification-footer",children:[i.jsx("button",{className:"btn-close",onClick:a,children:"Close"}),c&&i.jsx("button",{className:`btn-action btn-${t}`,onClick:f,children:l})]})]})})}function aj(){const e=pr(),[t,n]=y.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[s,a]=y.useState(!1),[l,c]=y.useState(!0),[u,f]=y.useState([]),[p,g]=y.useState({isOpen:!1,type:"info",title:"",message:""});y.useEffect(()=>{x()},[]);const x=async()=>{try{c(!0),console.log(" Initializing profile form...");const S=localStorage.getItem("userFirstName")||"",P=localStorage.getItem("userLastName")||"",_=localStorage.getItem("userPhone")||"";console.log(" Profile initialized from localStorage");const v=[],w=localStorage.getItem("userAddress"),b=localStorage.getItem("userDateOfBirth"),B=localStorage.getItem("userDriverLicenseNumber"),T=localStorage.getItem("userDriverLicenseExpiry");console.log(" Checking 4 required fields:"),console.log("  Address:",w),console.log("  DateOfBirth:",b),console.log("  DriverLicenseNumber:",B),console.log("  DriverLicenseExpiry:",T),(!w||w.trim()==="")&&v.push("address"),(!b||b.trim()==="")&&v.push("dateOfBirth"),(!B||B.trim()==="")&&v.push("driverLicenseNumber"),(!T||T.trim()==="")&&v.push("driverLicenseExpiry"),f(v),console.log(" Missing fields:",v),n({firstName:S,lastName:P,phoneNumber:_,address:localStorage.getItem("userAddress")||"",dateOfBirth:localStorage.getItem("userDateOfBirth")||"",yearOfBirth:localStorage.getItem("userYearOfBirth")||"",identityNumber:localStorage.getItem("userIdentityNumber")||"",driverLicenseNumber:localStorage.getItem("userDriverLicenseNumber")||"",driverLicenseExpiry:localStorage.getItem("userDriverLicenseExpiry")||"",driverLicenseClass:localStorage.getItem("userDriverLicenseClass")||""})}catch(S){console.error(" Error initializing profile:",S)}finally{c(!1)}},j=S=>{const{name:P,value:_}=S.target,v={...t,[P]:_};if(P==="dateOfBirth"&&_){const w=new Date(_).getFullYear();v.yearOfBirth=String(w),console.log(` Extracted year ${w} from date ${_}`)}n(v)},k=()=>t.firstName.trim()?t.lastName.trim()?t.phoneNumber.trim()?t.phoneNumber.match(/^[0-9]{10,11}$/)?t.address.trim()?t.driverLicenseNumber.trim()?t.driverLicenseExpiry.trim()?!0:(g({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Expiry is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Number is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Address is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number must be 10-11 digits"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Last name is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"First name is required"}),!1),C=async S=>{var P,_;if(S.preventDefault(),!!k()){a(!0);try{console.log(" Updating profile with data:",t);const v={request:"UpdateProfile",firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber,address:t.address||"",dateOfBirth:t.dateOfBirth||"",yearOfBirth:t.yearOfBirth?String(t.yearOfBirth):"",identityNumber:t.identityNumber||"",driverLicenseNumber:t.driverLicenseNumber||"",driverLicenseExpiry:t.driverLicenseExpiry||"",driverLicenseClass:t.driverLicenseClass||""},w=await sj.updateMyProfile(v);console.log(" Profile updated successfully:",w),localStorage.setItem("userFirstName",t.firstName),localStorage.setItem("userLastName",t.lastName),localStorage.setItem("userPhone",t.phoneNumber),localStorage.setItem("userAddress",t.address),localStorage.setItem("userDateOfBirth",t.dateOfBirth),localStorage.setItem("userYearOfBirth",t.yearOfBirth),localStorage.setItem("userIdentityNumber",t.identityNumber),localStorage.setItem("userDriverLicenseNumber",t.driverLicenseNumber),localStorage.setItem("userDriverLicenseExpiry",t.driverLicenseExpiry),localStorage.setItem("userDriverLicenseClass",t.driverLicenseClass),g({isOpen:!0,type:"success",title:"Success! ",message:"Your profile has been updated successfully.",autoCloseMs:2e3,onAction:()=>{e("/")},actionLabel:"Go to Home"})}catch(v){console.error(" Error updating profile:",v),g({isOpen:!0,type:"error",title:"Update Failed",message:((_=(P=v.response)==null?void 0:P.data)==null?void 0:_.message)||"Failed to update profile. Please try again."})}finally{a(!1)}}};return l?i.jsx("div",{className:"update-profile-page",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Loading your profile..."})]})}):i.jsxs("div",{className:"update-profile-page",children:[i.jsx(ka,{isOpen:p.isOpen,type:p.type,title:p.title,message:p.message,onClose:()=>g({...p,isOpen:!1}),autoCloseMs:p.autoCloseMs||0,onAction:p.onAction,actionLabel:p.actionLabel}),i.jsxs("div",{className:"container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("h1",{children:" Update Your Profile"}),i.jsx("p",{style:{color:"white"},children:"Keep your information up to date to enjoy our services"})]}),u.length>0&&i.jsxs("div",{className:"warning-banner",children:[i.jsx("span",{className:"warning-icon",children:""}),i.jsxs("div",{children:[i.jsx("strong",{children:"Missing Information"}),i.jsxs("p",{children:["Please complete the following fields: ",u.map(S=>S==="address"?"Address":S==="driverLicenseNumber"?"Driver License Number":S==="driverLicenseExpiry"?"Driver License Expiry":S).join(", ")]})]})]}),i.jsxs("form",{onSubmit:C,className:"update-profile-form",children:[i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Basic Information"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"firstName",children:"First Name *"}),i.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:j,placeholder:"John",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),i.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:j,placeholder:"Doe",required:!0})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),i.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:t.phoneNumber,onChange:j,placeholder:"0912345678",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"address",children:["Address *",u.includes("address")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"text",id:"address",name:"address",value:t.address,onChange:j,placeholder:"123 Main St, City, Country",className:u.includes("address")?"field-missing":"",required:!0})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Birth Information"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),i.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:t.dateOfBirth,onChange:j})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth (Auto-filled)"}),i.jsx("input",{type:"text",id:"yearOfBirth",name:"yearOfBirth",value:t.yearOfBirth,disabled:!0,placeholder:"Will auto-fill from date above",style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Driver License Information *"}),i.jsxs("div",{className:`form-group ${u.includes("driverLicenseNumber")?"field-missing-group":""}`,children:[i.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number *",u.includes("driverLicenseNumber")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:t.driverLicenseNumber,onChange:j,placeholder:"ABC123456",className:u.includes("driverLicenseNumber")?"field-missing":"",required:!0})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:`form-group ${u.includes("driverLicenseExpiry")?"field-missing-group":""}`,children:[i.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry *",u.includes("driverLicenseExpiry")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:t.driverLicenseExpiry,onChange:j,className:u.includes("driverLicenseExpiry")?"field-missing":"",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),i.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:t.driverLicenseClass,onChange:j,children:[i.jsx("option",{value:"",children:"Select Class"}),i.jsx("option",{value:"A",children:"Class A"}),i.jsx("option",{value:"A1",children:"Class A1"}),i.jsx("option",{value:"B",children:"Class B"}),i.jsx("option",{value:"C",children:"Class C"}),i.jsx("option",{value:"D",children:"Class D"}),i.jsx("option",{value:"E",children:"Class E"})]})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Additional Information"}),i.jsxs("div",{className:`form-group ${u.includes("identityNumber")?"field-missing-group":""}`,children:[i.jsxs("label",{htmlFor:"identityNumber",children:["Identity Number (CCCD) *",u.includes("identityNumber")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:t.identityNumber,onChange:j,placeholder:"123456789012",className:u.includes("identityNumber")?"field-missing":"",required:!0})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e(-1),disabled:s,children:" Go Back"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?" Saving...":" Save Profile"})]})]})]})]})}const Nd={getAllStations:async(e=1,t=100)=>{var n;try{console.log(" Fetching stations from:",`${wl}/Stations/Get-All`);const s=await de.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Stations response:",s.data);const a=s.data;return Array.isArray(a)?(console.log(" Returning stations array:",a.length,"items"),a):a.data&&a.data.data&&Array.isArray(a.data.data)?(console.log(" Returning stations from data.data.data:",a.data.data.length,"items"),a.data.data):a.data&&a.data.items&&Array.isArray(a.data.items)?(console.log(" Returning stations from data.data.items:",a.data.items.length,"items"),a.data.items):a.data&&Array.isArray(a.data)?(console.log(" Returning stations from data.data:",a.data.length,"items"),a.data):a.items&&Array.isArray(a.items)?(console.log(" Returning stations from data.items:",a.items.length,"items"),a.items):(console.warn(" No stations found in response"),[])}catch(s){return console.error(" Error fetching stations:",((n=s.response)==null?void 0:n.data)||s.message),[]}}},ot={getAllCars:async(e=1,t=100)=>{var n;try{console.log(" Fetching cars from:",`${wl}/Cars/Get-All`);const s=await de.get("/Cars/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Cars response:",s.data);const a=s.data;return Array.isArray(a)?(console.log(" Returning cars array:",a.length,"items"),a):a.data&&a.data.data&&Array.isArray(a.data.data)?(console.log(" Returning cars from data.data.data:",a.data.data.length,"items"),a.data.data):a.data&&a.data.items&&Array.isArray(a.data.items)?(console.log(" Returning cars from data.data.items:",a.data.items.length,"items"),a.data.items):a.data&&Array.isArray(a.data)?(console.log(" Returning cars from data.data:",a.data.length,"items"),a.data):a.items&&Array.isArray(a.items)?(console.log(" Returning cars from data.items:",a.items.length,"items"),a.items):(console.warn(" No cars found in response"),[])}catch(s){return console.error(" Error fetching cars:",((n=s.response)==null?void 0:n.data)||s.message),[]}},getCarById:async e=>{var t;try{console.log(" Fetching car details for ID:",e);const n=await de.get(`/Cars/Get-By-${encodeURIComponent(e)}`);console.log(" Car detail response:",n.data);const s=n.data;return s.id||s.Id?(console.log(" Returning car object directly"),s):s.data&&s.data.data&&(s.data.data.id||s.data.data.Id)?(console.log(" Returning car from data.data.data"),s.data.data):s.data&&(s.data.id||s.data.Id)?(console.log(" Returning car from data.data"),s.data):(console.warn(" No car found in response"),null)}catch(n){throw console.error(" Error fetching car details:",((t=n.response)==null?void 0:t.data)||n.message),n}},getAvailableCarsByStation:async e=>{var t;try{console.log(" Fetching available cars for station:",e);const n=await de.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`);console.log(" Available cars response:",n.data);const s=n.data;return Array.isArray(s)?(console.log(" Returning available cars array:",s.length,"items"),s):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning available cars from data.data.data:",s.data.data.length,"items"),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning available cars from data.data.items:",s.data.items.length,"items"),s.data.items):s.data&&Array.isArray(s.data)?(console.log(" Returning available cars from data.data:",s.data.length,"items"),s.data):s.items&&Array.isArray(s.items)?(console.log(" Returning available cars from data.items:",s.items.length,"items"),s.items):(console.warn(" No available cars found in response"),[])}catch(n){throw console.error(" Error fetching available cars:",((t=n.response)==null?void 0:t.data)||n.message),n}},createCar:async e=>{var t,n;try{if(e instanceof FormData){const s=await de.post("/Cars/Create",e,{headers:{"Content-Type":void 0}});return((t=s.data)==null?void 0:t.data)||s.data}else{const s=await de.post("/Cars/Create",e);return((n=s.data)==null?void 0:n.data)||s.data}}catch(s){throw console.error("Error creating car:",s),s}},deleteCar:async e=>{var t;try{const n=await de.delete(`/Cars/Delete-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error deleting car:",n),n}},updateCar:async(e,t)=>{var n;try{const s=await de.put(`/Cars/Update-By-${encodeURIComponent(e)}`,t);return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car:",s),s}},updateStatus:async(e,t)=>{var n;try{const s=await de.patch(`/Cars/${encodeURIComponent(e)}/status`,{status:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car status:",s),s}},updateBatteryLevel:async(e,t)=>{var n;try{const s=await de.patch(`/Cars/${encodeURIComponent(e)}/battery`,{batteryLevel:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating battery level:",s),s}},updateCarDescription:async(e,t)=>{var n;try{const s=await de.patch(`/Cars/${encodeURIComponent(e)}/description`,{description:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car description:",s),s}}},oj=24e3;function At(e,t={convertFromUSD:!1}){const{convertFromUSD:n}=t||{},s=Number(e)||0,a=Math.round(n?s*oj:s);return new Intl.NumberFormat("vi-VN").format(a)+" "}const ey=y.createContext(null);function lj({children:e}){const[t,n]=y.useState([]),s=y.useCallback((l,c="info",u=3500,f=null)=>{const p=Date.now()+Math.random();let g=null;try{if(f&&typeof f.getBoundingClientRect=="function"){const x=f.getBoundingClientRect(),j=Math.round(x.top+x.height+8),k=Math.round(x.left+x.width/2);g={top:j,left:k}}}catch{g=null}n(x=>[...x,{id:p,message:l,type:c,pos:g}]),setTimeout(()=>{n(x=>x.filter(j=>j.id!==p))},u)},[]),a=y.useCallback(l=>{n(c=>c.filter(u=>u.id!==l))},[]);return i.jsxs(ey.Provider,{value:{showToast:s},children:[e,i.jsx("div",{className:"toast-viewport","aria-live":"polite",children:t.filter(l=>!l.pos).map(l=>i.jsxs("div",{className:`toast ${l.type}`,onClick:()=>a(l.id),children:[i.jsx("div",{className:"toast-message",children:l.message}),i.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},l.id))}),t.filter(l=>l.pos).map(l=>i.jsxs("div",{className:`toast ${l.type} anchored`,style:{position:"fixed",top:`${l.pos.top}px`,left:`${l.pos.left}px`,transform:"translateX(-50%)"},onClick:()=>a(l.id),children:[i.jsx("div",{className:"toast-message",children:l.message}),i.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},l.id))]})}function Cu(){const e=y.useContext(ey);if(!e)throw new Error("useToast must be used within ToastProvider");return e}function ty(e,t){const n=y.useRef(t);y.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const cj=1;function dj(e){return Object.freeze({__version:cj,map:e})}function uj(e,t){return Object.freeze({...e,...t})}const ny=y.createContext(null),ry=ny.Provider;function ku(){const e=y.useContext(ny);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function fj(e){function t(n,s){const{instance:a,context:l}=e(n).current;return y.useImperativeHandle(s,()=>a),n.children==null?null:Kn.createElement(ry,{value:l},n.children)}return y.forwardRef(t)}function hj(e){function t(n,s){const[a,l]=y.useState(!1),{instance:c}=e(n,l).current;y.useImperativeHandle(s,()=>c),y.useEffect(function(){a&&c.update()},[c,a,n.children]);const u=c._contentNode;return u?yg.createPortal(n.children,u):null}return y.forwardRef(t)}function pj(e){function t(n,s){const{instance:a}=e(n).current;return y.useImperativeHandle(s,()=>a),null}return y.forwardRef(t)}function iy(e,t){const n=y.useRef();y.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function Pu(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function mj(e,t){return function(s,a){const l=ku(),c=e(Pu(s,l),l);return ty(l.map,s.attribution),iy(c.current,s.eventHandlers),t(c.current,l,s,a),c}}var Cd={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,s){s(t)})(iv,function(n){var s="1.9.4";function a(r){var o,d,h,m;for(d=1,h=arguments.length;d<h;d++){m=arguments[d];for(o in m)r[o]=m[o]}return r}var l=Object.create||function(){function r(){}return function(o){return r.prototype=o,new r}}();function c(r,o){var d=Array.prototype.slice;if(r.bind)return r.bind.apply(r,d.call(arguments,1));var h=d.call(arguments,2);return function(){return r.apply(o,h.length?h.concat(d.call(arguments)):arguments)}}var u=0;function f(r){return"_leaflet_id"in r||(r._leaflet_id=++u),r._leaflet_id}function p(r,o,d){var h,m,N,A;return A=function(){h=!1,m&&(N.apply(d,m),m=!1)},N=function(){h?m=arguments:(r.apply(d,arguments),setTimeout(A,o),h=!0)},N}function g(r,o,d){var h=o[1],m=o[0],N=h-m;return r===h&&d?r:((r-m)%N+N)%N+m}function x(){return!1}function j(r,o){if(o===!1)return r;var d=Math.pow(10,o===void 0?6:o);return Math.round(r*d)/d}function k(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function C(r){return k(r).split(/\s+/)}function S(r,o){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?l(r.options):{});for(var d in o)r.options[d]=o[d];return r.options}function P(r,o,d){var h=[];for(var m in r)h.push(encodeURIComponent(d?m.toUpperCase():m)+"="+encodeURIComponent(r[m]));return(!o||o.indexOf("?")===-1?"?":"&")+h.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function v(r,o){return r.replace(_,function(d,h){var m=o[h];if(m===void 0)throw new Error("No value provided for variable "+d);return typeof m=="function"&&(m=m(o)),m})}var w=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function b(r,o){for(var d=0;d<r.length;d++)if(r[d]===o)return d;return-1}var B="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var F=0;function R(r){var o=+new Date,d=Math.max(0,16-(o-F));return F=o+d,window.setTimeout(r,d)}var O=window.requestAnimationFrame||T("RequestAnimationFrame")||R,I=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function D(r,o,d){if(d&&O===R)r.call(o);else return O.call(window,c(r,o))}function q(r){r&&I.call(window,r)}var te={__proto__:null,extend:a,create:l,bind:c,get lastId(){return u},stamp:f,throttle:p,wrapNum:g,falseFn:x,formatNum:j,trim:k,splitWords:C,setOptions:S,getParamString:P,template:v,isArray:w,indexOf:b,emptyImageUrl:B,requestFn:O,cancelFn:I,requestAnimFrame:D,cancelAnimFrame:q};function G(){}G.extend=function(r){var o=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=o.__super__=this.prototype,h=l(d);h.constructor=o,o.prototype=h;for(var m in this)Object.prototype.hasOwnProperty.call(this,m)&&m!=="prototype"&&m!=="__super__"&&(o[m]=this[m]);return r.statics&&a(o,r.statics),r.includes&&(E(r.includes),a.apply(null,[h].concat(r.includes))),a(h,r),delete h.statics,delete h.includes,h.options&&(h.options=d.options?l(d.options):{},a(h.options,r.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,A=h._initHooks.length;N<A;N++)h._initHooks[N].call(this)}},o},G.include=function(r){var o=this.prototype.options;return a(this.prototype,r),r.options&&(this.prototype.options=o,this.mergeOptions(r.options)),this},G.mergeOptions=function(r){return a(this.prototype.options,r),this},G.addInitHook=function(r){var o=Array.prototype.slice.call(arguments,1),d=typeof r=="function"?r:function(){this[r].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function E(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=w(r)?r:[r];for(var o=0;o<r.length;o++)r[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var oe={on:function(r,o,d){if(typeof r=="object")for(var h in r)this._on(h,r[h],o);else{r=C(r);for(var m=0,N=r.length;m<N;m++)this._on(r[m],o,d)}return this},off:function(r,o,d){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var h in r)this._off(h,r[h],o);else{r=C(r);for(var m=arguments.length===1,N=0,A=r.length;N<A;N++)m?this._off(r[N]):this._off(r[N],o,d)}return this},_on:function(r,o,d,h){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(r,o,d)===!1){d===this&&(d=void 0);var m={fn:o,ctx:d};h&&(m.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(m)}},_off:function(r,o,d){var h,m,N;if(this._events&&(h=this._events[r],!!h)){if(arguments.length===1){if(this._firingCount)for(m=0,N=h.length;m<N;m++)h[m].fn=x;delete this._events[r];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var A=this._listens(r,o,d);if(A!==!1){var H=h[A];this._firingCount&&(H.fn=x,this._events[r]=h=h.slice()),h.splice(A,1)}}},fire:function(r,o,d){if(!this.listens(r,d))return this;var h=a({},o,{type:r,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var m=this._events[r];if(m){this._firingCount=this._firingCount+1||1;for(var N=0,A=m.length;N<A;N++){var H=m[N],Y=H.fn;H.once&&this.off(r,Y,H.ctx),Y.call(H.ctx||this,h)}this._firingCount--}}return d&&this._propagateEvent(h),this},listens:function(r,o,d,h){typeof r!="string"&&console.warn('"string" type argument expected');var m=o;typeof o!="function"&&(h=!!o,m=void 0,d=void 0);var N=this._events&&this._events[r];if(N&&N.length&&this._listens(r,m,d)!==!1)return!0;if(h){for(var A in this._eventParents)if(this._eventParents[A].listens(r,o,d,h))return!0}return!1},_listens:function(r,o,d){if(!this._events)return!1;var h=this._events[r]||[];if(!o)return!!h.length;d===this&&(d=void 0);for(var m=0,N=h.length;m<N;m++)if(h[m].fn===o&&h[m].ctx===d)return m;return!1},once:function(r,o,d){if(typeof r=="object")for(var h in r)this._on(h,r[h],o,!0);else{r=C(r);for(var m=0,N=r.length;m<N;m++)this._on(r[m],o,d,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[f(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[f(r)],this},_propagateEvent:function(r){for(var o in this._eventParents)this._eventParents[o].fire(r.type,a({layer:r.target,propagatedFrom:r.target},r),!0)}};oe.addEventListener=oe.on,oe.removeEventListener=oe.clearAllEventListeners=oe.off,oe.addOneTimeEventListener=oe.once,oe.fireEvent=oe.fire,oe.hasEventListeners=oe.listens;var Ne=G.extend(oe);function W(r,o,d){this.x=d?Math.round(r):r,this.y=d?Math.round(o):o}var fe=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(r){return this.clone()._add(re(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(re(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new W(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new W(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=fe(this.x),this.y=fe(this.y),this},distanceTo:function(r){r=re(r);var o=r.x-this.x,d=r.y-this.y;return Math.sqrt(o*o+d*d)},equals:function(r){return r=re(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=re(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+j(this.x)+", "+j(this.y)+")"}};function re(r,o,d){return r instanceof W?r:w(r)?new W(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new W(r.x,r.y):new W(r,o,d)}function U(r,o){if(r)for(var d=o?[r,o]:r,h=0,m=d.length;h<m;h++)this.extend(d[h])}U.prototype={extend:function(r){var o,d;if(!r)return this;if(r instanceof W||typeof r[0]=="number"||"x"in r)o=d=re(r);else if(r=ie(r),o=r.min,d=r.max,!o||!d)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=d.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(r){return re((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return re(this.min.x,this.max.y)},getTopRight:function(){return re(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var o,d;return typeof r[0]=="number"||r instanceof W?r=re(r):r=ie(r),r instanceof U?(o=r.min,d=r.max):o=d=r,o.x>=this.min.x&&d.x<=this.max.x&&o.y>=this.min.y&&d.y<=this.max.y},intersects:function(r){r=ie(r);var o=this.min,d=this.max,h=r.min,m=r.max,N=m.x>=o.x&&h.x<=d.x,A=m.y>=o.y&&h.y<=d.y;return N&&A},overlaps:function(r){r=ie(r);var o=this.min,d=this.max,h=r.min,m=r.max,N=m.x>o.x&&h.x<d.x,A=m.y>o.y&&h.y<d.y;return N&&A},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var o=this.min,d=this.max,h=Math.abs(o.x-d.x)*r,m=Math.abs(o.y-d.y)*r;return ie(re(o.x-h,o.y-m),re(d.x+h,d.y+m))},equals:function(r){return r?(r=ie(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function ie(r,o){return!r||r instanceof U?r:new U(r,o)}function Z(r,o){if(r)for(var d=o?[r,o]:r,h=0,m=d.length;h<m;h++)this.extend(d[h])}Z.prototype={extend:function(r){var o=this._southWest,d=this._northEast,h,m;if(r instanceof ne)h=r,m=r;else if(r instanceof Z){if(h=r._southWest,m=r._northEast,!h||!m)return this}else return r?this.extend(ce(r)||se(r)):this;return!o&&!d?(this._southWest=new ne(h.lat,h.lng),this._northEast=new ne(m.lat,m.lng)):(o.lat=Math.min(h.lat,o.lat),o.lng=Math.min(h.lng,o.lng),d.lat=Math.max(m.lat,d.lat),d.lng=Math.max(m.lng,d.lng)),this},pad:function(r){var o=this._southWest,d=this._northEast,h=Math.abs(o.lat-d.lat)*r,m=Math.abs(o.lng-d.lng)*r;return new Z(new ne(o.lat-h,o.lng-m),new ne(d.lat+h,d.lng+m))},getCenter:function(){return new ne((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ne(this.getNorth(),this.getWest())},getSouthEast:function(){return new ne(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof ne||"lat"in r?r=ce(r):r=se(r);var o=this._southWest,d=this._northEast,h,m;return r instanceof Z?(h=r.getSouthWest(),m=r.getNorthEast()):h=m=r,h.lat>=o.lat&&m.lat<=d.lat&&h.lng>=o.lng&&m.lng<=d.lng},intersects:function(r){r=se(r);var o=this._southWest,d=this._northEast,h=r.getSouthWest(),m=r.getNorthEast(),N=m.lat>=o.lat&&h.lat<=d.lat,A=m.lng>=o.lng&&h.lng<=d.lng;return N&&A},overlaps:function(r){r=se(r);var o=this._southWest,d=this._northEast,h=r.getSouthWest(),m=r.getNorthEast(),N=m.lat>o.lat&&h.lat<d.lat,A=m.lng>o.lng&&h.lng<d.lng;return N&&A},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,o){return r?(r=se(r),this._southWest.equals(r.getSouthWest(),o)&&this._northEast.equals(r.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(r,o){return r instanceof Z?r:new Z(r,o)}function ne(r,o,d){if(isNaN(r)||isNaN(o))throw new Error("Invalid LatLng object: ("+r+", "+o+")");this.lat=+r,this.lng=+o,d!==void 0&&(this.alt=+d)}ne.prototype={equals:function(r,o){if(!r)return!1;r=ce(r);var d=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return d<=(o===void 0?1e-9:o)},toString:function(r){return"LatLng("+j(this.lat,r)+", "+j(this.lng,r)+")"},distanceTo:function(r){return we.distance(this,ce(r))},wrap:function(){return we.wrapLatLng(this)},toBounds:function(r){var o=180*r/40075017,d=o/Math.cos(Math.PI/180*this.lat);return se([this.lat-o,this.lng-d],[this.lat+o,this.lng+d])},clone:function(){return new ne(this.lat,this.lng,this.alt)}};function ce(r,o,d){return r instanceof ne?r:w(r)&&typeof r[0]!="object"?r.length===3?new ne(r[0],r[1],r[2]):r.length===2?new ne(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new ne(r.lat,"lng"in r?r.lng:r.lon,r.alt):o===void 0?null:new ne(r,o,d)}var ke={latLngToPoint:function(r,o){var d=this.projection.project(r),h=this.scale(o);return this.transformation._transform(d,h)},pointToLatLng:function(r,o){var d=this.scale(o),h=this.transformation.untransform(r,d);return this.projection.unproject(h)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var o=this.projection.bounds,d=this.scale(r),h=this.transformation.transform(o.min,d),m=this.transformation.transform(o.max,d);return new U(h,m)},infinite:!1,wrapLatLng:function(r){var o=this.wrapLng?g(r.lng,this.wrapLng,!0):r.lng,d=this.wrapLat?g(r.lat,this.wrapLat,!0):r.lat,h=r.alt;return new ne(d,o,h)},wrapLatLngBounds:function(r){var o=r.getCenter(),d=this.wrapLatLng(o),h=o.lat-d.lat,m=o.lng-d.lng;if(h===0&&m===0)return r;var N=r.getSouthWest(),A=r.getNorthEast(),H=new ne(N.lat-h,N.lng-m),Y=new ne(A.lat-h,A.lng-m);return new Z(H,Y)}},we=a({},ke,{wrapLng:[-180,180],R:6371e3,distance:function(r,o){var d=Math.PI/180,h=r.lat*d,m=o.lat*d,N=Math.sin((o.lat-r.lat)*d/2),A=Math.sin((o.lng-r.lng)*d/2),H=N*N+Math.cos(h)*Math.cos(m)*A*A,Y=2*Math.atan2(Math.sqrt(H),Math.sqrt(1-H));return this.R*Y}}),he=6378137,Ve={R:he,MAX_LATITUDE:85.0511287798,project:function(r){var o=Math.PI/180,d=this.MAX_LATITUDE,h=Math.max(Math.min(d,r.lat),-d),m=Math.sin(h*o);return new W(this.R*r.lng*o,this.R*Math.log((1+m)/(1-m))/2)},unproject:function(r){var o=180/Math.PI;return new ne((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*o,r.x*o/this.R)},bounds:function(){var r=he*Math.PI;return new U([-r,-r],[r,r])}()};function ht(r,o,d,h){if(w(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=o,this._c=d,this._d=h}ht.prototype={transform:function(r,o){return this._transform(r.clone(),o)},_transform:function(r,o){return o=o||1,r.x=o*(this._a*r.x+this._b),r.y=o*(this._c*r.y+this._d),r},untransform:function(r,o){return o=o||1,new W((r.x/o-this._b)/this._a,(r.y/o-this._d)/this._c)}};function qe(r,o,d,h){return new ht(r,o,d,h)}var Ct=a({},we,{code:"EPSG:3857",projection:Ve,transformation:function(){var r=.5/(Math.PI*Ve.R);return qe(r,.5,-r,.5)}()}),ge=a({},Ct,{code:"EPSG:900913"});function ae(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function ye(r,o){var d="",h,m,N,A,H,Y;for(h=0,N=r.length;h<N;h++){for(H=r[h],m=0,A=H.length;m<A;m++)Y=H[m],d+=(m?"L":"M")+Y.x+" "+Y.y;d+=o?Pe.svg?"z":"x":""}return d||"M0 0"}var ue=document.documentElement.style,xe="ActiveXObject"in window,Ie=xe&&!document.addEventListener,Ut="msLaunchUri"in navigator&&!("documentMode"in document),jn=Lt("webkit"),Se=Lt("android"),z=Lt("android 2")||Lt("android 3"),X=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ee=Se&&Lt("Google")&&X<537&&!("AudioNode"in window),Q=!!window.opera,M=!Ut&&Lt("chrome"),J=Lt("gecko")&&!jn&&!Q&&!xe,Ue=!M&&Lt("safari"),ve=Lt("phantom"),We="OTransition"in ue,je=navigator.platform.indexOf("Win")===0,$=xe&&"transition"in ue,Le="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!z,Be="MozPerspective"in ue,me=!window.L_DISABLE_3D&&($||Le||Be)&&!We&&!ve,V=typeof orientation<"u"||Lt("mobile"),ze=V&&jn,Ye=V&&Le,be=!window.PointerEvent&&window.MSPointerEvent,tt=!!(window.PointerEvent||be),Vt="ontouchstart"in window||!!window.TouchEvent,dn=!window.L_NO_TOUCH&&(Vt||tt),mr=V&&Q,gr=V&&J,Mt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,mt=function(){var r=!1;try{var o=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",x,o),window.removeEventListener("testPassiveEventSupport",x,o)}catch{}return r}(),gt=function(){return!!document.createElement("canvas").getContext}(),tn=!!(document.createElementNS&&ae("svg").createSVGRect),Ei=!!tn&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Ti=!tn&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var o=r.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),Bi=navigator.platform.indexOf("Mac")===0,Qr=navigator.platform.indexOf("Linux")===0;function Lt(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var Pe={ie:xe,ielt9:Ie,edge:Ut,webkit:jn,android:Se,android23:z,androidStock:ee,opera:Q,chrome:M,gecko:J,safari:Ue,phantom:ve,opera12:We,win:je,ie3d:$,webkit3d:Le,gecko3d:Be,any3d:me,mobile:V,mobileWebkit:ze,mobileWebkit3d:Ye,msPointer:be,pointer:tt,touch:dn,touchNative:Vt,mobileOpera:mr,mobileGecko:gr,retina:Mt,passiveEvents:mt,canvas:gt,svg:tn,vml:Ti,inlineSvg:Ei,mac:Bi,linux:Qr},yr=Pe.msPointer?"MSPointerDown":"pointerdown",vr=Pe.msPointer?"MSPointerMove":"pointermove",xr=Pe.msPointer?"MSPointerUp":"pointerup",_r=Pe.msPointer?"MSPointerCancel":"pointercancel",Qn={touchstart:yr,touchmove:vr,touchend:xr,touchcancel:_r},wr={touchstart:ri,touchmove:Un,touchend:Un,touchcancel:Un},un={},jr=!1;function Jr(r,o,d){return o==="touchstart"&&ni(),wr[o]?(d=wr[o].bind(this,d),r.addEventListener(Qn[o],d,!1),d):(console.warn("wrong event specified:",o),x)}function Xr(r,o,d){if(!Qn[o]){console.warn("wrong event specified:",o);return}r.removeEventListener(Qn[o],d,!1)}function ei(r){un[r.pointerId]=r}function ti(r){un[r.pointerId]&&(un[r.pointerId]=r)}function Sr(r){delete un[r.pointerId]}function ni(){jr||(document.addEventListener(yr,ei,!0),document.addEventListener(vr,ti,!0),document.addEventListener(xr,Sr,!0),document.addEventListener(_r,Sr,!0),jr=!0)}function Un(r,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var d in un)o.touches.push(un[d]);o.changedTouches=[o],r(o)}}function ri(r,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&kt(o),Un(r,o)}function ii(r){var o={},d,h;for(h in r)d=r[h],o[h]=d&&d.bind?d.bind(r):d;return r=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var si=200;function ai(r,o){r.addEventListener("dblclick",o);var d=0,h;function m(N){if(N.detail!==1){h=N.detail;return}if(!(N.pointerType==="mouse"||N.sourceCapabilities&&!N.sourceCapabilities.firesTouchEvents)){var A=Ru(N);if(!(A.some(function(Y){return Y instanceof HTMLLabelElement&&Y.attributes.for})&&!A.some(function(Y){return Y instanceof HTMLInputElement||Y instanceof HTMLSelectElement}))){var H=Date.now();H-d<=si?(h++,h===2&&o(ii(N))):h=1,d=H}}}return r.addEventListener("click",m),{dblclick:o,simDblclick:m}}function oi(r,o){r.removeEventListener("dblclick",o.dblclick),r.removeEventListener("click",o.simDblclick)}var Jn=li(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Sn=li(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Nr=Sn==="webkitTransition"||Sn==="OTransition"?Sn+"End":"transitionend";function Cr(r){return typeof r=="string"?document.getElementById(r):r}function Nn(r,o){var d=r.style[o]||r.currentStyle&&r.currentStyle[o];if((!d||d==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(r,null);d=h?h[o]:null}return d==="auto"?null:d}function Me(r,o,d){var h=document.createElement(r);return h.className=o||"",d&&d.appendChild(h),h}function Ke(r){var o=r.parentNode;o&&o.removeChild(r)}function Mn(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function fn(r){var o=r.parentNode;o&&o.lastChild!==r&&o.appendChild(r)}function hn(r){var o=r.parentNode;o&&o.firstChild!==r&&o.insertBefore(r,o.firstChild)}function Xn(r,o){if(r.classList!==void 0)return r.classList.contains(o);var d=Cn(r);return d.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(d)}function Te(r,o){if(r.classList!==void 0)for(var d=C(o),h=0,m=d.length;h<m;h++)r.classList.add(d[h]);else if(!Xn(r,o)){var N=Cn(r);Ge(r,(N?N+" ":"")+o)}}function Je(r,o){r.classList!==void 0?r.classList.remove(o):Ge(r,k((" "+Cn(r)+" ").replace(" "+o+" "," ")))}function Ge(r,o){r.className.baseVal===void 0?r.className=o:r.className.baseVal=o}function Cn(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Ot(r,o){"opacity"in r.style?r.style.opacity=o:"filter"in r.style&&Ia(r,o)}function Ia(r,o){var d=!1,h="DXImageTransform.Microsoft.Alpha";try{d=r.filters.item(h)}catch{if(o===1)return}o=Math.round(o*100),d?(d.Enabled=o!==100,d.Opacity=o):r.style.filter+=" progid:"+h+"(opacity="+o+")"}function li(r){for(var o=document.documentElement.style,d=0;d<r.length;d++)if(r[d]in o)return r[d];return!1}function On(r,o,d){var h=o||new W(0,0);r.style[Jn]=(Pe.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(d?" scale("+d+")":"")}function at(r,o){r._leaflet_pos=o,Pe.any3d?On(r,o):(r.style.left=o.x+"px",r.style.top=o.y+"px")}function nt(r){return r._leaflet_pos||new W(0,0)}var xs,_s,Nl;if("onselectstart"in document)xs=function(){Ae(window,"selectstart",kt)},_s=function(){Xe(window,"selectstart",kt)};else{var ws=li(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);xs=function(){if(ws){var r=document.documentElement.style;Nl=r[ws],r[ws]="none"}},_s=function(){ws&&(document.documentElement.style[ws]=Nl,Nl=void 0)}}function Cl(){Ae(window,"dragstart",kt)}function kl(){Xe(window,"dragstart",kt)}var La,Pl;function bl(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(Ea(),La=r,Pl=r.style.outlineStyle,r.style.outlineStyle="none",Ae(window,"keydown",Ea))}function Ea(){La&&(La.style.outlineStyle=Pl,La=void 0,Pl=void 0,Xe(window,"keydown",Ea))}function Tu(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function Il(r){var o=r.getBoundingClientRect();return{x:o.width/r.offsetWidth||1,y:o.height/r.offsetHeight||1,boundingClientRect:o}}var cy={__proto__:null,TRANSFORM:Jn,TRANSITION:Sn,TRANSITION_END:Nr,get:Cr,getStyle:Nn,create:Me,remove:Ke,empty:Mn,toFront:fn,toBack:hn,hasClass:Xn,addClass:Te,removeClass:Je,setClass:Ge,getClass:Cn,setOpacity:Ot,testProp:li,setTransform:On,setPosition:at,getPosition:nt,get disableTextSelection(){return xs},get enableTextSelection(){return _s},disableImageDrag:Cl,enableImageDrag:kl,preventOutline:bl,restoreOutline:Ea,getSizedParentNode:Tu,getScale:Il};function Ae(r,o,d,h){if(o&&typeof o=="object")for(var m in o)El(r,m,o[m],d);else{o=C(o);for(var N=0,A=o.length;N<A;N++)El(r,o[N],d,h)}return this}var Dn="_leaflet_events";function Xe(r,o,d,h){if(arguments.length===1)Bu(r),delete r[Dn];else if(o&&typeof o=="object")for(var m in o)Tl(r,m,o[m],d);else if(o=C(o),arguments.length===2)Bu(r,function(H){return b(o,H)!==-1});else for(var N=0,A=o.length;N<A;N++)Tl(r,o[N],d,h);return this}function Bu(r,o){for(var d in r[Dn]){var h=d.split(/\d/)[0];(!o||o(h))&&Tl(r,h,null,null,d)}}var Ll={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function El(r,o,d,h){var m=o+f(d)+(h?"_"+f(h):"");if(r[Dn]&&r[Dn][m])return this;var N=function(H){return d.call(h||r,H||window.event)},A=N;!Pe.touchNative&&Pe.pointer&&o.indexOf("touch")===0?N=Jr(r,o,N):Pe.touch&&o==="dblclick"?N=ai(r,N):"addEventListener"in r?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?r.addEventListener(Ll[o]||o,N,Pe.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(N=function(H){H=H||window.event,Rl(r,H)&&A(H)},r.addEventListener(Ll[o],N,!1)):r.addEventListener(o,A,!1):r.attachEvent("on"+o,N),r[Dn]=r[Dn]||{},r[Dn][m]=N}function Tl(r,o,d,h,m){m=m||o+f(d)+(h?"_"+f(h):"");var N=r[Dn]&&r[Dn][m];if(!N)return this;!Pe.touchNative&&Pe.pointer&&o.indexOf("touch")===0?Xr(r,o,N):Pe.touch&&o==="dblclick"?oi(r,N):"removeEventListener"in r?r.removeEventListener(Ll[o]||o,N,!1):r.detachEvent("on"+o,N),r[Dn][m]=null}function ci(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function Bl(r){return El(r,"wheel",ci),this}function js(r){return Ae(r,"mousedown touchstart dblclick contextmenu",ci),r._leaflet_disable_click=!0,this}function kt(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function di(r){return kt(r),ci(r),this}function Ru(r){if(r.composedPath)return r.composedPath();for(var o=[],d=r.target;d;)o.push(d),d=d.parentNode;return o}function Au(r,o){if(!o)return new W(r.clientX,r.clientY);var d=Il(o),h=d.boundingClientRect;return new W((r.clientX-h.left)/d.x-o.clientLeft,(r.clientY-h.top)/d.y-o.clientTop)}var dy=Pe.linux&&Pe.chrome?window.devicePixelRatio:Pe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Fu(r){return Pe.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/dy:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function Rl(r,o){var d=o.relatedTarget;if(!d)return!0;try{for(;d&&d!==r;)d=d.parentNode}catch{return!1}return d!==r}var uy={__proto__:null,on:Ae,off:Xe,stopPropagation:ci,disableScrollPropagation:Bl,disableClickPropagation:js,preventDefault:kt,stop:di,getPropagationPath:Ru,getMousePosition:Au,getWheelDelta:Fu,isExternalTarget:Rl,addListener:Ae,removeListener:Xe},Uu=Ne.extend({run:function(r,o,d,h){this.stop(),this._el=r,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=nt(r),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=D(this._animate,this),this._step()},_step:function(r){var o=+new Date-this._startTime,d=this._duration*1e3;o<d?this._runFrame(this._easeOut(o/d),r):(this._runFrame(1),this._complete())},_runFrame:function(r,o){var d=this._startPos.add(this._offset.multiplyBy(r));o&&d._round(),at(this._el,d),this.fire("step")},_complete:function(){q(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),He=Ne.extend({options:{crs:Ct,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,o){o=S(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(ce(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Sn&&Pe.any3d&&!Pe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ae(this._proxy,Nr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,o,d){if(o=o===void 0?this._zoom:this._limitZoom(o),r=this._limitCenter(ce(r),o,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=a({animate:d.animate},d.zoom),d.pan=a({animate:d.animate,duration:d.duration},d.pan));var h=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,o,d.zoom):this._tryAnimatedPan(r,d.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(r,o,d.pan&&d.pan.noMoveStart),this},setZoom:function(r,o){return this._loaded?this.setView(this.getCenter(),r,{zoom:o}):(this._zoom=r,this)},zoomIn:function(r,o){return r=r||(Pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,o)},zoomOut:function(r,o){return r=r||(Pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,o)},setZoomAround:function(r,o,d){var h=this.getZoomScale(o),m=this.getSize().divideBy(2),N=r instanceof W?r:this.latLngToContainerPoint(r),A=N.subtract(m).multiplyBy(1-1/h),H=this.containerPointToLatLng(m.add(A));return this.setView(H,o,{zoom:d})},_getBoundsCenterZoom:function(r,o){o=o||{},r=r.getBounds?r.getBounds():se(r);var d=re(o.paddingTopLeft||o.padding||[0,0]),h=re(o.paddingBottomRight||o.padding||[0,0]),m=this.getBoundsZoom(r,!1,d.add(h));if(m=typeof o.maxZoom=="number"?Math.min(o.maxZoom,m):m,m===1/0)return{center:r.getCenter(),zoom:m};var N=h.subtract(d).divideBy(2),A=this.project(r.getSouthWest(),m),H=this.project(r.getNorthEast(),m),Y=this.unproject(A.add(H).divideBy(2).add(N),m);return{center:Y,zoom:m}},fitBounds:function(r,o){if(r=se(r),!r.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(r,o);return this.setView(d.center,d.zoom,o)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,o){return this.setView(r,this._zoom,{pan:o})},panBy:function(r,o){if(r=re(r).round(),o=o||{},!r.x&&!r.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Uu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){Te(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,d,o.duration||.25,o.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,o,d){if(d=d||{},d.animate===!1||!Pe.any3d)return this.setView(r,o,d);this._stop();var h=this.project(this.getCenter()),m=this.project(r),N=this.getSize(),A=this._zoom;r=ce(r),o=o===void 0?A:o;var H=Math.max(N.x,N.y),Y=H*this.getZoomScale(A,o),le=m.distanceTo(h)||1,_e=1.42,Ee=_e*_e;function Oe(yt){var Wa=yt?-1:1,Xy=yt?Y:H,ev=Y*Y-H*H+Wa*Ee*Ee*le*le,tv=2*Xy*Ee*le,Zl=ev/tv,vf=Math.sqrt(Zl*Zl+1)-Zl,nv=vf<1e-9?-18:Math.log(vf);return nv}function Dt(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function jt(yt){return(Math.exp(yt)+Math.exp(-yt))/2}function mn(yt){return Dt(yt)/jt(yt)}var qt=Oe(0);function Oi(yt){return H*(jt(qt)/jt(qt+_e*yt))}function Yy(yt){return H*(jt(qt)*mn(qt+_e*yt)-Dt(qt))/Ee}function Ky(yt){return 1-Math.pow(1-yt,1.5)}var Qy=Date.now(),gf=(Oe(1)-qt)/_e,Jy=d.duration?1e3*d.duration:1e3*gf*.8;function yf(){var yt=(Date.now()-Qy)/Jy,Wa=Ky(yt)*gf;yt<=1?(this._flyToFrame=D(yf,this),this._move(this.unproject(h.add(m.subtract(h).multiplyBy(Yy(Wa)/le)),A),this.getScaleZoom(H/Oi(Wa),A),{flyTo:!0})):this._move(r,o)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),yf.call(this),this},flyToBounds:function(r,o){var d=this._getBoundsCenterZoom(r,o);return this.flyTo(d.center,d.zoom,o)},setMaxBounds:function(r){return r=se(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var o=this.options.minZoom;return this.options.minZoom=r,this._loaded&&o!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var o=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&o!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,o){this._enforcingBounds=!0;var d=this.getCenter(),h=this._limitCenter(d,this._zoom,se(r));return d.equals(h)||this.panTo(h,o),this._enforcingBounds=!1,this},panInside:function(r,o){o=o||{};var d=re(o.paddingTopLeft||o.padding||[0,0]),h=re(o.paddingBottomRight||o.padding||[0,0]),m=this.project(this.getCenter()),N=this.project(r),A=this.getPixelBounds(),H=ie([A.min.add(d),A.max.subtract(h)]),Y=H.getSize();if(!H.contains(N)){this._enforcingBounds=!0;var le=N.subtract(H.getCenter()),_e=H.extend(N).getSize().subtract(Y);m.x+=le.x<0?-_e.x:_e.x,m.y+=le.y<0?-_e.y:_e.y,this.panTo(this.unproject(m),o),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=a({animate:!1,pan:!0},r===!0?{animate:!0}:r);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),h=o.divideBy(2).round(),m=d.divideBy(2).round(),N=h.subtract(m);return!N.x&&!N.y?this:(r.animate&&r.pan?this.panBy(N):(r.pan&&this._rawPanBy(N),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=a({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=c(this._handleGeolocationResponse,this),d=c(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,d,r):navigator.geolocation.getCurrentPosition(o,d,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var o=r.code,d=r.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var o=r.coords.latitude,d=r.coords.longitude,h=new ne(o,d),m=h.toBounds(r.coords.accuracy*2),N=this._locateOptions;if(N.setView){var A=this.getBoundsZoom(m);this.setView(h,N.maxZoom?Math.min(A,N.maxZoom):A)}var H={latlng:h,bounds:m,timestamp:r.timestamp};for(var Y in r.coords)typeof r.coords[Y]=="number"&&(H[Y]=r.coords[Y]);this.fire("locationfound",H)}},addHandler:function(r,o){if(!o)return this;var d=this[r]=new o(this);return this._handlers.push(d),this.options[r]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ke(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(q(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)Ke(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,o){var d="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),h=Me("div",d,o||this._mapPane);return r&&(this._panes[r]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),o=this.unproject(r.getBottomLeft()),d=this.unproject(r.getTopRight());return new Z(o,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,o,d){r=se(r),d=re(d||[0,0]);var h=this.getZoom()||0,m=this.getMinZoom(),N=this.getMaxZoom(),A=r.getNorthWest(),H=r.getSouthEast(),Y=this.getSize().subtract(d),le=ie(this.project(H,h),this.project(A,h)).getSize(),_e=Pe.any3d?this.options.zoomSnap:1,Ee=Y.x/le.x,Oe=Y.y/le.y,Dt=o?Math.max(Ee,Oe):Math.min(Ee,Oe);return h=this.getScaleZoom(Dt,h),_e&&(h=Math.round(h/(_e/100))*(_e/100),h=o?Math.ceil(h/_e)*_e:Math.floor(h/_e)*_e),Math.max(m,Math.min(N,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,o){var d=this._getTopLeftPoint(r,o);return new U(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,o){var d=this.options.crs;return o=o===void 0?this._zoom:o,d.scale(r)/d.scale(o)},getScaleZoom:function(r,o){var d=this.options.crs;o=o===void 0?this._zoom:o;var h=d.zoom(r*d.scale(o));return isNaN(h)?1/0:h},project:function(r,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(ce(r),o)},unproject:function(r,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(re(r),o)},layerPointToLatLng:function(r){var o=re(r).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(r){var o=this.project(ce(r))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(ce(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(se(r))},distance:function(r,o){return this.options.crs.distance(ce(r),ce(o))},containerPointToLayerPoint:function(r){return re(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return re(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var o=this.containerPointToLayerPoint(re(r));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ce(r)))},mouseEventToContainerPoint:function(r){return Au(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var o=this._container=Cr(r);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ae(o,"scroll",this._onScroll,this),this._containerId=f(o)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pe.any3d,Te(r,"leaflet-container"+(Pe.touch?" leaflet-touch":"")+(Pe.retina?" leaflet-retina":"")+(Pe.ielt9?" leaflet-oldie":"")+(Pe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=Nn(r,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),at(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Te(r.markerPane,"leaflet-zoom-hide"),Te(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,o,d){at(this._mapPane,new W(0,0));var h=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var m=this._zoom!==o;this._moveStart(m,d)._move(r,o)._moveEnd(m),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(r,o){return r&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(r,o,d,h){o===void 0&&(o=this._zoom);var m=this._zoom!==o;return this._zoom=o,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),h?d&&d.pinch&&this.fire("zoom",d):((m||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return q(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){at(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[f(this._container)]=this;var o=r?Xe:Ae;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),Pe.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){q(this._resizeRequest),this._resizeRequest=D(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,o){for(var d=[],h,m=o==="mouseout"||o==="mouseover",N=r.target||r.srcElement,A=!1;N;){if(h=this._targets[f(N)],h&&(o==="click"||o==="preclick")&&this._draggableMoved(h)){A=!0;break}if(h&&h.listens(o,!0)&&(m&&!Rl(N,r)||(d.push(h),m))||N===this._container)break;N=N.parentNode}return!d.length&&!A&&!m&&this.listens(o,!0)&&(d=[this]),d},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var o=r.target||r.srcElement;if(!(!this._loaded||o._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(o))){var d=r.type;d==="mousedown"&&bl(o),this._fireDOMEvent(r,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,o,d){if(r.type==="click"){var h=a({},r);h.type="preclick",this._fireDOMEvent(h,h.type,d)}var m=this._findEventTargets(r,o);if(d){for(var N=[],A=0;A<d.length;A++)d[A].listens(o,!0)&&N.push(d[A]);m=N.concat(m)}if(m.length){o==="contextmenu"&&kt(r);var H=m[0],Y={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var le=H.getLatLng&&(!H._radius||H._radius<=10);Y.containerPoint=le?this.latLngToContainerPoint(H.getLatLng()):this.mouseEventToContainerPoint(r),Y.layerPoint=this.containerPointToLayerPoint(Y.containerPoint),Y.latlng=le?H.getLatLng():this.layerPointToLatLng(Y.layerPoint)}for(A=0;A<m.length;A++)if(m[A].fire(o,Y,!0),Y.originalEvent._stopped||m[A].options.bubblingMouseEvents===!1&&b(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,o=this._handlers.length;r<o;r++)this._handlers[r].disable()},whenReady:function(r,o){return this._loaded?r.call(o||this,{target:this}):this.on("load",r,o),this},_getMapPanePos:function(){return nt(this._mapPane)||new W(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,o){var d=r&&o!==void 0?this._getNewPixelOrigin(r,o):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,o){var d=this.getSize()._divideBy(2);return this.project(r,o)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,o,d){var h=this._getNewPixelOrigin(d,o);return this.project(r,o)._subtract(h)},_latLngBoundsToNewLayerBounds:function(r,o,d){var h=this._getNewPixelOrigin(d,o);return ie([this.project(r.getSouthWest(),o)._subtract(h),this.project(r.getNorthWest(),o)._subtract(h),this.project(r.getSouthEast(),o)._subtract(h),this.project(r.getNorthEast(),o)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,o,d){if(!d)return r;var h=this.project(r,o),m=this.getSize().divideBy(2),N=new U(h.subtract(m),h.add(m)),A=this._getBoundsOffset(N,d,o);return Math.abs(A.x)<=1&&Math.abs(A.y)<=1?r:this.unproject(h.add(A),o)},_limitOffset:function(r,o){if(!o)return r;var d=this.getPixelBounds(),h=new U(d.min.add(r),d.max.add(r));return r.add(this._getBoundsOffset(h,o))},_getBoundsOffset:function(r,o,d){var h=ie(this.project(o.getNorthEast(),d),this.project(o.getSouthWest(),d)),m=h.min.subtract(r.min),N=h.max.subtract(r.max),A=this._rebound(m.x,-N.x),H=this._rebound(m.y,-N.y);return new W(A,H)},_rebound:function(r,o){return r+o>0?Math.round(r-o)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(o))},_limitZoom:function(r){var o=this.getMinZoom(),d=this.getMaxZoom(),h=Pe.any3d?this.options.zoomSnap:1;return h&&(r=Math.round(r/h)*h),Math.max(o,Math.min(d,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Je(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,o){var d=this._getCenterOffset(r)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,o),!0)},_createAnimProxy:function(){var r=this._proxy=Me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(o){var d=Jn,h=this._proxy.style[d];On(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),h===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ke(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),o=this.getZoom();On(this._proxy,this.project(r,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,o,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(o),m=this._getCenterOffset(r)._divideBy(1-1/h);return d.animate!==!0&&!this.getSize().contains(m)?!1:(D(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(r,o,!0)},this),!0)},_animateZoom:function(r,o,d,h){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=o,Te(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:o,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Je(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function fy(r,o){return new He(r,o)}var kn=G.extend({options:{position:"topright"},initialize:function(r){S(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var o=this._map;return o&&o.removeControl(this),this.options.position=r,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var o=this._container=this.onAdd(r),d=this.getPosition(),h=r._controlCorners[d];return Te(o,"leaflet-control"),d.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ke(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),Ss=function(r){return new kn(r)};He.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},o="leaflet-",d=this._controlContainer=Me("div",o+"control-container",this._container);function h(m,N){var A=o+m+" "+o+N;r[m+N]=Me("div",A,d)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)Ke(this._controlCorners[r]);Ke(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Mu=kn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,o,d,h){return d<h?-1:h<d?1:0}},initialize:function(r,o,d){S(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in r)this._addLayer(r[h],h);for(h in o)this._addLayer(o[h],h,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return kn.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,o){return this._addLayer(r,o),this._map?this._update():this},addOverlay:function(r,o){return this._addLayer(r,o,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var o=this._getLayer(f(r));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){Te(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Te(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Je(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Je(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",o=this._container=Me("div",r),d=this.options.collapsed;o.setAttribute("aria-haspopup",!0),js(o),Bl(o);var h=this._section=Me("section",r+"-list");d&&(this._map.on("click",this.collapse,this),Ae(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var m=this._layersLink=Me("a",r+"-toggle",o);m.href="#",m.title="Layers",m.setAttribute("role","button"),Ae(m,{keydown:function(N){N.keyCode===13&&this._expandSafely()},click:function(N){kt(N),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=Me("div",r+"-base",h),this._separator=Me("div",r+"-separator",h),this._overlaysList=Me("div",r+"-overlays",h),o.appendChild(h)},_getLayer:function(r){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&f(this._layers[o].layer)===r)return this._layers[o]},_addLayer:function(r,o,d){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:o,overlay:d}),this.options.sortLayers&&this._layers.sort(c(function(h,m){return this.options.sortFunction(h.layer,m.layer,h.name,m.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Mn(this._baseLayersList),Mn(this._overlaysList),this._layerControlInputs=[];var r,o,d,h,m=0;for(d=0;d<this._layers.length;d++)h=this._layers[d],this._addItem(h),o=o||h.overlay,r=r||!h.overlay,m+=h.overlay?0:1;return this.options.hideSingleBase&&(r=r&&m>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=o&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var o=this._getLayer(f(r.target)),d=o.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;d&&this._map.fire(d,o)},_createRadioElement:function(r,o){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(o?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=d,h.firstChild},_addItem:function(r){var o=document.createElement("label"),d=this._map.hasLayer(r.layer),h;r.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=d):h=this._createRadioElement("leaflet-base-layers_"+f(this),d),this._layerControlInputs.push(h),h.layerId=f(r.layer),Ae(h,"click",this._onInputClick,this);var m=document.createElement("span");m.innerHTML=" "+r.name;var N=document.createElement("span");o.appendChild(N),N.appendChild(h),N.appendChild(m);var A=r.overlay?this._overlaysList:this._baseLayersList;return A.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,o,d,h=[],m=[];this._handlingClick=!0;for(var N=r.length-1;N>=0;N--)o=r[N],d=this._getLayer(o.layerId).layer,o.checked?h.push(d):o.checked||m.push(d);for(N=0;N<m.length;N++)this._map.hasLayer(m[N])&&this._map.removeLayer(m[N]);for(N=0;N<h.length;N++)this._map.hasLayer(h[N])||this._map.addLayer(h[N]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,o,d,h=this._map.getZoom(),m=r.length-1;m>=0;m--)o=r[m],d=this._getLayer(o.layerId).layer,o.disabled=d.options.minZoom!==void 0&&h<d.options.minZoom||d.options.maxZoom!==void 0&&h>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Ae(r,"click",kt),this.expand();var o=this;setTimeout(function(){Xe(r,"click",kt),o._preventClick=!1})}}),hy=function(r,o,d){return new Mu(r,o,d)},Al=kn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var o="leaflet-control-zoom",d=Me("div",o+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,o+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,o+"-out",d,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,o,d,h,m){var N=Me("a",d,h);return N.innerHTML=r,N.href="#",N.title=o,N.setAttribute("role","button"),N.setAttribute("aria-label",o),js(N),Ae(N,"click",di),Ae(N,"click",m,this),Ae(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var r=this._map,o="leaflet-disabled";Je(this._zoomInButton,o),Je(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(Te(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(Te(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});He.mergeOptions({zoomControl:!0}),He.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Al,this.addControl(this.zoomControl))});var py=function(r){return new Al(r)},Ou=kn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var o="leaflet-control-scale",d=Me("div",o),h=this.options;return this._addScales(h,o+"-line",d),r.on(h.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),d},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,o,d){r.metric&&(this._mScale=Me("div",o,d)),r.imperial&&(this._iScale=Me("div",o,d))},_update:function(){var r=this._map,o=r.getSize().y/2,d=r.distance(r.containerPointToLatLng([0,o]),r.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(d)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var o=this._getRoundNum(r),d=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,d,o/r)},_updateImperial:function(r){var o=r*3.2808399,d,h,m;o>5280?(d=o/5280,h=this._getRoundNum(d),this._updateScale(this._iScale,h+" mi",h/d)):(m=this._getRoundNum(o),this._updateScale(this._iScale,m+" ft",m/o))},_updateScale:function(r,o,d){r.style.width=Math.round(this.options.maxWidth*d)+"px",r.innerHTML=o},_getRoundNum:function(r){var o=Math.pow(10,(Math.floor(r)+"").length-1),d=r/o;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,o*d}}),my=function(r){return new Ou(r)},gy='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Fl=kn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pe.inlineSvg?gy+" ":"")+"Leaflet</a>"},initialize:function(r){S(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Me("div","leaflet-control-attribution"),js(this._container);for(var o in r._layers)r._layers[o].getAttribution&&this.addAttribution(r._layers[o].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var o in this._attributions)this._attributions[o]&&r.push(o);var d=[];this.options.prefix&&d.push(this.options.prefix),r.length&&d.push(r.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});He.mergeOptions({attributionControl:!0}),He.addInitHook(function(){this.options.attributionControl&&new Fl().addTo(this)});var yy=function(r){return new Fl(r)};kn.Layers=Mu,kn.Zoom=Al,kn.Scale=Ou,kn.Attribution=Fl,Ss.layers=hy,Ss.zoom=py,Ss.scale=my,Ss.attribution=yy;var zn=G.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});zn.addTo=function(r,o){return r.addHandler(o,this),this};var vy={Events:oe},Du=Pe.touch?"touchstart mousedown":"mousedown",kr=Ne.extend({options:{clickTolerance:3},initialize:function(r,o,d,h){S(this,h),this._element=r,this._dragStartTarget=o||r,this._preventOutline=d},enable:function(){this._enabled||(Ae(this._dragStartTarget,Du,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(kr._dragging===this&&this.finishDrag(!0),Xe(this._dragStartTarget,Du,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!Xn(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){kr._dragging===this&&this.finishDrag();return}if(!(kr._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(kr._dragging=this,this._preventOutline&&bl(this._element),Cl(),xs(),!this._moving)){this.fire("down");var o=r.touches?r.touches[0]:r,d=Tu(this._element);this._startPoint=new W(o.clientX,o.clientY),this._startPos=nt(this._element),this._parentScale=Il(d);var h=r.type==="mousedown";Ae(document,h?"mousemove":"touchmove",this._onMove,this),Ae(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var o=r.touches&&r.touches.length===1?r.touches[0]:r,d=new W(o.clientX,o.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,kt(r),this._moved||(this.fire("dragstart"),this._moved=!0,Te(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Te(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),at(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){Je(document.body,"leaflet-dragging"),this._lastTarget&&(Je(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Xe(document,"mousemove touchmove",this._onMove,this),Xe(document,"mouseup touchend touchcancel",this._onUp,this),kl(),_s();var o=this._moved&&this._moving;this._moving=!1,kr._dragging=!1,o&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function zu(r,o,d){var h,m=[1,4,2,8],N,A,H,Y,le,_e,Ee,Oe;for(N=0,_e=r.length;N<_e;N++)r[N]._code=ui(r[N],o);for(H=0;H<4;H++){for(Ee=m[H],h=[],N=0,_e=r.length,A=_e-1;N<_e;A=N++)Y=r[N],le=r[A],Y._code&Ee?le._code&Ee||(Oe=Ta(le,Y,Ee,o,d),Oe._code=ui(Oe,o),h.push(Oe)):(le._code&Ee&&(Oe=Ta(le,Y,Ee,o,d),Oe._code=ui(Oe,o),h.push(Oe)),h.push(Y));r=h}return r}function $u(r,o){var d,h,m,N,A,H,Y,le,_e;if(!r||r.length===0)throw new Error("latlngs not passed");pn(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Ee=ce([0,0]),Oe=se(r),Dt=Oe.getNorthWest().distanceTo(Oe.getSouthWest())*Oe.getNorthEast().distanceTo(Oe.getNorthWest());Dt<1700&&(Ee=Ul(r));var jt=r.length,mn=[];for(d=0;d<jt;d++){var qt=ce(r[d]);mn.push(o.project(ce([qt.lat-Ee.lat,qt.lng-Ee.lng])))}for(H=Y=le=0,d=0,h=jt-1;d<jt;h=d++)m=mn[d],N=mn[h],A=m.y*N.x-N.y*m.x,Y+=(m.x+N.x)*A,le+=(m.y+N.y)*A,H+=A*3;H===0?_e=mn[0]:_e=[Y/H,le/H];var Oi=o.unproject(re(_e));return ce([Oi.lat+Ee.lat,Oi.lng+Ee.lng])}function Ul(r){for(var o=0,d=0,h=0,m=0;m<r.length;m++){var N=ce(r[m]);o+=N.lat,d+=N.lng,h++}return ce([o/h,d/h])}var xy={__proto__:null,clipPolygon:zu,polygonCenter:$u,centroid:Ul};function Wu(r,o){if(!o||!r.length)return r.slice();var d=o*o;return r=jy(r,d),r=wy(r,d),r}function Hu(r,o,d){return Math.sqrt(Ns(r,o,d,!0))}function _y(r,o,d){return Ns(r,o,d)}function wy(r,o){var d=r.length,h=typeof Uint8Array<"u"?Uint8Array:Array,m=new h(d);m[0]=m[d-1]=1,Ml(r,m,o,0,d-1);var N,A=[];for(N=0;N<d;N++)m[N]&&A.push(r[N]);return A}function Ml(r,o,d,h,m){var N=0,A,H,Y;for(H=h+1;H<=m-1;H++)Y=Ns(r[H],r[h],r[m],!0),Y>N&&(A=H,N=Y);N>d&&(o[A]=1,Ml(r,o,d,h,A),Ml(r,o,d,A,m))}function jy(r,o){for(var d=[r[0]],h=1,m=0,N=r.length;h<N;h++)Sy(r[h],r[m])>o&&(d.push(r[h]),m=h);return m<N-1&&d.push(r[N-1]),d}var Zu;function Vu(r,o,d,h,m){var N=h?Zu:ui(r,d),A=ui(o,d),H,Y,le;for(Zu=A;;){if(!(N|A))return[r,o];if(N&A)return!1;H=N||A,Y=Ta(r,o,H,d,m),le=ui(Y,d),H===N?(r=Y,N=le):(o=Y,A=le)}}function Ta(r,o,d,h,m){var N=o.x-r.x,A=o.y-r.y,H=h.min,Y=h.max,le,_e;return d&8?(le=r.x+N*(Y.y-r.y)/A,_e=Y.y):d&4?(le=r.x+N*(H.y-r.y)/A,_e=H.y):d&2?(le=Y.x,_e=r.y+A*(Y.x-r.x)/N):d&1&&(le=H.x,_e=r.y+A*(H.x-r.x)/N),new W(le,_e,m)}function ui(r,o){var d=0;return r.x<o.min.x?d|=1:r.x>o.max.x&&(d|=2),r.y<o.min.y?d|=4:r.y>o.max.y&&(d|=8),d}function Sy(r,o){var d=o.x-r.x,h=o.y-r.y;return d*d+h*h}function Ns(r,o,d,h){var m=o.x,N=o.y,A=d.x-m,H=d.y-N,Y=A*A+H*H,le;return Y>0&&(le=((r.x-m)*A+(r.y-N)*H)/Y,le>1?(m=d.x,N=d.y):le>0&&(m+=A*le,N+=H*le)),A=r.x-m,H=r.y-N,h?A*A+H*H:new W(m,N)}function pn(r){return!w(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function qu(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),pn(r)}function Gu(r,o){var d,h,m,N,A,H,Y,le;if(!r||r.length===0)throw new Error("latlngs not passed");pn(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var _e=ce([0,0]),Ee=se(r),Oe=Ee.getNorthWest().distanceTo(Ee.getSouthWest())*Ee.getNorthEast().distanceTo(Ee.getNorthWest());Oe<1700&&(_e=Ul(r));var Dt=r.length,jt=[];for(d=0;d<Dt;d++){var mn=ce(r[d]);jt.push(o.project(ce([mn.lat-_e.lat,mn.lng-_e.lng])))}for(d=0,h=0;d<Dt-1;d++)h+=jt[d].distanceTo(jt[d+1])/2;if(h===0)le=jt[0];else for(d=0,N=0;d<Dt-1;d++)if(A=jt[d],H=jt[d+1],m=A.distanceTo(H),N+=m,N>h){Y=(N-h)/m,le=[H.x-Y*(H.x-A.x),H.y-Y*(H.y-A.y)];break}var qt=o.unproject(re(le));return ce([qt.lat+_e.lat,qt.lng+_e.lng])}var Ny={__proto__:null,simplify:Wu,pointToSegmentDistance:Hu,closestPointOnSegment:_y,clipSegment:Vu,_getEdgeIntersection:Ta,_getBitCode:ui,_sqClosestPointOnSegment:Ns,isFlat:pn,_flat:qu,polylineCenter:Gu},Ol={project:function(r){return new W(r.lng,r.lat)},unproject:function(r){return new ne(r.y,r.x)},bounds:new U([-180,-90],[180,90])},Dl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new U([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var o=Math.PI/180,d=this.R,h=r.lat*o,m=this.R_MINOR/d,N=Math.sqrt(1-m*m),A=N*Math.sin(h),H=Math.tan(Math.PI/4-h/2)/Math.pow((1-A)/(1+A),N/2);return h=-d*Math.log(Math.max(H,1e-10)),new W(r.lng*o*d,h)},unproject:function(r){for(var o=180/Math.PI,d=this.R,h=this.R_MINOR/d,m=Math.sqrt(1-h*h),N=Math.exp(-r.y/d),A=Math.PI/2-2*Math.atan(N),H=0,Y=.1,le;H<15&&Math.abs(Y)>1e-7;H++)le=m*Math.sin(A),le=Math.pow((1-le)/(1+le),m/2),Y=Math.PI/2-2*Math.atan(N*le)-A,A+=Y;return new ne(A*o,r.x*o/d)}},Cy={__proto__:null,LonLat:Ol,Mercator:Dl,SphericalMercator:Ve},ky=a({},we,{code:"EPSG:3395",projection:Dl,transformation:function(){var r=.5/(Math.PI*Dl.R);return qe(r,.5,-r,.5)}()}),Yu=a({},we,{code:"EPSG:4326",projection:Ol,transformation:qe(1/180,1,-1/180,.5)}),Py=a({},ke,{projection:Ol,transformation:qe(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,o){var d=o.lng-r.lng,h=o.lat-r.lat;return Math.sqrt(d*d+h*h)},infinite:!0});ke.Earth=we,ke.EPSG3395=ky,ke.EPSG3857=Ct,ke.EPSG900913=ge,ke.EPSG4326=Yu,ke.Simple=Py;var Pn=Ne.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[f(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[f(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var o=r.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var d=this.getEvents();o.on(d,this),this.once("remove",function(){o.off(d,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});He.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var o=f(r);return this._layers[o]?this:(this._layers[o]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var o=f(r);return this._layers[o]?(this._loaded&&r.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return f(r)in this._layers},eachLayer:function(r,o){for(var d in this._layers)r.call(o,this._layers[d]);return this},_addLayers:function(r){r=r?w(r)?r:[r]:[];for(var o=0,d=r.length;o<d;o++)this.addLayer(r[o])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[f(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var o=f(r);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,o=-1/0,d=this._getZoomSpan();for(var h in this._zoomBoundLayers){var m=this._zoomBoundLayers[h].options;r=m.minZoom===void 0?r:Math.min(r,m.minZoom),o=m.maxZoom===void 0?o:Math.max(o,m.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=r===1/0?void 0:r,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ri=Pn.extend({initialize:function(r,o){S(this,o),this._layers={};var d,h;if(r)for(d=0,h=r.length;d<h;d++)this.addLayer(r[d])},addLayer:function(r){var o=this.getLayerId(r);return this._layers[o]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var o=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(r){var o=typeof r=="number"?r:this.getLayerId(r);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var o=Array.prototype.slice.call(arguments,1),d,h;for(d in this._layers)h=this._layers[d],h[r]&&h[r].apply(h,o);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,o){for(var d in this._layers)r.call(o,this._layers[d]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return f(r)}}),by=function(r,o){return new Ri(r,o)},er=Ri.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),Ri.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),Ri.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Z;for(var o in this._layers){var d=this._layers[o];r.extend(d.getBounds?d.getBounds():d.getLatLng())}return r}}),Iy=function(r,o){return new er(r,o)},Ai=G.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){S(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,o){var d=this._getIconUrl(r);if(!d){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(d,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(h,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(r,o){var d=this.options,h=d[o+"Size"];typeof h=="number"&&(h=[h,h]);var m=re(h),N=re(o==="shadow"&&d.shadowAnchor||d.iconAnchor||m&&m.divideBy(2,!0));r.className="leaflet-marker-"+o+" "+(d.className||""),N&&(r.style.marginLeft=-N.x+"px",r.style.marginTop=-N.y+"px"),m&&(r.style.width=m.x+"px",r.style.height=m.y+"px")},_createImg:function(r,o){return o=o||document.createElement("img"),o.src=r,o},_getIconUrl:function(r){return Pe.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Ly(r){return new Ai(r)}var Cs=Ai.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof Cs.imagePath!="string"&&(Cs.imagePath=this._detectIconPath()),(this.options.imagePath||Cs.imagePath)+Ai.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var o=function(d,h,m){var N=h.exec(d);return N&&N[m]};return r=o(r,/^url\((['"])?(.+)\1\)$/,2),r&&o(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Me("div","leaflet-default-icon-path",document.body),o=Nn(r,"background-image")||Nn(r,"backgroundImage");if(document.body.removeChild(r),o=this._stripUrl(o),o)return o;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),Ku=zn.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new kr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Te(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Je(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var o=this._marker,d=o._map,h=this._marker.options.autoPanSpeed,m=this._marker.options.autoPanPadding,N=nt(o._icon),A=d.getPixelBounds(),H=d.getPixelOrigin(),Y=ie(A.min._subtract(H).add(m),A.max._subtract(H).subtract(m));if(!Y.contains(N)){var le=re((Math.max(Y.max.x,N.x)-Y.max.x)/(A.max.x-Y.max.x)-(Math.min(Y.min.x,N.x)-Y.min.x)/(A.min.x-Y.min.x),(Math.max(Y.max.y,N.y)-Y.max.y)/(A.max.y-Y.max.y)-(Math.min(Y.min.y,N.y)-Y.min.y)/(A.min.y-Y.min.y)).multiplyBy(h);d.panBy(le,{animate:!1}),this._draggable._newPos._add(le),this._draggable._startPos._add(le),at(o._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=D(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(q(this._panRequest),this._panRequest=D(this._adjustPan.bind(this,r)))},_onDrag:function(r){var o=this._marker,d=o._shadow,h=nt(o._icon),m=o._map.layerPointToLatLng(h);d&&at(d,h),o._latlng=m,r.latlng=m,r.oldLatLng=this._oldLatLng,o.fire("move",r).fire("drag",r)},_onDragEnd:function(r){q(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),Ba=Pn.extend({options:{icon:new Cs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,o){S(this,o),this._latlng=ce(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var o=this._latlng;return this._latlng=ce(r),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=r.icon.createIcon(this._icon),h=!1;d!==this._icon&&(this._icon&&this._removeIcon(),h=!0,r.title&&(d.title=r.title),d.tagName==="IMG"&&(d.alt=r.alt||"")),Te(d,o),r.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ae(d,"focus",this._panOnFocus,this);var m=r.icon.createShadow(this._shadow),N=!1;m!==this._shadow&&(this._removeShadow(),N=!0),m&&(Te(m,o),m.alt=""),this._shadow=m,r.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),m&&N&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(this._icon,"focus",this._panOnFocus,this),Ke(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ke(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&at(this._icon,r),this._shadow&&at(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var o=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(Te(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ku)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ku(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Ot(this._icon,r),this._shadow&&Ot(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var o=this.options.icon.options,d=o.iconSize?re(o.iconSize):re(0,0),h=o.iconAnchor?re(o.iconAnchor):re(0,0);r.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:d.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ey(r,o){return new Ba(r,o)}var Pr=Pn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return S(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ra=Pr.extend({options:{fill:!0,radius:10},initialize:function(r,o){S(this,o),this._latlng=ce(r),this._radius=this.options.radius},setLatLng:function(r){var o=this._latlng;return this._latlng=ce(r),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var o=r&&r.radius||this._radius;return Pr.prototype.setStyle.call(this,r),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,o=this._radiusY||r,d=this._clickTolerance(),h=[r+d,o+d];this._pxBounds=new U(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ty(r,o){return new Ra(r,o)}var zl=Ra.extend({initialize:function(r,o,d){if(typeof o=="number"&&(o=a({},d,{radius:o})),S(this,o),this._latlng=ce(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Z(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Pr.prototype.setStyle,_project:function(){var r=this._latlng.lng,o=this._latlng.lat,d=this._map,h=d.options.crs;if(h.distance===we.distance){var m=Math.PI/180,N=this._mRadius/we.R/m,A=d.project([o+N,r]),H=d.project([o-N,r]),Y=A.add(H).divideBy(2),le=d.unproject(Y).lat,_e=Math.acos((Math.cos(N*m)-Math.sin(o*m)*Math.sin(le*m))/(Math.cos(o*m)*Math.cos(le*m)))/m;(isNaN(_e)||_e===0)&&(_e=N/Math.cos(Math.PI/180*o)),this._point=Y.subtract(d.getPixelOrigin()),this._radius=isNaN(_e)?0:Y.x-d.project([le,r-_e]).x,this._radiusY=Y.y-A.y}else{var Ee=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(Ee).x}this._updateBounds()}});function By(r,o,d){return new zl(r,o,d)}var tr=Pr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,o){S(this,o),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var o=1/0,d=null,h=Ns,m,N,A=0,H=this._parts.length;A<H;A++)for(var Y=this._parts[A],le=1,_e=Y.length;le<_e;le++){m=Y[le-1],N=Y[le];var Ee=h(r,m,N,!0);Ee<o&&(o=Ee,d=h(r,m,N))}return d&&(d.distance=Math.sqrt(o)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Gu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,o){return o=o||this._defaultShape(),r=ce(r),o.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Z,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return pn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var o=[],d=pn(r),h=0,m=r.length;h<m;h++)d?(o[h]=ce(r[h]),this._bounds.extend(o[h])):o[h]=this._convertLatLngs(r[h]);return o},_project:function(){var r=new U;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),o=new W(r,r);this._rawPxBounds&&(this._pxBounds=new U([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(r,o,d){var h=r[0]instanceof ne,m=r.length,N,A;if(h){for(A=[],N=0;N<m;N++)A[N]=this._map.latLngToLayerPoint(r[N]),d.extend(A[N]);o.push(A)}else for(N=0;N<m;N++)this._projectLatlngs(r[N],o,d)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,d,h,m,N,A,H,Y;for(d=0,m=0,N=this._rings.length;d<N;d++)for(Y=this._rings[d],h=0,A=Y.length;h<A-1;h++)H=Vu(Y[h],Y[h+1],r,h,!0),H&&(o[m]=o[m]||[],o[m].push(H[0]),(H[1]!==Y[h+1]||h===A-2)&&(o[m].push(H[1]),m++))}},_simplifyPoints:function(){for(var r=this._parts,o=this.options.smoothFactor,d=0,h=r.length;d<h;d++)r[d]=Wu(r[d],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,o){var d,h,m,N,A,H,Y=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(d=0,N=this._parts.length;d<N;d++)for(H=this._parts[d],h=0,A=H.length,m=A-1;h<A;m=h++)if(!(!o&&h===0)&&Hu(r,H[m],H[h])<=Y)return!0;return!1}});function Ry(r,o){return new tr(r,o)}tr._flat=qu;var Fi=tr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return $u(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var o=tr.prototype._convertLatLngs.call(this,r),d=o.length;return d>=2&&o[0]instanceof ne&&o[0].equals(o[d-1])&&o.pop(),o},_setLatLngs:function(r){tr.prototype._setLatLngs.call(this,r),pn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return pn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,o=this.options.weight,d=new W(o,o);if(r=new U(r.min.subtract(d),r.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,m=this._rings.length,N;h<m;h++)N=zu(this._rings[h],r,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var o=!1,d,h,m,N,A,H,Y,le;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(N=0,Y=this._parts.length;N<Y;N++)for(d=this._parts[N],A=0,le=d.length,H=le-1;A<le;H=A++)h=d[A],m=d[H],h.y>r.y!=m.y>r.y&&r.x<(m.x-h.x)*(r.y-h.y)/(m.y-h.y)+h.x&&(o=!o);return o||tr.prototype._containsPoint.call(this,r,!0)}});function Ay(r,o){return new Fi(r,o)}var nr=er.extend({initialize:function(r,o){S(this,o),this._layers={},r&&this.addData(r)},addData:function(r){var o=w(r)?r:r.features,d,h,m;if(o){for(d=0,h=o.length;d<h;d++)m=o[d],(m.geometries||m.geometry||m.features||m.coordinates)&&this.addData(m);return this}var N=this.options;if(N.filter&&!N.filter(r))return this;var A=Aa(r,N);return A?(A.feature=Ma(r),A.defaultOptions=A.options,this.resetStyle(A),N.onEachFeature&&N.onEachFeature(r,A),this.addLayer(A)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=a({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(o){this._setLayerStyle(o,r)},this)},_setLayerStyle:function(r,o){r.setStyle&&(typeof o=="function"&&(o=o(r.feature)),r.setStyle(o))}});function Aa(r,o){var d=r.type==="Feature"?r.geometry:r,h=d?d.coordinates:null,m=[],N=o&&o.pointToLayer,A=o&&o.coordsToLatLng||$l,H,Y,le,_e;if(!h&&!d)return null;switch(d.type){case"Point":return H=A(h),Qu(N,r,H,o);case"MultiPoint":for(le=0,_e=h.length;le<_e;le++)H=A(h[le]),m.push(Qu(N,r,H,o));return new er(m);case"LineString":case"MultiLineString":return Y=Fa(h,d.type==="LineString"?0:1,A),new tr(Y,o);case"Polygon":case"MultiPolygon":return Y=Fa(h,d.type==="Polygon"?1:2,A),new Fi(Y,o);case"GeometryCollection":for(le=0,_e=d.geometries.length;le<_e;le++){var Ee=Aa({geometry:d.geometries[le],type:"Feature",properties:r.properties},o);Ee&&m.push(Ee)}return new er(m);case"FeatureCollection":for(le=0,_e=d.features.length;le<_e;le++){var Oe=Aa(d.features[le],o);Oe&&m.push(Oe)}return new er(m);default:throw new Error("Invalid GeoJSON object.")}}function Qu(r,o,d,h){return r?r(o,d):new Ba(d,h&&h.markersInheritOptions&&h)}function $l(r){return new ne(r[1],r[0],r[2])}function Fa(r,o,d){for(var h=[],m=0,N=r.length,A;m<N;m++)A=o?Fa(r[m],o-1,d):(d||$l)(r[m]),h.push(A);return h}function Wl(r,o){return r=ce(r),r.alt!==void 0?[j(r.lng,o),j(r.lat,o),j(r.alt,o)]:[j(r.lng,o),j(r.lat,o)]}function Ua(r,o,d,h){for(var m=[],N=0,A=r.length;N<A;N++)m.push(o?Ua(r[N],pn(r[N])?0:o-1,d,h):Wl(r[N],h));return!o&&d&&m.length>0&&m.push(m[0].slice()),m}function Ui(r,o){return r.feature?a({},r.feature,{geometry:o}):Ma(o)}function Ma(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Hl={toGeoJSON:function(r){return Ui(this,{type:"Point",coordinates:Wl(this.getLatLng(),r)})}};Ba.include(Hl),zl.include(Hl),Ra.include(Hl),tr.include({toGeoJSON:function(r){var o=!pn(this._latlngs),d=Ua(this._latlngs,o?1:0,!1,r);return Ui(this,{type:(o?"Multi":"")+"LineString",coordinates:d})}}),Fi.include({toGeoJSON:function(r){var o=!pn(this._latlngs),d=o&&!pn(this._latlngs[0]),h=Ua(this._latlngs,d?2:o?1:0,!0,r);return o||(h=[h]),Ui(this,{type:(d?"Multi":"")+"Polygon",coordinates:h})}}),Ri.include({toMultiPoint:function(r){var o=[];return this.eachLayer(function(d){o.push(d.toGeoJSON(r).geometry.coordinates)}),Ui(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(r){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(r);var d=o==="GeometryCollection",h=[];return this.eachLayer(function(m){if(m.toGeoJSON){var N=m.toGeoJSON(r);if(d)h.push(N.geometry);else{var A=Ma(N);A.type==="FeatureCollection"?h.push.apply(h,A.features):h.push(A)}}}),d?Ui(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function Ju(r,o){return new nr(r,o)}var Fy=Ju,Oa=Pn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,o,d){this._url=r,this._bounds=se(o),S(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Te(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ke(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&fn(this._image),this},bringToBack:function(){return this._map&&hn(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=se(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",o=this._image=r?this._url:Me("img");if(Te(o,"leaflet-image-layer"),this._zoomAnimated&&Te(o,"leaflet-zoom-animated"),this.options.className&&Te(o,this.options.className),o.onselectstart=x,o.onmousemove=x,o.onload=c(this.fire,this,"load"),o.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(r){var o=this._map.getZoomScale(r.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;On(this._image,d,o)},_reset:function(){var r=this._image,o=new U(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=o.getSize();at(r,o.min),r.style.width=d.x+"px",r.style.height=d.y+"px"},_updateOpacity:function(){Ot(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),Uy=function(r,o,d){return new Oa(r,o,d)},Xu=Oa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",o=this._image=r?this._url:Me("video");if(Te(o,"leaflet-image-layer"),this._zoomAnimated&&Te(o,"leaflet-zoom-animated"),this.options.className&&Te(o,this.options.className),o.onselectstart=x,o.onmousemove=x,o.onloadeddata=c(this.fire,this,"load"),r){for(var d=o.getElementsByTagName("source"),h=[],m=0;m<d.length;m++)h.push(d[m].src);this._url=d.length>0?h:[o.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var N=0;N<this._url.length;N++){var A=Me("source");A.src=this._url[N],o.appendChild(A)}}});function My(r,o,d){return new Xu(r,o,d)}var ef=Oa.extend({_initImage:function(){var r=this._image=this._url;Te(r,"leaflet-image-layer"),this._zoomAnimated&&Te(r,"leaflet-zoom-animated"),this.options.className&&Te(r,this.options.className),r.onselectstart=x,r.onmousemove=x}});function Oy(r,o,d){return new ef(r,o,d)}var $n=Pn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,o){r&&(r instanceof ne||w(r))?(this._latlng=ce(r),S(this,o)):(S(this,r),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Ot(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Ot(this._container,1),this.bringToFront(),this.options.interactive&&(Te(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Ot(this._container,0),this._removeTimeout=setTimeout(c(Ke,void 0,this._container),200)):Ke(this._container),this.options.interactive&&(Je(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=ce(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fn(this._container),this},bringToBack:function(){return this._map&&hn(this._container),this},_prepareOpen:function(r){var o=this._source;if(!o._map)return!1;if(o instanceof er){o=null;var d=this._source._layers;for(var h in d)if(d[h]._map){o=d[h];break}if(!o)return!1;this._source=o}if(!r)if(o.getCenter)r=o.getCenter();else if(o.getLatLng)r=o.getLatLng();else if(o.getBounds)r=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")r.innerHTML=o;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),o=re(this.options.offset),d=this._getAnchor();this._zoomAnimated?at(this._container,r.add(d)):o=o.add(r).add(d);var h=this._containerBottom=-o.y,m=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=h+"px",this._container.style.left=m+"px"}},_getAnchor:function(){return[0,0]}});He.include({_initOverlay:function(r,o,d,h){var m=o;return m instanceof r||(m=new r(h).setContent(o)),d&&m.setLatLng(d),m}}),Pn.include({_initOverlay:function(r,o,d,h){var m=d;return m instanceof r?(S(m,h),m._source=this):(m=o&&!h?o:new r(h,this),m.setContent(d)),m}});var Da=$n.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,$n.prototype.openOn.call(this,r)},onAdd:function(r){$n.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Pr||this._source.on("preclick",ci))},onRemove:function(r){$n.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Pr||this._source.off("preclick",ci))},getEvents:function(){var r=$n.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",o=this._container=Me("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=Me("div",r+"-content-wrapper",o);if(this._contentNode=Me("div",r+"-content",d),js(o),Bl(this._contentNode),Ae(o,"contextmenu",ci),this._tipContainer=Me("div",r+"-tip-container",o),this._tip=Me("div",r+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=Me("a",r+"-close-button",o);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',Ae(h,"click",function(m){kt(m),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,o=r.style;o.width="",o.whiteSpace="nowrap";var d=r.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),o.width=d+1+"px",o.whiteSpace="",o.height="";var h=r.offsetHeight,m=this.options.maxHeight,N="leaflet-popup-scrolled";m&&h>m?(o.height=m+"px",Te(r,N)):Je(r,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var o=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),d=this._getAnchor();at(this._container,o.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,o=parseInt(Nn(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+o,h=this._containerWidth,m=new W(this._containerLeft,-d-this._containerBottom);m._add(nt(this._container));var N=r.layerPointToContainerPoint(m),A=re(this.options.autoPanPadding),H=re(this.options.autoPanPaddingTopLeft||A),Y=re(this.options.autoPanPaddingBottomRight||A),le=r.getSize(),_e=0,Ee=0;N.x+h+Y.x>le.x&&(_e=N.x+h-le.x+Y.x),N.x-_e-H.x<0&&(_e=N.x-H.x),N.y+d+Y.y>le.y&&(Ee=N.y+d-le.y+Y.y),N.y-Ee-H.y<0&&(Ee=N.y-H.y),(_e||Ee)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([_e,Ee]))}},_getAnchor:function(){return re(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Dy=function(r,o){return new Da(r,o)};He.mergeOptions({closePopupOnClick:!0}),He.include({openPopup:function(r,o,d){return this._initOverlay(Da,r,o,d).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),Pn.include({bindPopup:function(r,o){return this._popup=this._initOverlay(Da,this._popup,r,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof er||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){di(r);var o=r.layer||r.target;if(this._popup._source===o&&!(o instanceof Pr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=o,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var za=$n.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){$n.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){$n.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=$n.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",o=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Me("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var o,d,h=this._map,m=this._container,N=h.latLngToContainerPoint(h.getCenter()),A=h.layerPointToContainerPoint(r),H=this.options.direction,Y=m.offsetWidth,le=m.offsetHeight,_e=re(this.options.offset),Ee=this._getAnchor();H==="top"?(o=Y/2,d=le):H==="bottom"?(o=Y/2,d=0):H==="center"?(o=Y/2,d=le/2):H==="right"?(o=0,d=le/2):H==="left"?(o=Y,d=le/2):A.x<N.x?(H="right",o=0,d=le/2):(H="left",o=Y+(_e.x+Ee.x)*2,d=le/2),r=r.subtract(re(o,d,!0)).add(_e).add(Ee),Je(m,"leaflet-tooltip-right"),Je(m,"leaflet-tooltip-left"),Je(m,"leaflet-tooltip-top"),Je(m,"leaflet-tooltip-bottom"),Te(m,"leaflet-tooltip-"+H),at(m,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Ot(this._container,r)},_animateZoom:function(r){var o=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(o)},_getAnchor:function(){return re(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),zy=function(r,o){return new za(r,o)};He.include({openTooltip:function(r,o,d){return this._initOverlay(za,r,o,d).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),Pn.include({bindTooltip:function(r,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(za,this._tooltip,r,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var o=r?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[o](d),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof er||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var o=typeof r.getElement=="function"&&r.getElement();o&&(Ae(o,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Ae(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var o=typeof r.getElement=="function"&&r.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var o=r.latlng,d,h;this._tooltip.options.sticky&&r.originalEvent&&(d=this._map.mouseEventToContainerPoint(r.originalEvent),h=this._map.containerPointToLayerPoint(d),o=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(o)}});var tf=Ai.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var o=r&&r.tagName==="DIV"?r:document.createElement("div"),d=this.options;if(d.html instanceof Element?(Mn(o),o.appendChild(d.html)):o.innerHTML=d.html!==!1?d.html:"",d.bgPos){var h=re(d.bgPos);o.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function $y(r){return new tf(r)}Ai.Default=Cs;var ks=Pn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){S(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),Ke(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(hn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof W?r:new W(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var o=this.getPane().children,d=-r(-1/0,1/0),h=0,m=o.length,N;h<m;h++)N=o[h].style.zIndex,o[h]!==this._container&&N&&(d=r(d,+N));isFinite(d)&&(this.options.zIndex=d+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pe.ielt9){Ot(this._container,this.options.opacity);var r=+new Date,o=!1,d=!1;for(var h in this._tiles){var m=this._tiles[h];if(!(!m.current||!m.loaded)){var N=Math.min(1,(r-m.loaded)/200);Ot(m.el,N),N<1?o=!0:(m.active?d=!0:this._onOpaqueTile(m),m.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),o&&(q(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=Me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,o=this.options.maxZoom;if(r!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===r?(this._levels[d].el.style.zIndex=o-Math.abs(r-d),this._onUpdateLevel(d)):(Ke(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var h=this._levels[r],m=this._map;return h||(h=this._levels[r]={},h.el=Me("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=o,h.origin=m.project(m.unproject(m.getPixelOrigin()),r).round(),h.zoom=r,this._setZoomTransform(h,m.getCenter(),m.getZoom()),x(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var r,o,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)o=this._tiles[r],o.retain=o.current;for(r in this._tiles)if(o=this._tiles[r],o.current&&!o.active){var h=o.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var o in this._tiles)this._tiles[o].coords.z===r&&this._removeTile(o)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)Ke(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,o,d,h){var m=Math.floor(r/2),N=Math.floor(o/2),A=d-1,H=new W(+m,+N);H.z=+A;var Y=this._tileCoordsToKey(H),le=this._tiles[Y];return le&&le.active?(le.retain=!0,!0):(le&&le.loaded&&(le.retain=!0),A>h?this._retainParent(m,N,A,h):!1)},_retainChildren:function(r,o,d,h){for(var m=2*r;m<2*r+2;m++)for(var N=2*o;N<2*o+2;N++){var A=new W(m,N);A.z=d+1;var H=this._tileCoordsToKey(A),Y=this._tiles[H];if(Y&&Y.active){Y.retain=!0;continue}else Y&&Y.loaded&&(Y.retain=!0);d+1<h&&this._retainChildren(m,N,d+1,h)}},_resetView:function(r){var o=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var o=this.options;return o.minNativeZoom!==void 0&&r<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<r?o.maxNativeZoom:r},_setView:function(r,o,d,h){var m=Math.round(o);this.options.maxZoom!==void 0&&m>this.options.maxZoom||this.options.minZoom!==void 0&&m<this.options.minZoom?m=void 0:m=this._clampZoom(m);var N=this.options.updateWhenZooming&&m!==this._tileZoom;(!h||N)&&(this._tileZoom=m,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),m!==void 0&&this._update(r),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(r,o)},_setZoomTransforms:function(r,o){for(var d in this._levels)this._setZoomTransform(this._levels[d],r,o)},_setZoomTransform:function(r,o,d){var h=this._map.getZoomScale(d,r.zoom),m=r.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(o,d)).round();Pe.any3d?On(r.el,m,h):at(r.el,m)},_resetGrid:function(){var r=this._map,o=r.options.crs,d=this._tileSize=this.getTileSize(),h=this._tileZoom,m=this._map.getPixelWorldBounds(this._tileZoom);m&&(this._globalTileRange=this._pxBoundsToTileRange(m)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,o.wrapLng[0]],h).x/d.x),Math.ceil(r.project([0,o.wrapLng[1]],h).x/d.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([o.wrapLat[0],0],h).y/d.x),Math.ceil(r.project([o.wrapLat[1],0],h).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var o=this._map,d=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),h=o.getZoomScale(d,this._tileZoom),m=o.project(r,this._tileZoom).floor(),N=o.getSize().divideBy(h*2);return new U(m.subtract(N),m.add(N))},_update:function(r){var o=this._map;if(o){var d=this._clampZoom(o.getZoom());if(r===void 0&&(r=o.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(r),m=this._pxBoundsToTileRange(h),N=m.getCenter(),A=[],H=this.options.keepBuffer,Y=new U(m.getBottomLeft().subtract([H,-H]),m.getTopRight().add([H,-H]));if(!(isFinite(m.min.x)&&isFinite(m.min.y)&&isFinite(m.max.x)&&isFinite(m.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var le in this._tiles){var _e=this._tiles[le].coords;(_e.z!==this._tileZoom||!Y.contains(new W(_e.x,_e.y)))&&(this._tiles[le].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(r,d);return}for(var Ee=m.min.y;Ee<=m.max.y;Ee++)for(var Oe=m.min.x;Oe<=m.max.x;Oe++){var Dt=new W(Oe,Ee);if(Dt.z=this._tileZoom,!!this._isValidTile(Dt)){var jt=this._tiles[this._tileCoordsToKey(Dt)];jt?jt.current=!0:A.push(Dt)}}if(A.sort(function(qt,Oi){return qt.distanceTo(N)-Oi.distanceTo(N)}),A.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var mn=document.createDocumentFragment();for(Oe=0;Oe<A.length;Oe++)this._addTile(A[Oe],mn);this._level.el.appendChild(mn)}}}},_isValidTile:function(r){var o=this._map.options.crs;if(!o.infinite){var d=this._globalTileRange;if(!o.wrapLng&&(r.x<d.min.x||r.x>d.max.x)||!o.wrapLat&&(r.y<d.min.y||r.y>d.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(r);return se(this.options.bounds).overlaps(h)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var o=this._map,d=this.getTileSize(),h=r.scaleBy(d),m=h.add(d),N=o.unproject(h,r.z),A=o.unproject(m,r.z);return[N,A]},_tileCoordsToBounds:function(r){var o=this._tileCoordsToNwSe(r),d=new Z(o[0],o[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var o=r.split(":"),d=new W(+o[0],+o[1]);return d.z=+o[2],d},_removeTile:function(r){var o=this._tiles[r];o&&(Ke(o.el),delete this._tiles[r],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Te(r,"leaflet-tile");var o=this.getTileSize();r.style.width=o.x+"px",r.style.height=o.y+"px",r.onselectstart=x,r.onmousemove=x,Pe.ielt9&&this.options.opacity<1&&Ot(r,this.options.opacity)},_addTile:function(r,o){var d=this._getTilePos(r),h=this._tileCoordsToKey(r),m=this.createTile(this._wrapCoords(r),c(this._tileReady,this,r));this._initTile(m),this.createTile.length<2&&D(c(this._tileReady,this,r,null,m)),at(m,d),this._tiles[h]={el:m,coords:r,current:!0},o.appendChild(m),this.fire("tileloadstart",{tile:m,coords:r})},_tileReady:function(r,o,d){o&&this.fire("tileerror",{error:o,tile:d,coords:r});var h=this._tileCoordsToKey(r);d=this._tiles[h],d&&(d.loaded=+new Date,this._map._fadeAnimated?(Ot(d.el,0),q(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),o||(Te(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pe.ielt9||!this._map._fadeAnimated?D(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var o=new W(this._wrapX?g(r.x,this._wrapX):r.x,this._wrapY?g(r.y,this._wrapY):r.y);return o.z=r.z,o},_pxBoundsToTileRange:function(r){var o=this.getTileSize();return new U(r.min.unscaleBy(o).floor(),r.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function Wy(r){return new ks(r)}var Mi=ks.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,o){this._url=r,o=S(this,o),o.detectRetina&&Pe.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,o){return this._url===r&&o===void 0&&(o=!0),this._url=r,o||this.redraw(),this},createTile:function(r,o){var d=document.createElement("img");return Ae(d,"load",c(this._tileOnLoad,this,o,d)),Ae(d,"error",c(this._tileOnError,this,o,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(r),d},getTileUrl:function(r){var o={r:Pe.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-r.y;this.options.tms&&(o.y=d),o["-y"]=d}return v(this._url,a(o,this.options))},_tileOnLoad:function(r,o){Pe.ielt9?setTimeout(c(r,this,null,o),0):r(null,o)},_tileOnError:function(r,o,d){var h=this.options.errorTileUrl;h&&o.getAttribute("src")!==h&&(o.src=h),r(d,o)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,o=this.options.maxZoom,d=this.options.zoomReverse,h=this.options.zoomOffset;return d&&(r=o-r),r+h},_getSubdomain:function(r){var o=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var r,o;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(o=this._tiles[r].el,o.onload=x,o.onerror=x,!o.complete)){o.src=B;var d=this._tiles[r].coords;Ke(o),delete this._tiles[r],this.fire("tileabort",{tile:o,coords:d})}},_removeTile:function(r){var o=this._tiles[r];if(o)return o.el.setAttribute("src",B),ks.prototype._removeTile.call(this,r)},_tileReady:function(r,o,d){if(!(!this._map||d&&d.getAttribute("src")===B))return ks.prototype._tileReady.call(this,r,o,d)}});function nf(r,o){return new Mi(r,o)}var rf=Mi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,o){this._url=r;var d=a({},this.defaultWmsParams);for(var h in o)h in this.options||(d[h]=o[h]);o=S(this,o);var m=o.detectRetina&&Pe.retina?2:1,N=this.getTileSize();d.width=N.x*m,d.height=N.y*m,this.wmsParams=d},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Mi.prototype.onAdd.call(this,r)},getTileUrl:function(r){var o=this._tileCoordsToNwSe(r),d=this._crs,h=ie(d.project(o[0]),d.project(o[1])),m=h.min,N=h.max,A=(this._wmsVersion>=1.3&&this._crs===Yu?[m.y,m.x,N.y,N.x]:[m.x,m.y,N.x,N.y]).join(","),H=Mi.prototype.getTileUrl.call(this,r);return H+P(this.wmsParams,H,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+A},setParams:function(r,o){return a(this.wmsParams,r),o||this.redraw(),this}});function Hy(r,o){return new rf(r,o)}Mi.WMS=rf,nf.wms=Hy;var rr=Pn.extend({options:{padding:.1},initialize:function(r){S(this,r),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Te(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,o){var d=this._map.getZoomScale(o,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),m=this._map.project(this._center,o),N=h.multiplyBy(-d).add(m).subtract(this._map._getNewPixelOrigin(r,o));Pe.any3d?On(this._container,N,d):at(this._container,N)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,o=this._map.getSize(),d=this._map.containerPointToLayerPoint(o.multiplyBy(-r)).round();this._bounds=new U(d,d.add(o.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),sf=rr.extend({options:{tolerance:0},getEvents:function(){var r=rr.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){rr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Ae(r,"mousemove",this._onMouseMove,this),Ae(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ae(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){q(this._redrawRequest),delete this._ctx,Ke(this._container),Xe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var o in this._layers)r=this._layers[o],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){rr.prototype._update.call(this);var r=this._bounds,o=this._container,d=r.getSize(),h=Pe.retina?2:1;at(o,r.min),o.width=h*d.x,o.height=h*d.y,o.style.width=d.x+"px",o.style.height=d.y+"px",Pe.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){rr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[f(r)]=r;var o=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var o=r._order,d=o.next,h=o.prev;d?d.prev=h:this._drawLast=h,h?h.next=d:this._drawFirst=d,delete r._order,delete this._layers[f(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var o=r.options.dashArray.split(/[, ]+/),d=[],h,m;for(m=0;m<o.length;m++){if(h=Number(o[m]),isNaN(h))return;d.push(h)}r.options._dashArray=d}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||D(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var o=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new U,this._redrawBounds.extend(r._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(r._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var o=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,o=this._redrawBounds;if(this._ctx.save(),o){var d=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)r=h.layer,(!o||r._pxBounds&&r._pxBounds.intersects(o))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,o){if(this._drawing){var d,h,m,N,A=r._parts,H=A.length,Y=this._ctx;if(H){for(Y.beginPath(),d=0;d<H;d++){for(h=0,m=A[d].length;h<m;h++)N=A[d][h],Y[h?"lineTo":"moveTo"](N.x,N.y);o&&Y.closePath()}this._fillStroke(Y,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var o=r._point,d=this._ctx,h=Math.max(Math.round(r._radius),1),m=(Math.max(Math.round(r._radiusY),1)||h)/h;m!==1&&(d.save(),d.scale(1,m)),d.beginPath(),d.arc(o.x,o.y/m,h,0,Math.PI*2,!1),m!==1&&d.restore(),this._fillStroke(d,r)}},_fillStroke:function(r,o){var d=o.options;d.fill&&(r.globalAlpha=d.fillOpacity,r.fillStyle=d.fillColor||d.color,r.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(r.setLineDash&&r.setLineDash(o.options&&o.options._dashArray||[]),r.globalAlpha=d.opacity,r.lineWidth=d.weight,r.strokeStyle=d.color,r.lineCap=d.lineCap,r.lineJoin=d.lineJoin,r.stroke())},_onClick:function(r){for(var o=this._map.mouseEventToLayerPoint(r),d,h,m=this._drawFirst;m;m=m.next)d=m.layer,d.options.interactive&&d._containsPoint(o)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(d))&&(h=d);this._fireEvent(h?[h]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,o)}},_handleMouseOut:function(r){var o=this._hoveredLayer;o&&(Je(this._container,"leaflet-interactive"),this._fireEvent([o],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,o){if(!this._mouseHoverThrottled){for(var d,h,m=this._drawFirst;m;m=m.next)d=m.layer,d.options.interactive&&d._containsPoint(o)&&(h=d);h!==this._hoveredLayer&&(this._handleMouseOut(r),h&&(Te(this._container,"leaflet-interactive"),this._fireEvent([h],r,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,o,d){this._map._fireDOMEvent(o,d||o.type,r)},_bringToFront:function(r){var o=r._order;if(o){var d=o.next,h=o.prev;if(d)d.prev=h;else return;h?h.next=d:d&&(this._drawFirst=d),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(r)}},_bringToBack:function(r){var o=r._order;if(o){var d=o.next,h=o.prev;if(h)h.next=d;else return;d?d.prev=h:h&&(this._drawLast=h),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(r)}}});function af(r){return Pe.canvas?new sf(r):null}var Ps=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Zy={_initContainer:function(){this._container=Me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(rr.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var o=r._container=Ps("shape");Te(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",r._path=Ps("path"),o.appendChild(r._path),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){var o=r._container;this._container.appendChild(o),r.options.interactive&&r.addInteractiveTarget(o)},_removePath:function(r){var o=r._container;Ke(o),r.removeInteractiveTarget(o),delete this._layers[f(r)]},_updateStyle:function(r){var o=r._stroke,d=r._fill,h=r.options,m=r._container;m.stroked=!!h.stroke,m.filled=!!h.fill,h.stroke?(o||(o=r._stroke=Ps("stroke")),m.appendChild(o),o.weight=h.weight+"px",o.color=h.color,o.opacity=h.opacity,h.dashArray?o.dashStyle=w(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=h.lineCap.replace("butt","flat"),o.joinstyle=h.lineJoin):o&&(m.removeChild(o),r._stroke=null),h.fill?(d||(d=r._fill=Ps("fill")),m.appendChild(d),d.color=h.fillColor||h.color,d.opacity=h.fillOpacity):d&&(m.removeChild(d),r._fill=null)},_updateCircle:function(r){var o=r._point.round(),d=Math.round(r._radius),h=Math.round(r._radiusY||d);this._setPath(r,r._empty()?"M0 0":"AL "+o.x+","+o.y+" "+d+","+h+" 0,"+65535*360)},_setPath:function(r,o){r._path.v=o},_bringToFront:function(r){fn(r._container)},_bringToBack:function(r){hn(r._container)}},$a=Pe.vml?Ps:ae,bs=rr.extend({_initContainer:function(){this._container=$a("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=$a("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ke(this._container),Xe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){rr.prototype._update.call(this);var r=this._bounds,o=r.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,d.setAttribute("width",o.x),d.setAttribute("height",o.y)),at(d,r.min),d.setAttribute("viewBox",[r.min.x,r.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(r){var o=r._path=$a("path");r.options.className&&Te(o,r.options.className),r.options.interactive&&Te(o,"leaflet-interactive"),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){Ke(r._path),r.removeInteractiveTarget(r._path),delete this._layers[f(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var o=r._path,d=r.options;o&&(d.stroke?(o.setAttribute("stroke",d.color),o.setAttribute("stroke-opacity",d.opacity),o.setAttribute("stroke-width",d.weight),o.setAttribute("stroke-linecap",d.lineCap),o.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?o.setAttribute("stroke-dasharray",d.dashArray):o.removeAttribute("stroke-dasharray"),d.dashOffset?o.setAttribute("stroke-dashoffset",d.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),d.fill?(o.setAttribute("fill",d.fillColor||d.color),o.setAttribute("fill-opacity",d.fillOpacity),o.setAttribute("fill-rule",d.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(r,o){this._setPath(r,ye(r._parts,o))},_updateCircle:function(r){var o=r._point,d=Math.max(Math.round(r._radius),1),h=Math.max(Math.round(r._radiusY),1)||d,m="a"+d+","+h+" 0 1,0 ",N=r._empty()?"M0 0":"M"+(o.x-d)+","+o.y+m+d*2+",0 "+m+-d*2+",0 ";this._setPath(r,N)},_setPath:function(r,o){r._path.setAttribute("d",o)},_bringToFront:function(r){fn(r._path)},_bringToBack:function(r){hn(r._path)}});Pe.vml&&bs.include(Zy);function of(r){return Pe.svg||Pe.vml?new bs(r):null}He.include({getRenderer:function(r){var o=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var o=this._paneRenderers[r];return o===void 0&&(o=this._createRenderer({pane:r}),this._paneRenderers[r]=o),o},_createRenderer:function(r){return this.options.preferCanvas&&af(r)||of(r)}});var lf=Fi.extend({initialize:function(r,o){Fi.prototype.initialize.call(this,this._boundsToLatLngs(r),o)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=se(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Vy(r,o){return new lf(r,o)}bs.create=$a,bs.pointsToPath=ye,nr.geometryToLayer=Aa,nr.coordsToLatLng=$l,nr.coordsToLatLngs=Fa,nr.latLngToCoords=Wl,nr.latLngsToCoords=Ua,nr.getFeature=Ui,nr.asFeature=Ma,He.mergeOptions({boxZoom:!0});var cf=zn.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Ae(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ke(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),xs(),Cl(),this._startPoint=this._map.mouseEventToContainerPoint(r),Ae(document,{contextmenu:di,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Me("div","leaflet-zoom-box",this._container),Te(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var o=new U(this._point,this._startPoint),d=o.getSize();at(this._box,o.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Ke(this._box),Je(this._container,"leaflet-crosshair")),_s(),kl(),Xe(document,{contextmenu:di,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var o=new Z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});He.addInitHook("addHandler","boxZoom",cf),He.mergeOptions({doubleClickZoom:!0});var df=zn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var o=this._map,d=o.getZoom(),h=o.options.zoomDelta,m=r.originalEvent.shiftKey?d-h:d+h;o.options.doubleClickZoom==="center"?o.setZoom(m):o.setZoomAround(r.containerPoint,m)}});He.addInitHook("addHandler","doubleClickZoom",df),He.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var uf=zn.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new kr(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}Te(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Je(this._map._container,"leaflet-grab"),Je(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=se(this._map.options.maxBounds);this._offsetLimit=ie(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var o=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(o),this._prunePositions(o)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,o){return r-(r-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;r.x<o.min.x&&(r.x=this._viscousLimit(r.x,o.min.x)),r.y<o.min.y&&(r.y=this._viscousLimit(r.y,o.min.y)),r.x>o.max.x&&(r.x=this._viscousLimit(r.x,o.max.x)),r.y>o.max.y&&(r.y=this._viscousLimit(r.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,o=Math.round(r/2),d=this._initialWorldOffset,h=this._draggable._newPos.x,m=(h-o+d)%r+o-d,N=(h+o+d)%r-o-d,A=Math.abs(m+d)<Math.abs(N+d)?m:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=A},_onDragEnd:function(r){var o=this._map,d=o.options,h=!d.inertia||r.noInertia||this._times.length<2;if(o.fire("dragend",r),h)o.fire("moveend");else{this._prunePositions(+new Date);var m=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,A=d.easeLinearity,H=m.multiplyBy(A/N),Y=H.distanceTo([0,0]),le=Math.min(d.inertiaMaxSpeed,Y),_e=H.multiplyBy(le/Y),Ee=le/(d.inertiaDeceleration*A),Oe=_e.multiplyBy(-Ee/2).round();!Oe.x&&!Oe.y?o.fire("moveend"):(Oe=o._limitOffset(Oe,o.options.maxBounds),D(function(){o.panBy(Oe,{duration:Ee,easeLinearity:A,noMoveStart:!0,animate:!0})}))}}});He.addInitHook("addHandler","dragging",uf),He.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ff=zn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Ae(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Xe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,o=document.documentElement,d=r.scrollTop||o.scrollTop,h=r.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(h,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var o=this._panKeys={},d=this.keyCodes,h,m;for(h=0,m=d.left.length;h<m;h++)o[d.left[h]]=[-1*r,0];for(h=0,m=d.right.length;h<m;h++)o[d.right[h]]=[r,0];for(h=0,m=d.down.length;h<m;h++)o[d.down[h]]=[0,r];for(h=0,m=d.up.length;h<m;h++)o[d.up[h]]=[0,-1*r]},_setZoomDelta:function(r){var o=this._zoomKeys={},d=this.keyCodes,h,m;for(h=0,m=d.zoomIn.length;h<m;h++)o[d.zoomIn[h]]=r;for(h=0,m=d.zoomOut.length;h<m;h++)o[d.zoomOut[h]]=-r},_addHooks:function(){Ae(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var o=r.keyCode,d=this._map,h;if(o in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(h=this._panKeys[o],r.shiftKey&&(h=re(h).multiplyBy(3)),d.options.maxBounds&&(h=d._limitOffset(re(h),d.options.maxBounds)),d.options.worldCopyJump){var m=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(h)));d.panTo(m)}else d.panBy(h)}else if(o in this._zoomKeys)d.setZoom(d.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;di(r)}}});He.addInitHook("addHandler","keyboard",ff),He.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var hf=zn.extend({addHooks:function(){Ae(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var o=Fu(r),d=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var h=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),h),di(r)},_performZoom:function(){var r=this._map,o=r.getZoom(),d=this._map.options.zoomSnap||0;r._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),m=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,N=d?Math.ceil(m/d)*d:m,A=r._limitZoom(o+(this._delta>0?N:-N))-o;this._delta=0,this._startTime=null,A&&(r.options.scrollWheelZoom==="center"?r.setZoom(o+A):r.setZoomAround(this._lastMousePos,o+A))}});He.addInitHook("addHandler","scrollWheelZoom",hf);var qy=600;He.mergeOptions({tapHold:Pe.touchNative&&Pe.safari&&Pe.mobile,tapTolerance:15});var pf=zn.extend({addHooks:function(){Ae(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var o=r.touches[0];this._startPos=this._newPos=new W(o.clientX,o.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(Ae(document,"touchend",kt),Ae(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),qy),Ae(document,"touchend touchcancel contextmenu",this._cancel,this),Ae(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){Xe(document,"touchend",kt),Xe(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)},_onMove:function(r){var o=r.touches[0];this._newPos=new W(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,o){var d=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});d._simulated=!0,o.target.dispatchEvent(d)}});He.addInitHook("addHandler","tapHold",pf),He.mergeOptions({touchZoom:Pe.touch,bounceAtZoomLimits:!0});var mf=zn.extend({addHooks:function(){Te(this._map._container,"leaflet-touch-zoom"),Ae(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Je(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var o=this._map;if(!(!r.touches||r.touches.length!==2||o._animatingZoom||this._zooming)){var d=o.mouseEventToContainerPoint(r.touches[0]),h=o.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(d.add(h)._divideBy(2))),this._startDist=d.distanceTo(h),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),Ae(document,"touchmove",this._onTouchMove,this),Ae(document,"touchend touchcancel",this._onTouchEnd,this),kt(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var o=this._map,d=o.mouseEventToContainerPoint(r.touches[0]),h=o.mouseEventToContainerPoint(r.touches[1]),m=d.distanceTo(h)/this._startDist;if(this._zoom=o.getScaleZoom(m,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&m<1||this._zoom>o.getMaxZoom()&&m>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,m===1)return}else{var N=d._add(h)._divideBy(2)._subtract(this._centerPoint);if(m===1&&N.x===0&&N.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),q(this._animRequest);var A=c(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=D(A,this,!0),kt(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,q(this._animRequest),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});He.addInitHook("addHandler","touchZoom",mf),He.BoxZoom=cf,He.DoubleClickZoom=df,He.Drag=uf,He.Keyboard=ff,He.ScrollWheelZoom=hf,He.TapHold=pf,He.TouchZoom=mf,n.Bounds=U,n.Browser=Pe,n.CRS=ke,n.Canvas=sf,n.Circle=zl,n.CircleMarker=Ra,n.Class=G,n.Control=kn,n.DivIcon=tf,n.DivOverlay=$n,n.DomEvent=uy,n.DomUtil=cy,n.Draggable=kr,n.Evented=Ne,n.FeatureGroup=er,n.GeoJSON=nr,n.GridLayer=ks,n.Handler=zn,n.Icon=Ai,n.ImageOverlay=Oa,n.LatLng=ne,n.LatLngBounds=Z,n.Layer=Pn,n.LayerGroup=Ri,n.LineUtil=Ny,n.Map=He,n.Marker=Ba,n.Mixin=vy,n.Path=Pr,n.Point=W,n.PolyUtil=xy,n.Polygon=Fi,n.Polyline=tr,n.Popup=Da,n.PosAnimation=Uu,n.Projection=Cy,n.Rectangle=lf,n.Renderer=rr,n.SVG=bs,n.SVGOverlay=ef,n.TileLayer=Mi,n.Tooltip=za,n.Transformation=ht,n.Util=te,n.VideoOverlay=Xu,n.bind=c,n.bounds=ie,n.canvas=af,n.circle=By,n.circleMarker=Ty,n.control=Ss,n.divIcon=$y,n.extend=a,n.featureGroup=Iy,n.geoJSON=Ju,n.geoJson=Fy,n.gridLayer=Wy,n.icon=Ly,n.imageOverlay=Uy,n.latLng=ce,n.latLngBounds=se,n.layerGroup=by,n.map=fy,n.marker=Ey,n.point=re,n.polygon=Ay,n.polyline=Ry,n.popup=Dy,n.rectangle=Vy,n.setOptions=S,n.stamp=f,n.svg=of,n.svgOverlay=Oy,n.tileLayer=nf,n.tooltip=zy,n.transformation=qe,n.version=s,n.videoOverlay=My;var Gy=window.L;n.noConflict=function(){return window.L=Gy,this},window.L=n})})(Cd,Cd.exports);var Pa=Cd.exports;const ba=ip(Pa);function bu(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function Iu(e,t){return t==null?function(s,a){const l=y.useRef();return l.current||(l.current=e(s,a)),l}:function(s,a){const l=y.useRef();l.current||(l.current=e(s,a));const c=y.useRef(s),{instance:u}=l.current;return y.useEffect(function(){c.current!==s&&(t(u,s,c.current),c.current=s)},[u,s,a]),l}}function gj(e,t){y.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var l;(l=t.layerContainer)==null||l.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function sy(e){return function(n){const s=ku(),a=e(Pu(n,s),s);return ty(s.map,n.attribution),iy(a.current,n.eventHandlers),gj(a.current,s),a}}function yj(e,t){const n=Iu(e,t),s=sy(n);return fj(s)}function vj(e,t){const n=Iu(e),s=mj(n,t);return hj(s)}function xj(e,t){const n=Iu(e,t),s=sy(n);return pj(s)}function _j(e,t,n){const{opacity:s,zIndex:a}=t;s!=null&&s!==n.opacity&&e.setOpacity(s),a!=null&&a!==n.zIndex&&e.setZIndex(a)}function wj(){return ku().map}function kd(){return kd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},kd.apply(this,arguments)}function jj({bounds:e,boundsOptions:t,center:n,children:s,className:a,id:l,placeholder:c,style:u,whenReady:f,zoom:p,...g},x){const[j]=y.useState({className:a,id:l,style:u}),[k,C]=y.useState(null);y.useImperativeHandle(x,()=>(k==null?void 0:k.map)??null,[k]);const S=y.useCallback(_=>{if(_!==null&&k===null){const v=new Pa.Map(_,g);n!=null&&p!=null?v.setView(n,p):e!=null&&v.fitBounds(e,t),f!=null&&v.whenReady(f),C(dj(v))}},[]);y.useEffect(()=>()=>{k==null||k.map.remove()},[k]);const P=k?Kn.createElement(ry,{value:k},s):c??null;return Kn.createElement("div",kd({},j,{ref:S}),P)}const Sj=y.forwardRef(jj),Xh=yj(function({position:t,...n},s){const a=new Pa.Marker(t,n);return bu(a,uj(s,{overlayContainer:a}))},function(t,n,s){n.position!==s.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),ep=vj(function(t,n){const s=new Pa.Popup(t,n.overlayContainer);return bu(s,n)},function(t,n,{position:s},a){y.useEffect(function(){const{instance:c}=t;function u(p){p.popup===c&&(c.update(),a(!0))}function f(p){p.popup===c&&a(!1)}return n.map.on({popupopen:u,popupclose:f}),n.overlayContainer==null?(s!=null&&c.setLatLng(s),c.openOn(n.map)):n.overlayContainer.bindPopup(c),function(){var g;n.map.off({popupopen:u,popupclose:f}),(g=n.overlayContainer)==null||g.unbindPopup(),n.map.removeLayer(c)}},[t,n,a,s])}),Nj=xj(function({url:t,...n},s){const a=new Pa.TileLayer(t,Pu(n,s));return bu(a,s)},function(t,n,s){_j(t,n,s);const{url:a}=n;a!=null&&a!==s.url&&t.setUrl(a)}),Cj="https://nominatim.openstreetmap.org/search",Lu="ev_station_geocoding_cache",Tn=new Map;function kj(){try{const e=localStorage.getItem(Lu);if(e){const t=JSON.parse(e);return Object.entries(t).forEach(([n,s])=>{Tn.set(n,s)}),console.log(` Loaded ${Tn.size} cached geocoding results from localStorage`),!0}}catch(e){console.warn(" Failed to load geocoding cache from localStorage:",e.message)}return!1}function jc(){try{const e=Object.fromEntries(Tn);localStorage.setItem(Lu,JSON.stringify(e))}catch(e){console.warn(" Failed to save geocoding cache to localStorage:",e.message)}}kj();async function Pj(e,t="Vietnam"){if(!e||typeof e!="string")return null;const n=`${e}|${t}`;if(Tn.has(n)){const s=Tn.get(n);return s&&console.log(` Geocoding cache hit for "${e}"`),s}try{const s=[`${e}, ${t}`,`${e}`,`${t}, Vietnam`];console.log(` Geocoding address: "${e}" (city: "${t}")`);let a=null,l="";for(const c of s){l=c;const u=await fetch(`${Cj}?q=${encodeURIComponent(c)}&format=json&limit=5&timeout=10&accept-language=vi`,{headers:{Accept:"application/json","User-Agent":"EVStationRental-FE"}});if(u.ok){if(a=await u.json(),Array.isArray(a)&&a.length>0){const f=a.find(g=>{var k;const x=((k=g.address)==null?void 0:k.toLowerCase())||"",j=(t==null?void 0:t.toLowerCase())||"";return x.includes(j)})||a[0],p={lat:parseFloat(f.lat),lng:parseFloat(f.lon)};if(!isNaN(p.lat)&&!isNaN(p.lng))return console.log(` Geocoded "${e}" (via "${l}")  ${p.lat.toFixed(4)}, ${p.lng.toFixed(4)}`),Tn.set(n,p),jc(),p}await new Promise(f=>setTimeout(f,100))}}return console.warn(` Could not geocode: "${e}" (tried: ${s.join(" | ")})`),Tn.set(n,null),jc(),null}catch(s){return console.error(` Geocoding error for "${e}":`,s.message),Tn.set(n,null),jc(),null}}async function bj(e,t=500){if(!Array.isArray(e)||e.length===0)return console.warn(" geocodeAddressesBatch: Empty or invalid items array"),new Map;const n=new Map;let s=0;for(const a of e){const l=a.address||a.Address||"",c=a.city||"Vietnam";if(!l){console.warn(` Station ${a.id}: No address found - skipping geocoding`),n.set(a.id,null);continue}const u=await Pj(l,c);u&&s++,n.set(a.id,u),e.indexOf(a)<e.length-1&&await new Promise(f=>setTimeout(f,t))}return console.log(` Batch geocoding complete: ${s}/${e.length} stations geocoded`),n}function Ij(){var e;return{size:Tn.size,entries:Array.from(Tn.entries()),storageSize:((e=localStorage.getItem(Lu))==null?void 0:e.length)||0}}function Lj(e,t="Vietnam"){const n=`${e}|${t}`;return Tn.get(n)||null}delete ba.Icon.Default.prototype._getIconUrl;ba.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const Ej=new ba.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Tj=new ba.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Bj=new ba.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-40],shadowSize:[41,41]});function Rj({stations:e,userLocation:t}){const n=wj();return y.useEffect(()=>{if(!(!t||!n))try{const s=setTimeout(()=>{n&&n._container&&n.setView([t.lat,t.lng],14,{animate:!0,duration:1})},100);return()=>clearTimeout(s)}catch(s){console.warn(" Error setting map view:",s.message)}},[n,t]),null}function Aj({isOpen:e,onClose:t,stations:n,onSelectStation:s,selectedStationId:a,userLocation:l}){const[c,u]=y.useState(0),[f,p]=y.useState(new Map),[g,x]=y.useState(null),[j,k]=y.useState(!1);if(y.useEffect(()=>{e&&u(S=>S+1)},[e]),y.useEffect(()=>{if(!e||!n||n.length===0)return;const S=Ij();x(S),console.log(" Geocoding cache stats:",S);const P=new Map;let _=0,v=0;for(const w of n){const b=w.id||w.Id||w.stationId,B=w.address||w.Address||"",T=Lj(B,"Vietnam");T?_++:T===null||v++,P.set(b,T)}console.log(` Using ${_}/${n.length} cached coordinates (${v} never attempted)`),p(P),v>0?k(!0):k(!1)},[e,n]),!e)return null;const C=l||{lat:10.8231,lng:106.6297};return i.jsxs("div",{className:`map-modal ${e?"active":""}`,children:[i.jsxs("div",{className:"map-modal-header",children:[i.jsxs("h3",{children:[i.jsx("i",{className:"fas fa-map-marked-alt"})," Select Location on Map"]}),i.jsx("button",{className:"map-modal-close",onClick:t,children:i.jsx("i",{className:"fas fa-times"})})]}),i.jsx("div",{className:"map-container",children:i.jsxs(Sj,{center:[C.lat,C.lng],zoom:13,style:{height:"100%",width:"100%"},zoomControl:!0,children:[i.jsx(Nj,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),i.jsx(Rj,{stations:n,userLocation:l}),l&&i.jsx(Xh,{position:[l.lat,l.lng],icon:Ej,children:i.jsx(ep,{children:i.jsx("div",{style:{padding:"4px"},children:i.jsx("strong",{children:"Your Location"})})})}),n.map(S=>{const P=S.id||S.Id||S.stationId,_=f.get(P);if(!_)return null;const v=S.stationName||S.name||S.Name||"Unknown Station",w=S.address||S.Address||"",b=P===a;return i.jsx(Xh,{position:[_.lat,_.lng],icon:b?Bj:Tj,children:i.jsx(ep,{children:i.jsxs("div",{style:{padding:"8px",minWidth:"200px"},children:[i.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#333"},children:v}),i.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#666"},children:w}),i.jsx("button",{onClick:()=>s(P,v,w),style:{background:"#ff6b35",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",width:"100%"},children:b?" Selected":"Select Location"})]})})},P)})]},c)}),i.jsx("div",{className:"map-modal-footer",children:i.jsxs("p",{children:[i.jsx("i",{className:"fas fa-info-circle"})," Click on a marker to select a station"]})})]})}function ay({isOpen:e,onClose:t,stations:n=[],userLocation:s=null,onSearch:a,currentSearchData:l=null}){const[c,u]=y.useState(!1),[f,p]=y.useState(()=>{if(l)return{location:l.location||"",locationName:l.locationName||"Select location",pickupDate:l.pickupDate||new Date().toISOString().split("T")[0],pickupTime:l.pickupTime||"15:00",returnDate:l.returnDate||new Date(new Date().getTime()+24*60*60*1e3).toISOString().split("T")[0],returnTime:l.returnTime||"19:00",calendarMode:null,currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear()};const R=new Date,O=new Date(R.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:R.toISOString().split("T")[0],pickupTime:"15:00",returnDate:O.toISOString().split("T")[0],returnTime:"19:00",calendarMode:null,currentMonth:R.getMonth(),currentYear:R.getFullYear()}}),[g,x]=y.useState(""),j=Array.from({length:18},(R,O)=>`${(6+O).toString().padStart(2,"0")}:00`);y.useEffect(()=>{B()},[f.pickupDate,f.pickupTime,f.returnDate,f.returnTime]),y.useEffect(()=>{if(e){const R=document.querySelector(".search-modal-body");R&&(R.scrollTop=0)}},[e]),y.useEffect(()=>{e&&l&&p(R=>({...R,location:l.location||"",locationName:l.locationName||"Select location",pickupDate:l.pickupDate||R.pickupDate,pickupTime:l.pickupTime||"15:00",returnDate:l.returnDate||R.returnDate,returnTime:l.returnTime||"19:00"}))},[e,l]);function k(){u(!1),t()}function C(){u(!0)}function S(R,O,I){p(D=>({...D,location:R,locationName:O})),u(!1)}function P(R){p(O=>({...O,calendarMode:O.calendarMode===R?null:R}))}function _(R){const O=`${R}-time`;p(I=>({...I,calendarMode:I.calendarMode===O?null:O}))}function v(R){p(O=>{let I=O.currentMonth+R,D=O.currentYear;return I>11&&(I=0,D++),I<0&&(I=11,D--),{...O,currentMonth:I,currentYear:D}})}function w(R){p(O=>{const I={...O};if(O.calendarMode==="pickup"){I.pickupDate=R;const D=new Date(`${R}T${O.pickupTime}`);if(new Date(`${O.returnDate}T${O.returnTime}`)<=D){I.returnDate=R;const te=parseInt(O.pickupTime.split(":")[0]),G=Math.min(te+2,23);I.returnTime=`${G.toString().padStart(2,"0")}:00`}}else I.returnDate=R;return I.calendarMode=null,I})}function b(R,O){p(I=>({...I,[R+"Time"]:O,calendarMode:null}))}function B(){try{const R=new Date(`${f.pickupDate}T${f.pickupTime}`),I=new Date(`${f.returnDate}T${f.returnTime}`)-R,D=Math.floor(I/(1e3*60*60));if(D<0)return x("Invalid duration");if(D===0)return x("Less than 1 hour");const q=Math.floor(D/24),te=D%24;let G="";q>0&&(G+=`${q} day${q>1?"s":""} `),te>0&&(G+=`${te} hour${te>1?"s":""}`),x(G.trim()||"0 hours")}catch{x("")}}function T(){if(!f.location){alert("Please select a pick-up location");return}const R=new Date(`${f.pickupDate}T${f.pickupTime}`),O=new Date(`${f.returnDate}T${f.returnTime}`);if(O<=R){alert("Return date and time must be after pick-up date and time.");return}if((O-R)/(1e3*60*60)<1){alert("Minimum rental duration is 1 hour.");return}a&&a(f)}function F(){const R=new Date(f.currentYear,f.currentMonth,1),O=new Date(f.currentYear,f.currentMonth+1,0),I=new Date;I.setHours(0,0,0,0);const D=[];for(let q=0;q<R.getDay();q++)D.push(i.jsx("div",{className:"calendar-day"},`empty-${q}`));for(let q=1;q<=O.getDate();q++){const te=`${f.currentYear}-${(f.currentMonth+1).toString().padStart(2,"0")}-${q.toString().padStart(2,"0")}`,G=new Date(f.currentYear,f.currentMonth,q),E=G.toDateString()===I.toDateString(),oe=G<I,Ne=te===(f.calendarMode==="pickup"?f.pickupDate:f.returnDate),W=["calendar-day"];oe&&W.push("disabled"),E&&W.push("today"),Ne&&W.push("selected"),D.push(i.jsx("div",{className:W.join(" "),onClick:()=>{oe||w(te)},children:q},te))}return D}return e?i.jsxs(i.Fragment,{children:[!c&&i.jsx("div",{className:"search-modal-backdrop",onClick:k}),i.jsx(Aj,{isOpen:c,onClose:()=>u(!1),stations:n,onSelectStation:S,selectedStationId:f.location,userLocation:s}),i.jsx("div",{className:`search-modal ${e?"active":""} ${c?"with-map":""}`,children:i.jsxs("div",{className:"search-modal-content",children:[i.jsxs("div",{className:"search-modal-header",children:[i.jsx("h3",{children:"Search Cars"}),i.jsx("button",{className:"search-modal-close",onClick:k,children:""})]}),i.jsxs("div",{className:"search-modal-body",children:[i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),i.jsxs("div",{className:"search-input",onClick:C,children:[i.jsx("i",{className:"fas fa-map-marker-alt"}),i.jsx("span",{children:f.locationName})]})]}),i.jsxs("div",{className:"search-field-row",children:[i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),i.jsxs("div",{className:"search-input",onClick:()=>P("pickup"),children:[i.jsx("i",{className:"fas fa-calendar"}),i.jsx("span",{children:new Date(f.pickupDate).toLocaleDateString()})]}),f.calendarMode==="pickup"&&i.jsxs("div",{className:"calendar-dropdown active",children:[i.jsxs("div",{className:"calendar-header",children:[i.jsx("button",{onClick:()=>v(-1),children:"<"}),i.jsx("span",{children:new Date(f.currentYear,f.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:()=>v(1),children:">"})]}),i.jsxs("div",{className:"calendar-weekdays",children:[i.jsx("div",{children:"Sun"}),i.jsx("div",{children:"Mon"}),i.jsx("div",{children:"Tue"}),i.jsx("div",{children:"Wed"}),i.jsx("div",{children:"Thu"}),i.jsx("div",{children:"Fri"}),i.jsx("div",{children:"Sat"})]}),i.jsx("div",{className:"calendar-days",children:F()})]})]}),i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),i.jsxs("div",{className:"search-input",onClick:()=>_("pickup"),children:[i.jsx("i",{className:"fas fa-clock"}),i.jsx("span",{children:f.pickupTime})]}),i.jsxs("div",{className:`time-picker-dropdown ${f.calendarMode==="pickup-time"?"active":""}`,children:[i.jsx("div",{className:"time-picker-label",children:"Choose pick-up time"}),i.jsx("div",{className:"time-picker-options",children:j.map(R=>i.jsx("div",{className:`time-option ${R===f.pickupTime?"selected":""}`,onClick:()=>b("pickup",R),children:R},R))})]})]})]}),i.jsxs("div",{className:"search-field-row",children:[i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),i.jsxs("div",{className:"search-input",onClick:()=>P("return"),children:[i.jsx("i",{className:"fas fa-calendar-check"}),i.jsx("span",{children:new Date(f.returnDate).toLocaleDateString()})]}),f.calendarMode==="return"&&i.jsxs("div",{className:"calendar-dropdown active",children:[i.jsxs("div",{className:"calendar-header",children:[i.jsx("button",{onClick:()=>v(-1),children:"<"}),i.jsx("span",{children:new Date(f.currentYear,f.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:()=>v(1),children:">"})]}),i.jsxs("div",{className:"calendar-weekdays",children:[i.jsx("div",{children:"Sun"}),i.jsx("div",{children:"Mon"}),i.jsx("div",{children:"Tue"}),i.jsx("div",{children:"Wed"}),i.jsx("div",{children:"Thu"}),i.jsx("div",{children:"Fri"}),i.jsx("div",{children:"Sat"})]}),i.jsx("div",{className:"calendar-days",children:F()})]})]}),i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-clock"})," Return Time"]}),i.jsxs("div",{className:"search-input",onClick:()=>_("return"),children:[i.jsx("i",{className:"fas fa-clock"}),i.jsx("span",{children:f.returnTime})]}),i.jsxs("div",{className:`time-picker-dropdown ${f.calendarMode==="return-time"?"active":""}`,children:[i.jsx("div",{className:"time-picker-label",children:"Choose return time"}),i.jsx("div",{className:"time-picker-options",children:j.map(R=>i.jsx("div",{className:`time-option ${R===f.returnTime?"selected":""}`,onClick:()=>b("return",R),children:R},R))})]})]})]}),i.jsxs("div",{className:"rental-duration",children:[i.jsx("i",{className:"fas fa-info-circle"}),i.jsxs("div",{children:[i.jsx("strong",{children:"Rental Duration"}),i.jsx("p",{children:g})]})]}),i.jsxs("div",{className:"rental-warning",children:[i.jsx("i",{className:"fas fa-exclamation-circle"}),i.jsx("p",{children:"Minimum rental duration is 1 hour. Same-day rentals are available. To ensure cars are properly prepared and meet environmental standards, please book at least 2 hours in advance."})]}),i.jsxs("button",{className:"btn-search-submit",onClick:T,children:[i.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})]})})]}):null}function Fj(){const[e,t]=y.useState([]),[n,s]=y.useState([]),[a,l]=y.useState(!0),[c,u]=y.useState(0),f=y.useRef(null),[p,g]=y.useState(null),[x,j]=y.useState(!1),[k,C]=y.useState(0),S=["/Picture/E car 1.jpg","/Picture/E car 3.png","/Picture/E car 2.png"],P=y.useRef(null),{showToast:_}=Cu();y.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(R=>{const O=R.coords.accuracy;g({lat:R.coords.latitude,lng:R.coords.longitude}),console.log(" User location:",R.coords.latitude,R.coords.longitude),console.log(" Accuracy:",O,"meters"),O>100&&console.warn(" Location accuracy is low (>"+O+"m). Position may not be precise.")},R=>{console.error(" Could not get user location:",R.message),g({lat:10.8231,lng:106.6297}),_("Could not detect your location. Using default location.","warning",3e3)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.warn("Geolocation is not supported by this browser"),g({lat:10.8231,lng:106.6297}),_("Your browser does not support geolocation","warning",3e3));const T=async()=>{try{if(!Nd.getAllStations){console.warn("stationApi.getAllStations not available");return}const R=await Nd.getAllStations(1,500);console.log(" Loaded stations in HomePage:",R.length,"items"),t(R||[]),R&&R.length>0&&(console.log(" Geocoding all stations in background..."),bj(R,300))}catch(R){console.error("Failed to load stations",R)}},F=async()=>{try{if(!ot.getAllCars){console.warn("carApi.getAllCars not available"),l(!1);return}l(!0);const R=await ot.getAllCars(1,100);console.log(" Loaded cars in HomePage:",R.length,"items"),s(R||[])}catch(R){console.error("Failed to load cars",R)}finally{l(!1)}};T(),F()},[]),y.useEffect(()=>{if(x)return;const T=setInterval(()=>{C(F=>(F+1)%S.length)},6e3);return()=>clearInterval(T)},[S.length,x]),y.useEffect(()=>{const T=f.current;if(!T)return;const F=T.querySelector(".car-card-item");if(!F)return;const R=F.offsetWidth,I=c*(R+20);T.style.transform=`translateX(-${I}px)`},[c,n]),y.useEffect(()=>{const T=()=>{const F=P.current;if(!F)return;const R=document.querySelector(".header"),O=R?R.offsetHeight:80;window.scrollY>O+50?(F.classList.add("sticky"),F.style.top=`${O}px`):(F.classList.remove("sticky"),F.style.top="")};return window.addEventListener("scroll",T,{passive:!0}),T(),()=>window.removeEventListener("scroll",T)},[]);function v(){j(!0)}function w(){j(!1)}function b(T){const F={stationId:T.location,stationName:T.locationName,pickupDate:T.pickupDate,pickupTime:T.pickupTime,returnDate:T.returnDate,returnTime:T.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(F))}catch{}const R=new URLSearchParams({location:T.location,"pickup-date":T.pickupDate,"pickup-time":T.pickupTime,"return-date":T.returnDate,"return-time":T.returnTime});window.location.href=`/cars?${R.toString()}`}function B(){const T=f.current;if(!T)return;const F=T.querySelector(".car-card-item");if(!F)return;const R=Math.floor(T.parentElement.offsetWidth/(F.offsetWidth+20))||1,O=Math.min(n.length,10),I=Math.max(0,Math.ceil(O-R));u(D=>Math.min(I,D+1))}return i.jsxs("main",{children:[i.jsxs("section",{className:"hero-slideshow",children:[i.jsx("div",{className:"slideshow-container",children:S.map((T,F)=>i.jsx("div",{className:`slide fade ${F===k?"active":""}`,children:i.jsx("img",{src:T,alt:`Electric Car ${F+1}`})},F))}),i.jsx("div",{className:"search-form-overlay",id:"searchFormOverlay",ref:P,children:i.jsx("div",{className:"container",children:i.jsxs("div",{className:"search-form-wrapper",children:[i.jsx("h2",{children:"Find Your Perfect Rental Car"}),i.jsxs("div",{className:"search-summary",children:[i.jsxs("div",{className:"summary-item",onClick:v,children:[i.jsx("div",{className:"summary-label",children:"Pick-up Location"}),i.jsx("div",{className:"summary-value",id:"summaryLocation",children:"Select location"})]}),i.jsxs("div",{className:"summary-item",onClick:v,children:[i.jsx("div",{className:"summary-label",children:"Pick-up Date"}),i.jsx("div",{className:"summary-value",children:new Date().toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:v,children:[i.jsx("div",{className:"summary-label",children:"Pick-up Time"}),i.jsx("div",{className:"summary-value",children:"15:00"})]}),i.jsxs("div",{className:"summary-item",onClick:v,children:[i.jsx("div",{className:"summary-label",children:"Return Date"}),i.jsx("div",{className:"summary-value",children:new Date(Date.now()+24*60*60*1e3).toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:v,children:[i.jsx("div",{className:"summary-label",children:"Return Time"}),i.jsx("div",{className:"summary-value",children:"19:00"})]}),i.jsxs("button",{type:"button",className:"btn-search",onClick:v,children:[i.jsx("i",{className:"fas fa-search"})," SEARCH"]})]})]})})})]}),i.jsx(ay,{isOpen:x,onClose:w,stations:e,userLocation:p,onSearch:b}),i.jsx("section",{className:"car-section","data-type":"models",children:i.jsxs("div",{className:"container",children:[i.jsx("div",{className:"car-section-header",children:i.jsx("h2",{children:"Our Electric Car Models"})}),i.jsxs("div",{className:"car-carousel-wrapper",children:[i.jsx("button",{className:"carousel-nav prev-carousel",onClick:()=>u(T=>Math.max(0,T-1)),children:i.jsx("i",{className:"fas fa-chevron-left"})}),i.jsx("div",{className:"car-carousel-container",id:"carCarouselContainer",children:i.jsxs("div",{className:"car-carousel-inner",id:"carCarouselInner",ref:f,children:[a&&i.jsx("div",{className:"car-card-item loading-placeholder",style:{textAlign:"center",padding:20},children:"Loading cars..."}),!a&&n.slice(0,10).map((T,F)=>{T.id||T.Id||T.carId;const R=T.name||T.Name||T.model||T.modelName||"Unknown",O=T.imageUrl||T.ImageUrl||T.image||"/Picture/E car 1.jpg",I=parseFloat(T.rentalPricePerHour||T.RentalPricePerHour||0),D=T.seats||T.Seats;return i.jsxs("div",{className:"car-card-item",children:[i.jsx("div",{className:"car-image",children:i.jsx("img",{src:O,alt:R,onError:q=>q.currentTarget.src="/Picture/E car 1.jpg"})}),i.jsxs("div",{className:"car-info",children:[i.jsx("h3",{className:"car-name",children:R}),i.jsxs("div",{className:"car-price-simple",children:[i.jsx("span",{className:"price-amount",children:At(I)}),i.jsx("span",{className:"price-label",children:"/hour"})]}),i.jsx("div",{className:"car-specs",children:D?i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-users"})," ",D," Seats"]}):null})]})]},F)})]})}),i.jsx("button",{className:"carousel-nav next-carousel",onClick:()=>B(),children:i.jsx("i",{className:"fas fa-chevron-right"})})]})]})})]})}function Uj(){const[e,t]=y.useState([]),[n,s]=y.useState([]),[a,l]=y.useState(!0),[c,u]=y.useState([]),[f,p]=y.useState({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),[g,x]=y.useState("default"),[j,k]=y.useState(()=>{const I=new Date,D=new Date(I.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:I.toISOString().split("T")[0],pickupTime:"15:00",returnDate:D.toISOString().split("T")[0],returnTime:"19:00"}}),[C,S]=y.useState(!1),[P,_]=y.useState(null);y.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(I=>{_({lat:I.coords.latitude,lng:I.coords.longitude})},I=>{console.error(" Could not get user location:",I.message),_({lat:10.8231,lng:106.6297})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):_({lat:10.8231,lng:106.6297}),v(),w()},[]);const v=async()=>{try{const I=await Nd.getAllStations(1,500);u(I||[])}catch(I){console.error("Failed to load stations",I)}},w=async()=>{try{l(!0);let I=null,D=null;try{const te=JSON.parse(localStorage.getItem("rentalContext")||"null");te&&(I=te.stationId,D=te,k(G=>({...G,location:te.stationId,locationName:te.stationName,pickupDate:te.pickupDate,pickupTime:te.pickupTime,returnDate:te.returnDate,returnTime:te.returnTime})))}catch{}let q=[];if(I&&D){console.log(" Loading cars for station:",I);try{const te=`${D.pickupDate}T${D.pickupTime}:00`,G=`${D.returnDate}T${D.returnTime}:00`;console.log(" Pickup DateTime (local):",te),console.log(" Return DateTime (local):",G),q=await ot.getAvailableCarsByStation(I,te,G),console.log(" Found",q.length,"cars at this station")}catch(te){console.error("Failed to load cars by station, falling back to all cars",te),q=await ot.getAllCars(1,100)}}else q=await ot.getAllCars(1,100);t(q||[]),s(q||[])}catch(I){console.error(I)}finally{l(!1)}};function b(){S(!0)}function B(){S(!1)}function T(I){k({location:I.location,locationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime});const D={stationId:I.location,stationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(D))}catch{}l(!0);const q=`${I.pickupDate}T${I.pickupTime}:00`,te=`${I.returnDate}T${I.returnTime}:00`;console.log(" Pickup DateTime (local):",q),console.log(" Return DateTime (local):",te),ot.getAvailableCarsByStation(I.location,q,te).then(G=>{t(G||[]),s(G||[]),l(!1),B()}).catch(G=>{console.error("Failed to load station cars:",G),alert("Failed to load cars for this station"),l(!1)})}y.useEffect(()=>{let I=[...e];f.brand&&(I=I.filter(D=>(D.brand||"").toLowerCase().includes(f.brand.toLowerCase()))),f.color&&(I=I.filter(D=>(D.color||"").toLowerCase().includes(f.color.toLowerCase()))),f.seats&&(I=I.filter(D=>D.seats===parseInt(f.seats))),f.year&&(I=I.filter(D=>D.year>=parseInt(f.year))),f.priceMin&&(I=I.filter(D=>parseFloat(D.rentalPricePerHour||0)>=parseFloat(f.priceMin))),f.priceMax&&(I=I.filter(D=>parseFloat(D.rentalPricePerHour||0)<=parseFloat(f.priceMax))),g==="name-asc"?I.sort((D,q)=>{const te=`${D.brand||""} ${D.model||""}`.trim().toLowerCase(),G=`${q.brand||""} ${q.model||""}`.trim().toLowerCase();return te.localeCompare(G)}):g==="name-desc"?I.sort((D,q)=>{const te=`${D.brand||""} ${D.model||""}`.trim().toLowerCase();return`${q.brand||""} ${q.model||""}`.trim().toLowerCase().localeCompare(te)}):g==="price-asc"?I.sort((D,q)=>{const te=parseFloat(D.rentalPricePerHour||D.RentalPricePerHour||0),G=parseFloat(q.rentalPricePerHour||q.RentalPricePerHour||0);return te-G}):g==="price-desc"&&I.sort((D,q)=>{const te=parseFloat(D.rentalPricePerHour||D.RentalPricePerHour||0);return parseFloat(q.rentalPricePerHour||q.RentalPricePerHour||0)-te}),s(I)},[e,f,g]);const F=()=>{p({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),s(e)},R=[...new Set(e.map(I=>I.brand).filter(Boolean))],O=[...new Set(e.map(I=>I.color).filter(Boolean))];return Array.from({length:18},(I,D)=>`${(6+D).toString().padStart(2,"0")}:00`),i.jsxs("main",{className:"car-list-main",children:[i.jsx("div",{className:"search-form-container",children:i.jsxs("div",{className:"search-summary",children:[i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),i.jsx("div",{className:"summary-value",children:j.locationName})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),i.jsx("div",{className:"summary-value",children:new Date(j.pickupDate).toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),i.jsx("div",{className:"summary-value",children:j.pickupTime})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),i.jsx("div",{className:"summary-value",children:new Date(j.returnDate).toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-clock"})," Return Time"]}),i.jsx("div",{className:"summary-value",children:j.returnTime})]}),i.jsxs("button",{className:"btn-search-submit",onClick:b,children:[i.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})}),i.jsxs("div",{className:"container",children:[i.jsxs("aside",{className:"filters-sidebar",children:[i.jsx("h3",{className:"filters-title",children:"Filters"}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Brand"}),i.jsx("div",{className:"filter-group",children:i.jsxs("select",{value:f.brand,onChange:I=>p({...f,brand:I.target.value}),children:[i.jsx("option",{value:"",children:"Any Brand"}),R.map(I=>i.jsx("option",{value:I,children:I},I))]})})]}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Color"}),i.jsx("div",{className:"filter-group",children:i.jsxs("select",{value:f.color,onChange:I=>p({...f,color:I.target.value}),children:[i.jsx("option",{value:"",children:"Any Color"}),O.map(I=>i.jsx("option",{value:I,children:I},I))]})})]}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Specifications"}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Seats"}),i.jsxs("select",{value:f.seats,onChange:I=>p({...f,seats:I.target.value}),children:[i.jsx("option",{value:"",children:"Any"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"5",children:"5"}),i.jsx("option",{value:"7",children:"7"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Year (min)"}),i.jsx("input",{type:"number",min:"1900",max:"2100",placeholder:"2020",value:f.year,onChange:I=>p({...f,year:I.target.value})})]})]}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Price Range"}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Min Price (VND/hour)"}),i.jsx("input",{type:"number",min:"0",placeholder:"0",value:f.priceMin,onChange:I=>p({...f,priceMin:I.target.value})})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Max Price (VND/hour)"}),i.jsx("input",{type:"number",min:"0",placeholder:"999,000",value:f.priceMax,onChange:I=>p({...f,priceMax:I.target.value})})]})]}),i.jsx("div",{className:"filter-actions",children:i.jsx("button",{type:"button",className:"btn-reset-filters",onClick:F,children:"Reset Filters"})})]}),i.jsxs("div",{className:"cars-content",children:[i.jsxs("div",{className:"cars-header",children:[i.jsxs("div",{children:[i.jsx("h2",{children:"Available Cars"}),i.jsxs("div",{className:"cars-count",children:["Showing ",n.length," cars"]})]}),i.jsxs("div",{className:"sort-controls",children:[i.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),i.jsxs("select",{id:"sortBy",value:g,onChange:I=>x(I.target.value),className:"sort-select",children:[i.jsx("option",{value:"default",children:"Default"}),i.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),i.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),i.jsx("option",{value:"price-asc",children:"Price (Low to High)"}),i.jsx("option",{value:"price-desc",children:"Price (High to Low)"})]})]})]}),i.jsxs("div",{className:"car-list",children:[a&&i.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading cars..."}),!a&&n.length===0&&i.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"No cars found"}),!a&&n.map((I,D)=>{const q=I.id||I.Id,te=`${I.brand||""} ${I.model||"Car"}`.trim(),G=I.imageUrl||I.image||"/Picture/E car 1.jpg",E=parseFloat(I.rentalPricePerHour||I.RentalPricePerHour||0),oe=I.seats||I.Seats||5,Ne=I.year||"",W=I.color||"N/A";return i.jsxs("div",{className:"car-card",onClick:()=>window.location.href=`/cars/${q}`,children:[i.jsx("div",{className:"car-image",children:i.jsx("img",{src:G,alt:te,onError:fe=>fe.currentTarget.src="/Picture/E car 1.jpg"})}),i.jsxs("div",{className:"car-info",children:[i.jsxs("div",{className:"car-info-top",children:[i.jsxs("div",{children:[i.jsx("div",{className:"car-name",children:te}),i.jsxs("div",{className:"car-location",children:[i.jsx("i",{className:"fas fa-map-marker-alt"}),j.locationName||"Location"]})]}),i.jsxs("div",{className:"car-pricing",children:[i.jsx("div",{className:"car-price",children:At(E)}),i.jsx("div",{className:"car-price-label",children:"/hour"})]})]}),i.jsxs("div",{className:"car-details",children:[i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-palette"})," ",W]}),i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-calendar"})," ",Ne||"N/A"]}),i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-users"})," ",oe," seats"]})]})]})]},D)})]})]})," "]})," ",i.jsx(ay,{isOpen:C,onClose:B,stations:c,userLocation:P,onSearch:T,currentSearchData:j})]})}function Mj(){const{id:e}=o_(),t=pr(),[n,s]=y.useState(null),[a,l]=y.useState(!0);if(y.useEffect(()=>{e&&(async()=>{try{l(!0);const g=await ot.getCarById(e);s(g)}catch(g){console.error(g)}finally{l(!1)}})()},[e]),a)return i.jsx("main",{className:"car-detail-main",children:i.jsx("div",{className:"container",children:i.jsx("div",{className:"loading-message",children:"Loading..."})})});if(!n)return i.jsx("main",{className:"car-detail-main",children:i.jsx("div",{className:"container",children:i.jsx("div",{className:"error-message",children:"Car not found"})})});const c=n.imageUrl||n.image||"/Picture/E car 1.jpg",u=`${n.brand||""} ${n.model||"Car"}`.trim(),f=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return i.jsx("main",{className:"car-detail-main",children:i.jsxs("div",{className:"container",children:[i.jsxs("button",{className:"back-btn",onClick:()=>t("/cars"),children:[i.jsx("i",{className:"fas fa-arrow-left"})," Back to Cars"]}),i.jsxs("div",{className:"car-detail-grid",children:[i.jsxs("div",{className:"car-left-section",children:[i.jsx("div",{className:"car-image-section",children:i.jsx("div",{className:"main-image",children:i.jsx("img",{src:c,alt:u,onError:p=>p.currentTarget.src="/Picture/E car 1.jpg"})})}),i.jsxs("div",{className:"car-specs",children:[i.jsx("h3",{children:"Car Information"}),i.jsxs("div",{className:"specs-grid",children:[i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-car"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Brand"}),i.jsx("div",{className:"spec-value",children:n.brand||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-palette"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Color"}),i.jsx("div",{className:"spec-value",children:n.color||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-users"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Seats"}),i.jsx("div",{className:"spec-value",children:n.seats||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-calendar"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Year"}),i.jsx("div",{className:"spec-value",children:n.year||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-battery-full"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Battery Range"}),i.jsxs("div",{className:"spec-value",children:[n.batteryCapacity||"N/A"," km"]})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-cog"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Transmission"}),i.jsx("div",{className:"spec-value",children:n.transmission||"Automatic"})]})]})]})]}),n.description&&i.jsxs("div",{className:"car-description",children:[i.jsx("h3",{children:"Description"}),i.jsx("p",{children:n.description||n.Description})]})]}),i.jsx("div",{className:"car-right-section",children:i.jsxs("div",{className:"pricing-card",children:[i.jsxs("div",{className:"car-header",children:[i.jsx("h1",{className:"car-title",children:u}),n.year&&i.jsx("span",{className:"car-year",children:n.year})]}),i.jsxs("div",{className:"price-section",children:[i.jsx("div",{className:"price-label",children:"Rental Price"}),i.jsxs("div",{className:"price-value",children:[At(f),"/hour"]}),i.jsxs("div",{className:"price-note",children:["Estimated daily rate: ",At(Math.round(f*24)),"/day"]})]}),i.jsxs("div",{className:"rental-info",children:[i.jsx("h3",{children:"Rental Details"}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-clock"}),i.jsx("span",{children:"Minimum rental: 1 hour"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-shield-alt"}),i.jsx("span",{children:"Insurance included"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-gas-pump"}),i.jsx("span",{children:"Fuel policy: Same to same"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-map-marked-alt"}),i.jsx("span",{children:"Unlimited mileage"})]})]}),i.jsxs("button",{className:"book-now-btn",onClick:()=>{localStorage.setItem("selectedCarId",n.id||n.Id),t("/payment")},children:[i.jsx("i",{className:"fas fa-check-circle"})," Book Now"]})]})})]})]})})}const $t={createBooking:async(e,t)=>{var n,s,a,l;try{console.log(" Creating booking for user:",t),console.log(" Booking data:",e);const c={carId:e.carId,stationId:e.pickupStationId||e.returnStationId||e.stationId,pickupDateTime:e.pickupDateTime,expectedReturnDateTime:e.expectedReturnDateTime};console.log(" Sending payload:",c);const u=await de.post(`/Bookings/Create-With-Deposit?userId=${encodeURIComponent(t)}`,c);return console.log(" Booking created:",u.data),((n=u.data)==null?void 0:n.data)||u.data||{}}catch(c){throw console.error(" Error creating booking:",((s=c.response)==null?void 0:s.data)||c.message),(l=(a=c.response)==null?void 0:a.data)!=null&&l.errors&&console.error(" Validation errors:",c.response.data.errors),c}},confirmBooking:async(e,t,n="")=>{var s,a;try{console.log(" Confirming booking:",e);const l={bookingId:e,paymentMethod:t,paymentTransactionId:n},c=await de.post("/Bookings/Confirm",l);return console.log(" Booking confirmed:",c.data),((s=c.data)==null?void 0:s.data)||c.data||{}}catch(l){throw console.error(" Error confirming booking:",((a=l.response)==null?void 0:a.data)||l.message),l}},completeBooking:async e=>{var t,n;try{console.log(" Completing booking:",e);const s=await de.post(`/Bookings/Complete-By-${encodeURIComponent(e)}`);return console.log(" Booking completed:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error completing booking:",((n=s.response)==null?void 0:n.data)||s.message),s}},getUserBookings:async e=>{var t;try{console.log(" Fetching bookings for current user");const n=await de.get("/Bookings/My-Bookings");console.log(" Raw /Bookings/My-Bookings response:",n.data);const s=n.data||{};return Array.isArray(s)?(console.log(" Returning bookings (direct array), count:",s.length),s):s.data&&Array.isArray(s.data)?(console.log(" Returning bookings from response.data, count:",s.data.length),s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning bookings from response.data.data, count:",s.data.data.length),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning bookings from response.data.items, count:",s.data.items.length),s.data.items):s.items&&Array.isArray(s.items)?(console.log(" Returning bookings from response.items, count:",s.items.length),s.items):s.bookings&&Array.isArray(s.bookings)?(console.log(" Returning bookings from response.bookings, count:",s.bookings.length),s.bookings):s&&(s.id||s.bookingId||s.bookingStatus)?(console.log(" Response looks like a single booking object, wrapping in array"),[s]):(console.warn(" No bookings array found in /Bookings/My-Bookings response; returning empty array"),[])}catch(n){if(console.error(" Error fetching user bookings:",((t=n.response)==null?void 0:t.data)||n.message),n.response&&n.response.status===401)throw n;return[]}},cancelBooking:async(e,t)=>{var n,s;try{console.log(" Cancelling booking:",e);const a=await de.post(`/Bookings/Cancel-By-${encodeURIComponent(e)}`,null,{params:{userId:t}});return console.log(" Booking cancelled:",a.data),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error cancelling booking:",((s=a.response)==null?void 0:s.data)||a.message),a}},getBookingById:async e=>{var t,n;try{console.log(" Fetching booking details for ID:",e);const s=await de.get(`/Bookings/Get-By-${encodeURIComponent(e)}`);return console.log(" Booking details:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking details:",((n=s.response)==null?void 0:n.data)||s.message),s}}},tp={getContractByBooking:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Booking/${t}`,`/Contract/Get-By-Booking/${t}`,`/Contracts/By-Booking/${t}`,`/contracts/booking/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(u)return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},getContractByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contract/Get-By-Renter/${t}`,`/Contracts/By-Renter/${t}`,`/contracts/renter/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(u)return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},createRentalContract:async(e,t=null,n=null)=>{var c;if(!e)throw new Error("bookingId is required");let s=`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(e)}`;t&&(s+=`&renterId=${encodeURIComponent(t)}`);const a=[{url:s,method:"post",data:n},{url:"/Contracts/Create",method:"post",data:{bookingId:e}},{url:"/Contract/Create",method:"post",data:{bookingId:e}}];let l;for(const u of a)try{const f=await de[u.method](u.url,u.data||{}),p=f==null?void 0:f.data;return p&&typeof p=="object"&&"data"in p?p.data:p}catch(f){l=f;const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}throw l||new Error("Create contract endpoint not found")},sendContractEmail:async(e,t=null)=>{var l,c,u;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e);console.log(" sendContractEmail called with contractId:",e,"email:",t);const s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,"/Contract/SendEmail"];let a;for(const f of s)try{console.log(" Trying endpoint:",f);const p=await de.post(f,t?{email:t}:{}),g=p==null?void 0:p.data;return console.log(" Success on endpoint:",f,"response:",g),g&&typeof g=="object"&&"data"in g?g.data:g}catch(p){console.warn(" Failed on endpoint:",f,"status:",(l=p==null?void 0:p.response)==null?void 0:l.status,"error:",((c=p==null?void 0:p.response)==null?void 0:c.data)||(p==null?void 0:p.message)),a=p;const g=(u=p==null?void 0:p.response)==null?void 0:u.status;if(g&&g!==404&&g!==405)throw p}throw console.error(" All endpoints failed for sendContractEmail"),a||new Error("Send contract email endpoint not found")},isContractConfirmed:async e=>{var s;if(!e)return!1;const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/xac-nhan`,`/Contracts/Get-By-Booking/${t}`,`/Contracts/${t}/Is-Confirmed`,"/Contract/IsConfirmed"];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;return u===!0||(u==null?void 0:u.isConfirmed)===!0||(u==null?void 0:u.IsConfirmed)===!0}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return!1},confirmContractSigning:async e=>{var a;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/ky`,`/Contracts/${t}/Confirm`,"/Contract/ConfirmSigning"];let s;for(const l of n)try{const c=await de.post(l),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){s=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}throw s||new Error("Confirm contract signing endpoint not found")},deleteContract:async e=>{var a;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}`,`/Contracts/${t}`,`/Contract/Delete/${t}`];let s;for(const l of n)try{const c=await de.delete(l),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){s=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}throw s||new Error("Delete contract endpoint not found")},downloadContract:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/${t}/Download`,`/Contract/Download/${t}`];for(const a of n)try{return(await de.get(a,{responseType:"blob"})).data}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Download contract endpoint not found")},getContractDownloadByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const a of n)try{return(await de.get(a,{responseType:"blob"})).data}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Get contract download link endpoint not found")},getContractViewingByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/View/${t}`,`/Contract/View/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null}},Zr={createPayment:async(e,t=0,n="Payment",s=0)=>{var a,l;try{console.log(" Creating payment for booking:",e,"| Type:",t,"| Extra amount:",s);const c={bookingId:e,paymentType:t,description:n};s>0&&(c.extraAmount=s);const u=await de.post("/Payment/create",c);return console.log(" Payment created:",u.data),((a=u.data)==null?void 0:a.data)||u.data||{}}catch(c){throw console.error(" Error creating payment:",((l=c.response)==null?void 0:l.data)||c.message),c}},syncPayment:async e=>{var t,n;try{console.log(" Syncing payment for booking:",e);const s=await de.post(`/Payment/sync/${encodeURIComponent(e)}`);return console.log(" Payment synced:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error syncing payment:",((n=s.response)==null?void 0:n.data)||s.message),s}}};function Oj(){const e=pr(),{showToast:t}=Cu(),[n,s]=y.useState(null),[a,l]=y.useState(null),[c,u]=y.useState(!1),[f,p]=y.useState(!1),[g,x]=y.useState(!1),[j,k]=y.useState(!1),[C,S]=y.useState({isOpen:!1,type:"info",title:"",message:""});y.useEffect(()=>{try{const R=JSON.parse(localStorage.getItem("rentalContext")||"null");if(!R){alert("No rental information found. Please search for a car first."),e("/");return}l(R);const O=localStorage.getItem("selectedCarId");O&&ot.getCarById(O).then(I=>s(I))}catch(R){console.error(R)}},[e]);const P=()=>{if(!a||!n)return 0;const R=new Date(`${a.pickupDate}T${a.pickupTime}`),O=new Date(`${a.returnDate}T${a.returnTime}`),I=Math.ceil((O-R)/(1e3*60*60)),D=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return I*D},_=()=>{if(!a)return 0;const R=new Date(`${a.pickupDate}T${a.pickupTime}`),O=new Date(`${a.returnDate}T${a.returnTime}`);return Math.ceil((O-R)/(1e3*60*60))},v=()=>n?parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0):0,w=()=>P()*.3,b=()=>{const R=new Date,O=String(R.getDate()).padStart(2,"0"),I=String(R.getMonth()+1).padStart(2,"0"),D=R.getFullYear(),q=localStorage.getItem("userFirstName")||"",te=localStorage.getItem("userLastName")||"",G=localStorage.getItem("userDateOfBirth")||"",E=localStorage.getItem("userIdentityNumber")||"",oe=localStorage.getItem("userAddress")||"",Ne=localStorage.getItem("userDriverLicenseClass")||"",W=localStorage.getItem("userDriverLicenseNumber")||"",fe=localStorage.getItem("userDriverLicenseExpiry")||"",re=new Date(`${a.pickupDate}T${a.pickupTime}`),U=new Date(`${a.returnDate}T${a.returnTime}`),ie=Math.ceil((U-re)/(1e3*60*60*24)),Z=P(),se=G?new Date(G).getFullYear().toString():"";return{soHopDong:`H-${R.getTime()}`,ngayKy:O,thangKy:I,namKy:D.toString(),benA:{hoTen:`${q} ${te}`,namSinh:se,cccdHoacHoChieu:E,hoKhauThuongTru:oe},xe:{nhanHieu:n.brand||"",bienSo:n.licensePlate||"",loaiXe:n.model||"",mauSon:n.color||"",choNgoi:(n.seats||0).toString(),xeDangKiHan:(n.year||"").toString()},giaThue:{giaThueSo:Z.toString(),giaThueChu:Z.toString(),phuongThucThanhToan:"Chuyn khon",ngayThanhToan:R.toISOString().split("T")[0]},thoiHanThueSo:ie.toString(),thoiHanThueChu:ie.toString(),thoiHanThue:ie,donViThoiHan:"ngay",gplx:{hang:Ne,so:W,hanSuDung:fe}}},B=async()=>{var R,O;if(!c){alert("Please agree to the Terms and Conditions and Privacy Policy to continue.");return}if(!n||!a){alert("Missing booking information. Please try again.");return}k(!0);try{const I=localStorage.getItem("userId");if(!I){alert("User ID not found. Please logout and login again."),e("/");return}const D=new Date(`${a.pickupDate}T${a.pickupTime}`).toISOString(),q=new Date(`${a.returnDate}T${a.returnTime}`).toISOString(),te=a.stationId;console.log(" Using station from rental context:",a.stationName,"- ID:",te);const G={carId:n.id||n.Id,userId:I,pickupStationId:te,returnStationId:te,pickupDateTime:D,expectedReturnDateTime:q,totalAmount:P()};console.log(" Creating booking with user-selected station..."),console.log(" Booking data:",G);const E=await $t.createBooking(G,I),oe=E.id||E.Id||E.bookingId;if(!oe)throw new Error("Booking ID not received from server");console.log(" Booking created:",oe),console.log(" Creating contract...");const Ne=b(),W=await tp.createRentalContract(oe,I,Ne),fe=(W==null?void 0:W.id)||(W==null?void 0:W.contractId)||W;console.log(" Contract created with ID:",fe),console.log(" Full contract response:",W);try{const re=localStorage.getItem("userEmail");if(re&&fe){console.log(" Waiting 1s before sending email..."),await new Promise(ie=>setTimeout(ie,1e3)),console.log(" Sending contract email to:",re),console.log(" Contract ID being used:",fe);const U=await tp.sendContractEmail(fe,re);console.log(" Email sent, response:",U)}}catch(re){console.warn(" Email failed (non-critical):",re.message),console.error(" Full error:",re)}try{console.log(" Creating deposit payment...");const re=w(),U=await Zr.createPayment(oe,0,"Cc thu xe");console.log(" Payment created:",U)}catch(re){console.warn(" Payment creation failed (non-critical):",re.message)}S({isOpen:!0,type:"success",title:"Booking Created Successfully! ",message:"The contract has been sent to your email. You have 10 minutes to sign the contract and complete the deposit payment before the reservation expires. You can view details in your Booking History."}),setTimeout(()=>{localStorage.removeItem("selectedCarId"),localStorage.removeItem("rentalContext"),e("/booking-history")},3e3)}catch(I){console.error(" Error:",I);const D=((O=(R=I.response)==null?void 0:R.data)==null?void 0:O.message)||I.message||"Failed to create booking";D.toLowerCase().includes("car not available")?(t("This car is not available, please choose another one!","error",4e3),setTimeout(()=>e("/cars"),2e3)):alert(D)}finally{k(!1)}};if(!a||!n)return i.jsx("div",{style:{padding:"2rem"},children:i.jsx("p",{children:"Loading..."})});const T=P(),F=w();return i.jsxs("main",{className:"payment-page",children:[i.jsxs("div",{className:"container",children:[i.jsx("h2",{children:"Confirm Your Reservation"}),i.jsx("div",{className:"payment-layout",children:i.jsxs("div",{className:"payment-info-column",children:[i.jsxs("div",{className:"info-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx("h3",{className:"section-heading",children:"Rental Information"}),i.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Change]"})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Pick-up Location:"}),i.jsx("span",{className:"info-value",children:a.stationName})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Pick-up Date & Time:"}),i.jsxs("span",{className:"info-value",children:[a.pickupDate," ",a.pickupTime]})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Return Date & Time:"}),i.jsxs("span",{className:"info-value",children:[a.returnDate," ",a.returnTime]})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Total Rental Time:"}),i.jsxs("span",{className:"info-value",children:[_()," hour",_()!==1?"s":""]})]})]}),i.jsxs("div",{className:"info-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx("h3",{className:"section-heading",children:"Car Information"}),i.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Pick another car ]"})]}),i.jsxs("div",{className:"car-preview",children:[i.jsx("img",{src:n.imageUrl||n.image||"/Picture/E car 1.jpg",alt:`${n.brand} ${n.model}`,onError:R=>{R.target.src="/Picture/E car 1.jpg"}}),i.jsxs("div",{className:"car-details",children:[i.jsxs("h4",{children:[n.brand," ",n.model]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Color:"})," ",n.color]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Seats:"})," ",n.seats]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Year:"})," ",n.year]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Price:"})," ",At(parseFloat(n.rentalPricePerHour||0)),"/hour"]})]})]})]}),i.jsxs("div",{className:"info-section price-summary-section",children:[i.jsx("h3",{className:"section-heading",children:"Price Summary"}),i.jsxs("div",{className:"price-breakdown",children:[i.jsxs("div",{className:"price-row",children:[i.jsx("span",{className:"price-label",children:"Unit Price:"}),i.jsxs("span",{className:"price-value",children:[i.jsx("span",{className:"price-amount",children:At(v())}),i.jsx("span",{className:"unit",children:"/hour"})]})]}),i.jsxs("div",{className:"price-row",children:[i.jsx("span",{className:"price-label",children:"Rental Time:"}),i.jsxs("span",{className:"price-value",children:[i.jsxs("span",{className:"price-amount",children:[" ",_()]}),i.jsxs("span",{className:"unit",children:[" hour",_()!==1?"s":""]})]})]}),i.jsx("div",{className:"price-divider"}),i.jsxs("div",{className:"price-row total-row",children:[i.jsx("span",{className:"price-label",children:"Total Rental Cost:"}),i.jsx("span",{className:"price-value-total",children:i.jsx("span",{className:"price-amount",children:At(T)})})]}),i.jsxs("div",{className:"price-row deposit-row-summary",children:[i.jsx("span",{className:"price-label",children:"Deposit Required (30%):"}),i.jsx("span",{className:"price-value-deposit",children:i.jsx("span",{className:"price-amount",children:At(F)})})]})]})]})]})}),i.jsx("div",{className:"terms-section",style:{marginTop:"18px"},children:i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:c,onChange:R=>u(R.target.checked)}),i.jsxs("span",{style:{marginLeft:"10px"},children:["I agree to the ",i.jsx("button",{type:"button",className:"link-button",onClick:()=>p(!0),children:"Terms and Conditions"})," and ",i.jsx("button",{type:"button",className:"link-button",onClick:()=>x(!0),children:"Privacy Policy"})]})]})}),i.jsx("div",{className:"cta-button-container",children:i.jsx("button",{className:"btn-confirm-booking",onClick:B,disabled:!c||j,children:j?"Creating...":"Confirm and Deposit"})})]}),i.jsx("div",{className:"page-actions",style:{maxWidth:"980px",margin:"20px auto 60px",padding:"0 1rem"},children:i.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"center"}})}),f&&i.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:i.jsxs("div",{className:"modal-content",onClick:R=>R.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Terms and Conditions"}),i.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsx("h4",{children:"1. Rental Agreement"}),i.jsx("p",{children:"By renting a vehicle from our service, you agree to use the vehicle responsibly and return it in the same condition as received."}),i.jsx("h4",{children:"2. Driver Requirements"}),i.jsx("p",{children:"The driver must be at least 21 years old and possess a valid driver's license for at least 1 year."}),i.jsx("h4",{children:"3. Vehicle Usage"}),i.jsx("p",{children:"The vehicle may only be driven by the person(s) listed on the rental agreement. Unauthorized drivers are prohibited."}),i.jsx("h4",{children:"4. Fuel Policy"}),i.jsx("p",{children:"For electric vehicles, please return the car with at least 70% battery charge. Additional charging fees may apply if returned below this level."}),i.jsx("h4",{children:"5. Damage and Liability"}),i.jsx("p",{children:"The renter is responsible for any damage to the vehicle during the rental period, excluding normal wear and tear."}),i.jsx("h4",{children:"6. Cancellation Policy"}),i.jsx("p",{children:"Cancellations made more than 24 hours before pick-up time will receive a full refund. Cancellations within 24 hours will forfeit the deposit."}),i.jsx("h4",{children:"7. Late Returns"}),i.jsx("p",{children:"Late returns will be charged at 1.5x the hourly rate for each additional hour."}),i.jsx("h4",{children:"8. Insurance"}),i.jsx("p",{children:"Basic insurance is included in the rental price. Additional coverage options are available at checkout."})]})]})}),g&&i.jsx("div",{className:"modal-overlay",onClick:()=>x(!1),children:i.jsxs("div",{className:"modal-content",onClick:R=>R.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Privacy Policy"}),i.jsx("button",{className:"modal-close",onClick:()=>x(!1),children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsx("h4",{children:"1. Information Collection"}),i.jsx("p",{children:"We collect personal information including name, email, phone number, driver's license details, and payment information necessary to process your rental booking."}),i.jsx("h4",{children:"2. Use of Information"}),i.jsx("p",{children:"Your information is used solely for processing rentals, communication regarding your booking, and improving our services."}),i.jsx("h4",{children:"3. Data Security"}),i.jsx("p",{children:"We implement industry-standard security measures to protect your personal information from unauthorized access, disclosure, or misuse."}),i.jsx("h4",{children:"4. Third-Party Sharing"}),i.jsx("p",{children:"We do not sell or share your personal information with third parties except as required for payment processing or legal compliance."}),i.jsx("h4",{children:"5. Cookies"}),i.jsx("p",{children:"Our website uses cookies to enhance user experience and analyze site traffic. You can disable cookies in your browser settings."}),i.jsx("h4",{children:"6. Data Retention"}),i.jsx("p",{children:"We retain your booking information for 7 years as required by law. You may request deletion of your data at any time."}),i.jsx("h4",{children:"7. Your Rights"}),i.jsx("p",{children:"You have the right to access, correct, or delete your personal information. Contact our support team to exercise these rights."}),i.jsx("h4",{children:"8. Contact"}),i.jsx("p",{children:"For privacy concerns or questions, please contact us at privacy@carental.com"})]})]})}),i.jsx(ka,{isOpen:C.isOpen,type:C.type,title:C.title,message:C.message,onClose:()=>S({...C,isOpen:!1})})]})}function Dj(){const e=pr(),[t,n]=y.useState(!0),[s,a]=y.useState(null);return y.useEffect(()=>{console.log(" Payment successful! Checking payment type..."),(async()=>{try{let c=localStorage.getItem("currentBookingId"),u="user-deposit";if(!c&&(c=localStorage.getItem("activeCheckInBookingId"),c)){u="staff-checkin",console.log(" Found check-in booking ID (staff payment):",c),console.log(" Staff check-in payment: Skipping auto-sync (manual sync button will be used)"),n(!1),localStorage.removeItem("activeCheckInBookingId"),setTimeout(()=>e("/staff"),1e3);return}if(!c&&(c=localStorage.getItem("activeCheckOutBookingId"),c)){u="staff-checkout",console.log(" Found check-out booking ID (staff payment):",c),console.log(" Staff check-out payment: Skipping auto-sync (manual sync button will be used)"),n(!1),localStorage.removeItem("activeCheckOutBookingId"),setTimeout(()=>e("/staff"),1e3);return}if(!c){console.warn(" No booking ID found in localStorage"),a("Booking ID not found"),n(!1),setTimeout(()=>e("/booking-history"),2e3);return}console.log(" User deposit payment: Auto-syncing payment for booking:",c),await Zr.syncPayment(c),console.log(" Payment status synced successfully"),console.log(" Fetching booking details to check status...");const f=await $t.getBookingById(c),p=Number((f==null?void 0:f.bookingStatus)||(f==null?void 0:f.BookingStatus));console.log(" Booking status after payment:",p,"(0=Pending, 1=Active, 2=Waiting Check-in, 3=Checked-in, 4=Check-out Pending, 5=Completed)"),n(!1),setTimeout(()=>{try{localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount")}catch(g){console.warn("Failed to clear storage:",g)}console.log(" User deposit payment complete, redirecting to booking history..."),e("/booking-history")},1500)}catch(c){console.error(" Error in payment sync flow:",c),a("Failed to process payment or create contract"),n(!1),setTimeout(()=>e("/booking-history"),3e3)}})()},[e]),i.jsx("main",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:i.jsx("div",{style:{textAlign:"center"},children:t?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),i.jsx("h1",{children:"Processing Payment..."}),i.jsx("p",{style:{color:"#000",marginTop:"8px"},children:"Please wait while we confirm your payment."})]}):s?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),i.jsx("h1",{children:"Payment Sync Issue"}),i.jsx("p",{style:{color:"#000",marginTop:"8px"},children:s}),i.jsx("p",{style:{color:"#000",marginTop:"8px",fontSize:"14px"},children:"Redirecting to booking history..."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),i.jsx("h1",{children:"Payment Successful!"}),i.jsx("p",{style:{color:"#000",marginTop:"8px"},children:"Your payment has been processed."}),i.jsx("p",{style:{color:"#000",marginTop:"8px",fontSize:"14px"},children:"Redirecting to booking history..."})]})})})}function zj(){const e=pr(),{showToast:t}=Cu(),[n]=b_(),[s,a]=y.useState(!0);return y.useEffect(()=>{(async()=>{console.log(" PaymentCancel component mounted!"),console.log(" Current URL:",window.location.href);try{const c=n.get("orderCode"),u=n.get("status"),f=n.get("cancel");if(console.log(" Payment cancelled:",{orderCode:c,status:u,cancel:f}),f==="true"&&u==="CANCELLED"){const p=localStorage.getItem("currentBookingId");p?(console.log(" Payment cancelled for booking:",p),console.log(" Payment session cleared - booking status unchanged"),localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),t("Payment cancelled. You can retry payment from your booking history.","info",3e3)):(console.warn(" No booking ID found in localStorage"),t("Payment cancelled.","info",3e3)),setTimeout(()=>{e("/booking-history")},2e3)}else t("Invalid payment cancellation.","error",3e3),setTimeout(()=>{e("/booking-history")},1500)}catch(c){console.error(" Error handling payment cancellation:",c),t("An error occurred. Redirecting to home...","error",3e3),setTimeout(()=>{e("/")},2e3)}finally{a(!1)}})()},[n,e,t]),i.jsx("main",{style:{minHeight:"60vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:i.jsx("div",{style:{textAlign:"center",maxWidth:"500px",padding:"2rem",background:"#f8f9fa",borderRadius:"8px"},children:s?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",color:"#ffc107",marginBottom:"1rem"},children:""}),i.jsx("h2",{style:{marginBottom:"1rem"},children:"Processing Cancellation..."}),i.jsx("p",{style:{color:"#000"},children:"Clearing payment session. You can retry payment later."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",color:"#6c757d",marginBottom:"1rem"},children:""}),i.jsx("h2",{style:{marginBottom:"1rem"},children:"Payment Cancelled"}),i.jsx("p",{style:{color:"#000",marginBottom:"1rem"},children:"Your payment has been cancelled. Your booking is still active and you can retry payment anytime."}),i.jsx("p",{style:{color:"#000",fontSize:"0.9rem"},children:"Redirecting to booking history..."})]})})})}const $j=()=>{const e=pr(),t=wa(),[n,s]=y.useState(10),[a,l]=y.useState(!1),[c,u]=y.useState(!1),{bookingId:f,depositAmount:p,totalAmount:g,carInfo:x,rentalInfo:j}=t.state||{};y.useEffect(()=>{if(!f){e("/payment");return}const C=setInterval(()=>{s(S=>S<=1?(clearInterval(C),k(),0):S-1)},1e3);return()=>clearInterval(C)},[f]);const k=async()=>{l(!0);try{await new Promise(C=>setTimeout(C,1e3)),console.log(" Payment simulation completed for booking:",f),console.log("  Booking is in Pending status. Admin will confirm after payment verification."),u(!0),setTimeout(()=>{e("/booking-history")},2e3)}catch(C){console.error("Error in payment flow:",C),alert("An error occurred. Redirecting to booking history..."),e("/booking-history")}finally{l(!1)}};return f?i.jsx("main",{className:"transaction-page",children:i.jsx("div",{className:"container",children:i.jsx("div",{className:"transaction-content",children:c?i.jsxs("div",{className:"success-section",children:[i.jsx("div",{className:"success-icon",children:i.jsx("i",{className:"fas fa-check-circle"})}),i.jsx("h2",{children:"Booking Created Successfully!"}),i.jsx("p",{children:"Your booking is pending payment confirmation."}),i.jsxs("p",{style:{fontSize:"0.95rem",color:"#666",margin:"1rem 0"},children:["Booking ID: ",i.jsx("strong",{children:f})]}),i.jsx("p",{className:"redirect-text",children:"Redirecting to booking history..."})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"transaction-header",children:[i.jsx("div",{className:"icon-circle",children:i.jsx("i",{className:"fas fa-credit-card"})}),i.jsx("h2",{children:"Complete Your Payment"}),i.jsxs("p",{className:"booking-id",children:["Booking ID: ",i.jsx("span",{children:f})]})]}),i.jsxs("div",{className:"payment-layout",children:[i.jsxs("div",{className:"qr-section",children:[i.jsx("h3",{children:"Scan QR Code to Pay"}),i.jsxs("div",{className:"qr-placeholder",children:[i.jsx("i",{className:"fas fa-qrcode"}),i.jsx("p",{children:"QR Code Here"})]}),i.jsxs("div",{className:"payment-instructions",children:[i.jsx("h4",{children:"Payment Instructions:"}),i.jsxs("ol",{children:[i.jsx("li",{children:"Open your banking app"}),i.jsx("li",{children:"Scan the QR code above"}),i.jsx("li",{children:"Confirm the payment amount"}),i.jsx("li",{children:"Complete the transaction"})]})]})]}),i.jsxs("div",{className:"payment-details",children:[i.jsx("h3",{children:"Payment Details"}),i.jsxs("div",{className:"detail-card",children:[i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Deposit Amount:"}),i.jsx("span",{className:"value highlight",children:At(p)})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Total Rental Cost:"}),i.jsx("span",{className:"value",children:At(g)})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Remaining Balance:"}),i.jsx("span",{className:"value",children:At((g||0)-(p||0))})]})]}),x&&i.jsxs("div",{className:"detail-card",children:[i.jsxs("h4",{children:[i.jsx("i",{className:"fas fa-car"})," Vehicle"]}),i.jsx("p",{children:i.jsxs("strong",{children:[x.brand," ",x.model]})}),i.jsxs("p",{children:[x.color,"  ",x.seats," seats  ",x.year]})]}),j&&i.jsxs("div",{className:"detail-card",children:[i.jsxs("h4",{children:[i.jsx("i",{className:"fas fa-calendar-alt"})," Rental Period"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Pick-up:"})," ",j.pickupDate," ",j.pickupTime]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Return:"})," ",j.returnDate," ",j.returnTime]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Location:"})," ",j.stationName]})]}),i.jsxs("div",{className:"countdown-section",children:[i.jsxs("div",{className:"countdown-circle",children:[i.jsx("span",{className:"countdown-number",children:n}),i.jsx("span",{className:"countdown-label",children:"seconds"})]}),i.jsx("p",{className:"countdown-text",children:a?"Processing payment...":"Simulating payment completion in..."})]}),i.jsxs("div",{className:"info-box",children:[i.jsx("i",{className:"fas fa-info-circle"}),i.jsxs("p",{children:["This is a demo. Your booking will be created in ",i.jsx("strong",{children:"Pending"})," status. Admin will confirm after receiving payment. Payment simulation completes after ",n," second",n!==1?"s":"","."]})]})]})]})]})})})}):null},np={createFeedback:async(e,t)=>{var n,s;try{console.log(" Creating feedback for user:",e),console.log(" Feedback data:",t);const a=await de.post(`/Feedback/Create-By-User/${encodeURIComponent(e)}`,t);return console.log(" Feedback created:",a.data),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error creating feedback:",((s=a.response)==null?void 0:s.data)||a.message),a}},updateFeedback:async(e,t,n)=>{var s,a;try{console.log(" Updating feedback:",e),console.log(" Updated data:",n);const l=await de.put(`/Feedback/Update-By-${encodeURIComponent(e)}`,n,{params:{userId:t}});return console.log(" Feedback updated:",l.data),((s=l.data)==null?void 0:s.data)||l.data||{}}catch(l){throw console.error(" Error updating feedback:",((a=l.response)==null?void 0:a.data)||l.message),l}}};function Wj(){const e=pr(),[t,n]=y.useState([]),[s,a]=y.useState([]),[l,c]=y.useState(!0),[u,f]=y.useState(""),[p,g]=y.useState(""),[x,j]=y.useState("newest"),[k,C]=y.useState(null),[S,P]=y.useState(!1),[_,v]=y.useState(!1),[w,b]=y.useState({bookingId:"",carId:"",rating:5,comment:""}),[B,T]=y.useState(!1),[F,R]=y.useState(null),[O,I]=y.useState({isOpen:!1,type:"info",title:"",message:""}),[D,q]=y.useState(!1);y.useEffect(()=>{te()},[]),y.useEffect(()=>{G()},[t,p,x]);const te=async()=>{try{c(!0),f("");const U=localStorage.getItem("token");if(!U||U==="null"){console.warn("No auth token found in localStorage"),n([]),f("You are not signed in. Please sign in to view your bookings.");return}const ie=await $t.getUserBookings();console.log(" Bookings loaded - count:",ie==null?void 0:ie.length),console.log(" First booking sample:",ie==null?void 0:ie[0]),console.log(" All bookings:",ie),n(ie||[])}catch(U){if(console.error("Error loading bookings:",U),U&&U.response&&U.response.status===401){f("Session expired or unauthorized. Please sign in again."),n([]);return}f("Failed to load bookings. Please try again later.")}finally{c(!1)}},G=()=>{let U=[...t];p&&(U=U.filter(ie=>String(ie.bookingStatus)===p)),U.sort((ie,Z)=>{switch(x){case"oldest":return new Date(ie.createdAt)-new Date(Z.createdAt);case"price-high":return(Z.totalAmount||0)-(ie.totalAmount||0);case"price-low":return(ie.totalAmount||0)-(Z.totalAmount||0);default:return new Date(Z.createdAt)-new Date(ie.createdAt)}}),a(U)},E=U=>{const ie={0:{text:"Pending",class:"status-pending"},1:{text:"Active",class:"status-active"},2:{text:"Waiting for check-in",class:"status-waiting-check-in"},3:{text:"Checked-in",class:"status-checked-in"},4:{text:"Check-out pending",class:"status-check-out-pending"},5:{text:"Completed",class:"status-completed"},6:{text:"Cancelled pending refund",class:"status-cancelled-pending-refund"},7:{text:"Cancelled",class:"status-cancelled"}},Z=Number(U);return Number.isNaN(Z)||!(Z in ie)?(console.warn(" Unknown booking status:",U,"type:",typeof U),ie[0]):ie[Z]},oe=U=>{if(!U)return"N/A";try{const ie=new Date(U);return isNaN(ie.getTime())?U:ie.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return U}},Ne=async(U,ie)=>{ie&&(ie.preventDefault(),ie.stopPropagation());const Z=U.id||U.bookingId||U.bookingIdString;if(!Z){alert("Cannot cancel: Booking ID not found");return}if(Number(U.bookingStatus)===7){alert("This booking has already been cancelled.");return}if(window.confirm(`Are you sure you want to cancel booking for "${U.carInfo||"this car"}"?`))try{const ne=localStorage.getItem("userId");if(!ne){alert("User ID not found. Please login again.");return}console.log(" Cancelling booking:",Z,"for user:",ne),await $t.cancelBooking(Z,ne),alert("Booking cancelled successfully!"),te()}catch(ne){console.error(" Error cancelling booking:",ne),alert("Failed to cancel booking. Please try again.")}},W=async(U,ie)=>{var se,ne,ce,ke,we;ie&&(ie.preventDefault(),ie.stopPropagation());const Z=U.id||U.bookingId||U.bookingIdString;if(!Z){alert("Booking ID not found");return}q(!0);try{console.log(" Creating deposit payment for booking:",Z);const he=await Zr.createPayment(Z),Ve=he.checkoutUrl||((se=he.data)==null?void 0:se.checkoutUrl);if(!Ve)throw new Error("No checkout URL received");localStorage.setItem("currentBookingId",Z),console.log(" Redirecting to PayOS:",Ve),window.location.href=Ve}catch(he){console.error(" Error initiating payment:",he);let Ve=((ce=(ne=he.response)==null?void 0:ne.data)==null?void 0:ce.message)||he.message||"Failed to initiate payment";(((we=(ke=he.response)==null?void 0:ke.data)==null?void 0:we.errors)||[]).some(qe=>typeof qe=="string"&&qe.toLowerCase().includes("contract"))?(Ve="Contract not found or not confirmed for this booking",I({isOpen:!0,type:"error",title:" Contract Required",message:"Please wait for the contract to be confirmed. Check your email for the contract document and ensure it has been processed."})):I({isOpen:!0,type:"error",title:"Payment Error",message:Ve})}finally{q(!1)}},fe=(U,ie)=>{var ne,ce;if(ie&&(ie.preventDefault(),ie.stopPropagation()),_){console.log(" Modal already open, ignoring click");return}console.log(" Opening feedback modal for booking:",U);const Z=U.id||U.bookingId||U.bookingIdString||"",se=U.carId||((ne=U.car)==null?void 0:ne.id)||((ce=U.car)==null?void 0:ce.carId)||"";if(!Z){alert("Cannot create feedback: Booking ID not found.");return}if(!se){alert("Cannot create feedback: Car ID not found in booking data. Please contact support.");return}U.feedbackId?(T(!0),R(U.feedbackId),b({bookingId:Z,carId:se,rating:U.feedbackRating||5,comment:U.feedbackComment||""})):(T(!1),R(null),b({bookingId:Z,carId:se,rating:5,comment:""})),C(U),v(!0)},re=async()=>{try{const U=localStorage.getItem("userId");if(!U){alert("User ID not found. Please login again.");return}if(!w.carId){alert("Car ID not found for this booking.");return}if(!w.comment.trim()){alert("Please enter your feedback comment.");return}console.log(" Submitting feedback:",w),B&&F?(await np.updateFeedback(F,U,w),alert("Feedback updated successfully!")):(await np.createFeedback(U,w),alert("Feedback submitted successfully!")),v(!1),b({bookingId:"",carId:"",rating:5,comment:""}),T(!1),R(null),te()}catch(U){console.error(" Error submitting feedback:",U),alert("Failed to submit feedback. Please try again.")}};return i.jsxs("main",{className:"main-content",children:[i.jsxs("div",{className:"container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("i",{className:"fas fa-history"}),i.jsxs("div",{className:"page-header-text",children:[i.jsx("h1",{children:"Booking History"}),i.jsx("p",{style:{color:"white"},children:"Manage all your car rentals"})]})]}),i.jsxs("div",{className:"filters-section",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Status:"}),i.jsxs("select",{value:p,onChange:U=>g(U.target.value),children:[i.jsx("option",{value:"",children:"All"}),i.jsx("option",{value:"0",children:"Pending"}),i.jsx("option",{value:"1",children:"Active"}),i.jsx("option",{value:"2",children:"Waiting for check-in"}),i.jsx("option",{value:"3",children:"Checked-in"}),i.jsx("option",{value:"4",children:"Checked-out pending"}),i.jsx("option",{value:"5",children:"Completed"}),i.jsx("option",{value:"6",children:"Cancelled pending refund"}),i.jsx("option",{value:"7",children:"Cancelled"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Sort By:"}),i.jsxs("select",{value:x,onChange:U=>j(U.target.value),children:[i.jsx("option",{value:"newest",children:"Newest"}),i.jsx("option",{value:"oldest",children:"Oldest"}),i.jsx("option",{value:"price-high",children:"Price (High to Low)"}),i.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),i.jsxs("button",{className:"btn-refresh",onClick:te,children:[i.jsx("i",{className:"fas fa-sync"})," Refresh"]})]}),l&&i.jsxs("div",{className:"loading",children:[i.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading..."]}),!l&&s.length===0&&i.jsxs("div",{className:"empty-state",children:[i.jsx("i",{className:"fas fa-inbox"}),i.jsx("h2",{children:"No Bookings Yet"}),i.jsx("p",{children:"Start booking a car to find your perfect ride"}),i.jsxs("button",{className:"btn btn-primary",onClick:()=>e("/cars"),children:[i.jsx("i",{className:"fas fa-car"})," View Cars"]})]}),!l&&s.length>0&&i.jsx("div",{className:"bookings-list",children:s.map((U,ie)=>{var he,Ve,ht,qe,Ct,ge,ae,ye;console.log(" Booking #"+ie,{id:U.id||U.bookingId,bookingStatus:U.bookingStatus,BookingStatus:U.BookingStatus,statusType:typeof U.bookingStatus,fullBooking:U});const Z=E(U.bookingStatus),se=oe(U.startTime||U.StartTime||U.pickupDateTime||U.PickupDateTime),ne=oe(U.endTime||U.EndTime||U.expectedReturnDateTime||U.ExpectedReturnDateTime),ce=U.carInfo||U.CarInfo||((he=U.car)!=null&&he.brand&&((Ve=U.car)!=null&&Ve.model)?`${U.car.brand} ${U.car.model}`:null)||((ht=U.Car)!=null&&ht.Brand&&((qe=U.Car)!=null&&qe.Model)?`${U.Car.Brand} ${U.Car.Model}`:null)||"Car Rental",ke=U.pickupStationName||U.PickupStationName||U.stationName||U.StationName||((Ct=U.station)==null?void 0:Ct.name)||((ge=U.Station)==null?void 0:ge.Name)||"N/A",we=U.carImage||U.CarImage||((ae=U.car)==null?void 0:ae.imageUrl)||((ye=U.Car)==null?void 0:ye.ImageUrl)||"/Picture/E car 1.jpg";return U.id||U.bookingId||U.bookingIdString,i.jsxs("div",{className:`booking-card-shopee ${Z.class}`,children:[i.jsx("div",{className:"booking-card-header",children:i.jsx("span",{className:`status-badge ${Z.class}`,children:Z.text})}),i.jsxs("div",{className:"booking-card-body",children:[i.jsx("div",{className:"car-image-container",children:i.jsx("img",{src:we,alt:ce,onError:ue=>ue.currentTarget.src="/Picture/E car 1.jpg"})}),i.jsxs("div",{className:"booking-details",children:[i.jsx("h3",{className:"car-name",children:ce}),i.jsxs("div",{className:"booking-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("div",{className:"info-label",children:[i.jsx("i",{className:"fas fa-map-marker-alt"}),"Pick-up Location"]}),i.jsx("div",{className:"info-value",children:ke})]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("div",{className:"info-label",children:[i.jsx("i",{className:"fas fa-calendar-alt"}),"Start Date & Time"]}),i.jsx("div",{className:"info-value",children:se})]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("div",{className:"info-label",children:[i.jsx("i",{className:"fas fa-calendar-check"}),"End Date & Time"]}),i.jsx("div",{className:"info-value",children:ne})]})]})]})]}),i.jsxs("div",{className:"booking-card-footer",children:[i.jsxs("div",{className:"total-price",children:[i.jsx("span",{className:"price-label",children:"Total Amount:"}),i.jsx("span",{className:"price-value",children:At(U.totalAmount||U.TotalAmount||0)})]}),i.jsxs("div",{className:"booking-actions",children:[Number(U.bookingStatus)===0&&i.jsxs("button",{className:"btn btn-deposit",onClick:ue=>W(U,ue),disabled:D,type:"button",children:[i.jsx("i",{className:"fas fa-wallet"})," ",D?"Processing...":"Pay Deposit"]}),Number(U.bookingStatus)===6&&i.jsxs("button",{className:"btn btn-feedback",onClick:ue=>fe(U,ue),type:"button",children:[i.jsx("i",{className:"fas fa-comment"})," ",U.feedbackId?"Edit Feedback":"Feedback"]}),i.jsxs("button",{className:"btn btn-cancel",onClick:ue=>Ne(U,ue),disabled:Number(U.bookingStatus)===7,title:Number(U.bookingStatus)===7?"Already cancelled":"Cancel booking",type:"button",children:[i.jsx("i",{className:"fas fa-times-circle"})," Cancel Booking"]})]})]})]},ie)})})]}),S&&k&&i.jsx("div",{className:"modal-overlay",onClick:()=>P(!1),children:i.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:"Booking Details"}),i.jsx("button",{className:"modal-close",onClick:()=>P(!1),children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsxs("div",{className:"detail-section car-section",children:[i.jsx("div",{className:"section-icon",children:""}),i.jsxs("div",{className:"section-content",children:[i.jsx("h3",{children:k.carInfo||"Car Rental"}),i.jsx("div",{className:"status-row",children:i.jsx("span",{className:`status-badge ${E(k.bookingStatus).class}`,children:E(k.bookingStatus).text})})]})]}),i.jsxs("div",{className:"detail-section datetime-section",children:[i.jsxs("div",{className:"datetime-card pickup",children:[i.jsx("div",{className:"datetime-icon",children:""}),i.jsxs("div",{className:"datetime-info",children:[i.jsx("label",{children:"Pick-up"}),i.jsx("p",{className:"location",children:k.pickupStationName||"N/A"}),i.jsx("p",{className:"time",children:oe(k.startTime||k.pickupDateTime)})]})]}),i.jsx("div",{className:"datetime-arrow",children:""}),i.jsxs("div",{className:"datetime-card return",children:[i.jsx("div",{className:"datetime-icon",children:""}),i.jsxs("div",{className:"datetime-info",children:[i.jsx("label",{children:"Return"}),i.jsx("p",{className:"location",children:k.returnStationName||"N/A"}),i.jsx("p",{className:"time",children:oe(k.endTime||k.expectedReturnDateTime)})]})]})]}),i.jsx("div",{className:"detail-section pricing-section",children:i.jsxs("div",{className:"pricing-grid",children:[i.jsxs("div",{className:"pricing-item",children:[i.jsx("span",{className:"pricing-icon",children:""}),i.jsxs("div",{children:[i.jsx("label",{children:"Hourly Rate"}),i.jsxs("p",{children:[At(k.hourlyRate||0),"/hour"]})]})]}),i.jsxs("div",{className:"pricing-item",children:[i.jsx("span",{className:"pricing-icon",children:""}),i.jsxs("div",{children:[i.jsx("label",{children:"Daily Rate"}),i.jsxs("p",{children:[At(k.dailyRate||0),"/day"]})]})]}),i.jsxs("div",{className:"pricing-item",children:[i.jsx("span",{className:"pricing-icon",children:""}),i.jsxs("div",{children:[i.jsx("label",{children:"Created At"}),i.jsx("p",{children:oe(k.createdAt)})]})]})]})}),i.jsx("div",{className:"detail-section total-section",children:i.jsxs("div",{className:"total-content",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsx("span",{className:"total-amount",children:At(k.totalAmount||0)})]})})]})]})}),_&&i.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:i.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:"We want your opinion!"}),i.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:""})]}),i.jsx("div",{className:"modal-body",children:i.jsxs("div",{className:"feedback-form",children:[i.jsx("div",{className:"form-group",children:i.jsxs("label",{children:["Car: ",(k==null?void 0:k.carInfo)||"N/A"]})}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"rating",children:"Rating"}),i.jsxs("div",{className:"rating-input",children:[[1,2,3,4,5].map(U=>i.jsx("button",{type:"button",className:`star-btn ${w.rating>=U?"active":""}`,onClick:()=>b({...w,rating:U}),children:i.jsx("i",{className:`fas fa-star ${w.rating>=U?"":"far"}`})},U)),i.jsxs("span",{className:"rating-text",children:[w.rating," / 5"]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"comment",children:"Comment"}),i.jsx("textarea",{id:"comment",rows:"5",value:w.comment,onChange:U=>b({...w,comment:U.target.value}),placeholder:"Share your experience with this car..."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"}),i.jsx("button",{className:"btn btn-continue",onClick:re,children:B?"Update":"Continue"})]})]})})]})}),i.jsx(ka,{isOpen:O.isOpen,type:O.type,title:O.title,message:O.message,onClose:()=>I({...O,isOpen:!1})})]})}function Hj(){return i.jsxs("header",{className:"header-bar",children:[i.jsx("div",{className:"header-title",children:"Staff Page"}),i.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function Zj({onSelect:e,isOpen:t,toggleSidebar:n}){return y.useEffect(()=>{t?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[t]),i.jsxs(i.Fragment,{children:[t&&i.jsx("div",{className:"sidebar-collider",onClick:n}),i.jsxs("div",{className:`sidebar ${t?"active":""}`,children:[i.jsx("h2",{children:"FEC Staff"}),i.jsx("div",{style:{marginTop:"60px"}}),i.jsxs("button",{onClick:()=>e("booking"),children:[i.jsx("i",{className:"fas fa-calendar-alt"})," Booking"]}),i.jsxs("button",{onClick:()=>e("vehicle"),children:[i.jsx("i",{className:"fas fa-car"})," Vehicle"]}),i.jsxs("button",{onClick:()=>e("incident"),children:[i.jsx("i",{className:"fas fa-exclamation-triangle"})," Incident"]}),i.jsxs("button",{onClick:()=>e("profile"),children:[i.jsx("i",{className:"fas fa-user-circle"})," Profile"]})]})]})}const oy=()=>'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2"><path d="M3 9l1-3h16l1 3M3 9v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9M3 9h18M7 13a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/></svg>',jl=e=>{e&&(e.style.objectFit="contain",e.style.backgroundColor="#f0f0f0",e.src=oy())},Sl=e=>!e||typeof e=="string"&&e.trim()===""?oy():e;function Vj({booking:e,onClick:t}){let n="booking-status-chip ";e.status==="booked"?n+="booking-status-booked":e.status==="pending"?n+="booking-status-pending":e.status==="waiting-checkin"?n+="booking-status-waiting-checkin":e.status==="checked-in"?n+="booking-status-checkedin":e.status==="checkout-pending"?n+="booking-status-checkout-pending":e.status==="completed"?n+="booking-status-completed":e.status==="cancelled-pending"?n+="booking-status-cancelled-pending":e.status==="cancelled"?n+="booking-status-cancelled":(n+="booking-status-unknown",console.warn(" BookingCard: Unknown status value:",e.status,"Full booking:",e));const s=a=>{jl(a.currentTarget)};return i.jsxs("div",{className:"booking-card",onClick:t,children:[i.jsx("img",{src:Sl(e.img),alt:e.title,onError:s}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),i.jsx("div",{className:n,children:e.statusLabel||(e.status?e.status.toUpperCase():"UNKNOWN")})]})}function qj({booking:e,onClick:t}){const n="booking-status-chip booking-status-pending",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"",a=l=>{jl(l.currentTarget)};return i.jsxs("div",{className:"booking-card waiting-payment",onClick:t,children:[i.jsx("img",{src:Sl(e.img),alt:e.title,onError:a}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsxs("div",{className:"loading-row",title:"Waiting for payment confirmation",children:[i.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),i.jsx("div",{className:"booking-subtext",children:"Waiting for Payment"})]})]}),i.jsx("div",{className:n,children:"Pending"})]})}function Gj({booking:e,onClick:t}){const n="booking-status-chip booking-status-checkedin",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return i.jsxs("div",{className:"booking-card checkin-payment",onClick:t,children:[i.jsx("img",{src:e.img,alt:e.title}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsx("div",{className:"booking-subtext",children:"Payment In Waiting"})]}),i.jsx("div",{className:n,children:"Payment In Waiting"})]})}const Ir={createIncident:async(e,t,n=[])=>{var c;if(!e||!t)throw new Error("bookingId and description are required");const s=new FormData;if(s.append("bookingId",e),s.append("description",t),n&&n.length)for(const u of n)s.append("images",u);const a=["/Incidents/Create","/incidents/Create","/Incidents/CreateIncident"];let l=null;for(const u of a)try{const f=await de.post(u,s,{headers:{"Content-Type":"multipart/form-data"}}),p=f==null?void 0:f.data;if(p&&typeof p=="object"&&"data"in p){if(p.isSuccess===!1){const g=p.message||(Array.isArray(p.errors)?p.errors.join("; "):"Request failed"),x=new Error(g);throw x.body=p,x}return p.data}return p}catch(f){l=f;const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}throw l||new Error("Create incident endpoint not found")},getIncidentsByBooking:async(e,t=1,n=20)=>{var l;if(!e)return[];const s=encodeURIComponent(e),a=[{url:`/Incidents/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/Incident/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/incidents/get-by-booking/${s}`,opts:{params:{page:t,pageSize:n}}}];for(const c of a)try{const u=await de.get(c.url,c.opts),f=u==null?void 0:u.data,p=f&&typeof f=="object"&&"data"in f?f.data:f;if(!p)continue;return Array.isArray(p)?p:Array.isArray(p==null?void 0:p.items)?p.items:Array.isArray(p==null?void 0:p.data)?p.data:Array.isArray(p)?p:[]}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)return[]}return[]},getMyIncidents:async()=>{var t;const e=["/Incidents/My-Incidents","/Incidents/My","/Incidents/Get-My"];for(const n of e)try{const s=await de.get(n),a=s==null?void 0:s.data,l=a&&typeof a=="object"&&"data"in a?a.data:a;if(!l)continue;return Array.isArray(l)?l:Array.isArray(l==null?void 0:l.items)?l.items:Array.isArray(l==null?void 0:l.data)?l.data:Array.isArray(l)?l:[]}catch(s){const a=(t=s==null?void 0:s.response)==null?void 0:t.status;if(a&&a!==404&&a!==405)return[]}return[]},getAllIncidents:async(e=null,t=null,n=null,s=null,a=1,l=100)=>{try{const c={};e&&(c.stationId=e),t&&(c.status=t),n&&(c.dateFrom=n),s&&(c.dateTo=s),c.page=a,c.pageSize=l;const u=await de.get("/Incidents/Get-All",{params:c}),f=u==null?void 0:u.data,p=f&&typeof f=="object"&&"data"in f?f.data:f;if(!p)return{incidents:[],totalCount:0,page:a,pageSize:l};if(Array.isArray(p))return{incidents:p,totalCount:p.length,page:a,pageSize:l};const g=p.incidents||p.items||p.data||[],x=p.totalCount||p.total||(Array.isArray(g)?g.length:0);return{incidents:Array.isArray(g)?g:[],totalCount:x||0,page:p.page||a,pageSize:p.pageSize||l}}catch{return{incidents:[],totalCount:0,page:a,pageSize:l}}},getIncidentById:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Incidents/Get-By-${t}`,`/Incidents/Get-By-Id/${t}`,`/Incidents/${t}`,`/incident/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(!u)continue;return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},updateIncident:async(e,t)=>{var l;if(!e)throw new Error("incidentId is required");const n=encodeURIComponent(e),s=[`/Incidents/Update-By-${n}`,`/Incidents/Update-By-Id/${n}`,`/Incidents/Update/${n}`,`/Incidents/${n}`];let a=null;for(const c of s)try{const u=await de.put(c,t,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;return(f&&typeof f=="object"&&"data"in f?f.data:f)||f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Update incident endpoint not found")},resolveIncident:async(e,t="",n=0)=>{var c;if(!e)throw new Error("incidentId is required");const s=encodeURIComponent(e),a=[`/Incidents/Resolve-By-${s}`,`/Incidents/Resolve-By-Id/${s}`,`/Incidents/Resolve/${s}`];let l=null;for(const u of a)try{const f=await de.patch(u,{resolutionNotes:t,costIncurred:n}),p=f==null?void 0:f.data;return p&&typeof p=="object"&&"data"in p?p.data:p}catch(f){l=f;const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}throw l||new Error("Resolve incident endpoint not found")},deleteIncident:async e=>{var a;if(!e)throw new Error("incidentId is required");const t=encodeURIComponent(e),n=[`/Incidents/Delete-By-${t}`,`/Incidents/Delete-By-Id/${t}`,`/Incidents/Delete/${t}`,`/Incidents/${t}`];let s=null;for(const l of n)try{const c=await de.delete(l),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){s=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}throw s||new Error("Delete incident endpoint not found")}},$e={confirmBooking:$t.confirmBooking,cancelBooking:$t.cancelBooking,completeBooking:$t.completeBooking,getBookingById:$t.getBookingById,createIncident:Ir.createIncident,getIncidentsByBooking:Ir.getIncidentsByBooking,getMyIncidents:Ir.getMyIncidents,getAllIncidents:Ir.getAllIncidents,getIncidentById:Ir.getIncidentById,updateIncident:Ir.updateIncident,resolveIncident:Ir.resolveIncident,deleteIncident:Ir.deleteIncident,post:(e,t={})=>de.post(e,t).then(n=>n.data),get:(e,t={})=>de.get(e,t).then(n=>n.data),put:(e,t={})=>de.put(e,t).then(n=>n.data),patch:(e,t={})=>de.patch(e,t).then(n=>n.data),delete:e=>de.delete(e).then(t=>t.data),createCar:ot.createCar,deleteCar:ot.deleteCar,updateCar:ot.updateCar,updateStatus:ot.updateStatus,updateBatteryLevel:ot.updateBatteryLevel,updateCarDescription:ot.updateCarDescription,getCarsByStation:async e=>{var t;try{const n=await de.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`),s=n==null?void 0:n.data;return Array.isArray(s)?s:s!=null&&s.data&&Array.isArray(s.data)?s.data:(t=s==null?void 0:s.data)!=null&&t.data&&Array.isArray(s.data.data)?s.data.data:s!=null&&s.items&&Array.isArray(s.items)?s.items:(console.warn(" No cars found in response for station:",e),[])}catch(n){return console.warn(" getCarsByStation error (endpoint may not exist):",n.message),[]}},checkInWithContract:async e=>{var s,a;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-In-With-Contract","/Bookings/CheckInWithContract","/bookings/check-in-with-contract"];let n;for(const l of t){if(e.checkInPhotoFile&&e.checkInPhotoFile instanceof File)try{const c=new FormData;c.append("bookingId",e.bookingId),c.append("staffId",e.staffId),e.checkInNotes&&c.append("checkInNotes",e.checkInNotes),e.checkInPhotoUrl&&!e.checkInPhotoUrl.startsWith("blob:")&&c.append("checkInPhotoUrl",e.checkInPhotoUrl),c.append("checkInPhotoFile",e.checkInPhotoFile);const u=await de.post(l,c,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const p=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(p);throw g.body=f,g}return f.data}return f}catch(c){n=c;const u=(s=c==null?void 0:c.response)==null?void 0:s.status;if(u&&u!==404&&u!==405)throw c}try{const{checkInPhotoFile:c,...u}=e,f=await de.post(l,u,{headers:{"Content-Type":"application/json"}}),p=f==null?void 0:f.data;if(p&&typeof p=="object"&&"data"in p){if(p.isSuccess===!1){const g=p.message||(Array.isArray(p.errors)?p.errors.join("; "):"Request failed"),x=new Error(g);throw x.body=p,x}return p.data}return p}catch(c){n=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}}throw n||new Error("Check-In-With-Contract endpoint not found")},checkOutWithPayment:async e=>{var s,a;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-Out-With-Payment","/Bookings/CheckOutWithPayment","/bookings/check-out-with-payment"];let n;for(const l of t){if(e.checkOutPhotoFile&&e.checkOutPhotoFile instanceof File)try{const c=new FormData;c.append("bookingId",e.bookingId),c.append("staffId",e.staffId),e.actualReturnDateTime&&c.append("actualReturnDateTime",e.actualReturnDateTime),e.damageFee!==void 0&&e.damageFee!==null&&c.append("damageFee",String(e.damageFee)),e.checkOutNotes&&c.append("checkOutNotes",e.checkOutNotes),e.checkOutPhotoUrl&&!e.checkOutPhotoUrl.startsWith("blob:")&&c.append("checkOutPhotoUrl",e.checkOutPhotoUrl),c.append("checkOutPhotoFile",e.checkOutPhotoFile);const u=await de.post(l,c,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const p=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(p);throw g.body=f,g}return f.data}return f}catch(c){n=c;const u=(s=c==null?void 0:c.response)==null?void 0:s.status;if(u&&u!==404&&u!==405)throw c}try{const{checkOutPhotoFile:c,...u}=e,f=await de.post(l,u,{headers:{"Content-Type":"application/json"}}),p=f==null?void 0:f.data;if(p&&typeof p=="object"&&"data"in p){if(p.isSuccess===!1){const g=p.message||(Array.isArray(p.errors)?p.errors.join("; "):"Request failed"),x=new Error(g);throw x.body=p,x}return p.data}return p}catch(c){n=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}}throw n||new Error("Check-Out-With-Payment endpoint not found")},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await $e.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},getAllStations:async(e=1,t=100)=>{var n;try{const s=await de.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}}),a=s==null?void 0:s.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(n=a==null?void 0:a.data)!=null&&n.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No stations found in response"),[])}catch(s){return console.warn(" getAllStations error:",s.message),[]}},getBookingsByStation:async(e,t=1,n=100)=>{var a;if(!e)throw new Error("stationId is required");const s=encodeURIComponent(e);try{const l=await de.get(`/Bookings/By-Station/${s}`,{params:{pageNumber:t,pageSize:n}}),c=l==null?void 0:l.data;return Array.isArray(c)?c:c!=null&&c.data&&Array.isArray(c.data)?c.data:(a=c==null?void 0:c.data)!=null&&a.data&&Array.isArray(c.data.data)?c.data.data:c!=null&&c.items&&Array.isArray(c.items)?c.items:(console.warn(" No bookings found in response for station:",e),[])}catch(l){return console.warn(" getBookingsByStation error:",l.message),[]}},getAvailableCarsByStation:async e=>{var n;if(!e)return[];const t=encodeURIComponent(e);try{const s=await de.get(`/Cars/Get-Available-By-Station/${t}`),a=s==null?void 0:s.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(n=a==null?void 0:a.data)!=null&&n.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No available cars found for station:",e),[])}catch(s){return console.warn(" getAvailableCarsByStation error:",s.message),[]}}};function Yj({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:a}){var U,ie;const[l,c]=y.useState(!1),[u,f]=y.useState(!1),[p,g]=y.useState(!1),[x,j]=y.useState(!1),[k,C]=y.useState(""),[S,P]=y.useState(!1),[_,v]=y.useState(!1),[w,b]=y.useState(null),[B,T]=y.useState(!1),[F,R]=y.useState(null),[O,I]=y.useState(""),[D,q]=y.useState(""),[te,G]=y.useState(""),[E,oe]=y.useState(null),[Ne,W]=y.useState(!1);if(y.useEffect(()=>{if(!e)return;c(!1),f(!1),g(!1),j(!1),C(""),oe(null);const Z=(he,Ve)=>[he,Ve].filter(Boolean).join(" "),se=e.fullName||Z(e.firstName,e.lastName);if(!se||/^customer$/i.test(se)||se===""||C(se),!e.id)return;let ce=!1;async function ke(){P(!0);try{const{firstName:he,lastName:Ve}=await staffApi.getUserNameByBookingId(e.id);ce||C(Z(he,Ve))}catch{}finally{ce||P(!1)}}async function we(){if(!e.userId){console.warn(" No userId in booking");return}W(!0);try{console.log(" Fetching user details for userId:",e.userId);const he=await staffApi.getUserById(e.userId);ce||(oe(he),console.log(" Fetched user details:",he),console.log(" CCCD Images:",{cccdFrontUrl:he==null?void 0:he.cccdFrontUrl,identityFrontUrl:he==null?void 0:he.identityFrontUrl,idFrontUrl:he==null?void 0:he.idFrontUrl,cccdImageUrl_Front:he==null?void 0:he.cccdImageUrl_Front,cccdBackUrl:he==null?void 0:he.cccdBackUrl,identityBackUrl:he==null?void 0:he.identityBackUrl,idBackUrl:he==null?void 0:he.idBackUrl,cccdImageUrl_Back:he==null?void 0:he.cccdImageUrl_Back}),console.log(" GPLX Images:",{gplxFrontUrl:he==null?void 0:he.gplxFrontUrl,driverLicenseFrontUrl:he==null?void 0:he.driverLicenseFrontUrl,gplxImageUrl_Front:he==null?void 0:he.gplxImageUrl_Front,gplxBackUrl:he==null?void 0:he.gplxBackUrl,driverLicenseBackUrl:he==null?void 0:he.driverLicenseBackUrl,gplxImageUrl_Back:he==null?void 0:he.gplxImageUrl_Back}))}catch(he){console.warn(" Failed to fetch user details:",(he==null?void 0:he.message)||he),console.error("Full error:",he),ce||oe(null)}finally{ce||W(!1)}}return ke(),we(),()=>{ce=!0}},[e]),!e)return null;const fe=(e==null?void 0:e.status)==="booked"?l&&u:!1,re=()=>{if(!e)return;const Z=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,Z)};return i.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("img",{id:"modalImage",src:e.facePhoto||e.img,alt:"",style:{width:"100%",borderRadius:8,objectFit:"cover",display:"block"}}),i.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),i.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),i.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((U=e.car)==null?void 0:U.name)||((ie=e.car)==null?void 0:ie.Name)||""]}),i.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(S?"Loading":"")]}),i.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",e.date]})]}),i.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Pickup Date:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"pickupDate",style:{fontWeight:600},children:e.pickupDate||e.startDate||e.date||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Return Date:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"returnDate",style:{fontWeight:600},children:e.returnDate||e.endDate||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:Ne?"Loading...":(E==null?void 0:E.identityNumber)||(E==null?void 0:E.idNumber)||(E==null?void 0:E.cmnd)||e.idString||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Address:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:Ne?"Loading...":(E==null?void 0:E.address)||e.address||""})})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["CCCD Images: ",Ne&&"(Loading...)"]}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),E!=null&&E.cccdFrontUrl||E!=null&&E.identityFrontUrl||E!=null&&E.idFrontUrl||E!=null&&E.cccdImageUrl_Front||e.cccdFrontUrl?i.jsx("a",{href:(E==null?void 0:E.cccdFrontUrl)||(E==null?void 0:E.identityFrontUrl)||(E==null?void 0:E.idFrontUrl)||(E==null?void 0:E.cccdImageUrl_Front)||e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.cccdFrontUrl)||(E==null?void 0:E.identityFrontUrl)||(E==null?void 0:E.idFrontUrl)||(E==null?void 0:E.cccdImageUrl_Front)||e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:Z=>c(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),E!=null&&E.cccdBackUrl||E!=null&&E.identityBackUrl||E!=null&&E.idBackUrl||E!=null&&E.cccdImageUrl_Back||e.cccdBackUrl?i.jsx("a",{href:(E==null?void 0:E.cccdBackUrl)||(E==null?void 0:E.identityBackUrl)||(E==null?void 0:E.idBackUrl)||(E==null?void 0:E.cccdImageUrl_Back)||e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.cccdBackUrl)||(E==null?void 0:E.identityBackUrl)||(E==null?void 0:E.idBackUrl)||(E==null?void 0:E.cccdImageUrl_Back)||e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:u,onChange:Z=>f(Z.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["Driver License (GPLX) Images: ",Ne&&"(Loading...)"]}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),E!=null&&E.gplxFrontUrl||E!=null&&E.driverLicenseFrontUrl||E!=null&&E.gplxImageUrl_Front||e.gplxFrontUrl?i.jsx("a",{href:(E==null?void 0:E.gplxFrontUrl)||(E==null?void 0:E.driverLicenseFrontUrl)||(E==null?void 0:E.gplxImageUrl_Front)||e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.gplxFrontUrl)||(E==null?void 0:E.driverLicenseFrontUrl)||(E==null?void 0:E.gplxImageUrl_Front)||e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:p,onChange:Z=>g(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),E!=null&&E.gplxBackUrl||E!=null&&E.driverLicenseBackUrl||E!=null&&E.gplxImageUrl_Back||e.gplxBackUrl?i.jsx("a",{href:(E==null?void 0:E.gplxBackUrl)||(E==null?void 0:E.driverLicenseBackUrl)||(E==null?void 0:E.gplxImageUrl_Back)||e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.gplxBackUrl)||(E==null?void 0:E.driverLicenseBackUrl)||(E==null?void 0:E.gplxImageUrl_Back)||e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:x,onChange:Z=>j(Z.target.checked)})," Verified"]})]})]})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{id:"customerPhone",style:{padding:6},children:Ne?"Loading...":(E==null?void 0:E.phoneNumber)||(E==null?void 0:E.phone)||e.phone||""}),((E==null?void 0:E.phoneNumber)||(E==null?void 0:E.phone)||e.phone)&&i.jsx("a",{href:`tel:${(E==null?void 0:E.phoneNumber)||(E==null?void 0:E.phone)||e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!fe,style:{background:fe?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),i.jsx("button",{onClick:re,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&i.jsx("button",{onClick:()=>n==null?void 0:n(e,"checkout"),style:{background:"#d32f2f",color:"#fff",width:"100%",padding:"12px",borderRadius:6,border:"none",cursor:"pointer",fontWeight:600,fontSize:14},children:"Check Out"})]}),O&&i.jsx("div",{style:{marginTop:8,color:"#b00020"},children:O})]})]}),i.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[i.jsx("h4",{children:"Transaction Details"}),i.jsxs("ul",{style:{fontSize:"1rem"},children:[i.jsx("li",{children:"Find rental location on map"}),i.jsx("li",{children:"View available vehicles (type, battery, price)"}),i.jsx("li",{children:"Book in advance or on-site"}),i.jsx("li",{children:"Check-in at counter/app"}),i.jsx("li",{children:"Sign electronic contract"}),i.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),i.jsx("li",{children:"Return vehicle at rental location"}),i.jsx("li",{children:"Staff checks and confirms vehicle condition"}),i.jsx("li",{children:"Pay any additional fees"})]})]})]})})}function rp(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function Kj({booking:e,onClose:t,onCheckedIn:n}){const[s,a]=y.useState(""),[l,c]=y.useState(null),[u,f]=y.useState(!1),[p,g]=y.useState(""),[x,j]=y.useState(null),[k,C]=y.useState(null),[S,P]=y.useState(""),[_,v]=y.useState(""),[w,b]=y.useState(""),[B,T]=y.useState(!1),[F,R]=y.useState(!1),[O,I]=y.useState(!1);Kn.useEffect(()=>{let te=!0;return(async()=>{try{const G=await staffApi.getServerTime();te&&j(G);try{const E=G?G.getTime()-Date.now():0;console.log(" Server time:",G,"Client time:",new Date,"(ms):",E)}catch{}}catch{}})(),()=>{te=!1}},[]);async function D(te){var G,E;if(te.preventDefault(),!!(e!=null&&e.id)){f(!0),g("");try{const oe=localStorage.getItem("token");if(!oe||oe==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let Ne="";try{Ne=localStorage.getItem("userId")||""}catch{}if(!Ne)try{const ie=localStorage.getItem("token");if(ie){const Z=staffApi.decodeJwt(ie);Ne=Z["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||Z.sub||Z.userId||Z.UserId||Z.id||Z.Id||""}}catch{}if(!Ne)throw new Error("Unable to determine userId. Please sign in again.");const W={bookingId:e.id,staffId:Ne},fe=(s||"").trim();fe&&(W.checkInNotes=fe),l&&(W.checkInPhotoFile=l);const re=await staffApi.checkInWithContract(W);console.log(" Check-in response:",re),localStorage.setItem("activeCheckInBookingId",e.id),console.log(" Saved activeCheckInBookingId to localStorage:",e.id),C(re);const U=(re==null?void 0:re.totalAmount)||(re==null?void 0:re.TotalAmount)||0;if(console.log(" Total amount for payment:",U),U>0){T(!0);try{const ie=await Zr.createPayment(e.id,1,"Rental payment at check-in");console.log(" Payment created:",ie);const Z=ie||{},se=Z.checkoutUrl||Z.url||Z.payUrl||"";se?(console.log(" Opening Payos checkout in new tab:",se),P(se),window.open(se,"_blank")):(console.warn(" No checkout URL in payment response:",Z),P(""),g("Payment session created but no checkout URL received. Please try again."))}catch(ie){console.error(" Payment creation failed:",ie==null?void 0:ie.message),g(`Check-in succeeded but payment setup failed: ${ie==null?void 0:ie.message}. Please try again.`)}finally{T(!1)}}typeof n=="function"&&n(e.id,W)}catch(oe){const Ne=(oe==null?void 0:oe.body)||((G=oe==null?void 0:oe.response)==null?void 0:G.data),W=Ne&&(Ne.errors||Ne.Errors)||null,fe=(Array.isArray(W)&&W.length?W.join("; "):null)||(Ne==null?void 0:Ne.message)||(oe==null?void 0:oe.message)||"Failed to save check-in";g(fe);try{console.error(" Check-in failed:",{error:oe==null?void 0:oe.message,status:(oe==null?void 0:oe.status)||((E=oe==null?void 0:oe.response)==null?void 0:E.status),body:Ne})}catch{}}finally{f(!1)}}}async function q(){if(e!=null&&e.id){R(!0),g("");try{console.log(" Syncing payment for booking:",e.id),await Zr.syncPayment(e.id),console.log(" Payment synced successfully");const te=await $t.getBookingById(e.id);console.log(" Updated booking status:",te.bookingStatus),I(!0),g(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(te){console.error(" Payment sync failed:",te),g(`Payment sync failed: ${te.message}`),I(!1)}finally{R(!1)}}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),k?i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check-in Successful"}),i.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(k==null?void 0:k.message)||"Check-in successful!"]}),p&&i.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:p}),B&&i.jsx("div",{style:{background:"#e3f2fd",color:"#1565c0",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Creating payment session and redirecting to Payos..."}),S&&!B&&i.jsx("div",{style:{background:"#f3e5f5",color:"#7b1fa2",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment session created. Payos opened in new tab."}),O&&i.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[i.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),i.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[i.jsx("span",{children:"Total Amount:"}),i.jsx("strong",{children:rp((k==null?void 0:k.totalAmount)||0)})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:14},children:[i.jsx("span",{children:"Deposit (30%):"}),i.jsx("strong",{children:rp((k==null?void 0:k.depositAmount)||0)})]})]})]}),i.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:i.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment Processing"}),B?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:"Preparing payment link..."}),i.jsx("div",{style:{fontSize:12,color:"#999"},children:"You will be redirected to Payos to complete payment."})]}):S?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:" Payment link opened in new tab"}),i.jsx("div",{style:{fontSize:12,color:"#999",marginBottom:16},children:"After customer completes payment, click the button below to sync"}),i.jsx("button",{onClick:q,disabled:F||O,style:{background:O?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:F||O?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:F?" Syncing...":O?" Synced!":" Sync Payment Status"})]}):i.jsx("div",{style:{fontSize:13,color:"#d32f2f",padding:"12px",background:"#ffebee",borderRadius:6},children:" Payment setup incomplete"})]})})]}),i.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",i.jsx("strong",{children:"Note:"})," You will be redirected to Payos to complete payment. After payment completes, you will be redirected to the payment success page."]}),!B&&!S&&i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check In"}),x&&i.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",x.toLocaleString()]}),p&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:p}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),i.jsxs("form",{onSubmit:D,style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Notes"}),i.jsx("textarea",{rows:5,value:s,onChange:te=>a(te.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Photo (Optional)"}),i.jsx("input",{type:"file",accept:"image/*",onChange:te=>c(te.target.files[0]||null),placeholder:"Select an image file"}),l&&i.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Selected: ",l.name," (",(l.size/1024/1024).toFixed(2)," MB)"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:u,style:{background:"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:u?"Processing":"Confirm Check In"})]})]})]})]})})}function co(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function Qj({booking:e,onClose:t,onCheckedOut:n}){const[s,a]=y.useState(""),[l,c]=y.useState(0),[u,f]=y.useState(""),[p,g]=y.useState("15:00"),[x,j]=y.useState(null),[k,C]=y.useState(new Date().getMonth()),[S,P]=y.useState(new Date().getFullYear()),[_,v]=y.useState(!1),[w,b]=y.useState(""),[B,T]=y.useState(null),[F,R]=y.useState(null),[O,I]=y.useState(""),[D,q]=y.useState(!1),[te,G]=y.useState(!1),[E,oe]=y.useState(!1),Ne=Array.from({length:18},(Z,se)=>`${(6+se).toString().padStart(2,"0")}:00`);Kn.useEffect(()=>{let Z=!0;return(async()=>{try{const se=await staffApi.getServerTime();if(Z&&(T(se),se)){const ce=se.toISOString().split("T")[0];f(ce)}try{const ne=se?se.getTime()-Date.now():0;console.log(" Server time:",se,"Client time:",new Date,"(ms):",ne)}catch{}}catch{}})(),()=>{Z=!1}},[]);function W(){const Z=new Date(S,k,1),se=new Date(S,k+1,0),ne=[];for(let ke=0;ke<Z.getDay();ke++)ne.push(i.jsx("div",{},`empty-${ke}`));const ce=new Date;ce.setHours(0,0,0,0);for(let ke=1;ke<=se.getDate();ke++){const we=`${S}-${(k+1).toString().padStart(2,"0")}-${ke.toString().padStart(2,"0")}`,Ve=new Date(we)<ce,ht=we===u,qe=["calendar-day"];Ve&&qe.push("past"),ht&&qe.push("selected"),ne.push(i.jsx("div",{className:qe.join(" "),onClick:Ct=>{Ct.stopPropagation(),Ve||(f(we),j(null))},style:{cursor:Ve?"not-allowed":"pointer"},children:ke},we))}return ne}function fe(Z){let se=k+Z,ne=S;se>11&&(se=0,ne++),se<0&&(se=11,ne--),C(se),P(ne)}async function re(Z){var se,ne;if(Z.preventDefault(),!!(e!=null&&e.id)){v(!0),b("");try{const ce=localStorage.getItem("token");if(!ce||ce==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let ke="";try{ke=localStorage.getItem("userId")||""}catch{}if(!ke)try{const ae=localStorage.getItem("token");if(ae){const ye=staffApi.decodeJwt(ae);ke=ye["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||ye.sub||ye.userId||ye.UserId||ye.id||ye.Id||""}}catch{}if(!ke)throw new Error("Unable to determine userId. Please sign in again.");const we={bookingId:e.id,staffId:ke,actualReturnDateTime:u&&p?new Date(`${u}T${p}`).toISOString():new Date().toISOString(),checkOutPhotoUrl:"",damageFee:Number(l)||0},he=(s||"").trim();he&&(we.checkOutNotes=he);const Ve=await staffApi.checkOutWithPayment(we);console.log(" Check-out response:",Ve),localStorage.setItem("activeCheckOutBookingId",e.id),console.log(" Saved activeCheckOutBookingId to localStorage:",e.id),R(Ve);const ht=await staffApi.getBookingById(e.id);console.log(" Updated booking:",ht),ht&&R(ae=>({...ae,...ht}));const qe=Number(l)||0,Ct=Number((ht==null?void 0:ht.extraAmount)||0),ge=qe+Ct;if(console.log(" Payment amounts - Damage:",qe,"Backend Extra:",Ct,"Total:",ge),ge>0){q(!0);try{const ae=await Zr.createPayment(e.id,2,"Rental payment at check-out",ge);console.log(" Payment created:",ae);const ye=ae||{},ue=ye.checkoutUrl||ye.url||ye.payUrl||"";ue?(console.log(" Opening Payos checkout in new tab:",ue),I(ue),window.open(ue,"_blank")):(console.warn(" No checkout URL in payment response:",ye),I(""),b("Payment session created but no checkout URL received. Please try again."))}catch(ae){console.error(" Payment creation failed:",ae==null?void 0:ae.message),b(`Check-out succeeded but payment setup failed: ${ae==null?void 0:ae.message}. Please try again.`)}finally{q(!1)}}typeof n=="function"&&n(e.id,we)}catch(ce){const ke=(ce==null?void 0:ce.body)||((se=ce==null?void 0:ce.response)==null?void 0:se.data),we=ke&&(ke.errors||ke.Errors)||null,he=(Array.isArray(we)&&we.length?we.join("; "):null)||(ke==null?void 0:ke.message)||(ce==null?void 0:ce.message)||"Failed to save check-out";b(he);try{console.error(" Check-out failed:",{error:ce==null?void 0:ce.message,status:(ce==null?void 0:ce.status)||((ne=ce==null?void 0:ce.response)==null?void 0:ne.status),body:ke})}catch{}}finally{v(!1)}}}async function U(){if(e!=null&&e.id){q(!0),b("");try{localStorage.setItem("activeCheckOutBookingId",e.id);const Z=Number((F==null?void 0:F.extraAmount)||0),se=Number(l)||0,ne=Math.max(Z,se);console.log(" Creating payment - ExtraAmount:",Z,"DamageFee:",se,"Using:",ne);const ce=await Zr.createPayment(e.id,2,"Rental payment at check-out",ne);console.log(" Payment created:",ce);const ke=ce||{},we=ke.checkoutUrl||ke.url||ke.payUrl||"";we?(console.log(" Opening Payos checkout:",we),I(we),window.open(we,"_blank")):(console.warn(" No checkout URL in payment response:",ke),b("No checkout URL received. Please try again."))}catch(Z){console.error(" Payment creation failed:",Z==null?void 0:Z.message),b(`Payment setup failed: ${Z==null?void 0:Z.message}`)}finally{q(!1)}}}async function ie(){if(e!=null&&e.id){G(!0),b("");try{console.log(" Syncing payment for booking:",e.id),await Zr.syncPayment(e.id),console.log(" Payment synced successfully");const Z=await $t.getBookingById(e.id);console.log(" Updated booking status:",Z.bookingStatus),oe(!0),b(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(Z){console.error(" Payment sync failed:",Z),b(`Payment sync failed: ${Z.message}`),oe(!1)}finally{G(!1)}}}return i.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),F?i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check-out Successful"}),i.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(F==null?void 0:F.message)||"Check-out successful!"]}),w&&i.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:w}),E&&i.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[i.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),i.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[i.jsx("span",{children:"Damage Fee:"}),i.jsx("strong",{style:{color:"#d32f2f"},children:co((F==null?void 0:F.damageFee)||0)})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[i.jsx("span",{children:"Late Fee:"}),i.jsx("strong",{style:{color:"#d32f2f"},children:co((F==null?void 0:F.lateFee)||0)})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid #eee",paddingTop:8,fontSize:14,fontWeight:600},children:[i.jsx("span",{children:"Total Additional Fees:"}),i.jsx("strong",{style:{color:"#d32f2f"},children:co(((F==null?void 0:F.damageFee)||0)+((F==null?void 0:F.lateFee)||0))})]})]})]}),i.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:i.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment"}),((F==null?void 0:F.extraAmount)||0)>0?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{fontSize:13,color:"#666",marginBottom:16,lineHeight:1.5},children:["Amount to pay: ",i.jsx("strong",{children:co((F==null?void 0:F.extraAmount)||0)})]}),O?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:12},children:" Payment link opened in new tab"}),i.jsx("button",{onClick:ie,disabled:te||E,style:{background:E?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:te||E?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:te?" Syncing...":E?" Synced!":" Sync Payment Status"})]}):i.jsx("button",{onClick:U,disabled:D,style:{background:"#4CAF50",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:D?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%",marginBottom:8},children:D?" Opening Payment...":" Go to Payment"})]}):i.jsx("div",{style:{fontSize:13,color:"#2e7d32",padding:"12px",background:"#e8f5e9",borderRadius:6},children:" No additional payment needed"})]})})]}),i.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",i.jsx("strong",{children:"Note:"}),' Click "Go to Payment" to open Payos in new tab. After customer completes payment, click "Sync Payment Status" to update booking.']}),i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check Out"}),B&&i.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",B.toLocaleString()]}),w&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:w}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),i.jsxs("form",{onSubmit:re,style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{style:{display:"flex",gap:12,position:"relative"},children:[i.jsxs("div",{style:{flex:1,position:"relative"},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Return Date"}),i.jsx("div",{onClick:Z=>{Z.stopPropagation(),j(x==="return"?null:"return")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:u?new Date(u).toLocaleDateString():"Select date"})]}),x==="return"&&i.jsxs("div",{onClick:Z=>Z.stopPropagation(),style:{position:"absolute",top:"100%",left:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:12,marginTop:4,zIndex:10,minWidth:280,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("button",{type:"button",onClick:Z=>{Z.stopPropagation(),fe(-1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""}),i.jsx("span",{style:{fontWeight:600},children:new Date(S,k).toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("button",{type:"button",onClick:Z=>{Z.stopPropagation(),fe(1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,marginBottom:8},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(Z=>i.jsx("div",{style:{textAlign:"center",fontSize:12,fontWeight:600},children:Z},Z))}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:W()})]})]}),i.jsxs("div",{style:{flex:1,position:"relative"},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Return Time"}),i.jsx("div",{onClick:Z=>{Z.stopPropagation(),j(x==="return-time"?null:"return-time")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:p})]}),x==="return-time"&&i.jsx("div",{onClick:Z=>Z.stopPropagation(),style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:8,marginTop:4,zIndex:1001,maxHeight:240,overflow:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:Ne.map(Z=>i.jsx("div",{onClick:se=>{se.stopPropagation(),g(Z),j(null)},style:{padding:"8px 12px",cursor:"pointer",background:Z===p?"#e3f2fd":"#fff",color:Z===p?"#1976d2":"#333",fontWeight:Z===p?"600":"400",borderRadius:4,marginBottom:4},children:Z},Z))})]})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-out Notes"}),i.jsx("textarea",{rows:4,value:s,onChange:Z=>a(Z.target.value),placeholder:"Notes about the vehicle condition upon return, battery level, etc."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Damage Fee (VND)"}),i.jsx("input",{type:"number",min:"0",value:l,onChange:Z=>c(Z.target.value),placeholder:"Enter damage fee (based on incidents reviewed)"})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:_,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:_?"Processing":"Confirm Check Out"})]})]})]})]})}function Jj({bookingId:e,onClose:t}){const[n,s]=y.useState([]),[a,l]=y.useState(!0),[c,u]=y.useState(""),[f,p]=y.useState(1),g=20;y.useEffect(()=>{e&&(async()=>{try{l(!0),u("");const j=await staffApi.getIncidentsByBooking(e,f,g);s(Array.isArray(j)?j:[]),console.log(" Incidents loaded:",j)}catch(j){console.error(" Failed to load incidents:",j),u((j==null?void 0:j.message)||"Failed to load incidents")}finally{l(!1)}})()},[e,f]);const x=j=>{const k=String(j||"").toLowerCase();return k.includes("high")?"#d32f2f":k.includes("medium")?"#f57c00":k.includes("low")?"#fbc02d":"#666"};return i.jsxs("div",{className:"modal-content",style:{width:"min(420px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("h3",{style:{margin:0},children:"Related Incidents"}),i.jsx("span",{className:"close-btn",onClick:t,style:{cursor:"pointer",fontSize:24},children:""})]}),a?i.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" Loading incidents..."}):c?i.jsxs("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6},children:[" ",c]}):n.length===0?i.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" No incidents reported for this booking"}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:n.map((j,k)=>i.jsxs("div",{style:{border:"1px solid #eee",padding:12,borderRadius:6},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:14,fontWeight:600},children:j.title}),i.jsx("div",{style:{background:x(j.severity),color:"#fff",padding:"2px 8px",borderRadius:4,fontSize:11,fontWeight:600},children:j.severity||"N/A"})]}),i.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#555",lineHeight:1.4},children:j.description}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,color:"#999"},children:[i.jsxs("span",{children:["Est. Cost: ",i.jsx("strong",{children:j.estimatedCost?`$${Number(j.estimatedCost).toFixed(2)}`:"N/A"})]}),i.jsx("span",{children:j.timestamp?new Date(j.timestamp).toLocaleDateString():"N/A"})]})]},k))}),!a&&n.length>0&&i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:[i.jsx("button",{onClick:()=>p(j=>Math.max(1,j-1)),disabled:f===1,style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:f===1?"not-allowed":"pointer"},children:" Prev"}),i.jsxs("span",{style:{padding:"6px 12px"},children:["Page ",f]}),i.jsx("button",{onClick:()=>p(j=>j+1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Next "})]})]})}function Xj({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:a,onContinuePayment:l,onCancelBooking:c,onStatusUpdated:u}){const[f,p]=y.useState(null),[g,x]=y.useState(null),[j,k]=y.useState(null);Kn.useEffect(()=>{if(!(j!=null&&j.id))return;const S=setInterval(async()=>{try{const P=localStorage.getItem("activeCheckOutBookingId");if(!P)return;const _=await staffApi.getBookingById(P);console.log(" Polling booking status:",_==null?void 0:_.bookingStatus),((_==null?void 0:_.bookingStatus)===5||(_==null?void 0:_.status)===5||(_==null?void 0:_.bookingStatus)==="completed"||(_==null?void 0:_.status)==="completed")&&(console.log(" Payment completed! Booking status = 5"),localStorage.removeItem("activeCheckOutBookingId"),clearInterval(S),k(null),u==null||u(P))}catch(P){console.warn(" Polling error:",P==null?void 0:P.message)}},3e3);return()=>clearInterval(S)},[j==null?void 0:j.id,u]),Kn.useEffect(()=>{if(!(g!=null&&g.id))return;const S=setInterval(async()=>{try{const P=localStorage.getItem("activeCheckInBookingId");if(!P)return;const _=await staffApi.getBookingById(P);console.log(" Polling check-in booking status:",_==null?void 0:_.bookingStatus),((_==null?void 0:_.bookingStatus)===3||(_==null?void 0:_.status)===3||(_==null?void 0:_.bookingStatus)>=3)&&(console.log(" Check-in payment completed! Booking status = 3+"),localStorage.removeItem("activeCheckInBookingId"),clearInterval(S),x(null),u==null||u(P))}catch(P){console.warn(" Polling error (check-in):",P==null?void 0:P.message)}},3e3);return()=>clearInterval(S)},[g==null?void 0:g.id,u]);const C=e.filter(S=>(S.title.toLowerCase().includes(t.toLowerCase())||(S.customer||"").toLowerCase().includes(t.toLowerCase())||(S.userName||"").toLowerCase().includes(t.toLowerCase())||(S.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||S.status===s));return i.jsxs("div",{id:"booking",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsx("input",{type:"text",id:"searchBooking",placeholder:"Search by customer or car...",value:t,onChange:S=>n(S.target.value)}),i.jsxs("select",{id:"statusFilter",value:s,onChange:S=>a(S.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending (Awaiting Payment)"}),i.jsx("option",{value:"booked",children:"Active Rental"}),i.jsx("option",{value:"waiting-checkin",children:"Waiting Check-in"}),i.jsx("option",{value:"checked-in",children:"Checked-in"}),i.jsx("option",{value:"checkout-pending",children:"Check-out Pending"}),i.jsx("option",{value:"completed",children:"Completed"}),i.jsx("option",{value:"cancelled-pending",children:"Cancelled (Pending Refund)"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsx("div",{className:"booking-grid",id:"bookingGrid",children:C.map(S=>S.uiStage==="waiting-payment"?i.jsx(qj,{booking:S,onClick:()=>p(S)},S.id):S.uiStage==="checkin-payment"?i.jsx(Gj,{booking:S,onClick:()=>p(S)},S.id):i.jsx(Vj,{booking:S,onClick:()=>p(S)},S.id))}),i.jsx(Yj,{booking:f,onClose:()=>p(null),onProceed:(S,P)=>{S&&(P==="checkout"?(k(S),p(null)):(x(S),p(null)))},onCancel:()=>{f&&(c==null||c(f))},onStatusUpdated:u}),g&&i.jsx(Kj,{booking:g,onClose:()=>x(null)}),j&&i.jsxs("div",{style:{display:"flex",gap:24,position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:1e3,alignItems:"center",justifyContent:"center",padding:20,overflow:"auto"},children:[i.jsx("div",{style:{flex:"0 0 auto",width:"720px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:i.jsx(Qj,{booking:j,onClose:()=>k(null)})}),i.jsx("div",{style:{flex:"0 0 auto",width:"420px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:i.jsx(Jj,{bookingId:j==null?void 0:j.id,onClose:()=>k(null)})})]})]})}function eS({vehicle:e,onOpen:t}){const n=s=>{jl(s.currentTarget)};return i.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[i.jsx("img",{src:Sl(e.img),alt:e.name,onError:n}),i.jsxs("div",{className:"vehicle-info",children:[i.jsx("div",{className:"vehicle-title",children:e.name}),i.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),i.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),i.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),i.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function tS({open:e,onClose:t,onSubmit:n,stationId:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,x]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(""),[P,_]=y.useState(""),[v,w]=y.useState(""),[b,B]=y.useState(""),[T,F]=y.useState(""),[R,O]=y.useState(""),[I,D]=y.useState("");if(!e)return null;async function q(){if(D(""),!s){D("Please select a station before creating a vehicle.");return}if(!a.trim()||!c.trim()||!j.trim()||!f||!C||!P||!v||!b){D("Please fill all required fields: Brand, Model, Year, License Plate, Battery Capacity, Current Battery, Price/hour, Price/day.");return}const te=Number(f),G=Number(C),E=Number(P),oe=Number(v),Ne=Number(b);if(!Number.isFinite(te)||te<1900||te>2100){D("Year must be between 1900 and 2100.");return}if(!Number.isFinite(G)||G<0||G>100){D("Battery Capacity must be between 0 and 100 (kWh).");return}if(!Number.isFinite(E)||E<0||E>100){D("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(oe)||oe<=0||!Number.isFinite(Ne)||Ne<=0){D("Rental prices must be positive numbers.");return}const W={brand:a.trim(),model:c.trim(),year:te,color:g||void 0,licensePlate:j.trim(),batteryCapacity:G,currentBatteryLevel:E,rentalPricePerHour:oe,rentalPricePerDate:Ne,currentStationId:s,imageUrl:T||void 0,description:R||void 0};try{await n(W),l(""),u(""),p(""),x(""),k(""),S(""),_(""),w(""),B(""),F(""),O(""),t()}catch(fe){D((fe==null?void 0:fe.message)||"Failed to create vehicle")}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),I&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[i.jsx("input",{value:a,onChange:te=>l(te.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:c,onChange:te=>u(te.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:f,onChange:te=>p(te.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:g,onChange:te=>x(te.target.value),placeholder:"Color",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:j,onChange:te=>k(te.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:C,onChange:te=>S(te.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:P,onChange:te=>_(te.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:v,onChange:te=>w(te.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:b,onChange:te=>B(te.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:T,onChange:te=>F(te.target.value),placeholder:"Image URL",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}}),i.jsx("input",{value:R,onChange:te=>O(te.target.value),placeholder:"Description",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{onClick:q,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function nS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState("");if(y.useEffect(()=>{n&&(l(n.battery??""),u(n.tech??""),p(n.issue??""))},[n]),!e||!n)return null;function g(){s(n.id,{battery:a,tech:c,issue:f}),t()}return i.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"vehicle-modal-content",children:[i.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),i.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),i.jsx("label",{children:"Battery Status"}),i.jsx("input",{value:a,onChange:x=>l(x.target.value),placeholder:"e.g. 80"}),i.jsx("label",{children:"Condition"}),i.jsxs("select",{value:c,onChange:x=>u(x.target.value),children:[i.jsx("option",{children:"Open"}),i.jsx("option",{children:"Running"}),i.jsx("option",{children:"Rented"}),i.jsx("option",{children:"Maintained"})]}),i.jsx("label",{children:"Issue"}),i.jsx("textarea",{value:f,onChange:x=>p(x.target.value)}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:g,children:"Submit Update"})})]})})}function rS({open:e,vehicle:t,onClose:n,onEdit:s,onUpdate:a}){const[l,c]=y.useState(!1),[u,f]=y.useState(""),[p,g]=y.useState(""),[x,j]=y.useState(""),[k,C]=y.useState(!1);if(!e||!t)return null;const S=t.img,P=()=>{f(t.battery??""),g(t.tech??""),j(t.issue??""),c(!0)},_=async()=>{if(a){C(!0);try{await a(t.id,{battery:u,tech:p,issue:x}),c(!1)}catch(w){alert((w==null?void 0:w.message)||"Failed to update vehicle")}finally{C(!1)}}},v=()=>{c(!1),f(""),g(""),j("")};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsx("img",{src:S,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),i.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[i.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[i.jsx("h3",{style:{marginTop:4},children:t.name}),i.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Detail:"}),i.jsx("div",{children:t.detail||"N/A"})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Battery:"}),l?i.jsx("input",{type:"number",min:"0",max:"100",value:u,onChange:w=>f(w.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):i.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Condition:"}),l?i.jsx("input",{type:"text",value:p,onChange:w=>g(w.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):i.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[i.jsx("strong",{children:"Issue:"}),l?i.jsx("textarea",{value:x,onChange:w=>j(w.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):i.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),i.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:S,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),i.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:l?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:_,disabled:k,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:k?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:k?.6:1},children:[i.jsx("i",{className:"fas fa-save"})," ",k?"Saving...":"Save Changes"]}),i.jsxs("button",{onClick:v,disabled:k,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:k?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):a&&i.jsxs("button",{onClick:P,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]})})]})})}function iS({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return i.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[i.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function sS({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:a,canDelete:l=!0,stationSlots:c=null}){const[u,f]=y.useState(null),[p,g]=y.useState(!1),[x,j]=y.useState(!1),[k,C]=y.useState(!1),[S,P]=y.useState(""),_=e.filter(b=>{if(!S)return!0;const B=S.toLowerCase(),T=(b.name||"").toLowerCase(),F=(b.model||"").toLowerCase(),R=(b.brand||"").toLowerCase(),O=(b.licensePlate||"").toLowerCase();return T.includes(B)||F.includes(B)||R.includes(B)||O.includes(B)});function v(b){f(b),C(!0)}function w(b){f(b),g(!0)}return i.jsxs("div",{id:"vehicle",className:"section",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>j(!0),children:[i.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),i.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:S,onChange:b=>P(b.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),a&&c&&i.jsx(iS,{stationSlots:c})]}),i.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!_||_.length===0)&&i.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:S?"No vehicles match your search.":"No vehicles available to display."}),_.map((b,B)=>i.jsx("div",{children:i.jsx(eS,{vehicle:b,onOpen:()=>w(b)})},b.id||b.licensePlate||`${b.name}-${b.stationId||""}-${B}`))]}),i.jsx(tS,{open:x,onClose:()=>j(!1),onSubmit:t,stationId:a}),i.jsx(nS,{open:k,onClose:()=>C(!1),vehicle:u,onSubmit:s}),i.jsx(rS,{open:p,vehicle:u,onClose:()=>g(!1),onEdit:u?()=>v(u):null,onUpdate:s})]})}function aS({open:e,onClose:t,inline:n=!1}){const[s,a]=y.useState(!1),[l,c]=y.useState({}),[u,f]=y.useState({}),[p,g]=y.useState("");if(y.useEffect(()=>{if(!e)return;let B=!0;async function T(){var F,R,O;try{a(!0),g("");let I={},D={};try{I=await staffApi.getMyProfile()}catch(q){((F=q==null?void 0:q.response)==null?void 0:F.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{D=await staffApi.getMe()}catch(q){((R=q==null?void 0:q.response)==null?void 0:R.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!B)return;c(I||{}),f(D||{});try{let q=(I==null?void 0:I.id)||(I==null?void 0:I.userId)||(D==null?void 0:D.userId)||(D==null?void 0:D.id);if(!q){const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=staffApi.decodeJwt(G);q=E["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||E.nameidentifier||E.sub||E.userId||E.UserId||E.id||E.Id}}if(!(D!=null&&D.role)&&!(I!=null&&I.role))try{const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=staffApi.decodeJwt(G),oe=(E==null?void 0:E.role)||(E==null?void 0:E.Role)||E["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];oe&&(D={...D,role:oe})}}catch{}const te=!(I!=null&&I.userName)&&!(D!=null&&D.userName)||!(I!=null&&I.address)||!(I!=null&&I.stationName);if(q&&te)try{const G=await staffApi.getUserById(q);if(!B)return;const E={...I};E.userName||(E.userName=(G==null?void 0:G.userName)||(G==null?void 0:G.UserName)||(G==null?void 0:G.username)||""),E.address||(E.address=(G==null?void 0:G.address)||(G==null?void 0:G.Address)||""),E.stationName||(E.stationName=(G==null?void 0:G.stationName)||((O=G==null?void 0:G.station)==null?void 0:O.name)||(G==null?void 0:G.StationName)||""),c(E)}catch{}}catch{}if((!I||Object.keys(I).length===0)&&(!D||Object.keys(D).length===0)){const q=typeof localStorage<"u"&&!!localStorage.getItem("token");g(q?"You may not have permission to view this profile.":"You are not logged in. Please log in with a staff account.")}}catch(I){if(!B)return;g((I==null?void 0:I.message)||"Failed to load profile")}finally{B&&a(!1)}}return T(),()=>{B=!1}},[e]),!e)return null;let x=l.userName||l.username||u.userName||u.username||"";if(!x)try{const B=typeof localStorage<"u"?localStorage.getItem("token"):null;if(B){const T=staffApi.decodeJwt(B);x=(T==null?void 0:T.preferred_username)||(T==null?void 0:T.unique_name)||(T==null?void 0:T.userName)||(T==null?void 0:T.username)||(T==null?void 0:T.name)||""}}catch{}const j=l.firstName?`${l.firstName} ${l.lastName||""}`.trim():l.fullName||u.fullName||u.name||"",k=l.email||u.email||"",C=l.phoneNumber||u.phoneNumber||"",S=l.address||u.address||"",P=l.createdAt||u.createdAt||"",_=l.employeeId||l.id||u.userId||u.id||"",v=l.stationName||l.station||"",w=l.role||u.role||(Array.isArray(u.roles)?u.roles.join(", "):u.roles||""),b=l.avatarUrl||u.avatarUrl||"https://via.placeholder.com/180x180?text=Staff";return n?i.jsxs("div",{className:"staff-profile-page",children:[i.jsx("div",{className:"staff-cover",children:i.jsx("div",{className:"staff-cover-gradient"})}),i.jsx("div",{className:"staff-header",children:i.jsxs("div",{className:"staff-header-inner",children:[i.jsx("div",{className:"staff-avatar",children:i.jsx("img",{src:b,alt:"Avatar"})}),i.jsxs("div",{className:"staff-title",children:[i.jsx("h1",{children:j}),i.jsxs("div",{className:"staff-meta",children:[i.jsx("span",{className:"staff-role",children:w||""}),i.jsx("span",{className:"staff-sep",children:""}),i.jsx("span",{className:"staff-station",children:v})]})]})]})}),i.jsxs("div",{className:"staff-content",children:[i.jsx("div",{className:"staff-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"About"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Full Name"}),i.jsx("span",{className:"value",children:j})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Role"}),i.jsx("span",{className:"value",children:w||""})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Station"}),i.jsx("span",{className:"value",children:v})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Employee ID"}),i.jsx("span",{className:"value",children:_})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Joined"}),i.jsx("span",{className:"value",children:String(P).toString().slice(0,10)||""})]})]})]})}),i.jsx("div",{className:"staff-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"Contact"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Email"}),i.jsx("span",{className:"value",children:k})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Phone"}),i.jsx("span",{className:"value",children:C})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Address"}),i.jsx("span",{className:"value",children:S})]})]})]})})]}),p&&i.jsx("div",{className:"staff-error",children:p})]}):i.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"profile-modal-content",children:[i.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),i.jsx("h2",{children:"Staff Profile"}),p&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:p}),i.jsx("img",{src:b,alt:"Staff",style:{borderRadius:"50%"}}),s?i.jsx("div",{style:{padding:16},children:"Loading profile"}):i.jsxs("div",{className:"profile-info-grid",children:[i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Name"}),i.jsx("div",{children:j})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Email"}),i.jsx("div",{children:k})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Role"}),i.jsx("div",{children:w||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Phone"}),i.jsx("div",{children:C})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Address"}),i.jsx("div",{children:S})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Joined"}),i.jsx("div",{children:String(P).toString().slice(0,10)||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Employee ID"}),i.jsx("div",{children:_})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Station"}),i.jsx("div",{children:v})]})]})]})})}function oS(){return i.jsx("div",{id:"profile",className:"section",style:{padding:24},children:i.jsx(aS,{open:!0,inline:!0,onClose:()=>{}})})}function lS({incident:e,onClick:t}){var l;const n=c=>{const u={Pending:{background:"#fef3c7",color:"#92400e",icon:"fa-clock"},InProgress:{background:"#dbeafe",color:"#1e40af",icon:"fa-spinner"},Resolved:{background:"#d1fae5",color:"#065f46",icon:"fa-check-circle"}},f=u[c]||u.Pending;return i.jsxs("span",{style:{...f,padding:"4px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:`fas ${f.icon}`}),c]})},s=c=>c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",a=c=>c==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(c);return i.jsxs("div",{className:"incident-card",onClick:()=>t(e),children:[i.jsxs("div",{className:"incident-card-header",children:[i.jsxs("div",{className:"incident-card-title",children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b",marginRight:"8px"}}),i.jsxs("span",{children:["Incident #",(l=e.id)==null?void 0:l.slice(0,8)]})]}),n(e.status)]}),i.jsxs("div",{className:"incident-card-body",children:[i.jsx("div",{className:"incident-description",children:e.description}),i.jsxs("div",{className:"incident-metadata",children:[i.jsxs("div",{className:"incident-meta-item",children:[i.jsx("i",{className:"fas fa-calendar"}),i.jsx("span",{children:s(e.reportedAt)})]}),e.bookingId&&i.jsxs("div",{className:"incident-meta-item",children:[i.jsx("i",{className:"fas fa-ticket-alt"}),i.jsxs("span",{children:["Booking: ",e.bookingId.slice(0,8),"..."]})]}),e.costIncurred!=null&&i.jsxs("div",{className:"incident-meta-item",style:{color:"#dc2626",fontWeight:"600"},children:[i.jsx("i",{className:"fas fa-dollar-sign"}),i.jsx("span",{children:a(e.costIncurred)})]}),e.images&&e.images.length>0&&i.jsxs("div",{className:"incident-meta-item",children:[i.jsx("i",{className:"fas fa-image"}),i.jsxs("span",{children:[e.images.length," image",e.images.length>1?"s":""]})]})]})]}),i.jsx("div",{className:"incident-card-footer",children:i.jsxs("span",{className:"incident-view-details",children:["View Details ",i.jsx("i",{className:"fas fa-arrow-right"})]})})]})}function cS({open:e,onClose:t,onSubmit:n,bookings:s=[]}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState([]),[g,x]=y.useState([]),[j,k]=y.useState(""),[C,S]=y.useState(!1);if(!e)return null;const P=w=>{const B=Array.from(w.target.files).filter(F=>["image/jpeg","image/jpg","image/png","image/gif"].includes(F.type)?F.size>26214400?(k(`File too large: ${F.name}. Max 25MB per file.`),!1):!0:(k(`Invalid file type: ${F.name}. Only JPG, PNG, GIF allowed.`),!1));p(B);const T=B.map(F=>URL.createObjectURL(F));x(T)},_=w=>{const b=f.filter((T,F)=>F!==w),B=g.filter((T,F)=>F!==w);URL.revokeObjectURL(g[w]),p(b),x(B)},v=async()=>{if(k(""),!a){k("Please select a booking");return}if(!c.trim()){k("Please provide incident description");return}S(!0);try{const w=new FormData;w.append("bookingId",a),w.append("description",c.trim()),f.forEach(b=>{w.append("images",b)}),await n(w),l(""),u(""),p([]),g.forEach(b=>URL.revokeObjectURL(b)),x([]),t()}catch(w){k((w==null?void 0:w.message)||"Failed to create incident")}finally{S(!1)}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"650px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("h3",{style:{marginTop:0,marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b"}}),"Report Incident"]}),j&&i.jsxs("div",{style:{background:"#fee2e2",color:"#b91c1c",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:[i.jsx("i",{className:"fas fa-exclamation-circle"})," ",j]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Select Booking ",i.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),i.jsxs("select",{value:a,onChange:w=>l(w.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"-- Select Booking --"}),s.map(w=>i.jsxs("option",{value:w.id,children:["Booking #",w.id.slice(0,8)," - ",w.vehicleName||"Vehicle"," (",w.status,")"]},w.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Incident Description ",i.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),i.jsx("textarea",{value:c,onChange:w=>u(w.target.value),placeholder:"Describe the incident in detail...",rows:5,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",resize:"vertical",fontFamily:"inherit"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:"Upload Images (Optional)"}),i.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.gif",multiple:!0,onChange:P,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",cursor:"pointer"}}),i.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:"Max 25MB per file. Formats: JPG, PNG, GIF"})]}),g.length>0&&i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:["Preview (",g.length," image",g.length>1?"s":"",")"]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px"},children:g.map((w,b)=>i.jsxs("div",{style:{position:"relative"},children:[i.jsx("img",{src:w,alt:`Preview ${b+1}`,style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e5e7eb"}}),i.jsx("button",{onClick:()=>_(b),style:{position:"absolute",top:"4px",right:"4px",background:"#dc2626",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fas fa-times"})})]},b))})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},children:[i.jsx("button",{onClick:t,disabled:C,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",opacity:C?.6:1},children:"Cancel"}),i.jsx("button",{onClick:v,disabled:C,style:{padding:"10px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:C?.6:1},children:C?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-spinner fa-spin"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-plus"}),"Create Incident"]})})]})]})})}function dS({open:e,incident:t,onClose:n,onUpdate:s,onResolve:a,onDelete:l,canDelete:c=!1}){var F,R;const[u,f]=y.useState(!1),[p,g]=y.useState(""),[x,j]=y.useState(""),[k,C]=y.useState(""),[S,P]=y.useState(!1);if(!e||!t)return null;const _=O=>O?new Date(O).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",v=O=>O==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(O),w=()=>{g(t.status||"Pending"),j(t.resolutionNotes||""),C(t.costIncurred||""),f(!0)},b=async()=>{P(!0);try{const O=new FormData;p&&O.append("status",p),x&&O.append("resolutionNotes",x),k&&O.append("costIncurred",k),await s(t.id,O),f(!1)}catch(O){alert((O==null?void 0:O.message)||"Failed to update incident")}finally{P(!1)}},B=async()=>{if(window.confirm("Mark this incident as resolved?")){P(!0);try{await a(t.id,x,k||0),n()}catch(O){alert((O==null?void 0:O.message)||"Failed to resolve incident")}finally{P(!1)}}},T=async()=>{if(window.confirm("Are you sure you want to delete this incident? This action cannot be undone.")){P(!0);try{await l(t.id),n()}catch(O){alert((O==null?void 0:O.message)||"Failed to delete incident")}finally{P(!1)}}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",background:"#fef9e7",border:"2px solid #d4af37",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",position:"relative"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsxs("div",{style:{textAlign:"center",borderBottom:"3px double #d4af37",paddingBottom:"20px",marginBottom:"24px"},children:[i.jsx("h2",{style:{margin:"0 0 8px 0",fontFamily:"Georgia, serif",color:"#1f2937",fontSize:"28px",fontWeight:"bold"},children:"INCIDENT REPORT"}),i.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",fontFamily:"Georgia, serif"},children:"Official Documentation"}),i.jsxs("div",{style:{display:"inline-block",marginTop:"12px",padding:"6px 16px",background:t.status==="Resolved"?"#d1fae5":t.status==="InProgress"?"#dbeafe":"#fef3c7",color:t.status==="Resolved"?"#065f46":t.status==="InProgress"?"#1e40af":"#92400e",borderRadius:"20px",fontSize:"13px",fontWeight:"600",border:`2px solid ${t.status==="Resolved"?"#10b981":t.status==="InProgress"?"#3b82f6":"#f59e0b"}`},children:["STATUS: ",(F=t.status)==null?void 0:F.toUpperCase()]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"24px",fontFamily:"Georgia, serif"},children:[i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Report ID:"}),i.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.id})]}),i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Reported Date:"}),i.jsx("div",{style:{color:"#1f2937",marginTop:"4px"},children:_(t.reportedAt)})]}),i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Booking Reference:"}),i.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[(R=t.bookingId)==null?void 0:R.slice(0,16),"..."]})]}),t.stationId&&i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Station ID:"}),i.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[t.stationId.slice(0,16),"..."]})]})]}),i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Incident Description:"}),i.jsx("p",{style:{color:"#1f2937",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.description})]}),t.images&&t.images.length>0&&i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsxs("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:["Evidence Photos (",t.images.length,"):"]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:t.images.map((O,I)=>i.jsx("a",{href:O,target:"_blank",rel:"noopener noreferrer",style:{display:"block"},children:i.jsx("img",{src:O,alt:`Evidence ${I+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",border:"2px solid #d4af37",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:D=>D.currentTarget.style.transform="scale(1.05)",onMouseOut:D=>D.currentTarget.style.transform="scale(1)"})},I))})]}),u?i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"2px solid #3b82f6"},children:[i.jsx("strong",{style:{fontSize:"16px",display:"block",marginBottom:"12px"},children:"Update Incident:"}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Status:"}),i.jsxs("select",{value:p,onChange:O=>g(O.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"},children:[i.jsx("option",{value:"Pending",children:"Pending"}),i.jsx("option",{value:"InProgress",children:"In Progress"}),i.jsx("option",{value:"Resolved",children:"Resolved"})]})]}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Resolution Notes:"}),i.jsx("textarea",{value:x,onChange:O=>j(O.target.value),rows:4,placeholder:"Enter resolution details...",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Cost Incurred (VND):"}),i.jsx("input",{type:"number",value:k,onChange:O=>C(O.target.value),placeholder:"0",min:"0",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"}})]})]}):i.jsxs(i.Fragment,{children:[t.resolutionNotes&&i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#d1fae5",borderRadius:"8px",border:"1px solid #10b981"},children:[i.jsx("strong",{style:{color:"#065f46",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Resolution Notes:"}),i.jsx("p",{style:{color:"#047857",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.resolutionNotes})]}),t.costIncurred!=null&&i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#fee2e2",borderRadius:"8px",border:"1px solid #dc2626"},children:[i.jsx("strong",{style:{color:"#991b1b",fontSize:"16px",display:"block",marginBottom:"8px",fontFamily:"Georgia, serif"},children:"Cost Incurred:"}),i.jsx("div",{style:{color:"#dc2626",fontSize:"24px",fontWeight:"bold",fontFamily:"Georgia, serif"},children:v(t.costIncurred)})]})]}),i.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"20px",borderTop:"2px solid #e5e7eb",flexWrap:"wrap"},children:u?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>f(!1),disabled:S,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer",opacity:S?.6:1},children:[i.jsx("i",{className:"fas fa-times"})," Cancel"]}),i.jsxs("button",{onClick:b,disabled:S,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer",opacity:S?.6:1},children:[i.jsx("i",{className:"fas fa-save"})," ",S?"Saving...":"Save Changes"]})]}):i.jsxs(i.Fragment,{children:[c&&i.jsxs("button",{onClick:T,disabled:S,style:{padding:"10px 20px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer",marginRight:"auto"},children:[i.jsx("i",{className:"fas fa-trash"})," Delete"]}),t.status!=="Resolved"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:w,disabled:S,style:{padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:[i.jsx("i",{className:"fas fa-edit"})," Edit"]}),i.jsxs("button",{onClick:B,disabled:S,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer"},children:[i.jsx("i",{className:"fas fa-check-circle"})," ",S?"Resolving...":"Mark Resolved"]})]}),i.jsx("button",{onClick:n,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Close"})]})})]})})}function uS({incidents:e=[],bookings:t=[],onCreateIncident:n,onUpdateIncident:s,onResolveIncident:a,onDeleteIncident:l,onRefresh:c,canDelete:u=!0,stationFilter:f=null}){const[p,g]=y.useState(!1),[x,j]=y.useState(!1),[k,C]=y.useState(null),[S,P]=y.useState(""),[_,v]=y.useState(""),w=e.filter(O=>{if(S&&O.status!==S)return!1;if(_){const I=_.toLowerCase(),D=(O.description||"").toLowerCase(),q=(O.id||"").toLowerCase(),te=(O.bookingId||"").toLowerCase();if(!D.includes(I)&&!q.includes(I)&&!te.includes(I))return!1}return!0}),b=O=>{C(O),j(!0)},B=async O=>{await n(O),c&&await c()},T=async(O,I)=>{await s(O,I),c&&await c(),j(!1)},F=async(O,I,D)=>{await a(O,I,D),c&&await c()},R=async O=>{await l(O),c&&await c()};return i.jsxs("div",{id:"incident",className:"section",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[i.jsxs("button",{className:"incident-add-btn",onClick:()=>g(!0),children:[i.jsx("i",{className:"fas fa-plus"})," Report Incident"]}),i.jsxs("div",{className:"incident-filters",style:{flex:1,display:"flex",gap:"12px"},children:[i.jsxs("select",{className:"incident-filter-select",value:S,onChange:O=>P(O.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"Pending",children:"Pending"}),i.jsx("option",{value:"InProgress",children:"In Progress"}),i.jsx("option",{value:"Resolved",children:"Resolved"})]}),i.jsx("input",{className:"incident-search-input",type:"text",placeholder:"Search by description, ID, or booking...",value:_,onChange:O=>v(O.target.value)})]})]}),i.jsx("div",{style:{padding:"8px 8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},children:w.length===0?"No incidents found":`Showing ${w.length} incident${w.length>1?"s":""}`}),w.length>0?i.jsx("div",{className:"incident-grid",children:w.map(O=>i.jsx(lS,{incident:O,onClick:b},O.id))}):i.jsxs("div",{className:"incident-empty-state",children:[i.jsx("i",{className:"fas fa-clipboard-check"}),i.jsx("h3",{children:"No Incidents"}),i.jsx("p",{children:_||S?"No incidents match your filters":"No incidents have been reported yet"})]}),i.jsx(cS,{open:p,onClose:()=>g(!1),onSubmit:B,bookings:t}),i.jsx(dS,{open:x,incident:k,onClose:()=>j(!1),onUpdate:T,onResolve:F,onDelete:R,canDelete:u})]})}const fS=[],hS=[];function pS(){var Ve,ht,qe,Ct;const[e,t]=y.useState("booking"),[n,s]=y.useState(fS),[a,l]=y.useState(hS),[c,u]=y.useState(!1),[f,p]=y.useState(""),[g,x]=y.useState(""),[j,k]=y.useState([]),[C,S]=y.useState([]),[P,_]=y.useState(!1),[v,w]=y.useState(""),[b,B]=y.useState(!1),[T,F]=y.useState(!1),[R,O]=y.useState(!1),[I,D]=y.useState(""),[q,te]=y.useState(""),[G,E]=y.useState(""),[oe,Ne]=y.useState(null),W=async ge=>{try{await $e.confirmBooking(ge.id,"Cash",""),s(ae=>ae.map(ye=>ye.id===ge.id?{...ye,status:"booked"}:ye))}catch(ae){D((ae==null?void 0:ae.message)||"Failed to proceed to payment")}},fe=async(ge,ae="")=>{var ye;try{await $e.cancelBooking(ge.id,ae||""),s(ue=>ue.map(xe=>xe.id===ge.id?{...xe,status:"denied"}:xe))}catch(ue){const xe=(ye=ue==null?void 0:ue.response)==null?void 0:ye.status;if(xe===401||xe===403){alert("You don't have permission to cancel this booking.");return}D((ue==null?void 0:ue.message)||"Failed to cancel booking")}},re=(ge,ae)=>{const ye=ae==="pending"?"Pending":ae==="booked"?"Active Rental":ae==="waiting-checkin"?"Waiting Check-in":ae==="checked-in"?"Checked-in":ae==="checkout-pending"?"Check-out Pending":ae==="completed"?"Completed":ae==="cancelled-pending"?"Cancelled (Pending Refund)":ae==="cancelled"?"Cancelled":ae;s(ue=>ue.map(xe=>xe.id===ge?{...xe,status:ae,statusLabel:ye}:xe))},U=async ge=>{var ae;try{const ye=ge.get("bookingId")||"",ue=ge.get("description")||"";let xe=[];try{xe=ge.getAll?ge.getAll("images"):[]}catch{xe=[]}const Ie=await $e.createIncident(ye,ue,xe);try{await ie(v)}catch{}return Ie}catch(ye){throw console.error(" create incident failed",((ae=ye==null?void 0:ye.response)==null?void 0:ae.data)||(ye==null?void 0:ye.message)||ye),ye}},ie=async ge=>{if(!ge){S([]);return}_(!0);try{const ae=await $e.getAllIncidents(ge,null,null,null,1,200),ue=((ae==null?void 0:ae.incidents)||[]||[]).map(xe=>({id:xe.id||xe.Id||xe.incidentId||xe.IncidentId||xe._id&&String(xe._id),description:xe.description||xe.Description||xe.details||"",bookingId:xe.bookingId||xe.BookingId||xe.booking||null,images:xe.images||xe.Images||[],status:xe.status||xe.Status||"Pending",reportedAt:xe.reportedAt||xe.ReportedAt||xe.createdAt||xe.CreatedAt||xe.date||null,costIncurred:xe.costIncurred??xe.CostIncurred??xe.cost??null,stationId:xe.stationId||xe.StationId||null,raw:xe}));S(ue)}catch(ae){console.error(" failed to load incidents for station",ae),S([])}finally{_(!1)}},Z=async(ge,ae)=>{try{await $e.updateIncident(ge,ae),await ie(v)}catch(ye){throw console.error(" update incident failed",ye),ye}},se=async(ge,ae,ye)=>{try{await $e.resolveIncident(ge,ae,Number(ye)||0),await ie(v)}catch(ue){throw console.error(" resolve incident failed",ue),ue}},ne=async ge=>{try{await $e.deleteIncident(ge),await ie(v)}catch(ae){throw console.error(" delete incident failed",ae),ae}},ce=async ge=>{try{if(!v){D("Please select a station before creating a vehicle.");return}const ae={...ge};ae.currentStationId=v,ae.stationId=v,ae.StationId=v,ae.rentalPricePerDate!=null&&ae.rentalPricePerDay==null&&(ae.rentalPricePerDay=ae.rentalPricePerDate),ae.rentalPricePerDay!=null&&ae.rentalPricePerDate==null&&(ae.rentalPricePerDate=ae.rentalPricePerDay),ae.batteryCapacity!=null&&ae.BatteryCapacity==null&&(ae.BatteryCapacity=ae.batteryCapacity),ae.currentBatteryLevel!=null&&ae.CurrentBatteryLevel==null&&(ae.CurrentBatteryLevel=ae.currentBatteryLevel);const ye=await $e.createCar(ae),ue=ye||{},xe=Ie=>({id:Ie.id||Ie.Id||Ie.carId||Ie.CarId,name:Ie.name||Ie.Name||[Ie.brand,Ie.model].filter(Boolean).join(" ")||"Car",model:Ie.model||Ie.Model||null,brand:Ie.brand||Ie.Brand||null,licensePlate:Ie.licensePlate||Ie.LicensePlate||null,img:Ie.imageUrl||Ie.image||Ie.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Ie.name||Ie.Name||Ie.model||"Car")}`,battery:Number.isFinite(Ie.currentBatteryLevel)?Math.round(Ie.currentBatteryLevel):void 0,tech:Ie.condition??Ie.status??Ie.Status??null,issue:Ie.issue??Ie.issueDescription??null,capacity:Ie.batteryCapacity??Ie.BatteryCapacity??Ie.capacity??Ie.capacityKWh??Ie.batteryCapacityKWh??null});return l(Ie=>[...Ie,xe(ue)]),await he(v),ye}catch(ae){throw D((ae==null?void 0:ae.message)||"Failed to create vehicle"),ae}},ke=async ge=>{var ae;try{await $e.deleteCar(ge),l(ye=>ye.filter(ue=>ue.id!==ge)),await he(v)}catch(ye){const ue=(ae=ye==null?void 0:ye.response)==null?void 0:ae.status;if(ue===401||ue===403){te("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const xe=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Ie=!1;for(const Ut of xe)try{await $e.updateStatus(ge,Ut),Ie=!0;break}catch{}if(Ie){l(Ut=>Ut.filter(jn=>jn.id!==ge));return}}catch{}D((ye==null?void 0:ye.message)||"Failed to delete vehicle")}},we=async(ge,ae)=>{try{if(ae.battery!==void 0&&ae.battery!==""){let ye=Number(ae.battery);Number.isNaN(ye)||(ye=Math.max(0,Math.min(100,Math.round(ye))),await $e.updateBatteryLevel(ge,ye))}if(ae.tech&&await $e.updateStatus(ge,ae.tech),ae.issue)try{await $e.updateCarDescription(ge,ae.issue)}catch{await $e.updateCar(ge,{description:ae.issue})}}catch(ye){D((ye==null?void 0:ye.message)||"Failed to update vehicle")}l(ye=>ye.map(ue=>ue.id===ge?{...ue,...ae}:ue))},he=async ge=>{if(!ge){Ne(null);return}try{const ae=await $e.getCarStatusReport(ge,null);ae&&Ne({totalCars:ae.totalCars||0,availableCars:ae.availableCars||0})}catch(ae){console.warn("Failed to load station slots:",ae)}};return y.useEffect(()=>{c?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[c]),y.useEffect(()=>{let ge=!0;async function ae(){try{const ue=await $e.getMe(),xe=(ue==null?void 0:ue.role)||(ue==null?void 0:ue.Role)||(ue==null?void 0:ue.roleName)||(ue==null?void 0:ue.userRole)||(Array.isArray(ue==null?void 0:ue.roles)?ue.roles[0]:"");ge&&E(xe||"")}catch{try{const ue=localStorage.getItem("token");if(ue){const xe=$e.decodeJwt(ue),Ie=(xe==null?void 0:xe.role)||(xe==null?void 0:xe.Role)||xe["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];ge&&E(Ie||"")}}catch{}}}async function ye(){try{F(!0);const ue=localStorage.getItem("stationId");if(ue){console.log(" Staff assigned station from localStorage:",ue),ge&&w(ue);try{const Ie=await $e.getAllStations(1,100);ge&&k(Ie||[])}catch(Ie){console.warn(" Failed to load stations for display:",Ie)}return}console.warn(" No stationId found in localStorage for staff user");const xe=await $e.getAllStations(1,100);if(!ge)return;k(xe||[])}catch(ue){if(!ge)return;D((ue==null?void 0:ue.message)||"Failed to load stations")}finally{ge&&F(!1)}}return ae(),ye(),()=>{ge=!1}},[]),y.useEffect(()=>{let ge=!0;async function ae(){try{B(!0);let ue=[];if(v){let Se=[],z=[];try{Se=await $e.getCarsByStation(v)}catch{}try{z=await $e.getAvailableCarsByStation(v)}catch{}const X=J=>Array.isArray(J)?J:J?[J]:[],ee=X(Se),Q=X(z),M=new Map;for(const J of[...ee,...Q]){const Ue=String((J==null?void 0:J.id)||(J==null?void 0:J.Id)||(J==null?void 0:J.carId)||(J==null?void 0:J.CarId)||(J==null?void 0:J.licensePlate)||(J==null?void 0:J.LicensePlate)||Math.random());M.has(Ue)||M.set(Ue,J)}ue=Array.from(M.values());try{const J=await $e.getAllCars(1,1e3),Ue=je=>je==null?"":String(je).replace(/[{}]/g,"").toLowerCase(),ve=Ue(v),We=(J||[]).filter(je=>{var Le,Be,me,V;return[je.currentStationId,je.CurrentStationId,je.currentStationID,je.stationId,je.StationId,je.stationID,(Le=je.station)==null?void 0:Le.id,(Be=je.station)==null?void 0:Be.Id,(me=je.station)==null?void 0:me.stationId,(V=je.station)==null?void 0:V.StationId].some(ze=>ze!=null&&Ue(ze)===ve)});for(const je of We){const $=String((je==null?void 0:je.id)||(je==null?void 0:je.Id)||(je==null?void 0:je.carId)||(je==null?void 0:je.CarId)||(je==null?void 0:je.licensePlate)||(je==null?void 0:je.LicensePlate));$&&!M.has($)&&M.set($,je)}ue=Array.from(M.values())}catch{}}else try{ue=await $e.getAllCars(1,1e3)}catch{try{ue=await $e.listCars({page:1,pageSize:1e3})}catch{ue=[]}}if(Array.isArray(ue)||(ue=ue?[ue]:[]),!ge)return;const xe=Se=>{const z=Number(Se);return Number.isFinite(z)&&z>=0&&z<=100?Math.round(z):null},Ie=(ue||[]).map(Se=>{var J,Ue,ve,We;const X=((...je)=>je.find($=>$!=null&&$!==""))(Se.currentStationId,Se.CurrentStationId,Se.currentStationID,Se.stationId,Se.StationId,Se.stationID,(J=Se.station)==null?void 0:J.id,(Ue=Se.station)==null?void 0:Ue.Id,(ve=Se.station)==null?void 0:ve.stationId,(We=Se.station)==null?void 0:We.StationId),ee=je=>je==null?"":String(je).replace(/[{}]/g,"").toLowerCase(),Q=X||"",M=(()=>{if(!Q)return null;const je=j.find($=>ee($.id||$.Id)===ee(Q))||null;return je&&(je.name||je.Name)||null})();return{id:Se.id||Se.Id||Se.carId||Se.CarId,name:Se.name||Se.Name||Se.model||Se.CarName||"Car",model:Se.model||Se.Model||null,brand:Se.brand||Se.Brand||null,licensePlate:Se.licensePlate||Se.LicensePlate||null,img:Se.imageUrl||Se.image||Se.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Se.name||Se.Name||"Car")}`,battery:xe(Se.currentBatteryLevel??Se.CurrentBatteryLevel??Se.batteryPercent??Se.battery),tech:Se.condition??Se.status??Se.Status??null,issue:Se.issue??Se.issueDescription??null,capacity:Se.batteryCapacity??Se.BatteryCapacity??Se.capacity??Se.capacityKWh??Se.batteryCapacityKWh??null,stationId:Q,stationName:M||null}});l(Ie);const Ut=Ie.filter(Se=>Se.battery==null),jn=Ie.filter(Se=>Se.capacity==null);if(Ut.length>0)try{const Se=await Promise.all(Ut.map(async z=>{try{const X=await $e.getCarBattery(z.id);return{id:z.id,battery:xe(X)}}catch{return{id:z.id,battery:null}}}));if(!ge)return;l(z=>z.map(X=>{const ee=Se.find(Q=>Q.id===X.id);return ee&&ee.battery!=null?{...X,battery:ee.battery}:X}))}catch{}if(jn.length>0)try{const Se=await Promise.all(jn.map(async z=>{try{const X=await $e.getCarCapacity(z.id);return{id:z.id,capacity:X}}catch{return{id:z.id,capacity:null}}}));if(!ge)return;l(z=>z.map(X=>{const ee=Se.find(Q=>Q.id===X.id);return ee&&ee.capacity!=null?{...X,capacity:ee.capacity}:X}))}catch{}}catch(ue){if(!ge)return;D((ue==null?void 0:ue.message)||"Failed to load vehicles")}finally{ge&&B(!1)}}async function ye(){ge&&await he(v)}return ae(),ye(),()=>{ge=!1}},[v,j]),y.useEffect(()=>{let ge=!0;async function ae(){try{O(!0);let ye=[];if(v){console.log(" Loading active bookings for station:",v);try{ye=await $e.getBookingsByStation(v,1,200),console.log(" Loaded active bookings:",ye==null?void 0:ye.length)}catch(z){console.error(" Error loading bookings:",z),ye=[]}}else console.warn(" No station ID set"),ye=[];if(!ge)return;const ue=(ye||[]).map(z=>{var Mt,mt,gt,tn,Ei,Ti,Bi,Qr,Lt,Pe,yr,vr,xr,_r,Qn,wr,un,jr,Jr,Xr,ei,ti,Sr,ni,Un,ri,ii,si,ai,oi,Jn,Sn,Nr,Cr,Nn,Me,Ke,Mn,fn,hn,Xn,Te,Je;const X=z.id||z.Id||z.bookingId||z.BookingId,ee=((Mt=z.car)==null?void 0:Mt.brand)||((mt=z.car)==null?void 0:mt.Brand)||((gt=z.vehicle)==null?void 0:gt.brand)||((tn=z.vehicle)==null?void 0:tn.Brand)||z.carBrand||z.CarBrand||null,Q=((Ei=z.car)==null?void 0:Ei.model)||((Ti=z.car)==null?void 0:Ti.Model)||((Bi=z.vehicle)==null?void 0:Bi.model)||((Qr=z.vehicle)==null?void 0:Qr.Model)||z.carModel||z.CarModel||null;let M=z.carName||z.vehicleName||((Lt=z.car)==null?void 0:Lt.name)||((Pe=z.car)==null?void 0:Pe.Name)||null;!M&&(ee||Q)&&(M=[ee,Q].filter(Boolean).join(" ").trim()||null),!M&&typeof z.carInfo=="string"&&z.carInfo.trim()&&(M=z.carInfo.trim()),!M&&typeof z.CarInfo=="string"&&z.CarInfo.trim()&&(M=z.CarInfo.trim()),M=M||"Booking";const J=((yr=z.user)==null?void 0:yr.firstName)||((vr=z.customer)==null?void 0:vr.firstName)||z.firstName||z.FirstName||((xr=z.user)==null?void 0:xr.FirstName)||((_r=z.customer)==null?void 0:_r.FirstName),Ue=((Qn=z.user)==null?void 0:Qn.lastName)||((wr=z.customer)==null?void 0:wr.lastName)||z.lastName||z.LastName||((un=z.user)==null?void 0:un.LastName)||((jr=z.customer)==null?void 0:jr.LastName),ve=[J,Ue].filter(Boolean).join(" "),We=ve||z.customerName||z.userFullName||((Jr=z.user)==null?void 0:Jr.fullName)||((Xr=z.customer)==null?void 0:Xr.name)||((ei=z.user)==null?void 0:ei.name)||"Customer",je=z.userId||z.UserId||((ti=z.user)==null?void 0:ti.id)||((Sr=z.user)==null?void 0:Sr.Id)||z.customerId||z.CustomerId||z.appUserId||z.AppUserId||z.accountId||z.AccountId||z.UserID||z.ownerId||z.OwnerId||z.createdById||z.CreatedById||"",$=((ni=z.user)==null?void 0:ni.userName)||((Un=z.user)==null?void 0:Un.UserName)||((ri=z.user)==null?void 0:ri.username)||z.userName||z.UserName||z.username||null,Le=((ii=z.user)==null?void 0:ii.email)||z.customerEmail||z.email||z.userEmail||"",Be=((si=z.user)==null?void 0:si.address)||z.customerAddress||z.address||"",me=z.statusCode??z.StatusCode??z.bookingStatus??z.BookingStatus??z.status??z.Status;let V="booked";if(me!=null&&(typeof me=="number"||/^\d+$/.test(String(me)))){const Ge=Number(me);Ge===0?V="pending":Ge===1?V="booked":Ge===2?V="waiting-checkin":Ge===3?V="checked-in":Ge===4?V="checkout-pending":Ge===5?V="completed":Ge===6?V="cancelled-pending":Ge===7&&(V="cancelled")}else{const Ge=String(me||"").toLowerCase();Ge.includes("pending")||Ge.includes("wait")?V="pending":Ge.includes("check")&&Ge.includes("in")?V="checked-in":Ge.includes("complete")||Ge.includes("finish")?V="completed":Ge.includes("cancel")?V="cancelled":V="booked"}const ze=V==="pending"?"Pending":V==="booked"?"Active Rental":V==="waiting-checkin"?"Waiting Check-in":V==="checked-in"?"Checked-in":V==="checkout-pending"?"Check-out Pending":V==="completed"?"Completed":V==="cancelled-pending"?"Cancelled (Pending Refund)":V==="cancelled"?"Cancelled":String(me||"")||"Booked",Ye=String(me||"").toLowerCase(),be=Number(me)===0||Ye.includes("pending")||Ye.includes("wait")?"waiting-payment":Ye.includes("check")&&Ye.includes("in")&&(Ye.includes("pay")||Ye.includes("payment"))?"checkin-payment":null;let tt=z.date||z.createdAt||z.bookingDate||"";if(tt)try{const Ge=new Date(tt);isNaN(Ge.getTime())||(tt=Ge.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:void 0}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5"))}catch{}const Vt=z.carImageUrl||((ai=z.car)==null?void 0:ai.imageUrl)||((oi=z.vehicle)==null?void 0:oi.imageUrl)||`https://via.placeholder.com/440x280?text=${encodeURIComponent(M)}`,dn=Ge=>{if(!Ge)return null;try{const Cn=new Date(Ge);if(!isNaN(Cn.getTime()))return Cn.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5")}catch{}return Ge},mr=dn(z.pickupDate||z.rentalStartDate||z.startDateTime||z.startDate),gr=dn(z.returnDate||z.rentalEndDate||z.endDateTime||z.endDate);return{id:X,title:M,firstName:J||null,lastName:Ue||null,fullName:ve||z.userFullName||((Jn=z.user)==null?void 0:Jn.fullName)||((Sn=z.customer)==null?void 0:Sn.name)||((Nr=z.user)==null?void 0:Nr.name)||null,customer:We,userId:je,userName:$,email:Le,address:Be,status:V,statusLabel:ze,uiStage:be,date:tt,pickupDate:mr,returnDate:gr,img:Vt,cccdFrontUrl:z.cccdFrontUrl||z.identityFrontUrl||z.idFrontUrl||z.frontImageUrl||z.frontIdUrl||z.cccdFrontImageUrl||((Cr=z.customer)==null?void 0:Cr.cccdFrontUrl)||((Nn=z.user)==null?void 0:Nn.cccdFrontUrl),cccdBackUrl:z.cccdBackUrl||z.identityBackUrl||z.idBackUrl||z.backImageUrl||z.backIdUrl||z.cccdBackImageUrl||((Me=z.customer)==null?void 0:Me.cccdBackUrl)||((Ke=z.user)==null?void 0:Ke.cccdBackUrl),gplxFrontUrl:z.gplxFrontUrl||z.driverLicenseFrontUrl||z.gplxImageUrl_Front||((Mn=z.customer)==null?void 0:Mn.gplxImageUrl_Front)||((fn=z.user)==null?void 0:fn.gplxImageUrl_Front),gplxBackUrl:z.gplxBackUrl||z.driverLicenseBackUrl||z.gplxImageUrl_Back||((hn=z.customer)==null?void 0:hn.gplxImageUrl_Back)||((Xn=z.user)==null?void 0:Xn.gplxImageUrl_Back),idString:z.customerIdNumber||((Te=z.user)==null?void 0:Te.identityNumber)||"",phone:z.customerPhone||((Je=z.user)==null?void 0:Je.phoneNumber)||""}});s(ue);const xe=ue.filter(z=>z.userId&&!(z.firstName&&z.lastName));if(xe.length>0)try{const z=Array.from(new Set(xe.map(Q=>Q.userId))),X=await Promise.all(z.map(async Q=>{try{const M=await $e.getUserById(Q),J=(M==null?void 0:M.firstName)||(M==null?void 0:M.FirstName)||(M==null?void 0:M.givenName)||(M==null?void 0:M.GivenName)||null,Ue=(M==null?void 0:M.lastName)||(M==null?void 0:M.LastName)||(M==null?void 0:M.surname)||(M==null?void 0:M.Surname)||null,ve=(M==null?void 0:M.fullName)||(M==null?void 0:M.FullName)||[J,Ue].filter(Boolean).join(" ")||null,We=(M==null?void 0:M.userName)||(M==null?void 0:M.UserName)||(M==null?void 0:M.username)||(M==null?void 0:M.user_name)||null,je=(M==null?void 0:M.address)||(M==null?void 0:M.Address)||"";return{uid:Q,firstName:J,lastName:Ue,fullName:ve,userName:We,address:je}}catch{return{uid:Q,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!ge)return;const ee=new Map(X.map(Q=>[Q.uid,Q]));s(Q=>Q.map(M=>{if(M.userId&&ee.has(M.userId)){const J=ee.get(M.userId),Ue=M.fullName||J.fullName||[J.firstName,J.lastName].filter(Boolean).join(" ");return{...M,firstName:M.firstName??J.firstName??null,lastName:M.lastName??J.lastName??null,fullName:Ue||M.customer||M.userName||null,userName:M.userName??J.userName,address:M.address||J.address}}return M}))}catch{}const Ie=z=>{var X,ee,Q,M;return z.carId||z.CarId||z.vehicleId||z.VehicleId||((X=z.car)==null?void 0:X.id)||((ee=z.car)==null?void 0:ee.Id)||((Q=z.vehicle)==null?void 0:Q.id)||((M=z.vehicle)==null?void 0:M.Id)},Ut=ue.filter(z=>(!z.title||z.title==="Booking")&&Ie(z));if(Ut.length>0)try{const z=Array.from(new Set(Ut.map(Ie).filter(Boolean))),X=await Promise.all(z.map(async Q=>{try{let M=await $e.getCarById(Q);if(!M||!M.id&&!M.Id)try{M=await $e.getCarByIdRest(Q)}catch{}const J=(M==null?void 0:M.name)||(M==null?void 0:M.Name)||[M==null?void 0:M.brand,M==null?void 0:M.model].filter(Boolean).join(" ")||null,Ue=(M==null?void 0:M.imageUrl)||(M==null?void 0:M.thumbnailUrl)||null;return{cid:Q,name:J,img:Ue}}catch{return{cid:Q,name:null,img:null}}})),ee=new Map(X.map(Q=>[String(Q.cid),Q]));s(Q=>Q.map(M=>{const J=Ie(M),Ue=J!=null?String(J):null;if(Ue&&ee.has(Ue)){const ve=ee.get(Ue);return{...M,title:M.title&&M.title!=="Booking"?M.title:ve.name||M.title,img:M.img||ve.img||M.img}}return M}))}catch{}const Se=(z=>z.filter(X=>!X.title||X.title==="Booking"))(ue);if(Se.length>0)try{const z=await Promise.all(Se.map(async ee=>{try{const Q=await $e.getVehicleModelFromBooking(ee.id),M=(Q==null?void 0:Q.name)||[Q==null?void 0:Q.brand,Q==null?void 0:Q.model].filter(Boolean).join(" ")||null;return{id:ee.id,title:M}}catch{return{id:ee.id,title:null}}})),X=new Map(z.map(ee=>[ee.id,ee.title]));s(ee=>ee.map(Q=>X.has(Q.id)&&X.get(Q.id)?{...Q,title:X.get(Q.id)}:Q))}catch{}}catch(ye){if(!ge)return;D((ye==null?void 0:ye.message)||"Failed to load bookings")}finally{ge&&O(!1)}}return ae(),()=>{ge=!1}},[v]),y.useEffect(()=>{ie(v)},[v]),i.jsxs("div",{className:"app-layout",children:[i.jsx(Hj,{}),i.jsx("div",{className:"sidebar-hover-zone",onMouseEnter:()=>u(!0)}),i.jsx("div",{className:`sidebar-wrapper ${c?"visible":""}`,onMouseLeave:()=>u(!1),children:i.jsx(Zj,{onSelect:t,isOpen:!0})}),i.jsxs("main",{className:`main-content ${c?"shifted":""}`,children:[q&&i.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:q}),I&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),e==="booking"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((Ve=j.find(ge=>(ge.id||ge.Id)===v))==null?void 0:Ve.name)||((ht=j.find(ge=>(ge.id||ge.Id)===v))==null?void 0:ht.Name)||v}),R&&i.jsx("span",{children:"Loading bookings"})]}),!R&&n.length===0&&i.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),i.jsx(Xj,{bookings:n,search:f,setSearch:p,statusFilter:g,setStatusFilter:x,onContinuePayment:W,onCancelBooking:fe,onStatusUpdated:re})]}),e==="vehicle"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((qe=j.find(ge=>(ge.id||ge.Id)===v))==null?void 0:qe.name)||((Ct=j.find(ge=>(ge.id||ge.Id)===v))==null?void 0:Ct.Name)||v}),b&&i.jsx("span",{children:"Loading vehicles"})]}),i.jsx(sS,{vehicles:a,onAdd:ce,onRemove:ke,onUpdate:we,stationId:v,canDelete:String(G).toLowerCase()==="admin",stationSlots:oe})]}),e==="incident"&&i.jsx(uS,{incidents:C,bookings:n,onCreateIncident:U,onUpdateIncident:Z,onResolveIncident:se,onDeleteIncident:ne,onRefresh:async()=>{await ie(v)},canDelete:!0,stationFilter:v}),e==="profile"&&i.jsx(oS,{})]})]})}function mS(){return i.jsxs("header",{className:"header-bar",children:[i.jsx("div",{className:"header-title",children:"Admin Page"}),i.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function gS({onSelect:e,isOpen:t,toggleSidebar:n}){return y.useEffect(()=>{t?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[t]),i.jsxs(i.Fragment,{children:[t&&i.jsx("div",{className:"sidebar-collider",onClick:n}),i.jsxs("div",{className:`sidebar ${t?"active":""}`,children:[i.jsx("h2",{children:"FEC Admin"}),i.jsx("div",{style:{marginTop:"60px"}}),i.jsxs("button",{onClick:()=>e("booking"),children:[i.jsx("i",{className:"fas fa-calendar-alt"})," Booking"]}),i.jsxs("button",{onClick:()=>e("vehicle"),children:[i.jsx("i",{className:"fas fa-car"})," Vehicle"]}),i.jsxs("button",{onClick:()=>e("user"),children:[i.jsx("i",{className:"fas fa-users"})," User"]}),i.jsxs("button",{onClick:()=>e("staff"),children:[i.jsx("i",{className:"fas fa-user-tie"})," Staff"]}),i.jsxs("button",{onClick:()=>e("incident"),children:[i.jsx("i",{className:"fas fa-exclamation-triangle"})," Incident"]}),i.jsxs("button",{onClick:()=>e("profile"),children:[i.jsx("i",{className:"fas fa-user-circle"})," Profile"]})]})]})}function yS({booking:e,onClick:t}){let n="booking-status-chip ";e.status==="booked"?n+="booking-status-booked":e.status==="denied"?n+="booking-status-denied":e.status==="completed"?n+="booking-status-completed":e.status==="pending"?n+="booking-status-pending":e.status==="checked-in"&&(n+="booking-status-checkedin");const s=a=>{jl(a.currentTarget)};return i.jsxs("div",{className:"booking-card",onClick:t,children:[i.jsx("img",{src:Sl(e.img),alt:e.title,onError:s}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),i.jsx("div",{className:n,children:e.statusLabel||(e.status?e.status.toUpperCase():"")})]})}function vS({booking:e,onClick:t}){const n="booking-status-chip booking-status-pending",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return i.jsxs("div",{className:"booking-card waiting-payment",onClick:t,children:[i.jsx("img",{src:e.img,alt:e.title}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsxs("div",{className:"loading-row",title:"Waiting for payment confirmation",children:[i.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),i.jsx("div",{className:"booking-subtext",children:"Waiting for Payment"})]})]}),i.jsx("div",{className:n,children:"Pending"})]})}function xS({booking:e,onClick:t}){const n="booking-status-chip booking-status-checkedin",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return i.jsxs("div",{className:"booking-card checkin-payment",onClick:t,children:[i.jsx("img",{src:e.img,alt:e.title}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsx("div",{className:"booking-subtext",children:"Payment In Waiting"})]}),i.jsx("div",{className:n,children:"Payment In Waiting"})]})}const Re={confirmBooking:$t.confirmBooking,cancelBooking:$t.cancelBooking,completeBooking:$t.completeBooking,getBookingById:$t.getBookingById,listBookings:async(e={})=>{var t;try{const{page:n=1,pageSize:s=100}=e;console.log(` Listing bookings: page=${n}, pageSize=${s}`);const a=await de.get("/Bookings/Get-All",{params:{pageNumber:n,pageSize:s}}),l=a==null?void 0:a.data;return Array.isArray(l)?l:l!=null&&l.data&&Array.isArray(l.data)?l.data:(t=l==null?void 0:l.data)!=null&&t.data&&Array.isArray(l.data.data)?l.data.data:l!=null&&l.items&&Array.isArray(l.items)?l.items:(console.warn(" No bookings array found in listBookings response"),[])}catch(n){return console.error(" Error listing bookings:",n.message),[]}},createCar:ot.createCar,deleteCar:ot.deleteCar,updateCar:ot.updateCar,updateStatus:ot.updateStatus,updateBatteryLevel:ot.updateBatteryLevel,updateCarDescription:ot.updateCarDescription,getAllCars:ot.getAllCars,getCarById:ot.getCarById,getAvailableCarsByStation:ot.getAvailableCarsByStation,getCarStatusReport:$e.getCarStatusReport,getCarsByStation:$e.getCarsByStation,getAllStations:$e.getAllStations,getBookingsByStation:$e.getBookingsByStation,getAllUsers:async(e=1,t=100,n=null)=>{var l,c;const s={pageNumber:e,pageSize:t};n&&(s.role=n);const a=[{url:"/Users/Get-All",params:s},{url:"/Admin/Users",params:s},{url:"/users",params:s}];for(const u of a)try{const f=await de.get(u.url,{params:u.params}),p=f==null?void 0:f.data;if(Array.isArray(p))return p;if(Array.isArray((l=p==null?void 0:p.data)==null?void 0:l.data))return p.data.data;if(Array.isArray(p==null?void 0:p.data))return p.data;if(Array.isArray(p==null?void 0:p.items))return p.items}catch(f){const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}return[]},assignStaffRole:async(e,t="")=>{var l;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Admin/Users/${n}/Assign-Staff-Role${s}`,`/Users/${n}/Assign-Staff-Role${s}`,`/Admin/Users/Assign-Staff-Role${s}`];for(const c of a)try{const u=await de.post(c,t?{userId:e,reason:t}:{userId:e}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Assign staff role endpoint not found")},removeStaffRole:async(e,t="")=>{var l;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Admin/Users/${n}/Remove-Staff-Role${s}`,`/Users/${n}/Remove-Staff-Role${s}`,`/Admin/Users/Remove-Staff-Role${s}`];for(const c of a)try{const u=await de.post(c,t?{userId:e,reason:t}:{userId:e}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Remove staff role endpoint not found")},getStaffByStation:async e=>{var s;if(!e)return[];const t=encodeURIComponent(e),n=[`/Admin/Staff/By-Station/${t}`,`/Staff/By-Station/${t}`,{url:"/Admin/Staff/By-Station",params:{stationId:e}}];for(const a of n)try{const l=typeof a=="string"?await de.get(a):await de.get(a.url,{params:a.params}),c=l==null?void 0:l.data;if(Array.isArray(c))return c;if(Array.isArray(c==null?void 0:c.data))return c.data;if(Array.isArray(c==null?void 0:c.items))return c.items}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return[]},getStationByStaff:async e=>{var s;if(!e)throw new Error("staffId is required");const t=encodeURIComponent(e),n=[`/Admin/Staff/${t}/Station`,`/Staff/${t}/Station`,`/Admin/Users/${t}/Station`,`/Users/${t}/Station`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(u)return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},getCustomerProfile:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Customers/${t}/Profile`,`/Admin/Users/${t}/Profile`,`/Users/${t}/Profile`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Customer profile endpoint not found")},getUserDocuments:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Documents`,`/Users/${t}/Documents`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("User documents endpoint not found")},softDeleteUser:async(e,t="")=>{var l;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Admin/Users/${n}/Soft-Delete${s}`,`/Users/${n}/Soft-Delete${s}`];for(const c of a)try{const u=await de.post(c,t?{reason:t}:{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Soft delete user endpoint not found")},restoreUser:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Restore`,`/Users/${t}/Restore`];for(const a of n)try{const l=await de.post(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Restore user endpoint not found")},getDeletedAccounts:async(e=1,t=20,n=null)=>{var l;(!e||e<1)&&(e=1),(!t||t<1)&&(t=20);const s=new URLSearchParams({page:e.toString(),pageSize:t.toString()});n&&s.append("role",n);const a=[`/Admin/Users/Deleted-Accounts?${s}`,`/Users/Deleted-Accounts?${s}`];for(const c of a)try{const u=await de.get(c),f=u==null?void 0:u.data,p=f&&typeof f=="object"&&"data"in f?f.data:f;return(p==null?void 0:p.deletedAccounts)||p||[]}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Get deleted accounts endpoint not found")},getAdminDashboard:async()=>{var t;const e=["/Admin/Dashboard","/Dashboard"];for(const n of e)try{const s=await de.get(n),a=s==null?void 0:s.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(s){const a=(t=s==null?void 0:s.response)==null?void 0:t.status;if(a&&a!==404&&a!==405)throw s}throw new Error("Dashboard endpoint not found")},getFleetOverview:async()=>{var t;const e=["/Admin/Fleet/Overview","/Fleet/Overview"];for(const n of e)try{const s=await de.get(n),a=s==null?void 0:s.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(s){const a=(t=s==null?void 0:s.response)==null?void 0:t.status;if(a&&a!==404&&a!==405)throw s}return null},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Re.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},transferCar:async(e,t,n="")=>{var l;if(!e||!t)throw new Error("carId and targetStationId are required");const s={carId:e,targetStationId:t};n&&(s.reason=n);const a=["/Admin/Fleet/Transfer-Car","/Fleet/Transfer-Car"];for(const c of a)try{const u=await de.post(c,null,{params:s}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Transfer car endpoint not found")},assignStaffToStation:async(e,t)=>{var s;if(!e||!t)throw new Error("stationId and staffId are required");const n=[{url:`/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}},{url:`/Admin/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}}];for(const a of n)try{const l=await de.post(a.url,null,{params:a.params}),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Assign staff to station endpoint not found")},unassignStaffFromStation:async e=>{var n;if(!e)throw new Error("staffId is required");const t=[{url:"/Stations/Unassign-Staff",params:{staffId:e}},{url:"/Admin/Stations/Unassign-Staff",params:{staffId:e}}];for(const s of t)try{const a=await de.post(s.url,null,{params:s.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(n=a==null?void 0:a.response)==null?void 0:n.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Unassign staff from station endpoint not found")},reassignStaff:async(e,t)=>{var s;if(!e||!t)throw new Error("staffId and toStationId are required");const n=[{url:"/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}},{url:"/Admin/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}}];for(const a of n)try{const l=await de.post(a.url,null,{params:a.params}),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Reassign staff endpoint not found")},post:async(e,t,n={})=>{const s=await de.post(e,t,n);return s==null?void 0:s.data},get:async(e,t={})=>{const n=await de.get(e,t);return n==null?void 0:n.data},put:async(e,t,n={})=>{const s=await de.put(e,t,n);return s==null?void 0:s.data},patch:async(e,t,n={})=>{const s=await de.patch(e,t,n);return s==null?void 0:s.data},delete:async(e,t={})=>{const n=await de.delete(e,t);return n==null?void 0:n.data}};function _S({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:a}){var U,ie;const[l,c]=y.useState(!1),[u,f]=y.useState(!1),[p,g]=y.useState(!1),[x,j]=y.useState(!1),[k,C]=y.useState(""),[S,P]=y.useState(!1),[_,v]=y.useState(!1),[w,b]=y.useState(null),[B,T]=y.useState(!1),[F,R]=y.useState(null),[O,I]=y.useState(""),[D,q]=y.useState(""),[te,G]=y.useState("");if(y.useEffect(()=>{if(!e)return;c(!1),f(!1),g(!1),j(!1),C("");const Z=(we,he)=>[we,he].filter(Boolean).join(" "),se=e.fullName||Z(e.firstName,e.lastName);if(!(!se||/^customer$/i.test(se)||se==="")){C(se);return}if(!e.id)return;let ce=!1;async function ke(){P(!0);try{const{firstName:we,lastName:he}=await adminApi.getUserNameByBookingId(e.id);ce||C(Z(we,he))}catch{}finally{ce||P(!1)}}return ke(),()=>{ce=!0}},[e]),!e)return null;const E=(e==null?void 0:e.status)==="booked"?l&&u:!1,oe=()=>{if(!e)return;const Z=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,Z)},Ne=Z=>{let se="booked";if(Z!=null&&(typeof Z=="number"||/^\d+$/.test(String(Z)))){const ne=Number(Z);ne===0?se="pending":ne===1?se="booked":ne===2?se="waiting-checkin":ne===3?se="checked-in":ne===4?se="checkout-pending":ne===5?se="completed":ne===6?se="cancelled-pending":ne===7&&(se="cancelled")}else{const ne=String(Z||"").toLowerCase();ne.includes("pending")||ne.includes("wait")?se="pending":ne.includes("check")&&ne.includes("in")?se="checked-in":ne.includes("complete")||ne.includes("finish")?se="completed":ne.includes("deny")||ne.includes("reject")||ne.includes("cancel")?se="cancelled":se="booked"}return se},W=async()=>{var Z,se,ne,ce,ke;if(e!=null&&e.id){I(""),v(!0);try{const we=await adminApi.createPayment(e.id,"Rental","Rental payment at check-in");try{localStorage.setItem("currentBookingId",e.id)}catch{}const he=(we==null?void 0:we.checkoutUrl)||((Z=we==null?void 0:we.data)==null?void 0:Z.checkoutUrl)||(we==null?void 0:we.url)||"",Ve=(we==null?void 0:we.qrCode)||((se=we==null?void 0:we.data)==null?void 0:se.qrCode)||"";if(q(he),G(Ve),b(we),he)try{window.open(he,"_blank","noopener,noreferrer")}catch{}}catch(we){const he=(ne=we==null?void 0:we.response)==null?void 0:ne.status;if(he&&he!==400&&he!==409){v(!1),I(((ke=(ce=we==null?void 0:we.response)==null?void 0:ce.data)==null?void 0:ke.message)||(we==null?void 0:we.message)||"Failed to create payment");return}}v(!1)}},fe=async()=>{var Z,se;if(e!=null&&e.id){I(""),v(!0);try{await adminApi.syncPaymentStatus(e.id),R(new Date);const ne=await adminApi.getBookingById(e.id),ce=(ne==null?void 0:ne.statusCode)??(ne==null?void 0:ne.StatusCode)??(ne==null?void 0:ne.bookingStatus)??(ne==null?void 0:ne.BookingStatus)??(ne==null?void 0:ne.status)??(ne==null?void 0:ne.Status),ke=Ne(ce);if(ke&&ke!==e.status){a==null||a(e.id,ke),t==null||t();return}alert("Synced. Status unchanged; try again shortly if the gateway is still processing.")}catch(ne){I(((se=(Z=ne==null?void 0:ne.response)==null?void 0:Z.data)==null?void 0:se.message)||(ne==null?void 0:ne.message)||"Retry sync failed")}finally{v(!1)}}},re=async()=>{var Z,se;if(e!=null&&e.id){T(!0),I("");try{const ne=await adminApi.getPaymentByBooking(e.id);b(ne)}catch(ne){I(((se=(Z=ne==null?void 0:ne.response)==null?void 0:Z.data)==null?void 0:se.message)||(ne==null?void 0:ne.message)||"Unable to load payment info")}finally{T(!1)}}};return i.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("img",{id:"modalImage",src:e.facePhoto||e.img,alt:"",style:{width:"100%",borderRadius:8,objectFit:"cover",display:"block"}}),i.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),i.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),i.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((U=e.car)==null?void 0:U.name)||((ie=e.car)==null?void 0:ie.Name)||""]}),i.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(S?"Loading":"")]}),i.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",e.date]})]}),i.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:e.idString||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Address:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:e.address||""})})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"CCCD Images:"}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),e.cccdFrontUrl?i.jsx("a",{href:e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:Z=>c(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),e.cccdBackUrl?i.jsx("a",{href:e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:u,onChange:Z=>f(Z.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Driver License (GPLX) Images:"}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),e.gplxFrontUrl?i.jsx("a",{href:e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:p,onChange:Z=>g(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),e.gplxBackUrl?i.jsx("a",{href:e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:x,onChange:Z=>j(Z.target.checked)})," Verified"]})]})]})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{id:"customerPhone",style:{padding:6},children:e.phone||""}),e.phone&&i.jsx("a",{href:`tel:${e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!E,style:{background:E?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),i.jsx("button",{onClick:oe,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:W,disabled:_,style:{background:"#43a047",color:"#fff",padding:"8px 16px",borderRadius:14},children:_?"Processing":"Confirm Check In"}),i.jsx("button",{onClick:fe,disabled:_,style:{background:"#1565c0",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Retry Sync"}),i.jsx("button",{onClick:re,disabled:B,style:{background:"#455a64",color:"#fff",padding:"8px 16px",borderRadius:14},children:B?"Loading":"View Payment Status"})]})]}),O&&i.jsx("div",{style:{marginTop:8,color:"#b00020"},children:O}),F&&i.jsxs("div",{style:{marginTop:4,color:"#555",fontSize:12},children:["Last sync: ",F.toLocaleTimeString()]}),(te||D)&&i.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #e0e0e0",borderRadius:8},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Complete Payment"}),te?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("img",{alt:"Pay QR",src:te,style:{width:160,height:160,objectFit:"contain",border:"1px solid #eee",borderRadius:6}}),i.jsx("div",{style:{color:"#555"},children:'Scan the QR to pay. After payment completes, use "Retry Sync" to update the booking.'})]}):i.jsx("div",{style:{color:"#555"},children:'Open the checkout to complete your payment, then return and press "Retry Sync".'}),D&&i.jsx("div",{style:{marginTop:10},children:i.jsx("a",{href:D,target:"_blank",rel:"noreferrer",style:{background:"#1565c0",color:"#fff",padding:"8px 14px",borderRadius:10,textDecoration:"none"},children:"Open Checkout"})})]}),w&&i.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #eee",borderRadius:8},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Payment"}),i.jsxs("div",{children:["Status: ",String(w.status||w.Status||w.paymentStatus||"")]}),i.jsxs("div",{children:["Gateway: ",String(w.gatewayStatus||w.GatewayStatus||w.providerStatus||"")]}),i.jsxs("div",{children:["Amount: ",w.amount??w.Amount??""]}),i.jsxs("div",{children:["Transaction: ",w.transactionId||w.TransactionId||w.txnId||""]}),i.jsxs("div",{children:["Updated: ",w.updatedAt||w.UpdatedAt||w.lastUpdated||""]})]})]})]}),i.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[i.jsx("h4",{children:"Transaction Details"}),i.jsxs("ul",{style:{fontSize:"1rem"},children:[i.jsx("li",{children:"Find rental location on map"}),i.jsx("li",{children:"View available vehicles (type, battery, price)"}),i.jsx("li",{children:"Book in advance or on-site"}),i.jsx("li",{children:"Check-in at counter/app"}),i.jsx("li",{children:"Sign electronic contract"}),i.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),i.jsx("li",{children:"Return vehicle at rental location"}),i.jsx("li",{children:"Staff checks and confirms vehicle condition"}),i.jsx("li",{children:"Pay any additional fees"})]})]})]})})}function wS({booking:e,onClose:t,onCheckedIn:n}){const[s,a]=y.useState(""),[l,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[x,j]=y.useState(!1),[k,C]=y.useState(""),[S,P]=y.useState(null);Kn.useEffect(()=>{let v=!0;return(async()=>{try{const w=await adminApi.getServerTime();v&&P(w);try{const b=w?w.getTime()-Date.now():0;console.log(" Server time:",w,"Client time:",new Date,"(ms):",b)}catch{}}catch{}})(),()=>{v=!1}},[]);async function _(v){var w,b;if(v.preventDefault(),!!(e!=null&&e.id)){j(!0),C("");try{const B=localStorage.getItem("token");if(!B||B==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let T="";try{T=await adminApi.resolveStaffId()}catch(I){try{T=localStorage.getItem("userId")||""}catch{}if(!T)throw I}const F={bookingId:e.id,adminId:T,adminSignature:u.trim()||"Admin",customerSignature:p.trim()||"Customer"},R=(s||"").trim();R&&(F.checkInNotes=R);const O=(l||"").trim();if(O)try{const I=new URL(O);(I.protocol==="http:"||I.protocol==="https:")&&(F.checkInPhotoUrl=O)}catch{}await adminApi.checkInWithContract(F),typeof n=="function"&&n(e.id,F),t==null||t()}catch(B){const T=(B==null?void 0:B.body)||((w=B==null?void 0:B.response)==null?void 0:w.data),F=T&&(T.errors||T.Errors)||null,R=(Array.isArray(F)&&F.length?F.join("; "):null)||(T==null?void 0:T.message)||(B==null?void 0:B.message)||"Failed to save check-in";C(R);try{console.error(" Check-in failed:",{error:B==null?void 0:B.message,status:(B==null?void 0:B.status)||((b=B==null?void 0:B.response)==null?void 0:b.status),body:T})}catch{}}finally{j(!1)}}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h3",{style:{marginBottom:12},children:"Check In"}),S&&i.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",S.toLocaleString()]}),k&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:k}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),i.jsxs("form",{onSubmit:_,style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Notes"}),i.jsx("textarea",{rows:5,value:s,onChange:v=>a(v.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Photo URL"}),i.jsx("input",{type:"url",value:l,onChange:v=>c(v.target.value),placeholder:"https://..."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsxs("span",{children:["Admin/Staff Signature ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",value:u,onChange:v=>f(v.target.value),placeholder:"Type admin/staff name or paste signature URL",required:!0})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsxs("span",{children:["Customer Signature ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",value:p,onChange:v=>g(v.target.value),placeholder:"Type customer name or paste signature URL",required:!0})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:x||!u.trim()||!p.trim(),style:{background:x||!u.trim()||!p.trim()?"#ccc":"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px",cursor:x||!u.trim()||!p.trim()?"not-allowed":"pointer"},children:x?"Saving":"Confirm Check In"})]})]})]})})}function jS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:a,onContinuePayment:l,onCancelBooking:c,onStatusUpdated:u}){const[f,p]=y.useState(null),[g,x]=y.useState(null),j=e.filter(k=>(k.title.toLowerCase().includes(t.toLowerCase())||(k.customer||"").toLowerCase().includes(t.toLowerCase())||(k.userName||"").toLowerCase().includes(t.toLowerCase())||(k.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||k.status===s));return i.jsxs("div",{id:"booking",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsx("input",{type:"text",id:"searchBooking",placeholder:"Search by customer or car...",value:t,onChange:k=>n(k.target.value)}),i.jsxs("select",{id:"statusFilter",value:s,onChange:k=>a(k.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending"}),i.jsx("option",{value:"booked",children:"Booked"}),i.jsx("option",{value:"checked-in",children:"Check-in Pending"}),i.jsx("option",{value:"denied",children:"Denied"}),i.jsx("option",{value:"completed",children:"Completed"})]})]}),i.jsx("div",{className:"booking-grid",id:"bookingGrid",children:j.map(k=>k.uiStage==="waiting-payment"?i.jsx(vS,{booking:k,onClick:()=>p(k)},k.id):k.uiStage==="checkin-payment"?i.jsx(xS,{booking:k,onClick:()=>p(k)},k.id):i.jsx(yS,{booking:k,onClick:()=>p(k)},k.id))}),i.jsx(_S,{booking:f,onClose:()=>p(null),onProceed:()=>{f&&(x(f),p(null))},onCancel:()=>{f&&(c==null||c(f))},onStatusUpdated:u}),g&&i.jsx(wS,{booking:g,onClose:()=>x(null)})]})}function SS({vehicle:e,onOpen:t}){return i.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[i.jsx("img",{src:e.img,alt:e.name}),i.jsxs("div",{className:"vehicle-info",children:[i.jsx("div",{className:"vehicle-title",children:e.name}),i.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),i.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),i.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),i.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function NS({open:e,onClose:t,onSubmit:n,stationId:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,x]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(""),[P,_]=y.useState(""),[v,w]=y.useState(""),[b,B]=y.useState(""),[T,F]=y.useState(""),[R,O]=y.useState(null),[I,D]=y.useState(""),q=5*1024*1024,te=["image/jpeg","image/png","image/webp","image/jpg"];if(!e)return null;async function G(){if(D(""),!s){D("Please select a station before creating a vehicle.");return}if(!a.trim()||!c.trim()||!g.trim()||!j.trim()||!f||!C||!P||!v||!b||!T){D("Please fill all required fields: Brand, Model, Color, Year, License Plate, Battery Capacity, Current Battery, Seats, Price/hour, Price/day.");return}const E=Number(f),oe=Number(C),Ne=Number(P),W=Number(v),fe=Number(b),re=Number(T);if(!Number.isFinite(E)||E<1900||E>2100){D("Year must be between 1900 and 2100.");return}if(!Number.isFinite(oe)||oe<0||oe>1e4){D("Battery Capacity must be a positive number (kWh).");return}if(!Number.isFinite(Ne)||Ne<0||Ne>100){D("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(W)||W<=0||!Number.isFinite(fe)||fe<=0){D("Rental prices must be positive numbers.");return}if(!Number.isFinite(re)||re<=0){D("Seats must be a positive number.");return}if(R){if(!te.includes(R.type)){D(`Invalid file type. Allowed: ${te.join(", ")}`);return}if(R.size>q){D(`File size must be less than ${q/1024/1024}MB. Current: ${(R.size/1024/1024).toFixed(2)}MB`);return}}const U=new FormData;U.append("Brand",a.trim()),U.append("Model",c.trim()),U.append("Year",E),U.append("Color",g.trim()),U.append("LicensePlate",j.trim()),U.append("BatteryCapacity",oe),U.append("CurrentBatteryLevel",Ne),U.append("RentalPricePerHour",W),U.append("RentalPricePerDay",fe),U.append("Seats",re),U.append("CurrentStationId",s),R&&(U.append("CarImage",R,R.name),console.log(" Added CarImage:",R.name,"size:",R.size,"type:",R.type));try{await n(U),l(""),u(""),p(""),x(""),k(""),S(""),_(""),w(""),B(""),F(""),O(null),t()}catch(ie){D((ie==null?void 0:ie.message)||"Failed to create vehicle")}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),I&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[i.jsx("input",{value:a,onChange:E=>l(E.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:c,onChange:E=>u(E.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:f,onChange:E=>p(E.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:g,onChange:E=>x(E.target.value),placeholder:"Color *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:j,onChange:E=>k(E.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:C,onChange:E=>S(E.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:P,onChange:E=>_(E.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:v,onChange:E=>w(E.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:b,onChange:E=>B(E.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:T,onChange:E=>F(E.target.value),placeholder:"Seats *",type:"number",min:1,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{type:"file",accept:"image/*",onChange:E=>{var Ne;const oe=((Ne=E.target.files)==null?void 0:Ne[0])||null;if(oe){if(!te.includes(oe.type)){D(`Invalid file type. Allowed: ${te.join(", ")}`),O(null);return}if(oe.size>q){D(`File size must be less than ${q/1024/1024}MB. Current: ${(oe.size/1024/1024).toFixed(2)}MB`),O(null);return}D(""),O(oe)}else O(null)},placeholder:"Car Image",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{onClick:G,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function CS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState("");if(y.useEffect(()=>{n&&(l(n.battery??""),u(n.tech??""),p(n.issue??""))},[n]),!e||!n)return null;function g(){s(n.id,{battery:a,tech:c,issue:f}),t()}return i.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"vehicle-modal-content",children:[i.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),i.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),i.jsx("label",{children:"Battery Status"}),i.jsx("input",{value:a,onChange:x=>l(x.target.value),placeholder:"e.g. 80"}),i.jsx("label",{children:"Condition"}),i.jsxs("select",{value:c,onChange:x=>u(x.target.value),children:[i.jsx("option",{children:"Open"}),i.jsx("option",{children:"Running"}),i.jsx("option",{children:"Rented"}),i.jsx("option",{children:"Maintained"})]}),i.jsx("label",{children:"Issue"}),i.jsx("textarea",{value:f,onChange:x=>p(x.target.value)}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:g,children:"Submit Update"})})]})})}function kS({open:e,vehicle:t,onClose:n,onEdit:s,onTransfer:a,onUpdate:l}){const[c,u]=y.useState(!1),[f,p]=y.useState(""),[g,x]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(!1);if(!e||!t)return null;const P=t.img,_=()=>{p(t.battery??""),x(t.tech??""),k(t.issue??""),u(!0)},v=async()=>{if(l){S(!0);try{await l(t.id,{battery:f,tech:g,issue:j}),u(!1)}catch(b){alert((b==null?void 0:b.message)||"Failed to update vehicle")}finally{S(!1)}}},w=()=>{u(!1),p(""),x(""),k("")};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsx("img",{src:P,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),i.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[i.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[i.jsx("h3",{style:{marginTop:4},children:t.name}),i.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Detail:"}),i.jsx("div",{children:t.detail||"N/A"})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Battery:"}),c?i.jsx("input",{type:"number",min:"0",max:"100",value:f,onChange:b=>p(b.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):i.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Condition:"}),c?i.jsx("input",{type:"text",value:g,onChange:b=>x(b.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):i.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[i.jsx("strong",{children:"Issue:"}),c?i.jsx("textarea",{value:j,onChange:b=>k(b.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):i.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),i.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:P,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),i.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:c?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:v,disabled:C,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:C?.6:1},children:[i.jsx("i",{className:"fas fa-save"})," ",C?"Saving...":"Save Changes"]}),i.jsxs("button",{onClick:w,disabled:C,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):i.jsxs(i.Fragment,{children:[l&&i.jsxs("button",{onClick:_,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]}),a&&i.jsxs("button",{onClick:()=>{n(),a()},style:{padding:"10px 24px",background:"#8b5cf6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-exchange-alt"})," Transfer Station"]})]})})]})})}function PS({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return i.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[i.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function bS({open:e,onClose:t,vehicle:n,stations:s,currentStationId:a,onSubmit:l}){const[c,u]=y.useState(""),[f,p]=y.useState("Fleet rebalancing"),[g,x]=y.useState(!1);if(!e||!n)return null;const j=s.filter(C=>{const S=C.id||C.Id;return S&&S!==a}),k=async C=>{if(C.preventDefault(),!c){alert("Please select a station");return}x(!0);try{await l(n,c,f),u(""),p("Fleet rebalancing"),t()}catch(S){console.error("Transfer failed:",S)}finally{x(!1)}};return i.jsx("div",{className:"modal-backdrop",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{className:"modal-content",onClick:C=>C.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 10px 40px rgba(0,0,0,0.2)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsxs("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:[i.jsx("i",{className:"fas fa-exchange-alt",style:{marginRight:"8px",color:"#0ea5e9"}}),"Transfer Vehicle"]}),i.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",padding:"0",width:"32px",height:"32px"},children:""})]}),i.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"20px"},children:[i.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:n.name}),i.jsxs("div",{style:{fontSize:"14px",color:"#6b7280"},children:["Current Station: ",n.stationName||"Unknown"]})]}),i.jsxs("form",{onSubmit:k,children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:["Transfer to Station ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsxs("select",{value:c,onChange:C=>u(C.target.value),required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[i.jsx("option",{value:"",children:"-- Select Station --"}),j.map(C=>{const S=C.id||C.Id,P=C.name||C.Name||`Station ${S}`;return i.jsx("option",{value:S,children:P},S)})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:"Reason (optional)"}),i.jsx("textarea",{value:f,onChange:C=>p(C.target.value),placeholder:"Enter reason for transfer...",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),i.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i.jsx("button",{type:"button",onClick:t,disabled:g,style:{flex:1,padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",fontSize:"14px",fontWeight:"500",cursor:g?"not-allowed":"pointer",opacity:g?.6:1},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:g||!c,style:{flex:1,padding:"10px",border:"none",borderRadius:"6px",background:c&&!g?"#0ea5e9":"#9ca3af",color:"white",fontSize:"14px",fontWeight:"500",cursor:c&&!g?"pointer":"not-allowed"},children:g?"Transferring...":"Transfer Vehicle"})]})]})]})})}function IS({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:a,canDelete:l=!0,stationSlots:c=null,onTransferCar:u,stations:f}){const[p,g]=y.useState(null),[x,j]=y.useState(!1),[k,C]=y.useState(!1),[S,P]=y.useState(!1),[_,v]=y.useState(!1),[w,b]=y.useState(null),[B,T]=y.useState(""),F=e.filter(q=>{if(!B)return!0;const te=B.toLowerCase(),G=(q.name||"").toLowerCase(),E=(q.model||"").toLowerCase(),oe=(q.brand||"").toLowerCase(),Ne=(q.licensePlate||"").toLowerCase();return G.includes(te)||E.includes(te)||oe.includes(te)||Ne.includes(te)});function R(q){g(q),P(!0)}function O(q){g(q),j(!0)}function I(q){b(q),v(!0)}const D=async(q,te,G)=>{u&&await u(q,te,G)};return i.jsxs("div",{id:"vehicle",className:"section",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>C(!0),children:[i.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),i.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:B,onChange:q=>T(q.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),a&&c&&i.jsx(PS,{stationSlots:c})]}),i.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!F||F.length===0)&&i.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:B?"No vehicles match your search.":"No vehicles available to display."}),F.map((q,te)=>i.jsx("div",{children:i.jsx(SS,{vehicle:q,onOpen:()=>O(q)})},q.id||q.licensePlate||`${q.name}-${q.stationId||""}-${te}`))]}),i.jsx(NS,{open:k,onClose:()=>C(!1),onSubmit:t,stationId:a}),i.jsx(CS,{open:S,onClose:()=>P(!1),vehicle:p,onSubmit:s}),i.jsx(kS,{open:x,vehicle:p,onClose:()=>j(!1),onEdit:p?()=>R(p):null,onTransfer:u&&p?()=>I(p):null,onUpdate:s}),i.jsx(bS,{open:_,onClose:()=>{v(!1),b(null)},vehicle:w,stations:f||[],currentStationId:a,onSubmit:D})]})}function LS({user:e,onClick:t}){const n=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",s=e.email||e.Email||"",a=e.role||e.Role||e.userRole||"Customer",l=e.phoneNumber||e.PhoneNumber||e.phone||"";return i.jsxs("div",{className:"user-card",onClick:t,children:[i.jsx("div",{className:"user-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsxs("div",{className:"user-info",children:[i.jsx("div",{className:"user-name",children:n}),i.jsx("div",{className:"user-email",children:s}),i.jsx("div",{className:"user-role",children:a}),l!==""&&i.jsx("div",{className:"user-phone",children:l})]})]})}function ES({userId:e,userName:t,onClose:n}){const[s,a]=y.useState([]),[l,c]=y.useState(!0),[u,f]=y.useState(""),[p,g]=y.useState(""),[x,j]=y.useState("newest");y.useEffect(()=>{k()},[e]);const k=async()=>{var _,v;try{c(!0),f(""),console.log(" Fetching bookings for user:",e);const w=await $t.getUserBookings(e);console.log(" Bookings loaded:",w),a(w||[])}catch(w){console.error(" Error loading bookings:",w),f(((v=(_=w==null?void 0:w.response)==null?void 0:_.data)==null?void 0:v.message)||"Failed to load booking history")}finally{c(!1)}},C=_=>{const v={0:{text:"Pending",class:"status-pending",color:"#ff9800"},1:{text:"Active",class:"status-active",color:"#2196f3"},2:{text:"Waiting for check-in",class:"status-waiting",color:"#ff5722"},3:{text:"Checked-in",class:"status-checked-in",color:"#4caf50"},4:{text:"Check-out pending",class:"status-checkout-pending",color:"#9c27b0"},5:{text:"Completed",class:"status-completed",color:"#4caf50"},6:{text:"Cancelled pending refund",class:"status-cancelled-refund",color:"#f44336"},7:{text:"Cancelled",class:"status-cancelled",color:"#9e9e9e"}},w=Number(_);return v[w]||v[0]},S=_=>{if(!_)return"N/A";try{const v=new Date(_);return isNaN(v.getTime())?_:v.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return _}};let P=[...s];return p&&(P=P.filter(_=>String(_.bookingStatus)===p)),P.sort((_,v)=>{switch(x){case"oldest":return new Date(_.createdAt)-new Date(v.createdAt);case"price-high":return(v.totalAmount||0)-(_.totalAmount||0);case"price-low":return(_.totalAmount||0)-(v.totalAmount||0);default:return new Date(v.createdAt)-new Date(_.createdAt)}}),i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:n,children:i.jsxs("div",{style:{background:"white",borderRadius:"12px",width:"100%",maxWidth:"900px",maxHeight:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:_=>_.stopPropagation(),children:[i.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("h2",{style:{margin:0,marginBottom:"4px"},children:"Booking History"}),i.jsxs("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:["for ",t]})]}),i.jsx("button",{onClick:n,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#999",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"15px 20px",borderBottom:"1px solid #eee",display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("label",{style:{fontWeight:500},children:"Status:"}),i.jsxs("select",{value:p,onChange:_=>g(_.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"",children:"All"}),i.jsx("option",{value:"0",children:"Pending"}),i.jsx("option",{value:"1",children:"Active"}),i.jsx("option",{value:"2",children:"Waiting for check-in"}),i.jsx("option",{value:"3",children:"Checked-in"}),i.jsx("option",{value:"4",children:"Check-out pending"}),i.jsx("option",{value:"5",children:"Completed"}),i.jsx("option",{value:"6",children:"Cancelled pending refund"}),i.jsx("option",{value:"7",children:"Cancelled"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("label",{style:{fontWeight:500},children:"Sort by:"}),i.jsxs("select",{value:x,onChange:_=>j(_.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"newest",children:"Newest"}),i.jsx("option",{value:"oldest",children:"Oldest"}),i.jsx("option",{value:"price-high",children:"Price (High to Low)"}),i.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),i.jsx("button",{onClick:k,style:{padding:"8px 16px",background:"#1976d2",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:" Refresh"})]}),i.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[l&&i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[i.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"10px"}}),"Loading bookings..."]}),u&&i.jsxs("div",{style:{background:"#ffebee",color:"#c62828",padding:"15px",borderRadius:"8px",marginBottom:"15px",border:"1px solid #ef5350"},children:[i.jsx("strong",{children:"Error:"})," ",u]}),!l&&P.length===0&&i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[i.jsx("i",{className:"fas fa-inbox",style:{fontSize:"36px",marginBottom:"15px",display:"block"}}),i.jsx("p",{children:"No bookings found"})]}),!l&&P.length>0&&i.jsx("div",{style:{display:"grid",gap:"15px"},children:P.map((_,v)=>{const w=C(_.bookingStatus),b=S(_.startTime||_.pickupDateTime),B=S(_.endTime||_.expectedReturnDateTime),T=_.carInfo||"Car Rental",F=_.pickupStationName||"N/A",R=_.id||_.bookingId||"N/A";return i.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"15px",background:"#fafafa",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:"15px",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Car"}),i.jsx("div",{style:{fontWeight:500},children:T}),i.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:["Booking ID: ",R]})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Pick-up"}),i.jsx("div",{style:{fontSize:"13px"},children:F}),i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:b})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Return"}),i.jsx("div",{style:{fontSize:"13px"},children:B})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Total"}),i.jsx("div",{style:{fontWeight:600,fontSize:"15px",color:"#1976d2"},children:At(_.totalAmount||0)})]}),i.jsx("div",{style:{padding:"6px 12px",background:w.color,color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:500,textAlign:"center",whiteSpace:"nowrap"},children:w.text})]},v)})})]})]})})}function TS({user:e,onClose:t,onAssignStaff:n,onDelete:s}){const[a,l]=y.useState(!1),[c,u]=y.useState(!1);if(!e)return null;const f=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",p=e.email||e.Email||"",g=e.phoneNumber||e.PhoneNumber||e.phone||"",x=e.role||e.Role||e.userRole||"Customer",j=e.id||e.Id||e.userId||e.UserId;if(c)return i.jsx(ES,{userId:j,userName:f,onClose:()=>u(!1)});const k=async()=>{const S=window.prompt("Enter reason for promoting to staff (optional):")||"";if(S!==null){l(!0);try{await(n==null?void 0:n(e,S)),t==null||t()}catch(P){alert((P==null?void 0:P.message)||"Failed to assign staff role")}finally{l(!1)}}},C=async()=>{if(!window.confirm(`Are you sure you want to delete ${f}?`))return;const S=window.prompt("Enter reason for deletion (optional):")||"";l(!0);try{await(s==null?void 0:s(e,S)),t==null||t()}catch(P){alert((P==null?void 0:P.message)||"Failed to delete user")}finally{l(!1)}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("div",{style:{textAlign:"center",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{"aria-hidden":!0,style:{width:"120px",height:"120px",borderRadius:"50%",background:"#eceff1",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"15px",color:"#607d8b"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsx("h2",{style:{margin:"10px 0"},children:f}),i.jsx("div",{style:{color:"#666",marginBottom:"20px"},children:x})]}),i.jsxs("div",{style:{padding:"0 20px 20px"},children:[i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Email:"}),i.jsx("span",{children:p})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Phone:"}),i.jsx("span",{children:g})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"User ID:"}),i.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:j})]})]}),i.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("button",{onClick:()=>u(!0),style:{background:"#1976d2",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:"pointer",opacity:a?.6:1},children:[i.jsx("i",{className:"fas fa-history",style:{marginRight:"6px"}}),"Booking History"]}),i.jsx("button",{onClick:k,disabled:a,style:{background:"#43a047",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:a?"not-allowed":"pointer",opacity:a?.6:1},children:a?"Processing...":"Promote to Staff"}),i.jsx("button",{onClick:C,disabled:a,style:{background:"#d32f2f",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:a?"not-allowed":"pointer",opacity:a?.6:1},children:a?"Processing...":"Delete User"})]})]})})}function BS({open:e,onClose:t,onSuccess:n}){const[s,a]=y.useState(""),[l,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[x,j]=y.useState(!1),[k,C]=y.useState(""),S=async P=>{var _,v;P.preventDefault(),C(""),j(!0);try{await adminApi.post("/Auth/Register",{fullName:s,email:l,phoneNumber:u,password:p}),a(""),c(""),f(""),g(""),n==null||n(),t()}catch(w){const b=((v=(_=w==null?void 0:w.response)==null?void 0:_.data)==null?void 0:v.message)||(w==null?void 0:w.message)||"Failed to create user";C(b)}finally{j(!1)}};return e?i.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:i.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h2",{children:"Create New User"}),i.jsxs("form",{onSubmit:S,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:s,onChange:P=>a(P.target.value),placeholder:"Full Name",required:!0,disabled:x}),i.jsx("i",{className:"fas fa-user"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:l,onChange:P=>c(P.target.value),placeholder:"Email",required:!0,disabled:x}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:u,onChange:P=>f(P.target.value),placeholder:"Phone",required:!0,disabled:x}),i.jsx("i",{className:"fas fa-phone"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:p,onChange:P=>g(P.target.value),placeholder:"Password",required:!0,disabled:x}),i.jsx("i",{className:"fas fa-lock"})]}),k&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:k}),i.jsx("button",{type:"submit",disabled:x,children:x?"Creating Account...":"Create User"})]})]})}):null}function RS({user:e,onClick:t}){const n=e.fullName||e.FullName||"Unknown User",s=e.email||e.Email||"N/A",a=e.userRole||e.role||e.Role||"N/A",l=e.deactivatedAt||"Unknown",c=e.daysDeactivated||0;return i.jsxs("div",{className:"user-card deleted-user-card",onClick:t,children:[i.jsxs("div",{className:"user-card-header",children:[i.jsx("div",{className:"user-avatar deleted",children:i.jsx("i",{className:"fas fa-user-slash"})}),i.jsxs("div",{className:"user-info",children:[i.jsx("h4",{className:"user-name",children:n}),i.jsx("p",{className:"user-email",children:s})]})]}),i.jsxs("div",{className:"user-card-body",children:[i.jsxs("div",{className:"user-detail",children:[i.jsx("span",{className:"label",children:"Role:"}),i.jsx("span",{className:"value",children:a})]}),i.jsxs("div",{className:"user-detail",children:[i.jsx("span",{className:"label",children:"Deleted:"}),i.jsx("span",{className:"value",children:l})]}),i.jsxs("div",{className:"user-detail",children:[i.jsx("span",{className:"label",children:"Days Inactive:"}),i.jsxs("span",{className:"value deleted-badge",children:[c," days"]})]})]}),i.jsx("div",{className:"user-card-footer",children:i.jsxs("span",{className:"user-status deleted-status",children:[i.jsx("i",{className:"fas fa-ban"})," Deleted"]})})]})}function AS({users:e,deletedUsers:t=[],loadingDeleted:n=!1,onAssignStaff:s,onDeleteUser:a,onRestoreUser:l,onUserCreated:c,onLoadDeleted:u}){const[f,p]=y.useState(null),[g,x]=y.useState(null),[j,k]=y.useState(""),[C,S]=y.useState(!1),[P,_]=y.useState("active");y.useEffect(()=>{P==="deleted"&&t.length===0&&!n&&u&&u()},[P,t.length,n,u]);const v=e.filter(B=>{const T=(B.role||B.Role||B.userRole||"").toLowerCase();return(j===""||(B.fullName||B.FullName||"").toLowerCase().includes(j.toLowerCase())||(B.email||B.Email||"").toLowerCase().includes(j.toLowerCase())||(B.userName||B.UserName||"").toLowerCase().includes(j.toLowerCase()))&&T!=="station staff"&&T!=="stationstaff"&&T!=="admin"}),w=t.filter(B=>j===""||(B.fullName||B.FullName||"").toLowerCase().includes(j.toLowerCase())||(B.email||B.Email||"").toLowerCase().includes(j.toLowerCase())||(B.userName||B.UserName||"").toLowerCase().includes(j.toLowerCase())),b=P==="active"?v:w;return i.jsxs("div",{id:"users",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>S(!0),style:{marginRight:"12px"},children:[i.jsx("i",{className:"fas fa-plus"})," Create User"]}),i.jsxs("div",{className:"view-mode-toggle",style:{marginRight:"12px"},children:[i.jsxs("button",{className:`toggle-btn ${P==="active"?"active":""}`,onClick:()=>_("active"),children:[i.jsx("i",{className:"fas fa-users"})," Active Users"]}),i.jsxs("button",{className:`toggle-btn ${P==="deleted"?"active":""}`,onClick:()=>_("deleted"),children:[i.jsx("i",{className:"fas fa-user-slash"})," Deleted Users"]})]}),i.jsx("input",{type:"text",placeholder:"Search by name, email, or username...",value:j,onChange:B=>k(B.target.value)}),i.jsxs("div",{style:{color:"#666",fontSize:"14px"},children:["Showing ",b.length," ",P==="active"?"active":"deleted"," users"]})]}),n&&P==="deleted"&&i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Loading deleted users..."}),!n&&i.jsxs("div",{className:"user-grid",children:[P==="active"&&v.map(B=>i.jsx(LS,{user:B,onClick:()=>p(B)},B.id||B.Id)),P==="deleted"&&w.map(B=>i.jsx(RS,{user:B,onClick:()=>x(B)},B.userId||B.id||B.Id))]}),b.length===0&&!n&&i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:["No ",P==="deleted"?"deleted":""," users found"]}),i.jsx(TS,{user:f,onClose:()=>p(null),onAssignStaff:s,onDelete:a}),g&&i.jsx("div",{className:"modal-overlay",onClick:()=>x(null),children:i.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Deleted User Details"}),i.jsx("button",{className:"modal-close",onClick:()=>x(null),children:i.jsx("i",{className:"fas fa-times"})})]}),i.jsxs("div",{className:"modal-body",children:[i.jsxs("div",{className:"user-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Name:"}),i.jsx("span",{children:g.fullName||g.FullName||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Email:"}),i.jsx("span",{children:g.email||g.Email||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Role:"}),i.jsx("span",{children:g.userRole||g.role||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Deleted At:"}),i.jsx("span",{children:g.deactivatedAt||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Days Deactivated:"}),i.jsxs("span",{children:[g.daysDeactivated||0," days"]})]})]}),i.jsx("div",{className:"modal-actions",style:{marginTop:"20px"},children:i.jsxs("button",{className:"btn-restore",onClick:()=>{l&&(l(g),x(null))},children:[i.jsx("i",{className:"fas fa-undo"})," Restore User"]})})]})]})}),i.jsx(BS,{open:C,onClose:()=>S(!1),onSuccess:c})]})}function FS({staff:e,stations:t,onClick:n}){const s=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",a=e.email||e.Email||"",l=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/100x100?text=${encodeURIComponent(s.charAt(0))}`,c=e.phoneNumber||e.PhoneNumber||e.phone||"",u=e.stationId||e.StationId,f=t.find(x=>(x.id||x.Id)===u),p=f?f.name||f.Name:e.stationName||e.StationName||(u?`Station ${u.substring(0,8)}...`:"Not Assigned"),g=!u&&!e.stationName&&!e.StationName;return i.jsxs("div",{className:"staff-card",onClick:n,children:[i.jsx("img",{src:l,alt:s,className:"staff-avatar"}),i.jsxs("div",{className:"staff-info",children:[i.jsx("div",{className:"staff-name",children:s}),i.jsx("div",{className:"staff-email",children:a}),i.jsxs("div",{className:"staff-station",style:{color:g?"#ff9800":"inherit"},children:[g?"":""," ",p]}),c!==""&&i.jsxs("div",{className:"staff-phone",children:[" ",c]})]})]})}function US({staff:e,stations:t,onClose:n,onRemoveStaff:s,onAssignStation:a,onUnassignStation:l}){const[c,u]=y.useState(!1),[f,p]=y.useState("");if(!e)return null;const g=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",x=e.email||e.Email||"",j=e.phoneNumber||e.PhoneNumber||e.phone||"",k=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/150x150?text=${encodeURIComponent(g.charAt(0))}`,C=e.id||e.Id||e.userId||e.UserId,S=e.stationId||e.StationId,P=t.find(T=>(T.id||T.Id)===S),_=P?P.name||P.Name:e.stationName||e.StationName||(S?`Station ${S.substring(0,8)}...`:"Not Assigned"),v=S||e.stationName||e.StationName,w=async()=>{if(!window.confirm(`Are you sure you want to remove staff role from ${g}?`))return;const T=window.prompt("Enter reason for removing staff role (optional):")||"";u(!0);try{await(s==null?void 0:s(e,T)),n==null||n()}catch(F){alert((F==null?void 0:F.message)||"Failed to remove staff role")}finally{u(!1)}},b=async()=>{if(!f){alert("Please select a station");return}if(window.confirm(`Assign ${g} to this station?`)){u(!0);try{await(a==null?void 0:a(e,f)),n==null||n()}catch(T){alert((T==null?void 0:T.message)||"Failed to assign station")}finally{u(!1)}}},B=async()=>{if(window.confirm(`Unassign ${g} from ${_}?`)){u(!0);try{await(l==null?void 0:l(e)),n==null||n()}catch(T){alert((T==null?void 0:T.message)||"Failed to unassign station")}finally{u(!1)}}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[i.jsx("img",{src:k,alt:g,style:{width:"120px",height:"120px",borderRadius:"50%",objectFit:"cover",marginBottom:"15px"}}),i.jsx("h2",{style:{margin:"10px 0"},children:g}),i.jsx("div",{style:{color:"#43a047",fontWeight:600,marginBottom:"20px"},children:"Station Staff"})]}),i.jsxs("div",{style:{padding:"0 20px 20px"},children:[i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Email:"}),i.jsx("span",{children:x})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Phone:"}),i.jsx("span",{children:j})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Station:"}),i.jsx("span",{children:_})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"User ID:"}),i.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:C})]})]}),i.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee"},children:[i.jsx("h4",{style:{marginBottom:"12px",color:"#333"},children:v?"Reassign to Different Station":"Assign to Station"}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:v?"10px":"0"},children:[i.jsxs("select",{value:f,onChange:T=>p(T.target.value),style:{flex:1,padding:"10px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},disabled:c,children:[i.jsx("option",{value:"",children:"Select a station..."}),t.map(T=>i.jsxs("option",{value:T.id||T.Id,disabled:(T.id||T.Id)===S,children:[T.name||T.Name||`Station ${T.id||T.Id}`,(T.id||T.Id)===S?" (Current)":""]},T.id||T.Id))]}),i.jsx("button",{onClick:b,disabled:c||!f,style:{background:"#2196f3",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:c||!f?"not-allowed":"pointer",opacity:c||!f?.6:1,whiteSpace:"nowrap"},children:c?"Assigning...":v?"Reassign":"Assign"})]}),v&&l&&i.jsx("button",{onClick:B,disabled:c,style:{background:"#ff9800",color:"white",padding:"8px 16px",borderRadius:"8px",border:"none",cursor:c?"not-allowed":"pointer",opacity:c?.6:1,fontSize:"13px",width:"100%"},children:c?"Unassigning...":" Unassign from Station"})]}),i.jsx("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:w,disabled:c,style:{background:"#ff9800",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:c?"not-allowed":"pointer",opacity:c?.6:1},children:c?"Processing...":"Remove Staff Role"})})]})})}function MS({open:e,onClose:t,stations:n,onSuccess:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,x]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(!1),[P,_]=y.useState(""),v=async w=>{var b,B,T,F;w.preventDefault(),_(""),S(!0);try{const R=await adminApi.post("/Auth/Register",{fullName:a,email:c,phoneNumber:f,password:g}),O=((b=R==null?void 0:R.data)==null?void 0:b.id)||((B=R==null?void 0:R.data)==null?void 0:B.userId);if(!O)throw new Error("Failed to get user ID from registration response");try{await adminApi.assignStaffRole(O,"Assigned to station staff role during creation")}catch(I){throw console.warn("Failed to assign staff role:",I),new Error("User created but failed to assign staff role")}if(j)try{await adminApi.assignStaffToStation(j,O)}catch(I){console.warn("Staff role assigned but station assignment failed:",I)}l(""),u(""),p(""),x(""),k(""),s==null||s(),t()}catch(R){const O=((F=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:F.message)||(R==null?void 0:R.message)||"Failed to create staff member";_(O)}finally{S(!1)}};return e?i.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:i.jsxs("div",{className:"modal-content",onClick:w=>w.stopPropagation(),children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h2",{children:"Create New Staff Member"}),i.jsxs("form",{onSubmit:v,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:a,onChange:w=>l(w.target.value),placeholder:"Full Name",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-user"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:c,onChange:w=>u(w.target.value),placeholder:"Email",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:f,onChange:w=>p(w.target.value),placeholder:"Phone",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-phone"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:g,onChange:w=>x(w.target.value),placeholder:"Password",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-lock"})]}),i.jsxs("div",{className:"input-group",style:{marginBottom:"15px"},children:[i.jsxs("select",{value:j,onChange:w=>k(w.target.value),required:!0,disabled:C,style:{width:"100%",padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",paddingLeft:"40px"},children:[i.jsx("option",{value:"",children:"Select Station"}),n.map(w=>i.jsx("option",{value:w.id||w.Id,children:w.name||w.Name||`Station ${w.id||w.Id}`},w.id||w.Id))]}),i.jsx("i",{className:"fas fa-map-marker-alt",style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",color:"#999"}})]}),P&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:P}),i.jsx("button",{type:"submit",disabled:C,children:C?"Creating Staff Member...":"Create Staff"})]})]})}):null}function OS({users:e,staffByStation:t=[],stations:n,onRemoveStaff:s,onAssignStation:a,onUnassignStation:l,onStaffCreated:c}){const[u,f]=y.useState(null),[p,g]=y.useState(""),[x,j]=y.useState(""),[k,C]=y.useState(!1),P=y.useMemo(()=>{const _=new Map;return t.forEach(v=>{const w=v.userId||v.id||v.Id;w&&_.set(w,v)}),e.forEach(v=>{const w=(v.role||v.Role||v.userRole||"").toLowerCase();if(w==="station staff"||w==="stationstaff"){const b=v.id||v.Id||v.userId;b&&!_.has(b)&&_.set(b,v)}}),Array.from(_.values())},[e,t]).filter(_=>{const v=p===""||(_.fullName||_.FullName||"").toLowerCase().includes(p.toLowerCase())||(_.email||_.Email||"").toLowerCase().includes(p.toLowerCase())||(_.userName||_.UserName||"").toLowerCase().includes(p.toLowerCase()),w=x===""||(_.stationId||_.StationId||"")===x;return v&&w});return i.jsxs("div",{id:"staff",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>C(!0),style:{marginRight:"12px"},children:[i.jsx("i",{className:"fas fa-plus"})," Create Staff"]}),i.jsx("input",{type:"text",placeholder:"Search staff by name, email, or username...",value:p,onChange:_=>g(_.target.value)}),i.jsxs("select",{value:x,onChange:_=>j(_.target.value),style:{padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"All Stations"}),n.map(_=>i.jsx("option",{value:_.id||_.Id,children:_.name||_.Name||`Station ${_.id||_.Id}`},_.id||_.Id))]}),i.jsxs("div",{style:{color:"#666",fontSize:"14px",whiteSpace:"nowrap"},children:[P.length," staff"]})]}),i.jsx("div",{className:"staff-grid",children:P.map(_=>i.jsx(FS,{staff:_,stations:n,onClick:()=>f(_)},_.id||_.Id))}),P.length===0&&i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No staff members found"}),i.jsx(US,{staff:u,stations:n,onClose:()=>f(null),onRemoveStaff:s,onAssignStation:a,onUnassignStation:l}),i.jsx(MS,{open:k,onClose:()=>C(!1),stations:n,onSuccess:c})]})}function DS({open:e,onClose:t,inline:n=!1}){const[s,a]=y.useState(!1),[l,c]=y.useState({}),[u,f]=y.useState({}),[p,g]=y.useState("");if(y.useEffect(()=>{if(!e)return;let B=!0;async function T(){var F,R,O;try{a(!0),g("");let I={},D={};try{I=await Re.getMyProfile()}catch(q){((F=q==null?void 0:q.response)==null?void 0:F.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{D=await Re.getMe()}catch(q){((R=q==null?void 0:q.response)==null?void 0:R.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!B)return;c(I||{}),f(D||{});try{let q=(I==null?void 0:I.id)||(I==null?void 0:I.userId)||(D==null?void 0:D.userId)||(D==null?void 0:D.id);if(!q){const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=Re.decodeJwt(G);q=E["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||E.nameidentifier||E.sub||E.userId||E.UserId||E.id||E.Id}}if(!(D!=null&&D.role)&&!(I!=null&&I.role))try{const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=Re.decodeJwt(G),oe=(E==null?void 0:E.role)||(E==null?void 0:E.Role)||E["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];oe&&(D={...D,role:oe})}}catch{}const te=!(I!=null&&I.userName)&&!(D!=null&&D.userName)||!(I!=null&&I.address)||!(I!=null&&I.stationName);if(q&&te)try{const G=await Re.getUserById(q);if(!B)return;const E={...I};E.userName||(E.userName=(G==null?void 0:G.userName)||(G==null?void 0:G.UserName)||(G==null?void 0:G.username)||""),E.address||(E.address=(G==null?void 0:G.address)||(G==null?void 0:G.Address)||""),E.stationName||(E.stationName=(G==null?void 0:G.stationName)||((O=G==null?void 0:G.station)==null?void 0:O.name)||(G==null?void 0:G.StationName)||""),c(E)}catch{}}catch{}if((!I||Object.keys(I).length===0)&&(!D||Object.keys(D).length===0)){const q=typeof localStorage<"u"&&!!localStorage.getItem("token");g(q?"You may not have permission to view this profile.":"You are not logged in. Please log in with a admin account.")}}catch(I){if(!B)return;g((I==null?void 0:I.message)||"Failed to load profile")}finally{B&&a(!1)}}return T(),()=>{B=!1}},[e]),!e)return null;let x=l.userName||l.username||u.userName||u.username||"";if(!x)try{const B=typeof localStorage<"u"?localStorage.getItem("token"):null;if(B){const T=Re.decodeJwt(B);x=(T==null?void 0:T.preferred_username)||(T==null?void 0:T.unique_name)||(T==null?void 0:T.userName)||(T==null?void 0:T.username)||(T==null?void 0:T.name)||""}}catch{}const j=l.firstName?`${l.firstName} ${l.lastName||""}`.trim():l.fullName||u.fullName||u.name||"",k=l.email||u.email||"",C=l.phoneNumber||u.phoneNumber||"",S=l.address||u.address||"",P=l.createdAt||u.createdAt||"",_=l.employeeId||l.id||u.userId||u.id||"",v=l.stationName||l.station||"",w=l.role||u.role||(Array.isArray(u.roles)?u.roles.join(", "):u.roles||""),b=l.avatarUrl||u.avatarUrl||"https://via.placeholder.com/180x180?text=Admin";return n?i.jsxs("div",{className:"admin-profile-page",children:[i.jsx("div",{className:"admin-cover",children:i.jsx("div",{className:"admin-cover-gradient"})}),i.jsx("div",{className:"admin-header",children:i.jsxs("div",{className:"admin-header-inner",children:[i.jsx("div",{className:"admin-avatar",children:i.jsx("img",{src:b,alt:"Avatar"})}),i.jsxs("div",{className:"admin-title",children:[i.jsx("h1",{children:j}),i.jsxs("div",{className:"admin-meta",children:[i.jsx("span",{className:"admin-role",children:w||""}),i.jsx("span",{className:"admin-sep",children:""}),i.jsx("span",{className:"admin-station",children:v})]})]})]})}),i.jsxs("div",{className:"admin-content",children:[i.jsx("div",{className:"admin-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"About"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Full Name"}),i.jsx("span",{className:"value",children:j})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Role"}),i.jsx("span",{className:"value",children:w||""})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Station"}),i.jsx("span",{className:"value",children:v})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Employee ID"}),i.jsx("span",{className:"value",children:_})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Joined"}),i.jsx("span",{className:"value",children:String(P).toString().slice(0,10)||""})]})]})]})}),i.jsx("div",{className:"admin-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"Contact"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Email"}),i.jsx("span",{className:"value",children:k})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Phone"}),i.jsx("span",{className:"value",children:C})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Address"}),i.jsx("span",{className:"value",children:S})]})]})]})})]}),p&&i.jsx("div",{className:"admin-error",children:p})]}):i.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"profile-modal-content",children:[i.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),i.jsx("h2",{children:"Admin Profile"}),p&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:p}),i.jsx("img",{src:b,alt:"Admin",style:{borderRadius:"50%"}}),s?i.jsx("div",{style:{padding:16},children:"Loading profile"}):i.jsxs("div",{className:"profile-info-grid",children:[i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Name"}),i.jsx("div",{children:j})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Email"}),i.jsx("div",{children:k})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Role"}),i.jsx("div",{children:w||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Phone"}),i.jsx("div",{children:C})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Address"}),i.jsx("div",{children:S})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Joined"}),i.jsx("div",{children:String(P).toString().slice(0,10)||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Employee ID"}),i.jsx("div",{children:_})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Station"}),i.jsx("div",{children:v})]})]})]})})}function zS(){return i.jsx("div",{id:"profile",className:"section",style:{padding:24},children:i.jsx(DS,{open:!0,inline:!0,onClose:()=>{}})})}const $S=[],WS=[];function HS(){const[e,t]=y.useState("booking"),[n,s]=y.useState($S),[a,l]=y.useState(WS),[c,u]=y.useState([]),[f,p]=y.useState([]),[g,x]=y.useState([]),[j,k]=y.useState(!1),[C,S]=y.useState(""),[P,_]=y.useState(""),[v,w]=y.useState([]),[b,B]=y.useState(""),[T,F]=y.useState(!1),[R,O]=y.useState(!1),[I,D]=y.useState(!1),[q,te]=y.useState(!1),[G,E]=y.useState(!1),[oe,Ne]=y.useState(!1),[W,fe]=y.useState(""),[re,U]=y.useState(""),[ie,Z]=y.useState(""),[se,ne]=y.useState(null),ce=async X=>{try{await Re.confirmBooking(X.id,"Cash",""),s(ee=>ee.map(Q=>Q.id===X.id?{...Q,status:"booked"}:Q))}catch(ee){fe((ee==null?void 0:ee.message)||"Failed to proceed to payment")}},ke=async(X,ee="")=>{var Q;try{await Re.cancelBooking(X.id,ee||""),s(M=>M.map(J=>J.id===X.id?{...J,status:"denied"}:J))}catch(M){const J=(Q=M==null?void 0:M.response)==null?void 0:Q.status;if(J===401||J===403){alert("You don't have permission to cancel this booking.");return}fe((M==null?void 0:M.message)||"Failed to cancel booking")}},we=(X,ee)=>{const Q=ee==="pending"?"Pending":ee==="booked"?"Booked":ee==="checked-in"?"Check-in Pending":ee==="completed"?"Completed":ee==="denied"?"Denied":ee;s(M=>M.map(J=>J.id===X?{...J,status:ee,statusLabel:Q}:J))},he=async X=>{try{if(!b){fe("Please select a station before creating a vehicle.");return}if(X instanceof FormData)console.log(" Received FormData payload for vehicle creation"),X.append("CurrentStationId",b);else{const J=X;J.currentStationId=b,J.stationId=b,J.StationId=b,J.rentalPricePerDate!=null&&J.rentalPricePerDay==null&&(J.rentalPricePerDay=J.rentalPricePerDate),J.rentalPricePerDay!=null&&J.rentalPricePerDate==null&&(J.rentalPricePerDate=J.rentalPricePerDay),J.batteryCapacity!=null&&J.BatteryCapacity==null&&(J.BatteryCapacity=J.batteryCapacity),J.currentBatteryLevel!=null&&J.CurrentBatteryLevel==null&&(J.CurrentBatteryLevel=J.currentBatteryLevel)}const ee=await Re.createCar(X),Q=ee||{},M=J=>({id:J.id||J.Id||J.carId||J.CarId,name:J.name||J.Name||[J.brand,J.model].filter(Boolean).join(" ")||"Car",model:J.model||J.Model||null,brand:J.brand||J.Brand||null,licensePlate:J.licensePlate||J.LicensePlate||null,img:J.imageUrl||J.image||J.thumbnailUrl||null,battery:Number.isFinite(J.currentBatteryLevel)?Math.round(J.currentBatteryLevel):void 0,tech:J.condition??J.status??J.Status??null,issue:J.issue??J.issueDescription??null,capacity:J.batteryCapacity??J.BatteryCapacity??J.capacity??J.capacityKWh??J.batteryCapacityKWh??null});return l(J=>[...J,M(Q)]),await Se(b),ee}catch(ee){throw fe((ee==null?void 0:ee.message)||"Failed to create vehicle"),ee}},Ve=async X=>{var ee;try{await Re.deleteCar(X),l(Q=>Q.filter(M=>M.id!==X)),await Se(b)}catch(Q){const M=(ee=Q==null?void 0:Q.response)==null?void 0:ee.status;if(M===401||M===403){U("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const J=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Ue=!1;for(const ve of J)try{await Re.updateStatus(X,ve),Ue=!0;break}catch{}if(Ue){l(ve=>ve.filter(We=>We.id!==X));return}}catch{}fe((Q==null?void 0:Q.message)||"Failed to delete vehicle")}},ht=async(X,ee)=>{try{if(ee.battery!==void 0&&ee.battery!==""){let Q=Number(ee.battery);Number.isNaN(Q)||(Q=Math.max(0,Math.min(100,Math.round(Q))),await Re.updateBatteryLevel(X,Q))}if(ee.tech&&await Re.updateStatus(X,ee.tech),ee.issue)try{await Re.updateCarDescription(X,ee.issue)}catch{await Re.updateCar(X,{description:ee.issue})}}catch(Q){fe((Q==null?void 0:Q.message)||"Failed to update vehicle")}l(Q=>Q.map(M=>M.id===X?{...M,...ee}:M))},qe=async()=>{te(!0);try{const ee=(await Re.getAllUsers(1,1e3)||[]).filter(Q=>Q.isActive!==!1&&Q.IsActive!==!1);u(ee)}catch(X){fe((X==null?void 0:X.message)||"Failed to load users")}finally{te(!1)}},Ct=async()=>{E(!0);try{const X=await Re.getDeletedAccounts(1,1e3);p(X||[])}catch(X){fe((X==null?void 0:X.message)||"Failed to load deleted users")}finally{E(!1)}},ge=async X=>{if(!X){x([]);return}Ne(!0);try{const ee=await Re.getStaffByStation(X);x(ee||[])}catch(ee){fe((ee==null?void 0:ee.message)||"Failed to load staff by station"),x([])}finally{Ne(!1)}},ae=async(X,ee)=>{try{await Re.assignStaffRole(X.id||X.Id||X.userId,ee),await qe(),b&&await ge(b),alert("User promoted to Station Staff successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to assign staff role")}},ye=async(X,ee)=>{try{await Re.removeStaffRole(X.id||X.Id||X.userId,ee),await qe(),b&&await ge(b),alert("Staff role removed successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to remove staff role")}},ue=async(X,ee)=>{try{const Q=X.id||X.Id||X.userId;X.stationId||X.StationId?await Re.reassignStaff(Q,ee):await Re.assignStaffToStation(ee,Q),await qe(),b&&await ge(b),alert("Staff assigned to station successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to assign staff to station")}},xe=async X=>{try{const ee=X.id||X.Id||X.userId;await Re.unassignStaffFromStation(ee),await qe(),b&&await ge(b),alert("Staff unassigned from station successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to unassign staff from station")}},Ie=async(X,ee)=>{try{const Q=X.id||X.Id||X.userId;await Re.softDeleteUser(Q,ee),u(M=>M.filter(J=>(J.id||J.Id||J.userId)!==Q)),await qe(),alert("User deleted successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to delete user")}},Ut=async X=>{try{const ee=X.userId||X.id||X.Id;await Re.restoreUser(ee),p(Q=>Q.filter(M=>(M.userId||M.id||M.Id)!==ee)),await Ct(),await qe(),alert("User restored successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to restore user")}},jn=async(X,ee,Q)=>{try{await Re.transferCar(X.id,ee,Q||"");const M=v.find(J=>(J.id||J.Id)===ee);alert(`Vehicle transferred successfully to ${(M==null?void 0:M.name)||(M==null?void 0:M.Name)||"target station"}`),await z(b),await Se(b)}catch(M){throw alert((M==null?void 0:M.message)||"Failed to transfer vehicle"),M}},Se=async X=>{if(!X){ne(null);return}try{const ee=await Re.getCarStatusReport(X,null);ee&&ne({totalCars:ee.totalCars||0,availableCars:ee.availableCars||0})}catch(ee){console.warn("Failed to load station slots:",ee)}},z=async X=>{try{F(!0);let ee=[];if(X){let ve=[],We=[];try{ve=await Re.getCarsByStation(X)}catch{}try{We=await Re.getAvailableCarsByStation(X)}catch{}const je=me=>Array.isArray(me)?me:me?[me]:[],$=je(ve),Le=je(We),Be=new Map;for(const me of[...$,...Le]){const V=String((me==null?void 0:me.id)||(me==null?void 0:me.Id)||(me==null?void 0:me.carId)||(me==null?void 0:me.CarId)||(me==null?void 0:me.licensePlate)||(me==null?void 0:me.LicensePlate)||Math.random());Be.has(V)||Be.set(V,me)}ee=Array.from(Be.values());try{const me=await Re.getAllCars(1,1e3),V=be=>be==null?"":String(be).replace(/[{}]/g,"").toLowerCase(),ze=V(X),Ye=(me||[]).filter(be=>{var Vt,dn,mr,gr;return[be.currentStationId,be.CurrentStationId,be.currentStationID,be.stationId,be.StationId,be.stationID,(Vt=be.station)==null?void 0:Vt.id,(dn=be.station)==null?void 0:dn.Id,(mr=be.station)==null?void 0:mr.stationId,(gr=be.station)==null?void 0:gr.StationId].some(Mt=>Mt!=null&&V(Mt)===ze)});for(const be of Ye){const tt=String((be==null?void 0:be.id)||(be==null?void 0:be.Id)||(be==null?void 0:be.carId)||(be==null?void 0:be.CarId)||(be==null?void 0:be.licensePlate)||(be==null?void 0:be.LicensePlate));tt&&!Be.has(tt)&&Be.set(tt,be)}ee=Array.from(Be.values())}catch{}}else try{ee=await Re.getAllCars(1,1e3)}catch{try{ee=await Re.listCars({page:1,pageSize:1e3})}catch{ee=[]}}Array.isArray(ee)||(ee=ee?[ee]:[]);const Q=ve=>{const We=Number(ve);return Number.isFinite(We)&&We>=0&&We<=100?Math.round(We):null},M=(ee||[]).map(ve=>{var me,V,ze,Ye;const je=((...be)=>be.find(tt=>tt!=null&&tt!==""))(ve.currentStationId,ve.CurrentStationId,ve.currentStationID,ve.stationId,ve.StationId,ve.stationID,(me=ve.station)==null?void 0:me.id,(V=ve.station)==null?void 0:V.Id,(ze=ve.station)==null?void 0:ze.stationId,(Ye=ve.station)==null?void 0:Ye.StationId),$=be=>be==null?"":String(be).replace(/[{}]/g,"").toLowerCase(),Le=je||"",Be=(()=>{if(!Le)return null;const be=v.find(tt=>$(tt.id||tt.Id)===$(Le))||null;return be&&(be.name||be.Name)||null})();return{id:ve.id||ve.Id||ve.carId||ve.CarId,name:ve.name||ve.Name||ve.model||ve.CarName||"Car",model:ve.model||ve.Model||null,brand:ve.brand||ve.Brand||null,licensePlate:ve.licensePlate||ve.LicensePlate||null,img:ve.imageUrl||ve.image||ve.thumbnailUrl||null,battery:Q(ve.currentBatteryLevel??ve.CurrentBatteryLevel??ve.batteryPercent??ve.battery),tech:ve.condition??ve.status??ve.Status??null,issue:ve.issue??ve.issueDescription??null,capacity:ve.batteryCapacity??ve.BatteryCapacity??ve.capacity??ve.capacityKWh??ve.batteryCapacityKWh??null,stationId:Le,stationName:Be||null}});l(M);const J=M.filter(ve=>ve.battery==null),Ue=M.filter(ve=>ve.capacity==null);if(J.length>0)try{const ve=await Promise.all(J.map(async We=>{try{const je=await Re.getCarBattery(We.id);return{id:We.id,battery:Q(je)}}catch{return{id:We.id,battery:null}}}));l(We=>We.map(je=>{const $=ve.find(Le=>Le.id===je.id);return $&&$.battery!=null?{...je,battery:$.battery}:je}))}catch{}if(Ue.length>0)try{const ve=await Promise.all(Ue.map(async We=>{try{const je=await Re.getCarCapacity(We.id);return{id:We.id,capacity:je}}catch{return{id:We.id,capacity:null}}}));l(We=>We.map(je=>{const $=ve.find(Le=>Le.id===je.id);return $&&$.capacity!=null?{...je,capacity:$.capacity}:je}))}catch{}}catch(ee){fe((ee==null?void 0:ee.message)||"Failed to load vehicles")}finally{F(!1)}};return y.useEffect(()=>{j?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[j]),y.useEffect(()=>{let X=!0;async function ee(){try{const M=await Re.getMe(),J=(M==null?void 0:M.role)||(M==null?void 0:M.Role)||(M==null?void 0:M.roleName)||(M==null?void 0:M.userRole)||(Array.isArray(M==null?void 0:M.roles)?M.roles[0]:"");X&&Z(J||"")}catch{try{const M=localStorage.getItem("token");if(M){const J=Re.decodeJwt(M),Ue=(J==null?void 0:J.role)||(J==null?void 0:J.Role)||J["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];X&&Z(Ue||"")}}catch{}}}async function Q(){try{O(!0);const M=await Re.getAllStations(1,100);if(!X)return;w(M||[]);const J=M&&M[0]&&(M[0].id||M[0].Id)||"";B(Ue=>Ue||J)}catch(M){if(!X)return;fe((M==null?void 0:M.message)||"Failed to load stations")}finally{X&&O(!1)}}return ee(),Q(),qe(),()=>{X=!1}},[]),y.useEffect(()=>{let X=!0;async function ee(){X&&(await z(b),await Se(b))}return ee(),()=>{X=!1}},[b,v]),y.useEffect(()=>{let X=!0;async function ee(){try{D(!0);let Q=[];if(b){try{Q=await Re.getBookingsByStation(b)}catch{Q=[]}if(!Q||Q.length===0)try{const $=await Re.listBookings({page:1,pageSize:200}),Le=String(b);Q=($||[]).filter(Be=>{var V,ze;const me=Be.stationId||Be.StationId||((V=Be.station)==null?void 0:V.id)||((ze=Be.station)==null?void 0:ze.Id)||Be.pickupStationId||Be.PickupStationId;return me!=null&&String(me)===Le})}catch{}if(Q&&Q.length>0){const $=String(b);Q=Q.filter(Le=>{var me,V,ze,Ye,be,tt,Vt;return[Le.stationId,Le.StationId,(me=Le.station)==null?void 0:me.id,(V=Le.station)==null?void 0:V.Id,Le.pickupStationId,Le.PickupStationId,Le.pickUpStationId,Le.PickUpStationId,Le.startStationId,Le.StartStationId,Le.originStationId,Le.OriginStationId,Le.fromStationId,Le.FromStationId,(ze=Le.car)==null?void 0:ze.stationId,(Ye=Le.car)==null?void 0:Ye.StationId,(be=Le.car)==null?void 0:be.currentStationId,(tt=Le.vehicle)==null?void 0:tt.stationId,(Vt=Le.vehicle)==null?void 0:Vt.StationId].some(dn=>dn!=null&&String(dn)===$)})}}else Q=await Re.listBookings({page:1,pageSize:100});if(!X)return;const M=(Q||[]).map($=>{var Qr,Lt,Pe,yr,vr,xr,_r,Qn,wr,un,jr,Jr,Xr,ei,ti,Sr,ni,Un,ri,ii,si,ai,oi,Jn,Sn,Nr,Cr,Nn,Me,Ke,Mn,fn,hn,Xn,Te,Je,Ge,Cn,Ot,Ia,li,On,at;const Le=$.id||$.Id||$.bookingId||$.BookingId,Be=((Qr=$.car)==null?void 0:Qr.brand)||((Lt=$.car)==null?void 0:Lt.Brand)||((Pe=$.vehicle)==null?void 0:Pe.brand)||((yr=$.vehicle)==null?void 0:yr.Brand)||$.carBrand||$.CarBrand||null,me=((vr=$.car)==null?void 0:vr.model)||((xr=$.car)==null?void 0:xr.Model)||((_r=$.vehicle)==null?void 0:_r.model)||((Qn=$.vehicle)==null?void 0:Qn.Model)||$.carModel||$.CarModel||null;let V=$.carName||$.vehicleName||((wr=$.car)==null?void 0:wr.name)||((un=$.car)==null?void 0:un.Name)||null;!V&&(Be||me)&&(V=[Be,me].filter(Boolean).join(" ").trim()||null),!V&&typeof $.carInfo=="string"&&$.carInfo.trim()&&(V=$.carInfo.trim()),!V&&typeof $.CarInfo=="string"&&$.CarInfo.trim()&&(V=$.CarInfo.trim()),V=V||"Booking";const ze=((jr=$.user)==null?void 0:jr.firstName)||((Jr=$.customer)==null?void 0:Jr.firstName)||$.firstName||$.FirstName||((Xr=$.user)==null?void 0:Xr.FirstName)||((ei=$.customer)==null?void 0:ei.FirstName),Ye=((ti=$.user)==null?void 0:ti.lastName)||((Sr=$.customer)==null?void 0:Sr.lastName)||$.lastName||$.LastName||((ni=$.user)==null?void 0:ni.LastName)||((Un=$.customer)==null?void 0:Un.LastName),be=[ze,Ye].filter(Boolean).join(" "),tt=be||$.customerName||$.userFullName||((ri=$.user)==null?void 0:ri.fullName)||((ii=$.customer)==null?void 0:ii.name)||((si=$.user)==null?void 0:si.name)||"Customer",Vt=$.userId||$.UserId||((ai=$.user)==null?void 0:ai.id)||((oi=$.user)==null?void 0:oi.Id)||$.customerId||$.CustomerId||$.appUserId||$.AppUserId||$.accountId||$.AccountId||$.UserID||$.ownerId||$.OwnerId||$.createdById||$.CreatedById||"",dn=((Jn=$.user)==null?void 0:Jn.userName)||((Sn=$.user)==null?void 0:Sn.UserName)||((Nr=$.user)==null?void 0:Nr.username)||$.userName||$.UserName||$.username||null,mr=((Cr=$.user)==null?void 0:Cr.email)||$.customerEmail||$.email||$.userEmail||"",gr=((Nn=$.user)==null?void 0:Nn.address)||$.customerAddress||$.address||"",Mt=$.statusCode??$.StatusCode??$.bookingStatus??$.BookingStatus??$.status??$.Status;let mt="booked",gt="Booked";if(Mt!=null&&(typeof Mt=="number"||/^\d+$/.test(String(Mt)))){const nt=Number(Mt);nt===0?(mt="pending",gt="Pending"):nt===1?(mt="booked",gt="Active"):nt===2?(mt="waiting-checkin",gt="Waiting for check-in"):nt===3?(mt="checked-in",gt="Checked-in"):nt===4?(mt="checkout-pending",gt="Check-out pending"):nt===5?(mt="completed",gt="Completed"):nt===6?(mt="cancelled-refund",gt="Cancelled pending refund"):nt===7&&(mt="cancelled",gt="Cancelled")}else{const nt=String(Mt||"").toLowerCase();nt.includes("pending")||nt.includes("wait")?(mt="pending",gt="Pending"):nt.includes("active")?(mt="booked",gt="Active"):nt.includes("check")&&nt.includes("in")?(mt="checked-in",gt="Checked-in"):nt.includes("complete")||nt.includes("finish")?(mt="completed",gt="Completed"):nt.includes("cancel")?(mt="cancelled",gt="Cancelled"):(mt="booked",gt="Booked")}const tn=String(Mt||"").toLowerCase(),Ei=Number(Mt)===0||tn.includes("pending")||tn.includes("wait")?"waiting-payment":tn.includes("check")&&tn.includes("in")&&(tn.includes("pay")||tn.includes("payment"))?"checkin-payment":null,Ti=$.date||$.createdAt||$.bookingDate||"",Bi=$.carImageUrl||((Me=$.car)==null?void 0:Me.imageUrl)||((Ke=$.vehicle)==null?void 0:Ke.imageUrl)||null;return{id:Le,title:V,firstName:ze||null,lastName:Ye||null,fullName:be||$.userFullName||((Mn=$.user)==null?void 0:Mn.fullName)||((fn=$.customer)==null?void 0:fn.name)||((hn=$.user)==null?void 0:hn.name)||null,customer:tt,userId:Vt,userName:dn,email:mr,address:gr,status:mt,statusLabel:gt,uiStage:Ei,date:Ti,img:Bi,cccdFrontUrl:$.cccdFrontUrl||$.identityFrontUrl||$.idFrontUrl||$.frontImageUrl||$.frontIdUrl||$.cccdFrontImageUrl||((Xn=$.customer)==null?void 0:Xn.cccdFrontUrl)||((Te=$.user)==null?void 0:Te.cccdFrontUrl),cccdBackUrl:$.cccdBackUrl||$.identityBackUrl||$.idBackUrl||$.backImageUrl||$.backIdUrl||$.cccdBackImageUrl||((Je=$.customer)==null?void 0:Je.cccdBackUrl)||((Ge=$.user)==null?void 0:Ge.cccdBackUrl),gplxFrontUrl:$.gplxFrontUrl||$.driverLicenseFrontUrl||$.gplxImageUrl_Front||((Cn=$.customer)==null?void 0:Cn.gplxImageUrl_Front)||((Ot=$.user)==null?void 0:Ot.gplxImageUrl_Front),gplxBackUrl:$.gplxBackUrl||$.driverLicenseBackUrl||$.gplxImageUrl_Back||((Ia=$.customer)==null?void 0:Ia.gplxImageUrl_Back)||((li=$.user)==null?void 0:li.gplxImageUrl_Back),idString:$.customerIdNumber||((On=$.user)==null?void 0:On.identityNumber)||"",phone:$.customerPhone||((at=$.user)==null?void 0:at.phoneNumber)||""}});s(M);const J=M.filter($=>$.userId&&!($.firstName&&$.lastName));if(J.length>0)try{const $=Array.from(new Set(J.map(me=>me.userId))),Le=await Promise.all($.map(async me=>{try{const V=await Re.getUserById(me),ze=(V==null?void 0:V.firstName)||(V==null?void 0:V.FirstName)||(V==null?void 0:V.givenName)||(V==null?void 0:V.GivenName)||null,Ye=(V==null?void 0:V.lastName)||(V==null?void 0:V.LastName)||(V==null?void 0:V.surname)||(V==null?void 0:V.Surname)||null,be=(V==null?void 0:V.fullName)||(V==null?void 0:V.FullName)||[ze,Ye].filter(Boolean).join(" ")||null,tt=(V==null?void 0:V.userName)||(V==null?void 0:V.UserName)||(V==null?void 0:V.username)||(V==null?void 0:V.user_name)||null,Vt=(V==null?void 0:V.address)||(V==null?void 0:V.Address)||"";return{uid:me,firstName:ze,lastName:Ye,fullName:be,userName:tt,address:Vt}}catch{return{uid:me,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!X)return;const Be=new Map(Le.map(me=>[me.uid,me]));s(me=>me.map(V=>{if(V.userId&&Be.has(V.userId)){const ze=Be.get(V.userId),Ye=V.fullName||ze.fullName||[ze.firstName,ze.lastName].filter(Boolean).join(" ");return{...V,firstName:V.firstName??ze.firstName??null,lastName:V.lastName??ze.lastName??null,fullName:Ye||V.customer||V.userName||null,userName:V.userName??ze.userName,address:V.address||ze.address}}return V}))}catch{}const Ue=$=>{var Le,Be,me,V;return $.carId||$.CarId||$.vehicleId||$.VehicleId||((Le=$.car)==null?void 0:Le.id)||((Be=$.car)==null?void 0:Be.Id)||((me=$.vehicle)==null?void 0:me.id)||((V=$.vehicle)==null?void 0:V.Id)},ve=M.filter($=>(!$.title||$.title==="Booking")&&Ue($));if(ve.length>0)try{const $=Array.from(new Set(ve.map(Ue).filter(Boolean))),Le=await Promise.all($.map(async me=>{try{let V=await Re.getCarById(me);if(!V||!V.id&&!V.Id)try{V=await Re.getCarByIdRest(me)}catch{}const ze=(V==null?void 0:V.name)||(V==null?void 0:V.Name)||[V==null?void 0:V.brand,V==null?void 0:V.model].filter(Boolean).join(" ")||null,Ye=(V==null?void 0:V.imageUrl)||(V==null?void 0:V.thumbnailUrl)||null;return{cid:me,name:ze,img:Ye}}catch{return{cid:me,name:null,img:null}}})),Be=new Map(Le.map(me=>[String(me.cid),me]));s(me=>me.map(V=>{const ze=Ue(V),Ye=ze!=null?String(ze):null;if(Ye&&Be.has(Ye)){const be=Be.get(Ye);return{...V,title:V.title&&V.title!=="Booking"?V.title:be.name||V.title,img:V.img||be.img||V.img}}return V}))}catch{}const je=($=>$.filter(Le=>!Le.title||Le.title==="Booking"))(M);if(je.length>0)try{const $=await Promise.all(je.map(async Be=>{try{const me=await Re.getVehicleModelFromBooking(Be.id),V=(me==null?void 0:me.name)||[me==null?void 0:me.brand,me==null?void 0:me.model].filter(Boolean).join(" ")||null;return{id:Be.id,title:V}}catch{return{id:Be.id,title:null}}})),Le=new Map($.map(Be=>[Be.id,Be.title]));s(Be=>Be.map(me=>Le.has(me.id)&&Le.get(me.id)?{...me,title:Le.get(me.id)}:me))}catch{}}catch(Q){if(!X)return;fe((Q==null?void 0:Q.message)||"Failed to load bookings")}finally{X&&D(!1)}}return ee(),()=>{X=!1}},[b]),y.useEffect(()=>{e==="staff"&&b&&ge(b)},[e,b]),i.jsxs("div",{className:"app-layout",children:[i.jsx(mS,{}),i.jsx("div",{className:"sidebar-hover-zone",onMouseEnter:()=>k(!0)}),i.jsx("div",{className:`sidebar-wrapper ${j?"visible":""}`,onMouseLeave:()=>k(!1),children:i.jsx(gS,{onSelect:t,isOpen:!0})}),i.jsxs("main",{className:`main-content ${j?"shifted":""}`,children:[re&&i.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:re}),W&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:W}),e==="booking"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsxs("select",{value:b,onChange:X=>B(X.target.value),disabled:R,children:[i.jsx("option",{value:"",children:"All stations"}),v.map(X=>{const ee=X.id||X.Id,Q=X.name||X.Name||X.stationName||`Station ${ee}`;return i.jsx("option",{value:ee,children:Q},ee)})]}),I&&i.jsx("span",{children:"Loading bookings"})]}),!I&&n.length===0&&i.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),i.jsx(jS,{bookings:n,search:C,setSearch:S,statusFilter:P,setStatusFilter:_,onContinuePayment:ce,onCancelBooking:ke,onStatusUpdated:we})]}),e==="vehicle"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsxs("select",{value:b,onChange:X=>B(X.target.value),disabled:R,children:[i.jsx("option",{value:"",children:"All stations"}),v.map(X=>{const ee=X.id||X.Id,Q=X.name||X.Name||X.stationName||`Station ${ee}`;return i.jsx("option",{value:ee,children:Q},ee)})]}),T&&i.jsx("span",{children:"Loading vehicles"})]}),i.jsx(IS,{vehicles:a,onAdd:he,onRemove:Ve,onUpdate:ht,stationId:b,canDelete:!0,stationSlots:se,onTransferCar:jn,stations:v})]}),e==="user"&&i.jsxs(i.Fragment,{children:[q&&i.jsx("div",{style:{padding:"10px 12px"},children:"Loading users..."}),i.jsx(AS,{users:c,deletedUsers:f,loadingDeleted:G,onAssignStaff:ae,onDeleteUser:Ie,onRestoreUser:Ut,onUserCreated:qe,onLoadDeleted:Ct})]}),e==="staff"&&i.jsxs(i.Fragment,{children:[(q||oe)&&i.jsx("div",{style:{padding:"10px 12px"},children:"Loading staff..."}),i.jsx(OS,{users:c,staffByStation:g,stations:v,onRemoveStaff:ye,onAssignStation:ue,onUnassignStation:xe,onStaffCreated:qe})]}),e==="incident"&&i.jsx(i.Fragment,{children:i.jsx("div",{style:{padding:"10px 12px",color:"#666"},children:i.jsx("p",{children:"Incident management section. Incidents are managed through booking details."})})}),e==="profile"&&i.jsx(zS,{})]})]})}const ly=y.createContext(null);function Eu(){return y.useContext(ly)}function ZS({children:e}){const[t,n]=y.useState(()=>{try{return JSON.parse(localStorage.getItem("user"))||null}catch{return null}}),[s,a]=y.useState(()=>localStorage.getItem("token")||null),[l,c]=y.useState(!1),[u,f]=y.useState(!1);y.useEffect(()=>{s?localStorage.setItem("token",s):localStorage.removeItem("token")},[s]),y.useEffect(()=>{t?(localStorage.setItem("user",JSON.stringify(t)),t.email&&localStorage.setItem("userEmail",t.email)):(localStorage.removeItem("user"),localStorage.removeItem("userEmail"))},[t]);async function p(k,C){var v,w,b,B;const S=await Vn.login(k,C),P=S.token||((v=S.payload)==null?void 0:v.token)||((w=S.raw)==null?void 0:w.token);P&&a(P);const _=((b=S.payload)==null?void 0:b.user)||((B=S.raw)==null?void 0:B.user)||S.payload&&S.payload.user||JSON.parse(localStorage.getItem("user"));return _&&n(_),c(!1),S}async function g(k,C,S,P){return await Vn.register({fullName:k,email:C,phoneNumber:S,password:P})}function x(){a(null),n(null),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userEmail"),localStorage.removeItem("stationId"),localStorage.removeItem("userRole")}const j={user:t,token:s,login:p,logout:x,register:g,showLogin:l,setShowLogin:c,showRegister:u,setShowRegister:f};return i.jsx(ly.Provider,{value:j,children:e})}function VS(){const{user:e,logout:t,setShowLogin:n,setShowRegister:s}=Eu(),a=pr(),[l,c]=y.useState(!1);function u(){c(g=>!g)}y.useEffect(()=>{const g=()=>{console.log(" Navigating to update profile page"),a("/update-profile"),c(!1)};return window.addEventListener("openUpdateProfile",g),()=>window.removeEventListener("openUpdateProfile",g)},[a]),y.useEffect(()=>{function g(x){l&&!x.target.closest(".user-menu")&&c(!1)}return document.addEventListener("click",g),()=>document.removeEventListener("click",g)},[l]);const f=e&&e.userRole==="Station Staff",p=e&&e.userRole==="Admin";return i.jsx(i.Fragment,{children:i.jsx("header",{className:"header",children:i.jsxs("div",{className:"container header-container",children:[i.jsx("div",{className:"logo",children:i.jsx("a",{href:"/",children:"FEC"})}),i.jsxs("nav",{className:"nav",children:[i.jsxs("div",{className:"navbar-left",children:[f&&i.jsxs("a",{href:"/staff",className:"staff-portal-btn",children:[i.jsx("i",{className:"fas fa-user-shield"})," Staff Portal"]}),p&&i.jsxs("a",{href:"/admin",className:"admin-portal-btn",children:[i.jsx("i",{className:"fas fa-user-shield"})," Admin Portal"]})]}),i.jsxs("div",{className:"navbar-right",children:[!e&&i.jsx("button",{id:"loginBtn",onClick:()=>n(!0),className:"login-nav-btn",children:"Login"}),e&&i.jsxs("div",{className:"user-menu",children:[i.jsxs("button",{className:"user-menu-btn",onClick:u,children:[i.jsx("i",{className:"fas fa-user-circle"}),i.jsx("i",{className:"fas fa-chevron-down"})]}),i.jsxs("div",{className:`user-dropdown ${l?"show":""}`,children:[i.jsxs("div",{className:"dropdown-header",children:[i.jsx("i",{className:"fas fa-user-circle"}),i.jsx("span",{id:"userEmail",children:e.email||"User Account"})]}),i.jsx("hr",{}),i.jsxs("a",{href:"/profile",children:[" ",i.jsx("i",{className:"fas fa-user-cog"})," User Profile"]}),i.jsxs("a",{href:"/update-profile",children:[" ",i.jsx("i",{className:"fas fa-edit"})," Update Profile"]}),i.jsxs("a",{href:"/booking-history",children:[" ",i.jsx("i",{className:"fas fa-history"})," Booking History"]}),i.jsxs("a",{href:"#",onClick:g=>{g.preventDefault(),t(),c(!1)},children:[" ",i.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})]})]})]})]})]})})})}function qS(){return i.jsx("footer",{className:"footer",children:i.jsx("div",{className:"container",children:i.jsx("p",{children:" 2025 FEC. All rights reserved."})})})}function GS(){const e=wa(),t=e.pathname.startsWith("/staff")||e.pathname.startsWith("/admin");return i.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",flex:1},children:[!t&&i.jsx(VS,{}),i.jsx("main",{style:{flex:1},children:i.jsxs(S_,{children:[i.jsx(nn,{path:"/",element:i.jsx(Fj,{})}),i.jsx(nn,{path:"/cars",element:i.jsx(Uj,{})}),i.jsx(nn,{path:"/cars/:id",element:i.jsx(Mj,{})}),i.jsx(nn,{path:"/payment",element:i.jsx(Oj,{})}),i.jsx(nn,{path:"/payment-success",element:i.jsx(Dj,{})}),i.jsx(nn,{path:"/payment-cancel",element:i.jsx(zj,{})}),i.jsx(nn,{path:"/transaction",element:i.jsx($j,{})}),i.jsx(nn,{path:"/booking-history",element:i.jsx(Wj,{})}),i.jsx(nn,{path:"/profile",element:i.jsx(ij,{})}),i.jsx(nn,{path:"/update-profile",element:i.jsx(aj,{})}),i.jsx(nn,{path:"/staff",element:i.jsx(pS,{})}),i.jsx(nn,{path:"/admin",element:i.jsx(HS,{})})]})}),!t&&i.jsx(qS,{})]})}function YS(){return i.jsx(P_,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:i.jsx(GS,{})})}function KS(){const{showLogin:e,setShowLogin:t,login:n,setShowRegister:s}=Eu(),[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,x]=y.useState({isOpen:!1,type:"info",title:"",message:""}),[j,k]=y.useState(!1),[C,S]=y.useState(!1);if(!e&&!g.isOpen)return null;const P=async w=>{try{console.log(" Checking profile completeness for user:",w);const b=await Vn.getMyProfile();console.log(" Profile data from /Users/Get-My-Profile:",b);const B=[];return(!b.address||b.address.trim()==="")&&B.push("Address"),(!b.dateOfBirth||b.dateOfBirth.trim()==="")&&B.push("Date of Birth"),(!b.driverLicenseNumber||b.driverLicenseNumber.trim()==="")&&B.push("Driver License Number"),(!b.driverLicenseExpiry||b.driverLicenseExpiry.trim()==="")&&B.push("Driver License Expiry"),B.length>0?(console.log(" Incomplete profile fields:",B),x({isOpen:!0,type:"warning",title:"Complete Your Profile ",message:`Your profile is incomplete. Please update: ${B.join(", ")}`}),S(!0),!0):(console.log(" Profile is complete"),!1)}catch(b){return console.error(" Error checking profile:",b),!1}};async function _(w){var b,B;w.preventDefault(),p(""),k(!0);try{console.log(" Logging in user:",a);const T=await n(a,c),F=localStorage.getItem("userRole")||(T==null?void 0:T.role);if(console.log(" User role:",F),(F==="Renter"||F==="Customer")&&await P(localStorage.getItem("userId"))){t(!1),k(!1);return}x({isOpen:!0,type:"success",title:"Login Successful! ",message:"Welcome back! You are now logged in."}),l(""),u(""),setTimeout(()=>{t(!1),x({...g,isOpen:!1})},1500)}catch(T){console.error(" Login error:",T);const F=T.message||((B=(b=T.response)==null?void 0:b.data)==null?void 0:B.message)||"Login failed";p(F),x({isOpen:!0,type:"error",title:"Login Failed",message:F})}finally{k(!1)}}function v(){t(!1),s(!0)}return i.jsxs(i.Fragment,{children:[e&&i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),i.jsx("h2",{children:"LOGIN"}),i.jsxs("form",{onSubmit:_,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:a,onChange:w=>l(w.target.value),placeholder:"Enter Email",required:!0,disabled:j}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:c,onChange:w=>u(w.target.value),placeholder:"Enter Password",required:!0,disabled:j}),i.jsx("i",{className:"fas fa-lock"})]}),f&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:f}),i.jsx("button",{type:"submit",disabled:j,children:j?"Logging in...":"Login"}),i.jsxs("p",{className:"modal-footer-text",children:["Don't have an account? ",i.jsx("a",{href:"#",onClick:w=>{w.preventDefault(),v()},children:"Register here"})]})]})]})}),i.jsx(ka,{isOpen:g.isOpen,type:g.type,title:g.title,message:g.message,onClose:()=>x({...g,isOpen:!1}),actionLabel:C?"Update Profile":void 0,onAction:C?()=>{window.dispatchEvent(new CustomEvent("openUpdateProfile")),S(!1)}:void 0})]})}function QS(){const{showRegister:e,setShowRegister:t,register:n}=Eu(),[s,a]=y.useState(""),[l,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[x,j]=y.useState(""),[k,C]=y.useState({isOpen:!1,type:"info",title:"",message:""}),[S,P]=y.useState(!1);if(!e&&!k.isOpen)return null;async function _(v){var w,b;v.preventDefault(),j(""),P(!0);try{console.log(" Registering user:",l),await n(s,l,u,p),C({isOpen:!0,type:"success",title:"Account Created! ",message:"Your account has been created successfully. You can now login and complete your profile."}),a(""),c(""),f(""),g(""),setTimeout(()=>{console.log(" Registration complete - closing register modal"),t(!1),C({...k,isOpen:!1})},2e3)}catch(B){console.error(" Registration error:",B);const T=B.message||((b=(w=B.response)==null?void 0:w.data)==null?void 0:b.message)||"Registration failed";j(T),C({isOpen:!0,type:"error",title:"Registration Failed",message:T})}finally{P(!1)}}return i.jsxs(i.Fragment,{children:[e&&i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),i.jsx("h2",{children:"Register"}),i.jsxs("form",{onSubmit:_,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:s,onChange:v=>a(v.target.value),placeholder:"Full Name",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-user"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:l,onChange:v=>c(v.target.value),placeholder:"Email",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:u,onChange:v=>f(v.target.value),placeholder:"Phone",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-phone"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:p,onChange:v=>g(v.target.value),placeholder:"Password",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-lock"})]}),x&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:x}),i.jsx("button",{type:"submit",disabled:S,children:S?"Creating Account...":"Create Account"}),i.jsxs("p",{className:"modal-footer-text",children:["Already have an account? ",i.jsx("a",{href:"#",onClick:v=>{v.preventDefault(),t(!1)},children:"Login here"})]})]})]})}),i.jsx(ka,{isOpen:k.isOpen,type:k.type,title:k.title,message:k.message,onClose:()=>C({...k,isOpen:!1})})]})}const JS=vg(document.getElementById("root"));JS.render(i.jsx(ZS,{children:i.jsxs(lj,{children:[i.jsx(YS,{}),i.jsx(KS,{}),i.jsx(QS,{})]})}));
