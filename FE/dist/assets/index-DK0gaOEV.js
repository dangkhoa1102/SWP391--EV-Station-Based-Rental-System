function ev(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var tv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var np={exports:{}},Ko={},rp={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ma=Symbol.for("react.element"),nv=Symbol.for("react.portal"),rv=Symbol.for("react.fragment"),iv=Symbol.for("react.strict_mode"),sv=Symbol.for("react.profiler"),av=Symbol.for("react.provider"),ov=Symbol.for("react.context"),lv=Symbol.for("react.forward_ref"),cv=Symbol.for("react.suspense"),dv=Symbol.for("react.memo"),uv=Symbol.for("react.lazy"),gf=Symbol.iterator;function fv(e){return e===null||typeof e!="object"?null:(e=gf&&e[gf]||e["@@iterator"],typeof e=="function"?e:null)}var ip={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sp=Object.assign,ap={};function fs(e,t,n){this.props=e,this.context=t,this.refs=ap,this.updater=n||ip}fs.prototype.isReactComponent={};fs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function op(){}op.prototype=fs.prototype;function Cd(e,t,n){this.props=e,this.context=t,this.refs=ap,this.updater=n||ip}var kd=Cd.prototype=new op;kd.constructor=Cd;sp(kd,fs.prototype);kd.isPureReactComponent=!0;var yf=Array.isArray,lp=Object.prototype.hasOwnProperty,Pd={current:null},cp={key:!0,ref:!0,__self:!0,__source:!0};function dp(e,t,n){var s,a={},l=null,c=null;if(t!=null)for(s in t.ref!==void 0&&(c=t.ref),t.key!==void 0&&(l=""+t.key),t)lp.call(t,s)&&!cp.hasOwnProperty(s)&&(a[s]=t[s]);var u=arguments.length-2;if(u===1)a.children=n;else if(1<u){for(var f=Array(u),p=0;p<u;p++)f[p]=arguments[p+2];a.children=f}if(e&&e.defaultProps)for(s in u=e.defaultProps,u)a[s]===void 0&&(a[s]=u[s]);return{$$typeof:ma,type:e,key:l,ref:c,props:a,_owner:Pd.current}}function hv(e,t){return{$$typeof:ma,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bd(e){return typeof e=="object"&&e!==null&&e.$$typeof===ma}function pv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var vf=/\/+/g;function Zl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pv(""+e.key):t.toString(36)}function co(e,t,n,s,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var c=!1;if(e===null)c=!0;else switch(l){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case ma:case nv:c=!0}}if(c)return c=e,a=a(c),e=s===""?"."+Zl(c,0):s,yf(a)?(n="",e!=null&&(n=e.replace(vf,"$&/")+"/"),co(a,t,n,"",function(p){return p})):a!=null&&(bd(a)&&(a=hv(a,n+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(vf,"$&/")+"/")+e)),t.push(a)),1;if(c=0,s=s===""?".":s+":",yf(e))for(var u=0;u<e.length;u++){l=e[u];var f=s+Zl(l,u);c+=co(l,t,n,f,a)}else if(f=fv(e),typeof f=="function")for(e=f.call(e),u=0;!(l=e.next()).done;)l=l.value,f=s+Zl(l,u++),c+=co(l,t,n,f,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function Wa(e,t,n){if(e==null)return e;var s=[],a=0;return co(e,s,"","",function(l){return t.call(n,l,a++)}),s}function mv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Wt={current:null},uo={transition:null},gv={ReactCurrentDispatcher:Wt,ReactCurrentBatchConfig:uo,ReactCurrentOwner:Pd};function up(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:Wa,forEach:function(e,t,n){Wa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Wa(e,function(){t++}),t},toArray:function(e){return Wa(e,function(t){return t})||[]},only:function(e){if(!bd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ze.Component=fs;ze.Fragment=rv;ze.Profiler=sv;ze.PureComponent=Cd;ze.StrictMode=iv;ze.Suspense=cv;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gv;ze.act=up;ze.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=sp({},e.props),a=e.key,l=e.ref,c=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,c=Pd.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(f in t)lp.call(t,f)&&!cp.hasOwnProperty(f)&&(s[f]=t[f]===void 0&&u!==void 0?u[f]:t[f])}var f=arguments.length-2;if(f===1)s.children=n;else if(1<f){u=Array(f);for(var p=0;p<f;p++)u[p]=arguments[p+2];s.children=u}return{$$typeof:ma,type:e.type,key:a,ref:l,props:s,_owner:c}};ze.createContext=function(e){return e={$$typeof:ov,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:av,_context:e},e.Consumer=e};ze.createElement=dp;ze.createFactory=function(e){var t=dp.bind(null,e);return t.type=e,t};ze.createRef=function(){return{current:null}};ze.forwardRef=function(e){return{$$typeof:lv,render:e}};ze.isValidElement=bd;ze.lazy=function(e){return{$$typeof:uv,_payload:{_status:-1,_result:e},_init:mv}};ze.memo=function(e,t){return{$$typeof:dv,type:e,compare:t===void 0?null:t}};ze.startTransition=function(e){var t=uo.transition;uo.transition={};try{e()}finally{uo.transition=t}};ze.unstable_act=up;ze.useCallback=function(e,t){return Wt.current.useCallback(e,t)};ze.useContext=function(e){return Wt.current.useContext(e)};ze.useDebugValue=function(){};ze.useDeferredValue=function(e){return Wt.current.useDeferredValue(e)};ze.useEffect=function(e,t){return Wt.current.useEffect(e,t)};ze.useId=function(){return Wt.current.useId()};ze.useImperativeHandle=function(e,t,n){return Wt.current.useImperativeHandle(e,t,n)};ze.useInsertionEffect=function(e,t){return Wt.current.useInsertionEffect(e,t)};ze.useLayoutEffect=function(e,t){return Wt.current.useLayoutEffect(e,t)};ze.useMemo=function(e,t){return Wt.current.useMemo(e,t)};ze.useReducer=function(e,t,n){return Wt.current.useReducer(e,t,n)};ze.useRef=function(e){return Wt.current.useRef(e)};ze.useState=function(e){return Wt.current.useState(e)};ze.useSyncExternalStore=function(e,t,n){return Wt.current.useSyncExternalStore(e,t,n)};ze.useTransition=function(){return Wt.current.useTransition()};ze.version="18.3.1";rp.exports=ze;var y=rp.exports;const Yn=tp(y),yv=ev({__proto__:null,default:Yn},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vv=y,xv=Symbol.for("react.element"),_v=Symbol.for("react.fragment"),wv=Object.prototype.hasOwnProperty,jv=vv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sv={key:!0,ref:!0,__self:!0,__source:!0};function fp(e,t,n){var s,a={},l=null,c=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(c=t.ref);for(s in t)wv.call(t,s)&&!Sv.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:xv,type:e,key:l,ref:c,props:a,_owner:jv.current}}Ko.Fragment=_v;Ko.jsx=fp;Ko.jsxs=fp;np.exports=Ko;var i=np.exports,hp={exports:{}},on={},pp={exports:{}},mp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,fe){var re=W.length;W.push(fe);e:for(;0<re;){var U=re-1>>>1,ie=W[U];if(0<a(ie,fe))W[U]=fe,W[re]=ie,re=U;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var fe=W[0],re=W.pop();if(re!==fe){W[0]=re;e:for(var U=0,ie=W.length,Z=ie>>>1;U<Z;){var se=2*(U+1)-1,ne=W[se],ce=se+1,ke=W[ce];if(0>a(ne,re))ce<ie&&0>a(ke,ne)?(W[U]=ke,W[ce]=re,U=ce):(W[U]=ne,W[se]=re,U=se);else if(ce<ie&&0>a(ke,re))W[U]=ke,W[ce]=re,U=ce;else break e}}return fe}function a(W,fe){var re=W.sortIndex-fe.sortIndex;return re!==0?re:W.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var f=[],p=[],g=1,v=null,j=3,k=!1,C=!1,S=!1,P=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var fe=n(p);fe!==null;){if(fe.callback===null)s(p);else if(fe.startTime<=W)s(p),fe.sortIndex=fe.expirationTime,t(f,fe);else break;fe=n(p)}}function b(W){if(S=!1,w(W),!C)if(n(f)!==null)C=!0,oe(B);else{var fe=n(p);fe!==null&&Ne(b,fe.startTime-W)}}function B(W,fe){C=!1,S&&(S=!1,_(R),R=-1),k=!0;var re=j;try{for(w(fe),v=n(f);v!==null&&(!(v.expirationTime>fe)||W&&!D());){var U=v.callback;if(typeof U=="function"){v.callback=null,j=v.priorityLevel;var ie=U(v.expirationTime<=fe);fe=e.unstable_now(),typeof ie=="function"?v.callback=ie:v===n(f)&&s(f),w(fe)}else s(f);v=n(f)}if(v!==null)var Z=!0;else{var se=n(p);se!==null&&Ne(b,se.startTime-fe),Z=!1}return Z}finally{v=null,j=re,k=!1}}var T=!1,F=null,R=-1,O=5,I=-1;function D(){return!(e.unstable_now()-I<O)}function q(){if(F!==null){var W=e.unstable_now();I=W;var fe=!0;try{fe=F(!0,W)}finally{fe?te():(T=!1,F=null)}}else T=!1}var te;if(typeof x=="function")te=function(){x(q)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,E=G.port2;G.port1.onmessage=q,te=function(){E.postMessage(null)}}else te=function(){P(q,0)};function oe(W){F=W,T||(T=!0,te())}function Ne(W,fe){R=P(function(){W(e.unstable_now())},fe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){C||k||(C=!0,oe(B))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return j},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(W){switch(j){case 1:case 2:case 3:var fe=3;break;default:fe=j}var re=j;j=fe;try{return W()}finally{j=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,fe){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var re=j;j=W;try{return fe()}finally{j=re}},e.unstable_scheduleCallback=function(W,fe,re){var U=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?U+re:U):re=U,W){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=re+ie,W={id:g++,callback:fe,priorityLevel:W,startTime:re,expirationTime:ie,sortIndex:-1},re>U?(W.sortIndex=re,t(p,W),n(f)===null&&W===n(p)&&(S?(_(R),R=-1):S=!0,Ne(b,re-U))):(W.sortIndex=ie,t(f,W),C||k||(C=!0,oe(B))),W},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(W){var fe=j;return function(){var re=j;j=fe;try{return W.apply(this,arguments)}finally{j=re}}}})(mp);pp.exports=mp;var Nv=pp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv=y,an=Nv;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gp=new Set,Ks={};function Pi(e,t){is(e,t),is(e+"Capture",t)}function is(e,t){for(Ks[e]=t,e=0;e<t.length;e++)gp.add(t[e])}var lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wc=Object.prototype.hasOwnProperty,kv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xf={},_f={};function Pv(e){return wc.call(_f,e)?!0:wc.call(xf,e)?!1:kv.test(e)?_f[e]=!0:(xf[e]=!0,!1)}function bv(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Iv(e,t,n,s){if(t===null||typeof t>"u"||bv(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ht(e,t,n,s,a,l,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=c}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bt[e]=new Ht(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bt[t]=new Ht(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bt[e]=new Ht(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bt[e]=new Ht(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bt[e]=new Ht(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bt[e]=new Ht(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bt[e]=new Ht(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bt[e]=new Ht(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bt[e]=new Ht(e,5,!1,e.toLowerCase(),null,!1,!1)});var Id=/[\-:]([a-z])/g;function Ld(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Id,Ld);bt[t]=new Ht(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Id,Ld);bt[t]=new Ht(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Id,Ld);bt[t]=new Ht(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bt[e]=new Ht(e,1,!1,e.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bt[e]=new Ht(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ed(e,t,n,s){var a=bt.hasOwnProperty(t)?bt[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Iv(t,n,a,s)&&(n=null),s||a===null?Pv(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,s=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var fr=Cv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ha=Symbol.for("react.element"),Di=Symbol.for("react.portal"),zi=Symbol.for("react.fragment"),Td=Symbol.for("react.strict_mode"),jc=Symbol.for("react.profiler"),yp=Symbol.for("react.provider"),vp=Symbol.for("react.context"),Bd=Symbol.for("react.forward_ref"),Sc=Symbol.for("react.suspense"),Nc=Symbol.for("react.suspense_list"),Rd=Symbol.for("react.memo"),Ir=Symbol.for("react.lazy"),xp=Symbol.for("react.offscreen"),wf=Symbol.iterator;function bs(e){return e===null||typeof e!="object"?null:(e=wf&&e[wf]||e["@@iterator"],typeof e=="function"?e:null)}var ct=Object.assign,Vl;function Us(e){if(Vl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Vl=t&&t[1]||""}return`
`+Vl+e}var ql=!1;function Gl(e,t){if(!e||ql)return"";ql=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var s=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){s=p}e.call(t.prototype)}else{try{throw Error()}catch(p){s=p}e()}}catch(p){if(p&&s&&typeof p.stack=="string"){for(var a=p.stack.split(`
`),l=s.stack.split(`
`),c=a.length-1,u=l.length-1;1<=c&&0<=u&&a[c]!==l[u];)u--;for(;1<=c&&0<=u;c--,u--)if(a[c]!==l[u]){if(c!==1||u!==1)do if(c--,u--,0>u||a[c]!==l[u]){var f=`
`+a[c].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=c&&0<=u);break}}}finally{ql=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Us(e):""}function Lv(e){switch(e.tag){case 5:return Us(e.type);case 16:return Us("Lazy");case 13:return Us("Suspense");case 19:return Us("SuspenseList");case 0:case 2:case 15:return e=Gl(e.type,!1),e;case 11:return e=Gl(e.type.render,!1),e;case 1:return e=Gl(e.type,!0),e;default:return""}}function Cc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case zi:return"Fragment";case Di:return"Portal";case jc:return"Profiler";case Td:return"StrictMode";case Sc:return"Suspense";case Nc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vp:return(e.displayName||"Context")+".Consumer";case yp:return(e._context.displayName||"Context")+".Provider";case Bd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rd:return t=e.displayName||null,t!==null?t:Cc(e.type)||"Memo";case Ir:t=e._payload,e=e._init;try{return Cc(e(t))}catch{}}return null}function Ev(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cc(t);case 8:return t===Td?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Zr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _p(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tv(e){var t=_p(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(c){s=""+c,l.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(c){s=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Za(e){e._valueTracker||(e._valueTracker=Tv(e))}function wp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=_p(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Co(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function kc(e,t){var n=t.checked;return ct({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function jf(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Zr(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jp(e,t){t=t.checked,t!=null&&Ed(e,"checked",t,!1)}function Pc(e,t){jp(e,t);var n=Zr(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bc(e,t.type,n):t.hasOwnProperty("defaultValue")&&bc(e,t.type,Zr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Sf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function bc(e,t,n){(t!=="number"||Co(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ms=Array.isArray;function Ji(e,t,n,s){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Zr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Ic(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return ct({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(pe(92));if(Ms(n)){if(1<n.length)throw Error(pe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Zr(n)}}function Sp(e,t){var n=Zr(t.value),s=Zr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Cf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Np(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Np(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Va,Cp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Va=Va||document.createElement("div"),Va.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Va.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bv=["Webkit","ms","Moz","O"];Object.keys(zs).forEach(function(e){Bv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zs[t]=zs[e]})});function kp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||zs.hasOwnProperty(e)&&zs[e]?(""+t).trim():t+"px"}function Pp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=kp(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,a):e[n]=a}}var Rv=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ec(e,t){if(t){if(Rv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function Tc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bc=null;function Ad(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Rc=null,Xi=null,es=null;function kf(e){if(e=va(e)){if(typeof Rc!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=tl(t),Rc(e.stateNode,e.type,t))}}function bp(e){Xi?es?es.push(e):es=[e]:Xi=e}function Ip(){if(Xi){var e=Xi,t=es;if(es=Xi=null,kf(e),t)for(e=0;e<t.length;e++)kf(t[e])}}function Lp(e,t){return e(t)}function Ep(){}var Yl=!1;function Tp(e,t,n){if(Yl)return e(t,n);Yl=!0;try{return Lp(e,t,n)}finally{Yl=!1,(Xi!==null||es!==null)&&(Ep(),Ip())}}function Js(e,t){var n=e.stateNode;if(n===null)return null;var s=tl(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(pe(231,t,typeof n));return n}var Ac=!1;if(lr)try{var Is={};Object.defineProperty(Is,"passive",{get:function(){Ac=!0}}),window.addEventListener("test",Is,Is),window.removeEventListener("test",Is,Is)}catch{Ac=!1}function Av(e,t,n,s,a,l,c,u,f){var p=Array.prototype.slice.call(arguments,3);try{t.apply(n,p)}catch(g){this.onError(g)}}var $s=!1,ko=null,Po=!1,Fc=null,Fv={onError:function(e){$s=!0,ko=e}};function Uv(e,t,n,s,a,l,c,u,f){$s=!1,ko=null,Av.apply(Fv,arguments)}function Mv(e,t,n,s,a,l,c,u,f){if(Uv.apply(this,arguments),$s){if($s){var p=ko;$s=!1,ko=null}else throw Error(pe(198));Po||(Po=!0,Fc=p)}}function bi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Bp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pf(e){if(bi(e)!==e)throw Error(pe(188))}function Ov(e){var t=e.alternate;if(!t){if(t=bi(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var n=e,s=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return Pf(a),e;if(l===s)return Pf(a),t;l=l.sibling}throw Error(pe(188))}if(n.return!==s.return)n=a,s=l;else{for(var c=!1,u=a.child;u;){if(u===n){c=!0,n=a,s=l;break}if(u===s){c=!0,s=a,n=l;break}u=u.sibling}if(!c){for(u=l.child;u;){if(u===n){c=!0,n=l,s=a;break}if(u===s){c=!0,s=l,n=a;break}u=u.sibling}if(!c)throw Error(pe(189))}}if(n.alternate!==s)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?e:t}function Rp(e){return e=Ov(e),e!==null?Ap(e):null}function Ap(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ap(e);if(t!==null)return t;e=e.sibling}return null}var Fp=an.unstable_scheduleCallback,bf=an.unstable_cancelCallback,Dv=an.unstable_shouldYield,zv=an.unstable_requestPaint,ht=an.unstable_now,$v=an.unstable_getCurrentPriorityLevel,Fd=an.unstable_ImmediatePriority,Up=an.unstable_UserBlockingPriority,bo=an.unstable_NormalPriority,Wv=an.unstable_LowPriority,Mp=an.unstable_IdlePriority,Qo=null,qn=null;function Hv(e){if(qn&&typeof qn.onCommitFiberRoot=="function")try{qn.onCommitFiberRoot(Qo,e,void 0,(e.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:qv,Zv=Math.log,Vv=Math.LN2;function qv(e){return e>>>=0,e===0?32:31-(Zv(e)/Vv|0)|0}var qa=64,Ga=4194304;function Os(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Io(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,a=e.suspendedLanes,l=e.pingedLanes,c=n&268435455;if(c!==0){var u=c&~a;u!==0?s=Os(u):(l&=c,l!==0&&(s=Os(l)))}else c=n&~a,c!==0?s=Os(c):l!==0&&(s=Os(l));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-Tn(t),a=1<<n,s|=e[n],t&=~a;return s}function Gv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yv(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var c=31-Tn(l),u=1<<c,f=a[c];f===-1?(!(u&n)||u&s)&&(a[c]=Gv(u,t)):f<=t&&(e.expiredLanes|=u),l&=~u}}function Uc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Op(){var e=qa;return qa<<=1,!(qa&4194240)&&(qa=64),e}function Kl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ga(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tn(t),e[t]=n}function Kv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Tn(n),l=1<<a;t[a]=0,s[a]=-1,e[a]=-1,n&=~l}}function Ud(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Tn(n),a=1<<s;a&t|e[s]&t&&(e[s]|=t),n&=~a}}var Qe=0;function Dp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zp,Md,$p,Wp,Hp,Mc=!1,Ya=[],Fr=null,Ur=null,Mr=null,Xs=new Map,ea=new Map,Er=[],Qv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function If(e,t){switch(e){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":Mr=null;break;case"pointerover":case"pointerout":Xs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(t.pointerId)}}function Ls(e,t,n,s,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:l,targetContainers:[a]},t!==null&&(t=va(t),t!==null&&Md(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Jv(e,t,n,s,a){switch(t){case"focusin":return Fr=Ls(Fr,e,t,n,s,a),!0;case"dragenter":return Ur=Ls(Ur,e,t,n,s,a),!0;case"mouseover":return Mr=Ls(Mr,e,t,n,s,a),!0;case"pointerover":var l=a.pointerId;return Xs.set(l,Ls(Xs.get(l)||null,e,t,n,s,a)),!0;case"gotpointercapture":return l=a.pointerId,ea.set(l,Ls(ea.get(l)||null,e,t,n,s,a)),!0}return!1}function Zp(e){var t=hi(e.target);if(t!==null){var n=bi(t);if(n!==null){if(t=n.tag,t===13){if(t=Bp(n),t!==null){e.blockedOn=t,Hp(e.priority,function(){$p(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Oc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Bc=s,n.target.dispatchEvent(s),Bc=null}else return t=va(n),t!==null&&Md(t),e.blockedOn=n,!1;t.shift()}return!0}function Lf(e,t,n){fo(e)&&n.delete(t)}function Xv(){Mc=!1,Fr!==null&&fo(Fr)&&(Fr=null),Ur!==null&&fo(Ur)&&(Ur=null),Mr!==null&&fo(Mr)&&(Mr=null),Xs.forEach(Lf),ea.forEach(Lf)}function Es(e,t){e.blockedOn===t&&(e.blockedOn=null,Mc||(Mc=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Xv)))}function ta(e){function t(a){return Es(a,e)}if(0<Ya.length){Es(Ya[0],e);for(var n=1;n<Ya.length;n++){var s=Ya[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Fr!==null&&Es(Fr,e),Ur!==null&&Es(Ur,e),Mr!==null&&Es(Mr,e),Xs.forEach(t),ea.forEach(t),n=0;n<Er.length;n++)s=Er[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Er.length&&(n=Er[0],n.blockedOn===null);)Zp(n),n.blockedOn===null&&Er.shift()}var ts=fr.ReactCurrentBatchConfig,Lo=!0;function ex(e,t,n,s){var a=Qe,l=ts.transition;ts.transition=null;try{Qe=1,Od(e,t,n,s)}finally{Qe=a,ts.transition=l}}function tx(e,t,n,s){var a=Qe,l=ts.transition;ts.transition=null;try{Qe=4,Od(e,t,n,s)}finally{Qe=a,ts.transition=l}}function Od(e,t,n,s){if(Lo){var a=Oc(e,t,n,s);if(a===null)ac(e,t,s,Eo,n),If(e,s);else if(Jv(a,e,t,n,s))s.stopPropagation();else if(If(e,s),t&4&&-1<Qv.indexOf(e)){for(;a!==null;){var l=va(a);if(l!==null&&zp(l),l=Oc(e,t,n,s),l===null&&ac(e,t,s,Eo,n),l===a)break;a=l}a!==null&&s.stopPropagation()}else ac(e,t,s,null,n)}}var Eo=null;function Oc(e,t,n,s){if(Eo=null,e=Ad(s),e=hi(e),e!==null)if(t=bi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Bp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Eo=e,null}function Vp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($v()){case Fd:return 1;case Up:return 4;case bo:case Wv:return 16;case Mp:return 536870912;default:return 16}default:return 16}}var Br=null,Dd=null,ho=null;function qp(){if(ho)return ho;var e,t=Dd,n=t.length,s,a="value"in Br?Br.value:Br.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var c=n-e;for(s=1;s<=c&&t[n-s]===a[l-s];s++);return ho=a.slice(e,1<s?1-s:void 0)}function po(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ka(){return!0}function Ef(){return!1}function ln(e){function t(n,s,a,l,c){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=l,this.target=c,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(l):l[u]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Ka:Ef,this.isPropagationStopped=Ef,this}return ct(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ka)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ka)},persist:function(){},isPersistent:Ka}),t}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zd=ln(hs),ya=ct({},hs,{view:0,detail:0}),nx=ln(ya),Ql,Jl,Ts,Jo=ct({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$d,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ts&&(Ts&&e.type==="mousemove"?(Ql=e.screenX-Ts.screenX,Jl=e.screenY-Ts.screenY):Jl=Ql=0,Ts=e),Ql)},movementY:function(e){return"movementY"in e?e.movementY:Jl}}),Tf=ln(Jo),rx=ct({},Jo,{dataTransfer:0}),ix=ln(rx),sx=ct({},ya,{relatedTarget:0}),Xl=ln(sx),ax=ct({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),ox=ln(ax),lx=ct({},hs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cx=ln(lx),dx=ct({},hs,{data:0}),Bf=ln(dx),ux={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function px(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hx[e])?!!t[e]:!1}function $d(){return px}var mx=ct({},ya,{key:function(e){if(e.key){var t=ux[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=po(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?fx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$d,charCode:function(e){return e.type==="keypress"?po(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?po(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gx=ln(mx),yx=ct({},Jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rf=ln(yx),vx=ct({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$d}),xx=ln(vx),_x=ct({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),wx=ln(_x),jx=ct({},Jo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Sx=ln(jx),Nx=[9,13,27,32],Wd=lr&&"CompositionEvent"in window,Ws=null;lr&&"documentMode"in document&&(Ws=document.documentMode);var Cx=lr&&"TextEvent"in window&&!Ws,Gp=lr&&(!Wd||Ws&&8<Ws&&11>=Ws),Af=" ",Ff=!1;function Yp(e,t){switch(e){case"keyup":return Nx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $i=!1;function kx(e,t){switch(e){case"compositionend":return Kp(t);case"keypress":return t.which!==32?null:(Ff=!0,Af);case"textInput":return e=t.data,e===Af&&Ff?null:e;default:return null}}function Px(e,t){if($i)return e==="compositionend"||!Wd&&Yp(e,t)?(e=qp(),ho=Dd=Br=null,$i=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Gp&&t.locale!=="ko"?null:t.data;default:return null}}var bx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!bx[e.type]:t==="textarea"}function Qp(e,t,n,s){bp(s),t=To(t,"onChange"),0<t.length&&(n=new zd("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Hs=null,na=null;function Ix(e){lm(e,0)}function Xo(e){var t=Zi(e);if(wp(t))return e}function Lx(e,t){if(e==="change")return t}var Jp=!1;if(lr){var ec;if(lr){var tc="oninput"in document;if(!tc){var Mf=document.createElement("div");Mf.setAttribute("oninput","return;"),tc=typeof Mf.oninput=="function"}ec=tc}else ec=!1;Jp=ec&&(!document.documentMode||9<document.documentMode)}function Of(){Hs&&(Hs.detachEvent("onpropertychange",Xp),na=Hs=null)}function Xp(e){if(e.propertyName==="value"&&Xo(na)){var t=[];Qp(t,na,e,Ad(e)),Tp(Ix,t)}}function Ex(e,t,n){e==="focusin"?(Of(),Hs=t,na=n,Hs.attachEvent("onpropertychange",Xp)):e==="focusout"&&Of()}function Tx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xo(na)}function Bx(e,t){if(e==="click")return Xo(t)}function Rx(e,t){if(e==="input"||e==="change")return Xo(t)}function Ax(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rn=typeof Object.is=="function"?Object.is:Ax;function ra(e,t){if(Rn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!wc.call(t,a)||!Rn(e[a],t[a]))return!1}return!0}function Df(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zf(e,t){var n=Df(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Df(n)}}function em(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?em(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function tm(){for(var e=window,t=Co();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Co(e.document)}return t}function Hd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Fx(e){var t=tm(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&em(n.ownerDocument.documentElement,n)){if(s!==null&&Hd(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(s.start,a);s=s.end===void 0?l:Math.min(s.end,a),!e.extend&&l>s&&(a=s,s=l,l=a),a=zf(n,l);var c=zf(n,s);a&&c&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>s?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ux=lr&&"documentMode"in document&&11>=document.documentMode,Wi=null,Dc=null,Zs=null,zc=!1;function $f(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zc||Wi==null||Wi!==Co(s)||(s=Wi,"selectionStart"in s&&Hd(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Zs&&ra(Zs,s)||(Zs=s,s=To(Dc,"onSelect"),0<s.length&&(t=new zd("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Wi)))}function Qa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Hi={animationend:Qa("Animation","AnimationEnd"),animationiteration:Qa("Animation","AnimationIteration"),animationstart:Qa("Animation","AnimationStart"),transitionend:Qa("Transition","TransitionEnd")},nc={},nm={};lr&&(nm=document.createElement("div").style,"AnimationEvent"in window||(delete Hi.animationend.animation,delete Hi.animationiteration.animation,delete Hi.animationstart.animation),"TransitionEvent"in window||delete Hi.transitionend.transition);function el(e){if(nc[e])return nc[e];if(!Hi[e])return e;var t=Hi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in nm)return nc[e]=t[n];return e}var rm=el("animationend"),im=el("animationiteration"),sm=el("animationstart"),am=el("transitionend"),om=new Map,Wf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qr(e,t){om.set(e,t),Pi(t,[e])}for(var rc=0;rc<Wf.length;rc++){var ic=Wf[rc],Mx=ic.toLowerCase(),Ox=ic[0].toUpperCase()+ic.slice(1);qr(Mx,"on"+Ox)}qr(rm,"onAnimationEnd");qr(im,"onAnimationIteration");qr(sm,"onAnimationStart");qr("dblclick","onDoubleClick");qr("focusin","onFocus");qr("focusout","onBlur");qr(am,"onTransitionEnd");is("onMouseEnter",["mouseout","mouseover"]);is("onMouseLeave",["mouseout","mouseover"]);is("onPointerEnter",["pointerout","pointerover"]);is("onPointerLeave",["pointerout","pointerover"]);Pi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ds="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ds));function Hf(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,Mv(s,t,void 0,e),e.currentTarget=null}function lm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],a=s.event;s=s.listeners;e:{var l=void 0;if(t)for(var c=s.length-1;0<=c;c--){var u=s[c],f=u.instance,p=u.currentTarget;if(u=u.listener,f!==l&&a.isPropagationStopped())break e;Hf(a,u,p),l=f}else for(c=0;c<s.length;c++){if(u=s[c],f=u.instance,p=u.currentTarget,u=u.listener,f!==l&&a.isPropagationStopped())break e;Hf(a,u,p),l=f}}}if(Po)throw e=Fc,Po=!1,Fc=null,e}function rt(e,t){var n=t[Vc];n===void 0&&(n=t[Vc]=new Set);var s=e+"__bubble";n.has(s)||(cm(t,e,2,!1),n.add(s))}function sc(e,t,n){var s=0;t&&(s|=4),cm(n,e,s,t)}var Ja="_reactListening"+Math.random().toString(36).slice(2);function ia(e){if(!e[Ja]){e[Ja]=!0,gp.forEach(function(n){n!=="selectionchange"&&(Dx.has(n)||sc(n,!1,e),sc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ja]||(t[Ja]=!0,sc("selectionchange",!1,t))}}function cm(e,t,n,s){switch(Vp(t)){case 1:var a=ex;break;case 4:a=tx;break;default:a=Od}n=a.bind(null,t,n,e),a=void 0,!Ac||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function ac(e,t,n,s,a){var l=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var c=s.tag;if(c===3||c===4){var u=s.stateNode.containerInfo;if(u===a||u.nodeType===8&&u.parentNode===a)break;if(c===4)for(c=s.return;c!==null;){var f=c.tag;if((f===3||f===4)&&(f=c.stateNode.containerInfo,f===a||f.nodeType===8&&f.parentNode===a))return;c=c.return}for(;u!==null;){if(c=hi(u),c===null)return;if(f=c.tag,f===5||f===6){s=l=c;continue e}u=u.parentNode}}s=s.return}Tp(function(){var p=l,g=Ad(n),v=[];e:{var j=om.get(e);if(j!==void 0){var k=zd,C=e;switch(e){case"keypress":if(po(n)===0)break e;case"keydown":case"keyup":k=gx;break;case"focusin":C="focus",k=Xl;break;case"focusout":C="blur",k=Xl;break;case"beforeblur":case"afterblur":k=Xl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Tf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=ix;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=xx;break;case rm:case im:case sm:k=ox;break;case am:k=wx;break;case"scroll":k=nx;break;case"wheel":k=Sx;break;case"copy":case"cut":case"paste":k=cx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Rf}var S=(t&4)!==0,P=!S&&e==="scroll",_=S?j!==null?j+"Capture":null:j;S=[];for(var x=p,w;x!==null;){w=x;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,_!==null&&(b=Js(x,_),b!=null&&S.push(sa(x,b,w)))),P)break;x=x.return}0<S.length&&(j=new k(j,C,null,n,g),v.push({event:j,listeners:S}))}}if(!(t&7)){e:{if(j=e==="mouseover"||e==="pointerover",k=e==="mouseout"||e==="pointerout",j&&n!==Bc&&(C=n.relatedTarget||n.fromElement)&&(hi(C)||C[cr]))break e;if((k||j)&&(j=g.window===g?g:(j=g.ownerDocument)?j.defaultView||j.parentWindow:window,k?(C=n.relatedTarget||n.toElement,k=p,C=C?hi(C):null,C!==null&&(P=bi(C),C!==P||C.tag!==5&&C.tag!==6)&&(C=null)):(k=null,C=p),k!==C)){if(S=Tf,b="onMouseLeave",_="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(S=Rf,b="onPointerLeave",_="onPointerEnter",x="pointer"),P=k==null?j:Zi(k),w=C==null?j:Zi(C),j=new S(b,x+"leave",k,n,g),j.target=P,j.relatedTarget=w,b=null,hi(g)===p&&(S=new S(_,x+"enter",C,n,g),S.target=w,S.relatedTarget=P,b=S),P=b,k&&C)t:{for(S=k,_=C,x=0,w=S;w;w=Oi(w))x++;for(w=0,b=_;b;b=Oi(b))w++;for(;0<x-w;)S=Oi(S),x--;for(;0<w-x;)_=Oi(_),w--;for(;x--;){if(S===_||_!==null&&S===_.alternate)break t;S=Oi(S),_=Oi(_)}S=null}else S=null;k!==null&&Zf(v,j,k,S,!1),C!==null&&P!==null&&Zf(v,P,C,S,!0)}}e:{if(j=p?Zi(p):window,k=j.nodeName&&j.nodeName.toLowerCase(),k==="select"||k==="input"&&j.type==="file")var B=Lx;else if(Uf(j))if(Jp)B=Rx;else{B=Tx;var T=Ex}else(k=j.nodeName)&&k.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(B=Bx);if(B&&(B=B(e,p))){Qp(v,B,n,g);break e}T&&T(e,j,p),e==="focusout"&&(T=j._wrapperState)&&T.controlled&&j.type==="number"&&bc(j,"number",j.value)}switch(T=p?Zi(p):window,e){case"focusin":(Uf(T)||T.contentEditable==="true")&&(Wi=T,Dc=p,Zs=null);break;case"focusout":Zs=Dc=Wi=null;break;case"mousedown":zc=!0;break;case"contextmenu":case"mouseup":case"dragend":zc=!1,$f(v,n,g);break;case"selectionchange":if(Ux)break;case"keydown":case"keyup":$f(v,n,g)}var F;if(Wd)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else $i?Yp(e,n)&&(R="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(Gp&&n.locale!=="ko"&&($i||R!=="onCompositionStart"?R==="onCompositionEnd"&&$i&&(F=qp()):(Br=g,Dd="value"in Br?Br.value:Br.textContent,$i=!0)),T=To(p,R),0<T.length&&(R=new Bf(R,e,null,n,g),v.push({event:R,listeners:T}),F?R.data=F:(F=Kp(n),F!==null&&(R.data=F)))),(F=Cx?kx(e,n):Px(e,n))&&(p=To(p,"onBeforeInput"),0<p.length&&(g=new Bf("onBeforeInput","beforeinput",null,n,g),v.push({event:g,listeners:p}),g.data=F))}lm(v,t)})}function sa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function To(e,t){for(var n=t+"Capture",s=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=Js(e,n),l!=null&&s.unshift(sa(e,l,a)),l=Js(e,t),l!=null&&s.push(sa(e,l,a))),e=e.return}return s}function Oi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Zf(e,t,n,s,a){for(var l=t._reactName,c=[];n!==null&&n!==s;){var u=n,f=u.alternate,p=u.stateNode;if(f!==null&&f===s)break;u.tag===5&&p!==null&&(u=p,a?(f=Js(n,l),f!=null&&c.unshift(sa(n,f,u))):a||(f=Js(n,l),f!=null&&c.push(sa(n,f,u)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var zx=/\r\n?/g,$x=/\u0000|\uFFFD/g;function Vf(e){return(typeof e=="string"?e:""+e).replace(zx,`
`).replace($x,"")}function Xa(e,t,n){if(t=Vf(t),Vf(e)!==t&&n)throw Error(pe(425))}function Bo(){}var $c=null,Wc=null;function Hc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zc=typeof setTimeout=="function"?setTimeout:void 0,Wx=typeof clearTimeout=="function"?clearTimeout:void 0,qf=typeof Promise=="function"?Promise:void 0,Hx=typeof queueMicrotask=="function"?queueMicrotask:typeof qf<"u"?function(e){return qf.resolve(null).then(e).catch(Zx)}:Zc;function Zx(e){setTimeout(function(){throw e})}function oc(e,t){var n=t,s=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){e.removeChild(a),ta(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);ta(t)}function Or(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Gf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ps=Math.random().toString(36).slice(2),Vn="__reactFiber$"+ps,aa="__reactProps$"+ps,cr="__reactContainer$"+ps,Vc="__reactEvents$"+ps,Vx="__reactListeners$"+ps,qx="__reactHandles$"+ps;function hi(e){var t=e[Vn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[cr]||n[Vn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Gf(e);e!==null;){if(n=e[Vn])return n;e=Gf(e)}return t}e=n,n=e.parentNode}return null}function va(e){return e=e[Vn]||e[cr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function tl(e){return e[aa]||null}var qc=[],Vi=-1;function Gr(e){return{current:e}}function it(e){0>Vi||(e.current=qc[Vi],qc[Vi]=null,Vi--)}function et(e,t){Vi++,qc[Vi]=e.current,e.current=t}var Vr={},At=Gr(Vr),Yt=Gr(!1),wi=Vr;function ss(e,t){var n=e.type.contextTypes;if(!n)return Vr;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Kt(e){return e=e.childContextTypes,e!=null}function Ro(){it(Yt),it(At)}function Yf(e,t,n){if(At.current!==Vr)throw Error(pe(168));et(At,t),et(Yt,n)}function dm(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(pe(108,Ev(e)||"Unknown",a));return ct({},n,s)}function Ao(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vr,wi=At.current,et(At,e),et(Yt,Yt.current),!0}function Kf(e,t,n){var s=e.stateNode;if(!s)throw Error(pe(169));n?(e=dm(e,t,wi),s.__reactInternalMemoizedMergedChildContext=e,it(Yt),it(At),et(At,e)):it(Yt),et(Yt,n)}var ir=null,nl=!1,lc=!1;function um(e){ir===null?ir=[e]:ir.push(e)}function Gx(e){nl=!0,um(e)}function Yr(){if(!lc&&ir!==null){lc=!0;var e=0,t=Qe;try{var n=ir;for(Qe=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}ir=null,nl=!1}catch(a){throw ir!==null&&(ir=ir.slice(e+1)),Fp(Fd,Yr),a}finally{Qe=t,lc=!1}}return null}var qi=[],Gi=0,Fo=null,Uo=0,mn=[],gn=0,ji=null,sr=1,ar="";function ui(e,t){qi[Gi++]=Uo,qi[Gi++]=Fo,Fo=e,Uo=t}function fm(e,t,n){mn[gn++]=sr,mn[gn++]=ar,mn[gn++]=ji,ji=e;var s=sr;e=ar;var a=32-Tn(s)-1;s&=~(1<<a),n+=1;var l=32-Tn(t)+a;if(30<l){var c=a-a%5;l=(s&(1<<c)-1).toString(32),s>>=c,a-=c,sr=1<<32-Tn(t)+a|n<<a|s,ar=l+e}else sr=1<<l|n<<a|s,ar=e}function Zd(e){e.return!==null&&(ui(e,1),fm(e,1,0))}function Vd(e){for(;e===Fo;)Fo=qi[--Gi],qi[Gi]=null,Uo=qi[--Gi],qi[Gi]=null;for(;e===ji;)ji=mn[--gn],mn[gn]=null,ar=mn[--gn],mn[gn]=null,sr=mn[--gn],mn[gn]=null}var sn=null,rn=null,st=!1,Ln=null;function hm(e,t){var n=yn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Qf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,rn=Or(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,rn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ji!==null?{id:sr,overflow:ar}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=yn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,sn=e,rn=null,!0):!1;default:return!1}}function Gc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yc(e){if(st){var t=rn;if(t){var n=t;if(!Qf(e,t)){if(Gc(e))throw Error(pe(418));t=Or(n.nextSibling);var s=sn;t&&Qf(e,t)?hm(s,n):(e.flags=e.flags&-4097|2,st=!1,sn=e)}}else{if(Gc(e))throw Error(pe(418));e.flags=e.flags&-4097|2,st=!1,sn=e}}}function Jf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function eo(e){if(e!==sn)return!1;if(!st)return Jf(e),st=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Hc(e.type,e.memoizedProps)),t&&(t=rn)){if(Gc(e))throw pm(),Error(pe(418));for(;t;)hm(e,t),t=Or(t.nextSibling)}if(Jf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){rn=Or(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}rn=null}}else rn=sn?Or(e.stateNode.nextSibling):null;return!0}function pm(){for(var e=rn;e;)e=Or(e.nextSibling)}function as(){rn=sn=null,st=!1}function qd(e){Ln===null?Ln=[e]:Ln.push(e)}var Yx=fr.ReactCurrentBatchConfig;function Bs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var s=n.stateNode}if(!s)throw Error(pe(147,e));var a=s,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(c){var u=a.refs;c===null?delete u[l]:u[l]=c},t._stringRef=l,t)}if(typeof e!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,e))}return e}function to(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xf(e){var t=e._init;return t(e._payload)}function mm(e){function t(_,x){if(e){var w=_.deletions;w===null?(_.deletions=[x],_.flags|=16):w.push(x)}}function n(_,x){if(!e)return null;for(;x!==null;)t(_,x),x=x.sibling;return null}function s(_,x){for(_=new Map;x!==null;)x.key!==null?_.set(x.key,x):_.set(x.index,x),x=x.sibling;return _}function a(_,x){return _=Wr(_,x),_.index=0,_.sibling=null,_}function l(_,x,w){return _.index=w,e?(w=_.alternate,w!==null?(w=w.index,w<x?(_.flags|=2,x):w):(_.flags|=2,x)):(_.flags|=1048576,x)}function c(_){return e&&_.alternate===null&&(_.flags|=2),_}function u(_,x,w,b){return x===null||x.tag!==6?(x=mc(w,_.mode,b),x.return=_,x):(x=a(x,w),x.return=_,x)}function f(_,x,w,b){var B=w.type;return B===zi?g(_,x,w.props.children,b,w.key):x!==null&&(x.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Ir&&Xf(B)===x.type)?(b=a(x,w.props),b.ref=Bs(_,x,w),b.return=_,b):(b=wo(w.type,w.key,w.props,null,_.mode,b),b.ref=Bs(_,x,w),b.return=_,b)}function p(_,x,w,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=gc(w,_.mode,b),x.return=_,x):(x=a(x,w.children||[]),x.return=_,x)}function g(_,x,w,b,B){return x===null||x.tag!==7?(x=vi(w,_.mode,b,B),x.return=_,x):(x=a(x,w),x.return=_,x)}function v(_,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=mc(""+x,_.mode,w),x.return=_,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ha:return w=wo(x.type,x.key,x.props,null,_.mode,w),w.ref=Bs(_,null,x),w.return=_,w;case Di:return x=gc(x,_.mode,w),x.return=_,x;case Ir:var b=x._init;return v(_,b(x._payload),w)}if(Ms(x)||bs(x))return x=vi(x,_.mode,w,null),x.return=_,x;to(_,x)}return null}function j(_,x,w,b){var B=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return B!==null?null:u(_,x,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ha:return w.key===B?f(_,x,w,b):null;case Di:return w.key===B?p(_,x,w,b):null;case Ir:return B=w._init,j(_,x,B(w._payload),b)}if(Ms(w)||bs(w))return B!==null?null:g(_,x,w,b,null);to(_,w)}return null}function k(_,x,w,b,B){if(typeof b=="string"&&b!==""||typeof b=="number")return _=_.get(w)||null,u(x,_,""+b,B);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ha:return _=_.get(b.key===null?w:b.key)||null,f(x,_,b,B);case Di:return _=_.get(b.key===null?w:b.key)||null,p(x,_,b,B);case Ir:var T=b._init;return k(_,x,w,T(b._payload),B)}if(Ms(b)||bs(b))return _=_.get(w)||null,g(x,_,b,B,null);to(x,b)}return null}function C(_,x,w,b){for(var B=null,T=null,F=x,R=x=0,O=null;F!==null&&R<w.length;R++){F.index>R?(O=F,F=null):O=F.sibling;var I=j(_,F,w[R],b);if(I===null){F===null&&(F=O);break}e&&F&&I.alternate===null&&t(_,F),x=l(I,x,R),T===null?B=I:T.sibling=I,T=I,F=O}if(R===w.length)return n(_,F),st&&ui(_,R),B;if(F===null){for(;R<w.length;R++)F=v(_,w[R],b),F!==null&&(x=l(F,x,R),T===null?B=F:T.sibling=F,T=F);return st&&ui(_,R),B}for(F=s(_,F);R<w.length;R++)O=k(F,_,R,w[R],b),O!==null&&(e&&O.alternate!==null&&F.delete(O.key===null?R:O.key),x=l(O,x,R),T===null?B=O:T.sibling=O,T=O);return e&&F.forEach(function(D){return t(_,D)}),st&&ui(_,R),B}function S(_,x,w,b){var B=bs(w);if(typeof B!="function")throw Error(pe(150));if(w=B.call(w),w==null)throw Error(pe(151));for(var T=B=null,F=x,R=x=0,O=null,I=w.next();F!==null&&!I.done;R++,I=w.next()){F.index>R?(O=F,F=null):O=F.sibling;var D=j(_,F,I.value,b);if(D===null){F===null&&(F=O);break}e&&F&&D.alternate===null&&t(_,F),x=l(D,x,R),T===null?B=D:T.sibling=D,T=D,F=O}if(I.done)return n(_,F),st&&ui(_,R),B;if(F===null){for(;!I.done;R++,I=w.next())I=v(_,I.value,b),I!==null&&(x=l(I,x,R),T===null?B=I:T.sibling=I,T=I);return st&&ui(_,R),B}for(F=s(_,F);!I.done;R++,I=w.next())I=k(F,_,R,I.value,b),I!==null&&(e&&I.alternate!==null&&F.delete(I.key===null?R:I.key),x=l(I,x,R),T===null?B=I:T.sibling=I,T=I);return e&&F.forEach(function(q){return t(_,q)}),st&&ui(_,R),B}function P(_,x,w,b){if(typeof w=="object"&&w!==null&&w.type===zi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ha:e:{for(var B=w.key,T=x;T!==null;){if(T.key===B){if(B=w.type,B===zi){if(T.tag===7){n(_,T.sibling),x=a(T,w.props.children),x.return=_,_=x;break e}}else if(T.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Ir&&Xf(B)===T.type){n(_,T.sibling),x=a(T,w.props),x.ref=Bs(_,T,w),x.return=_,_=x;break e}n(_,T);break}else t(_,T);T=T.sibling}w.type===zi?(x=vi(w.props.children,_.mode,b,w.key),x.return=_,_=x):(b=wo(w.type,w.key,w.props,null,_.mode,b),b.ref=Bs(_,x,w),b.return=_,_=b)}return c(_);case Di:e:{for(T=w.key;x!==null;){if(x.key===T)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(_,x.sibling),x=a(x,w.children||[]),x.return=_,_=x;break e}else{n(_,x);break}else t(_,x);x=x.sibling}x=gc(w,_.mode,b),x.return=_,_=x}return c(_);case Ir:return T=w._init,P(_,x,T(w._payload),b)}if(Ms(w))return C(_,x,w,b);if(bs(w))return S(_,x,w,b);to(_,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(_,x.sibling),x=a(x,w),x.return=_,_=x):(n(_,x),x=mc(w,_.mode,b),x.return=_,_=x),c(_)):n(_,x)}return P}var os=mm(!0),gm=mm(!1),Mo=Gr(null),Oo=null,Yi=null,Gd=null;function Yd(){Gd=Yi=Oo=null}function Kd(e){var t=Mo.current;it(Mo),e._currentValue=t}function Kc(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function ns(e,t){Oo=e,Gd=Yi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gt=!0),e.firstContext=null)}function xn(e){var t=e._currentValue;if(Gd!==e)if(e={context:e,memoizedValue:t,next:null},Yi===null){if(Oo===null)throw Error(pe(308));Yi=e,Oo.dependencies={lanes:0,firstContext:e}}else Yi=Yi.next=e;return t}var pi=null;function Qd(e){pi===null?pi=[e]:pi.push(e)}function ym(e,t,n,s){var a=t.interleaved;return a===null?(n.next=n,Qd(t)):(n.next=a.next,a.next=n),t.interleaved=n,dr(e,s)}function dr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Lr=!1;function Jd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function or(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Dr(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Ze&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,dr(e,n)}return a=s.interleaved,a===null?(t.next=t,Qd(s)):(t.next=a.next,a.next=t),s.interleaved=t,dr(e,n)}function mo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Ud(e,n)}}function eh(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=c:l=l.next=c,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Do(e,t,n,s){var a=e.updateQueue;Lr=!1;var l=a.firstBaseUpdate,c=a.lastBaseUpdate,u=a.shared.pending;if(u!==null){a.shared.pending=null;var f=u,p=f.next;f.next=null,c===null?l=p:c.next=p,c=f;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==c&&(u===null?g.firstBaseUpdate=p:u.next=p,g.lastBaseUpdate=f))}if(l!==null){var v=a.baseState;c=0,g=p=f=null,u=l;do{var j=u.lane,k=u.eventTime;if((s&j)===j){g!==null&&(g=g.next={eventTime:k,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=e,S=u;switch(j=t,k=n,S.tag){case 1:if(C=S.payload,typeof C=="function"){v=C.call(k,v,j);break e}v=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=S.payload,j=typeof C=="function"?C.call(k,v,j):C,j==null)break e;v=ct({},v,j);break e;case 2:Lr=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,j=a.effects,j===null?a.effects=[u]:j.push(u))}else k={eventTime:k,lane:j,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(p=g=k,f=v):g=g.next=k,c|=j;if(u=u.next,u===null){if(u=a.shared.pending,u===null)break;j=u,u=j.next,j.next=null,a.lastBaseUpdate=j,a.shared.pending=null}}while(!0);if(g===null&&(f=v),a.baseState=f,a.firstBaseUpdate=p,a.lastBaseUpdate=g,t=a.shared.interleaved,t!==null){a=t;do c|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);Ni|=c,e.lanes=c,e.memoizedState=v}}function th(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(pe(191,a));a.call(s)}}}var xa={},Gn=Gr(xa),oa=Gr(xa),la=Gr(xa);function mi(e){if(e===xa)throw Error(pe(174));return e}function Xd(e,t){switch(et(la,t),et(oa,e),et(Gn,xa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Lc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Lc(t,e)}it(Gn),et(Gn,t)}function ls(){it(Gn),it(oa),it(la)}function xm(e){mi(la.current);var t=mi(Gn.current),n=Lc(t,e.type);t!==n&&(et(oa,e),et(Gn,n))}function eu(e){oa.current===e&&(it(Gn),it(oa))}var ot=Gr(0);function zo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cc=[];function tu(){for(var e=0;e<cc.length;e++)cc[e]._workInProgressVersionPrimary=null;cc.length=0}var go=fr.ReactCurrentDispatcher,dc=fr.ReactCurrentBatchConfig,Si=0,lt=null,vt=null,jt=null,$o=!1,Vs=!1,ca=0,Kx=0;function Lt(){throw Error(pe(321))}function nu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Rn(e[n],t[n]))return!1;return!0}function ru(e,t,n,s,a,l){if(Si=l,lt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,go.current=e===null||e.memoizedState===null?e0:t0,e=n(s,a),Vs){l=0;do{if(Vs=!1,ca=0,25<=l)throw Error(pe(301));l+=1,jt=vt=null,t.updateQueue=null,go.current=n0,e=n(s,a)}while(Vs)}if(go.current=Wo,t=vt!==null&&vt.next!==null,Si=0,jt=vt=lt=null,$o=!1,t)throw Error(pe(300));return e}function iu(){var e=ca!==0;return ca=0,e}function Hn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?lt.memoizedState=jt=e:jt=jt.next=e,jt}function _n(){if(vt===null){var e=lt.alternate;e=e!==null?e.memoizedState:null}else e=vt.next;var t=jt===null?lt.memoizedState:jt.next;if(t!==null)jt=t,vt=e;else{if(e===null)throw Error(pe(310));vt=e,e={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},jt===null?lt.memoizedState=jt=e:jt=jt.next=e}return jt}function da(e,t){return typeof t=="function"?t(e):t}function uc(e){var t=_n(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=vt,a=s.baseQueue,l=n.pending;if(l!==null){if(a!==null){var c=a.next;a.next=l.next,l.next=c}s.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,s=s.baseState;var u=c=null,f=null,p=l;do{var g=p.lane;if((Si&g)===g)f!==null&&(f=f.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),s=p.hasEagerState?p.eagerState:e(s,p.action);else{var v={lane:g,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};f===null?(u=f=v,c=s):f=f.next=v,lt.lanes|=g,Ni|=g}p=p.next}while(p!==null&&p!==l);f===null?c=s:f.next=u,Rn(s,t.memoizedState)||(Gt=!0),t.memoizedState=s,t.baseState=c,t.baseQueue=f,n.lastRenderedState=s}if(e=n.interleaved,e!==null){a=e;do l=a.lane,lt.lanes|=l,Ni|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function fc(e){var t=_n(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var s=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var c=a=a.next;do l=e(l,c.action),c=c.next;while(c!==a);Rn(l,t.memoizedState)||(Gt=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,s]}function _m(){}function wm(e,t){var n=lt,s=_n(),a=t(),l=!Rn(s.memoizedState,a);if(l&&(s.memoizedState=a,Gt=!0),s=s.queue,su(Nm.bind(null,n,s,e),[e]),s.getSnapshot!==t||l||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,ua(9,Sm.bind(null,n,s,a,t),void 0,null),St===null)throw Error(pe(349));Si&30||jm(n,t,a)}return a}function jm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Sm(e,t,n,s){t.value=n,t.getSnapshot=s,Cm(t)&&km(e)}function Nm(e,t,n){return n(function(){Cm(t)&&km(e)})}function Cm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Rn(e,n)}catch{return!0}}function km(e){var t=dr(e,1);t!==null&&Bn(t,e,1,-1)}function nh(e){var t=Hn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:da,lastRenderedState:e},t.queue=e,e=e.dispatch=Xx.bind(null,lt,e),[t.memoizedState,e]}function ua(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Pm(){return _n().memoizedState}function yo(e,t,n,s){var a=Hn();lt.flags|=e,a.memoizedState=ua(1|t,n,void 0,s===void 0?null:s)}function rl(e,t,n,s){var a=_n();s=s===void 0?null:s;var l=void 0;if(vt!==null){var c=vt.memoizedState;if(l=c.destroy,s!==null&&nu(s,c.deps)){a.memoizedState=ua(t,n,l,s);return}}lt.flags|=e,a.memoizedState=ua(1|t,n,l,s)}function rh(e,t){return yo(8390656,8,e,t)}function su(e,t){return rl(2048,8,e,t)}function bm(e,t){return rl(4,2,e,t)}function Im(e,t){return rl(4,4,e,t)}function Lm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Em(e,t,n){return n=n!=null?n.concat([e]):null,rl(4,4,Lm.bind(null,t,e),n)}function au(){}function Tm(e,t){var n=_n();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&nu(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Bm(e,t){var n=_n();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&nu(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Rm(e,t,n){return Si&21?(Rn(n,t)||(n=Op(),lt.lanes|=n,Ni|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gt=!0),e.memoizedState=n)}function Qx(e,t){var n=Qe;Qe=n!==0&&4>n?n:4,e(!0);var s=dc.transition;dc.transition={};try{e(!1),t()}finally{Qe=n,dc.transition=s}}function Am(){return _n().memoizedState}function Jx(e,t,n){var s=$r(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Fm(e))Um(t,n);else if(n=ym(e,t,n,s),n!==null){var a=$t();Bn(n,e,s,a),Mm(n,t,s)}}function Xx(e,t,n){var s=$r(e),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Fm(e))Um(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var c=t.lastRenderedState,u=l(c,n);if(a.hasEagerState=!0,a.eagerState=u,Rn(u,c)){var f=t.interleaved;f===null?(a.next=a,Qd(t)):(a.next=f.next,f.next=a),t.interleaved=a;return}}catch{}finally{}n=ym(e,t,a,s),n!==null&&(a=$t(),Bn(n,e,s,a),Mm(n,t,s))}}function Fm(e){var t=e.alternate;return e===lt||t!==null&&t===lt}function Um(e,t){Vs=$o=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Mm(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Ud(e,n)}}var Wo={readContext:xn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},e0={readContext:xn,useCallback:function(e,t){return Hn().memoizedState=[e,t===void 0?null:t],e},useContext:xn,useEffect:rh,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,yo(4194308,4,Lm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return yo(4194308,4,e,t)},useInsertionEffect:function(e,t){return yo(4,2,e,t)},useMemo:function(e,t){var n=Hn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Hn();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Jx.bind(null,lt,e),[s.memoizedState,e]},useRef:function(e){var t=Hn();return e={current:e},t.memoizedState=e},useState:nh,useDebugValue:au,useDeferredValue:function(e){return Hn().memoizedState=e},useTransition:function(){var e=nh(!1),t=e[0];return e=Qx.bind(null,e[1]),Hn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=lt,a=Hn();if(st){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=t(),St===null)throw Error(pe(349));Si&30||jm(s,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,rh(Nm.bind(null,s,l,e),[e]),s.flags|=2048,ua(9,Sm.bind(null,s,l,n,t),void 0,null),n},useId:function(){var e=Hn(),t=St.identifierPrefix;if(st){var n=ar,s=sr;n=(s&~(1<<32-Tn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=ca++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Kx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},t0={readContext:xn,useCallback:Tm,useContext:xn,useEffect:su,useImperativeHandle:Em,useInsertionEffect:bm,useLayoutEffect:Im,useMemo:Bm,useReducer:uc,useRef:Pm,useState:function(){return uc(da)},useDebugValue:au,useDeferredValue:function(e){var t=_n();return Rm(t,vt.memoizedState,e)},useTransition:function(){var e=uc(da)[0],t=_n().memoizedState;return[e,t]},useMutableSource:_m,useSyncExternalStore:wm,useId:Am,unstable_isNewReconciler:!1},n0={readContext:xn,useCallback:Tm,useContext:xn,useEffect:su,useImperativeHandle:Em,useInsertionEffect:bm,useLayoutEffect:Im,useMemo:Bm,useReducer:fc,useRef:Pm,useState:function(){return fc(da)},useDebugValue:au,useDeferredValue:function(e){var t=_n();return vt===null?t.memoizedState=e:Rm(t,vt.memoizedState,e)},useTransition:function(){var e=fc(da)[0],t=_n().memoizedState;return[e,t]},useMutableSource:_m,useSyncExternalStore:wm,useId:Am,unstable_isNewReconciler:!1};function bn(e,t){if(e&&e.defaultProps){t=ct({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Qc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:ct({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var il={isMounted:function(e){return(e=e._reactInternals)?bi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=$t(),a=$r(e),l=or(s,a);l.payload=t,n!=null&&(l.callback=n),t=Dr(e,l,a),t!==null&&(Bn(t,e,a,s),mo(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=$t(),a=$r(e),l=or(s,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=Dr(e,l,a),t!==null&&(Bn(t,e,a,s),mo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$t(),s=$r(e),a=or(n,s);a.tag=2,t!=null&&(a.callback=t),t=Dr(e,a,s),t!==null&&(Bn(t,e,s,n),mo(t,e,s))}};function ih(e,t,n,s,a,l,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,l,c):t.prototype&&t.prototype.isPureReactComponent?!ra(n,s)||!ra(a,l):!0}function Om(e,t,n){var s=!1,a=Vr,l=t.contextType;return typeof l=="object"&&l!==null?l=xn(l):(a=Kt(t)?wi:At.current,s=t.contextTypes,l=(s=s!=null)?ss(e,a):Vr),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=il,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function sh(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&il.enqueueReplaceState(t,t.state,null)}function Jc(e,t,n,s){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Jd(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=xn(l):(l=Kt(t)?wi:At.current,a.context=ss(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Qc(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&il.enqueueReplaceState(a,a.state,null),Do(e,n,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function cs(e,t){try{var n="",s=t;do n+=Lv(s),s=s.return;while(s);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function hc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Xc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var r0=typeof WeakMap=="function"?WeakMap:Map;function Dm(e,t,n){n=or(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Zo||(Zo=!0,cd=s),Xc(e,t)},n}function zm(e,t,n){n=or(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;n.payload=function(){return s(a)},n.callback=function(){Xc(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Xc(e,t),typeof s!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function ah(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new r0;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(n)||(a.add(n),e=y0.bind(null,e,t,n),t.then(e,e))}function oh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function lh(e,t,n,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=or(-1,1),t.tag=2,Dr(n,t,1))),n.lanes|=1),e)}var i0=fr.ReactCurrentOwner,Gt=!1;function Dt(e,t,n,s){t.child=e===null?gm(t,null,n,s):os(t,e.child,n,s)}function ch(e,t,n,s,a){n=n.render;var l=t.ref;return ns(t,a),s=ru(e,t,n,s,l,a),n=iu(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ur(e,t,a)):(st&&n&&Zd(t),t.flags|=1,Dt(e,t,s,a),t.child)}function dh(e,t,n,s,a){if(e===null){var l=n.type;return typeof l=="function"&&!pu(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,$m(e,t,l,s,a)):(e=wo(n.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var c=l.memoizedProps;if(n=n.compare,n=n!==null?n:ra,n(c,s)&&e.ref===t.ref)return ur(e,t,a)}return t.flags|=1,e=Wr(l,s),e.ref=t.ref,e.return=t,t.child=e}function $m(e,t,n,s,a){if(e!==null){var l=e.memoizedProps;if(ra(l,s)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=s=l,(e.lanes&a)!==0)e.flags&131072&&(Gt=!0);else return t.lanes=e.lanes,ur(e,t,a)}return ed(e,t,n,s,a)}function Wm(e,t,n){var s=t.pendingProps,a=s.children,l=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(Qi,nn),nn|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,et(Qi,nn),nn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:n,et(Qi,nn),nn|=s}else l!==null?(s=l.baseLanes|n,t.memoizedState=null):s=n,et(Qi,nn),nn|=s;return Dt(e,t,a,n),t.child}function Hm(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ed(e,t,n,s,a){var l=Kt(n)?wi:At.current;return l=ss(t,l),ns(t,a),n=ru(e,t,n,s,l,a),s=iu(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ur(e,t,a)):(st&&s&&Zd(t),t.flags|=1,Dt(e,t,n,a),t.child)}function uh(e,t,n,s,a){if(Kt(n)){var l=!0;Ao(t)}else l=!1;if(ns(t,a),t.stateNode===null)vo(e,t),Om(t,n,s),Jc(t,n,s,a),s=!0;else if(e===null){var c=t.stateNode,u=t.memoizedProps;c.props=u;var f=c.context,p=n.contextType;typeof p=="object"&&p!==null?p=xn(p):(p=Kt(n)?wi:At.current,p=ss(t,p));var g=n.getDerivedStateFromProps,v=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function";v||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(u!==s||f!==p)&&sh(t,c,s,p),Lr=!1;var j=t.memoizedState;c.state=j,Do(t,s,c,a),f=t.memoizedState,u!==s||j!==f||Yt.current||Lr?(typeof g=="function"&&(Qc(t,n,g,s),f=t.memoizedState),(u=Lr||ih(t,n,u,s,j,f,p))?(v||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=f),c.props=s,c.state=f,c.context=p,s=u):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,vm(e,t),u=t.memoizedProps,p=t.type===t.elementType?u:bn(t.type,u),c.props=p,v=t.pendingProps,j=c.context,f=n.contextType,typeof f=="object"&&f!==null?f=xn(f):(f=Kt(n)?wi:At.current,f=ss(t,f));var k=n.getDerivedStateFromProps;(g=typeof k=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(u!==v||j!==f)&&sh(t,c,s,f),Lr=!1,j=t.memoizedState,c.state=j,Do(t,s,c,a);var C=t.memoizedState;u!==v||j!==C||Yt.current||Lr?(typeof k=="function"&&(Qc(t,n,k,s),C=t.memoizedState),(p=Lr||ih(t,n,p,s,j,C,f)||!1)?(g||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,C,f),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,C,f)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=C),c.props=s,c.state=C,c.context=f,s=p):(typeof c.componentDidUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),s=!1)}return td(e,t,n,s,l,a)}function td(e,t,n,s,a,l){Hm(e,t);var c=(t.flags&128)!==0;if(!s&&!c)return a&&Kf(t,n,!1),ur(e,t,l);s=t.stateNode,i0.current=t;var u=c&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&c?(t.child=os(t,e.child,null,l),t.child=os(t,null,u,l)):Dt(e,t,u,l),t.memoizedState=s.state,a&&Kf(t,n,!0),t.child}function Zm(e){var t=e.stateNode;t.pendingContext?Yf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Yf(e,t.context,!1),Xd(e,t.containerInfo)}function fh(e,t,n,s,a){return as(),qd(a),t.flags|=256,Dt(e,t,n,s),t.child}var nd={dehydrated:null,treeContext:null,retryLane:0};function rd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Vm(e,t,n){var s=t.pendingProps,a=ot.current,l=!1,c=(t.flags&128)!==0,u;if((u=c)||(u=e!==null&&e.memoizedState===null?!1:(a&2)!==0),u?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),et(ot,a&1),e===null)return Yc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=s.children,e=s.fallback,l?(s=t.mode,l=t.child,c={mode:"hidden",children:c},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=c):l=ol(c,s,0,null),e=vi(e,s,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=rd(n),t.memoizedState=nd,e):ou(t,c));if(a=e.memoizedState,a!==null&&(u=a.dehydrated,u!==null))return s0(e,t,c,s,u,a,n);if(l){l=s.fallback,c=t.mode,a=e.child,u=a.sibling;var f={mode:"hidden",children:s.children};return!(c&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=f,t.deletions=null):(s=Wr(a,f),s.subtreeFlags=a.subtreeFlags&14680064),u!==null?l=Wr(u,l):(l=vi(l,c,n,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,c=e.child.memoizedState,c=c===null?rd(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},l.memoizedState=c,l.childLanes=e.childLanes&~n,t.memoizedState=nd,s}return l=e.child,e=l.sibling,s=Wr(l,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function ou(e,t){return t=ol({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function no(e,t,n,s){return s!==null&&qd(s),os(t,e.child,null,n),e=ou(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function s0(e,t,n,s,a,l,c){if(n)return t.flags&256?(t.flags&=-257,s=hc(Error(pe(422))),no(e,t,c,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=s.fallback,a=t.mode,s=ol({mode:"visible",children:s.children},a,0,null),l=vi(l,a,c,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,t.mode&1&&os(t,e.child,null,c),t.child.memoizedState=rd(c),t.memoizedState=nd,l);if(!(t.mode&1))return no(e,t,c,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var u=s.dgst;return s=u,l=Error(pe(419)),s=hc(l,s,void 0),no(e,t,c,s)}if(u=(c&e.childLanes)!==0,Gt||u){if(s=St,s!==null){switch(c&-c){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|c)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,dr(e,a),Bn(s,e,a,-1))}return hu(),s=hc(Error(pe(421))),no(e,t,c,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=v0.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,rn=Or(a.nextSibling),sn=t,st=!0,Ln=null,e!==null&&(mn[gn++]=sr,mn[gn++]=ar,mn[gn++]=ji,sr=e.id,ar=e.overflow,ji=t),t=ou(t,s.children),t.flags|=4096,t)}function hh(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Kc(e.return,t,n)}function pc(e,t,n,s,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=n,l.tailMode=a)}function qm(e,t,n){var s=t.pendingProps,a=s.revealOrder,l=s.tail;if(Dt(e,t,s.children,n),s=ot.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hh(e,n,t);else if(e.tag===19)hh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(et(ot,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&zo(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),pc(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&zo(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}pc(t,!0,n,null,l);break;case"together":pc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ur(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ni|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,n=Wr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Wr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function a0(e,t,n){switch(t.tag){case 3:Zm(t),as();break;case 5:xm(t);break;case 1:Kt(t.type)&&Ao(t);break;case 4:Xd(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;et(Mo,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(et(ot,ot.current&1),t.flags|=128,null):n&t.child.childLanes?Vm(e,t,n):(et(ot,ot.current&1),e=ur(e,t,n),e!==null?e.sibling:null);et(ot,ot.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return qm(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),et(ot,ot.current),s)break;return null;case 22:case 23:return t.lanes=0,Wm(e,t,n)}return ur(e,t,n)}var Gm,id,Ym,Km;Gm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};id=function(){};Ym=function(e,t,n,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,mi(Gn.current);var l=null;switch(n){case"input":a=kc(e,a),s=kc(e,s),l=[];break;case"select":a=ct({},a,{value:void 0}),s=ct({},s,{value:void 0}),l=[];break;case"textarea":a=Ic(e,a),s=Ic(e,s),l=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Bo)}Ec(n,s);var c;n=null;for(p in a)if(!s.hasOwnProperty(p)&&a.hasOwnProperty(p)&&a[p]!=null)if(p==="style"){var u=a[p];for(c in u)u.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Ks.hasOwnProperty(p)?l||(l=[]):(l=l||[]).push(p,null));for(p in s){var f=s[p];if(u=a!=null?a[p]:void 0,s.hasOwnProperty(p)&&f!==u&&(f!=null||u!=null))if(p==="style")if(u){for(c in u)!u.hasOwnProperty(c)||f&&f.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in f)f.hasOwnProperty(c)&&u[c]!==f[c]&&(n||(n={}),n[c]=f[c])}else n||(l||(l=[]),l.push(p,n)),n=f;else p==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,u=u?u.__html:void 0,f!=null&&u!==f&&(l=l||[]).push(p,f)):p==="children"?typeof f!="string"&&typeof f!="number"||(l=l||[]).push(p,""+f):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Ks.hasOwnProperty(p)?(f!=null&&p==="onScroll"&&rt("scroll",e),l||u===f||(l=[])):(l=l||[]).push(p,f))}n&&(l=l||[]).push("style",n);var p=l;(t.updateQueue=p)&&(t.flags|=4)}};Km=function(e,t,n,s){n!==s&&(t.flags|=4)};function Rs(e,t){if(!st)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Et(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function o0(e,t,n){var s=t.pendingProps;switch(Vd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(t),null;case 1:return Kt(t.type)&&Ro(),Et(t),null;case 3:return s=t.stateNode,ls(),it(Yt),it(At),tu(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(eo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(fd(Ln),Ln=null))),id(e,t),Et(t),null;case 5:eu(t);var a=mi(la.current);if(n=t.type,e!==null&&t.stateNode!=null)Ym(e,t,n,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(pe(166));return Et(t),null}if(e=mi(Gn.current),eo(t)){s=t.stateNode,n=t.type;var l=t.memoizedProps;switch(s[Vn]=t,s[aa]=l,e=(t.mode&1)!==0,n){case"dialog":rt("cancel",s),rt("close",s);break;case"iframe":case"object":case"embed":rt("load",s);break;case"video":case"audio":for(a=0;a<Ds.length;a++)rt(Ds[a],s);break;case"source":rt("error",s);break;case"img":case"image":case"link":rt("error",s),rt("load",s);break;case"details":rt("toggle",s);break;case"input":jf(s,l),rt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},rt("invalid",s);break;case"textarea":Nf(s,l),rt("invalid",s)}Ec(n,l),a=null;for(var c in l)if(l.hasOwnProperty(c)){var u=l[c];c==="children"?typeof u=="string"?s.textContent!==u&&(l.suppressHydrationWarning!==!0&&Xa(s.textContent,u,e),a=["children",u]):typeof u=="number"&&s.textContent!==""+u&&(l.suppressHydrationWarning!==!0&&Xa(s.textContent,u,e),a=["children",""+u]):Ks.hasOwnProperty(c)&&u!=null&&c==="onScroll"&&rt("scroll",s)}switch(n){case"input":Za(s),Sf(s,l,!0);break;case"textarea":Za(s),Cf(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=Bo)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{c=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Np(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=c.createElement(n,{is:s.is}):(e=c.createElement(n),n==="select"&&(c=e,s.multiple?c.multiple=!0:s.size&&(c.size=s.size))):e=c.createElementNS(e,n),e[Vn]=t,e[aa]=s,Gm(e,t,!1,!1),t.stateNode=e;e:{switch(c=Tc(n,s),n){case"dialog":rt("cancel",e),rt("close",e),a=s;break;case"iframe":case"object":case"embed":rt("load",e),a=s;break;case"video":case"audio":for(a=0;a<Ds.length;a++)rt(Ds[a],e);a=s;break;case"source":rt("error",e),a=s;break;case"img":case"image":case"link":rt("error",e),rt("load",e),a=s;break;case"details":rt("toggle",e),a=s;break;case"input":jf(e,s),a=kc(e,s),rt("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=ct({},s,{value:void 0}),rt("invalid",e);break;case"textarea":Nf(e,s),a=Ic(e,s),rt("invalid",e);break;default:a=s}Ec(n,a),u=a;for(l in u)if(u.hasOwnProperty(l)){var f=u[l];l==="style"?Pp(e,f):l==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&Cp(e,f)):l==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Qs(e,f):typeof f=="number"&&Qs(e,""+f):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Ks.hasOwnProperty(l)?f!=null&&l==="onScroll"&&rt("scroll",e):f!=null&&Ed(e,l,f,c))}switch(n){case"input":Za(e),Sf(e,s,!1);break;case"textarea":Za(e),Cf(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Zr(s.value));break;case"select":e.multiple=!!s.multiple,l=s.value,l!=null?Ji(e,!!s.multiple,l,!1):s.defaultValue!=null&&Ji(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Bo)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Et(t),null;case 6:if(e&&t.stateNode!=null)Km(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(pe(166));if(n=mi(la.current),mi(Gn.current),eo(t)){if(s=t.stateNode,n=t.memoizedProps,s[Vn]=t,(l=s.nodeValue!==n)&&(e=sn,e!==null))switch(e.tag){case 3:Xa(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xa(s.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Vn]=t,t.stateNode=s}return Et(t),null;case 13:if(it(ot),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(st&&rn!==null&&t.mode&1&&!(t.flags&128))pm(),as(),t.flags|=98560,l=!1;else if(l=eo(t),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(pe(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(pe(317));l[Vn]=t}else as(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Et(t),l=!1}else Ln!==null&&(fd(Ln),Ln=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||ot.current&1?xt===0&&(xt=3):hu())),t.updateQueue!==null&&(t.flags|=4),Et(t),null);case 4:return ls(),id(e,t),e===null&&ia(t.stateNode.containerInfo),Et(t),null;case 10:return Kd(t.type._context),Et(t),null;case 17:return Kt(t.type)&&Ro(),Et(t),null;case 19:if(it(ot),l=t.memoizedState,l===null)return Et(t),null;if(s=(t.flags&128)!==0,c=l.rendering,c===null)if(s)Rs(l,!1);else{if(xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(c=zo(e),c!==null){for(t.flags|=128,Rs(l,!1),s=c.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)l=n,e=s,l.flags&=14680066,c=l.alternate,c===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=c.childLanes,l.lanes=c.lanes,l.child=c.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=c.memoizedProps,l.memoizedState=c.memoizedState,l.updateQueue=c.updateQueue,l.type=c.type,e=c.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return et(ot,ot.current&1|2),t.child}e=e.sibling}l.tail!==null&&ht()>ds&&(t.flags|=128,s=!0,Rs(l,!1),t.lanes=4194304)}else{if(!s)if(e=zo(c),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Rs(l,!0),l.tail===null&&l.tailMode==="hidden"&&!c.alternate&&!st)return Et(t),null}else 2*ht()-l.renderingStartTime>ds&&n!==1073741824&&(t.flags|=128,s=!0,Rs(l,!1),t.lanes=4194304);l.isBackwards?(c.sibling=t.child,t.child=c):(n=l.last,n!==null?n.sibling=c:t.child=c,l.last=c)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ht(),t.sibling=null,n=ot.current,et(ot,s?n&1|2:n&1),t):(Et(t),null);case 22:case 23:return fu(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?nn&1073741824&&(Et(t),t.subtreeFlags&6&&(t.flags|=8192)):Et(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function l0(e,t){switch(Vd(t),t.tag){case 1:return Kt(t.type)&&Ro(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ls(),it(Yt),it(At),tu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return eu(t),null;case 13:if(it(ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));as()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(ot),null;case 4:return ls(),null;case 10:return Kd(t.type._context),null;case 22:case 23:return fu(),null;case 24:return null;default:return null}}var ro=!1,Tt=!1,c0=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Ki(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){dt(e,t,s)}else n.current=null}function sd(e,t,n){try{n()}catch(s){dt(e,t,s)}}var ph=!1;function d0(e,t){if($c=Lo,e=tm(),Hd(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var c=0,u=-1,f=-1,p=0,g=0,v=e,j=null;t:for(;;){for(var k;v!==n||a!==0&&v.nodeType!==3||(u=c+a),v!==l||s!==0&&v.nodeType!==3||(f=c+s),v.nodeType===3&&(c+=v.nodeValue.length),(k=v.firstChild)!==null;)j=v,v=k;for(;;){if(v===e)break t;if(j===n&&++p===a&&(u=c),j===l&&++g===s&&(f=c),(k=v.nextSibling)!==null)break;v=j,j=v.parentNode}v=k}n=u===-1||f===-1?null:{start:u,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wc={focusedElem:e,selectionRange:n},Lo=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var S=C.memoizedProps,P=C.memoizedState,_=t.stateNode,x=_.getSnapshotBeforeUpdate(t.elementType===t.type?S:bn(t.type,S),P);_.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(b){dt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return C=ph,ph=!1,C}function qs(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&sd(t,n,l)}a=a.next}while(a!==s)}}function sl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function ad(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Qm(e){var t=e.alternate;t!==null&&(e.alternate=null,Qm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vn],delete t[aa],delete t[Vc],delete t[Vx],delete t[qx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Jm(e){return e.tag===5||e.tag===3||e.tag===4}function mh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Jm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function od(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Bo));else if(s!==4&&(e=e.child,e!==null))for(od(e,t,n),e=e.sibling;e!==null;)od(e,t,n),e=e.sibling}function ld(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(ld(e,t,n),e=e.sibling;e!==null;)ld(e,t,n),e=e.sibling}var kt=null,In=!1;function Pr(e,t,n){for(n=n.child;n!==null;)Xm(e,t,n),n=n.sibling}function Xm(e,t,n){if(qn&&typeof qn.onCommitFiberUnmount=="function")try{qn.onCommitFiberUnmount(Qo,n)}catch{}switch(n.tag){case 5:Tt||Ki(n,t);case 6:var s=kt,a=In;kt=null,Pr(e,t,n),kt=s,In=a,kt!==null&&(In?(e=kt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):kt.removeChild(n.stateNode));break;case 18:kt!==null&&(In?(e=kt,n=n.stateNode,e.nodeType===8?oc(e.parentNode,n):e.nodeType===1&&oc(e,n),ta(e)):oc(kt,n.stateNode));break;case 4:s=kt,a=In,kt=n.stateNode.containerInfo,In=!0,Pr(e,t,n),kt=s,In=a;break;case 0:case 11:case 14:case 15:if(!Tt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var l=a,c=l.destroy;l=l.tag,c!==void 0&&(l&2||l&4)&&sd(n,t,c),a=a.next}while(a!==s)}Pr(e,t,n);break;case 1:if(!Tt&&(Ki(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(u){dt(n,t,u)}Pr(e,t,n);break;case 21:Pr(e,t,n);break;case 22:n.mode&1?(Tt=(s=Tt)||n.memoizedState!==null,Pr(e,t,n),Tt=s):Pr(e,t,n);break;default:Pr(e,t,n)}}function gh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new c0),t.forEach(function(s){var a=x0.bind(null,e,s);n.has(s)||(n.add(s),s.then(a,a))})}}function Pn(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var l=e,c=t,u=c;e:for(;u!==null;){switch(u.tag){case 5:kt=u.stateNode,In=!1;break e;case 3:kt=u.stateNode.containerInfo,In=!0;break e;case 4:kt=u.stateNode.containerInfo,In=!0;break e}u=u.return}if(kt===null)throw Error(pe(160));Xm(l,c,a),kt=null,In=!1;var f=a.alternate;f!==null&&(f.return=null),a.return=null}catch(p){dt(a,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)eg(t,e),t=t.sibling}function eg(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pn(t,e),$n(e),s&4){try{qs(3,e,e.return),sl(3,e)}catch(S){dt(e,e.return,S)}try{qs(5,e,e.return)}catch(S){dt(e,e.return,S)}}break;case 1:Pn(t,e),$n(e),s&512&&n!==null&&Ki(n,n.return);break;case 5:if(Pn(t,e),$n(e),s&512&&n!==null&&Ki(n,n.return),e.flags&32){var a=e.stateNode;try{Qs(a,"")}catch(S){dt(e,e.return,S)}}if(s&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,c=n!==null?n.memoizedProps:l,u=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{u==="input"&&l.type==="radio"&&l.name!=null&&jp(a,l),Tc(u,c);var p=Tc(u,l);for(c=0;c<f.length;c+=2){var g=f[c],v=f[c+1];g==="style"?Pp(a,v):g==="dangerouslySetInnerHTML"?Cp(a,v):g==="children"?Qs(a,v):Ed(a,g,v,p)}switch(u){case"input":Pc(a,l);break;case"textarea":Sp(a,l);break;case"select":var j=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var k=l.value;k!=null?Ji(a,!!l.multiple,k,!1):j!==!!l.multiple&&(l.defaultValue!=null?Ji(a,!!l.multiple,l.defaultValue,!0):Ji(a,!!l.multiple,l.multiple?[]:"",!1))}a[aa]=l}catch(S){dt(e,e.return,S)}}break;case 6:if(Pn(t,e),$n(e),s&4){if(e.stateNode===null)throw Error(pe(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(S){dt(e,e.return,S)}}break;case 3:if(Pn(t,e),$n(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{ta(t.containerInfo)}catch(S){dt(e,e.return,S)}break;case 4:Pn(t,e),$n(e);break;case 13:Pn(t,e),$n(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(du=ht())),s&4&&gh(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(Tt=(p=Tt)||g,Pn(t,e),Tt=p):Pn(t,e),$n(e),s&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!g&&e.mode&1)for(Ce=e,g=e.child;g!==null;){for(v=Ce=g;Ce!==null;){switch(j=Ce,k=j.child,j.tag){case 0:case 11:case 14:case 15:qs(4,j,j.return);break;case 1:Ki(j,j.return);var C=j.stateNode;if(typeof C.componentWillUnmount=="function"){s=j,n=j.return;try{t=s,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(S){dt(s,n,S)}}break;case 5:Ki(j,j.return);break;case 22:if(j.memoizedState!==null){vh(v);continue}}k!==null?(k.return=j,Ce=k):vh(v)}g=g.sibling}e:for(g=null,v=e;;){if(v.tag===5){if(g===null){g=v;try{a=v.stateNode,p?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(u=v.stateNode,f=v.memoizedProps.style,c=f!=null&&f.hasOwnProperty("display")?f.display:null,u.style.display=kp("display",c))}catch(S){dt(e,e.return,S)}}}else if(v.tag===6){if(g===null)try{v.stateNode.nodeValue=p?"":v.memoizedProps}catch(S){dt(e,e.return,S)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;g===v&&(g=null),v=v.return}g===v&&(g=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Pn(t,e),$n(e),s&4&&gh(e);break;case 21:break;default:Pn(t,e),$n(e)}}function $n(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Jm(n)){var s=n;break e}n=n.return}throw Error(pe(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Qs(a,""),s.flags&=-33);var l=mh(e);ld(e,l,a);break;case 3:case 4:var c=s.stateNode.containerInfo,u=mh(e);od(e,u,c);break;default:throw Error(pe(161))}}catch(f){dt(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function u0(e,t,n){Ce=e,tg(e)}function tg(e,t,n){for(var s=(e.mode&1)!==0;Ce!==null;){var a=Ce,l=a.child;if(a.tag===22&&s){var c=a.memoizedState!==null||ro;if(!c){var u=a.alternate,f=u!==null&&u.memoizedState!==null||Tt;u=ro;var p=Tt;if(ro=c,(Tt=f)&&!p)for(Ce=a;Ce!==null;)c=Ce,f=c.child,c.tag===22&&c.memoizedState!==null?xh(a):f!==null?(f.return=c,Ce=f):xh(a);for(;l!==null;)Ce=l,tg(l),l=l.sibling;Ce=a,ro=u,Tt=p}yh(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,Ce=l):yh(e)}}function yh(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Tt||sl(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Tt)if(n===null)s.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:bn(t.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&th(t,l,s);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}th(t,c,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var f=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var g=p.memoizedState;if(g!==null){var v=g.dehydrated;v!==null&&ta(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Tt||t.flags&512&&ad(t)}catch(j){dt(t,t.return,j)}}if(t===e){Ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function vh(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function xh(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sl(4,t)}catch(f){dt(t,n,f)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(f){dt(t,a,f)}}var l=t.return;try{ad(t)}catch(f){dt(t,l,f)}break;case 5:var c=t.return;try{ad(t)}catch(f){dt(t,c,f)}}}catch(f){dt(t,t.return,f)}if(t===e){Ce=null;break}var u=t.sibling;if(u!==null){u.return=t.return,Ce=u;break}Ce=t.return}}var f0=Math.ceil,Ho=fr.ReactCurrentDispatcher,lu=fr.ReactCurrentOwner,vn=fr.ReactCurrentBatchConfig,Ze=0,St=null,yt=null,Pt=0,nn=0,Qi=Gr(0),xt=0,fa=null,Ni=0,al=0,cu=0,Gs=null,qt=null,du=0,ds=1/0,rr=null,Zo=!1,cd=null,zr=null,io=!1,Rr=null,Vo=0,Ys=0,dd=null,xo=-1,_o=0;function $t(){return Ze&6?ht():xo!==-1?xo:xo=ht()}function $r(e){return e.mode&1?Ze&2&&Pt!==0?Pt&-Pt:Yx.transition!==null?(_o===0&&(_o=Op()),_o):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:Vp(e.type)),e):1}function Bn(e,t,n,s){if(50<Ys)throw Ys=0,dd=null,Error(pe(185));ga(e,n,s),(!(Ze&2)||e!==St)&&(e===St&&(!(Ze&2)&&(al|=n),xt===4&&Tr(e,Pt)),Qt(e,s),n===1&&Ze===0&&!(t.mode&1)&&(ds=ht()+500,nl&&Yr()))}function Qt(e,t){var n=e.callbackNode;Yv(e,t);var s=Io(e,e===St?Pt:0);if(s===0)n!==null&&bf(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&bf(n),t===1)e.tag===0?Gx(_h.bind(null,e)):um(_h.bind(null,e)),Hx(function(){!(Ze&6)&&Yr()}),n=null;else{switch(Dp(s)){case 1:n=Fd;break;case 4:n=Up;break;case 16:n=bo;break;case 536870912:n=Mp;break;default:n=bo}n=cg(n,ng.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ng(e,t){if(xo=-1,_o=0,Ze&6)throw Error(pe(327));var n=e.callbackNode;if(rs()&&e.callbackNode!==n)return null;var s=Io(e,e===St?Pt:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=qo(e,s);else{t=s;var a=Ze;Ze|=2;var l=ig();(St!==e||Pt!==t)&&(rr=null,ds=ht()+500,yi(e,t));do try{m0();break}catch(u){rg(e,u)}while(!0);Yd(),Ho.current=l,Ze=a,yt!==null?t=0:(St=null,Pt=0,t=xt)}if(t!==0){if(t===2&&(a=Uc(e),a!==0&&(s=a,t=ud(e,a))),t===1)throw n=fa,yi(e,0),Tr(e,s),Qt(e,ht()),n;if(t===6)Tr(e,s);else{if(a=e.current.alternate,!(s&30)&&!h0(a)&&(t=qo(e,s),t===2&&(l=Uc(e),l!==0&&(s=l,t=ud(e,l))),t===1))throw n=fa,yi(e,0),Tr(e,s),Qt(e,ht()),n;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(pe(345));case 2:fi(e,qt,rr);break;case 3:if(Tr(e,s),(s&130023424)===s&&(t=du+500-ht(),10<t)){if(Io(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){$t(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Zc(fi.bind(null,e,qt,rr),t);break}fi(e,qt,rr);break;case 4:if(Tr(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var c=31-Tn(s);l=1<<c,c=t[c],c>a&&(a=c),s&=~l}if(s=a,s=ht()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*f0(s/1960))-s,10<s){e.timeoutHandle=Zc(fi.bind(null,e,qt,rr),s);break}fi(e,qt,rr);break;case 5:fi(e,qt,rr);break;default:throw Error(pe(329))}}}return Qt(e,ht()),e.callbackNode===n?ng.bind(null,e):null}function ud(e,t){var n=Gs;return e.current.memoizedState.isDehydrated&&(yi(e,t).flags|=256),e=qo(e,t),e!==2&&(t=qt,qt=n,t!==null&&fd(t)),e}function fd(e){qt===null?qt=e:qt.push.apply(qt,e)}function h0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],l=a.getSnapshot;a=a.value;try{if(!Rn(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tr(e,t){for(t&=~cu,t&=~al,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Tn(t),s=1<<n;e[n]=-1,t&=~s}}function _h(e){if(Ze&6)throw Error(pe(327));rs();var t=Io(e,0);if(!(t&1))return Qt(e,ht()),null;var n=qo(e,t);if(e.tag!==0&&n===2){var s=Uc(e);s!==0&&(t=s,n=ud(e,s))}if(n===1)throw n=fa,yi(e,0),Tr(e,t),Qt(e,ht()),n;if(n===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,fi(e,qt,rr),Qt(e,ht()),null}function uu(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(ds=ht()+500,nl&&Yr())}}function Ci(e){Rr!==null&&Rr.tag===0&&!(Ze&6)&&rs();var t=Ze;Ze|=1;var n=vn.transition,s=Qe;try{if(vn.transition=null,Qe=1,e)return e()}finally{Qe=s,vn.transition=n,Ze=t,!(Ze&6)&&Yr()}}function fu(){nn=Qi.current,it(Qi)}function yi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Wx(n)),yt!==null)for(n=yt.return;n!==null;){var s=n;switch(Vd(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ro();break;case 3:ls(),it(Yt),it(At),tu();break;case 5:eu(s);break;case 4:ls();break;case 13:it(ot);break;case 19:it(ot);break;case 10:Kd(s.type._context);break;case 22:case 23:fu()}n=n.return}if(St=e,yt=e=Wr(e.current,null),Pt=nn=t,xt=0,fa=null,cu=al=Ni=0,qt=Gs=null,pi!==null){for(t=0;t<pi.length;t++)if(n=pi[t],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,l=n.pending;if(l!==null){var c=l.next;l.next=a,s.next=c}n.pending=s}pi=null}return e}function rg(e,t){do{var n=yt;try{if(Yd(),go.current=Wo,$o){for(var s=lt.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}$o=!1}if(Si=0,jt=vt=lt=null,Vs=!1,ca=0,lu.current=null,n===null||n.return===null){xt=1,fa=t,yt=null;break}e:{var l=e,c=n.return,u=n,f=t;if(t=Pt,u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var p=f,g=u,v=g.tag;if(!(g.mode&1)&&(v===0||v===11||v===15)){var j=g.alternate;j?(g.updateQueue=j.updateQueue,g.memoizedState=j.memoizedState,g.lanes=j.lanes):(g.updateQueue=null,g.memoizedState=null)}var k=oh(c);if(k!==null){k.flags&=-257,lh(k,c,u,l,t),k.mode&1&&ah(l,p,t),t=k,f=p;var C=t.updateQueue;if(C===null){var S=new Set;S.add(f),t.updateQueue=S}else C.add(f);break e}else{if(!(t&1)){ah(l,p,t),hu();break e}f=Error(pe(426))}}else if(st&&u.mode&1){var P=oh(c);if(P!==null){!(P.flags&65536)&&(P.flags|=256),lh(P,c,u,l,t),qd(cs(f,u));break e}}l=f=cs(f,u),xt!==4&&(xt=2),Gs===null?Gs=[l]:Gs.push(l),l=c;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var _=Dm(l,f,t);eh(l,_);break e;case 1:u=f;var x=l.type,w=l.stateNode;if(!(l.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(zr===null||!zr.has(w)))){l.flags|=65536,t&=-t,l.lanes|=t;var b=zm(l,u,t);eh(l,b);break e}}l=l.return}while(l!==null)}ag(n)}catch(B){t=B,yt===n&&n!==null&&(yt=n=n.return);continue}break}while(!0)}function ig(){var e=Ho.current;return Ho.current=Wo,e===null?Wo:e}function hu(){(xt===0||xt===3||xt===2)&&(xt=4),St===null||!(Ni&268435455)&&!(al&268435455)||Tr(St,Pt)}function qo(e,t){var n=Ze;Ze|=2;var s=ig();(St!==e||Pt!==t)&&(rr=null,yi(e,t));do try{p0();break}catch(a){rg(e,a)}while(!0);if(Yd(),Ze=n,Ho.current=s,yt!==null)throw Error(pe(261));return St=null,Pt=0,xt}function p0(){for(;yt!==null;)sg(yt)}function m0(){for(;yt!==null&&!Dv();)sg(yt)}function sg(e){var t=lg(e.alternate,e,nn);e.memoizedProps=e.pendingProps,t===null?ag(e):yt=t,lu.current=null}function ag(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=l0(n,t),n!==null){n.flags&=32767,yt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{xt=6,yt=null;return}}else if(n=o0(n,t,nn),n!==null){yt=n;return}if(t=t.sibling,t!==null){yt=t;return}yt=t=e}while(t!==null);xt===0&&(xt=5)}function fi(e,t,n){var s=Qe,a=vn.transition;try{vn.transition=null,Qe=1,g0(e,t,n,s)}finally{vn.transition=a,Qe=s}return null}function g0(e,t,n,s){do rs();while(Rr!==null);if(Ze&6)throw Error(pe(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(Kv(e,l),e===St&&(yt=St=null,Pt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||io||(io=!0,cg(bo,function(){return rs(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=vn.transition,vn.transition=null;var c=Qe;Qe=1;var u=Ze;Ze|=4,lu.current=null,d0(e,n),eg(n,e),Fx(Wc),Lo=!!$c,Wc=$c=null,e.current=n,u0(n),zv(),Ze=u,Qe=c,vn.transition=l}else e.current=n;if(io&&(io=!1,Rr=e,Vo=a),l=e.pendingLanes,l===0&&(zr=null),Hv(n.stateNode),Qt(e,ht()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(Zo)throw Zo=!1,e=cd,cd=null,e;return Vo&1&&e.tag!==0&&rs(),l=e.pendingLanes,l&1?e===dd?Ys++:(Ys=0,dd=e):Ys=0,Yr(),null}function rs(){if(Rr!==null){var e=Dp(Vo),t=vn.transition,n=Qe;try{if(vn.transition=null,Qe=16>e?16:e,Rr===null)var s=!1;else{if(e=Rr,Rr=null,Vo=0,Ze&6)throw Error(pe(331));var a=Ze;for(Ze|=4,Ce=e.current;Ce!==null;){var l=Ce,c=l.child;if(Ce.flags&16){var u=l.deletions;if(u!==null){for(var f=0;f<u.length;f++){var p=u[f];for(Ce=p;Ce!==null;){var g=Ce;switch(g.tag){case 0:case 11:case 15:qs(8,g,l)}var v=g.child;if(v!==null)v.return=g,Ce=v;else for(;Ce!==null;){g=Ce;var j=g.sibling,k=g.return;if(Qm(g),g===p){Ce=null;break}if(j!==null){j.return=k,Ce=j;break}Ce=k}}}var C=l.alternate;if(C!==null){var S=C.child;if(S!==null){C.child=null;do{var P=S.sibling;S.sibling=null,S=P}while(S!==null)}}Ce=l}}if(l.subtreeFlags&2064&&c!==null)c.return=l,Ce=c;else e:for(;Ce!==null;){if(l=Ce,l.flags&2048)switch(l.tag){case 0:case 11:case 15:qs(9,l,l.return)}var _=l.sibling;if(_!==null){_.return=l.return,Ce=_;break e}Ce=l.return}}var x=e.current;for(Ce=x;Ce!==null;){c=Ce;var w=c.child;if(c.subtreeFlags&2064&&w!==null)w.return=c,Ce=w;else e:for(c=x;Ce!==null;){if(u=Ce,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:sl(9,u)}}catch(B){dt(u,u.return,B)}if(u===c){Ce=null;break e}var b=u.sibling;if(b!==null){b.return=u.return,Ce=b;break e}Ce=u.return}}if(Ze=a,Yr(),qn&&typeof qn.onPostCommitFiberRoot=="function")try{qn.onPostCommitFiberRoot(Qo,e)}catch{}s=!0}return s}finally{Qe=n,vn.transition=t}}return!1}function wh(e,t,n){t=cs(n,t),t=Dm(e,t,1),e=Dr(e,t,1),t=$t(),e!==null&&(ga(e,1,t),Qt(e,t))}function dt(e,t,n){if(e.tag===3)wh(e,e,n);else for(;t!==null;){if(t.tag===3){wh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(zr===null||!zr.has(s))){e=cs(n,e),e=zm(t,e,1),t=Dr(t,e,1),e=$t(),t!==null&&(ga(t,1,e),Qt(t,e));break}}t=t.return}}function y0(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=$t(),e.pingedLanes|=e.suspendedLanes&n,St===e&&(Pt&n)===n&&(xt===4||xt===3&&(Pt&130023424)===Pt&&500>ht()-du?yi(e,0):cu|=n),Qt(e,t)}function og(e,t){t===0&&(e.mode&1?(t=Ga,Ga<<=1,!(Ga&130023424)&&(Ga=4194304)):t=1);var n=$t();e=dr(e,t),e!==null&&(ga(e,t,n),Qt(e,n))}function v0(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),og(e,n)}function x0(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(pe(314))}s!==null&&s.delete(t),og(e,n)}var lg;lg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yt.current)Gt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Gt=!1,a0(e,t,n);Gt=!!(e.flags&131072)}else Gt=!1,st&&t.flags&1048576&&fm(t,Uo,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;vo(e,t),e=t.pendingProps;var a=ss(t,At.current);ns(t,n),a=ru(null,t,s,e,a,n);var l=iu();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kt(s)?(l=!0,Ao(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Jd(t),a.updater=il,t.stateNode=a,a._reactInternals=t,Jc(t,s,e,n),t=td(null,t,s,!0,l,n)):(t.tag=0,st&&l&&Zd(t),Dt(null,t,a,n),t=t.child),t;case 16:s=t.elementType;e:{switch(vo(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=w0(s),e=bn(s,e),a){case 0:t=ed(null,t,s,e,n);break e;case 1:t=uh(null,t,s,e,n);break e;case 11:t=ch(null,t,s,e,n);break e;case 14:t=dh(null,t,s,bn(s.type,e),n);break e}throw Error(pe(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:bn(s,a),ed(e,t,s,a,n);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:bn(s,a),uh(e,t,s,a,n);case 3:e:{if(Zm(t),e===null)throw Error(pe(387));s=t.pendingProps,l=t.memoizedState,a=l.element,vm(e,t),Do(t,s,null,n);var c=t.memoizedState;if(s=c.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=cs(Error(pe(423)),t),t=fh(e,t,s,n,a);break e}else if(s!==a){a=cs(Error(pe(424)),t),t=fh(e,t,s,n,a);break e}else for(rn=Or(t.stateNode.containerInfo.firstChild),sn=t,st=!0,Ln=null,n=gm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(as(),s===a){t=ur(e,t,n);break e}Dt(e,t,s,n)}t=t.child}return t;case 5:return xm(t),e===null&&Yc(t),s=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,c=a.children,Hc(s,a)?c=null:l!==null&&Hc(s,l)&&(t.flags|=32),Hm(e,t),Dt(e,t,c,n),t.child;case 6:return e===null&&Yc(t),null;case 13:return Vm(e,t,n);case 4:return Xd(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=os(t,null,s,n):Dt(e,t,s,n),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:bn(s,a),ch(e,t,s,a,n);case 7:return Dt(e,t,t.pendingProps,n),t.child;case 8:return Dt(e,t,t.pendingProps.children,n),t.child;case 12:return Dt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,l=t.memoizedProps,c=a.value,et(Mo,s._currentValue),s._currentValue=c,l!==null)if(Rn(l.value,c)){if(l.children===a.children&&!Yt.current){t=ur(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var u=l.dependencies;if(u!==null){c=l.child;for(var f=u.firstContext;f!==null;){if(f.context===s){if(l.tag===1){f=or(-1,n&-n),f.tag=2;var p=l.updateQueue;if(p!==null){p=p.shared;var g=p.pending;g===null?f.next=f:(f.next=g.next,g.next=f),p.pending=f}}l.lanes|=n,f=l.alternate,f!==null&&(f.lanes|=n),Kc(l.return,n,t),u.lanes|=n;break}f=f.next}}else if(l.tag===10)c=l.type===t.type?null:l.child;else if(l.tag===18){if(c=l.return,c===null)throw Error(pe(341));c.lanes|=n,u=c.alternate,u!==null&&(u.lanes|=n),Kc(c,n,t),c=l.sibling}else c=l.child;if(c!==null)c.return=l;else for(c=l;c!==null;){if(c===t){c=null;break}if(l=c.sibling,l!==null){l.return=c.return,c=l;break}c=c.return}l=c}Dt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,ns(t,n),a=xn(a),s=s(a),t.flags|=1,Dt(e,t,s,n),t.child;case 14:return s=t.type,a=bn(s,t.pendingProps),a=bn(s.type,a),dh(e,t,s,a,n);case 15:return $m(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:bn(s,a),vo(e,t),t.tag=1,Kt(s)?(e=!0,Ao(t)):e=!1,ns(t,n),Om(t,s,a),Jc(t,s,a,n),td(null,t,s,!0,e,n);case 19:return qm(e,t,n);case 22:return Wm(e,t,n)}throw Error(pe(156,t.tag))};function cg(e,t){return Fp(e,t)}function _0(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yn(e,t,n,s){return new _0(e,t,n,s)}function pu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function w0(e){if(typeof e=="function")return pu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Bd)return 11;if(e===Rd)return 14}return 2}function Wr(e,t){var n=e.alternate;return n===null?(n=yn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function wo(e,t,n,s,a,l){var c=2;if(s=e,typeof e=="function")pu(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case zi:return vi(n.children,a,l,t);case Td:c=8,a|=8;break;case jc:return e=yn(12,n,t,a|2),e.elementType=jc,e.lanes=l,e;case Sc:return e=yn(13,n,t,a),e.elementType=Sc,e.lanes=l,e;case Nc:return e=yn(19,n,t,a),e.elementType=Nc,e.lanes=l,e;case xp:return ol(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yp:c=10;break e;case vp:c=9;break e;case Bd:c=11;break e;case Rd:c=14;break e;case Ir:c=16,s=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=yn(c,n,t,a),t.elementType=e,t.type=s,t.lanes=l,t}function vi(e,t,n,s){return e=yn(7,e,s,t),e.lanes=n,e}function ol(e,t,n,s){return e=yn(22,e,s,t),e.elementType=xp,e.lanes=n,e.stateNode={isHidden:!1},e}function mc(e,t,n){return e=yn(6,e,null,t),e.lanes=n,e}function gc(e,t,n){return t=yn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function j0(e,t,n,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kl(0),this.expirationTimes=Kl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kl(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function mu(e,t,n,s,a,l,c,u,f){return e=new j0(e,t,n,u,f),t===1?(t=1,l===!0&&(t|=8)):t=0,l=yn(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jd(l),e}function S0(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Di,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function dg(e){if(!e)return Vr;e=e._reactInternals;e:{if(bi(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var n=e.type;if(Kt(n))return dm(e,n,t)}return t}function ug(e,t,n,s,a,l,c,u,f){return e=mu(n,s,!0,e,a,l,c,u,f),e.context=dg(null),n=e.current,s=$t(),a=$r(n),l=or(s,a),l.callback=t??null,Dr(n,l,a),e.current.lanes=a,ga(e,a,s),Qt(e,s),e}function ll(e,t,n,s){var a=t.current,l=$t(),c=$r(a);return n=dg(n),t.context===null?t.context=n:t.pendingContext=n,t=or(l,c),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Dr(a,t,c),e!==null&&(Bn(e,a,c,l),mo(e,a,c)),c}function Go(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function jh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function gu(e,t){jh(e,t),(e=e.alternate)&&jh(e,t)}function N0(){return null}var fg=typeof reportError=="function"?reportError:function(e){console.error(e)};function yu(e){this._internalRoot=e}cl.prototype.render=yu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));ll(e,t,null,null)};cl.prototype.unmount=yu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ci(function(){ll(null,e,null,null)}),t[cr]=null}};function cl(e){this._internalRoot=e}cl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Er.length&&t!==0&&t<Er[n].priority;n++);Er.splice(n,0,e),n===0&&Zp(e)}};function vu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function dl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Sh(){}function C0(e,t,n,s,a){if(a){if(typeof s=="function"){var l=s;s=function(){var p=Go(c);l.call(p)}}var c=ug(t,s,e,0,null,!1,!1,"",Sh);return e._reactRootContainer=c,e[cr]=c.current,ia(e.nodeType===8?e.parentNode:e),Ci(),c}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var u=s;s=function(){var p=Go(f);u.call(p)}}var f=mu(e,0,!1,null,null,!1,!1,"",Sh);return e._reactRootContainer=f,e[cr]=f.current,ia(e.nodeType===8?e.parentNode:e),Ci(function(){ll(t,f,n,s)}),f}function ul(e,t,n,s,a){var l=n._reactRootContainer;if(l){var c=l;if(typeof a=="function"){var u=a;a=function(){var f=Go(c);u.call(f)}}ll(t,c,e,a)}else c=C0(n,t,e,a,s);return Go(c)}zp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Os(t.pendingLanes);n!==0&&(Ud(t,n|1),Qt(t,ht()),!(Ze&6)&&(ds=ht()+500,Yr()))}break;case 13:Ci(function(){var s=dr(e,1);if(s!==null){var a=$t();Bn(s,e,1,a)}}),gu(e,1)}};Md=function(e){if(e.tag===13){var t=dr(e,134217728);if(t!==null){var n=$t();Bn(t,e,134217728,n)}gu(e,134217728)}};$p=function(e){if(e.tag===13){var t=$r(e),n=dr(e,t);if(n!==null){var s=$t();Bn(n,e,t,s)}gu(e,t)}};Wp=function(){return Qe};Hp=function(e,t){var n=Qe;try{return Qe=e,t()}finally{Qe=n}};Rc=function(e,t,n){switch(t){case"input":if(Pc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var a=tl(s);if(!a)throw Error(pe(90));wp(s),Pc(s,a)}}}break;case"textarea":Sp(e,n);break;case"select":t=n.value,t!=null&&Ji(e,!!n.multiple,t,!1)}};Lp=uu;Ep=Ci;var k0={usingClientEntryPoint:!1,Events:[va,Zi,tl,bp,Ip,uu]},As={findFiberByHostInstance:hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},P0={bundleType:As.bundleType,version:As.version,rendererPackageName:As.rendererPackageName,rendererConfig:As.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Rp(e),e===null?null:e.stateNode},findFiberByHostInstance:As.findFiberByHostInstance||N0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var so=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!so.isDisabled&&so.supportsFiber)try{Qo=so.inject(P0),qn=so}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k0;on.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vu(t))throw Error(pe(200));return S0(e,t,null,n)};on.createRoot=function(e,t){if(!vu(e))throw Error(pe(299));var n=!1,s="",a=fg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=mu(e,1,!1,null,null,n,!1,s,a),e[cr]=t.current,ia(e.nodeType===8?e.parentNode:e),new yu(t)};on.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=Rp(t),e=e===null?null:e.stateNode,e};on.flushSync=function(e){return Ci(e)};on.hydrate=function(e,t,n){if(!dl(t))throw Error(pe(200));return ul(null,e,t,!0,n)};on.hydrateRoot=function(e,t,n){if(!vu(e))throw Error(pe(405));var s=n!=null&&n.hydratedSources||null,a=!1,l="",c=fg;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=ug(t,null,e,1,n??null,a,!1,l,c),e[cr]=t.current,ia(e),s)for(e=0;e<s.length;e++)n=s[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new cl(t)};on.render=function(e,t,n){if(!dl(t))throw Error(pe(200));return ul(null,e,t,!1,n)};on.unmountComponentAtNode=function(e){if(!dl(e))throw Error(pe(40));return e._reactRootContainer?(Ci(function(){ul(null,null,e,!1,function(){e._reactRootContainer=null,e[cr]=null})}),!0):!1};on.unstable_batchedUpdates=uu;on.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!dl(n))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return ul(e,t,n,!1,s)};on.version="18.3.1-next-f1338f8080-20240426";function hg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hg)}catch(e){console.error(e)}}hg(),hp.exports=on;var pg=hp.exports,mg,Nh=pg;mg=Nh.createRoot,Nh.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ha(){return ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ha.apply(this,arguments)}var Ar;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ar||(Ar={}));const Ch="popstate";function b0(e){e===void 0&&(e={});function t(s,a){let{pathname:l,search:c,hash:u}=s.location;return hd("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:yg(a)}return L0(t,n,null,e)}function _t(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function gg(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function I0(){return Math.random().toString(36).substr(2,8)}function kh(e,t){return{usr:e.state,key:e.key,idx:t}}function hd(e,t,n,s){return n===void 0&&(n=null),ha({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ms(t):t,{state:n,key:t&&t.key||s||I0()})}function yg(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function ms(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function L0(e,t,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,c=a.history,u=Ar.Pop,f=null,p=g();p==null&&(p=0,c.replaceState(ha({},c.state,{idx:p}),""));function g(){return(c.state||{idx:null}).idx}function v(){u=Ar.Pop;let P=g(),_=P==null?null:P-p;p=P,f&&f({action:u,location:S.location,delta:_})}function j(P,_){u=Ar.Push;let x=hd(S.location,P,_);p=g()+1;let w=kh(x,p),b=S.createHref(x);try{c.pushState(w,"",b)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;a.location.assign(b)}l&&f&&f({action:u,location:S.location,delta:1})}function k(P,_){u=Ar.Replace;let x=hd(S.location,P,_);p=g();let w=kh(x,p),b=S.createHref(x);c.replaceState(w,"",b),l&&f&&f({action:u,location:S.location,delta:0})}function C(P){let _=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof P=="string"?P:yg(P);return x=x.replace(/ $/,"%20"),_t(_,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,_)}let S={get action(){return u},get location(){return e(a,c)},listen(P){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Ch,v),f=P,()=>{a.removeEventListener(Ch,v),f=null}},createHref(P){return t(a,P)},createURL:C,encodeLocation(P){let _=C(P);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:j,replace:k,go(P){return c.go(P)}};return S}var Ph;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Ph||(Ph={}));function E0(e,t,n){return n===void 0&&(n="/"),T0(e,t,n)}function T0(e,t,n,s){let a=typeof t=="string"?ms(t):t,l=_g(a.pathname||"/",n);if(l==null)return null;let c=vg(e);B0(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let p=Z0(l);u=$0(c[f],p)}return u}function vg(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(l,c,u)=>{let f={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};f.relativePath.startsWith("/")&&(_t(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let p=xi([s,f.relativePath]),g=n.concat(f);l.children&&l.children.length>0&&(_t(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),vg(l.children,t,g,p)),!(l.path==null&&!l.index)&&t.push({path:p,score:D0(p,l.index),routesMeta:g})};return e.forEach((l,c)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))a(l,c);else for(let f of xg(l.path))a(l,c,f)}),t}function xg(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let c=xg(s.join("/")),u=[];return u.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&u.push(...c),u.map(f=>e.startsWith("/")&&f===""?"/":f)}function B0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:z0(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const R0=/^:[\w-]+$/,A0=3,F0=2,U0=1,M0=10,O0=-2,bh=e=>e==="*";function D0(e,t){let n=e.split("/"),s=n.length;return n.some(bh)&&(s+=O0),t&&(s+=F0),n.filter(a=>!bh(a)).reduce((a,l)=>a+(R0.test(l)?A0:l===""?U0:M0),s)}function z0(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function $0(e,t,n){let{routesMeta:s}=e,a={},l="/",c=[];for(let u=0;u<s.length;++u){let f=s[u],p=u===s.length-1,g=l==="/"?t:t.slice(l.length)||"/",v=W0({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},g),j=f.route;if(!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:xi([l,v.pathname]),pathnameBase:Q0(xi([l,v.pathnameBase])),route:j}),v.pathnameBase!=="/"&&(l=xi([l,v.pathnameBase]))}return c}function W0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=H0(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:s.reduce((p,g,v)=>{let{paramName:j,isOptional:k}=g;if(j==="*"){let S=u[v]||"";c=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const C=u[v];return k&&!C?p[j]=void 0:p[j]=(C||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:e}}function H0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),gg(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function Z0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return gg(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _g(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function V0(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:a=""}=typeof e=="string"?ms(e):e;return{pathname:n?n.startsWith("/")?n:q0(n,t):t,search:J0(s),hash:X0(a)}}function q0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function yc(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function G0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Y0(e,t){let n=G0(e);return t?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function K0(e,t,n,s){s===void 0&&(s=!1);let a;typeof e=="string"?a=ms(e):(a=ha({},e),_t(!a.pathname||!a.pathname.includes("?"),yc("?","pathname","search",a)),_t(!a.pathname||!a.pathname.includes("#"),yc("#","pathname","hash",a)),_t(!a.search||!a.search.includes("#"),yc("#","search","hash",a)));let l=e===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=n;else{let v=t.length-1;if(!s&&c.startsWith("..")){let j=c.split("/");for(;j[0]==="..";)j.shift(),v-=1;a.pathname=j.join("/")}u=v>=0?t[v]:"/"}let f=V0(a,u),p=c&&c!=="/"&&c.endsWith("/"),g=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||g)&&(f.pathname+="/"),f}const xi=e=>e.join("/").replace(/\/\/+/g,"/"),Q0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),J0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,X0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function e_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const wg=["post","put","patch","delete"];new Set(wg);const t_=["get",...wg];new Set(t_);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pa(){return pa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},pa.apply(this,arguments)}const xu=y.createContext(null),n_=y.createContext(null),fl=y.createContext(null),hl=y.createContext(null),Ii=y.createContext({outlet:null,matches:[],isDataRoute:!1}),jg=y.createContext(null);function pl(){return y.useContext(hl)!=null}function _a(){return pl()||_t(!1),y.useContext(hl).location}function Sg(e){y.useContext(fl).static||y.useLayoutEffect(e)}function hr(){let{isDataRoute:e}=y.useContext(Ii);return e?g_():r_()}function r_(){pl()||_t(!1);let e=y.useContext(xu),{basename:t,future:n,navigator:s}=y.useContext(fl),{matches:a}=y.useContext(Ii),{pathname:l}=_a(),c=JSON.stringify(Y0(a,n.v7_relativeSplatPath)),u=y.useRef(!1);return Sg(()=>{u.current=!0}),y.useCallback(function(p,g){if(g===void 0&&(g={}),!u.current)return;if(typeof p=="number"){s.go(p);return}let v=K0(p,JSON.parse(c),l,g.relative==="path");e==null&&t!=="/"&&(v.pathname=v.pathname==="/"?t:xi([t,v.pathname])),(g.replace?s.replace:s.push)(v,g.state,g)},[t,s,c,l,e])}function i_(){let{matches:e}=y.useContext(Ii),t=e[e.length-1];return t?t.params:{}}function s_(e,t){return a_(e,t)}function a_(e,t,n,s){pl()||_t(!1);let{navigator:a}=y.useContext(fl),{matches:l}=y.useContext(Ii),c=l[l.length-1],u=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let p=_a(),g;if(t){var v;let P=typeof t=="string"?ms(t):t;f==="/"||(v=P.pathname)!=null&&v.startsWith(f)||_t(!1),g=P}else g=p;let j=g.pathname||"/",k=j;if(f!=="/"){let P=f.replace(/^\//,"").split("/");k="/"+j.replace(/^\//,"").split("/").slice(P.length).join("/")}let C=E0(e,{pathname:k}),S=u_(C&&C.map(P=>Object.assign({},P,{params:Object.assign({},u,P.params),pathname:xi([f,a.encodeLocation?a.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?f:xi([f,a.encodeLocation?a.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),l,n,s);return t&&S?y.createElement(hl.Provider,{value:{location:pa({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Ar.Pop}},S):S}function o_(){let e=m_(),t=e_(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),n?y.createElement("pre",{style:a},n):null,null)}const l_=y.createElement(o_,null);class c_ extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?y.createElement(Ii.Provider,{value:this.props.routeContext},y.createElement(jg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function d_(e){let{routeContext:t,match:n,children:s}=e,a=y.useContext(xu);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(Ii.Provider,{value:t},s)}function u_(e,t,n,s){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=s)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let c=e,u=(a=n)==null?void 0:a.errors;if(u!=null){let g=c.findIndex(v=>v.route.id&&(u==null?void 0:u[v.route.id])!==void 0);g>=0||_t(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,p=-1;if(n&&s&&s.v7_partialHydration)for(let g=0;g<c.length;g++){let v=c[g];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(p=g),v.route.id){let{loaderData:j,errors:k}=n,C=v.route.loader&&j[v.route.id]===void 0&&(!k||k[v.route.id]===void 0);if(v.route.lazy||C){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((g,v,j)=>{let k,C=!1,S=null,P=null;n&&(k=u&&v.route.id?u[v.route.id]:void 0,S=v.route.errorElement||l_,f&&(p<0&&j===0?(y_("route-fallback"),C=!0,P=null):p===j&&(C=!0,P=v.route.hydrateFallbackElement||null)));let _=t.concat(c.slice(0,j+1)),x=()=>{let w;return k?w=S:C?w=P:v.route.Component?w=y.createElement(v.route.Component,null):v.route.element?w=v.route.element:w=g,y.createElement(d_,{match:v,routeContext:{outlet:g,matches:_,isDataRoute:n!=null},children:w})};return n&&(v.route.ErrorBoundary||v.route.errorElement||j===0)?y.createElement(c_,{location:n.location,revalidation:n.revalidation,component:S,error:k,children:x(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):x()},null)}var Ng=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Ng||{}),Cg=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Cg||{});function f_(e){let t=y.useContext(xu);return t||_t(!1),t}function h_(e){let t=y.useContext(n_);return t||_t(!1),t}function p_(e){let t=y.useContext(Ii);return t||_t(!1),t}function kg(e){let t=p_(),n=t.matches[t.matches.length-1];return n.route.id||_t(!1),n.route.id}function m_(){var e;let t=y.useContext(jg),n=h_(),s=kg();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function g_(){let{router:e}=f_(Ng.UseNavigateStable),t=kg(Cg.UseNavigateStable),n=y.useRef(!1);return Sg(()=>{n.current=!0}),y.useCallback(function(a,l){l===void 0&&(l={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,pa({fromRouteId:t},l)))},[e,t])}const Ih={};function y_(e,t,n){Ih[e]||(Ih[e]=!0)}function v_(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function tn(e){_t(!1)}function x_(e){let{basename:t="/",children:n=null,location:s,navigationType:a=Ar.Pop,navigator:l,static:c=!1,future:u}=e;pl()&&_t(!1);let f=t.replace(/^\/*/,"/"),p=y.useMemo(()=>({basename:f,navigator:l,static:c,future:pa({v7_relativeSplatPath:!1},u)}),[f,u,l,c]);typeof s=="string"&&(s=ms(s));let{pathname:g="/",search:v="",hash:j="",state:k=null,key:C="default"}=s,S=y.useMemo(()=>{let P=_g(g,f);return P==null?null:{location:{pathname:P,search:v,hash:j,state:k,key:C},navigationType:a}},[f,g,v,j,k,C,a]);return S==null?null:y.createElement(fl.Provider,{value:p},y.createElement(hl.Provider,{children:n,value:S}))}function __(e){let{children:t,location:n}=e;return s_(pd(t),n)}new Promise(()=>{});function pd(e,t){t===void 0&&(t=[]);let n=[];return y.Children.forEach(e,(s,a)=>{if(!y.isValidElement(s))return;let l=[...t,a];if(s.type===y.Fragment){n.push.apply(n,pd(s.props.children,l));return}s.type!==tn&&_t(!1),!s.props.index||!s.props.children||_t(!1);let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=pd(s.props.children,l)),n.push(c)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function md(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(a=>[n,a]):[[n,s]])},[]))}function w_(e,t){let n=md(e);return t&&t.forEach((s,a)=>{n.has(a)||t.getAll(a).forEach(l=>{n.append(a,l)})}),n}const j_="6";try{window.__reactRouterVersion=j_}catch{}const S_="startTransition",Lh=yv[S_];function N_(e){let{basename:t,children:n,future:s,window:a}=e,l=y.useRef();l.current==null&&(l.current=b0({window:a,v5Compat:!0}));let c=l.current,[u,f]=y.useState({action:c.action,location:c.location}),{v7_startTransition:p}=s||{},g=y.useCallback(v=>{p&&Lh?Lh(()=>f(v)):f(v)},[f,p]);return y.useLayoutEffect(()=>c.listen(g),[c,g]),y.useEffect(()=>v_(s),[s]),y.createElement(x_,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:c,future:s})}var Eh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Eh||(Eh={}));var Th;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Th||(Th={}));function C_(e){let t=y.useRef(md(e)),n=y.useRef(!1),s=_a(),a=y.useMemo(()=>w_(s.search,n.current?null:t.current),[s.search]),l=hr(),c=y.useCallback((u,f)=>{const p=md(typeof u=="function"?u(a):u);n.current=!0,l("?"+p,f)},[l,a]);return[a,c]}function Pg(e,t){return function(){return e.apply(t,arguments)}}const{toString:k_}=Object.prototype,{getPrototypeOf:_u}=Object,{iterator:ml,toStringTag:bg}=Symbol,gl=(e=>t=>{const n=k_.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),An=e=>(e=e.toLowerCase(),t=>gl(t)===e),yl=e=>t=>typeof t===e,{isArray:gs}=Array,us=yl("undefined");function wa(e){return e!==null&&!us(e)&&e.constructor!==null&&!us(e.constructor)&&Jt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ig=An("ArrayBuffer");function P_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ig(e.buffer),t}const b_=yl("string"),Jt=yl("function"),Lg=yl("number"),ja=e=>e!==null&&typeof e=="object",I_=e=>e===!0||e===!1,jo=e=>{if(gl(e)!=="object")return!1;const t=_u(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(bg in e)&&!(ml in e)},L_=e=>{if(!ja(e)||wa(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},E_=An("Date"),T_=An("File"),B_=An("Blob"),R_=An("FileList"),A_=e=>ja(e)&&Jt(e.pipe),F_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Jt(e.append)&&((t=gl(e))==="formdata"||t==="object"&&Jt(e.toString)&&e.toString()==="[object FormData]"))},U_=An("URLSearchParams"),[M_,O_,D_,z_]=["ReadableStream","Request","Response","Headers"].map(An),$_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Sa(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),gs(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{if(wa(e))return;const l=n?Object.getOwnPropertyNames(e):Object.keys(e),c=l.length;let u;for(s=0;s<c;s++)u=l[s],t.call(null,e[u],u,e)}}function Eg(e,t){if(wa(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,a;for(;s-- >0;)if(a=n[s],t===a.toLowerCase())return a;return null}const gi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Tg=e=>!us(e)&&e!==gi;function gd(){const{caseless:e,skipUndefined:t}=Tg(this)&&this||{},n={},s=(a,l)=>{const c=e&&Eg(n,l)||l;jo(n[c])&&jo(a)?n[c]=gd(n[c],a):jo(a)?n[c]=gd({},a):gs(a)?n[c]=a.slice():(!t||!us(a))&&(n[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Sa(arguments[a],s);return n}const W_=(e,t,n,{allOwnKeys:s}={})=>(Sa(t,(a,l)=>{n&&Jt(a)?e[l]=Pg(a,n):e[l]=a},{allOwnKeys:s}),e),H_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Z_=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},V_=(e,t,n,s)=>{let a,l,c;const u={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),l=a.length;l-- >0;)c=a[l],(!s||s(c,e,t))&&!u[c]&&(t[c]=e[c],u[c]=!0);e=n!==!1&&_u(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},q_=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},G_=e=>{if(!e)return null;if(gs(e))return e;let t=e.length;if(!Lg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Y_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&_u(Uint8Array)),K_=(e,t)=>{const s=(e&&e[ml]).call(e);let a;for(;(a=s.next())&&!a.done;){const l=a.value;t.call(e,l[0],l[1])}},Q_=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},J_=An("HTMLFormElement"),X_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,a){return s.toUpperCase()+a}),Bh=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),ew=An("RegExp"),Bg=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Sa(n,(a,l)=>{let c;(c=t(a,l,e))!==!1&&(s[l]=c||a)}),Object.defineProperties(e,s)},tw=e=>{Bg(e,(t,n)=>{if(Jt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(Jt(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},nw=(e,t)=>{const n={},s=a=>{a.forEach(l=>{n[l]=!0})};return gs(e)?s(e):s(String(e).split(t)),n},rw=()=>{},iw=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function sw(e){return!!(e&&Jt(e.append)&&e[bg]==="FormData"&&e[ml])}const aw=e=>{const t=new Array(10),n=(s,a)=>{if(ja(s)){if(t.indexOf(s)>=0)return;if(wa(s))return s;if(!("toJSON"in s)){t[a]=s;const l=gs(s)?[]:{};return Sa(s,(c,u)=>{const f=n(c,a+1);!us(f)&&(l[u]=f)}),t[a]=void 0,l}}return s};return n(e,0)},ow=An("AsyncFunction"),lw=e=>e&&(ja(e)||Jt(e))&&Jt(e.then)&&Jt(e.catch),Rg=((e,t)=>e?setImmediate:t?((n,s)=>(gi.addEventListener("message",({source:a,data:l})=>{a===gi&&l===n&&s.length&&s.shift()()},!1),a=>{s.push(a),gi.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Jt(gi.postMessage)),cw=typeof queueMicrotask<"u"?queueMicrotask.bind(gi):typeof process<"u"&&process.nextTick||Rg,dw=e=>e!=null&&Jt(e[ml]),K={isArray:gs,isArrayBuffer:Ig,isBuffer:wa,isFormData:F_,isArrayBufferView:P_,isString:b_,isNumber:Lg,isBoolean:I_,isObject:ja,isPlainObject:jo,isEmptyObject:L_,isReadableStream:M_,isRequest:O_,isResponse:D_,isHeaders:z_,isUndefined:us,isDate:E_,isFile:T_,isBlob:B_,isRegExp:ew,isFunction:Jt,isStream:A_,isURLSearchParams:U_,isTypedArray:Y_,isFileList:R_,forEach:Sa,merge:gd,extend:W_,trim:$_,stripBOM:H_,inherits:Z_,toFlatObject:V_,kindOf:gl,kindOfTest:An,endsWith:q_,toArray:G_,forEachEntry:K_,matchAll:Q_,isHTMLForm:J_,hasOwnProperty:Bh,hasOwnProp:Bh,reduceDescriptors:Bg,freezeMethods:tw,toObjectSet:nw,toCamelCase:X_,noop:rw,toFiniteNumber:iw,findKey:Eg,global:gi,isContextDefined:Tg,isSpecCompliantForm:sw,toJSONObject:aw,isAsyncFn:ow,isThenable:lw,setImmediate:Rg,asap:cw,isIterable:dw};function Ue(e,t,n,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}K.inherits(Ue,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:K.toJSONObject(this.config),code:this.code,status:this.status}}});const Ag=Ue.prototype,Fg={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Fg[e]={value:e}});Object.defineProperties(Ue,Fg);Object.defineProperty(Ag,"isAxiosError",{value:!0});Ue.from=(e,t,n,s,a,l)=>{const c=Object.create(Ag);K.toFlatObject(e,c,function(g){return g!==Error.prototype},p=>p!=="isAxiosError");const u=e&&e.message?e.message:"Error",f=t==null&&e?e.code:t;return Ue.call(c,u,f,n,s,a),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",l&&Object.assign(c,l),c};const uw=null;function yd(e){return K.isPlainObject(e)||K.isArray(e)}function Ug(e){return K.endsWith(e,"[]")?e.slice(0,-2):e}function Rh(e,t,n){return e?e.concat(t).map(function(a,l){return a=Ug(a),!n&&l?"["+a+"]":a}).join(n?".":""):t}function fw(e){return K.isArray(e)&&!e.some(yd)}const hw=K.toFlatObject(K,{},null,function(t){return/^is[A-Z]/.test(t)});function vl(e,t,n){if(!K.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=K.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,P){return!K.isUndefined(P[S])});const s=n.metaTokens,a=n.visitor||g,l=n.dots,c=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&K.isSpecCompliantForm(t);if(!K.isFunction(a))throw new TypeError("visitor must be a function");function p(C){if(C===null)return"";if(K.isDate(C))return C.toISOString();if(K.isBoolean(C))return C.toString();if(!f&&K.isBlob(C))throw new Ue("Blob is not supported. Use a Buffer instead.");return K.isArrayBuffer(C)||K.isTypedArray(C)?f&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function g(C,S,P){let _=C;if(C&&!P&&typeof C=="object"){if(K.endsWith(S,"{}"))S=s?S:S.slice(0,-2),C=JSON.stringify(C);else if(K.isArray(C)&&fw(C)||(K.isFileList(C)||K.endsWith(S,"[]"))&&(_=K.toArray(C)))return S=Ug(S),_.forEach(function(w,b){!(K.isUndefined(w)||w===null)&&t.append(c===!0?Rh([S],b,l):c===null?S:S+"[]",p(w))}),!1}return yd(C)?!0:(t.append(Rh(P,S,l),p(C)),!1)}const v=[],j=Object.assign(hw,{defaultVisitor:g,convertValue:p,isVisitable:yd});function k(C,S){if(!K.isUndefined(C)){if(v.indexOf(C)!==-1)throw Error("Circular reference detected in "+S.join("."));v.push(C),K.forEach(C,function(_,x){(!(K.isUndefined(_)||_===null)&&a.call(t,_,K.isString(x)?x.trim():x,S,j))===!0&&k(_,S?S.concat(x):[x])}),v.pop()}}if(!K.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Ah(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function wu(e,t){this._pairs=[],e&&vl(e,this,t)}const Mg=wu.prototype;Mg.append=function(t,n){this._pairs.push([t,n])};Mg.toString=function(t){const n=t?function(s){return t.call(this,s,Ah)}:Ah;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function pw(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Og(e,t,n){if(!t)return e;const s=n&&n.encode||pw;K.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let l;if(a?l=a(t,n):l=K.isURLSearchParams(t)?t.toString():new wu(t,n).toString(s),l){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class Fh{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){K.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Dg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mw=typeof URLSearchParams<"u"?URLSearchParams:wu,gw=typeof FormData<"u"?FormData:null,yw=typeof Blob<"u"?Blob:null,vw={isBrowser:!0,classes:{URLSearchParams:mw,FormData:gw,Blob:yw},protocols:["http","https","file","blob","url","data"]},ju=typeof window<"u"&&typeof document<"u",vd=typeof navigator=="object"&&navigator||void 0,xw=ju&&(!vd||["ReactNative","NativeScript","NS"].indexOf(vd.product)<0),_w=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ww=ju&&window.location.href||"http://localhost",jw=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ju,hasStandardBrowserEnv:xw,hasStandardBrowserWebWorkerEnv:_w,navigator:vd,origin:ww},Symbol.toStringTag,{value:"Module"})),Bt={...jw,...vw};function Sw(e,t){return vl(e,new Bt.classes.URLSearchParams,{visitor:function(n,s,a,l){return Bt.isNode&&K.isBuffer(n)?(this.append(s,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function Nw(e){return K.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Cw(e){const t={},n=Object.keys(e);let s;const a=n.length;let l;for(s=0;s<a;s++)l=n[s],t[l]=e[l];return t}function zg(e){function t(n,s,a,l){let c=n[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),f=l>=n.length;return c=!c&&K.isArray(a)?a.length:c,f?(K.hasOwnProp(a,c)?a[c]=[a[c],s]:a[c]=s,!u):((!a[c]||!K.isObject(a[c]))&&(a[c]=[]),t(n,s,a[c],l)&&K.isArray(a[c])&&(a[c]=Cw(a[c])),!u)}if(K.isFormData(e)&&K.isFunction(e.entries)){const n={};return K.forEachEntry(e,(s,a)=>{t(Nw(s),a,n,0)}),n}return null}function kw(e,t,n){if(K.isString(e))try{return(t||JSON.parse)(e),K.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const Na={transitional:Dg,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",a=s.indexOf("application/json")>-1,l=K.isObject(t);if(l&&K.isHTMLForm(t)&&(t=new FormData(t)),K.isFormData(t))return a?JSON.stringify(zg(t)):t;if(K.isArrayBuffer(t)||K.isBuffer(t)||K.isStream(t)||K.isFile(t)||K.isBlob(t)||K.isReadableStream(t))return t;if(K.isArrayBufferView(t))return t.buffer;if(K.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Sw(t,this.formSerializer).toString();if((u=K.isFileList(t))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return vl(u?{"files[]":t}:t,f&&new f,this.formSerializer)}}return l||a?(n.setContentType("application/json",!1),kw(t)):t}],transformResponse:[function(t){const n=this.transitional||Na.transitional,s=n&&n.forcedJSONParsing,a=this.responseType==="json";if(K.isResponse(t)||K.isReadableStream(t))return t;if(t&&K.isString(t)&&(s&&!this.responseType||a)){const c=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?Ue.from(u,Ue.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Bt.classes.FormData,Blob:Bt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};K.forEach(["delete","get","head","post","put","patch"],e=>{Na.headers[e]={}});const Pw=K.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),bw=e=>{const t={};let n,s,a;return e&&e.split(`
`).forEach(function(c){a=c.indexOf(":"),n=c.substring(0,a).trim().toLowerCase(),s=c.substring(a+1).trim(),!(!n||t[n]&&Pw[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},Uh=Symbol("internals");function Fs(e){return e&&String(e).trim().toLowerCase()}function So(e){return e===!1||e==null?e:K.isArray(e)?e.map(So):String(e)}function Iw(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const Lw=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function vc(e,t,n,s,a){if(K.isFunction(s))return s.call(this,t,n);if(a&&(t=n),!!K.isString(t)){if(K.isString(s))return t.indexOf(s)!==-1;if(K.isRegExp(s))return s.test(t)}}function Ew(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function Tw(e,t){const n=K.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(a,l,c){return this[s].call(this,t,a,l,c)},configurable:!0})})}let Xt=class{constructor(t){t&&this.set(t)}set(t,n,s){const a=this;function l(u,f,p){const g=Fs(f);if(!g)throw new Error("header name must be a non-empty string");const v=K.findKey(a,g);(!v||a[v]===void 0||p===!0||p===void 0&&a[v]!==!1)&&(a[v||f]=So(u))}const c=(u,f)=>K.forEach(u,(p,g)=>l(p,g,f));if(K.isPlainObject(t)||t instanceof this.constructor)c(t,n);else if(K.isString(t)&&(t=t.trim())&&!Lw(t))c(bw(t),n);else if(K.isObject(t)&&K.isIterable(t)){let u={},f,p;for(const g of t){if(!K.isArray(g))throw TypeError("Object iterator must return a key-value pair");u[p=g[0]]=(f=u[p])?K.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}c(u,n)}else t!=null&&l(n,t,s);return this}get(t,n){if(t=Fs(t),t){const s=K.findKey(this,t);if(s){const a=this[s];if(!n)return a;if(n===!0)return Iw(a);if(K.isFunction(n))return n.call(this,a,s);if(K.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Fs(t),t){const s=K.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||vc(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let a=!1;function l(c){if(c=Fs(c),c){const u=K.findKey(s,c);u&&(!n||vc(s,s[u],u,n))&&(delete s[u],a=!0)}}return K.isArray(t)?t.forEach(l):l(t),a}clear(t){const n=Object.keys(this);let s=n.length,a=!1;for(;s--;){const l=n[s];(!t||vc(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const n=this,s={};return K.forEach(this,(a,l)=>{const c=K.findKey(s,l);if(c){n[c]=So(a),delete n[l];return}const u=t?Ew(l):String(l).trim();u!==l&&delete n[l],n[u]=So(a),s[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return K.forEach(this,(s,a)=>{s!=null&&s!==!1&&(n[a]=t&&K.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Uh]=this[Uh]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=Fs(c);s[u]||(Tw(a,c),s[u]=!0)}return K.isArray(t)?t.forEach(l):l(t),this}};Xt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);K.reduceDescriptors(Xt.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});K.freezeMethods(Xt);function xc(e,t){const n=this||Na,s=t||n,a=Xt.from(s.headers);let l=s.data;return K.forEach(e,function(u){l=u.call(n,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function $g(e){return!!(e&&e.__CANCEL__)}function ys(e,t,n){Ue.call(this,e??"canceled",Ue.ERR_CANCELED,t,n),this.name="CanceledError"}K.inherits(ys,Ue,{__CANCEL__:!0});function Wg(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new Ue("Request failed with status code "+n.status,[Ue.ERR_BAD_REQUEST,Ue.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Bw(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Rw(e,t){e=e||10;const n=new Array(e),s=new Array(e);let a=0,l=0,c;return t=t!==void 0?t:1e3,function(f){const p=Date.now(),g=s[l];c||(c=p),n[a]=f,s[a]=p;let v=l,j=0;for(;v!==a;)j+=n[v++],v=v%e;if(a=(a+1)%e,a===l&&(l=(l+1)%e),p-c<t)return;const k=g&&p-g;return k?Math.round(j*1e3/k):void 0}}function Aw(e,t){let n=0,s=1e3/t,a,l;const c=(p,g=Date.now())=>{n=g,a=null,l&&(clearTimeout(l),l=null),e(...p)};return[(...p)=>{const g=Date.now(),v=g-n;v>=s?c(p,g):(a=p,l||(l=setTimeout(()=>{l=null,c(a)},s-v)))},()=>a&&c(a)]}const Yo=(e,t,n=3)=>{let s=0;const a=Rw(50,250);return Aw(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,f=c-s,p=a(f),g=c<=u;s=c;const v={loaded:c,total:u,progress:u?c/u:void 0,bytes:f,rate:p||void 0,estimated:p&&u&&g?(u-c)/p:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(v)},n)},Mh=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},Oh=e=>(...t)=>K.asap(()=>e(...t)),Fw=Bt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Bt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Bt.origin),Bt.navigator&&/(msie|trident)/i.test(Bt.navigator.userAgent)):()=>!0,Uw=Bt.hasStandardBrowserEnv?{write(e,t,n,s,a,l){const c=[e+"="+encodeURIComponent(t)];K.isNumber(n)&&c.push("expires="+new Date(n).toGMTString()),K.isString(s)&&c.push("path="+s),K.isString(a)&&c.push("domain="+a),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Mw(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Ow(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Hg(e,t,n){let s=!Mw(t);return e&&(s||n==!1)?Ow(e,t):t}const Dh=e=>e instanceof Xt?{...e}:e;function ki(e,t){t=t||{};const n={};function s(p,g,v,j){return K.isPlainObject(p)&&K.isPlainObject(g)?K.merge.call({caseless:j},p,g):K.isPlainObject(g)?K.merge({},g):K.isArray(g)?g.slice():g}function a(p,g,v,j){if(K.isUndefined(g)){if(!K.isUndefined(p))return s(void 0,p,v,j)}else return s(p,g,v,j)}function l(p,g){if(!K.isUndefined(g))return s(void 0,g)}function c(p,g){if(K.isUndefined(g)){if(!K.isUndefined(p))return s(void 0,p)}else return s(void 0,g)}function u(p,g,v){if(v in t)return s(p,g);if(v in e)return s(void 0,p)}const f={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(p,g,v)=>a(Dh(p),Dh(g),v,!0)};return K.forEach(Object.keys({...e,...t}),function(g){const v=f[g]||a,j=v(e[g],t[g],g);K.isUndefined(j)&&v!==u||(n[g]=j)}),n}const Zg=e=>{const t=ki({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=Xt.from(c),t.url=Og(Hg(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),K.isFormData(n)){if(Bt.hasStandardBrowserEnv||Bt.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(K.isFunction(n.getHeaders)){const f=n.getHeaders(),p=["content-type","content-length"];Object.entries(f).forEach(([g,v])=>{p.includes(g.toLowerCase())&&c.set(g,v)})}}if(Bt.hasStandardBrowserEnv&&(s&&K.isFunction(s)&&(s=s(t)),s||s!==!1&&Fw(t.url))){const f=a&&l&&Uw.read(l);f&&c.set(a,f)}return t},Dw=typeof XMLHttpRequest<"u",zw=Dw&&function(e){return new Promise(function(n,s){const a=Zg(e);let l=a.data;const c=Xt.from(a.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:p}=a,g,v,j,k,C;function S(){k&&k(),C&&C(),a.cancelToken&&a.cancelToken.unsubscribe(g),a.signal&&a.signal.removeEventListener("abort",g)}let P=new XMLHttpRequest;P.open(a.method.toUpperCase(),a.url,!0),P.timeout=a.timeout;function _(){if(!P)return;const w=Xt.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),B={data:!u||u==="text"||u==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:w,config:e,request:P};Wg(function(F){n(F),S()},function(F){s(F),S()},B),P=null}"onloadend"in P?P.onloadend=_:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(_)},P.onabort=function(){P&&(s(new Ue("Request aborted",Ue.ECONNABORTED,e,P)),P=null)},P.onerror=function(b){const B=b&&b.message?b.message:"Network Error",T=new Ue(B,Ue.ERR_NETWORK,e,P);T.event=b||null,s(T),P=null},P.ontimeout=function(){let b=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const B=a.transitional||Dg;a.timeoutErrorMessage&&(b=a.timeoutErrorMessage),s(new Ue(b,B.clarifyTimeoutError?Ue.ETIMEDOUT:Ue.ECONNABORTED,e,P)),P=null},l===void 0&&c.setContentType(null),"setRequestHeader"in P&&K.forEach(c.toJSON(),function(b,B){P.setRequestHeader(B,b)}),K.isUndefined(a.withCredentials)||(P.withCredentials=!!a.withCredentials),u&&u!=="json"&&(P.responseType=a.responseType),p&&([j,C]=Yo(p,!0),P.addEventListener("progress",j)),f&&P.upload&&([v,k]=Yo(f),P.upload.addEventListener("progress",v),P.upload.addEventListener("loadend",k)),(a.cancelToken||a.signal)&&(g=w=>{P&&(s(!w||w.type?new ys(null,e,P):w),P.abort(),P=null)},a.cancelToken&&a.cancelToken.subscribe(g),a.signal&&(a.signal.aborted?g():a.signal.addEventListener("abort",g)));const x=Bw(a.url);if(x&&Bt.protocols.indexOf(x)===-1){s(new Ue("Unsupported protocol "+x+":",Ue.ERR_BAD_REQUEST,e));return}P.send(l||null)})},$w=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,a;const l=function(p){if(!a){a=!0,u();const g=p instanceof Error?p:this.reason;s.abort(g instanceof Ue?g:new ys(g instanceof Error?g.message:g))}};let c=t&&setTimeout(()=>{c=null,l(new Ue(`timeout ${t} of ms exceeded`,Ue.ETIMEDOUT))},t);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(p=>{p.unsubscribe?p.unsubscribe(l):p.removeEventListener("abort",l)}),e=null)};e.forEach(p=>p.addEventListener("abort",l));const{signal:f}=s;return f.unsubscribe=()=>K.asap(u),f}},Ww=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,a;for(;s<n;)a=s+t,yield e.slice(s,a),s=a},Hw=async function*(e,t){for await(const n of Zw(e))yield*Ww(n,t)},Zw=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},zh=(e,t,n,s)=>{const a=Hw(e,t);let l=0,c,u=f=>{c||(c=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:p,value:g}=await a.next();if(p){u(),f.close();return}let v=g.byteLength;if(n){let j=l+=v;n(j)}f.enqueue(new Uint8Array(g))}catch(p){throw u(p),p}},cancel(f){return u(f),a.return()}},{highWaterMark:2})},$h=64*1024,{isFunction:ao}=K,Vw=(({Request:e,Response:t})=>({Request:e,Response:t}))(K.global),{ReadableStream:Wh,TextEncoder:Hh}=K.global,Zh=(e,...t)=>{try{return!!e(...t)}catch{return!1}},qw=e=>{e=K.merge.call({skipUndefined:!0},Vw,e);const{fetch:t,Request:n,Response:s}=e,a=t?ao(t):typeof fetch=="function",l=ao(n),c=ao(s);if(!a)return!1;const u=a&&ao(Wh),f=a&&(typeof Hh=="function"?(C=>S=>C.encode(S))(new Hh):async C=>new Uint8Array(await new n(C).arrayBuffer())),p=l&&u&&Zh(()=>{let C=!1;const S=new n(Bt.origin,{body:new Wh,method:"POST",get duplex(){return C=!0,"half"}}).headers.has("Content-Type");return C&&!S}),g=c&&u&&Zh(()=>K.isReadableStream(new s("").body)),v={stream:g&&(C=>C.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(C=>{!v[C]&&(v[C]=(S,P)=>{let _=S&&S[C];if(_)return _.call(S);throw new Ue(`Response type '${C}' is not supported`,Ue.ERR_NOT_SUPPORT,P)})});const j=async C=>{if(C==null)return 0;if(K.isBlob(C))return C.size;if(K.isSpecCompliantForm(C))return(await new n(Bt.origin,{method:"POST",body:C}).arrayBuffer()).byteLength;if(K.isArrayBufferView(C)||K.isArrayBuffer(C))return C.byteLength;if(K.isURLSearchParams(C)&&(C=C+""),K.isString(C))return(await f(C)).byteLength},k=async(C,S)=>{const P=K.toFiniteNumber(C.getContentLength());return P??j(S)};return async C=>{let{url:S,method:P,data:_,signal:x,cancelToken:w,timeout:b,onDownloadProgress:B,onUploadProgress:T,responseType:F,headers:R,withCredentials:O="same-origin",fetchOptions:I}=Zg(C),D=t||fetch;F=F?(F+"").toLowerCase():"text";let q=$w([x,w&&w.toAbortSignal()],b),te=null;const G=q&&q.unsubscribe&&(()=>{q.unsubscribe()});let E;try{if(T&&p&&P!=="get"&&P!=="head"&&(E=await k(R,_))!==0){let U=new n(S,{method:"POST",body:_,duplex:"half"}),ie;if(K.isFormData(_)&&(ie=U.headers.get("content-type"))&&R.setContentType(ie),U.body){const[Z,se]=Mh(E,Yo(Oh(T)));_=zh(U.body,$h,Z,se)}}K.isString(O)||(O=O?"include":"omit");const oe=l&&"credentials"in n.prototype,Ne={...I,signal:q,method:P.toUpperCase(),headers:R.normalize().toJSON(),body:_,duplex:"half",credentials:oe?O:void 0};te=l&&new n(S,Ne);let W=await(l?D(te,I):D(S,Ne));const fe=g&&(F==="stream"||F==="response");if(g&&(B||fe&&G)){const U={};["status","statusText","headers"].forEach(ne=>{U[ne]=W[ne]});const ie=K.toFiniteNumber(W.headers.get("content-length")),[Z,se]=B&&Mh(ie,Yo(Oh(B),!0))||[];W=new s(zh(W.body,$h,Z,()=>{se&&se(),G&&G()}),U)}F=F||"text";let re=await v[K.findKey(v,F)||"text"](W,C);return!fe&&G&&G(),await new Promise((U,ie)=>{Wg(U,ie,{data:re,headers:Xt.from(W.headers),status:W.status,statusText:W.statusText,config:C,request:te})})}catch(oe){throw G&&G(),oe&&oe.name==="TypeError"&&/Load failed|fetch/i.test(oe.message)?Object.assign(new Ue("Network Error",Ue.ERR_NETWORK,C,te),{cause:oe.cause||oe}):Ue.from(oe,oe&&oe.code,C,te)}}},Gw=new Map,Vg=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:a}=t,l=[s,a,n];let c=l.length,u=c,f,p,g=Gw;for(;u--;)f=l[u],p=g.get(f),p===void 0&&g.set(f,p=u?new Map:qw(t)),g=p;return p};Vg();const xd={http:uw,xhr:zw,fetch:{get:Vg}};K.forEach(xd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Vh=e=>`- ${e}`,Yw=e=>K.isFunction(e)||e===null||e===!1,qg={getAdapter:(e,t)=>{e=K.isArray(e)?e:[e];const{length:n}=e;let s,a;const l={};for(let c=0;c<n;c++){s=e[c];let u;if(a=s,!Yw(s)&&(a=xd[(u=String(s)).toLowerCase()],a===void 0))throw new Ue(`Unknown adapter '${u}'`);if(a&&(K.isFunction(a)||(a=a.get(t))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([f,p])=>`adapter ${f} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=n?c.length>1?`since :
`+c.map(Vh).join(`
`):" "+Vh(c[0]):"as no adapter specified";throw new Ue("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a},adapters:xd};function _c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ys(null,e)}function qh(e){return _c(e),e.headers=Xt.from(e.headers),e.data=xc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),qg.getAdapter(e.adapter||Na.adapter,e)(e).then(function(s){return _c(e),s.data=xc.call(e,e.transformResponse,s),s.headers=Xt.from(s.headers),s},function(s){return $g(s)||(_c(e),s&&s.response&&(s.response.data=xc.call(e,e.transformResponse,s.response),s.response.headers=Xt.from(s.response.headers))),Promise.reject(s)})}const Gg="1.12.2",xl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{xl[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const Gh={};xl.transitional=function(t,n,s){function a(l,c){return"[Axios v"+Gg+"] Transitional option '"+l+"'"+c+(s?". "+s:"")}return(l,c,u)=>{if(t===!1)throw new Ue(a(c," has been removed"+(n?" in "+n:"")),Ue.ERR_DEPRECATED);return n&&!Gh[c]&&(Gh[c]=!0,console.warn(a(c," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(l,c,u):!0}};xl.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Kw(e,t,n){if(typeof e!="object")throw new Ue("options must be an object",Ue.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const l=s[a],c=t[l];if(c){const u=e[l],f=u===void 0||c(u,l,e);if(f!==!0)throw new Ue("option "+l+" must be "+f,Ue.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ue("Unknown option "+l,Ue.ERR_BAD_OPTION)}}const No={assertOptions:Kw,validators:xl},Wn=No.validators;let _i=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Fh,response:new Fh}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=ki(this.defaults,n);const{transitional:s,paramsSerializer:a,headers:l}=n;s!==void 0&&No.assertOptions(s,{silentJSONParsing:Wn.transitional(Wn.boolean),forcedJSONParsing:Wn.transitional(Wn.boolean),clarifyTimeoutError:Wn.transitional(Wn.boolean)},!1),a!=null&&(K.isFunction(a)?n.paramsSerializer={serialize:a}:No.assertOptions(a,{encode:Wn.function,serialize:Wn.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),No.assertOptions(n,{baseUrl:Wn.spelling("baseURL"),withXsrfToken:Wn.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let c=l&&K.merge(l.common,l[n.method]);l&&K.forEach(["delete","get","head","post","put","patch","common"],C=>{delete l[C]}),n.headers=Xt.concat(c,l);const u=[];let f=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(n)===!1||(f=f&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const p=[];this.interceptors.response.forEach(function(S){p.push(S.fulfilled,S.rejected)});let g,v=0,j;if(!f){const C=[qh.bind(this),void 0];for(C.unshift(...u),C.push(...p),j=C.length,g=Promise.resolve(n);v<j;)g=g.then(C[v++],C[v++]);return g}j=u.length;let k=n;for(;v<j;){const C=u[v++],S=u[v++];try{k=C(k)}catch(P){S.call(this,P);break}}try{g=qh.call(this,k)}catch(C){return Promise.reject(C)}for(v=0,j=p.length;v<j;)g=g.then(p[v++],p[v++]);return g}getUri(t){t=ki(this.defaults,t);const n=Hg(t.baseURL,t.url,t.allowAbsoluteUrls);return Og(n,t.params,t.paramsSerializer)}};K.forEach(["delete","get","head","options"],function(t){_i.prototype[t]=function(n,s){return this.request(ki(s||{},{method:t,url:n,data:(s||{}).data}))}});K.forEach(["post","put","patch"],function(t){function n(s){return function(l,c,u){return this.request(ki(u||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}_i.prototype[t]=n(),_i.prototype[t+"Form"]=n(!0)});let Qw=class Yg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const s=this;this.promise.then(a=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](a);s._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{s.subscribe(u),l=u}).then(a);return c.cancel=function(){s.unsubscribe(l)},c},t(function(l,c,u){s.reason||(s.reason=new ys(l,c,u),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Yg(function(a){t=a}),cancel:t}}};function Jw(e){return function(n){return e.apply(null,n)}}function Xw(e){return K.isObject(e)&&e.isAxiosError===!0}const _d={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_d).forEach(([e,t])=>{_d[t]=e});function Kg(e){const t=new _i(e),n=Pg(_i.prototype.request,t);return K.extend(n,_i.prototype,t,{allOwnKeys:!0}),K.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return Kg(ki(e,a))},n}const ut=Kg(Na);ut.Axios=_i;ut.CanceledError=ys;ut.CancelToken=Qw;ut.isCancel=$g;ut.VERSION=Gg;ut.toFormData=vl;ut.AxiosError=Ue;ut.Cancel=ut.CanceledError;ut.all=function(t){return Promise.all(t)};ut.spread=Jw;ut.isAxiosError=Xw;ut.mergeConfig=ki;ut.AxiosHeaders=Xt;ut.formToJSON=e=>zg(K.isHTMLForm(e)?new FormData(e):e);ut.getAdapter=qg.getAdapter;ut.HttpStatusCode=_d;ut.default=ut;const{Axios:q1,AxiosError:G1,CanceledError:Y1,isCancel:K1,CancelToken:Q1,VERSION:J1,all:X1,Cancel:eS,isAxiosError:tS,spread:nS,toFormData:rS,AxiosHeaders:iS,HttpStatusCode:sS,formToJSON:aS,getAdapter:oS,mergeConfig:lS}=ut,_l="http://localhost:5054/api",de=ut.create({baseURL:_l,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});de.interceptors.request.use(e=>{try{const t=localStorage.getItem("token");t&&t!=="null"&&(e.headers.Authorization=`Bearer ${t}`)}catch{}return e},e=>Promise.reject(e));let oo=!1,wd=[];const Yh=(e,t=null)=>{wd.forEach(n=>{e?n.reject(e):n.resolve(t)}),wd=[]};de.interceptors.response.use(e=>e,async e=>{var n,s,a,l,c,u,f,p;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){if(oo)return new Promise((g,v)=>{wd.push({resolve:g,reject:v})}).then(g=>(t.headers.Authorization=`Bearer ${g}`,de(t))).catch(g=>Promise.reject(g));t._retry=!0,oo=!0;try{console.log(" Token expired, refreshing...");const g=localStorage.getItem("refreshToken");if(!g)throw new Error("No refresh token available");const v=await ut.post(`${_l}/Auth/Refresh-Token`,{refreshToken:g}),j=((a=(s=v.data)==null?void 0:s.data)==null?void 0:a.token)||((l=v.data)==null?void 0:l.token)||((c=v.data)==null?void 0:c.accessToken),k=((f=(u=v.data)==null?void 0:u.data)==null?void 0:f.refreshToken)||((p=v.data)==null?void 0:p.refreshToken);if(j)return console.log(" Token refreshed successfully"),localStorage.setItem("token",j),k&&localStorage.setItem("refreshToken",k),t.headers.Authorization=`Bearer ${j}`,Yh(null,j),oo=!1,de(t);throw new Error("No token in refresh response")}catch(g){return console.error(" Token refresh failed:",g),Yh(g,null),oo=!1,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),window.location.href="/",Promise.reject(g)}}return Promise.reject(e)});const ej=e=>{if(!e)return{};try{const t=e.split(".");if(t.length<2)return{};const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch(t){return console.warn("decodeJwt failed",t),{}}},Zn={register:async({fullName:e,email:t,phoneNumber:n,password:s})=>{const a={FullName:e,Email:t,PhoneNumber:n,Password:s,ConfirmPassword:s};return(await de.post("/Auth/Register",a)).data},login:async(e,t)=>{var c,u,f;const n=await de.post("/Auth/Login",{Email:e,Password:t}),s=((c=n.data)==null?void 0:c.data)||n.data||{},a=s.token||s.accessToken||((u=n.data)==null?void 0:u.token),l=s.refreshToken||((f=n.data)==null?void 0:f.refreshToken);if(a){localStorage.setItem("token",a);try{const p=ej(a),g=p["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||p.nameidentifier||p.UserId||p.userId||p.uid||p.nameid||p.sub||p.id||p.Id;g&&localStorage.setItem("userId",g);const v=p["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||p.role||p.Role;v&&localStorage.setItem("userRole",v)}catch(p){console.error(" Error decoding JWT in authApi.login:",p)}}l&&localStorage.setItem("refreshToken",l),s.user&&localStorage.setItem("user",JSON.stringify(s.user));try{const p=localStorage.getItem("userRole");if(p&&(p.includes("Staff")||p.includes("staff")||p==="StationManager"||p.includes("Manager"))){const v=await Zn.getMyProfile(),j=(v==null?void 0:v.stationId)||(v==null?void 0:v.StationId);j&&localStorage.setItem("stationId",j)}}catch(p){console.warn(" Could not fetch staff profile after login:",p)}return{raw:n.data,token:a,refreshToken:l,payload:s}},logout:async()=>{const e=await de.post("/Auth/Logout");return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),localStorage.removeItem("userRole"),localStorage.removeItem("stationId"),e.data},refreshToken:async()=>{var s,a,l,c,u,f,p;const e=await de.post("/Auth/Refresh-Token"),t=((a=(s=e.data)==null?void 0:s.data)==null?void 0:a.token)||((l=e.data)==null?void 0:l.token)||((c=e.data)==null?void 0:c.accessToken),n=((f=(u=e.data)==null?void 0:u.data)==null?void 0:f.refreshToken)||((p=e.data)==null?void 0:p.refreshToken);return t&&localStorage.setItem("token",t),n&&localStorage.setItem("refreshToken",n),e.data},uploadCCCD:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await de.post("/Auth/cccd",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},uploadGPLX:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await de.post("/Auth/gplx",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},getMe:async()=>{var t;const e=await de.get("/Auth/Me");return((t=e.data)==null?void 0:t.data)||e.data||{}},getMyProfile:async()=>{var t;const e=await de.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},getUserById:async e=>{var t,n;try{const s=await de.get(`/Users/Get-By-${encodeURIComponent(e)}`);return((t=s.data)==null?void 0:t.data)||s.data||{}}catch{try{const a=await de.get(`/Users/${encodeURIComponent(e)}`);return((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error("authApi.getUserById failed:",a),a}}}};function tj(){const[e,t]=y.useState({}),[n,s]=y.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""}),[a,l]=y.useState({}),[c,u]=y.useState({cccdFront:null,cccdBack:null,licenseFront:null,licenseBack:null}),f={cccdFront:y.useRef(null),cccdBack:y.useRef(null),licenseFront:y.useRef(null),licenseBack:y.useRef(null)},p=y.useRef({});y.useEffect(()=>{(async()=>{try{console.log(" Fetching user profile from /api/Users/Get-My-Profile...");const C=await Zn.getMyProfile();console.log(" User profile:",C),t(C||{}),console.log(" Fetching document URLs from /api/Auth/me...");const S=await Zn.getMe();console.log(" Auth response from /api/Auth/me:",S);const P=S||{};console.log(" Extracted auth data:",P);const _=P.cccdImageUrl_Front&&P.cccdImageUrl_Front.trim()?P.cccdImageUrl_Front:"",x=P.cccdImageUrl_Back&&P.cccdImageUrl_Back.trim()?P.cccdImageUrl_Back:"",w=P.gplxImageUrl_Front&&P.gplxImageUrl_Front.trim()?P.gplxImageUrl_Front:"",b=P.gplxImageUrl_Back&&P.gplxImageUrl_Back.trim()?P.gplxImageUrl_Back:"";console.log(" Loaded document URLs:",{cccdFront:_,cccdBack:x,licenseFront:w,licenseBack:b}),s({cccdFront:_,cccdBack:x,licenseFront:w,licenseBack:b}),p.current={cccdFront:_,cccdBack:x,licenseFront:w,licenseBack:b}}catch(C){console.error(" Error loading profile:",C);const S=localStorage.getItem("userEmail"),P=localStorage.getItem("username"),_=localStorage.getItem("userPhone");t({email:S,fullName:P,phoneNumber:_}),s({cccdFront:localStorage.getItem("cccdFront")||"",cccdBack:localStorage.getItem("cccdBack")||"",licenseFront:localStorage.getItem("licenseFront")||"",licenseBack:localStorage.getItem("licenseBack")||""})}})()},[]);const g=async(k,C)=>{if(!C)return;if(!C.type.startsWith("image/")){alert("Please select an image file");return}if(C.size>5*1024*1024){alert("File must be <5MB");return}u(P=>({...P,[k]:C}));const S=new FileReader;S.onload=P=>{s(_=>({..._,[k]:P.target.result}))},S.readAsDataURL(C),console.log(` File selected for ${k}:`,C.name)},v=async()=>{var S,P;const k=c.cccdFront,C=c.cccdBack;if(!k&&!C){alert("Please select at least one CCCD image");return}l(_=>({..._,cccdFront:!0,cccdBack:!0}));try{console.log(" Uploading CCCD documents..."),await Zn.uploadCCCD(k,C);const x=await Zn.getMe()||{},w=x.cccdImageUrl_Front||"",b=x.cccdImageUrl_Back||"";s(B=>({...B,cccdFront:w,cccdBack:b})),u(B=>({...B,cccdFront:null,cccdBack:null})),alert(" CCCD uploaded successfully!")}catch(_){console.error(" Error uploading CCCD:",_),alert(` Upload failed: ${((P=(S=_.response)==null?void 0:S.data)==null?void 0:P.message)||_.message}`)}finally{l(_=>({..._,cccdFront:!1,cccdBack:!1}))}},j=async()=>{var S,P;const k=c.licenseFront,C=c.licenseBack;if(!k&&!C){alert("Please select at least one license image");return}l(_=>({..._,licenseFront:!0,licenseBack:!0}));try{console.log(" Uploading license documents..."),await Zn.uploadGPLX(k,C);const x=await Zn.getMe()||{},w=x.gplxImageUrl_Front||"",b=x.gplxImageUrl_Back||"";s(B=>({...B,licenseFront:w,licenseBack:b})),u(B=>({...B,licenseFront:null,licenseBack:null})),alert(" License uploaded successfully!")}catch(_){console.error(" Error uploading license:",_),alert(` Upload failed: ${((P=(S=_.response)==null?void 0:S.data)==null?void 0:P.message)||_.message}`)}finally{l(_=>({..._,licenseFront:!1,licenseBack:!1}))}};return i.jsx("main",{className:"profile-main",children:i.jsxs("div",{className:"profile-container",children:[i.jsx("h2",{children:"USER PROFILE"}),i.jsxs("div",{className:"profile-field",children:[i.jsx("label",{children:"Full Name"}),i.jsx("input",{type:"text",value:e.firstName?`${e.firstName} ${e.lastName}`:e.fullName||"",readOnly:!0})]}),i.jsxs("div",{className:"profile-field",children:[i.jsx("label",{children:"Email"}),i.jsx("input",{type:"email",value:e.email||"",readOnly:!0})]}),i.jsxs("div",{className:"profile-field",children:[i.jsx("label",{children:"Phone Number"}),i.jsx("input",{type:"tel",value:e.phoneNumber||"",readOnly:!0})]}),i.jsxs("div",{className:"documents-section",children:[i.jsx("h3",{children:"Upload ID Card (CCCD)"}),i.jsx("p",{className:"documents-note",children:"Please upload clear images of your ID card (both sides)"}),i.jsxs("div",{className:"documents-grid",children:[i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"ID (Front)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.cccdFront.current)==null?void 0:k.click()},children:[n.cccdFront&&n.cccdFront.trim()?i.jsx("img",{src:n.cccdFront,alt:"CCCD Front",className:"doc-preview",onLoad:()=>console.log(" cccdFront image loaded"),onError:k=>console.error(" Failed to load cccdFront"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card"}),i.jsx("span",{children:c.cccdFront?c.cccdFront.name:"Click to select"})]}),a.cccdFront&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.cccdFront,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("cccdFront",(C=k.target.files)==null?void 0:C[0])}})]}),i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"ID (Back)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.cccdBack.current)==null?void 0:k.click()},children:[n.cccdBack&&n.cccdBack.trim()?i.jsx("img",{src:n.cccdBack,alt:"CCCD Back",className:"doc-preview",onLoad:()=>console.log(" cccdBack image loaded"),onError:k=>console.error(" Failed to load cccdBack"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card"}),i.jsx("span",{children:c.cccdBack?c.cccdBack.name:"Click to select"})]}),a.cccdBack&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.cccdBack,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("cccdBack",(C=k.target.files)==null?void 0:C[0])}})]})]}),i.jsxs("button",{className:"btn-upload-docs",onClick:v,disabled:!c.cccdFront&&!c.cccdBack,children:[i.jsx("i",{className:"fas fa-upload"})," Upload ID Card"]})]}),i.jsxs("div",{className:"documents-section",children:[i.jsx("h3",{children:"Upload Driver License (GPLX)"}),i.jsx("p",{className:"documents-note",children:"Please upload clear images of your driver's license (both sides)"}),i.jsxs("div",{className:"documents-grid",children:[i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"Driver license (Front)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.licenseFront.current)==null?void 0:k.click()},children:[n.licenseFront&&n.licenseFront.trim()?i.jsx("img",{src:n.licenseFront,alt:"License Front",className:"doc-preview",onLoad:()=>console.log(" licenseFront image loaded"),onError:k=>console.error(" Failed to load licenseFront"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card-alt"}),i.jsx("span",{children:c.licenseFront?c.licenseFront.name:"Click to select"})]}),a.licenseFront&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.licenseFront,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("licenseFront",(C=k.target.files)==null?void 0:C[0])}})]}),i.jsxs("div",{className:"document-upload-box",children:[i.jsx("label",{children:"Driver license (Back)"}),i.jsxs("div",{className:"upload-area",onClick:()=>{var k;return(k=f.licenseBack.current)==null?void 0:k.click()},children:[n.licenseBack&&n.licenseBack.trim()?i.jsx("img",{src:n.licenseBack,alt:"License Back",className:"doc-preview",onLoad:()=>console.log(" licenseBack image loaded"),onError:k=>console.error(" Failed to load licenseBack"),crossOrigin:"anonymous"}):i.jsxs("div",{className:"upload-placeholder",children:[i.jsx("i",{className:"fas fa-id-card-alt"}),i.jsx("span",{children:c.licenseBack?c.licenseBack.name:"Click to select"})]}),a.licenseBack&&i.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),i.jsx("input",{ref:f.licenseBack,type:"file",accept:"image/*",style:{display:"none"},onChange:k=>{var C;return g("licenseBack",(C=k.target.files)==null?void 0:C[0])}})]})]}),i.jsxs("button",{className:"btn-upload-docs",onClick:j,disabled:!c.licenseFront&&!c.licenseBack,children:[i.jsx("i",{className:"fas fa-upload"})," Upload Driver License"]})]})]})})}const nj={getMyProfile:async()=>{var t;const e=await de.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},updateMyProfile:async e=>{var t,n;try{console.log(" Updating user profile:",e);const s=await de.put("/Users/Update-My-Profile",e);return console.log(" Profile updated:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error updating profile:",((n=s.response)==null?void 0:n.data)||s.message),s}},changePassword:async(e,t)=>{var n,s;try{console.log(" Changing password");const a=await de.post("/Users/Change-Password",{currentPassword:e,newPassword:t});return console.log(" Password changed successfully"),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error changing password:",((s=a.response)==null?void 0:s.data)||a.message),a}},updateUserAvatar:async(e,t)=>{var n,s;try{console.log(" Updating avatar for user:",e);const a=await de.post(`/Users/${encodeURIComponent(e)}/avatar`,{avatarUrl:t});return console.log(" Avatar updated:",a.data),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error updating avatar:",((s=a.response)==null?void 0:s.data)||a.message),a}},getUserById:async e=>{var t,n;try{console.log(" Fetching user by ID:",e);const s=await de.get(`/Users/Get-By-${encodeURIComponent(e)}`);return console.log(" User data:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching user:",((n=s.response)==null?void 0:n.data)||s.message),s}},searchUsers:async(e,t=1,n=10)=>{var s,a,l;try{console.log(" Searching users by email:",e);const c=await de.get("/Users/Search",{params:{email:e,pageNumber:t,pageSize:n}});return console.log(" Search results:",c.data),Array.isArray(c.data)?c.data:(s=c.data)!=null&&s.data&&Array.isArray(c.data.data)?c.data.data:(a=c.data)!=null&&a.items&&Array.isArray(c.data.items)?c.data.items:c.data||[]}catch(c){return console.error(" Error searching users:",((l=c.response)==null?void 0:l.data)||c.message),[]}},deactivateUser:async(e,t="")=>{var n;try{const s=encodeURIComponent(e),a=t?`?reason=${encodeURIComponent(t)}`:"",l=[`/Users/Deactivate-By-${s}${a}`,`/User/Deactivate-By-${s}${a}`];for(const c of l)try{const u=await de.patch(c,t?{reason:t}:{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(n=u==null?void 0:u.response)==null?void 0:n.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Deactivate user endpoint not found")}catch(s){throw console.error(" Error deactivating user:",s.message),s}},activateUser:async e=>{var t;try{const n=encodeURIComponent(e),s=[`/Users/Activate-By-${n}`,`/User/Activate-By-${n}`];for(const a of s)try{const l=await de.patch(a,{}),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(t=l==null?void 0:l.response)==null?void 0:t.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Activate user endpoint not found")}catch(n){throw console.error(" Error activating user:",n.message),n}},updateUserRole:async(e,t)=>{var n;try{const s=encodeURIComponent(e),a=[`/Users/Update-Role-By-${s}`,`/User/Update-Role-By-${s}`];for(const l of a)try{const c=await de.patch(l,{role:t}),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){const u=(n=c==null?void 0:c.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw c}throw new Error("Update user role endpoint not found")}catch(s){throw console.error(" Error updating user role:",s.message),s}},updateUserProfileByAdmin:async(e,t)=>{var n;try{const s=encodeURIComponent(e),a=[`/Users/Update-Profile-By-${s}`,`/User/Update-Profile-By-${s}`];for(const l of a)try{const c=await de.put(l,t),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){const u=(n=c==null?void 0:c.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw c}throw new Error("Update user profile endpoint not found")}catch(s){throw console.error(" Error updating user profile:",s.message),s}},getTotalUserCount:async()=>{var e;try{const t=["/Users/Get-Total-Count","/User/Get-Total-Count"];for(const n of t)try{const s=await de.get(n),a=s==null?void 0:s.data,l=a&&typeof a=="object"&&"data"in a?a.data:a;return(l==null?void 0:l.totalCount)||(l==null?void 0:l.count)||l||0}catch(s){const a=(e=s==null?void 0:s.response)==null?void 0:e.status;if(a&&a!==404&&a!==405)throw s}return 0}catch(t){return console.error(" Error getting total user count:",t.message),0}},getUserStatisticsByRole:async()=>{var e;try{const t=["/Users/Get-Statistics-By-Role","/User/Get-Statistics-By-Role","/Users/Statistics-By-Role"];for(const n of t)try{const s=await de.get(n),a=s==null?void 0:s.data;return(a&&typeof a=="object"&&"data"in a?a.data:a)||{}}catch(s){const a=(e=s==null?void 0:s.response)==null?void 0:e.status;if(a&&a!==404&&a!==405)throw s}return{}}catch(t){return console.error(" Error getting user statistics:",t.message),{}}}};function Ca({isOpen:e,type:t="info",title:n,message:s,onClose:a,actionLabel:l="OK",onAction:c,autoCloseMs:u=null}){if(Yn.useEffect(()=>{if(!e||!u)return;const g=setTimeout(a,u);return()=>clearTimeout(g)},[e,u,a]),!e)return null;const f=()=>{c&&c(),a()},p={success:"",error:"",info:"",warning:""}[t]||"";return i.jsx("div",{className:`notification-backdrop notification-${t}`,children:i.jsxs("div",{className:`notification-modal notification-${t}`,children:[i.jsxs("div",{className:"notification-header",children:[i.jsx("span",{className:"notification-icon",children:p}),i.jsx("h3",{className:"notification-title",children:n}),i.jsx("button",{className:"notification-close",onClick:a,children:""})]}),i.jsx("div",{className:"notification-body",children:Array.isArray(s)?i.jsx("ul",{children:s.map((g,v)=>i.jsx("li",{children:g},v))}):i.jsx("p",{children:s})}),i.jsxs("div",{className:"notification-footer",children:[i.jsx("button",{className:"btn-close",onClick:a,children:"Close"}),c&&i.jsx("button",{className:`btn-action btn-${t}`,onClick:f,children:l})]})]})})}function rj(){const e=hr(),[t,n]=y.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[s,a]=y.useState(!1),[l,c]=y.useState(!0),[u,f]=y.useState([]),[p,g]=y.useState({isOpen:!1,type:"info",title:"",message:""});y.useEffect(()=>{v()},[]);const v=async()=>{try{c(!0),console.log(" Initializing profile form...");const S=localStorage.getItem("userFirstName")||"",P=localStorage.getItem("userLastName")||"",_=localStorage.getItem("userPhone")||"";console.log(" Profile initialized from localStorage");const x=[],w=localStorage.getItem("userAddress"),b=localStorage.getItem("userDateOfBirth"),B=localStorage.getItem("userDriverLicenseNumber"),T=localStorage.getItem("userDriverLicenseExpiry");console.log(" Checking 4 required fields:"),console.log("  Address:",w),console.log("  DateOfBirth:",b),console.log("  DriverLicenseNumber:",B),console.log("  DriverLicenseExpiry:",T),(!w||w.trim()==="")&&x.push("address"),(!b||b.trim()==="")&&x.push("dateOfBirth"),(!B||B.trim()==="")&&x.push("driverLicenseNumber"),(!T||T.trim()==="")&&x.push("driverLicenseExpiry"),f(x),console.log(" Missing fields:",x),n({firstName:S,lastName:P,phoneNumber:_,address:localStorage.getItem("userAddress")||"",dateOfBirth:localStorage.getItem("userDateOfBirth")||"",yearOfBirth:localStorage.getItem("userYearOfBirth")||"",identityNumber:localStorage.getItem("userIdentityNumber")||"",driverLicenseNumber:localStorage.getItem("userDriverLicenseNumber")||"",driverLicenseExpiry:localStorage.getItem("userDriverLicenseExpiry")||"",driverLicenseClass:localStorage.getItem("userDriverLicenseClass")||""})}catch(S){console.error(" Error initializing profile:",S)}finally{c(!1)}},j=S=>{const{name:P,value:_}=S.target,x={...t,[P]:_};if(P==="dateOfBirth"&&_){const w=new Date(_).getFullYear();x.yearOfBirth=String(w),console.log(` Extracted year ${w} from date ${_}`)}n(x)},k=()=>t.firstName.trim()?t.lastName.trim()?t.phoneNumber.trim()?t.phoneNumber.match(/^[0-9]{10,11}$/)?t.address.trim()?t.driverLicenseNumber.trim()?t.driverLicenseExpiry.trim()?!0:(g({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Expiry is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Number is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Address is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number must be 10-11 digits"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"Last name is required"}),!1):(g({isOpen:!0,type:"error",title:"Validation Error",message:"First name is required"}),!1),C=async S=>{var P,_;if(S.preventDefault(),!!k()){a(!0);try{console.log(" Updating profile with data:",t);const x={request:"UpdateProfile",firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber,address:t.address||"",dateOfBirth:t.dateOfBirth||"",yearOfBirth:t.yearOfBirth?String(t.yearOfBirth):"",identityNumber:t.identityNumber||"",driverLicenseNumber:t.driverLicenseNumber||"",driverLicenseExpiry:t.driverLicenseExpiry||"",driverLicenseClass:t.driverLicenseClass||""},w=await nj.updateMyProfile(x);console.log(" Profile updated successfully:",w),localStorage.setItem("userFirstName",t.firstName),localStorage.setItem("userLastName",t.lastName),localStorage.setItem("userPhone",t.phoneNumber),localStorage.setItem("userAddress",t.address),localStorage.setItem("userDateOfBirth",t.dateOfBirth),localStorage.setItem("userYearOfBirth",t.yearOfBirth),localStorage.setItem("userIdentityNumber",t.identityNumber),localStorage.setItem("userDriverLicenseNumber",t.driverLicenseNumber),localStorage.setItem("userDriverLicenseExpiry",t.driverLicenseExpiry),localStorage.setItem("userDriverLicenseClass",t.driverLicenseClass),g({isOpen:!0,type:"success",title:"Success! ",message:"Your profile has been updated successfully.",autoCloseMs:2e3,onAction:()=>{e("/")},actionLabel:"Go to Home"})}catch(x){console.error(" Error updating profile:",x),g({isOpen:!0,type:"error",title:"Update Failed",message:((_=(P=x.response)==null?void 0:P.data)==null?void 0:_.message)||"Failed to update profile. Please try again."})}finally{a(!1)}}};return l?i.jsx("div",{className:"update-profile-page",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Loading your profile..."})]})}):i.jsxs("div",{className:"update-profile-page",children:[i.jsx(Ca,{isOpen:p.isOpen,type:p.type,title:p.title,message:p.message,onClose:()=>g({...p,isOpen:!1}),autoCloseMs:p.autoCloseMs||0,onAction:p.onAction,actionLabel:p.actionLabel}),i.jsxs("div",{className:"container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("h1",{children:" Update Your Profile"}),i.jsx("p",{style:{color:"white"},children:"Keep your information up to date to enjoy our services"})]}),u.length>0&&i.jsxs("div",{className:"warning-banner",children:[i.jsx("span",{className:"warning-icon",children:""}),i.jsxs("div",{children:[i.jsx("strong",{children:"Missing Information"}),i.jsxs("p",{children:["Please complete the following fields: ",u.map(S=>S==="address"?"Address":S==="driverLicenseNumber"?"Driver License Number":S==="driverLicenseExpiry"?"Driver License Expiry":S).join(", ")]})]})]}),i.jsxs("form",{onSubmit:C,className:"update-profile-form",children:[i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Basic Information"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"firstName",children:"First Name *"}),i.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:j,placeholder:"John",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),i.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:j,placeholder:"Doe",required:!0})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),i.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:t.phoneNumber,onChange:j,placeholder:"0912345678",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"address",children:["Address *",u.includes("address")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"text",id:"address",name:"address",value:t.address,onChange:j,placeholder:"123 Main St, City, Country",className:u.includes("address")?"field-missing":"",required:!0})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Birth Information"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),i.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:t.dateOfBirth,onChange:j})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth (Auto-filled)"}),i.jsx("input",{type:"text",id:"yearOfBirth",name:"yearOfBirth",value:t.yearOfBirth,disabled:!0,placeholder:"Will auto-fill from date above",style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Driver License Information *"}),i.jsxs("div",{className:`form-group ${u.includes("driverLicenseNumber")?"field-missing-group":""}`,children:[i.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number *",u.includes("driverLicenseNumber")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:t.driverLicenseNumber,onChange:j,placeholder:"ABC123456",className:u.includes("driverLicenseNumber")?"field-missing":"",required:!0})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:`form-group ${u.includes("driverLicenseExpiry")?"field-missing-group":""}`,children:[i.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry *",u.includes("driverLicenseExpiry")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:t.driverLicenseExpiry,onChange:j,className:u.includes("driverLicenseExpiry")?"field-missing":"",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),i.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:t.driverLicenseClass,onChange:j,children:[i.jsx("option",{value:"",children:"Select Class"}),i.jsx("option",{value:"A",children:"Class A"}),i.jsx("option",{value:"A1",children:"Class A1"}),i.jsx("option",{value:"B",children:"Class B"}),i.jsx("option",{value:"C",children:"Class C"}),i.jsx("option",{value:"D",children:"Class D"}),i.jsx("option",{value:"E",children:"Class E"})]})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h2",{className:"section-title",children:" Additional Information"}),i.jsxs("div",{className:`form-group ${u.includes("identityNumber")?"field-missing-group":""}`,children:[i.jsxs("label",{htmlFor:"identityNumber",children:["Identity Number (CCCD) *",u.includes("identityNumber")&&i.jsx("span",{className:"required-badge",children:"Required"})]}),i.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:t.identityNumber,onChange:j,placeholder:"123456789012",className:u.includes("identityNumber")?"field-missing":"",required:!0})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e(-1),disabled:s,children:" Go Back"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?" Saving...":" Save Profile"})]})]})]})]})}const jd={getAllStations:async(e=1,t=100)=>{var n;try{console.log(" Fetching stations from:",`${_l}/Stations/Get-All`);const s=await de.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Stations response:",s.data);const a=s.data;return Array.isArray(a)?(console.log(" Returning stations array:",a.length,"items"),a):a.data&&a.data.data&&Array.isArray(a.data.data)?(console.log(" Returning stations from data.data.data:",a.data.data.length,"items"),a.data.data):a.data&&a.data.items&&Array.isArray(a.data.items)?(console.log(" Returning stations from data.data.items:",a.data.items.length,"items"),a.data.items):a.data&&Array.isArray(a.data)?(console.log(" Returning stations from data.data:",a.data.length,"items"),a.data):a.items&&Array.isArray(a.items)?(console.log(" Returning stations from data.items:",a.items.length,"items"),a.items):(console.warn(" No stations found in response"),[])}catch(s){return console.error(" Error fetching stations:",((n=s.response)==null?void 0:n.data)||s.message),[]}}},En={getAllCars:async(e=1,t=100)=>{var n;try{console.log(" Fetching cars from:",`${_l}/Cars/Get-All`);const s=await de.get("/Cars/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Cars response:",s.data);const a=s.data;return Array.isArray(a)?(console.log(" Returning cars array:",a.length,"items"),a):a.data&&a.data.data&&Array.isArray(a.data.data)?(console.log(" Returning cars from data.data.data:",a.data.data.length,"items"),a.data.data):a.data&&a.data.items&&Array.isArray(a.data.items)?(console.log(" Returning cars from data.data.items:",a.data.items.length,"items"),a.data.items):a.data&&Array.isArray(a.data)?(console.log(" Returning cars from data.data:",a.data.length,"items"),a.data):a.items&&Array.isArray(a.items)?(console.log(" Returning cars from data.items:",a.items.length,"items"),a.items):(console.warn(" No cars found in response"),[])}catch(s){return console.error(" Error fetching cars:",((n=s.response)==null?void 0:n.data)||s.message),[]}},getCarById:async e=>{var t;try{console.log(" Fetching car details for ID:",e);const n=await de.get(`/Cars/Get-By-${encodeURIComponent(e)}`);console.log(" Car detail response:",n.data);const s=n.data;return s.id||s.Id?(console.log(" Returning car object directly"),s):s.data&&s.data.data&&(s.data.data.id||s.data.data.Id)?(console.log(" Returning car from data.data.data"),s.data.data):s.data&&(s.data.id||s.data.Id)?(console.log(" Returning car from data.data"),s.data):(console.warn(" No car found in response"),null)}catch(n){throw console.error(" Error fetching car details:",((t=n.response)==null?void 0:t.data)||n.message),n}},getAvailableCarsByStation:async e=>{var t;try{console.log(" Fetching available cars for station:",e);const n=await de.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`);console.log(" Available cars response:",n.data);const s=n.data;return Array.isArray(s)?(console.log(" Returning available cars array:",s.length,"items"),s):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning available cars from data.data.data:",s.data.data.length,"items"),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning available cars from data.data.items:",s.data.items.length,"items"),s.data.items):s.data&&Array.isArray(s.data)?(console.log(" Returning available cars from data.data:",s.data.length,"items"),s.data):s.items&&Array.isArray(s.items)?(console.log(" Returning available cars from data.items:",s.items.length,"items"),s.items):(console.warn(" No available cars found in response"),[])}catch(n){throw console.error(" Error fetching available cars:",((t=n.response)==null?void 0:t.data)||n.message),n}}},ij=24e3;function Rt(e,t={convertFromUSD:!1}){const{convertFromUSD:n}=t||{},s=Number(e)||0,a=Math.round(n?s*ij:s);return new Intl.NumberFormat("vi-VN").format(a)+" "}const Qg=y.createContext(null);function sj({children:e}){const[t,n]=y.useState([]),s=y.useCallback((l,c="info",u=3500,f=null)=>{const p=Date.now()+Math.random();let g=null;try{if(f&&typeof f.getBoundingClientRect=="function"){const v=f.getBoundingClientRect(),j=Math.round(v.top+v.height+8),k=Math.round(v.left+v.width/2);g={top:j,left:k}}}catch{g=null}n(v=>[...v,{id:p,message:l,type:c,pos:g}]),setTimeout(()=>{n(v=>v.filter(j=>j.id!==p))},u)},[]),a=y.useCallback(l=>{n(c=>c.filter(u=>u.id!==l))},[]);return i.jsxs(Qg.Provider,{value:{showToast:s},children:[e,i.jsx("div",{className:"toast-viewport","aria-live":"polite",children:t.filter(l=>!l.pos).map(l=>i.jsxs("div",{className:`toast ${l.type}`,onClick:()=>a(l.id),children:[i.jsx("div",{className:"toast-message",children:l.message}),i.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},l.id))}),t.filter(l=>l.pos).map(l=>i.jsxs("div",{className:`toast ${l.type} anchored`,style:{position:"fixed",top:`${l.pos.top}px`,left:`${l.pos.left}px`,transform:"translateX(-50%)"},onClick:()=>a(l.id),children:[i.jsx("div",{className:"toast-message",children:l.message}),i.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},l.id))]})}function Su(){const e=y.useContext(Qg);if(!e)throw new Error("useToast must be used within ToastProvider");return e}function Jg(e,t){const n=y.useRef(t);y.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const aj=1;function oj(e){return Object.freeze({__version:aj,map:e})}function lj(e,t){return Object.freeze({...e,...t})}const Xg=y.createContext(null),ey=Xg.Provider;function Nu(){const e=y.useContext(Xg);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function cj(e){function t(n,s){const{instance:a,context:l}=e(n).current;return y.useImperativeHandle(s,()=>a),n.children==null?null:Yn.createElement(ey,{value:l},n.children)}return y.forwardRef(t)}function dj(e){function t(n,s){const[a,l]=y.useState(!1),{instance:c}=e(n,l).current;y.useImperativeHandle(s,()=>c),y.useEffect(function(){a&&c.update()},[c,a,n.children]);const u=c._contentNode;return u?pg.createPortal(n.children,u):null}return y.forwardRef(t)}function uj(e){function t(n,s){const{instance:a}=e(n).current;return y.useImperativeHandle(s,()=>a),null}return y.forwardRef(t)}function ty(e,t){const n=y.useRef();y.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function Cu(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function fj(e,t){return function(s,a){const l=Nu(),c=e(Cu(s,l),l);return Jg(l.map,s.attribution),ty(c.current,s.eventHandlers),t(c.current,l,s,a),c}}var Sd={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,s){s(t)})(tv,function(n){var s="1.9.4";function a(r){var o,d,h,m;for(d=1,h=arguments.length;d<h;d++){m=arguments[d];for(o in m)r[o]=m[o]}return r}var l=Object.create||function(){function r(){}return function(o){return r.prototype=o,new r}}();function c(r,o){var d=Array.prototype.slice;if(r.bind)return r.bind.apply(r,d.call(arguments,1));var h=d.call(arguments,2);return function(){return r.apply(o,h.length?h.concat(d.call(arguments)):arguments)}}var u=0;function f(r){return"_leaflet_id"in r||(r._leaflet_id=++u),r._leaflet_id}function p(r,o,d){var h,m,N,A;return A=function(){h=!1,m&&(N.apply(d,m),m=!1)},N=function(){h?m=arguments:(r.apply(d,arguments),setTimeout(A,o),h=!0)},N}function g(r,o,d){var h=o[1],m=o[0],N=h-m;return r===h&&d?r:((r-m)%N+N)%N+m}function v(){return!1}function j(r,o){if(o===!1)return r;var d=Math.pow(10,o===void 0?6:o);return Math.round(r*d)/d}function k(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function C(r){return k(r).split(/\s+/)}function S(r,o){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?l(r.options):{});for(var d in o)r.options[d]=o[d];return r.options}function P(r,o,d){var h=[];for(var m in r)h.push(encodeURIComponent(d?m.toUpperCase():m)+"="+encodeURIComponent(r[m]));return(!o||o.indexOf("?")===-1?"?":"&")+h.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function x(r,o){return r.replace(_,function(d,h){var m=o[h];if(m===void 0)throw new Error("No value provided for variable "+d);return typeof m=="function"&&(m=m(o)),m})}var w=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function b(r,o){for(var d=0;d<r.length;d++)if(r[d]===o)return d;return-1}var B="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function T(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var F=0;function R(r){var o=+new Date,d=Math.max(0,16-(o-F));return F=o+d,window.setTimeout(r,d)}var O=window.requestAnimationFrame||T("RequestAnimationFrame")||R,I=window.cancelAnimationFrame||T("CancelAnimationFrame")||T("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function D(r,o,d){if(d&&O===R)r.call(o);else return O.call(window,c(r,o))}function q(r){r&&I.call(window,r)}var te={__proto__:null,extend:a,create:l,bind:c,get lastId(){return u},stamp:f,throttle:p,wrapNum:g,falseFn:v,formatNum:j,trim:k,splitWords:C,setOptions:S,getParamString:P,template:x,isArray:w,indexOf:b,emptyImageUrl:B,requestFn:O,cancelFn:I,requestAnimFrame:D,cancelAnimFrame:q};function G(){}G.extend=function(r){var o=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=o.__super__=this.prototype,h=l(d);h.constructor=o,o.prototype=h;for(var m in this)Object.prototype.hasOwnProperty.call(this,m)&&m!=="prototype"&&m!=="__super__"&&(o[m]=this[m]);return r.statics&&a(o,r.statics),r.includes&&(E(r.includes),a.apply(null,[h].concat(r.includes))),a(h,r),delete h.statics,delete h.includes,h.options&&(h.options=d.options?l(d.options):{},a(h.options,r.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,A=h._initHooks.length;N<A;N++)h._initHooks[N].call(this)}},o},G.include=function(r){var o=this.prototype.options;return a(this.prototype,r),r.options&&(this.prototype.options=o,this.mergeOptions(r.options)),this},G.mergeOptions=function(r){return a(this.prototype.options,r),this},G.addInitHook=function(r){var o=Array.prototype.slice.call(arguments,1),d=typeof r=="function"?r:function(){this[r].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function E(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=w(r)?r:[r];for(var o=0;o<r.length;o++)r[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var oe={on:function(r,o,d){if(typeof r=="object")for(var h in r)this._on(h,r[h],o);else{r=C(r);for(var m=0,N=r.length;m<N;m++)this._on(r[m],o,d)}return this},off:function(r,o,d){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var h in r)this._off(h,r[h],o);else{r=C(r);for(var m=arguments.length===1,N=0,A=r.length;N<A;N++)m?this._off(r[N]):this._off(r[N],o,d)}return this},_on:function(r,o,d,h){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(r,o,d)===!1){d===this&&(d=void 0);var m={fn:o,ctx:d};h&&(m.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(m)}},_off:function(r,o,d){var h,m,N;if(this._events&&(h=this._events[r],!!h)){if(arguments.length===1){if(this._firingCount)for(m=0,N=h.length;m<N;m++)h[m].fn=v;delete this._events[r];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var A=this._listens(r,o,d);if(A!==!1){var H=h[A];this._firingCount&&(H.fn=v,this._events[r]=h=h.slice()),h.splice(A,1)}}},fire:function(r,o,d){if(!this.listens(r,d))return this;var h=a({},o,{type:r,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var m=this._events[r];if(m){this._firingCount=this._firingCount+1||1;for(var N=0,A=m.length;N<A;N++){var H=m[N],Y=H.fn;H.once&&this.off(r,Y,H.ctx),Y.call(H.ctx||this,h)}this._firingCount--}}return d&&this._propagateEvent(h),this},listens:function(r,o,d,h){typeof r!="string"&&console.warn('"string" type argument expected');var m=o;typeof o!="function"&&(h=!!o,m=void 0,d=void 0);var N=this._events&&this._events[r];if(N&&N.length&&this._listens(r,m,d)!==!1)return!0;if(h){for(var A in this._eventParents)if(this._eventParents[A].listens(r,o,d,h))return!0}return!1},_listens:function(r,o,d){if(!this._events)return!1;var h=this._events[r]||[];if(!o)return!!h.length;d===this&&(d=void 0);for(var m=0,N=h.length;m<N;m++)if(h[m].fn===o&&h[m].ctx===d)return m;return!1},once:function(r,o,d){if(typeof r=="object")for(var h in r)this._on(h,r[h],o,!0);else{r=C(r);for(var m=0,N=r.length;m<N;m++)this._on(r[m],o,d,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[f(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[f(r)],this},_propagateEvent:function(r){for(var o in this._eventParents)this._eventParents[o].fire(r.type,a({layer:r.target,propagatedFrom:r.target},r),!0)}};oe.addEventListener=oe.on,oe.removeEventListener=oe.clearAllEventListeners=oe.off,oe.addOneTimeEventListener=oe.once,oe.fireEvent=oe.fire,oe.hasEventListeners=oe.listens;var Ne=G.extend(oe);function W(r,o,d){this.x=d?Math.round(r):r,this.y=d?Math.round(o):o}var fe=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(r){return this.clone()._add(re(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(re(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new W(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new W(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=fe(this.x),this.y=fe(this.y),this},distanceTo:function(r){r=re(r);var o=r.x-this.x,d=r.y-this.y;return Math.sqrt(o*o+d*d)},equals:function(r){return r=re(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=re(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+j(this.x)+", "+j(this.y)+")"}};function re(r,o,d){return r instanceof W?r:w(r)?new W(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new W(r.x,r.y):new W(r,o,d)}function U(r,o){if(r)for(var d=o?[r,o]:r,h=0,m=d.length;h<m;h++)this.extend(d[h])}U.prototype={extend:function(r){var o,d;if(!r)return this;if(r instanceof W||typeof r[0]=="number"||"x"in r)o=d=re(r);else if(r=ie(r),o=r.min,d=r.max,!o||!d)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=d.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(r){return re((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return re(this.min.x,this.max.y)},getTopRight:function(){return re(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var o,d;return typeof r[0]=="number"||r instanceof W?r=re(r):r=ie(r),r instanceof U?(o=r.min,d=r.max):o=d=r,o.x>=this.min.x&&d.x<=this.max.x&&o.y>=this.min.y&&d.y<=this.max.y},intersects:function(r){r=ie(r);var o=this.min,d=this.max,h=r.min,m=r.max,N=m.x>=o.x&&h.x<=d.x,A=m.y>=o.y&&h.y<=d.y;return N&&A},overlaps:function(r){r=ie(r);var o=this.min,d=this.max,h=r.min,m=r.max,N=m.x>o.x&&h.x<d.x,A=m.y>o.y&&h.y<d.y;return N&&A},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var o=this.min,d=this.max,h=Math.abs(o.x-d.x)*r,m=Math.abs(o.y-d.y)*r;return ie(re(o.x-h,o.y-m),re(d.x+h,d.y+m))},equals:function(r){return r?(r=ie(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function ie(r,o){return!r||r instanceof U?r:new U(r,o)}function Z(r,o){if(r)for(var d=o?[r,o]:r,h=0,m=d.length;h<m;h++)this.extend(d[h])}Z.prototype={extend:function(r){var o=this._southWest,d=this._northEast,h,m;if(r instanceof ne)h=r,m=r;else if(r instanceof Z){if(h=r._southWest,m=r._northEast,!h||!m)return this}else return r?this.extend(ce(r)||se(r)):this;return!o&&!d?(this._southWest=new ne(h.lat,h.lng),this._northEast=new ne(m.lat,m.lng)):(o.lat=Math.min(h.lat,o.lat),o.lng=Math.min(h.lng,o.lng),d.lat=Math.max(m.lat,d.lat),d.lng=Math.max(m.lng,d.lng)),this},pad:function(r){var o=this._southWest,d=this._northEast,h=Math.abs(o.lat-d.lat)*r,m=Math.abs(o.lng-d.lng)*r;return new Z(new ne(o.lat-h,o.lng-m),new ne(d.lat+h,d.lng+m))},getCenter:function(){return new ne((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ne(this.getNorth(),this.getWest())},getSouthEast:function(){return new ne(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof ne||"lat"in r?r=ce(r):r=se(r);var o=this._southWest,d=this._northEast,h,m;return r instanceof Z?(h=r.getSouthWest(),m=r.getNorthEast()):h=m=r,h.lat>=o.lat&&m.lat<=d.lat&&h.lng>=o.lng&&m.lng<=d.lng},intersects:function(r){r=se(r);var o=this._southWest,d=this._northEast,h=r.getSouthWest(),m=r.getNorthEast(),N=m.lat>=o.lat&&h.lat<=d.lat,A=m.lng>=o.lng&&h.lng<=d.lng;return N&&A},overlaps:function(r){r=se(r);var o=this._southWest,d=this._northEast,h=r.getSouthWest(),m=r.getNorthEast(),N=m.lat>o.lat&&h.lat<d.lat,A=m.lng>o.lng&&h.lng<d.lng;return N&&A},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,o){return r?(r=se(r),this._southWest.equals(r.getSouthWest(),o)&&this._northEast.equals(r.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(r,o){return r instanceof Z?r:new Z(r,o)}function ne(r,o,d){if(isNaN(r)||isNaN(o))throw new Error("Invalid LatLng object: ("+r+", "+o+")");this.lat=+r,this.lng=+o,d!==void 0&&(this.alt=+d)}ne.prototype={equals:function(r,o){if(!r)return!1;r=ce(r);var d=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return d<=(o===void 0?1e-9:o)},toString:function(r){return"LatLng("+j(this.lat,r)+", "+j(this.lng,r)+")"},distanceTo:function(r){return we.distance(this,ce(r))},wrap:function(){return we.wrapLatLng(this)},toBounds:function(r){var o=180*r/40075017,d=o/Math.cos(Math.PI/180*this.lat);return se([this.lat-o,this.lng-d],[this.lat+o,this.lng+d])},clone:function(){return new ne(this.lat,this.lng,this.alt)}};function ce(r,o,d){return r instanceof ne?r:w(r)&&typeof r[0]!="object"?r.length===3?new ne(r[0],r[1],r[2]):r.length===2?new ne(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new ne(r.lat,"lng"in r?r.lng:r.lon,r.alt):o===void 0?null:new ne(r,o,d)}var ke={latLngToPoint:function(r,o){var d=this.projection.project(r),h=this.scale(o);return this.transformation._transform(d,h)},pointToLatLng:function(r,o){var d=this.scale(o),h=this.transformation.untransform(r,d);return this.projection.unproject(h)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var o=this.projection.bounds,d=this.scale(r),h=this.transformation.transform(o.min,d),m=this.transformation.transform(o.max,d);return new U(h,m)},infinite:!1,wrapLatLng:function(r){var o=this.wrapLng?g(r.lng,this.wrapLng,!0):r.lng,d=this.wrapLat?g(r.lat,this.wrapLat,!0):r.lat,h=r.alt;return new ne(d,o,h)},wrapLatLngBounds:function(r){var o=r.getCenter(),d=this.wrapLatLng(o),h=o.lat-d.lat,m=o.lng-d.lng;if(h===0&&m===0)return r;var N=r.getSouthWest(),A=r.getNorthEast(),H=new ne(N.lat-h,N.lng-m),Y=new ne(A.lat-h,A.lng-m);return new Z(H,Y)}},we=a({},ke,{wrapLng:[-180,180],R:6371e3,distance:function(r,o){var d=Math.PI/180,h=r.lat*d,m=o.lat*d,N=Math.sin((o.lat-r.lat)*d/2),A=Math.sin((o.lng-r.lng)*d/2),H=N*N+Math.cos(h)*Math.cos(m)*A*A,Y=2*Math.atan2(Math.sqrt(H),Math.sqrt(1-H));return this.R*Y}}),he=6378137,Ve={R:he,MAX_LATITUDE:85.0511287798,project:function(r){var o=Math.PI/180,d=this.MAX_LATITUDE,h=Math.max(Math.min(d,r.lat),-d),m=Math.sin(h*o);return new W(this.R*r.lng*o,this.R*Math.log((1+m)/(1-m))/2)},unproject:function(r){var o=180/Math.PI;return new ne((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*o,r.x*o/this.R)},bounds:function(){var r=he*Math.PI;return new U([-r,-r],[r,r])}()};function ft(r,o,d,h){if(w(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=o,this._c=d,this._d=h}ft.prototype={transform:function(r,o){return this._transform(r.clone(),o)},_transform:function(r,o){return o=o||1,r.x=o*(this._a*r.x+this._b),r.y=o*(this._c*r.y+this._d),r},untransform:function(r,o){return o=o||1,new W((r.x/o-this._b)/this._a,(r.y/o-this._d)/this._c)}};function qe(r,o,d,h){return new ft(r,o,d,h)}var Nt=a({},we,{code:"EPSG:3857",projection:Ve,transformation:function(){var r=.5/(Math.PI*Ve.R);return qe(r,.5,-r,.5)}()}),ge=a({},Nt,{code:"EPSG:900913"});function ae(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function ye(r,o){var d="",h,m,N,A,H,Y;for(h=0,N=r.length;h<N;h++){for(H=r[h],m=0,A=H.length;m<A;m++)Y=H[m],d+=(m?"L":"M")+Y.x+" "+Y.y;d+=o?Pe.svg?"z":"x":""}return d||"M0 0"}var ue=document.documentElement.style,xe="ActiveXObject"in window,Ie=xe&&!document.addEventListener,Ft="msLaunchUri"in navigator&&!("documentMode"in document),wn=It("webkit"),Se=It("android"),z=It("android 2")||It("android 3"),X=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ee=Se&&It("Google")&&X<537&&!("AudioNode"in window),Q=!!window.opera,M=!Ft&&It("chrome"),J=It("gecko")&&!wn&&!Q&&!xe,Me=!M&&It("safari"),ve=It("phantom"),We="OTransition"in ue,je=navigator.platform.indexOf("Win")===0,$=xe&&"transition"in ue,Le="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!z,Be="MozPerspective"in ue,me=!window.L_DISABLE_3D&&($||Le||Be)&&!We&&!ve,V=typeof orientation<"u"||It("mobile"),$e=V&&wn,Ye=V&&Le,be=!window.PointerEvent&&window.MSPointerEvent,tt=!!(window.PointerEvent||be),Zt="ontouchstart"in window||!!window.TouchEvent,cn=!window.L_NO_TOUCH&&(Zt||tt),pr=V&&Q,mr=V&&J,Ut=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,pt=function(){var r=!1;try{var o=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",v,o),window.removeEventListener("testPassiveEventSupport",v,o)}catch{}return r}(),mt=function(){return!!document.createElement("canvas").getContext}(),en=!!(document.createElementNS&&ae("svg").createSVGRect),Li=!!en&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Ei=!en&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var o=r.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),Ti=navigator.platform.indexOf("Mac")===0,Kr=navigator.platform.indexOf("Linux")===0;function It(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var Pe={ie:xe,ielt9:Ie,edge:Ft,webkit:wn,android:Se,android23:z,androidStock:ee,opera:Q,chrome:M,gecko:J,safari:Me,phantom:ve,opera12:We,win:je,ie3d:$,webkit3d:Le,gecko3d:Be,any3d:me,mobile:V,mobileWebkit:$e,mobileWebkit3d:Ye,msPointer:be,pointer:tt,touch:cn,touchNative:Zt,mobileOpera:pr,mobileGecko:mr,retina:Ut,passiveEvents:pt,canvas:mt,svg:en,vml:Ei,inlineSvg:Li,mac:Ti,linux:Kr},gr=Pe.msPointer?"MSPointerDown":"pointerdown",yr=Pe.msPointer?"MSPointerMove":"pointermove",vr=Pe.msPointer?"MSPointerUp":"pointerup",xr=Pe.msPointer?"MSPointerCancel":"pointercancel",Kn={touchstart:gr,touchmove:yr,touchend:vr,touchcancel:xr},_r={touchstart:ni,touchmove:Fn,touchend:Fn,touchcancel:Fn},dn={},wr=!1;function Qr(r,o,d){return o==="touchstart"&&ti(),_r[o]?(d=_r[o].bind(this,d),r.addEventListener(Kn[o],d,!1),d):(console.warn("wrong event specified:",o),v)}function Jr(r,o,d){if(!Kn[o]){console.warn("wrong event specified:",o);return}r.removeEventListener(Kn[o],d,!1)}function Xr(r){dn[r.pointerId]=r}function ei(r){dn[r.pointerId]&&(dn[r.pointerId]=r)}function jr(r){delete dn[r.pointerId]}function ti(){wr||(document.addEventListener(gr,Xr,!0),document.addEventListener(yr,ei,!0),document.addEventListener(vr,jr,!0),document.addEventListener(xr,jr,!0),wr=!0)}function Fn(r,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var d in dn)o.touches.push(dn[d]);o.changedTouches=[o],r(o)}}function ni(r,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&Ct(o),Fn(r,o)}function ri(r){var o={},d,h;for(h in r)d=r[h],o[h]=d&&d.bind?d.bind(r):d;return r=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var ii=200;function si(r,o){r.addEventListener("dblclick",o);var d=0,h;function m(N){if(N.detail!==1){h=N.detail;return}if(!(N.pointerType==="mouse"||N.sourceCapabilities&&!N.sourceCapabilities.firesTouchEvents)){var A=Eu(N);if(!(A.some(function(Y){return Y instanceof HTMLLabelElement&&Y.attributes.for})&&!A.some(function(Y){return Y instanceof HTMLInputElement||Y instanceof HTMLSelectElement}))){var H=Date.now();H-d<=ii?(h++,h===2&&o(ri(N))):h=1,d=H}}}return r.addEventListener("click",m),{dblclick:o,simDblclick:m}}function ai(r,o){r.removeEventListener("dblclick",o.dblclick),r.removeEventListener("click",o.simDblclick)}var Qn=oi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),jn=oi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Sr=jn==="webkitTransition"||jn==="OTransition"?jn+"End":"transitionend";function Nr(r){return typeof r=="string"?document.getElementById(r):r}function Sn(r,o){var d=r.style[o]||r.currentStyle&&r.currentStyle[o];if((!d||d==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(r,null);d=h?h[o]:null}return d==="auto"?null:d}function Oe(r,o,d){var h=document.createElement(r);return h.className=o||"",d&&d.appendChild(h),h}function Ke(r){var o=r.parentNode;o&&o.removeChild(r)}function Un(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function un(r){var o=r.parentNode;o&&o.lastChild!==r&&o.appendChild(r)}function fn(r){var o=r.parentNode;o&&o.firstChild!==r&&o.insertBefore(r,o.firstChild)}function Jn(r,o){if(r.classList!==void 0)return r.classList.contains(o);var d=Nn(r);return d.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(d)}function Te(r,o){if(r.classList!==void 0)for(var d=C(o),h=0,m=d.length;h<m;h++)r.classList.add(d[h]);else if(!Jn(r,o)){var N=Nn(r);Ge(r,(N?N+" ":"")+o)}}function Je(r,o){r.classList!==void 0?r.classList.remove(o):Ge(r,k((" "+Nn(r)+" ").replace(" "+o+" "," ")))}function Ge(r,o){r.className.baseVal===void 0?r.className=o:r.className.baseVal=o}function Nn(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Mt(r,o){"opacity"in r.style?r.style.opacity=o:"filter"in r.style&&ba(r,o)}function ba(r,o){var d=!1,h="DXImageTransform.Microsoft.Alpha";try{d=r.filters.item(h)}catch{if(o===1)return}o=Math.round(o*100),d?(d.Enabled=o!==100,d.Opacity=o):r.style.filter+=" progid:"+h+"(opacity="+o+")"}function oi(r){for(var o=document.documentElement.style,d=0;d<r.length;d++)if(r[d]in o)return r[d];return!1}function Mn(r,o,d){var h=o||new W(0,0);r.style[Qn]=(Pe.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(d?" scale("+d+")":"")}function at(r,o){r._leaflet_pos=o,Pe.any3d?Mn(r,o):(r.style.left=o.x+"px",r.style.top=o.y+"px")}function nt(r){return r._leaflet_pos||new W(0,0)}var vs,xs,Sl;if("onselectstart"in document)vs=function(){Ae(window,"selectstart",Ct)},xs=function(){Xe(window,"selectstart",Ct)};else{var _s=oi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);vs=function(){if(_s){var r=document.documentElement.style;Sl=r[_s],r[_s]="none"}},xs=function(){_s&&(document.documentElement.style[_s]=Sl,Sl=void 0)}}function Nl(){Ae(window,"dragstart",Ct)}function Cl(){Xe(window,"dragstart",Ct)}var Ia,kl;function Pl(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(La(),Ia=r,kl=r.style.outlineStyle,r.style.outlineStyle="none",Ae(window,"keydown",La))}function La(){Ia&&(Ia.style.outlineStyle=kl,Ia=void 0,kl=void 0,Xe(window,"keydown",La))}function Iu(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function bl(r){var o=r.getBoundingClientRect();return{x:o.width/r.offsetWidth||1,y:o.height/r.offsetHeight||1,boundingClientRect:o}}var ay={__proto__:null,TRANSFORM:Qn,TRANSITION:jn,TRANSITION_END:Sr,get:Nr,getStyle:Sn,create:Oe,remove:Ke,empty:Un,toFront:un,toBack:fn,hasClass:Jn,addClass:Te,removeClass:Je,setClass:Ge,getClass:Nn,setOpacity:Mt,testProp:oi,setTransform:Mn,setPosition:at,getPosition:nt,get disableTextSelection(){return vs},get enableTextSelection(){return xs},disableImageDrag:Nl,enableImageDrag:Cl,preventOutline:Pl,restoreOutline:La,getSizedParentNode:Iu,getScale:bl};function Ae(r,o,d,h){if(o&&typeof o=="object")for(var m in o)Ll(r,m,o[m],d);else{o=C(o);for(var N=0,A=o.length;N<A;N++)Ll(r,o[N],d,h)}return this}var On="_leaflet_events";function Xe(r,o,d,h){if(arguments.length===1)Lu(r),delete r[On];else if(o&&typeof o=="object")for(var m in o)El(r,m,o[m],d);else if(o=C(o),arguments.length===2)Lu(r,function(H){return b(o,H)!==-1});else for(var N=0,A=o.length;N<A;N++)El(r,o[N],d,h);return this}function Lu(r,o){for(var d in r[On]){var h=d.split(/\d/)[0];(!o||o(h))&&El(r,h,null,null,d)}}var Il={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ll(r,o,d,h){var m=o+f(d)+(h?"_"+f(h):"");if(r[On]&&r[On][m])return this;var N=function(H){return d.call(h||r,H||window.event)},A=N;!Pe.touchNative&&Pe.pointer&&o.indexOf("touch")===0?N=Qr(r,o,N):Pe.touch&&o==="dblclick"?N=si(r,N):"addEventListener"in r?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?r.addEventListener(Il[o]||o,N,Pe.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(N=function(H){H=H||window.event,Bl(r,H)&&A(H)},r.addEventListener(Il[o],N,!1)):r.addEventListener(o,A,!1):r.attachEvent("on"+o,N),r[On]=r[On]||{},r[On][m]=N}function El(r,o,d,h,m){m=m||o+f(d)+(h?"_"+f(h):"");var N=r[On]&&r[On][m];if(!N)return this;!Pe.touchNative&&Pe.pointer&&o.indexOf("touch")===0?Jr(r,o,N):Pe.touch&&o==="dblclick"?ai(r,N):"removeEventListener"in r?r.removeEventListener(Il[o]||o,N,!1):r.detachEvent("on"+o,N),r[On][m]=null}function li(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function Tl(r){return Ll(r,"wheel",li),this}function ws(r){return Ae(r,"mousedown touchstart dblclick contextmenu",li),r._leaflet_disable_click=!0,this}function Ct(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function ci(r){return Ct(r),li(r),this}function Eu(r){if(r.composedPath)return r.composedPath();for(var o=[],d=r.target;d;)o.push(d),d=d.parentNode;return o}function Tu(r,o){if(!o)return new W(r.clientX,r.clientY);var d=bl(o),h=d.boundingClientRect;return new W((r.clientX-h.left)/d.x-o.clientLeft,(r.clientY-h.top)/d.y-o.clientTop)}var oy=Pe.linux&&Pe.chrome?window.devicePixelRatio:Pe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Bu(r){return Pe.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/oy:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function Bl(r,o){var d=o.relatedTarget;if(!d)return!0;try{for(;d&&d!==r;)d=d.parentNode}catch{return!1}return d!==r}var ly={__proto__:null,on:Ae,off:Xe,stopPropagation:li,disableScrollPropagation:Tl,disableClickPropagation:ws,preventDefault:Ct,stop:ci,getPropagationPath:Eu,getMousePosition:Tu,getWheelDelta:Bu,isExternalTarget:Bl,addListener:Ae,removeListener:Xe},Ru=Ne.extend({run:function(r,o,d,h){this.stop(),this._el=r,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=nt(r),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=D(this._animate,this),this._step()},_step:function(r){var o=+new Date-this._startTime,d=this._duration*1e3;o<d?this._runFrame(this._easeOut(o/d),r):(this._runFrame(1),this._complete())},_runFrame:function(r,o){var d=this._startPos.add(this._offset.multiplyBy(r));o&&d._round(),at(this._el,d),this.fire("step")},_complete:function(){q(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),He=Ne.extend({options:{crs:Nt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,o){o=S(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(ce(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=jn&&Pe.any3d&&!Pe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ae(this._proxy,Sr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,o,d){if(o=o===void 0?this._zoom:this._limitZoom(o),r=this._limitCenter(ce(r),o,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=a({animate:d.animate},d.zoom),d.pan=a({animate:d.animate,duration:d.duration},d.pan));var h=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,o,d.zoom):this._tryAnimatedPan(r,d.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(r,o,d.pan&&d.pan.noMoveStart),this},setZoom:function(r,o){return this._loaded?this.setView(this.getCenter(),r,{zoom:o}):(this._zoom=r,this)},zoomIn:function(r,o){return r=r||(Pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,o)},zoomOut:function(r,o){return r=r||(Pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,o)},setZoomAround:function(r,o,d){var h=this.getZoomScale(o),m=this.getSize().divideBy(2),N=r instanceof W?r:this.latLngToContainerPoint(r),A=N.subtract(m).multiplyBy(1-1/h),H=this.containerPointToLatLng(m.add(A));return this.setView(H,o,{zoom:d})},_getBoundsCenterZoom:function(r,o){o=o||{},r=r.getBounds?r.getBounds():se(r);var d=re(o.paddingTopLeft||o.padding||[0,0]),h=re(o.paddingBottomRight||o.padding||[0,0]),m=this.getBoundsZoom(r,!1,d.add(h));if(m=typeof o.maxZoom=="number"?Math.min(o.maxZoom,m):m,m===1/0)return{center:r.getCenter(),zoom:m};var N=h.subtract(d).divideBy(2),A=this.project(r.getSouthWest(),m),H=this.project(r.getNorthEast(),m),Y=this.unproject(A.add(H).divideBy(2).add(N),m);return{center:Y,zoom:m}},fitBounds:function(r,o){if(r=se(r),!r.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(r,o);return this.setView(d.center,d.zoom,o)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,o){return this.setView(r,this._zoom,{pan:o})},panBy:function(r,o){if(r=re(r).round(),o=o||{},!r.x&&!r.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ru,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){Te(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,d,o.duration||.25,o.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,o,d){if(d=d||{},d.animate===!1||!Pe.any3d)return this.setView(r,o,d);this._stop();var h=this.project(this.getCenter()),m=this.project(r),N=this.getSize(),A=this._zoom;r=ce(r),o=o===void 0?A:o;var H=Math.max(N.x,N.y),Y=H*this.getZoomScale(A,o),le=m.distanceTo(h)||1,_e=1.42,Ee=_e*_e;function De(gt){var $a=gt?-1:1,Ky=gt?Y:H,Qy=Y*Y-H*H+$a*Ee*Ee*le*le,Jy=2*Ky*Ee*le,Hl=Qy/Jy,mf=Math.sqrt(Hl*Hl+1)-Hl,Xy=mf<1e-9?-18:Math.log(mf);return Xy}function Ot(gt){return(Math.exp(gt)-Math.exp(-gt))/2}function wt(gt){return(Math.exp(gt)+Math.exp(-gt))/2}function pn(gt){return Ot(gt)/wt(gt)}var Vt=De(0);function Mi(gt){return H*(wt(Vt)/wt(Vt+_e*gt))}function Vy(gt){return H*(wt(Vt)*pn(Vt+_e*gt)-Ot(Vt))/Ee}function qy(gt){return 1-Math.pow(1-gt,1.5)}var Gy=Date.now(),hf=(De(1)-Vt)/_e,Yy=d.duration?1e3*d.duration:1e3*hf*.8;function pf(){var gt=(Date.now()-Gy)/Yy,$a=qy(gt)*hf;gt<=1?(this._flyToFrame=D(pf,this),this._move(this.unproject(h.add(m.subtract(h).multiplyBy(Vy($a)/le)),A),this.getScaleZoom(H/Mi($a),A),{flyTo:!0})):this._move(r,o)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),pf.call(this),this},flyToBounds:function(r,o){var d=this._getBoundsCenterZoom(r,o);return this.flyTo(d.center,d.zoom,o)},setMaxBounds:function(r){return r=se(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var o=this.options.minZoom;return this.options.minZoom=r,this._loaded&&o!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var o=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&o!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,o){this._enforcingBounds=!0;var d=this.getCenter(),h=this._limitCenter(d,this._zoom,se(r));return d.equals(h)||this.panTo(h,o),this._enforcingBounds=!1,this},panInside:function(r,o){o=o||{};var d=re(o.paddingTopLeft||o.padding||[0,0]),h=re(o.paddingBottomRight||o.padding||[0,0]),m=this.project(this.getCenter()),N=this.project(r),A=this.getPixelBounds(),H=ie([A.min.add(d),A.max.subtract(h)]),Y=H.getSize();if(!H.contains(N)){this._enforcingBounds=!0;var le=N.subtract(H.getCenter()),_e=H.extend(N).getSize().subtract(Y);m.x+=le.x<0?-_e.x:_e.x,m.y+=le.y<0?-_e.y:_e.y,this.panTo(this.unproject(m),o),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=a({animate:!1,pan:!0},r===!0?{animate:!0}:r);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),h=o.divideBy(2).round(),m=d.divideBy(2).round(),N=h.subtract(m);return!N.x&&!N.y?this:(r.animate&&r.pan?this.panBy(N):(r.pan&&this._rawPanBy(N),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=a({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=c(this._handleGeolocationResponse,this),d=c(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,d,r):navigator.geolocation.getCurrentPosition(o,d,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var o=r.code,d=r.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var o=r.coords.latitude,d=r.coords.longitude,h=new ne(o,d),m=h.toBounds(r.coords.accuracy*2),N=this._locateOptions;if(N.setView){var A=this.getBoundsZoom(m);this.setView(h,N.maxZoom?Math.min(A,N.maxZoom):A)}var H={latlng:h,bounds:m,timestamp:r.timestamp};for(var Y in r.coords)typeof r.coords[Y]=="number"&&(H[Y]=r.coords[Y]);this.fire("locationfound",H)}},addHandler:function(r,o){if(!o)return this;var d=this[r]=new o(this);return this._handlers.push(d),this.options[r]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ke(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(q(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)Ke(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,o){var d="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),h=Oe("div",d,o||this._mapPane);return r&&(this._panes[r]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),o=this.unproject(r.getBottomLeft()),d=this.unproject(r.getTopRight());return new Z(o,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,o,d){r=se(r),d=re(d||[0,0]);var h=this.getZoom()||0,m=this.getMinZoom(),N=this.getMaxZoom(),A=r.getNorthWest(),H=r.getSouthEast(),Y=this.getSize().subtract(d),le=ie(this.project(H,h),this.project(A,h)).getSize(),_e=Pe.any3d?this.options.zoomSnap:1,Ee=Y.x/le.x,De=Y.y/le.y,Ot=o?Math.max(Ee,De):Math.min(Ee,De);return h=this.getScaleZoom(Ot,h),_e&&(h=Math.round(h/(_e/100))*(_e/100),h=o?Math.ceil(h/_e)*_e:Math.floor(h/_e)*_e),Math.max(m,Math.min(N,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,o){var d=this._getTopLeftPoint(r,o);return new U(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,o){var d=this.options.crs;return o=o===void 0?this._zoom:o,d.scale(r)/d.scale(o)},getScaleZoom:function(r,o){var d=this.options.crs;o=o===void 0?this._zoom:o;var h=d.zoom(r*d.scale(o));return isNaN(h)?1/0:h},project:function(r,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(ce(r),o)},unproject:function(r,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(re(r),o)},layerPointToLatLng:function(r){var o=re(r).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(r){var o=this.project(ce(r))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(ce(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(se(r))},distance:function(r,o){return this.options.crs.distance(ce(r),ce(o))},containerPointToLayerPoint:function(r){return re(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return re(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var o=this.containerPointToLayerPoint(re(r));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ce(r)))},mouseEventToContainerPoint:function(r){return Tu(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var o=this._container=Nr(r);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ae(o,"scroll",this._onScroll,this),this._containerId=f(o)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pe.any3d,Te(r,"leaflet-container"+(Pe.touch?" leaflet-touch":"")+(Pe.retina?" leaflet-retina":"")+(Pe.ielt9?" leaflet-oldie":"")+(Pe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=Sn(r,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),at(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Te(r.markerPane,"leaflet-zoom-hide"),Te(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,o,d){at(this._mapPane,new W(0,0));var h=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var m=this._zoom!==o;this._moveStart(m,d)._move(r,o)._moveEnd(m),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(r,o){return r&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(r,o,d,h){o===void 0&&(o=this._zoom);var m=this._zoom!==o;return this._zoom=o,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),h?d&&d.pinch&&this.fire("zoom",d):((m||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return q(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){at(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[f(this._container)]=this;var o=r?Xe:Ae;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),Pe.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){q(this._resizeRequest),this._resizeRequest=D(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,o){for(var d=[],h,m=o==="mouseout"||o==="mouseover",N=r.target||r.srcElement,A=!1;N;){if(h=this._targets[f(N)],h&&(o==="click"||o==="preclick")&&this._draggableMoved(h)){A=!0;break}if(h&&h.listens(o,!0)&&(m&&!Bl(N,r)||(d.push(h),m))||N===this._container)break;N=N.parentNode}return!d.length&&!A&&!m&&this.listens(o,!0)&&(d=[this]),d},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var o=r.target||r.srcElement;if(!(!this._loaded||o._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(o))){var d=r.type;d==="mousedown"&&Pl(o),this._fireDOMEvent(r,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,o,d){if(r.type==="click"){var h=a({},r);h.type="preclick",this._fireDOMEvent(h,h.type,d)}var m=this._findEventTargets(r,o);if(d){for(var N=[],A=0;A<d.length;A++)d[A].listens(o,!0)&&N.push(d[A]);m=N.concat(m)}if(m.length){o==="contextmenu"&&Ct(r);var H=m[0],Y={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var le=H.getLatLng&&(!H._radius||H._radius<=10);Y.containerPoint=le?this.latLngToContainerPoint(H.getLatLng()):this.mouseEventToContainerPoint(r),Y.layerPoint=this.containerPointToLayerPoint(Y.containerPoint),Y.latlng=le?H.getLatLng():this.layerPointToLatLng(Y.layerPoint)}for(A=0;A<m.length;A++)if(m[A].fire(o,Y,!0),Y.originalEvent._stopped||m[A].options.bubblingMouseEvents===!1&&b(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,o=this._handlers.length;r<o;r++)this._handlers[r].disable()},whenReady:function(r,o){return this._loaded?r.call(o||this,{target:this}):this.on("load",r,o),this},_getMapPanePos:function(){return nt(this._mapPane)||new W(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,o){var d=r&&o!==void 0?this._getNewPixelOrigin(r,o):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,o){var d=this.getSize()._divideBy(2);return this.project(r,o)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,o,d){var h=this._getNewPixelOrigin(d,o);return this.project(r,o)._subtract(h)},_latLngBoundsToNewLayerBounds:function(r,o,d){var h=this._getNewPixelOrigin(d,o);return ie([this.project(r.getSouthWest(),o)._subtract(h),this.project(r.getNorthWest(),o)._subtract(h),this.project(r.getSouthEast(),o)._subtract(h),this.project(r.getNorthEast(),o)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,o,d){if(!d)return r;var h=this.project(r,o),m=this.getSize().divideBy(2),N=new U(h.subtract(m),h.add(m)),A=this._getBoundsOffset(N,d,o);return Math.abs(A.x)<=1&&Math.abs(A.y)<=1?r:this.unproject(h.add(A),o)},_limitOffset:function(r,o){if(!o)return r;var d=this.getPixelBounds(),h=new U(d.min.add(r),d.max.add(r));return r.add(this._getBoundsOffset(h,o))},_getBoundsOffset:function(r,o,d){var h=ie(this.project(o.getNorthEast(),d),this.project(o.getSouthWest(),d)),m=h.min.subtract(r.min),N=h.max.subtract(r.max),A=this._rebound(m.x,-N.x),H=this._rebound(m.y,-N.y);return new W(A,H)},_rebound:function(r,o){return r+o>0?Math.round(r-o)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(o))},_limitZoom:function(r){var o=this.getMinZoom(),d=this.getMaxZoom(),h=Pe.any3d?this.options.zoomSnap:1;return h&&(r=Math.round(r/h)*h),Math.max(o,Math.min(d,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Je(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,o){var d=this._getCenterOffset(r)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,o),!0)},_createAnimProxy:function(){var r=this._proxy=Oe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(o){var d=Qn,h=this._proxy.style[d];Mn(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),h===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ke(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),o=this.getZoom();Mn(this._proxy,this.project(r,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,o,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(o),m=this._getCenterOffset(r)._divideBy(1-1/h);return d.animate!==!0&&!this.getSize().contains(m)?!1:(D(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(r,o,!0)},this),!0)},_animateZoom:function(r,o,d,h){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=o,Te(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:o,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Je(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function cy(r,o){return new He(r,o)}var Cn=G.extend({options:{position:"topright"},initialize:function(r){S(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var o=this._map;return o&&o.removeControl(this),this.options.position=r,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var o=this._container=this.onAdd(r),d=this.getPosition(),h=r._controlCorners[d];return Te(o,"leaflet-control"),d.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ke(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),js=function(r){return new Cn(r)};He.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},o="leaflet-",d=this._controlContainer=Oe("div",o+"control-container",this._container);function h(m,N){var A=o+m+" "+o+N;r[m+N]=Oe("div",A,d)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)Ke(this._controlCorners[r]);Ke(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Au=Cn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,o,d,h){return d<h?-1:h<d?1:0}},initialize:function(r,o,d){S(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in r)this._addLayer(r[h],h);for(h in o)this._addLayer(o[h],h,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return Cn.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,o){return this._addLayer(r,o),this._map?this._update():this},addOverlay:function(r,o){return this._addLayer(r,o,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var o=this._getLayer(f(r));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){Te(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Te(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Je(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Je(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",o=this._container=Oe("div",r),d=this.options.collapsed;o.setAttribute("aria-haspopup",!0),ws(o),Tl(o);var h=this._section=Oe("section",r+"-list");d&&(this._map.on("click",this.collapse,this),Ae(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var m=this._layersLink=Oe("a",r+"-toggle",o);m.href="#",m.title="Layers",m.setAttribute("role","button"),Ae(m,{keydown:function(N){N.keyCode===13&&this._expandSafely()},click:function(N){Ct(N),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=Oe("div",r+"-base",h),this._separator=Oe("div",r+"-separator",h),this._overlaysList=Oe("div",r+"-overlays",h),o.appendChild(h)},_getLayer:function(r){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&f(this._layers[o].layer)===r)return this._layers[o]},_addLayer:function(r,o,d){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:o,overlay:d}),this.options.sortLayers&&this._layers.sort(c(function(h,m){return this.options.sortFunction(h.layer,m.layer,h.name,m.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Un(this._baseLayersList),Un(this._overlaysList),this._layerControlInputs=[];var r,o,d,h,m=0;for(d=0;d<this._layers.length;d++)h=this._layers[d],this._addItem(h),o=o||h.overlay,r=r||!h.overlay,m+=h.overlay?0:1;return this.options.hideSingleBase&&(r=r&&m>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=o&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var o=this._getLayer(f(r.target)),d=o.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;d&&this._map.fire(d,o)},_createRadioElement:function(r,o){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(o?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=d,h.firstChild},_addItem:function(r){var o=document.createElement("label"),d=this._map.hasLayer(r.layer),h;r.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=d):h=this._createRadioElement("leaflet-base-layers_"+f(this),d),this._layerControlInputs.push(h),h.layerId=f(r.layer),Ae(h,"click",this._onInputClick,this);var m=document.createElement("span");m.innerHTML=" "+r.name;var N=document.createElement("span");o.appendChild(N),N.appendChild(h),N.appendChild(m);var A=r.overlay?this._overlaysList:this._baseLayersList;return A.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,o,d,h=[],m=[];this._handlingClick=!0;for(var N=r.length-1;N>=0;N--)o=r[N],d=this._getLayer(o.layerId).layer,o.checked?h.push(d):o.checked||m.push(d);for(N=0;N<m.length;N++)this._map.hasLayer(m[N])&&this._map.removeLayer(m[N]);for(N=0;N<h.length;N++)this._map.hasLayer(h[N])||this._map.addLayer(h[N]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,o,d,h=this._map.getZoom(),m=r.length-1;m>=0;m--)o=r[m],d=this._getLayer(o.layerId).layer,o.disabled=d.options.minZoom!==void 0&&h<d.options.minZoom||d.options.maxZoom!==void 0&&h>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Ae(r,"click",Ct),this.expand();var o=this;setTimeout(function(){Xe(r,"click",Ct),o._preventClick=!1})}}),dy=function(r,o,d){return new Au(r,o,d)},Rl=Cn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var o="leaflet-control-zoom",d=Oe("div",o+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,o+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,o+"-out",d,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,o,d,h,m){var N=Oe("a",d,h);return N.innerHTML=r,N.href="#",N.title=o,N.setAttribute("role","button"),N.setAttribute("aria-label",o),ws(N),Ae(N,"click",ci),Ae(N,"click",m,this),Ae(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var r=this._map,o="leaflet-disabled";Je(this._zoomInButton,o),Je(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(Te(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(Te(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});He.mergeOptions({zoomControl:!0}),He.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Rl,this.addControl(this.zoomControl))});var uy=function(r){return new Rl(r)},Fu=Cn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var o="leaflet-control-scale",d=Oe("div",o),h=this.options;return this._addScales(h,o+"-line",d),r.on(h.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),d},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,o,d){r.metric&&(this._mScale=Oe("div",o,d)),r.imperial&&(this._iScale=Oe("div",o,d))},_update:function(){var r=this._map,o=r.getSize().y/2,d=r.distance(r.containerPointToLatLng([0,o]),r.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(d)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var o=this._getRoundNum(r),d=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,d,o/r)},_updateImperial:function(r){var o=r*3.2808399,d,h,m;o>5280?(d=o/5280,h=this._getRoundNum(d),this._updateScale(this._iScale,h+" mi",h/d)):(m=this._getRoundNum(o),this._updateScale(this._iScale,m+" ft",m/o))},_updateScale:function(r,o,d){r.style.width=Math.round(this.options.maxWidth*d)+"px",r.innerHTML=o},_getRoundNum:function(r){var o=Math.pow(10,(Math.floor(r)+"").length-1),d=r/o;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,o*d}}),fy=function(r){return new Fu(r)},hy='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Al=Cn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pe.inlineSvg?hy+" ":"")+"Leaflet</a>"},initialize:function(r){S(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Oe("div","leaflet-control-attribution"),ws(this._container);for(var o in r._layers)r._layers[o].getAttribution&&this.addAttribution(r._layers[o].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var o in this._attributions)this._attributions[o]&&r.push(o);var d=[];this.options.prefix&&d.push(this.options.prefix),r.length&&d.push(r.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});He.mergeOptions({attributionControl:!0}),He.addInitHook(function(){this.options.attributionControl&&new Al().addTo(this)});var py=function(r){return new Al(r)};Cn.Layers=Au,Cn.Zoom=Rl,Cn.Scale=Fu,Cn.Attribution=Al,js.layers=dy,js.zoom=uy,js.scale=fy,js.attribution=py;var Dn=G.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Dn.addTo=function(r,o){return r.addHandler(o,this),this};var my={Events:oe},Uu=Pe.touch?"touchstart mousedown":"mousedown",Cr=Ne.extend({options:{clickTolerance:3},initialize:function(r,o,d,h){S(this,h),this._element=r,this._dragStartTarget=o||r,this._preventOutline=d},enable:function(){this._enabled||(Ae(this._dragStartTarget,Uu,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Cr._dragging===this&&this.finishDrag(!0),Xe(this._dragStartTarget,Uu,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!Jn(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){Cr._dragging===this&&this.finishDrag();return}if(!(Cr._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(Cr._dragging=this,this._preventOutline&&Pl(this._element),Nl(),vs(),!this._moving)){this.fire("down");var o=r.touches?r.touches[0]:r,d=Iu(this._element);this._startPoint=new W(o.clientX,o.clientY),this._startPos=nt(this._element),this._parentScale=bl(d);var h=r.type==="mousedown";Ae(document,h?"mousemove":"touchmove",this._onMove,this),Ae(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var o=r.touches&&r.touches.length===1?r.touches[0]:r,d=new W(o.clientX,o.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Ct(r),this._moved||(this.fire("dragstart"),this._moved=!0,Te(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Te(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),at(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){Je(document.body,"leaflet-dragging"),this._lastTarget&&(Je(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Xe(document,"mousemove touchmove",this._onMove,this),Xe(document,"mouseup touchend touchcancel",this._onUp,this),Cl(),xs();var o=this._moved&&this._moving;this._moving=!1,Cr._dragging=!1,o&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function Mu(r,o,d){var h,m=[1,4,2,8],N,A,H,Y,le,_e,Ee,De;for(N=0,_e=r.length;N<_e;N++)r[N]._code=di(r[N],o);for(H=0;H<4;H++){for(Ee=m[H],h=[],N=0,_e=r.length,A=_e-1;N<_e;A=N++)Y=r[N],le=r[A],Y._code&Ee?le._code&Ee||(De=Ea(le,Y,Ee,o,d),De._code=di(De,o),h.push(De)):(le._code&Ee&&(De=Ea(le,Y,Ee,o,d),De._code=di(De,o),h.push(De)),h.push(Y));r=h}return r}function Ou(r,o){var d,h,m,N,A,H,Y,le,_e;if(!r||r.length===0)throw new Error("latlngs not passed");hn(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Ee=ce([0,0]),De=se(r),Ot=De.getNorthWest().distanceTo(De.getSouthWest())*De.getNorthEast().distanceTo(De.getNorthWest());Ot<1700&&(Ee=Fl(r));var wt=r.length,pn=[];for(d=0;d<wt;d++){var Vt=ce(r[d]);pn.push(o.project(ce([Vt.lat-Ee.lat,Vt.lng-Ee.lng])))}for(H=Y=le=0,d=0,h=wt-1;d<wt;h=d++)m=pn[d],N=pn[h],A=m.y*N.x-N.y*m.x,Y+=(m.x+N.x)*A,le+=(m.y+N.y)*A,H+=A*3;H===0?_e=pn[0]:_e=[Y/H,le/H];var Mi=o.unproject(re(_e));return ce([Mi.lat+Ee.lat,Mi.lng+Ee.lng])}function Fl(r){for(var o=0,d=0,h=0,m=0;m<r.length;m++){var N=ce(r[m]);o+=N.lat,d+=N.lng,h++}return ce([o/h,d/h])}var gy={__proto__:null,clipPolygon:Mu,polygonCenter:Ou,centroid:Fl};function Du(r,o){if(!o||!r.length)return r.slice();var d=o*o;return r=xy(r,d),r=vy(r,d),r}function zu(r,o,d){return Math.sqrt(Ss(r,o,d,!0))}function yy(r,o,d){return Ss(r,o,d)}function vy(r,o){var d=r.length,h=typeof Uint8Array<"u"?Uint8Array:Array,m=new h(d);m[0]=m[d-1]=1,Ul(r,m,o,0,d-1);var N,A=[];for(N=0;N<d;N++)m[N]&&A.push(r[N]);return A}function Ul(r,o,d,h,m){var N=0,A,H,Y;for(H=h+1;H<=m-1;H++)Y=Ss(r[H],r[h],r[m],!0),Y>N&&(A=H,N=Y);N>d&&(o[A]=1,Ul(r,o,d,h,A),Ul(r,o,d,A,m))}function xy(r,o){for(var d=[r[0]],h=1,m=0,N=r.length;h<N;h++)_y(r[h],r[m])>o&&(d.push(r[h]),m=h);return m<N-1&&d.push(r[N-1]),d}var $u;function Wu(r,o,d,h,m){var N=h?$u:di(r,d),A=di(o,d),H,Y,le;for($u=A;;){if(!(N|A))return[r,o];if(N&A)return!1;H=N||A,Y=Ea(r,o,H,d,m),le=di(Y,d),H===N?(r=Y,N=le):(o=Y,A=le)}}function Ea(r,o,d,h,m){var N=o.x-r.x,A=o.y-r.y,H=h.min,Y=h.max,le,_e;return d&8?(le=r.x+N*(Y.y-r.y)/A,_e=Y.y):d&4?(le=r.x+N*(H.y-r.y)/A,_e=H.y):d&2?(le=Y.x,_e=r.y+A*(Y.x-r.x)/N):d&1&&(le=H.x,_e=r.y+A*(H.x-r.x)/N),new W(le,_e,m)}function di(r,o){var d=0;return r.x<o.min.x?d|=1:r.x>o.max.x&&(d|=2),r.y<o.min.y?d|=4:r.y>o.max.y&&(d|=8),d}function _y(r,o){var d=o.x-r.x,h=o.y-r.y;return d*d+h*h}function Ss(r,o,d,h){var m=o.x,N=o.y,A=d.x-m,H=d.y-N,Y=A*A+H*H,le;return Y>0&&(le=((r.x-m)*A+(r.y-N)*H)/Y,le>1?(m=d.x,N=d.y):le>0&&(m+=A*le,N+=H*le)),A=r.x-m,H=r.y-N,h?A*A+H*H:new W(m,N)}function hn(r){return!w(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function Hu(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),hn(r)}function Zu(r,o){var d,h,m,N,A,H,Y,le;if(!r||r.length===0)throw new Error("latlngs not passed");hn(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var _e=ce([0,0]),Ee=se(r),De=Ee.getNorthWest().distanceTo(Ee.getSouthWest())*Ee.getNorthEast().distanceTo(Ee.getNorthWest());De<1700&&(_e=Fl(r));var Ot=r.length,wt=[];for(d=0;d<Ot;d++){var pn=ce(r[d]);wt.push(o.project(ce([pn.lat-_e.lat,pn.lng-_e.lng])))}for(d=0,h=0;d<Ot-1;d++)h+=wt[d].distanceTo(wt[d+1])/2;if(h===0)le=wt[0];else for(d=0,N=0;d<Ot-1;d++)if(A=wt[d],H=wt[d+1],m=A.distanceTo(H),N+=m,N>h){Y=(N-h)/m,le=[H.x-Y*(H.x-A.x),H.y-Y*(H.y-A.y)];break}var Vt=o.unproject(re(le));return ce([Vt.lat+_e.lat,Vt.lng+_e.lng])}var wy={__proto__:null,simplify:Du,pointToSegmentDistance:zu,closestPointOnSegment:yy,clipSegment:Wu,_getEdgeIntersection:Ea,_getBitCode:di,_sqClosestPointOnSegment:Ss,isFlat:hn,_flat:Hu,polylineCenter:Zu},Ml={project:function(r){return new W(r.lng,r.lat)},unproject:function(r){return new ne(r.y,r.x)},bounds:new U([-180,-90],[180,90])},Ol={R:6378137,R_MINOR:6356752314245179e-9,bounds:new U([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var o=Math.PI/180,d=this.R,h=r.lat*o,m=this.R_MINOR/d,N=Math.sqrt(1-m*m),A=N*Math.sin(h),H=Math.tan(Math.PI/4-h/2)/Math.pow((1-A)/(1+A),N/2);return h=-d*Math.log(Math.max(H,1e-10)),new W(r.lng*o*d,h)},unproject:function(r){for(var o=180/Math.PI,d=this.R,h=this.R_MINOR/d,m=Math.sqrt(1-h*h),N=Math.exp(-r.y/d),A=Math.PI/2-2*Math.atan(N),H=0,Y=.1,le;H<15&&Math.abs(Y)>1e-7;H++)le=m*Math.sin(A),le=Math.pow((1-le)/(1+le),m/2),Y=Math.PI/2-2*Math.atan(N*le)-A,A+=Y;return new ne(A*o,r.x*o/d)}},jy={__proto__:null,LonLat:Ml,Mercator:Ol,SphericalMercator:Ve},Sy=a({},we,{code:"EPSG:3395",projection:Ol,transformation:function(){var r=.5/(Math.PI*Ol.R);return qe(r,.5,-r,.5)}()}),Vu=a({},we,{code:"EPSG:4326",projection:Ml,transformation:qe(1/180,1,-1/180,.5)}),Ny=a({},ke,{projection:Ml,transformation:qe(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,o){var d=o.lng-r.lng,h=o.lat-r.lat;return Math.sqrt(d*d+h*h)},infinite:!0});ke.Earth=we,ke.EPSG3395=Sy,ke.EPSG3857=Nt,ke.EPSG900913=ge,ke.EPSG4326=Vu,ke.Simple=Ny;var kn=Ne.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[f(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[f(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var o=r.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var d=this.getEvents();o.on(d,this),this.once("remove",function(){o.off(d,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});He.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var o=f(r);return this._layers[o]?this:(this._layers[o]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var o=f(r);return this._layers[o]?(this._loaded&&r.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return f(r)in this._layers},eachLayer:function(r,o){for(var d in this._layers)r.call(o,this._layers[d]);return this},_addLayers:function(r){r=r?w(r)?r:[r]:[];for(var o=0,d=r.length;o<d;o++)this.addLayer(r[o])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[f(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var o=f(r);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,o=-1/0,d=this._getZoomSpan();for(var h in this._zoomBoundLayers){var m=this._zoomBoundLayers[h].options;r=m.minZoom===void 0?r:Math.min(r,m.minZoom),o=m.maxZoom===void 0?o:Math.max(o,m.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=r===1/0?void 0:r,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Bi=kn.extend({initialize:function(r,o){S(this,o),this._layers={};var d,h;if(r)for(d=0,h=r.length;d<h;d++)this.addLayer(r[d])},addLayer:function(r){var o=this.getLayerId(r);return this._layers[o]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var o=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(r){var o=typeof r=="number"?r:this.getLayerId(r);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var o=Array.prototype.slice.call(arguments,1),d,h;for(d in this._layers)h=this._layers[d],h[r]&&h[r].apply(h,o);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,o){for(var d in this._layers)r.call(o,this._layers[d]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return f(r)}}),Cy=function(r,o){return new Bi(r,o)},Xn=Bi.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),Bi.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),Bi.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Z;for(var o in this._layers){var d=this._layers[o];r.extend(d.getBounds?d.getBounds():d.getLatLng())}return r}}),ky=function(r,o){return new Xn(r,o)},Ri=G.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){S(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,o){var d=this._getIconUrl(r);if(!d){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(d,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(h,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(r,o){var d=this.options,h=d[o+"Size"];typeof h=="number"&&(h=[h,h]);var m=re(h),N=re(o==="shadow"&&d.shadowAnchor||d.iconAnchor||m&&m.divideBy(2,!0));r.className="leaflet-marker-"+o+" "+(d.className||""),N&&(r.style.marginLeft=-N.x+"px",r.style.marginTop=-N.y+"px"),m&&(r.style.width=m.x+"px",r.style.height=m.y+"px")},_createImg:function(r,o){return o=o||document.createElement("img"),o.src=r,o},_getIconUrl:function(r){return Pe.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Py(r){return new Ri(r)}var Ns=Ri.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof Ns.imagePath!="string"&&(Ns.imagePath=this._detectIconPath()),(this.options.imagePath||Ns.imagePath)+Ri.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var o=function(d,h,m){var N=h.exec(d);return N&&N[m]};return r=o(r,/^url\((['"])?(.+)\1\)$/,2),r&&o(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Oe("div","leaflet-default-icon-path",document.body),o=Sn(r,"background-image")||Sn(r,"backgroundImage");if(document.body.removeChild(r),o=this._stripUrl(o),o)return o;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),qu=Dn.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Cr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Te(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Je(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var o=this._marker,d=o._map,h=this._marker.options.autoPanSpeed,m=this._marker.options.autoPanPadding,N=nt(o._icon),A=d.getPixelBounds(),H=d.getPixelOrigin(),Y=ie(A.min._subtract(H).add(m),A.max._subtract(H).subtract(m));if(!Y.contains(N)){var le=re((Math.max(Y.max.x,N.x)-Y.max.x)/(A.max.x-Y.max.x)-(Math.min(Y.min.x,N.x)-Y.min.x)/(A.min.x-Y.min.x),(Math.max(Y.max.y,N.y)-Y.max.y)/(A.max.y-Y.max.y)-(Math.min(Y.min.y,N.y)-Y.min.y)/(A.min.y-Y.min.y)).multiplyBy(h);d.panBy(le,{animate:!1}),this._draggable._newPos._add(le),this._draggable._startPos._add(le),at(o._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=D(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(q(this._panRequest),this._panRequest=D(this._adjustPan.bind(this,r)))},_onDrag:function(r){var o=this._marker,d=o._shadow,h=nt(o._icon),m=o._map.layerPointToLatLng(h);d&&at(d,h),o._latlng=m,r.latlng=m,r.oldLatLng=this._oldLatLng,o.fire("move",r).fire("drag",r)},_onDragEnd:function(r){q(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),Ta=kn.extend({options:{icon:new Ns,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,o){S(this,o),this._latlng=ce(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var o=this._latlng;return this._latlng=ce(r),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=r.icon.createIcon(this._icon),h=!1;d!==this._icon&&(this._icon&&this._removeIcon(),h=!0,r.title&&(d.title=r.title),d.tagName==="IMG"&&(d.alt=r.alt||"")),Te(d,o),r.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ae(d,"focus",this._panOnFocus,this);var m=r.icon.createShadow(this._shadow),N=!1;m!==this._shadow&&(this._removeShadow(),N=!0),m&&(Te(m,o),m.alt=""),this._shadow=m,r.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),m&&N&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(this._icon,"focus",this._panOnFocus,this),Ke(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ke(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&at(this._icon,r),this._shadow&&at(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var o=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(Te(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),qu)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new qu(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Mt(this._icon,r),this._shadow&&Mt(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var o=this.options.icon.options,d=o.iconSize?re(o.iconSize):re(0,0),h=o.iconAnchor?re(o.iconAnchor):re(0,0);r.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:d.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function by(r,o){return new Ta(r,o)}var kr=kn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return S(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ba=kr.extend({options:{fill:!0,radius:10},initialize:function(r,o){S(this,o),this._latlng=ce(r),this._radius=this.options.radius},setLatLng:function(r){var o=this._latlng;return this._latlng=ce(r),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var o=r&&r.radius||this._radius;return kr.prototype.setStyle.call(this,r),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,o=this._radiusY||r,d=this._clickTolerance(),h=[r+d,o+d];this._pxBounds=new U(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Iy(r,o){return new Ba(r,o)}var Dl=Ba.extend({initialize:function(r,o,d){if(typeof o=="number"&&(o=a({},d,{radius:o})),S(this,o),this._latlng=ce(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Z(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:kr.prototype.setStyle,_project:function(){var r=this._latlng.lng,o=this._latlng.lat,d=this._map,h=d.options.crs;if(h.distance===we.distance){var m=Math.PI/180,N=this._mRadius/we.R/m,A=d.project([o+N,r]),H=d.project([o-N,r]),Y=A.add(H).divideBy(2),le=d.unproject(Y).lat,_e=Math.acos((Math.cos(N*m)-Math.sin(o*m)*Math.sin(le*m))/(Math.cos(o*m)*Math.cos(le*m)))/m;(isNaN(_e)||_e===0)&&(_e=N/Math.cos(Math.PI/180*o)),this._point=Y.subtract(d.getPixelOrigin()),this._radius=isNaN(_e)?0:Y.x-d.project([le,r-_e]).x,this._radiusY=Y.y-A.y}else{var Ee=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(Ee).x}this._updateBounds()}});function Ly(r,o,d){return new Dl(r,o,d)}var er=kr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,o){S(this,o),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var o=1/0,d=null,h=Ss,m,N,A=0,H=this._parts.length;A<H;A++)for(var Y=this._parts[A],le=1,_e=Y.length;le<_e;le++){m=Y[le-1],N=Y[le];var Ee=h(r,m,N,!0);Ee<o&&(o=Ee,d=h(r,m,N))}return d&&(d.distance=Math.sqrt(o)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,o){return o=o||this._defaultShape(),r=ce(r),o.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Z,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return hn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var o=[],d=hn(r),h=0,m=r.length;h<m;h++)d?(o[h]=ce(r[h]),this._bounds.extend(o[h])):o[h]=this._convertLatLngs(r[h]);return o},_project:function(){var r=new U;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),o=new W(r,r);this._rawPxBounds&&(this._pxBounds=new U([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(r,o,d){var h=r[0]instanceof ne,m=r.length,N,A;if(h){for(A=[],N=0;N<m;N++)A[N]=this._map.latLngToLayerPoint(r[N]),d.extend(A[N]);o.push(A)}else for(N=0;N<m;N++)this._projectLatlngs(r[N],o,d)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,d,h,m,N,A,H,Y;for(d=0,m=0,N=this._rings.length;d<N;d++)for(Y=this._rings[d],h=0,A=Y.length;h<A-1;h++)H=Wu(Y[h],Y[h+1],r,h,!0),H&&(o[m]=o[m]||[],o[m].push(H[0]),(H[1]!==Y[h+1]||h===A-2)&&(o[m].push(H[1]),m++))}},_simplifyPoints:function(){for(var r=this._parts,o=this.options.smoothFactor,d=0,h=r.length;d<h;d++)r[d]=Du(r[d],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,o){var d,h,m,N,A,H,Y=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(d=0,N=this._parts.length;d<N;d++)for(H=this._parts[d],h=0,A=H.length,m=A-1;h<A;m=h++)if(!(!o&&h===0)&&zu(r,H[m],H[h])<=Y)return!0;return!1}});function Ey(r,o){return new er(r,o)}er._flat=Hu;var Ai=er.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ou(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var o=er.prototype._convertLatLngs.call(this,r),d=o.length;return d>=2&&o[0]instanceof ne&&o[0].equals(o[d-1])&&o.pop(),o},_setLatLngs:function(r){er.prototype._setLatLngs.call(this,r),hn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return hn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,o=this.options.weight,d=new W(o,o);if(r=new U(r.min.subtract(d),r.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,m=this._rings.length,N;h<m;h++)N=Mu(this._rings[h],r,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var o=!1,d,h,m,N,A,H,Y,le;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(N=0,Y=this._parts.length;N<Y;N++)for(d=this._parts[N],A=0,le=d.length,H=le-1;A<le;H=A++)h=d[A],m=d[H],h.y>r.y!=m.y>r.y&&r.x<(m.x-h.x)*(r.y-h.y)/(m.y-h.y)+h.x&&(o=!o);return o||er.prototype._containsPoint.call(this,r,!0)}});function Ty(r,o){return new Ai(r,o)}var tr=Xn.extend({initialize:function(r,o){S(this,o),this._layers={},r&&this.addData(r)},addData:function(r){var o=w(r)?r:r.features,d,h,m;if(o){for(d=0,h=o.length;d<h;d++)m=o[d],(m.geometries||m.geometry||m.features||m.coordinates)&&this.addData(m);return this}var N=this.options;if(N.filter&&!N.filter(r))return this;var A=Ra(r,N);return A?(A.feature=Ua(r),A.defaultOptions=A.options,this.resetStyle(A),N.onEachFeature&&N.onEachFeature(r,A),this.addLayer(A)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=a({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(o){this._setLayerStyle(o,r)},this)},_setLayerStyle:function(r,o){r.setStyle&&(typeof o=="function"&&(o=o(r.feature)),r.setStyle(o))}});function Ra(r,o){var d=r.type==="Feature"?r.geometry:r,h=d?d.coordinates:null,m=[],N=o&&o.pointToLayer,A=o&&o.coordsToLatLng||zl,H,Y,le,_e;if(!h&&!d)return null;switch(d.type){case"Point":return H=A(h),Gu(N,r,H,o);case"MultiPoint":for(le=0,_e=h.length;le<_e;le++)H=A(h[le]),m.push(Gu(N,r,H,o));return new Xn(m);case"LineString":case"MultiLineString":return Y=Aa(h,d.type==="LineString"?0:1,A),new er(Y,o);case"Polygon":case"MultiPolygon":return Y=Aa(h,d.type==="Polygon"?1:2,A),new Ai(Y,o);case"GeometryCollection":for(le=0,_e=d.geometries.length;le<_e;le++){var Ee=Ra({geometry:d.geometries[le],type:"Feature",properties:r.properties},o);Ee&&m.push(Ee)}return new Xn(m);case"FeatureCollection":for(le=0,_e=d.features.length;le<_e;le++){var De=Ra(d.features[le],o);De&&m.push(De)}return new Xn(m);default:throw new Error("Invalid GeoJSON object.")}}function Gu(r,o,d,h){return r?r(o,d):new Ta(d,h&&h.markersInheritOptions&&h)}function zl(r){return new ne(r[1],r[0],r[2])}function Aa(r,o,d){for(var h=[],m=0,N=r.length,A;m<N;m++)A=o?Aa(r[m],o-1,d):(d||zl)(r[m]),h.push(A);return h}function $l(r,o){return r=ce(r),r.alt!==void 0?[j(r.lng,o),j(r.lat,o),j(r.alt,o)]:[j(r.lng,o),j(r.lat,o)]}function Fa(r,o,d,h){for(var m=[],N=0,A=r.length;N<A;N++)m.push(o?Fa(r[N],hn(r[N])?0:o-1,d,h):$l(r[N],h));return!o&&d&&m.length>0&&m.push(m[0].slice()),m}function Fi(r,o){return r.feature?a({},r.feature,{geometry:o}):Ua(o)}function Ua(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Wl={toGeoJSON:function(r){return Fi(this,{type:"Point",coordinates:$l(this.getLatLng(),r)})}};Ta.include(Wl),Dl.include(Wl),Ba.include(Wl),er.include({toGeoJSON:function(r){var o=!hn(this._latlngs),d=Fa(this._latlngs,o?1:0,!1,r);return Fi(this,{type:(o?"Multi":"")+"LineString",coordinates:d})}}),Ai.include({toGeoJSON:function(r){var o=!hn(this._latlngs),d=o&&!hn(this._latlngs[0]),h=Fa(this._latlngs,d?2:o?1:0,!0,r);return o||(h=[h]),Fi(this,{type:(d?"Multi":"")+"Polygon",coordinates:h})}}),Bi.include({toMultiPoint:function(r){var o=[];return this.eachLayer(function(d){o.push(d.toGeoJSON(r).geometry.coordinates)}),Fi(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(r){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(r);var d=o==="GeometryCollection",h=[];return this.eachLayer(function(m){if(m.toGeoJSON){var N=m.toGeoJSON(r);if(d)h.push(N.geometry);else{var A=Ua(N);A.type==="FeatureCollection"?h.push.apply(h,A.features):h.push(A)}}}),d?Fi(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function Yu(r,o){return new tr(r,o)}var By=Yu,Ma=kn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,o,d){this._url=r,this._bounds=se(o),S(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Te(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ke(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&un(this._image),this},bringToBack:function(){return this._map&&fn(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=se(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",o=this._image=r?this._url:Oe("img");if(Te(o,"leaflet-image-layer"),this._zoomAnimated&&Te(o,"leaflet-zoom-animated"),this.options.className&&Te(o,this.options.className),o.onselectstart=v,o.onmousemove=v,o.onload=c(this.fire,this,"load"),o.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(r){var o=this._map.getZoomScale(r.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Mn(this._image,d,o)},_reset:function(){var r=this._image,o=new U(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=o.getSize();at(r,o.min),r.style.width=d.x+"px",r.style.height=d.y+"px"},_updateOpacity:function(){Mt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),Ry=function(r,o,d){return new Ma(r,o,d)},Ku=Ma.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",o=this._image=r?this._url:Oe("video");if(Te(o,"leaflet-image-layer"),this._zoomAnimated&&Te(o,"leaflet-zoom-animated"),this.options.className&&Te(o,this.options.className),o.onselectstart=v,o.onmousemove=v,o.onloadeddata=c(this.fire,this,"load"),r){for(var d=o.getElementsByTagName("source"),h=[],m=0;m<d.length;m++)h.push(d[m].src);this._url=d.length>0?h:[o.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var N=0;N<this._url.length;N++){var A=Oe("source");A.src=this._url[N],o.appendChild(A)}}});function Ay(r,o,d){return new Ku(r,o,d)}var Qu=Ma.extend({_initImage:function(){var r=this._image=this._url;Te(r,"leaflet-image-layer"),this._zoomAnimated&&Te(r,"leaflet-zoom-animated"),this.options.className&&Te(r,this.options.className),r.onselectstart=v,r.onmousemove=v}});function Fy(r,o,d){return new Qu(r,o,d)}var zn=kn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,o){r&&(r instanceof ne||w(r))?(this._latlng=ce(r),S(this,o)):(S(this,r),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Mt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Mt(this._container,1),this.bringToFront(),this.options.interactive&&(Te(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Mt(this._container,0),this._removeTimeout=setTimeout(c(Ke,void 0,this._container),200)):Ke(this._container),this.options.interactive&&(Je(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=ce(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&un(this._container),this},bringToBack:function(){return this._map&&fn(this._container),this},_prepareOpen:function(r){var o=this._source;if(!o._map)return!1;if(o instanceof Xn){o=null;var d=this._source._layers;for(var h in d)if(d[h]._map){o=d[h];break}if(!o)return!1;this._source=o}if(!r)if(o.getCenter)r=o.getCenter();else if(o.getLatLng)r=o.getLatLng();else if(o.getBounds)r=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")r.innerHTML=o;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),o=re(this.options.offset),d=this._getAnchor();this._zoomAnimated?at(this._container,r.add(d)):o=o.add(r).add(d);var h=this._containerBottom=-o.y,m=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=h+"px",this._container.style.left=m+"px"}},_getAnchor:function(){return[0,0]}});He.include({_initOverlay:function(r,o,d,h){var m=o;return m instanceof r||(m=new r(h).setContent(o)),d&&m.setLatLng(d),m}}),kn.include({_initOverlay:function(r,o,d,h){var m=d;return m instanceof r?(S(m,h),m._source=this):(m=o&&!h?o:new r(h,this),m.setContent(d)),m}});var Oa=zn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,zn.prototype.openOn.call(this,r)},onAdd:function(r){zn.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof kr||this._source.on("preclick",li))},onRemove:function(r){zn.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof kr||this._source.off("preclick",li))},getEvents:function(){var r=zn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",o=this._container=Oe("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=Oe("div",r+"-content-wrapper",o);if(this._contentNode=Oe("div",r+"-content",d),ws(o),Tl(this._contentNode),Ae(o,"contextmenu",li),this._tipContainer=Oe("div",r+"-tip-container",o),this._tip=Oe("div",r+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=Oe("a",r+"-close-button",o);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',Ae(h,"click",function(m){Ct(m),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,o=r.style;o.width="",o.whiteSpace="nowrap";var d=r.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),o.width=d+1+"px",o.whiteSpace="",o.height="";var h=r.offsetHeight,m=this.options.maxHeight,N="leaflet-popup-scrolled";m&&h>m?(o.height=m+"px",Te(r,N)):Je(r,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var o=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),d=this._getAnchor();at(this._container,o.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,o=parseInt(Sn(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+o,h=this._containerWidth,m=new W(this._containerLeft,-d-this._containerBottom);m._add(nt(this._container));var N=r.layerPointToContainerPoint(m),A=re(this.options.autoPanPadding),H=re(this.options.autoPanPaddingTopLeft||A),Y=re(this.options.autoPanPaddingBottomRight||A),le=r.getSize(),_e=0,Ee=0;N.x+h+Y.x>le.x&&(_e=N.x+h-le.x+Y.x),N.x-_e-H.x<0&&(_e=N.x-H.x),N.y+d+Y.y>le.y&&(Ee=N.y+d-le.y+Y.y),N.y-Ee-H.y<0&&(Ee=N.y-H.y),(_e||Ee)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([_e,Ee]))}},_getAnchor:function(){return re(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Uy=function(r,o){return new Oa(r,o)};He.mergeOptions({closePopupOnClick:!0}),He.include({openPopup:function(r,o,d){return this._initOverlay(Oa,r,o,d).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),kn.include({bindPopup:function(r,o){return this._popup=this._initOverlay(Oa,this._popup,r,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof Xn||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){ci(r);var o=r.layer||r.target;if(this._popup._source===o&&!(o instanceof kr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=o,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var Da=zn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){zn.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){zn.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=zn.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",o=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Oe("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var o,d,h=this._map,m=this._container,N=h.latLngToContainerPoint(h.getCenter()),A=h.layerPointToContainerPoint(r),H=this.options.direction,Y=m.offsetWidth,le=m.offsetHeight,_e=re(this.options.offset),Ee=this._getAnchor();H==="top"?(o=Y/2,d=le):H==="bottom"?(o=Y/2,d=0):H==="center"?(o=Y/2,d=le/2):H==="right"?(o=0,d=le/2):H==="left"?(o=Y,d=le/2):A.x<N.x?(H="right",o=0,d=le/2):(H="left",o=Y+(_e.x+Ee.x)*2,d=le/2),r=r.subtract(re(o,d,!0)).add(_e).add(Ee),Je(m,"leaflet-tooltip-right"),Je(m,"leaflet-tooltip-left"),Je(m,"leaflet-tooltip-top"),Je(m,"leaflet-tooltip-bottom"),Te(m,"leaflet-tooltip-"+H),at(m,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Mt(this._container,r)},_animateZoom:function(r){var o=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(o)},_getAnchor:function(){return re(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),My=function(r,o){return new Da(r,o)};He.include({openTooltip:function(r,o,d){return this._initOverlay(Da,r,o,d).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),kn.include({bindTooltip:function(r,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Da,this._tooltip,r,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var o=r?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[o](d),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof Xn||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var o=typeof r.getElement=="function"&&r.getElement();o&&(Ae(o,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Ae(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var o=typeof r.getElement=="function"&&r.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var o=r.latlng,d,h;this._tooltip.options.sticky&&r.originalEvent&&(d=this._map.mouseEventToContainerPoint(r.originalEvent),h=this._map.containerPointToLayerPoint(d),o=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(o)}});var Ju=Ri.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var o=r&&r.tagName==="DIV"?r:document.createElement("div"),d=this.options;if(d.html instanceof Element?(Un(o),o.appendChild(d.html)):o.innerHTML=d.html!==!1?d.html:"",d.bgPos){var h=re(d.bgPos);o.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Oy(r){return new Ju(r)}Ri.Default=Ns;var Cs=kn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){S(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),Ke(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(un(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(fn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof W?r:new W(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var o=this.getPane().children,d=-r(-1/0,1/0),h=0,m=o.length,N;h<m;h++)N=o[h].style.zIndex,o[h]!==this._container&&N&&(d=r(d,+N));isFinite(d)&&(this.options.zIndex=d+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pe.ielt9){Mt(this._container,this.options.opacity);var r=+new Date,o=!1,d=!1;for(var h in this._tiles){var m=this._tiles[h];if(!(!m.current||!m.loaded)){var N=Math.min(1,(r-m.loaded)/200);Mt(m.el,N),N<1?o=!0:(m.active?d=!0:this._onOpaqueTile(m),m.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),o&&(q(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=Oe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,o=this.options.maxZoom;if(r!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===r?(this._levels[d].el.style.zIndex=o-Math.abs(r-d),this._onUpdateLevel(d)):(Ke(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var h=this._levels[r],m=this._map;return h||(h=this._levels[r]={},h.el=Oe("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=o,h.origin=m.project(m.unproject(m.getPixelOrigin()),r).round(),h.zoom=r,this._setZoomTransform(h,m.getCenter(),m.getZoom()),v(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var r,o,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)o=this._tiles[r],o.retain=o.current;for(r in this._tiles)if(o=this._tiles[r],o.current&&!o.active){var h=o.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var o in this._tiles)this._tiles[o].coords.z===r&&this._removeTile(o)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)Ke(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,o,d,h){var m=Math.floor(r/2),N=Math.floor(o/2),A=d-1,H=new W(+m,+N);H.z=+A;var Y=this._tileCoordsToKey(H),le=this._tiles[Y];return le&&le.active?(le.retain=!0,!0):(le&&le.loaded&&(le.retain=!0),A>h?this._retainParent(m,N,A,h):!1)},_retainChildren:function(r,o,d,h){for(var m=2*r;m<2*r+2;m++)for(var N=2*o;N<2*o+2;N++){var A=new W(m,N);A.z=d+1;var H=this._tileCoordsToKey(A),Y=this._tiles[H];if(Y&&Y.active){Y.retain=!0;continue}else Y&&Y.loaded&&(Y.retain=!0);d+1<h&&this._retainChildren(m,N,d+1,h)}},_resetView:function(r){var o=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var o=this.options;return o.minNativeZoom!==void 0&&r<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<r?o.maxNativeZoom:r},_setView:function(r,o,d,h){var m=Math.round(o);this.options.maxZoom!==void 0&&m>this.options.maxZoom||this.options.minZoom!==void 0&&m<this.options.minZoom?m=void 0:m=this._clampZoom(m);var N=this.options.updateWhenZooming&&m!==this._tileZoom;(!h||N)&&(this._tileZoom=m,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),m!==void 0&&this._update(r),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(r,o)},_setZoomTransforms:function(r,o){for(var d in this._levels)this._setZoomTransform(this._levels[d],r,o)},_setZoomTransform:function(r,o,d){var h=this._map.getZoomScale(d,r.zoom),m=r.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(o,d)).round();Pe.any3d?Mn(r.el,m,h):at(r.el,m)},_resetGrid:function(){var r=this._map,o=r.options.crs,d=this._tileSize=this.getTileSize(),h=this._tileZoom,m=this._map.getPixelWorldBounds(this._tileZoom);m&&(this._globalTileRange=this._pxBoundsToTileRange(m)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,o.wrapLng[0]],h).x/d.x),Math.ceil(r.project([0,o.wrapLng[1]],h).x/d.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([o.wrapLat[0],0],h).y/d.x),Math.ceil(r.project([o.wrapLat[1],0],h).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var o=this._map,d=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),h=o.getZoomScale(d,this._tileZoom),m=o.project(r,this._tileZoom).floor(),N=o.getSize().divideBy(h*2);return new U(m.subtract(N),m.add(N))},_update:function(r){var o=this._map;if(o){var d=this._clampZoom(o.getZoom());if(r===void 0&&(r=o.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(r),m=this._pxBoundsToTileRange(h),N=m.getCenter(),A=[],H=this.options.keepBuffer,Y=new U(m.getBottomLeft().subtract([H,-H]),m.getTopRight().add([H,-H]));if(!(isFinite(m.min.x)&&isFinite(m.min.y)&&isFinite(m.max.x)&&isFinite(m.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var le in this._tiles){var _e=this._tiles[le].coords;(_e.z!==this._tileZoom||!Y.contains(new W(_e.x,_e.y)))&&(this._tiles[le].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(r,d);return}for(var Ee=m.min.y;Ee<=m.max.y;Ee++)for(var De=m.min.x;De<=m.max.x;De++){var Ot=new W(De,Ee);if(Ot.z=this._tileZoom,!!this._isValidTile(Ot)){var wt=this._tiles[this._tileCoordsToKey(Ot)];wt?wt.current=!0:A.push(Ot)}}if(A.sort(function(Vt,Mi){return Vt.distanceTo(N)-Mi.distanceTo(N)}),A.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var pn=document.createDocumentFragment();for(De=0;De<A.length;De++)this._addTile(A[De],pn);this._level.el.appendChild(pn)}}}},_isValidTile:function(r){var o=this._map.options.crs;if(!o.infinite){var d=this._globalTileRange;if(!o.wrapLng&&(r.x<d.min.x||r.x>d.max.x)||!o.wrapLat&&(r.y<d.min.y||r.y>d.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(r);return se(this.options.bounds).overlaps(h)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var o=this._map,d=this.getTileSize(),h=r.scaleBy(d),m=h.add(d),N=o.unproject(h,r.z),A=o.unproject(m,r.z);return[N,A]},_tileCoordsToBounds:function(r){var o=this._tileCoordsToNwSe(r),d=new Z(o[0],o[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var o=r.split(":"),d=new W(+o[0],+o[1]);return d.z=+o[2],d},_removeTile:function(r){var o=this._tiles[r];o&&(Ke(o.el),delete this._tiles[r],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Te(r,"leaflet-tile");var o=this.getTileSize();r.style.width=o.x+"px",r.style.height=o.y+"px",r.onselectstart=v,r.onmousemove=v,Pe.ielt9&&this.options.opacity<1&&Mt(r,this.options.opacity)},_addTile:function(r,o){var d=this._getTilePos(r),h=this._tileCoordsToKey(r),m=this.createTile(this._wrapCoords(r),c(this._tileReady,this,r));this._initTile(m),this.createTile.length<2&&D(c(this._tileReady,this,r,null,m)),at(m,d),this._tiles[h]={el:m,coords:r,current:!0},o.appendChild(m),this.fire("tileloadstart",{tile:m,coords:r})},_tileReady:function(r,o,d){o&&this.fire("tileerror",{error:o,tile:d,coords:r});var h=this._tileCoordsToKey(r);d=this._tiles[h],d&&(d.loaded=+new Date,this._map._fadeAnimated?(Mt(d.el,0),q(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),o||(Te(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pe.ielt9||!this._map._fadeAnimated?D(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var o=new W(this._wrapX?g(r.x,this._wrapX):r.x,this._wrapY?g(r.y,this._wrapY):r.y);return o.z=r.z,o},_pxBoundsToTileRange:function(r){var o=this.getTileSize();return new U(r.min.unscaleBy(o).floor(),r.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function Dy(r){return new Cs(r)}var Ui=Cs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,o){this._url=r,o=S(this,o),o.detectRetina&&Pe.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,o){return this._url===r&&o===void 0&&(o=!0),this._url=r,o||this.redraw(),this},createTile:function(r,o){var d=document.createElement("img");return Ae(d,"load",c(this._tileOnLoad,this,o,d)),Ae(d,"error",c(this._tileOnError,this,o,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(r),d},getTileUrl:function(r){var o={r:Pe.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-r.y;this.options.tms&&(o.y=d),o["-y"]=d}return x(this._url,a(o,this.options))},_tileOnLoad:function(r,o){Pe.ielt9?setTimeout(c(r,this,null,o),0):r(null,o)},_tileOnError:function(r,o,d){var h=this.options.errorTileUrl;h&&o.getAttribute("src")!==h&&(o.src=h),r(d,o)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,o=this.options.maxZoom,d=this.options.zoomReverse,h=this.options.zoomOffset;return d&&(r=o-r),r+h},_getSubdomain:function(r){var o=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var r,o;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(o=this._tiles[r].el,o.onload=v,o.onerror=v,!o.complete)){o.src=B;var d=this._tiles[r].coords;Ke(o),delete this._tiles[r],this.fire("tileabort",{tile:o,coords:d})}},_removeTile:function(r){var o=this._tiles[r];if(o)return o.el.setAttribute("src",B),Cs.prototype._removeTile.call(this,r)},_tileReady:function(r,o,d){if(!(!this._map||d&&d.getAttribute("src")===B))return Cs.prototype._tileReady.call(this,r,o,d)}});function Xu(r,o){return new Ui(r,o)}var ef=Ui.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,o){this._url=r;var d=a({},this.defaultWmsParams);for(var h in o)h in this.options||(d[h]=o[h]);o=S(this,o);var m=o.detectRetina&&Pe.retina?2:1,N=this.getTileSize();d.width=N.x*m,d.height=N.y*m,this.wmsParams=d},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Ui.prototype.onAdd.call(this,r)},getTileUrl:function(r){var o=this._tileCoordsToNwSe(r),d=this._crs,h=ie(d.project(o[0]),d.project(o[1])),m=h.min,N=h.max,A=(this._wmsVersion>=1.3&&this._crs===Vu?[m.y,m.x,N.y,N.x]:[m.x,m.y,N.x,N.y]).join(","),H=Ui.prototype.getTileUrl.call(this,r);return H+P(this.wmsParams,H,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+A},setParams:function(r,o){return a(this.wmsParams,r),o||this.redraw(),this}});function zy(r,o){return new ef(r,o)}Ui.WMS=ef,Xu.wms=zy;var nr=kn.extend({options:{padding:.1},initialize:function(r){S(this,r),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Te(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,o){var d=this._map.getZoomScale(o,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),m=this._map.project(this._center,o),N=h.multiplyBy(-d).add(m).subtract(this._map._getNewPixelOrigin(r,o));Pe.any3d?Mn(this._container,N,d):at(this._container,N)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,o=this._map.getSize(),d=this._map.containerPointToLayerPoint(o.multiplyBy(-r)).round();this._bounds=new U(d,d.add(o.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),tf=nr.extend({options:{tolerance:0},getEvents:function(){var r=nr.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){nr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Ae(r,"mousemove",this._onMouseMove,this),Ae(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ae(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){q(this._redrawRequest),delete this._ctx,Ke(this._container),Xe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var o in this._layers)r=this._layers[o],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nr.prototype._update.call(this);var r=this._bounds,o=this._container,d=r.getSize(),h=Pe.retina?2:1;at(o,r.min),o.width=h*d.x,o.height=h*d.y,o.style.width=d.x+"px",o.style.height=d.y+"px",Pe.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){nr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[f(r)]=r;var o=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var o=r._order,d=o.next,h=o.prev;d?d.prev=h:this._drawLast=h,h?h.next=d:this._drawFirst=d,delete r._order,delete this._layers[f(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var o=r.options.dashArray.split(/[, ]+/),d=[],h,m;for(m=0;m<o.length;m++){if(h=Number(o[m]),isNaN(h))return;d.push(h)}r.options._dashArray=d}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||D(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var o=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new U,this._redrawBounds.extend(r._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(r._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var o=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,o=this._redrawBounds;if(this._ctx.save(),o){var d=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)r=h.layer,(!o||r._pxBounds&&r._pxBounds.intersects(o))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,o){if(this._drawing){var d,h,m,N,A=r._parts,H=A.length,Y=this._ctx;if(H){for(Y.beginPath(),d=0;d<H;d++){for(h=0,m=A[d].length;h<m;h++)N=A[d][h],Y[h?"lineTo":"moveTo"](N.x,N.y);o&&Y.closePath()}this._fillStroke(Y,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var o=r._point,d=this._ctx,h=Math.max(Math.round(r._radius),1),m=(Math.max(Math.round(r._radiusY),1)||h)/h;m!==1&&(d.save(),d.scale(1,m)),d.beginPath(),d.arc(o.x,o.y/m,h,0,Math.PI*2,!1),m!==1&&d.restore(),this._fillStroke(d,r)}},_fillStroke:function(r,o){var d=o.options;d.fill&&(r.globalAlpha=d.fillOpacity,r.fillStyle=d.fillColor||d.color,r.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(r.setLineDash&&r.setLineDash(o.options&&o.options._dashArray||[]),r.globalAlpha=d.opacity,r.lineWidth=d.weight,r.strokeStyle=d.color,r.lineCap=d.lineCap,r.lineJoin=d.lineJoin,r.stroke())},_onClick:function(r){for(var o=this._map.mouseEventToLayerPoint(r),d,h,m=this._drawFirst;m;m=m.next)d=m.layer,d.options.interactive&&d._containsPoint(o)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(d))&&(h=d);this._fireEvent(h?[h]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,o)}},_handleMouseOut:function(r){var o=this._hoveredLayer;o&&(Je(this._container,"leaflet-interactive"),this._fireEvent([o],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,o){if(!this._mouseHoverThrottled){for(var d,h,m=this._drawFirst;m;m=m.next)d=m.layer,d.options.interactive&&d._containsPoint(o)&&(h=d);h!==this._hoveredLayer&&(this._handleMouseOut(r),h&&(Te(this._container,"leaflet-interactive"),this._fireEvent([h],r,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,o,d){this._map._fireDOMEvent(o,d||o.type,r)},_bringToFront:function(r){var o=r._order;if(o){var d=o.next,h=o.prev;if(d)d.prev=h;else return;h?h.next=d:d&&(this._drawFirst=d),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(r)}},_bringToBack:function(r){var o=r._order;if(o){var d=o.next,h=o.prev;if(h)h.next=d;else return;d?d.prev=h:h&&(this._drawLast=h),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(r)}}});function nf(r){return Pe.canvas?new tf(r):null}var ks=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),$y={_initContainer:function(){this._container=Oe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(nr.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var o=r._container=ks("shape");Te(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",r._path=ks("path"),o.appendChild(r._path),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){var o=r._container;this._container.appendChild(o),r.options.interactive&&r.addInteractiveTarget(o)},_removePath:function(r){var o=r._container;Ke(o),r.removeInteractiveTarget(o),delete this._layers[f(r)]},_updateStyle:function(r){var o=r._stroke,d=r._fill,h=r.options,m=r._container;m.stroked=!!h.stroke,m.filled=!!h.fill,h.stroke?(o||(o=r._stroke=ks("stroke")),m.appendChild(o),o.weight=h.weight+"px",o.color=h.color,o.opacity=h.opacity,h.dashArray?o.dashStyle=w(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=h.lineCap.replace("butt","flat"),o.joinstyle=h.lineJoin):o&&(m.removeChild(o),r._stroke=null),h.fill?(d||(d=r._fill=ks("fill")),m.appendChild(d),d.color=h.fillColor||h.color,d.opacity=h.fillOpacity):d&&(m.removeChild(d),r._fill=null)},_updateCircle:function(r){var o=r._point.round(),d=Math.round(r._radius),h=Math.round(r._radiusY||d);this._setPath(r,r._empty()?"M0 0":"AL "+o.x+","+o.y+" "+d+","+h+" 0,"+65535*360)},_setPath:function(r,o){r._path.v=o},_bringToFront:function(r){un(r._container)},_bringToBack:function(r){fn(r._container)}},za=Pe.vml?ks:ae,Ps=nr.extend({_initContainer:function(){this._container=za("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=za("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ke(this._container),Xe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nr.prototype._update.call(this);var r=this._bounds,o=r.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,d.setAttribute("width",o.x),d.setAttribute("height",o.y)),at(d,r.min),d.setAttribute("viewBox",[r.min.x,r.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(r){var o=r._path=za("path");r.options.className&&Te(o,r.options.className),r.options.interactive&&Te(o,"leaflet-interactive"),this._updateStyle(r),this._layers[f(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){Ke(r._path),r.removeInteractiveTarget(r._path),delete this._layers[f(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var o=r._path,d=r.options;o&&(d.stroke?(o.setAttribute("stroke",d.color),o.setAttribute("stroke-opacity",d.opacity),o.setAttribute("stroke-width",d.weight),o.setAttribute("stroke-linecap",d.lineCap),o.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?o.setAttribute("stroke-dasharray",d.dashArray):o.removeAttribute("stroke-dasharray"),d.dashOffset?o.setAttribute("stroke-dashoffset",d.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),d.fill?(o.setAttribute("fill",d.fillColor||d.color),o.setAttribute("fill-opacity",d.fillOpacity),o.setAttribute("fill-rule",d.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(r,o){this._setPath(r,ye(r._parts,o))},_updateCircle:function(r){var o=r._point,d=Math.max(Math.round(r._radius),1),h=Math.max(Math.round(r._radiusY),1)||d,m="a"+d+","+h+" 0 1,0 ",N=r._empty()?"M0 0":"M"+(o.x-d)+","+o.y+m+d*2+",0 "+m+-d*2+",0 ";this._setPath(r,N)},_setPath:function(r,o){r._path.setAttribute("d",o)},_bringToFront:function(r){un(r._path)},_bringToBack:function(r){fn(r._path)}});Pe.vml&&Ps.include($y);function rf(r){return Pe.svg||Pe.vml?new Ps(r):null}He.include({getRenderer:function(r){var o=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var o=this._paneRenderers[r];return o===void 0&&(o=this._createRenderer({pane:r}),this._paneRenderers[r]=o),o},_createRenderer:function(r){return this.options.preferCanvas&&nf(r)||rf(r)}});var sf=Ai.extend({initialize:function(r,o){Ai.prototype.initialize.call(this,this._boundsToLatLngs(r),o)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=se(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Wy(r,o){return new sf(r,o)}Ps.create=za,Ps.pointsToPath=ye,tr.geometryToLayer=Ra,tr.coordsToLatLng=zl,tr.coordsToLatLngs=Aa,tr.latLngToCoords=$l,tr.latLngsToCoords=Fa,tr.getFeature=Fi,tr.asFeature=Ua,He.mergeOptions({boxZoom:!0});var af=Dn.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Ae(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ke(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),vs(),Nl(),this._startPoint=this._map.mouseEventToContainerPoint(r),Ae(document,{contextmenu:ci,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Oe("div","leaflet-zoom-box",this._container),Te(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var o=new U(this._point,this._startPoint),d=o.getSize();at(this._box,o.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Ke(this._box),Je(this._container,"leaflet-crosshair")),xs(),Cl(),Xe(document,{contextmenu:ci,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var o=new Z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});He.addInitHook("addHandler","boxZoom",af),He.mergeOptions({doubleClickZoom:!0});var of=Dn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var o=this._map,d=o.getZoom(),h=o.options.zoomDelta,m=r.originalEvent.shiftKey?d-h:d+h;o.options.doubleClickZoom==="center"?o.setZoom(m):o.setZoomAround(r.containerPoint,m)}});He.addInitHook("addHandler","doubleClickZoom",of),He.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var lf=Dn.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new Cr(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}Te(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Je(this._map._container,"leaflet-grab"),Je(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=se(this._map.options.maxBounds);this._offsetLimit=ie(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var o=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(o),this._prunePositions(o)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,o){return r-(r-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;r.x<o.min.x&&(r.x=this._viscousLimit(r.x,o.min.x)),r.y<o.min.y&&(r.y=this._viscousLimit(r.y,o.min.y)),r.x>o.max.x&&(r.x=this._viscousLimit(r.x,o.max.x)),r.y>o.max.y&&(r.y=this._viscousLimit(r.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,o=Math.round(r/2),d=this._initialWorldOffset,h=this._draggable._newPos.x,m=(h-o+d)%r+o-d,N=(h+o+d)%r-o-d,A=Math.abs(m+d)<Math.abs(N+d)?m:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=A},_onDragEnd:function(r){var o=this._map,d=o.options,h=!d.inertia||r.noInertia||this._times.length<2;if(o.fire("dragend",r),h)o.fire("moveend");else{this._prunePositions(+new Date);var m=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,A=d.easeLinearity,H=m.multiplyBy(A/N),Y=H.distanceTo([0,0]),le=Math.min(d.inertiaMaxSpeed,Y),_e=H.multiplyBy(le/Y),Ee=le/(d.inertiaDeceleration*A),De=_e.multiplyBy(-Ee/2).round();!De.x&&!De.y?o.fire("moveend"):(De=o._limitOffset(De,o.options.maxBounds),D(function(){o.panBy(De,{duration:Ee,easeLinearity:A,noMoveStart:!0,animate:!0})}))}}});He.addInitHook("addHandler","dragging",lf),He.mergeOptions({keyboard:!0,keyboardPanDelta:80});var cf=Dn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Ae(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Xe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,o=document.documentElement,d=r.scrollTop||o.scrollTop,h=r.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(h,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var o=this._panKeys={},d=this.keyCodes,h,m;for(h=0,m=d.left.length;h<m;h++)o[d.left[h]]=[-1*r,0];for(h=0,m=d.right.length;h<m;h++)o[d.right[h]]=[r,0];for(h=0,m=d.down.length;h<m;h++)o[d.down[h]]=[0,r];for(h=0,m=d.up.length;h<m;h++)o[d.up[h]]=[0,-1*r]},_setZoomDelta:function(r){var o=this._zoomKeys={},d=this.keyCodes,h,m;for(h=0,m=d.zoomIn.length;h<m;h++)o[d.zoomIn[h]]=r;for(h=0,m=d.zoomOut.length;h<m;h++)o[d.zoomOut[h]]=-r},_addHooks:function(){Ae(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var o=r.keyCode,d=this._map,h;if(o in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(h=this._panKeys[o],r.shiftKey&&(h=re(h).multiplyBy(3)),d.options.maxBounds&&(h=d._limitOffset(re(h),d.options.maxBounds)),d.options.worldCopyJump){var m=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(h)));d.panTo(m)}else d.panBy(h)}else if(o in this._zoomKeys)d.setZoom(d.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;ci(r)}}});He.addInitHook("addHandler","keyboard",cf),He.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var df=Dn.extend({addHooks:function(){Ae(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var o=Bu(r),d=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var h=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),h),ci(r)},_performZoom:function(){var r=this._map,o=r.getZoom(),d=this._map.options.zoomSnap||0;r._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),m=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,N=d?Math.ceil(m/d)*d:m,A=r._limitZoom(o+(this._delta>0?N:-N))-o;this._delta=0,this._startTime=null,A&&(r.options.scrollWheelZoom==="center"?r.setZoom(o+A):r.setZoomAround(this._lastMousePos,o+A))}});He.addInitHook("addHandler","scrollWheelZoom",df);var Hy=600;He.mergeOptions({tapHold:Pe.touchNative&&Pe.safari&&Pe.mobile,tapTolerance:15});var uf=Dn.extend({addHooks:function(){Ae(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var o=r.touches[0];this._startPos=this._newPos=new W(o.clientX,o.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(Ae(document,"touchend",Ct),Ae(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Hy),Ae(document,"touchend touchcancel contextmenu",this._cancel,this),Ae(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){Xe(document,"touchend",Ct),Xe(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)},_onMove:function(r){var o=r.touches[0];this._newPos=new W(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,o){var d=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});d._simulated=!0,o.target.dispatchEvent(d)}});He.addInitHook("addHandler","tapHold",uf),He.mergeOptions({touchZoom:Pe.touch,bounceAtZoomLimits:!0});var ff=Dn.extend({addHooks:function(){Te(this._map._container,"leaflet-touch-zoom"),Ae(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Je(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var o=this._map;if(!(!r.touches||r.touches.length!==2||o._animatingZoom||this._zooming)){var d=o.mouseEventToContainerPoint(r.touches[0]),h=o.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(d.add(h)._divideBy(2))),this._startDist=d.distanceTo(h),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),Ae(document,"touchmove",this._onTouchMove,this),Ae(document,"touchend touchcancel",this._onTouchEnd,this),Ct(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var o=this._map,d=o.mouseEventToContainerPoint(r.touches[0]),h=o.mouseEventToContainerPoint(r.touches[1]),m=d.distanceTo(h)/this._startDist;if(this._zoom=o.getScaleZoom(m,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&m<1||this._zoom>o.getMaxZoom()&&m>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,m===1)return}else{var N=d._add(h)._divideBy(2)._subtract(this._centerPoint);if(m===1&&N.x===0&&N.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),q(this._animRequest);var A=c(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=D(A,this,!0),Ct(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,q(this._animRequest),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});He.addInitHook("addHandler","touchZoom",ff),He.BoxZoom=af,He.DoubleClickZoom=of,He.Drag=lf,He.Keyboard=cf,He.ScrollWheelZoom=df,He.TapHold=uf,He.TouchZoom=ff,n.Bounds=U,n.Browser=Pe,n.CRS=ke,n.Canvas=tf,n.Circle=Dl,n.CircleMarker=Ba,n.Class=G,n.Control=Cn,n.DivIcon=Ju,n.DivOverlay=zn,n.DomEvent=ly,n.DomUtil=ay,n.Draggable=Cr,n.Evented=Ne,n.FeatureGroup=Xn,n.GeoJSON=tr,n.GridLayer=Cs,n.Handler=Dn,n.Icon=Ri,n.ImageOverlay=Ma,n.LatLng=ne,n.LatLngBounds=Z,n.Layer=kn,n.LayerGroup=Bi,n.LineUtil=wy,n.Map=He,n.Marker=Ta,n.Mixin=my,n.Path=kr,n.Point=W,n.PolyUtil=gy,n.Polygon=Ai,n.Polyline=er,n.Popup=Oa,n.PosAnimation=Ru,n.Projection=jy,n.Rectangle=sf,n.Renderer=nr,n.SVG=Ps,n.SVGOverlay=Qu,n.TileLayer=Ui,n.Tooltip=Da,n.Transformation=ft,n.Util=te,n.VideoOverlay=Ku,n.bind=c,n.bounds=ie,n.canvas=nf,n.circle=Ly,n.circleMarker=Iy,n.control=js,n.divIcon=Oy,n.extend=a,n.featureGroup=ky,n.geoJSON=Yu,n.geoJson=By,n.gridLayer=Dy,n.icon=Py,n.imageOverlay=Ry,n.latLng=ce,n.latLngBounds=se,n.layerGroup=Cy,n.map=cy,n.marker=by,n.point=re,n.polygon=Ty,n.polyline=Ey,n.popup=Uy,n.rectangle=Wy,n.setOptions=S,n.stamp=f,n.svg=rf,n.svgOverlay=Fy,n.tileLayer=Xu,n.tooltip=My,n.transformation=qe,n.version=s,n.videoOverlay=Ay;var Zy=window.L;n.noConflict=function(){return window.L=Zy,this},window.L=n})})(Sd,Sd.exports);var ka=Sd.exports;const Pa=tp(ka);function ku(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function Pu(e,t){return t==null?function(s,a){const l=y.useRef();return l.current||(l.current=e(s,a)),l}:function(s,a){const l=y.useRef();l.current||(l.current=e(s,a));const c=y.useRef(s),{instance:u}=l.current;return y.useEffect(function(){c.current!==s&&(t(u,s,c.current),c.current=s)},[u,s,a]),l}}function hj(e,t){y.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var l;(l=t.layerContainer)==null||l.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function ny(e){return function(n){const s=Nu(),a=e(Cu(n,s),s);return Jg(s.map,n.attribution),ty(a.current,n.eventHandlers),hj(a.current,s),a}}function pj(e,t){const n=Pu(e,t),s=ny(n);return cj(s)}function mj(e,t){const n=Pu(e),s=fj(n,t);return dj(s)}function gj(e,t){const n=Pu(e,t),s=ny(n);return uj(s)}function yj(e,t,n){const{opacity:s,zIndex:a}=t;s!=null&&s!==n.opacity&&e.setOpacity(s),a!=null&&a!==n.zIndex&&e.setZIndex(a)}function vj(){return Nu().map}function Nd(){return Nd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Nd.apply(this,arguments)}function xj({bounds:e,boundsOptions:t,center:n,children:s,className:a,id:l,placeholder:c,style:u,whenReady:f,zoom:p,...g},v){const[j]=y.useState({className:a,id:l,style:u}),[k,C]=y.useState(null);y.useImperativeHandle(v,()=>(k==null?void 0:k.map)??null,[k]);const S=y.useCallback(_=>{if(_!==null&&k===null){const x=new ka.Map(_,g);n!=null&&p!=null?x.setView(n,p):e!=null&&x.fitBounds(e,t),f!=null&&x.whenReady(f),C(oj(x))}},[]);y.useEffect(()=>()=>{k==null||k.map.remove()},[k]);const P=k?Yn.createElement(ey,{value:k},s):c??null;return Yn.createElement("div",Nd({},j,{ref:S}),P)}const _j=y.forwardRef(xj),Kh=pj(function({position:t,...n},s){const a=new ka.Marker(t,n);return ku(a,lj(s,{overlayContainer:a}))},function(t,n,s){n.position!==s.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),Qh=mj(function(t,n){const s=new ka.Popup(t,n.overlayContainer);return ku(s,n)},function(t,n,{position:s},a){y.useEffect(function(){const{instance:c}=t;function u(p){p.popup===c&&(c.update(),a(!0))}function f(p){p.popup===c&&a(!1)}return n.map.on({popupopen:u,popupclose:f}),n.overlayContainer==null?(s!=null&&c.setLatLng(s),c.openOn(n.map)):n.overlayContainer.bindPopup(c),function(){var g;n.map.off({popupopen:u,popupclose:f}),(g=n.overlayContainer)==null||g.unbindPopup(),n.map.removeLayer(c)}},[t,n,a,s])}),wj=gj(function({url:t,...n},s){const a=new ka.TileLayer(t,Cu(n,s));return ku(a,s)},function(t,n,s){yj(t,n,s);const{url:a}=n;a!=null&&a!==s.url&&t.setUrl(a)});delete Pa.Icon.Default.prototype._getIconUrl;Pa.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const jj=new Pa.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Sj=new Pa.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Nj=new Pa.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-40],shadowSize:[41,41]});function Cj({stations:e,userLocation:t}){const n=vj();return y.useEffect(()=>{if(!(!t||!n))try{const s=setTimeout(()=>{n&&n._container&&n.setView([t.lat,t.lng],14,{animate:!0,duration:1})},100);return()=>clearTimeout(s)}catch(s){console.warn(" Error setting map view:",s.message)}},[n,t]),null}function kj(e){const t={"District 1 - Nguyen Hue":{lat:10.7743,lng:106.7012},"District 4 - Khanh Hoi":{lat:10.7593,lng:106.7058},"Binh Thanh - Pearl Plaza":{lat:10.799,lng:106.7095},"District 7 - Phu My Hung":{lat:10.7308,lng:106.7193},"Go Vap - Emart":{lat:10.8376,lng:106.6758},"Tan Binh - Airport":{lat:10.8184,lng:106.6589},"Hi Phng - L Li":{lat:20.8445,lng:106.6839},"Hu - Huyn Trn Cng Cha":{lat:16.4637,lng:107.5909},"District 1 - Nguyn Hu":{lat:10.7743,lng:106.7012},"District 3 - V Vn Tn":{lat:10.7866,lng:106.6774},"Quy Nhn - Nguyn Tt Thnh":{lat:13.7769,lng:109.2233},"Vinh - L Dun":{lat:18.6799,lng:105.6936},"Thanh Ha - L Li":{lat:19.8096,lng:105.7756},"Bc Ninh - L Thi T":{lat:21.1856,lng:105.9804},"Hi Dng - Thnh Cng":{lat:20.948,lng:106.3178},"Thi Nguyn - L Hng Phong":{lat:21.5931,lng:105.8473},"Nam nh - Hng Vng":{lat:20.4281,lng:105.9424},"Ph Quc - Trn Hng o":{lat:10.1886,lng:103.9847},"Bun Ma Thut - L Dun":{lat:12.6655,lng:108.0404},"Long Xuyn - Nguyn Vn C":{lat:10.3872,lng:105.4329},"Rch Gi - Trn Hng o":{lat:10.0131,lng:104.9756},"District 7 - Nguyn Th Thp":{lat:10.7308,lng:106.7193},"Bnh Thnh - X Vit Ngh Tnh":{lat:10.8201,lng:106.7355},"Hon Kim - Hng Bi":{lat:21.029,lng:105.8548},"Ba nh - in Bin Ph":{lat:21.0459,lng:105.8186},"Ph Nhun - Phan nh Phng":{lat:10.8134,lng:106.7401},"Cu Giy - Cu Giy":{lat:21.0479,lng:105.7888},"Ty H - Trch Si":{lat:21.106,lng:105.8208},"Nha Trang - Trn Ph":{lat:12.2389,lng:109.1968}," Nng - Bch ng":{lat:16.0743,lng:108.2158}," Lt - Phan nh Phng":{lat:11.9404,lng:108.4453},"Cn Th - L Li":{lat:10.0379,lng:105.7869},"Bn Tre - Hm Lung":{lat:10.2384,lng:106.3721},"Vnh Long - ng Khi":{lat:10.2558,lng:105.9597},"Vng Tu - Trng Cng nh":{lat:10.3455,lng:107.0628}},n=e.stationName||e.name||e.Name,s=e.latitude||e.Latitude,a=e.longitude||e.Longitude;return s&&a?{lat:parseFloat(s),lng:parseFloat(a)}:t[n]?t[n]:null}function Pj({isOpen:e,onClose:t,stations:n,onSelectStation:s,selectedStationId:a,userLocation:l}){const[c,u]=y.useState(0);if(y.useEffect(()=>{e&&u(p=>p+1)},[e]),!e)return null;const f=l||{lat:10.8231,lng:106.6297};return i.jsxs("div",{className:`map-modal ${e?"active":""}`,children:[i.jsxs("div",{className:"map-modal-header",children:[i.jsxs("h3",{children:[i.jsx("i",{className:"fas fa-map-marked-alt"})," Select Location on Map"]}),i.jsx("button",{className:"map-modal-close",onClick:t,children:i.jsx("i",{className:"fas fa-times"})})]}),i.jsx("div",{className:"map-container",children:i.jsxs(_j,{center:[f.lat,f.lng],zoom:13,style:{height:"100%",width:"100%"},zoomControl:!0,children:[i.jsx(wj,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),i.jsx(Cj,{stations:n,userLocation:l}),l&&i.jsx(Kh,{position:[l.lat,l.lng],icon:jj,children:i.jsx(Qh,{children:i.jsx("div",{style:{padding:"4px"},children:i.jsx("strong",{children:"Your Location"})})})}),n.map(p=>{const g=kj(p);if(!g)return null;const v=p.stationName||p.name||p.Name||"Unknown Station",j=p.address||p.Address||"",k=p.id||p.Id||p.stationId,C=k===a;return i.jsx(Kh,{position:[g.lat,g.lng],icon:C?Nj:Sj,children:i.jsx(Qh,{children:i.jsxs("div",{style:{padding:"8px",minWidth:"200px"},children:[i.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#333"},children:v}),i.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#666"},children:j}),i.jsx("button",{onClick:()=>s(k,v,j),style:{background:"#ff6b35",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",width:"100%"},children:C?" Selected":"Select Location"})]})})},k)})]},c)}),i.jsx("div",{className:"map-modal-footer",children:i.jsxs("p",{children:[i.jsx("i",{className:"fas fa-info-circle"})," Click on a marker to select a station"]})})]})}function ry({isOpen:e,onClose:t,stations:n=[],userLocation:s=null,onSearch:a,currentSearchData:l=null}){const[c,u]=y.useState(!1),[f,p]=y.useState(()=>{if(l)return{location:l.location||"",locationName:l.locationName||"Select location",pickupDate:l.pickupDate||new Date().toISOString().split("T")[0],pickupTime:l.pickupTime||"15:00",returnDate:l.returnDate||new Date(new Date().getTime()+24*60*60*1e3).toISOString().split("T")[0],returnTime:l.returnTime||"19:00",calendarMode:null,currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear()};const R=new Date,O=new Date(R.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:R.toISOString().split("T")[0],pickupTime:"15:00",returnDate:O.toISOString().split("T")[0],returnTime:"19:00",calendarMode:null,currentMonth:R.getMonth(),currentYear:R.getFullYear()}}),[g,v]=y.useState(""),j=Array.from({length:18},(R,O)=>`${(6+O).toString().padStart(2,"0")}:00`);y.useEffect(()=>{B()},[f.pickupDate,f.pickupTime,f.returnDate,f.returnTime]),y.useEffect(()=>{if(e){const R=document.querySelector(".search-modal-body");R&&(R.scrollTop=0)}},[e]),y.useEffect(()=>{e&&l&&p(R=>({...R,location:l.location||"",locationName:l.locationName||"Select location",pickupDate:l.pickupDate||R.pickupDate,pickupTime:l.pickupTime||"15:00",returnDate:l.returnDate||R.returnDate,returnTime:l.returnTime||"19:00"}))},[e,l]);function k(){u(!1),t()}function C(){u(!0)}function S(R,O,I){p(D=>({...D,location:R,locationName:O})),u(!1)}function P(R){p(O=>({...O,calendarMode:O.calendarMode===R?null:R}))}function _(R){const O=`${R}-time`;p(I=>({...I,calendarMode:I.calendarMode===O?null:O}))}function x(R){p(O=>{let I=O.currentMonth+R,D=O.currentYear;return I>11&&(I=0,D++),I<0&&(I=11,D--),{...O,currentMonth:I,currentYear:D}})}function w(R){p(O=>{const I={...O};if(O.calendarMode==="pickup"){I.pickupDate=R;const D=new Date(`${R}T${O.pickupTime}`);if(new Date(`${O.returnDate}T${O.returnTime}`)<=D){I.returnDate=R;const te=parseInt(O.pickupTime.split(":")[0]),G=Math.min(te+2,23);I.returnTime=`${G.toString().padStart(2,"0")}:00`}}else I.returnDate=R;return I.calendarMode=null,I})}function b(R,O){p(I=>({...I,[R+"Time"]:O,calendarMode:null}))}function B(){try{const R=new Date(`${f.pickupDate}T${f.pickupTime}`),I=new Date(`${f.returnDate}T${f.returnTime}`)-R,D=Math.floor(I/(1e3*60*60));if(D<0)return v("Invalid duration");if(D===0)return v("Less than 1 hour");const q=Math.floor(D/24),te=D%24;let G="";q>0&&(G+=`${q} day${q>1?"s":""} `),te>0&&(G+=`${te} hour${te>1?"s":""}`),v(G.trim()||"0 hours")}catch{v("")}}function T(){if(!f.location){alert("Please select a pick-up location");return}const R=new Date(`${f.pickupDate}T${f.pickupTime}`),O=new Date(`${f.returnDate}T${f.returnTime}`);if(O<=R){alert("Return date and time must be after pick-up date and time.");return}if((O-R)/(1e3*60*60)<1){alert("Minimum rental duration is 1 hour.");return}a&&a(f)}function F(){const R=new Date(f.currentYear,f.currentMonth,1),O=new Date(f.currentYear,f.currentMonth+1,0),I=new Date;I.setHours(0,0,0,0);const D=[];for(let q=0;q<R.getDay();q++)D.push(i.jsx("div",{className:"calendar-day"},`empty-${q}`));for(let q=1;q<=O.getDate();q++){const te=`${f.currentYear}-${(f.currentMonth+1).toString().padStart(2,"0")}-${q.toString().padStart(2,"0")}`,G=new Date(f.currentYear,f.currentMonth,q),E=G.toDateString()===I.toDateString(),oe=G<I,Ne=te===(f.calendarMode==="pickup"?f.pickupDate:f.returnDate),W=["calendar-day"];oe&&W.push("disabled"),E&&W.push("today"),Ne&&W.push("selected"),D.push(i.jsx("div",{className:W.join(" "),onClick:()=>{oe||w(te)},children:q},te))}return D}return e?i.jsxs(i.Fragment,{children:[!c&&i.jsx("div",{className:"search-modal-backdrop",onClick:k}),i.jsx(Pj,{isOpen:c,onClose:()=>u(!1),stations:n,onSelectStation:S,selectedStationId:f.location,userLocation:s}),i.jsx("div",{className:`search-modal ${e?"active":""} ${c?"with-map":""}`,children:i.jsxs("div",{className:"search-modal-content",children:[i.jsxs("div",{className:"search-modal-header",children:[i.jsx("h3",{children:"Search Cars"}),i.jsx("button",{className:"search-modal-close",onClick:k,children:""})]}),i.jsxs("div",{className:"search-modal-body",children:[i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),i.jsxs("div",{className:"search-input",onClick:C,children:[i.jsx("i",{className:"fas fa-map-marker-alt"}),i.jsx("span",{children:f.locationName})]})]}),i.jsxs("div",{className:"search-field-row",children:[i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),i.jsxs("div",{className:"search-input",onClick:()=>P("pickup"),children:[i.jsx("i",{className:"fas fa-calendar"}),i.jsx("span",{children:new Date(f.pickupDate).toLocaleDateString()})]}),f.calendarMode==="pickup"&&i.jsxs("div",{className:"calendar-dropdown active",children:[i.jsxs("div",{className:"calendar-header",children:[i.jsx("button",{onClick:()=>x(-1),children:"<"}),i.jsx("span",{children:new Date(f.currentYear,f.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:()=>x(1),children:">"})]}),i.jsxs("div",{className:"calendar-weekdays",children:[i.jsx("div",{children:"Sun"}),i.jsx("div",{children:"Mon"}),i.jsx("div",{children:"Tue"}),i.jsx("div",{children:"Wed"}),i.jsx("div",{children:"Thu"}),i.jsx("div",{children:"Fri"}),i.jsx("div",{children:"Sat"})]}),i.jsx("div",{className:"calendar-days",children:F()})]})]}),i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),i.jsxs("div",{className:"search-input",onClick:()=>_("pickup"),children:[i.jsx("i",{className:"fas fa-clock"}),i.jsx("span",{children:f.pickupTime})]}),i.jsxs("div",{className:`time-picker-dropdown ${f.calendarMode==="pickup-time"?"active":""}`,children:[i.jsx("div",{className:"time-picker-label",children:"Choose pick-up time"}),i.jsx("div",{className:"time-picker-options",children:j.map(R=>i.jsx("div",{className:`time-option ${R===f.pickupTime?"selected":""}`,onClick:()=>b("pickup",R),children:R},R))})]})]})]}),i.jsxs("div",{className:"search-field-row",children:[i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),i.jsxs("div",{className:"search-input",onClick:()=>P("return"),children:[i.jsx("i",{className:"fas fa-calendar-check"}),i.jsx("span",{children:new Date(f.returnDate).toLocaleDateString()})]}),f.calendarMode==="return"&&i.jsxs("div",{className:"calendar-dropdown active",children:[i.jsxs("div",{className:"calendar-header",children:[i.jsx("button",{onClick:()=>x(-1),children:"<"}),i.jsx("span",{children:new Date(f.currentYear,f.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:()=>x(1),children:">"})]}),i.jsxs("div",{className:"calendar-weekdays",children:[i.jsx("div",{children:"Sun"}),i.jsx("div",{children:"Mon"}),i.jsx("div",{children:"Tue"}),i.jsx("div",{children:"Wed"}),i.jsx("div",{children:"Thu"}),i.jsx("div",{children:"Fri"}),i.jsx("div",{children:"Sat"})]}),i.jsx("div",{className:"calendar-days",children:F()})]})]}),i.jsxs("div",{className:"search-field",children:[i.jsxs("label",{children:[i.jsx("i",{className:"fas fa-clock"})," Return Time"]}),i.jsxs("div",{className:"search-input",onClick:()=>_("return"),children:[i.jsx("i",{className:"fas fa-clock"}),i.jsx("span",{children:f.returnTime})]}),i.jsxs("div",{className:`time-picker-dropdown ${f.calendarMode==="return-time"?"active":""}`,children:[i.jsx("div",{className:"time-picker-label",children:"Choose return time"}),i.jsx("div",{className:"time-picker-options",children:j.map(R=>i.jsx("div",{className:`time-option ${R===f.returnTime?"selected":""}`,onClick:()=>b("return",R),children:R},R))})]})]})]}),i.jsxs("div",{className:"rental-duration",children:[i.jsx("i",{className:"fas fa-info-circle"}),i.jsxs("div",{children:[i.jsx("strong",{children:"Rental Duration"}),i.jsx("p",{children:g})]})]}),i.jsxs("div",{className:"rental-warning",children:[i.jsx("i",{className:"fas fa-exclamation-circle"}),i.jsx("p",{children:"Minimum rental duration is 1 hour. Same-day rentals are available. To ensure cars are properly prepared and meet environmental standards, please book at least 2 hours in advance."})]}),i.jsxs("button",{className:"btn-search-submit",onClick:T,children:[i.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})]})})]}):null}function bj(){const[e,t]=y.useState([]),[n,s]=y.useState([]),[a,l]=y.useState(!0),[c,u]=y.useState(0),f=y.useRef(null),[p,g]=y.useState(null),[v,j]=y.useState(!1),[k,C]=y.useState(0),S=["/Picture/E car 1.jpg","/Picture/E car 3.png","/Picture/E car 2.png"],P=y.useRef(null),{showToast:_}=Su();y.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(R=>{const O=R.coords.accuracy;g({lat:R.coords.latitude,lng:R.coords.longitude}),console.log(" User location:",R.coords.latitude,R.coords.longitude),console.log(" Accuracy:",O,"meters"),O>100&&console.warn(" Location accuracy is low (>"+O+"m). Position may not be precise.")},R=>{console.error(" Could not get user location:",R.message),g({lat:10.8231,lng:106.6297}),_("Could not detect your location. Using default location.","warning",3e3)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.warn("Geolocation is not supported by this browser"),g({lat:10.8231,lng:106.6297}),_("Your browser does not support geolocation","warning",3e3));const T=async()=>{try{if(!jd.getAllStations){console.warn("stationApi.getAllStations not available");return}const R=await jd.getAllStations(1,500);console.log(" Loaded stations in HomePage:",R.length,"items"),t(R||[])}catch(R){console.error("Failed to load stations",R)}},F=async()=>{try{if(!En.getAllCars){console.warn("carApi.getAllCars not available"),l(!1);return}l(!0);const R=await En.getAllCars(1,100);console.log(" Loaded cars in HomePage:",R.length,"items"),s(R||[])}catch(R){console.error("Failed to load cars",R)}finally{l(!1)}};T(),F()},[]),y.useEffect(()=>{if(v)return;const T=setInterval(()=>{C(F=>(F+1)%S.length)},6e3);return()=>clearInterval(T)},[S.length,v]),y.useEffect(()=>{const T=f.current;if(!T)return;const F=T.querySelector(".car-card-item");if(!F)return;const R=F.offsetWidth,I=c*(R+20);T.style.transform=`translateX(-${I}px)`},[c,n]),y.useEffect(()=>{const T=()=>{const F=P.current;if(!F)return;const R=document.querySelector(".header"),O=R?R.offsetHeight:80;window.scrollY>O+50?(F.classList.add("sticky"),F.style.top=`${O}px`):(F.classList.remove("sticky"),F.style.top="")};return window.addEventListener("scroll",T,{passive:!0}),T(),()=>window.removeEventListener("scroll",T)},[]);function x(){j(!0)}function w(){j(!1)}function b(T){const F={stationId:T.location,stationName:T.locationName,pickupDate:T.pickupDate,pickupTime:T.pickupTime,returnDate:T.returnDate,returnTime:T.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(F))}catch{}const R=new URLSearchParams({location:T.location,"pickup-date":T.pickupDate,"pickup-time":T.pickupTime,"return-date":T.returnDate,"return-time":T.returnTime});window.location.href=`/cars?${R.toString()}`}function B(){const T=f.current;if(!T)return;const F=T.querySelector(".car-card-item");if(!F)return;const R=Math.floor(T.parentElement.offsetWidth/(F.offsetWidth+20))||1,O=Math.min(n.length,10),I=Math.max(0,Math.ceil(O-R));u(D=>Math.min(I,D+1))}return i.jsxs("main",{children:[i.jsxs("section",{className:"hero-slideshow",children:[i.jsx("div",{className:"slideshow-container",children:S.map((T,F)=>i.jsx("div",{className:`slide fade ${F===k?"active":""}`,children:i.jsx("img",{src:T,alt:`Electric Car ${F+1}`})},F))}),i.jsx("div",{className:"search-form-overlay",id:"searchFormOverlay",ref:P,children:i.jsx("div",{className:"container",children:i.jsxs("div",{className:"search-form-wrapper",children:[i.jsx("h2",{children:"Find Your Perfect Rental Car"}),i.jsxs("div",{className:"search-summary",children:[i.jsxs("div",{className:"summary-item",onClick:x,children:[i.jsx("div",{className:"summary-label",children:"Pick-up Location"}),i.jsx("div",{className:"summary-value",id:"summaryLocation",children:"Select location"})]}),i.jsxs("div",{className:"summary-item",onClick:x,children:[i.jsx("div",{className:"summary-label",children:"Pick-up Date"}),i.jsx("div",{className:"summary-value",children:new Date().toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:x,children:[i.jsx("div",{className:"summary-label",children:"Pick-up Time"}),i.jsx("div",{className:"summary-value",children:"15:00"})]}),i.jsxs("div",{className:"summary-item",onClick:x,children:[i.jsx("div",{className:"summary-label",children:"Return Date"}),i.jsx("div",{className:"summary-value",children:new Date(Date.now()+24*60*60*1e3).toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:x,children:[i.jsx("div",{className:"summary-label",children:"Return Time"}),i.jsx("div",{className:"summary-value",children:"19:00"})]}),i.jsxs("button",{type:"button",className:"btn-search",onClick:x,children:[i.jsx("i",{className:"fas fa-search"})," SEARCH"]})]})]})})})]}),i.jsx(ry,{isOpen:v,onClose:w,stations:e,userLocation:p,onSearch:b}),i.jsx("section",{className:"car-section","data-type":"models",children:i.jsxs("div",{className:"container",children:[i.jsx("div",{className:"car-section-header",children:i.jsx("h2",{children:"Our Electric Car Models"})}),i.jsxs("div",{className:"car-carousel-wrapper",children:[i.jsx("button",{className:"carousel-nav prev-carousel",onClick:()=>u(T=>Math.max(0,T-1)),children:i.jsx("i",{className:"fas fa-chevron-left"})}),i.jsx("div",{className:"car-carousel-container",id:"carCarouselContainer",children:i.jsxs("div",{className:"car-carousel-inner",id:"carCarouselInner",ref:f,children:[a&&i.jsx("div",{className:"car-card-item loading-placeholder",style:{textAlign:"center",padding:20},children:"Loading cars..."}),!a&&n.slice(0,10).map((T,F)=>{T.id||T.Id||T.carId;const R=T.name||T.Name||T.model||T.modelName||"Unknown",O=T.imageUrl||T.ImageUrl||T.image||"/Picture/E car 1.jpg",I=parseFloat(T.rentalPricePerHour||T.RentalPricePerHour||0),D=T.seats||T.Seats;return i.jsxs("div",{className:"car-card-item",children:[i.jsx("div",{className:"car-image",children:i.jsx("img",{src:O,alt:R,onError:q=>q.currentTarget.src="/Picture/E car 1.jpg"})}),i.jsxs("div",{className:"car-info",children:[i.jsx("h3",{className:"car-name",children:R}),i.jsxs("div",{className:"car-price-simple",children:[i.jsx("span",{className:"price-amount",children:Rt(I)}),i.jsx("span",{className:"price-label",children:"/hour"})]}),i.jsx("div",{className:"car-specs",children:D?i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-users"})," ",D," Seats"]}):null})]})]},F)})]})}),i.jsx("button",{className:"carousel-nav next-carousel",onClick:()=>B(),children:i.jsx("i",{className:"fas fa-chevron-right"})})]})]})})]})}function Ij(){const[e,t]=y.useState([]),[n,s]=y.useState([]),[a,l]=y.useState(!0),[c,u]=y.useState([]),[f,p]=y.useState({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),[g,v]=y.useState("default"),[j,k]=y.useState(()=>{const I=new Date,D=new Date(I.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:I.toISOString().split("T")[0],pickupTime:"15:00",returnDate:D.toISOString().split("T")[0],returnTime:"19:00"}}),[C,S]=y.useState(!1),[P,_]=y.useState(null);y.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(I=>{_({lat:I.coords.latitude,lng:I.coords.longitude})},I=>{console.error(" Could not get user location:",I.message),_({lat:10.8231,lng:106.6297})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):_({lat:10.8231,lng:106.6297}),x(),w()},[]);const x=async()=>{try{const I=await jd.getAllStations(1,500);u(I||[])}catch(I){console.error("Failed to load stations",I)}},w=async()=>{try{l(!0);let I=null,D=null;try{const te=JSON.parse(localStorage.getItem("rentalContext")||"null");te&&(I=te.stationId,D=te,k(G=>({...G,location:te.stationId,locationName:te.stationName,pickupDate:te.pickupDate,pickupTime:te.pickupTime,returnDate:te.returnDate,returnTime:te.returnTime})))}catch{}let q=[];if(I&&D){console.log(" Loading cars for station:",I);try{const te=`${D.pickupDate}T${D.pickupTime}:00`,G=`${D.returnDate}T${D.returnTime}:00`;console.log(" Pickup DateTime (local):",te),console.log(" Return DateTime (local):",G),q=await En.getAvailableCarsByStation(I,te,G),console.log(" Found",q.length,"cars at this station")}catch(te){console.error("Failed to load cars by station, falling back to all cars",te),q=await En.getAllCars(1,100)}}else q=await En.getAllCars(1,100);t(q||[]),s(q||[])}catch(I){console.error(I)}finally{l(!1)}};function b(){S(!0)}function B(){S(!1)}function T(I){k({location:I.location,locationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime});const D={stationId:I.location,stationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(D))}catch{}l(!0);const q=`${I.pickupDate}T${I.pickupTime}:00`,te=`${I.returnDate}T${I.returnTime}:00`;console.log(" Pickup DateTime (local):",q),console.log(" Return DateTime (local):",te),En.getAvailableCarsByStation(I.location,q,te).then(G=>{t(G||[]),s(G||[]),l(!1),B()}).catch(G=>{console.error("Failed to load station cars:",G),alert("Failed to load cars for this station"),l(!1)})}y.useEffect(()=>{let I=[...e];f.brand&&(I=I.filter(D=>(D.brand||"").toLowerCase().includes(f.brand.toLowerCase()))),f.color&&(I=I.filter(D=>(D.color||"").toLowerCase().includes(f.color.toLowerCase()))),f.seats&&(I=I.filter(D=>D.seats===parseInt(f.seats))),f.year&&(I=I.filter(D=>D.year>=parseInt(f.year))),f.priceMin&&(I=I.filter(D=>parseFloat(D.rentalPricePerHour||0)>=parseFloat(f.priceMin))),f.priceMax&&(I=I.filter(D=>parseFloat(D.rentalPricePerHour||0)<=parseFloat(f.priceMax))),g==="name-asc"?I.sort((D,q)=>{const te=`${D.brand||""} ${D.model||""}`.trim().toLowerCase(),G=`${q.brand||""} ${q.model||""}`.trim().toLowerCase();return te.localeCompare(G)}):g==="name-desc"?I.sort((D,q)=>{const te=`${D.brand||""} ${D.model||""}`.trim().toLowerCase();return`${q.brand||""} ${q.model||""}`.trim().toLowerCase().localeCompare(te)}):g==="price-asc"?I.sort((D,q)=>{const te=parseFloat(D.rentalPricePerHour||D.RentalPricePerHour||0),G=parseFloat(q.rentalPricePerHour||q.RentalPricePerHour||0);return te-G}):g==="price-desc"&&I.sort((D,q)=>{const te=parseFloat(D.rentalPricePerHour||D.RentalPricePerHour||0);return parseFloat(q.rentalPricePerHour||q.RentalPricePerHour||0)-te}),s(I)},[e,f,g]);const F=()=>{p({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),s(e)},R=[...new Set(e.map(I=>I.brand).filter(Boolean))],O=[...new Set(e.map(I=>I.color).filter(Boolean))];return Array.from({length:18},(I,D)=>`${(6+D).toString().padStart(2,"0")}:00`),i.jsxs("main",{className:"car-list-main",children:[i.jsx("div",{className:"search-form-container",children:i.jsxs("div",{className:"search-summary",children:[i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),i.jsx("div",{className:"summary-value",children:j.locationName})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),i.jsx("div",{className:"summary-value",children:new Date(j.pickupDate).toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),i.jsx("div",{className:"summary-value",children:j.pickupTime})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),i.jsx("div",{className:"summary-value",children:new Date(j.returnDate).toLocaleDateString()})]}),i.jsxs("div",{className:"summary-item",onClick:b,children:[i.jsxs("div",{className:"summary-label",children:[i.jsx("i",{className:"fas fa-clock"})," Return Time"]}),i.jsx("div",{className:"summary-value",children:j.returnTime})]}),i.jsxs("button",{className:"btn-search-submit",onClick:b,children:[i.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})}),i.jsxs("div",{className:"container",children:[i.jsxs("aside",{className:"filters-sidebar",children:[i.jsx("h3",{className:"filters-title",children:"Filters"}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Brand"}),i.jsx("div",{className:"filter-group",children:i.jsxs("select",{value:f.brand,onChange:I=>p({...f,brand:I.target.value}),children:[i.jsx("option",{value:"",children:"Any Brand"}),R.map(I=>i.jsx("option",{value:I,children:I},I))]})})]}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Color"}),i.jsx("div",{className:"filter-group",children:i.jsxs("select",{value:f.color,onChange:I=>p({...f,color:I.target.value}),children:[i.jsx("option",{value:"",children:"Any Color"}),O.map(I=>i.jsx("option",{value:I,children:I},I))]})})]}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Specifications"}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Seats"}),i.jsxs("select",{value:f.seats,onChange:I=>p({...f,seats:I.target.value}),children:[i.jsx("option",{value:"",children:"Any"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"5",children:"5"}),i.jsx("option",{value:"7",children:"7"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Year (min)"}),i.jsx("input",{type:"number",min:"1900",max:"2100",placeholder:"2020",value:f.year,onChange:I=>p({...f,year:I.target.value})})]})]}),i.jsxs("div",{className:"filter-section",children:[i.jsx("h4",{children:"Price Range"}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Min Price (VND/hour)"}),i.jsx("input",{type:"number",min:"0",placeholder:"0",value:f.priceMin,onChange:I=>p({...f,priceMin:I.target.value})})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Max Price (VND/hour)"}),i.jsx("input",{type:"number",min:"0",placeholder:"999,000",value:f.priceMax,onChange:I=>p({...f,priceMax:I.target.value})})]})]}),i.jsx("div",{className:"filter-actions",children:i.jsx("button",{type:"button",className:"btn-reset-filters",onClick:F,children:"Reset Filters"})})]}),i.jsxs("div",{className:"cars-content",children:[i.jsxs("div",{className:"cars-header",children:[i.jsxs("div",{children:[i.jsx("h2",{children:"Available Cars"}),i.jsxs("div",{className:"cars-count",children:["Showing ",n.length," cars"]})]}),i.jsxs("div",{className:"sort-controls",children:[i.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),i.jsxs("select",{id:"sortBy",value:g,onChange:I=>v(I.target.value),className:"sort-select",children:[i.jsx("option",{value:"default",children:"Default"}),i.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),i.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),i.jsx("option",{value:"price-asc",children:"Price (Low to High)"}),i.jsx("option",{value:"price-desc",children:"Price (High to Low)"})]})]})]}),i.jsxs("div",{className:"car-list",children:[a&&i.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading cars..."}),!a&&n.length===0&&i.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"No cars found"}),!a&&n.map((I,D)=>{const q=I.id||I.Id,te=`${I.brand||""} ${I.model||"Car"}`.trim(),G=I.imageUrl||I.image||"/Picture/E car 1.jpg",E=parseFloat(I.rentalPricePerHour||I.RentalPricePerHour||0),oe=I.seats||I.Seats||5,Ne=I.year||"",W=I.color||"N/A";return i.jsxs("div",{className:"car-card",onClick:()=>window.location.href=`/cars/${q}`,children:[i.jsx("div",{className:"car-image",children:i.jsx("img",{src:G,alt:te,onError:fe=>fe.currentTarget.src="/Picture/E car 1.jpg"})}),i.jsxs("div",{className:"car-info",children:[i.jsxs("div",{className:"car-info-top",children:[i.jsxs("div",{children:[i.jsx("div",{className:"car-name",children:te}),i.jsxs("div",{className:"car-location",children:[i.jsx("i",{className:"fas fa-map-marker-alt"}),j.locationName||"Location"]})]}),i.jsxs("div",{className:"car-pricing",children:[i.jsx("div",{className:"car-price",children:Rt(E)}),i.jsx("div",{className:"car-price-label",children:"/hour"})]})]}),i.jsxs("div",{className:"car-details",children:[i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-palette"})," ",W]}),i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-calendar"})," ",Ne||"N/A"]}),i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-users"})," ",oe," seats"]})]})]})]},D)})]})]})," "]})," ",i.jsx(ry,{isOpen:C,onClose:B,stations:c,userLocation:P,onSearch:T,currentSearchData:j})]})}function Lj(){const{id:e}=i_(),t=hr(),[n,s]=y.useState(null),[a,l]=y.useState(!0);if(y.useEffect(()=>{e&&(async()=>{try{l(!0);const g=await En.getCarById(e);s(g)}catch(g){console.error(g)}finally{l(!1)}})()},[e]),a)return i.jsx("main",{className:"car-detail-main",children:i.jsx("div",{className:"container",children:i.jsx("div",{className:"loading-message",children:"Loading..."})})});if(!n)return i.jsx("main",{className:"car-detail-main",children:i.jsx("div",{className:"container",children:i.jsx("div",{className:"error-message",children:"Car not found"})})});const c=n.imageUrl||n.image||"/Picture/E car 1.jpg",u=`${n.brand||""} ${n.model||"Car"}`.trim(),f=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return i.jsx("main",{className:"car-detail-main",children:i.jsxs("div",{className:"container",children:[i.jsxs("button",{className:"back-btn",onClick:()=>t("/cars"),children:[i.jsx("i",{className:"fas fa-arrow-left"})," Back to Cars"]}),i.jsxs("div",{className:"car-detail-grid",children:[i.jsxs("div",{className:"car-left-section",children:[i.jsx("div",{className:"car-image-section",children:i.jsx("div",{className:"main-image",children:i.jsx("img",{src:c,alt:u,onError:p=>p.currentTarget.src="/Picture/E car 1.jpg"})})}),i.jsxs("div",{className:"car-specs",children:[i.jsx("h3",{children:"Car Information"}),i.jsxs("div",{className:"specs-grid",children:[i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-car"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Brand"}),i.jsx("div",{className:"spec-value",children:n.brand||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-palette"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Color"}),i.jsx("div",{className:"spec-value",children:n.color||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-users"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Seats"}),i.jsx("div",{className:"spec-value",children:n.seats||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-calendar"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Year"}),i.jsx("div",{className:"spec-value",children:n.year||"N/A"})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-battery-full"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Battery Range"}),i.jsxs("div",{className:"spec-value",children:[n.batteryCapacity||"N/A"," km"]})]})]}),i.jsxs("div",{className:"spec-item",children:[i.jsx("i",{className:"fas fa-cog"}),i.jsxs("div",{className:"spec-info",children:[i.jsx("div",{className:"spec-label",children:"Transmission"}),i.jsx("div",{className:"spec-value",children:n.transmission||"Automatic"})]})]})]})]}),n.description&&i.jsxs("div",{className:"car-description",children:[i.jsx("h3",{children:"Description"}),i.jsx("p",{children:n.description||n.Description})]})]}),i.jsx("div",{className:"car-right-section",children:i.jsxs("div",{className:"pricing-card",children:[i.jsxs("div",{className:"car-header",children:[i.jsx("h1",{className:"car-title",children:u}),n.year&&i.jsx("span",{className:"car-year",children:n.year})]}),i.jsxs("div",{className:"price-section",children:[i.jsx("div",{className:"price-label",children:"Rental Price"}),i.jsxs("div",{className:"price-value",children:[Rt(f),"/hour"]}),i.jsxs("div",{className:"price-note",children:["Estimated daily rate: ",Rt(Math.round(f*24)),"/day"]})]}),i.jsxs("div",{className:"rental-info",children:[i.jsx("h3",{children:"Rental Details"}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-clock"}),i.jsx("span",{children:"Minimum rental: 1 hour"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-shield-alt"}),i.jsx("span",{children:"Insurance included"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-gas-pump"}),i.jsx("span",{children:"Fuel policy: Same to same"})]}),i.jsxs("div",{className:"info-item",children:[i.jsx("i",{className:"fas fa-map-marked-alt"}),i.jsx("span",{children:"Unlimited mileage"})]})]}),i.jsxs("button",{className:"book-now-btn",onClick:()=>{localStorage.setItem("selectedCarId",n.id||n.Id),t("/payment")},children:[i.jsx("i",{className:"fas fa-check-circle"})," Book Now"]})]})})]})]})})}const zt={createBooking:async(e,t)=>{var n,s,a,l;try{console.log(" Creating booking for user:",t),console.log(" Booking data:",e);const c={carId:e.carId,stationId:e.pickupStationId||e.returnStationId||e.stationId,pickupDateTime:e.pickupDateTime,expectedReturnDateTime:e.expectedReturnDateTime};console.log(" Sending payload:",c);const u=await de.post(`/Bookings/Create-With-Deposit?userId=${encodeURIComponent(t)}`,c);return console.log(" Booking created:",u.data),((n=u.data)==null?void 0:n.data)||u.data||{}}catch(c){throw console.error(" Error creating booking:",((s=c.response)==null?void 0:s.data)||c.message),(l=(a=c.response)==null?void 0:a.data)!=null&&l.errors&&console.error(" Validation errors:",c.response.data.errors),c}},confirmBooking:async(e,t,n="")=>{var s,a;try{console.log(" Confirming booking:",e);const l={bookingId:e,paymentMethod:t,paymentTransactionId:n},c=await de.post("/Bookings/Confirm",l);return console.log(" Booking confirmed:",c.data),((s=c.data)==null?void 0:s.data)||c.data||{}}catch(l){throw console.error(" Error confirming booking:",((a=l.response)==null?void 0:a.data)||l.message),l}},completeBooking:async e=>{var t,n;try{console.log(" Completing booking:",e);const s=await de.post(`/Bookings/Complete-By-${encodeURIComponent(e)}`);return console.log(" Booking completed:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error completing booking:",((n=s.response)==null?void 0:n.data)||s.message),s}},getUserBookings:async e=>{var t;try{console.log(" Fetching bookings for current user");const n=await de.get("/Bookings/My-Bookings");console.log(" Raw /Bookings/My-Bookings response:",n.data);const s=n.data||{};return Array.isArray(s)?(console.log(" Returning bookings (direct array), count:",s.length),s):s.data&&Array.isArray(s.data)?(console.log(" Returning bookings from response.data, count:",s.data.length),s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning bookings from response.data.data, count:",s.data.data.length),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning bookings from response.data.items, count:",s.data.items.length),s.data.items):s.items&&Array.isArray(s.items)?(console.log(" Returning bookings from response.items, count:",s.items.length),s.items):s.bookings&&Array.isArray(s.bookings)?(console.log(" Returning bookings from response.bookings, count:",s.bookings.length),s.bookings):s&&(s.id||s.bookingId||s.bookingStatus)?(console.log(" Response looks like a single booking object, wrapping in array"),[s]):(console.warn(" No bookings array found in /Bookings/My-Bookings response; returning empty array"),[])}catch(n){if(console.error(" Error fetching user bookings:",((t=n.response)==null?void 0:t.data)||n.message),n.response&&n.response.status===401)throw n;return[]}},cancelBooking:async(e,t)=>{var n,s;try{console.log(" Cancelling booking:",e);const a=await de.post(`/Bookings/Cancel-By-${encodeURIComponent(e)}`,null,{params:{userId:t}});return console.log(" Booking cancelled:",a.data),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error cancelling booking:",((s=a.response)==null?void 0:s.data)||a.message),a}},getBookingById:async e=>{var t,n;try{console.log(" Fetching booking details for ID:",e);const s=await de.get(`/Bookings/Get-By-${encodeURIComponent(e)}`);return console.log(" Booking details:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking details:",((n=s.response)==null?void 0:n.data)||s.message),s}}},Jh={getContractByBooking:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Booking/${t}`,`/Contract/Get-By-Booking/${t}`,`/Contracts/By-Booking/${t}`,`/contracts/booking/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(u)return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},getContractByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contract/Get-By-Renter/${t}`,`/Contracts/By-Renter/${t}`,`/contracts/renter/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(u)return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},createRentalContract:async(e,t=null,n=null)=>{var c;if(!e)throw new Error("bookingId is required");let s=`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(e)}`;t&&(s+=`&renterId=${encodeURIComponent(t)}`);const a=[{url:s,method:"post",data:n},{url:"/Contracts/Create",method:"post",data:{bookingId:e}},{url:"/Contract/Create",method:"post",data:{bookingId:e}}];let l;for(const u of a)try{const f=await de[u.method](u.url,u.data||{}),p=f==null?void 0:f.data;return p&&typeof p=="object"&&"data"in p?p.data:p}catch(f){l=f;const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}throw l||new Error("Create contract endpoint not found")},sendContractEmail:async(e,t=null)=>{var l,c,u;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e);console.log(" sendContractEmail called with contractId:",e,"email:",t);const s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,"/Contract/SendEmail"];let a;for(const f of s)try{console.log(" Trying endpoint:",f);const p=await de.post(f,t?{email:t}:{}),g=p==null?void 0:p.data;return console.log(" Success on endpoint:",f,"response:",g),g&&typeof g=="object"&&"data"in g?g.data:g}catch(p){console.warn(" Failed on endpoint:",f,"status:",(l=p==null?void 0:p.response)==null?void 0:l.status,"error:",((c=p==null?void 0:p.response)==null?void 0:c.data)||(p==null?void 0:p.message)),a=p;const g=(u=p==null?void 0:p.response)==null?void 0:u.status;if(g&&g!==404&&g!==405)throw p}throw console.error(" All endpoints failed for sendContractEmail"),a||new Error("Send contract email endpoint not found")},isContractConfirmed:async e=>{var s;if(!e)return!1;const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/xac-nhan`,`/Contracts/Get-By-Booking/${t}`,`/Contracts/${t}/Is-Confirmed`,"/Contract/IsConfirmed"];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;return u===!0||(u==null?void 0:u.isConfirmed)===!0||(u==null?void 0:u.IsConfirmed)===!0}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return!1},confirmContractSigning:async e=>{var a;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/ky`,`/Contracts/${t}/Confirm`,"/Contract/ConfirmSigning"];let s;for(const l of n)try{const c=await de.post(l),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){s=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}throw s||new Error("Confirm contract signing endpoint not found")},deleteContract:async e=>{var a;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}`,`/Contracts/${t}`,`/Contract/Delete/${t}`];let s;for(const l of n)try{const c=await de.delete(l),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){s=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}throw s||new Error("Delete contract endpoint not found")},downloadContract:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/${t}/Download`,`/Contract/Download/${t}`];for(const a of n)try{return(await de.get(a,{responseType:"blob"})).data}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Download contract endpoint not found")},getContractDownloadByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const a of n)try{return(await de.get(a,{responseType:"blob"})).data}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Get contract download link endpoint not found")},getContractViewingByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/View/${t}`,`/Contract/View/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null}},Hr={createPayment:async(e,t=0,n="Payment",s=0)=>{var a,l;try{console.log(" Creating payment for booking:",e,"| Type:",t,"| Extra amount:",s);const c={bookingId:e,paymentType:t,description:n};s>0&&(c.extraAmount=s);const u=await de.post("/Payment/create",c);return console.log(" Payment created:",u.data),((a=u.data)==null?void 0:a.data)||u.data||{}}catch(c){throw console.error(" Error creating payment:",((l=c.response)==null?void 0:l.data)||c.message),c}},syncPayment:async e=>{var t,n;try{console.log(" Syncing payment for booking:",e);const s=await de.post(`/Payment/sync/${encodeURIComponent(e)}`);return console.log(" Payment synced:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error syncing payment:",((n=s.response)==null?void 0:n.data)||s.message),s}}};function Ej(){const e=hr(),{showToast:t}=Su(),[n,s]=y.useState(null),[a,l]=y.useState(null),[c,u]=y.useState(!1),[f,p]=y.useState(!1),[g,v]=y.useState(!1),[j,k]=y.useState(!1),[C,S]=y.useState({isOpen:!1,type:"info",title:"",message:""});y.useEffect(()=>{try{const R=JSON.parse(localStorage.getItem("rentalContext")||"null");if(!R){alert("No rental information found. Please search for a car first."),e("/");return}l(R);const O=localStorage.getItem("selectedCarId");O&&En.getCarById(O).then(I=>s(I))}catch(R){console.error(R)}},[e]);const P=()=>{if(!a||!n)return 0;const R=new Date(`${a.pickupDate}T${a.pickupTime}`),O=new Date(`${a.returnDate}T${a.returnTime}`),I=Math.ceil((O-R)/(1e3*60*60)),D=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return I*D},_=()=>{if(!a)return 0;const R=new Date(`${a.pickupDate}T${a.pickupTime}`),O=new Date(`${a.returnDate}T${a.returnTime}`);return Math.ceil((O-R)/(1e3*60*60))},x=()=>n?parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0):0,w=()=>P()*.3,b=()=>{const R=new Date,O=String(R.getDate()).padStart(2,"0"),I=String(R.getMonth()+1).padStart(2,"0"),D=R.getFullYear(),q=localStorage.getItem("userFirstName")||"",te=localStorage.getItem("userLastName")||"",G=localStorage.getItem("userDateOfBirth")||"",E=localStorage.getItem("userIdentityNumber")||"",oe=localStorage.getItem("userAddress")||"",Ne=localStorage.getItem("userDriverLicenseClass")||"",W=localStorage.getItem("userDriverLicenseNumber")||"",fe=localStorage.getItem("userDriverLicenseExpiry")||"",re=new Date(`${a.pickupDate}T${a.pickupTime}`),U=new Date(`${a.returnDate}T${a.returnTime}`),ie=Math.ceil((U-re)/(1e3*60*60*24)),Z=P(),se=G?new Date(G).getFullYear().toString():"";return{soHopDong:`H-${R.getTime()}`,ngayKy:O,thangKy:I,namKy:D.toString(),benA:{hoTen:`${q} ${te}`,namSinh:se,cccdHoacHoChieu:E,hoKhauThuongTru:oe},xe:{nhanHieu:n.brand||"",bienSo:n.licensePlate||"",loaiXe:n.model||"",mauSon:n.color||"",choNgoi:(n.seats||0).toString(),xeDangKiHan:(n.year||"").toString()},giaThue:{giaThueSo:Z.toString(),giaThueChu:Z.toString(),phuongThucThanhToan:"Chuyn khon",ngayThanhToan:R.toISOString().split("T")[0]},thoiHanThueSo:ie.toString(),thoiHanThueChu:ie.toString(),thoiHanThue:ie,donViThoiHan:"ngay",gplx:{hang:Ne,so:W,hanSuDung:fe}}},B=async()=>{var R,O;if(!c){alert("Please agree to the Terms and Conditions and Privacy Policy to continue.");return}if(!n||!a){alert("Missing booking information. Please try again.");return}k(!0);try{const I=localStorage.getItem("userId");if(!I){alert("User ID not found. Please logout and login again."),e("/");return}const D=new Date(`${a.pickupDate}T${a.pickupTime}`).toISOString(),q=new Date(`${a.returnDate}T${a.returnTime}`).toISOString(),te=a.stationId;console.log(" Using station from rental context:",a.stationName,"- ID:",te);const G={carId:n.id||n.Id,userId:I,pickupStationId:te,returnStationId:te,pickupDateTime:D,expectedReturnDateTime:q,totalAmount:P()};console.log(" Creating booking with user-selected station..."),console.log(" Booking data:",G);const E=await zt.createBooking(G,I),oe=E.id||E.Id||E.bookingId;if(!oe)throw new Error("Booking ID not received from server");console.log(" Booking created:",oe),console.log(" Creating contract...");const Ne=b(),W=await Jh.createRentalContract(oe,I,Ne),fe=(W==null?void 0:W.id)||(W==null?void 0:W.contractId)||W;console.log(" Contract created with ID:",fe),console.log(" Full contract response:",W);try{const re=localStorage.getItem("userEmail");if(re&&fe){console.log(" Waiting 1s before sending email..."),await new Promise(ie=>setTimeout(ie,1e3)),console.log(" Sending contract email to:",re),console.log(" Contract ID being used:",fe);const U=await Jh.sendContractEmail(fe,re);console.log(" Email sent, response:",U)}}catch(re){console.warn(" Email failed (non-critical):",re.message),console.error(" Full error:",re)}try{console.log(" Creating deposit payment...");const re=w(),U=await Hr.createPayment(oe,0,"Cc thu xe");console.log(" Payment created:",U)}catch(re){console.warn(" Payment creation failed (non-critical):",re.message)}S({isOpen:!0,type:"success",title:"Booking Created Successfully! ",message:"The contract has been sent to your email. You have 10 minutes to sign the contract and complete the deposit payment before the reservation expires. You can view details in your Booking History."}),setTimeout(()=>{localStorage.removeItem("selectedCarId"),localStorage.removeItem("rentalContext"),e("/booking-history")},3e3)}catch(I){console.error(" Error:",I);const D=((O=(R=I.response)==null?void 0:R.data)==null?void 0:O.message)||I.message||"Failed to create booking";D.toLowerCase().includes("car not available")?(t("This car is not available, please choose another one!","error",4e3),setTimeout(()=>e("/cars"),2e3)):alert(D)}finally{k(!1)}};if(!a||!n)return i.jsx("div",{style:{padding:"2rem"},children:i.jsx("p",{children:"Loading..."})});const T=P(),F=w();return i.jsxs("main",{className:"payment-page",children:[i.jsxs("div",{className:"container",children:[i.jsx("h2",{children:"Confirm Your Reservation"}),i.jsx("div",{className:"payment-layout",children:i.jsxs("div",{className:"payment-info-column",children:[i.jsxs("div",{className:"info-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx("h3",{className:"section-heading",children:"Rental Information"}),i.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Change]"})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Pick-up Location:"}),i.jsx("span",{className:"info-value",children:a.stationName})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Pick-up Date & Time:"}),i.jsxs("span",{className:"info-value",children:[a.pickupDate," ",a.pickupTime]})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Return Date & Time:"}),i.jsxs("span",{className:"info-value",children:[a.returnDate," ",a.returnTime]})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Total Rental Time:"}),i.jsxs("span",{className:"info-value",children:[_()," hour",_()!==1?"s":""]})]})]}),i.jsxs("div",{className:"info-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx("h3",{className:"section-heading",children:"Car Information"}),i.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Pick another car ]"})]}),i.jsxs("div",{className:"car-preview",children:[i.jsx("img",{src:n.imageUrl||n.image||"/Picture/E car 1.jpg",alt:`${n.brand} ${n.model}`,onError:R=>{R.target.src="/Picture/E car 1.jpg"}}),i.jsxs("div",{className:"car-details",children:[i.jsxs("h4",{children:[n.brand," ",n.model]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Color:"})," ",n.color]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Seats:"})," ",n.seats]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Year:"})," ",n.year]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Price:"})," ",Rt(parseFloat(n.rentalPricePerHour||0)),"/hour"]})]})]})]}),i.jsxs("div",{className:"info-section price-summary-section",children:[i.jsx("h3",{className:"section-heading",children:"Price Summary"}),i.jsxs("div",{className:"price-breakdown",children:[i.jsxs("div",{className:"price-row",children:[i.jsx("span",{className:"price-label",children:"Unit Price:"}),i.jsxs("span",{className:"price-value",children:[i.jsx("span",{className:"price-amount",children:Rt(x())}),i.jsx("span",{className:"unit",children:"/hour"})]})]}),i.jsxs("div",{className:"price-row",children:[i.jsx("span",{className:"price-label",children:"Rental Time:"}),i.jsxs("span",{className:"price-value",children:[i.jsxs("span",{className:"price-amount",children:[" ",_()]}),i.jsxs("span",{className:"unit",children:[" hour",_()!==1?"s":""]})]})]}),i.jsx("div",{className:"price-divider"}),i.jsxs("div",{className:"price-row total-row",children:[i.jsx("span",{className:"price-label",children:"Total Rental Cost:"}),i.jsx("span",{className:"price-value-total",children:i.jsx("span",{className:"price-amount",children:Rt(T)})})]}),i.jsxs("div",{className:"price-row deposit-row-summary",children:[i.jsx("span",{className:"price-label",children:"Deposit Required (30%):"}),i.jsx("span",{className:"price-value-deposit",children:i.jsx("span",{className:"price-amount",children:Rt(F)})})]})]})]})]})}),i.jsx("div",{className:"terms-section",style:{marginTop:"18px"},children:i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:c,onChange:R=>u(R.target.checked)}),i.jsxs("span",{style:{marginLeft:"10px"},children:["I agree to the ",i.jsx("button",{type:"button",className:"link-button",onClick:()=>p(!0),children:"Terms and Conditions"})," and ",i.jsx("button",{type:"button",className:"link-button",onClick:()=>v(!0),children:"Privacy Policy"})]})]})}),i.jsx("div",{className:"cta-button-container",children:i.jsx("button",{className:"btn-confirm-booking",onClick:B,disabled:!c||j,children:j?"Creating...":"Confirm and Deposit"})})]}),i.jsx("div",{className:"page-actions",style:{maxWidth:"980px",margin:"20px auto 60px",padding:"0 1rem"},children:i.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"center"}})}),f&&i.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:i.jsxs("div",{className:"modal-content",onClick:R=>R.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Terms and Conditions"}),i.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsx("h4",{children:"1. Rental Agreement"}),i.jsx("p",{children:"By renting a vehicle from our service, you agree to use the vehicle responsibly and return it in the same condition as received."}),i.jsx("h4",{children:"2. Driver Requirements"}),i.jsx("p",{children:"The driver must be at least 21 years old and possess a valid driver's license for at least 1 year."}),i.jsx("h4",{children:"3. Vehicle Usage"}),i.jsx("p",{children:"The vehicle may only be driven by the person(s) listed on the rental agreement. Unauthorized drivers are prohibited."}),i.jsx("h4",{children:"4. Fuel Policy"}),i.jsx("p",{children:"For electric vehicles, please return the car with at least 70% battery charge. Additional charging fees may apply if returned below this level."}),i.jsx("h4",{children:"5. Damage and Liability"}),i.jsx("p",{children:"The renter is responsible for any damage to the vehicle during the rental period, excluding normal wear and tear."}),i.jsx("h4",{children:"6. Cancellation Policy"}),i.jsx("p",{children:"Cancellations made more than 24 hours before pick-up time will receive a full refund. Cancellations within 24 hours will forfeit the deposit."}),i.jsx("h4",{children:"7. Late Returns"}),i.jsx("p",{children:"Late returns will be charged at 1.5x the hourly rate for each additional hour."}),i.jsx("h4",{children:"8. Insurance"}),i.jsx("p",{children:"Basic insurance is included in the rental price. Additional coverage options are available at checkout."})]})]})}),g&&i.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:i.jsxs("div",{className:"modal-content",onClick:R=>R.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Privacy Policy"}),i.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsx("h4",{children:"1. Information Collection"}),i.jsx("p",{children:"We collect personal information including name, email, phone number, driver's license details, and payment information necessary to process your rental booking."}),i.jsx("h4",{children:"2. Use of Information"}),i.jsx("p",{children:"Your information is used solely for processing rentals, communication regarding your booking, and improving our services."}),i.jsx("h4",{children:"3. Data Security"}),i.jsx("p",{children:"We implement industry-standard security measures to protect your personal information from unauthorized access, disclosure, or misuse."}),i.jsx("h4",{children:"4. Third-Party Sharing"}),i.jsx("p",{children:"We do not sell or share your personal information with third parties except as required for payment processing or legal compliance."}),i.jsx("h4",{children:"5. Cookies"}),i.jsx("p",{children:"Our website uses cookies to enhance user experience and analyze site traffic. You can disable cookies in your browser settings."}),i.jsx("h4",{children:"6. Data Retention"}),i.jsx("p",{children:"We retain your booking information for 7 years as required by law. You may request deletion of your data at any time."}),i.jsx("h4",{children:"7. Your Rights"}),i.jsx("p",{children:"You have the right to access, correct, or delete your personal information. Contact our support team to exercise these rights."}),i.jsx("h4",{children:"8. Contact"}),i.jsx("p",{children:"For privacy concerns or questions, please contact us at privacy@carental.com"})]})]})}),i.jsx(Ca,{isOpen:C.isOpen,type:C.type,title:C.title,message:C.message,onClose:()=>S({...C,isOpen:!1})})]})}function Tj(){const e=hr(),[t,n]=y.useState(!0),[s,a]=y.useState(null);return y.useEffect(()=>{console.log(" Payment successful! Checking payment type..."),(async()=>{try{let c=localStorage.getItem("currentBookingId"),u="user-deposit";if(!c&&(c=localStorage.getItem("activeCheckInBookingId"),c)){u="staff-checkin",console.log(" Found check-in booking ID (staff payment):",c),console.log(" Staff check-in payment: Skipping auto-sync (manual sync button will be used)"),n(!1),localStorage.removeItem("activeCheckInBookingId"),setTimeout(()=>e("/staff"),1e3);return}if(!c&&(c=localStorage.getItem("activeCheckOutBookingId"),c)){u="staff-checkout",console.log(" Found check-out booking ID (staff payment):",c),console.log(" Staff check-out payment: Skipping auto-sync (manual sync button will be used)"),n(!1),localStorage.removeItem("activeCheckOutBookingId"),setTimeout(()=>e("/staff"),1e3);return}if(!c){console.warn(" No booking ID found in localStorage"),a("Booking ID not found"),n(!1),setTimeout(()=>e("/booking-history"),2e3);return}console.log(" User deposit payment: Auto-syncing payment for booking:",c),await Hr.syncPayment(c),console.log(" Payment status synced successfully"),console.log(" Fetching booking details to check status...");const f=await zt.getBookingById(c),p=Number((f==null?void 0:f.bookingStatus)||(f==null?void 0:f.BookingStatus));console.log(" Booking status after payment:",p,"(0=Pending, 1=Active, 2=Waiting Check-in, 3=Checked-in, 4=Check-out Pending, 5=Completed)"),n(!1),setTimeout(()=>{try{localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount")}catch(g){console.warn("Failed to clear storage:",g)}console.log(" User deposit payment complete, redirecting to booking history..."),e("/booking-history")},1500)}catch(c){console.error(" Error in payment sync flow:",c),a("Failed to process payment or create contract"),n(!1),setTimeout(()=>e("/booking-history"),3e3)}})()},[e]),i.jsx("main",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:i.jsx("div",{style:{textAlign:"center"},children:t?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),i.jsx("h1",{children:"Processing Payment..."}),i.jsx("p",{style:{color:"#000",marginTop:"8px"},children:"Please wait while we confirm your payment."})]}):s?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),i.jsx("h1",{children:"Payment Sync Issue"}),i.jsx("p",{style:{color:"#000",marginTop:"8px"},children:s}),i.jsx("p",{style:{color:"#000",marginTop:"8px",fontSize:"14px"},children:"Redirecting to booking history..."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),i.jsx("h1",{children:"Payment Successful!"}),i.jsx("p",{style:{color:"#000",marginTop:"8px"},children:"Your payment has been processed."}),i.jsx("p",{style:{color:"#000",marginTop:"8px",fontSize:"14px"},children:"Redirecting to booking history..."})]})})})}function Bj(){const e=hr(),{showToast:t}=Su(),[n]=C_(),[s,a]=y.useState(!0);return y.useEffect(()=>{(async()=>{console.log(" PaymentCancel component mounted!"),console.log(" Current URL:",window.location.href);try{const c=n.get("orderCode"),u=n.get("status"),f=n.get("cancel");if(console.log(" Payment cancelled:",{orderCode:c,status:u,cancel:f}),f==="true"&&u==="CANCELLED"){const p=localStorage.getItem("currentBookingId");p?(console.log(" Payment cancelled for booking:",p),console.log(" Payment session cleared - booking status unchanged"),localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),t("Payment cancelled. You can retry payment from your booking history.","info",3e3)):(console.warn(" No booking ID found in localStorage"),t("Payment cancelled.","info",3e3)),setTimeout(()=>{e("/booking-history")},2e3)}else t("Invalid payment cancellation.","error",3e3),setTimeout(()=>{e("/booking-history")},1500)}catch(c){console.error(" Error handling payment cancellation:",c),t("An error occurred. Redirecting to home...","error",3e3),setTimeout(()=>{e("/")},2e3)}finally{a(!1)}})()},[n,e,t]),i.jsx("main",{style:{minHeight:"60vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:i.jsx("div",{style:{textAlign:"center",maxWidth:"500px",padding:"2rem",background:"#f8f9fa",borderRadius:"8px"},children:s?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",color:"#ffc107",marginBottom:"1rem"},children:""}),i.jsx("h2",{style:{marginBottom:"1rem"},children:"Processing Cancellation..."}),i.jsx("p",{style:{color:"#000"},children:"Clearing payment session. You can retry payment later."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:"48px",color:"#6c757d",marginBottom:"1rem"},children:""}),i.jsx("h2",{style:{marginBottom:"1rem"},children:"Payment Cancelled"}),i.jsx("p",{style:{color:"#000",marginBottom:"1rem"},children:"Your payment has been cancelled. Your booking is still active and you can retry payment anytime."}),i.jsx("p",{style:{color:"#000",fontSize:"0.9rem"},children:"Redirecting to booking history..."})]})})})}const Rj=()=>{const e=hr(),t=_a(),[n,s]=y.useState(10),[a,l]=y.useState(!1),[c,u]=y.useState(!1),{bookingId:f,depositAmount:p,totalAmount:g,carInfo:v,rentalInfo:j}=t.state||{};y.useEffect(()=>{if(!f){e("/payment");return}const C=setInterval(()=>{s(S=>S<=1?(clearInterval(C),k(),0):S-1)},1e3);return()=>clearInterval(C)},[f]);const k=async()=>{l(!0);try{await new Promise(C=>setTimeout(C,1e3)),console.log(" Payment simulation completed for booking:",f),console.log("  Booking is in Pending status. Admin will confirm after payment verification."),u(!0),setTimeout(()=>{e("/booking-history")},2e3)}catch(C){console.error("Error in payment flow:",C),alert("An error occurred. Redirecting to booking history..."),e("/booking-history")}finally{l(!1)}};return f?i.jsx("main",{className:"transaction-page",children:i.jsx("div",{className:"container",children:i.jsx("div",{className:"transaction-content",children:c?i.jsxs("div",{className:"success-section",children:[i.jsx("div",{className:"success-icon",children:i.jsx("i",{className:"fas fa-check-circle"})}),i.jsx("h2",{children:"Booking Created Successfully!"}),i.jsx("p",{children:"Your booking is pending payment confirmation."}),i.jsxs("p",{style:{fontSize:"0.95rem",color:"#666",margin:"1rem 0"},children:["Booking ID: ",i.jsx("strong",{children:f})]}),i.jsx("p",{className:"redirect-text",children:"Redirecting to booking history..."})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"transaction-header",children:[i.jsx("div",{className:"icon-circle",children:i.jsx("i",{className:"fas fa-credit-card"})}),i.jsx("h2",{children:"Complete Your Payment"}),i.jsxs("p",{className:"booking-id",children:["Booking ID: ",i.jsx("span",{children:f})]})]}),i.jsxs("div",{className:"payment-layout",children:[i.jsxs("div",{className:"qr-section",children:[i.jsx("h3",{children:"Scan QR Code to Pay"}),i.jsxs("div",{className:"qr-placeholder",children:[i.jsx("i",{className:"fas fa-qrcode"}),i.jsx("p",{children:"QR Code Here"})]}),i.jsxs("div",{className:"payment-instructions",children:[i.jsx("h4",{children:"Payment Instructions:"}),i.jsxs("ol",{children:[i.jsx("li",{children:"Open your banking app"}),i.jsx("li",{children:"Scan the QR code above"}),i.jsx("li",{children:"Confirm the payment amount"}),i.jsx("li",{children:"Complete the transaction"})]})]})]}),i.jsxs("div",{className:"payment-details",children:[i.jsx("h3",{children:"Payment Details"}),i.jsxs("div",{className:"detail-card",children:[i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Deposit Amount:"}),i.jsx("span",{className:"value highlight",children:Rt(p)})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Total Rental Cost:"}),i.jsx("span",{className:"value",children:Rt(g)})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Remaining Balance:"}),i.jsx("span",{className:"value",children:Rt((g||0)-(p||0))})]})]}),v&&i.jsxs("div",{className:"detail-card",children:[i.jsxs("h4",{children:[i.jsx("i",{className:"fas fa-car"})," Vehicle"]}),i.jsx("p",{children:i.jsxs("strong",{children:[v.brand," ",v.model]})}),i.jsxs("p",{children:[v.color,"  ",v.seats," seats  ",v.year]})]}),j&&i.jsxs("div",{className:"detail-card",children:[i.jsxs("h4",{children:[i.jsx("i",{className:"fas fa-calendar-alt"})," Rental Period"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Pick-up:"})," ",j.pickupDate," ",j.pickupTime]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Return:"})," ",j.returnDate," ",j.returnTime]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Location:"})," ",j.stationName]})]}),i.jsxs("div",{className:"countdown-section",children:[i.jsxs("div",{className:"countdown-circle",children:[i.jsx("span",{className:"countdown-number",children:n}),i.jsx("span",{className:"countdown-label",children:"seconds"})]}),i.jsx("p",{className:"countdown-text",children:a?"Processing payment...":"Simulating payment completion in..."})]}),i.jsxs("div",{className:"info-box",children:[i.jsx("i",{className:"fas fa-info-circle"}),i.jsxs("p",{children:["This is a demo. Your booking will be created in ",i.jsx("strong",{children:"Pending"})," status. Admin will confirm after receiving payment. Payment simulation completes after ",n," second",n!==1?"s":"","."]})]})]})]})]})})})}):null},Xh={createFeedback:async(e,t)=>{var n,s;try{console.log(" Creating feedback for user:",e),console.log(" Feedback data:",t);const a=await de.post(`/Feedback/Create-By-User/${encodeURIComponent(e)}`,t);return console.log(" Feedback created:",a.data),((n=a.data)==null?void 0:n.data)||a.data||{}}catch(a){throw console.error(" Error creating feedback:",((s=a.response)==null?void 0:s.data)||a.message),a}},updateFeedback:async(e,t,n)=>{var s,a;try{console.log(" Updating feedback:",e),console.log(" Updated data:",n);const l=await de.put(`/Feedback/Update-By-${encodeURIComponent(e)}`,n,{params:{userId:t}});return console.log(" Feedback updated:",l.data),((s=l.data)==null?void 0:s.data)||l.data||{}}catch(l){throw console.error(" Error updating feedback:",((a=l.response)==null?void 0:a.data)||l.message),l}}};function Aj(){const e=hr(),[t,n]=y.useState([]),[s,a]=y.useState([]),[l,c]=y.useState(!0),[u,f]=y.useState(""),[p,g]=y.useState(""),[v,j]=y.useState("newest"),[k,C]=y.useState(null),[S,P]=y.useState(!1),[_,x]=y.useState(!1),[w,b]=y.useState({bookingId:"",carId:"",rating:5,comment:""}),[B,T]=y.useState(!1),[F,R]=y.useState(null),[O,I]=y.useState({isOpen:!1,type:"info",title:"",message:""}),[D,q]=y.useState(!1);y.useEffect(()=>{te()},[]),y.useEffect(()=>{G()},[t,p,v]);const te=async()=>{try{c(!0),f("");const U=localStorage.getItem("token");if(!U||U==="null"){console.warn("No auth token found in localStorage"),n([]),f("You are not signed in. Please sign in to view your bookings.");return}const ie=await zt.getUserBookings();console.log(" Bookings loaded - count:",ie==null?void 0:ie.length),console.log(" First booking sample:",ie==null?void 0:ie[0]),console.log(" All bookings:",ie),n(ie||[])}catch(U){if(console.error("Error loading bookings:",U),U&&U.response&&U.response.status===401){f("Session expired or unauthorized. Please sign in again."),n([]);return}f("Failed to load bookings. Please try again later.")}finally{c(!1)}},G=()=>{let U=[...t];p&&(U=U.filter(ie=>String(ie.bookingStatus)===p)),U.sort((ie,Z)=>{switch(v){case"oldest":return new Date(ie.createdAt)-new Date(Z.createdAt);case"price-high":return(Z.totalAmount||0)-(ie.totalAmount||0);case"price-low":return(ie.totalAmount||0)-(Z.totalAmount||0);default:return new Date(Z.createdAt)-new Date(ie.createdAt)}}),a(U)},E=U=>{const ie={0:{text:"Pending",class:"status-pending"},1:{text:"Active",class:"status-active"},2:{text:"Waiting for check-in",class:"status-waiting-check-in"},3:{text:"Checked-in",class:"status-checked-in"},4:{text:"Check-out pending",class:"status-check-out-pending"},5:{text:"Completed",class:"status-completed"},6:{text:"Cancelled pending refund",class:"status-cancelled-pending-refund"},7:{text:"Cancelled",class:"status-cancelled"}},Z=Number(U);return Number.isNaN(Z)||!(Z in ie)?(console.warn(" Unknown booking status:",U,"type:",typeof U),ie[0]):ie[Z]},oe=U=>{if(!U)return"N/A";try{const ie=new Date(U);return isNaN(ie.getTime())?U:ie.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return U}},Ne=async(U,ie)=>{ie&&(ie.preventDefault(),ie.stopPropagation());const Z=U.id||U.bookingId||U.bookingIdString;if(!Z){alert("Cannot cancel: Booking ID not found");return}if(Number(U.bookingStatus)===7){alert("This booking has already been cancelled.");return}if(window.confirm(`Are you sure you want to cancel booking for "${U.carInfo||"this car"}"?`))try{const ne=localStorage.getItem("userId");if(!ne){alert("User ID not found. Please login again.");return}console.log(" Cancelling booking:",Z,"for user:",ne),await zt.cancelBooking(Z,ne),alert("Booking cancelled successfully!"),te()}catch(ne){console.error(" Error cancelling booking:",ne),alert("Failed to cancel booking. Please try again.")}},W=async(U,ie)=>{var se,ne,ce,ke,we;ie&&(ie.preventDefault(),ie.stopPropagation());const Z=U.id||U.bookingId||U.bookingIdString;if(!Z){alert("Booking ID not found");return}q(!0);try{console.log(" Creating deposit payment for booking:",Z);const he=await Hr.createPayment(Z),Ve=he.checkoutUrl||((se=he.data)==null?void 0:se.checkoutUrl);if(!Ve)throw new Error("No checkout URL received");localStorage.setItem("currentBookingId",Z),console.log(" Redirecting to PayOS:",Ve),window.location.href=Ve}catch(he){console.error(" Error initiating payment:",he);let Ve=((ce=(ne=he.response)==null?void 0:ne.data)==null?void 0:ce.message)||he.message||"Failed to initiate payment";(((we=(ke=he.response)==null?void 0:ke.data)==null?void 0:we.errors)||[]).some(qe=>typeof qe=="string"&&qe.toLowerCase().includes("contract"))?(Ve="Contract not found or not confirmed for this booking",I({isOpen:!0,type:"error",title:" Contract Required",message:"Please wait for the contract to be confirmed. Check your email for the contract document and ensure it has been processed."})):I({isOpen:!0,type:"error",title:"Payment Error",message:Ve})}finally{q(!1)}},fe=(U,ie)=>{var ne,ce;if(ie&&(ie.preventDefault(),ie.stopPropagation()),_){console.log(" Modal already open, ignoring click");return}console.log(" Opening feedback modal for booking:",U);const Z=U.id||U.bookingId||U.bookingIdString||"",se=U.carId||((ne=U.car)==null?void 0:ne.id)||((ce=U.car)==null?void 0:ce.carId)||"";if(!Z){alert("Cannot create feedback: Booking ID not found.");return}if(!se){alert("Cannot create feedback: Car ID not found in booking data. Please contact support.");return}U.feedbackId?(T(!0),R(U.feedbackId),b({bookingId:Z,carId:se,rating:U.feedbackRating||5,comment:U.feedbackComment||""})):(T(!1),R(null),b({bookingId:Z,carId:se,rating:5,comment:""})),C(U),x(!0)},re=async()=>{try{const U=localStorage.getItem("userId");if(!U){alert("User ID not found. Please login again.");return}if(!w.carId){alert("Car ID not found for this booking.");return}if(!w.comment.trim()){alert("Please enter your feedback comment.");return}console.log(" Submitting feedback:",w),B&&F?(await Xh.updateFeedback(F,U,w),alert("Feedback updated successfully!")):(await Xh.createFeedback(U,w),alert("Feedback submitted successfully!")),x(!1),b({bookingId:"",carId:"",rating:5,comment:""}),T(!1),R(null),te()}catch(U){console.error(" Error submitting feedback:",U),alert("Failed to submit feedback. Please try again.")}};return i.jsxs("main",{className:"main-content",children:[i.jsxs("div",{className:"container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("i",{className:"fas fa-history"}),i.jsxs("div",{className:"page-header-text",children:[i.jsx("h1",{children:"Booking History"}),i.jsx("p",{style:{color:"white"},children:"Manage all your car rentals"})]})]}),i.jsxs("div",{className:"filters-section",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Status:"}),i.jsxs("select",{value:p,onChange:U=>g(U.target.value),children:[i.jsx("option",{value:"",children:"All"}),i.jsx("option",{value:"0",children:"Pending"}),i.jsx("option",{value:"1",children:"Active"}),i.jsx("option",{value:"2",children:"Waiting for check-in"}),i.jsx("option",{value:"3",children:"Checked-in"}),i.jsx("option",{value:"4",children:"Checked-out pending"}),i.jsx("option",{value:"5",children:"Completed"}),i.jsx("option",{value:"6",children:"Cancelled pending refund"}),i.jsx("option",{value:"7",children:"Cancelled"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Sort By:"}),i.jsxs("select",{value:v,onChange:U=>j(U.target.value),children:[i.jsx("option",{value:"newest",children:"Newest"}),i.jsx("option",{value:"oldest",children:"Oldest"}),i.jsx("option",{value:"price-high",children:"Price (High to Low)"}),i.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),i.jsxs("button",{className:"btn-refresh",onClick:te,children:[i.jsx("i",{className:"fas fa-sync"})," Refresh"]})]}),l&&i.jsxs("div",{className:"loading",children:[i.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading..."]}),!l&&s.length===0&&i.jsxs("div",{className:"empty-state",children:[i.jsx("i",{className:"fas fa-inbox"}),i.jsx("h2",{children:"No Bookings Yet"}),i.jsx("p",{children:"Start booking a car to find your perfect ride"}),i.jsxs("button",{className:"btn btn-primary",onClick:()=>e("/cars"),children:[i.jsx("i",{className:"fas fa-car"})," View Cars"]})]}),!l&&s.length>0&&i.jsx("div",{className:"bookings-list",children:s.map((U,ie)=>{var he,Ve,ft,qe,Nt,ge,ae,ye;console.log(" Booking #"+ie,{id:U.id||U.bookingId,bookingStatus:U.bookingStatus,BookingStatus:U.BookingStatus,statusType:typeof U.bookingStatus,fullBooking:U});const Z=E(U.bookingStatus),se=oe(U.startTime||U.StartTime||U.pickupDateTime||U.PickupDateTime),ne=oe(U.endTime||U.EndTime||U.expectedReturnDateTime||U.ExpectedReturnDateTime),ce=U.carInfo||U.CarInfo||((he=U.car)!=null&&he.brand&&((Ve=U.car)!=null&&Ve.model)?`${U.car.brand} ${U.car.model}`:null)||((ft=U.Car)!=null&&ft.Brand&&((qe=U.Car)!=null&&qe.Model)?`${U.Car.Brand} ${U.Car.Model}`:null)||"Car Rental",ke=U.pickupStationName||U.PickupStationName||U.stationName||U.StationName||((Nt=U.station)==null?void 0:Nt.name)||((ge=U.Station)==null?void 0:ge.Name)||"N/A",we=U.carImage||U.CarImage||((ae=U.car)==null?void 0:ae.imageUrl)||((ye=U.Car)==null?void 0:ye.ImageUrl)||"/Picture/E car 1.jpg";return U.id||U.bookingId||U.bookingIdString,i.jsxs("div",{className:`booking-card-shopee ${Z.class}`,children:[i.jsx("div",{className:"booking-card-header",children:i.jsx("span",{className:`status-badge ${Z.class}`,children:Z.text})}),i.jsxs("div",{className:"booking-card-body",children:[i.jsx("div",{className:"car-image-container",children:i.jsx("img",{src:we,alt:ce,onError:ue=>ue.currentTarget.src="/Picture/E car 1.jpg"})}),i.jsxs("div",{className:"booking-details",children:[i.jsx("h3",{className:"car-name",children:ce}),i.jsxs("div",{className:"booking-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("div",{className:"info-label",children:[i.jsx("i",{className:"fas fa-map-marker-alt"}),"Pick-up Location"]}),i.jsx("div",{className:"info-value",children:ke})]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("div",{className:"info-label",children:[i.jsx("i",{className:"fas fa-calendar-alt"}),"Start Date & Time"]}),i.jsx("div",{className:"info-value",children:se})]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("div",{className:"info-label",children:[i.jsx("i",{className:"fas fa-calendar-check"}),"End Date & Time"]}),i.jsx("div",{className:"info-value",children:ne})]})]})]})]}),i.jsxs("div",{className:"booking-card-footer",children:[i.jsxs("div",{className:"total-price",children:[i.jsx("span",{className:"price-label",children:"Total Amount:"}),i.jsx("span",{className:"price-value",children:Rt(U.totalAmount||U.TotalAmount||0)})]}),i.jsxs("div",{className:"booking-actions",children:[Number(U.bookingStatus)===0&&i.jsxs("button",{className:"btn btn-deposit",onClick:ue=>W(U,ue),disabled:D,type:"button",children:[i.jsx("i",{className:"fas fa-wallet"})," ",D?"Processing...":"Pay Deposit"]}),Number(U.bookingStatus)===6&&i.jsxs("button",{className:"btn btn-feedback",onClick:ue=>fe(U,ue),type:"button",children:[i.jsx("i",{className:"fas fa-comment"})," ",U.feedbackId?"Edit Feedback":"Feedback"]}),i.jsxs("button",{className:"btn btn-cancel",onClick:ue=>Ne(U,ue),disabled:Number(U.bookingStatus)===7,title:Number(U.bookingStatus)===7?"Already cancelled":"Cancel booking",type:"button",children:[i.jsx("i",{className:"fas fa-times-circle"})," Cancel Booking"]})]})]})]},ie)})})]}),S&&k&&i.jsx("div",{className:"modal-overlay",onClick:()=>P(!1),children:i.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:"Booking Details"}),i.jsx("button",{className:"modal-close",onClick:()=>P(!1),children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsxs("div",{className:"detail-section car-section",children:[i.jsx("div",{className:"section-icon",children:""}),i.jsxs("div",{className:"section-content",children:[i.jsx("h3",{children:k.carInfo||"Car Rental"}),i.jsx("div",{className:"status-row",children:i.jsx("span",{className:`status-badge ${E(k.bookingStatus).class}`,children:E(k.bookingStatus).text})})]})]}),i.jsxs("div",{className:"detail-section datetime-section",children:[i.jsxs("div",{className:"datetime-card pickup",children:[i.jsx("div",{className:"datetime-icon",children:""}),i.jsxs("div",{className:"datetime-info",children:[i.jsx("label",{children:"Pick-up"}),i.jsx("p",{className:"location",children:k.pickupStationName||"N/A"}),i.jsx("p",{className:"time",children:oe(k.startTime||k.pickupDateTime)})]})]}),i.jsx("div",{className:"datetime-arrow",children:""}),i.jsxs("div",{className:"datetime-card return",children:[i.jsx("div",{className:"datetime-icon",children:""}),i.jsxs("div",{className:"datetime-info",children:[i.jsx("label",{children:"Return"}),i.jsx("p",{className:"location",children:k.returnStationName||"N/A"}),i.jsx("p",{className:"time",children:oe(k.endTime||k.expectedReturnDateTime)})]})]})]}),i.jsx("div",{className:"detail-section pricing-section",children:i.jsxs("div",{className:"pricing-grid",children:[i.jsxs("div",{className:"pricing-item",children:[i.jsx("span",{className:"pricing-icon",children:""}),i.jsxs("div",{children:[i.jsx("label",{children:"Hourly Rate"}),i.jsxs("p",{children:[Rt(k.hourlyRate||0),"/hour"]})]})]}),i.jsxs("div",{className:"pricing-item",children:[i.jsx("span",{className:"pricing-icon",children:""}),i.jsxs("div",{children:[i.jsx("label",{children:"Daily Rate"}),i.jsxs("p",{children:[Rt(k.dailyRate||0),"/day"]})]})]}),i.jsxs("div",{className:"pricing-item",children:[i.jsx("span",{className:"pricing-icon",children:""}),i.jsxs("div",{children:[i.jsx("label",{children:"Created At"}),i.jsx("p",{children:oe(k.createdAt)})]})]})]})}),i.jsx("div",{className:"detail-section total-section",children:i.jsxs("div",{className:"total-content",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsx("span",{className:"total-amount",children:Rt(k.totalAmount||0)})]})})]})]})}),_&&i.jsx("div",{className:"modal-overlay",onClick:()=>x(!1),children:i.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:"We want your opinion!"}),i.jsx("button",{className:"modal-close",onClick:()=>x(!1),children:""})]}),i.jsx("div",{className:"modal-body",children:i.jsxs("div",{className:"feedback-form",children:[i.jsx("div",{className:"form-group",children:i.jsxs("label",{children:["Car: ",(k==null?void 0:k.carInfo)||"N/A"]})}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"rating",children:"Rating"}),i.jsxs("div",{className:"rating-input",children:[[1,2,3,4,5].map(U=>i.jsx("button",{type:"button",className:`star-btn ${w.rating>=U?"active":""}`,onClick:()=>b({...w,rating:U}),children:i.jsx("i",{className:`fas fa-star ${w.rating>=U?"":"far"}`})},U)),i.jsxs("span",{className:"rating-text",children:[w.rating," / 5"]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"comment",children:"Comment"}),i.jsx("textarea",{id:"comment",rows:"5",value:w.comment,onChange:U=>b({...w,comment:U.target.value}),placeholder:"Share your experience with this car..."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>x(!1),children:"Cancel"}),i.jsx("button",{className:"btn btn-continue",onClick:re,children:B?"Update":"Continue"})]})]})})]})}),i.jsx(Ca,{isOpen:O.isOpen,type:O.type,title:O.title,message:O.message,onClose:()=>I({...O,isOpen:!1})})]})}function Fj(){return i.jsxs("header",{className:"header-bar",children:[i.jsx("div",{className:"header-title",children:"Staff Page"}),i.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function Uj({onSelect:e,isOpen:t,toggleSidebar:n}){return y.useEffect(()=>{t?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[t]),i.jsxs(i.Fragment,{children:[t&&i.jsx("div",{className:"sidebar-collider",onClick:n}),i.jsxs("div",{className:`sidebar ${t?"active":""}`,children:[i.jsx("h2",{children:"FEC Staff"}),i.jsx("div",{style:{marginTop:"60px"}}),i.jsxs("button",{onClick:()=>e("booking"),children:[i.jsx("i",{className:"fas fa-calendar-alt"})," Booking"]}),i.jsxs("button",{onClick:()=>e("vehicle"),children:[i.jsx("i",{className:"fas fa-car"})," Vehicle"]}),i.jsxs("button",{onClick:()=>e("incident"),children:[i.jsx("i",{className:"fas fa-exclamation-triangle"})," Incident"]}),i.jsxs("button",{onClick:()=>e("profile"),children:[i.jsx("i",{className:"fas fa-user-circle"})," Profile"]})]})]})}const iy=()=>'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2"><path d="M3 9l1-3h16l1 3M3 9v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9M3 9h18M7 13a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/></svg>',wl=e=>{e&&(e.style.objectFit="contain",e.style.backgroundColor="#f0f0f0",e.src=iy())},jl=e=>!e||typeof e=="string"&&e.trim()===""?iy():e;function Mj({booking:e,onClick:t}){let n="booking-status-chip ";e.status==="booked"?n+="booking-status-booked":e.status==="pending"?n+="booking-status-pending":e.status==="waiting-checkin"?n+="booking-status-waiting-checkin":e.status==="checked-in"?n+="booking-status-checkedin":e.status==="checkout-pending"?n+="booking-status-checkout-pending":e.status==="completed"?n+="booking-status-completed":e.status==="cancelled-pending"?n+="booking-status-cancelled-pending":e.status==="cancelled"?n+="booking-status-cancelled":(n+="booking-status-unknown",console.warn(" BookingCard: Unknown status value:",e.status,"Full booking:",e));const s=a=>{wl(a.currentTarget)};return i.jsxs("div",{className:"booking-card",onClick:t,children:[i.jsx("img",{src:jl(e.img),alt:e.title,onError:s}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),i.jsx("div",{className:n,children:e.statusLabel||(e.status?e.status.toUpperCase():"UNKNOWN")})]})}function Oj({booking:e,onClick:t}){const n="booking-status-chip booking-status-pending",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"",a=l=>{wl(l.currentTarget)};return i.jsxs("div",{className:"booking-card waiting-payment",onClick:t,children:[i.jsx("img",{src:jl(e.img),alt:e.title,onError:a}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsxs("div",{className:"loading-row",title:"Waiting for payment confirmation",children:[i.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),i.jsx("div",{className:"booking-subtext",children:"Waiting for Payment"})]})]}),i.jsx("div",{className:n,children:"Pending"})]})}function Dj({booking:e,onClick:t}){const n="booking-status-chip booking-status-checkedin",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return i.jsxs("div",{className:"booking-card checkin-payment",onClick:t,children:[i.jsx("img",{src:e.img,alt:e.title}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsx("div",{className:"booking-subtext",children:"Payment In Waiting"})]}),i.jsx("div",{className:n,children:"Payment In Waiting"})]})}const br={createIncident:async(e,t,n=[])=>{var c;if(!e||!t)throw new Error("bookingId and description are required");const s=new FormData;if(s.append("bookingId",e),s.append("description",t),n&&n.length)for(const u of n)s.append("images",u);const a=["/Incidents/Create","/incidents/Create","/Incidents/CreateIncident"];let l=null;for(const u of a)try{const f=await de.post(u,s,{headers:{"Content-Type":"multipart/form-data"}}),p=f==null?void 0:f.data;if(p&&typeof p=="object"&&"data"in p){if(p.isSuccess===!1){const g=p.message||(Array.isArray(p.errors)?p.errors.join("; "):"Request failed"),v=new Error(g);throw v.body=p,v}return p.data}return p}catch(f){l=f;const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}throw l||new Error("Create incident endpoint not found")},getIncidentsByBooking:async(e,t=1,n=20)=>{var l;if(!e)return[];const s=encodeURIComponent(e),a=[{url:`/Incidents/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/Incident/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/incidents/get-by-booking/${s}`,opts:{params:{page:t,pageSize:n}}}];for(const c of a)try{const u=await de.get(c.url,c.opts),f=u==null?void 0:u.data,p=f&&typeof f=="object"&&"data"in f?f.data:f;if(!p)continue;return Array.isArray(p)?p:Array.isArray(p==null?void 0:p.items)?p.items:Array.isArray(p==null?void 0:p.data)?p.data:Array.isArray(p)?p:[]}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)return[]}return[]},getMyIncidents:async()=>{var t;const e=["/Incidents/My-Incidents","/Incidents/My","/Incidents/Get-My"];for(const n of e)try{const s=await de.get(n),a=s==null?void 0:s.data,l=a&&typeof a=="object"&&"data"in a?a.data:a;if(!l)continue;return Array.isArray(l)?l:Array.isArray(l==null?void 0:l.items)?l.items:Array.isArray(l==null?void 0:l.data)?l.data:Array.isArray(l)?l:[]}catch(s){const a=(t=s==null?void 0:s.response)==null?void 0:t.status;if(a&&a!==404&&a!==405)return[]}return[]},getAllIncidents:async(e=null,t=null,n=null,s=null,a=1,l=100)=>{try{const c={};e&&(c.stationId=e),t&&(c.status=t),n&&(c.dateFrom=n),s&&(c.dateTo=s),c.page=a,c.pageSize=l;const u=await de.get("/Incidents/Get-All",{params:c}),f=u==null?void 0:u.data,p=f&&typeof f=="object"&&"data"in f?f.data:f;if(!p)return{incidents:[],totalCount:0,page:a,pageSize:l};if(Array.isArray(p))return{incidents:p,totalCount:p.length,page:a,pageSize:l};const g=p.incidents||p.items||p.data||[],v=p.totalCount||p.total||(Array.isArray(g)?g.length:0);return{incidents:Array.isArray(g)?g:[],totalCount:v||0,page:p.page||a,pageSize:p.pageSize||l}}catch{return{incidents:[],totalCount:0,page:a,pageSize:l}}},getIncidentById:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Incidents/Get-By-${t}`,`/Incidents/Get-By-Id/${t}`,`/Incidents/${t}`,`/incident/${t}`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(!u)continue;return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},updateIncident:async(e,t)=>{var l;if(!e)throw new Error("incidentId is required");const n=encodeURIComponent(e),s=[`/Incidents/Update-By-${n}`,`/Incidents/Update-By-Id/${n}`,`/Incidents/Update/${n}`,`/Incidents/${n}`];let a=null;for(const c of s)try{const u=await de.put(c,t,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;return(f&&typeof f=="object"&&"data"in f?f.data:f)||f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Update incident endpoint not found")},resolveIncident:async(e,t="",n=0)=>{var c;if(!e)throw new Error("incidentId is required");const s=encodeURIComponent(e),a=[`/Incidents/Resolve-By-${s}`,`/Incidents/Resolve-By-Id/${s}`,`/Incidents/Resolve/${s}`];let l=null;for(const u of a)try{const f=await de.patch(u,{resolutionNotes:t,costIncurred:n}),p=f==null?void 0:f.data;return p&&typeof p=="object"&&"data"in p?p.data:p}catch(f){l=f;const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}throw l||new Error("Resolve incident endpoint not found")},deleteIncident:async e=>{var a;if(!e)throw new Error("incidentId is required");const t=encodeURIComponent(e),n=[`/Incidents/Delete-By-${t}`,`/Incidents/Delete-By-Id/${t}`,`/Incidents/Delete/${t}`,`/Incidents/${t}`];let s=null;for(const l of n)try{const c=await de.delete(l),u=c==null?void 0:c.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(c){s=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}throw s||new Error("Delete incident endpoint not found")}},Fe={confirmBooking:zt.confirmBooking,cancelBooking:zt.cancelBooking,completeBooking:zt.completeBooking,getBookingById:zt.getBookingById,createIncident:br.createIncident,getIncidentsByBooking:br.getIncidentsByBooking,getMyIncidents:br.getMyIncidents,getAllIncidents:br.getAllIncidents,getIncidentById:br.getIncidentById,updateIncident:br.updateIncident,resolveIncident:br.resolveIncident,deleteIncident:br.deleteIncident,post:(e,t={})=>de.post(e,t).then(n=>n.data),get:(e,t={})=>de.get(e,t).then(n=>n.data),put:(e,t={})=>de.put(e,t).then(n=>n.data),patch:(e,t={})=>de.patch(e,t).then(n=>n.data),delete:e=>de.delete(e).then(t=>t.data),createCar:async e=>{var t;try{const n=await de.post("/Cars/Create",e);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error creating car:",n),n}},deleteCar:async e=>{var t;try{const n=await de.delete(`/Cars/Delete-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error deleting car:",n),n}},updateCar:async(e,t)=>{var n;try{const s=await de.put(`/Cars/Update-By-${encodeURIComponent(e)}`,t);return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car:",s),s}},updateStatus:async(e,t)=>{var n;try{const s=await de.patch(`/Cars/${encodeURIComponent(e)}/status`,{status:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car status:",s),s}},updateBatteryLevel:async(e,t)=>{var n;try{const s=await de.patch(`/Cars/${encodeURIComponent(e)}/battery`,{batteryLevel:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating battery level:",s),s}},updateCarDescription:async(e,t)=>{var n;try{const s=await de.patch(`/Cars/${encodeURIComponent(e)}/description`,{description:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car description:",s),s}},getCarsByStation:async e=>{var t;try{const n=await de.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`),s=n==null?void 0:n.data;return Array.isArray(s)?s:s!=null&&s.data&&Array.isArray(s.data)?s.data:(t=s==null?void 0:s.data)!=null&&t.data&&Array.isArray(s.data.data)?s.data.data:s!=null&&s.items&&Array.isArray(s.items)?s.items:(console.warn(" No cars found in response for station:",e),[])}catch(n){return console.warn(" getCarsByStation error (endpoint may not exist):",n.message),[]}},checkInWithContract:async e=>{var s,a;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-In-With-Contract","/Bookings/CheckInWithContract","/bookings/check-in-with-contract"];let n;for(const l of t){if(e.checkInPhotoFile&&e.checkInPhotoFile instanceof File)try{const c=new FormData;c.append("bookingId",e.bookingId),c.append("staffId",e.staffId),e.checkInNotes&&c.append("checkInNotes",e.checkInNotes),e.checkInPhotoUrl&&!e.checkInPhotoUrl.startsWith("blob:")&&c.append("checkInPhotoUrl",e.checkInPhotoUrl),c.append("checkInPhotoFile",e.checkInPhotoFile);const u=await de.post(l,c,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const p=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(p);throw g.body=f,g}return f.data}return f}catch(c){n=c;const u=(s=c==null?void 0:c.response)==null?void 0:s.status;if(u&&u!==404&&u!==405)throw c}try{const{checkInPhotoFile:c,...u}=e,f=await de.post(l,u,{headers:{"Content-Type":"application/json"}}),p=f==null?void 0:f.data;if(p&&typeof p=="object"&&"data"in p){if(p.isSuccess===!1){const g=p.message||(Array.isArray(p.errors)?p.errors.join("; "):"Request failed"),v=new Error(g);throw v.body=p,v}return p.data}return p}catch(c){n=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}}throw n||new Error("Check-In-With-Contract endpoint not found")},checkOutWithPayment:async e=>{var s,a;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-Out-With-Payment","/Bookings/CheckOutWithPayment","/bookings/check-out-with-payment"];let n;for(const l of t){if(e.checkOutPhotoFile&&e.checkOutPhotoFile instanceof File)try{const c=new FormData;c.append("bookingId",e.bookingId),c.append("staffId",e.staffId),e.actualReturnDateTime&&c.append("actualReturnDateTime",e.actualReturnDateTime),e.damageFee!==void 0&&e.damageFee!==null&&c.append("damageFee",String(e.damageFee)),e.checkOutNotes&&c.append("checkOutNotes",e.checkOutNotes),e.checkOutPhotoUrl&&!e.checkOutPhotoUrl.startsWith("blob:")&&c.append("checkOutPhotoUrl",e.checkOutPhotoUrl),c.append("checkOutPhotoFile",e.checkOutPhotoFile);const u=await de.post(l,c,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const p=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(p);throw g.body=f,g}return f.data}return f}catch(c){n=c;const u=(s=c==null?void 0:c.response)==null?void 0:s.status;if(u&&u!==404&&u!==405)throw c}try{const{checkOutPhotoFile:c,...u}=e,f=await de.post(l,u,{headers:{"Content-Type":"application/json"}}),p=f==null?void 0:f.data;if(p&&typeof p=="object"&&"data"in p){if(p.isSuccess===!1){const g=p.message||(Array.isArray(p.errors)?p.errors.join("; "):"Request failed"),v=new Error(g);throw v.body=p,v}return p.data}return p}catch(c){n=c;const u=(a=c==null?void 0:c.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw c}}throw n||new Error("Check-Out-With-Payment endpoint not found")},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Fe.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},getAllStations:async(e=1,t=100)=>{var n;try{const s=await de.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}}),a=s==null?void 0:s.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(n=a==null?void 0:a.data)!=null&&n.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No stations found in response"),[])}catch(s){return console.warn(" getAllStations error:",s.message),[]}},getBookingsByStation:async(e,t=1,n=100)=>{var a;if(!e)throw new Error("stationId is required");const s=encodeURIComponent(e);try{const l=await de.get(`/Bookings/By-Station/${s}`,{params:{pageNumber:t,pageSize:n}}),c=l==null?void 0:l.data;return Array.isArray(c)?c:c!=null&&c.data&&Array.isArray(c.data)?c.data:(a=c==null?void 0:c.data)!=null&&a.data&&Array.isArray(c.data.data)?c.data.data:c!=null&&c.items&&Array.isArray(c.items)?c.items:(console.warn(" No bookings found in response for station:",e),[])}catch(l){return console.warn(" getBookingsByStation error:",l.message),[]}},getAvailableCarsByStation:async e=>{var n;if(!e)return[];const t=encodeURIComponent(e);try{const s=await de.get(`/Cars/Get-Available-By-Station/${t}`),a=s==null?void 0:s.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(n=a==null?void 0:a.data)!=null&&n.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No available cars found for station:",e),[])}catch(s){return console.warn(" getAvailableCarsByStation error:",s.message),[]}}};function zj({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:a}){var U,ie;const[l,c]=y.useState(!1),[u,f]=y.useState(!1),[p,g]=y.useState(!1),[v,j]=y.useState(!1),[k,C]=y.useState(""),[S,P]=y.useState(!1),[_,x]=y.useState(!1),[w,b]=y.useState(null),[B,T]=y.useState(!1),[F,R]=y.useState(null),[O,I]=y.useState(""),[D,q]=y.useState(""),[te,G]=y.useState(""),[E,oe]=y.useState(null),[Ne,W]=y.useState(!1);if(y.useEffect(()=>{if(!e)return;c(!1),f(!1),g(!1),j(!1),C(""),oe(null);const Z=(he,Ve)=>[he,Ve].filter(Boolean).join(" "),se=e.fullName||Z(e.firstName,e.lastName);if(!se||/^customer$/i.test(se)||se===""||C(se),!e.id)return;let ce=!1;async function ke(){P(!0);try{const{firstName:he,lastName:Ve}=await staffApi.getUserNameByBookingId(e.id);ce||C(Z(he,Ve))}catch{}finally{ce||P(!1)}}async function we(){if(!e.userId){console.warn(" No userId in booking");return}W(!0);try{console.log(" Fetching user details for userId:",e.userId);const he=await staffApi.getUserById(e.userId);ce||(oe(he),console.log(" Fetched user details:",he),console.log(" CCCD Images:",{cccdFrontUrl:he==null?void 0:he.cccdFrontUrl,identityFrontUrl:he==null?void 0:he.identityFrontUrl,idFrontUrl:he==null?void 0:he.idFrontUrl,cccdImageUrl_Front:he==null?void 0:he.cccdImageUrl_Front,cccdBackUrl:he==null?void 0:he.cccdBackUrl,identityBackUrl:he==null?void 0:he.identityBackUrl,idBackUrl:he==null?void 0:he.idBackUrl,cccdImageUrl_Back:he==null?void 0:he.cccdImageUrl_Back}),console.log(" GPLX Images:",{gplxFrontUrl:he==null?void 0:he.gplxFrontUrl,driverLicenseFrontUrl:he==null?void 0:he.driverLicenseFrontUrl,gplxImageUrl_Front:he==null?void 0:he.gplxImageUrl_Front,gplxBackUrl:he==null?void 0:he.gplxBackUrl,driverLicenseBackUrl:he==null?void 0:he.driverLicenseBackUrl,gplxImageUrl_Back:he==null?void 0:he.gplxImageUrl_Back}))}catch(he){console.warn(" Failed to fetch user details:",(he==null?void 0:he.message)||he),console.error("Full error:",he),ce||oe(null)}finally{ce||W(!1)}}return ke(),we(),()=>{ce=!0}},[e]),!e)return null;const fe=(e==null?void 0:e.status)==="booked"?l&&u:!1,re=()=>{if(!e)return;const Z=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,Z)};return i.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("img",{id:"modalImage",src:e.facePhoto||e.img,alt:"",style:{width:"100%",borderRadius:8,objectFit:"cover",display:"block"}}),i.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),i.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),i.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((U=e.car)==null?void 0:U.name)||((ie=e.car)==null?void 0:ie.Name)||""]}),i.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(S?"Loading":"")]}),i.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",e.date]})]}),i.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Pickup Date:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"pickupDate",style:{fontWeight:600},children:e.pickupDate||e.startDate||e.date||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Return Date:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"returnDate",style:{fontWeight:600},children:e.returnDate||e.endDate||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:Ne?"Loading...":(E==null?void 0:E.identityNumber)||(E==null?void 0:E.idNumber)||(E==null?void 0:E.cmnd)||e.idString||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Address:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:Ne?"Loading...":(E==null?void 0:E.address)||e.address||""})})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["CCCD Images: ",Ne&&"(Loading...)"]}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),E!=null&&E.cccdFrontUrl||E!=null&&E.identityFrontUrl||E!=null&&E.idFrontUrl||E!=null&&E.cccdImageUrl_Front||e.cccdFrontUrl?i.jsx("a",{href:(E==null?void 0:E.cccdFrontUrl)||(E==null?void 0:E.identityFrontUrl)||(E==null?void 0:E.idFrontUrl)||(E==null?void 0:E.cccdImageUrl_Front)||e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.cccdFrontUrl)||(E==null?void 0:E.identityFrontUrl)||(E==null?void 0:E.idFrontUrl)||(E==null?void 0:E.cccdImageUrl_Front)||e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:Z=>c(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),E!=null&&E.cccdBackUrl||E!=null&&E.identityBackUrl||E!=null&&E.idBackUrl||E!=null&&E.cccdImageUrl_Back||e.cccdBackUrl?i.jsx("a",{href:(E==null?void 0:E.cccdBackUrl)||(E==null?void 0:E.identityBackUrl)||(E==null?void 0:E.idBackUrl)||(E==null?void 0:E.cccdImageUrl_Back)||e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.cccdBackUrl)||(E==null?void 0:E.identityBackUrl)||(E==null?void 0:E.idBackUrl)||(E==null?void 0:E.cccdImageUrl_Back)||e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:u,onChange:Z=>f(Z.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["Driver License (GPLX) Images: ",Ne&&"(Loading...)"]}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),E!=null&&E.gplxFrontUrl||E!=null&&E.driverLicenseFrontUrl||E!=null&&E.gplxImageUrl_Front||e.gplxFrontUrl?i.jsx("a",{href:(E==null?void 0:E.gplxFrontUrl)||(E==null?void 0:E.driverLicenseFrontUrl)||(E==null?void 0:E.gplxImageUrl_Front)||e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.gplxFrontUrl)||(E==null?void 0:E.driverLicenseFrontUrl)||(E==null?void 0:E.gplxImageUrl_Front)||e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:p,onChange:Z=>g(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),E!=null&&E.gplxBackUrl||E!=null&&E.driverLicenseBackUrl||E!=null&&E.gplxImageUrl_Back||e.gplxBackUrl?i.jsx("a",{href:(E==null?void 0:E.gplxBackUrl)||(E==null?void 0:E.driverLicenseBackUrl)||(E==null?void 0:E.gplxImageUrl_Back)||e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:(E==null?void 0:E.gplxBackUrl)||(E==null?void 0:E.driverLicenseBackUrl)||(E==null?void 0:E.gplxImageUrl_Back)||e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:v,onChange:Z=>j(Z.target.checked)})," Verified"]})]})]})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{id:"customerPhone",style:{padding:6},children:Ne?"Loading...":(E==null?void 0:E.phoneNumber)||(E==null?void 0:E.phone)||e.phone||""}),((E==null?void 0:E.phoneNumber)||(E==null?void 0:E.phone)||e.phone)&&i.jsx("a",{href:`tel:${(E==null?void 0:E.phoneNumber)||(E==null?void 0:E.phone)||e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!fe,style:{background:fe?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),i.jsx("button",{onClick:re,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&i.jsx("button",{onClick:()=>n==null?void 0:n(e,"checkout"),style:{background:"#d32f2f",color:"#fff",width:"100%",padding:"12px",borderRadius:6,border:"none",cursor:"pointer",fontWeight:600,fontSize:14},children:"Check Out"})]}),O&&i.jsx("div",{style:{marginTop:8,color:"#b00020"},children:O})]})]}),i.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[i.jsx("h4",{children:"Transaction Details"}),i.jsxs("ul",{style:{fontSize:"1rem"},children:[i.jsx("li",{children:"Find rental location on map"}),i.jsx("li",{children:"View available vehicles (type, battery, price)"}),i.jsx("li",{children:"Book in advance or on-site"}),i.jsx("li",{children:"Check-in at counter/app"}),i.jsx("li",{children:"Sign electronic contract"}),i.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),i.jsx("li",{children:"Return vehicle at rental location"}),i.jsx("li",{children:"Staff checks and confirms vehicle condition"}),i.jsx("li",{children:"Pay any additional fees"})]})]})]})})}function ep(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function $j({booking:e,onClose:t,onCheckedIn:n}){const[s,a]=y.useState(""),[l,c]=y.useState(null),[u,f]=y.useState(!1),[p,g]=y.useState(""),[v,j]=y.useState(null),[k,C]=y.useState(null),[S,P]=y.useState(""),[_,x]=y.useState(""),[w,b]=y.useState(""),[B,T]=y.useState(!1),[F,R]=y.useState(!1),[O,I]=y.useState(!1);Yn.useEffect(()=>{let te=!0;return(async()=>{try{const G=await staffApi.getServerTime();te&&j(G);try{const E=G?G.getTime()-Date.now():0;console.log(" Server time:",G,"Client time:",new Date,"(ms):",E)}catch{}}catch{}})(),()=>{te=!1}},[]);async function D(te){var G,E;if(te.preventDefault(),!!(e!=null&&e.id)){f(!0),g("");try{const oe=localStorage.getItem("token");if(!oe||oe==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let Ne="";try{Ne=localStorage.getItem("userId")||""}catch{}if(!Ne)try{const ie=localStorage.getItem("token");if(ie){const Z=staffApi.decodeJwt(ie);Ne=Z["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||Z.sub||Z.userId||Z.UserId||Z.id||Z.Id||""}}catch{}if(!Ne)throw new Error("Unable to determine userId. Please sign in again.");const W={bookingId:e.id,staffId:Ne},fe=(s||"").trim();fe&&(W.checkInNotes=fe),l&&(W.checkInPhotoFile=l);const re=await staffApi.checkInWithContract(W);console.log(" Check-in response:",re),localStorage.setItem("activeCheckInBookingId",e.id),console.log(" Saved activeCheckInBookingId to localStorage:",e.id),C(re);const U=(re==null?void 0:re.totalAmount)||(re==null?void 0:re.TotalAmount)||0;if(console.log(" Total amount for payment:",U),U>0){T(!0);try{const ie=await Hr.createPayment(e.id,1,"Rental payment at check-in");console.log(" Payment created:",ie);const Z=ie||{},se=Z.checkoutUrl||Z.url||Z.payUrl||"";se?(console.log(" Opening Payos checkout in new tab:",se),P(se),window.open(se,"_blank")):(console.warn(" No checkout URL in payment response:",Z),P(""),g("Payment session created but no checkout URL received. Please try again."))}catch(ie){console.error(" Payment creation failed:",ie==null?void 0:ie.message),g(`Check-in succeeded but payment setup failed: ${ie==null?void 0:ie.message}. Please try again.`)}finally{T(!1)}}typeof n=="function"&&n(e.id,W)}catch(oe){const Ne=(oe==null?void 0:oe.body)||((G=oe==null?void 0:oe.response)==null?void 0:G.data),W=Ne&&(Ne.errors||Ne.Errors)||null,fe=(Array.isArray(W)&&W.length?W.join("; "):null)||(Ne==null?void 0:Ne.message)||(oe==null?void 0:oe.message)||"Failed to save check-in";g(fe);try{console.error(" Check-in failed:",{error:oe==null?void 0:oe.message,status:(oe==null?void 0:oe.status)||((E=oe==null?void 0:oe.response)==null?void 0:E.status),body:Ne})}catch{}}finally{f(!1)}}}async function q(){if(e!=null&&e.id){R(!0),g("");try{console.log(" Syncing payment for booking:",e.id),await Hr.syncPayment(e.id),console.log(" Payment synced successfully");const te=await zt.getBookingById(e.id);console.log(" Updated booking status:",te.bookingStatus),I(!0),g(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(te){console.error(" Payment sync failed:",te),g(`Payment sync failed: ${te.message}`),I(!1)}finally{R(!1)}}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),k?i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check-in Successful"}),i.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(k==null?void 0:k.message)||"Check-in successful!"]}),p&&i.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:p}),B&&i.jsx("div",{style:{background:"#e3f2fd",color:"#1565c0",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Creating payment session and redirecting to Payos..."}),S&&!B&&i.jsx("div",{style:{background:"#f3e5f5",color:"#7b1fa2",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment session created. Payos opened in new tab."}),O&&i.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[i.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),i.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[i.jsx("span",{children:"Total Amount:"}),i.jsx("strong",{children:ep((k==null?void 0:k.totalAmount)||0)})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:14},children:[i.jsx("span",{children:"Deposit (30%):"}),i.jsx("strong",{children:ep((k==null?void 0:k.depositAmount)||0)})]})]})]}),i.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:i.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment Processing"}),B?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:"Preparing payment link..."}),i.jsx("div",{style:{fontSize:12,color:"#999"},children:"You will be redirected to Payos to complete payment."})]}):S?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:" Payment link opened in new tab"}),i.jsx("div",{style:{fontSize:12,color:"#999",marginBottom:16},children:"After customer completes payment, click the button below to sync"}),i.jsx("button",{onClick:q,disabled:F||O,style:{background:O?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:F||O?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:F?" Syncing...":O?" Synced!":" Sync Payment Status"})]}):i.jsx("div",{style:{fontSize:13,color:"#d32f2f",padding:"12px",background:"#ffebee",borderRadius:6},children:" Payment setup incomplete"})]})})]}),i.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",i.jsx("strong",{children:"Note:"})," You will be redirected to Payos to complete payment. After payment completes, you will be redirected to the payment success page."]}),!B&&!S&&i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check In"}),v&&i.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",v.toLocaleString()]}),p&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:p}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),i.jsxs("form",{onSubmit:D,style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Notes"}),i.jsx("textarea",{rows:5,value:s,onChange:te=>a(te.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Photo (Optional)"}),i.jsx("input",{type:"file",accept:"image/*",onChange:te=>c(te.target.files[0]||null),placeholder:"Select an image file"}),l&&i.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Selected: ",l.name," (",(l.size/1024/1024).toFixed(2)," MB)"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:u,style:{background:"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:u?"Processing":"Confirm Check In"})]})]})]})]})})}function lo(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function Wj({booking:e,onClose:t,onCheckedOut:n}){const[s,a]=y.useState(""),[l,c]=y.useState(0),[u,f]=y.useState(""),[p,g]=y.useState("15:00"),[v,j]=y.useState(null),[k,C]=y.useState(new Date().getMonth()),[S,P]=y.useState(new Date().getFullYear()),[_,x]=y.useState(!1),[w,b]=y.useState(""),[B,T]=y.useState(null),[F,R]=y.useState(null),[O,I]=y.useState(""),[D,q]=y.useState(!1),[te,G]=y.useState(!1),[E,oe]=y.useState(!1),Ne=Array.from({length:18},(Z,se)=>`${(6+se).toString().padStart(2,"0")}:00`);Yn.useEffect(()=>{let Z=!0;return(async()=>{try{const se=await staffApi.getServerTime();if(Z&&(T(se),se)){const ce=se.toISOString().split("T")[0];f(ce)}try{const ne=se?se.getTime()-Date.now():0;console.log(" Server time:",se,"Client time:",new Date,"(ms):",ne)}catch{}}catch{}})(),()=>{Z=!1}},[]);function W(){const Z=new Date(S,k,1),se=new Date(S,k+1,0),ne=[];for(let ke=0;ke<Z.getDay();ke++)ne.push(i.jsx("div",{},`empty-${ke}`));const ce=new Date;ce.setHours(0,0,0,0);for(let ke=1;ke<=se.getDate();ke++){const we=`${S}-${(k+1).toString().padStart(2,"0")}-${ke.toString().padStart(2,"0")}`,Ve=new Date(we)<ce,ft=we===u,qe=["calendar-day"];Ve&&qe.push("past"),ft&&qe.push("selected"),ne.push(i.jsx("div",{className:qe.join(" "),onClick:Nt=>{Nt.stopPropagation(),Ve||(f(we),j(null))},style:{cursor:Ve?"not-allowed":"pointer"},children:ke},we))}return ne}function fe(Z){let se=k+Z,ne=S;se>11&&(se=0,ne++),se<0&&(se=11,ne--),C(se),P(ne)}async function re(Z){var se,ne;if(Z.preventDefault(),!!(e!=null&&e.id)){x(!0),b("");try{const ce=localStorage.getItem("token");if(!ce||ce==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let ke="";try{ke=localStorage.getItem("userId")||""}catch{}if(!ke)try{const ae=localStorage.getItem("token");if(ae){const ye=staffApi.decodeJwt(ae);ke=ye["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||ye.sub||ye.userId||ye.UserId||ye.id||ye.Id||""}}catch{}if(!ke)throw new Error("Unable to determine userId. Please sign in again.");const we={bookingId:e.id,staffId:ke,actualReturnDateTime:u&&p?new Date(`${u}T${p}`).toISOString():new Date().toISOString(),checkOutPhotoUrl:"",damageFee:Number(l)||0},he=(s||"").trim();he&&(we.checkOutNotes=he);const Ve=await staffApi.checkOutWithPayment(we);console.log(" Check-out response:",Ve),localStorage.setItem("activeCheckOutBookingId",e.id),console.log(" Saved activeCheckOutBookingId to localStorage:",e.id),R(Ve);const ft=await staffApi.getBookingById(e.id);console.log(" Updated booking:",ft),ft&&R(ae=>({...ae,...ft}));const qe=Number(l)||0,Nt=Number((ft==null?void 0:ft.extraAmount)||0),ge=qe+Nt;if(console.log(" Payment amounts - Damage:",qe,"Backend Extra:",Nt,"Total:",ge),ge>0){q(!0);try{const ae=await Hr.createPayment(e.id,2,"Rental payment at check-out",ge);console.log(" Payment created:",ae);const ye=ae||{},ue=ye.checkoutUrl||ye.url||ye.payUrl||"";ue?(console.log(" Opening Payos checkout in new tab:",ue),I(ue),window.open(ue,"_blank")):(console.warn(" No checkout URL in payment response:",ye),I(""),b("Payment session created but no checkout URL received. Please try again."))}catch(ae){console.error(" Payment creation failed:",ae==null?void 0:ae.message),b(`Check-out succeeded but payment setup failed: ${ae==null?void 0:ae.message}. Please try again.`)}finally{q(!1)}}typeof n=="function"&&n(e.id,we)}catch(ce){const ke=(ce==null?void 0:ce.body)||((se=ce==null?void 0:ce.response)==null?void 0:se.data),we=ke&&(ke.errors||ke.Errors)||null,he=(Array.isArray(we)&&we.length?we.join("; "):null)||(ke==null?void 0:ke.message)||(ce==null?void 0:ce.message)||"Failed to save check-out";b(he);try{console.error(" Check-out failed:",{error:ce==null?void 0:ce.message,status:(ce==null?void 0:ce.status)||((ne=ce==null?void 0:ce.response)==null?void 0:ne.status),body:ke})}catch{}}finally{x(!1)}}}async function U(){if(e!=null&&e.id){q(!0),b("");try{localStorage.setItem("activeCheckOutBookingId",e.id);const Z=Number((F==null?void 0:F.extraAmount)||0),se=Number(l)||0,ne=Math.max(Z,se);console.log(" Creating payment - ExtraAmount:",Z,"DamageFee:",se,"Using:",ne);const ce=await Hr.createPayment(e.id,2,"Rental payment at check-out",ne);console.log(" Payment created:",ce);const ke=ce||{},we=ke.checkoutUrl||ke.url||ke.payUrl||"";we?(console.log(" Opening Payos checkout:",we),I(we),window.open(we,"_blank")):(console.warn(" No checkout URL in payment response:",ke),b("No checkout URL received. Please try again."))}catch(Z){console.error(" Payment creation failed:",Z==null?void 0:Z.message),b(`Payment setup failed: ${Z==null?void 0:Z.message}`)}finally{q(!1)}}}async function ie(){if(e!=null&&e.id){G(!0),b("");try{console.log(" Syncing payment for booking:",e.id),await Hr.syncPayment(e.id),console.log(" Payment synced successfully");const Z=await zt.getBookingById(e.id);console.log(" Updated booking status:",Z.bookingStatus),oe(!0),b(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(Z){console.error(" Payment sync failed:",Z),b(`Payment sync failed: ${Z.message}`),oe(!1)}finally{G(!1)}}}return i.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),F?i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check-out Successful"}),i.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(F==null?void 0:F.message)||"Check-out successful!"]}),w&&i.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:w}),E&&i.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[i.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),i.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[i.jsx("span",{children:"Damage Fee:"}),i.jsx("strong",{style:{color:"#d32f2f"},children:lo((F==null?void 0:F.damageFee)||0)})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[i.jsx("span",{children:"Late Fee:"}),i.jsx("strong",{style:{color:"#d32f2f"},children:lo((F==null?void 0:F.lateFee)||0)})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid #eee",paddingTop:8,fontSize:14,fontWeight:600},children:[i.jsx("span",{children:"Total Additional Fees:"}),i.jsx("strong",{style:{color:"#d32f2f"},children:lo(((F==null?void 0:F.damageFee)||0)+((F==null?void 0:F.lateFee)||0))})]})]})]}),i.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:i.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment"}),((F==null?void 0:F.extraAmount)||0)>0?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{fontSize:13,color:"#666",marginBottom:16,lineHeight:1.5},children:["Amount to pay: ",i.jsx("strong",{children:lo((F==null?void 0:F.extraAmount)||0)})]}),O?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:12},children:" Payment link opened in new tab"}),i.jsx("button",{onClick:ie,disabled:te||E,style:{background:E?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:te||E?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:te?" Syncing...":E?" Synced!":" Sync Payment Status"})]}):i.jsx("button",{onClick:U,disabled:D,style:{background:"#4CAF50",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:D?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%",marginBottom:8},children:D?" Opening Payment...":" Go to Payment"})]}):i.jsx("div",{style:{fontSize:13,color:"#2e7d32",padding:"12px",background:"#e8f5e9",borderRadius:6},children:" No additional payment needed"})]})})]}),i.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",i.jsx("strong",{children:"Note:"}),' Click "Go to Payment" to open Payos in new tab. After customer completes payment, click "Sync Payment Status" to update booking.']}),i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("h3",{style:{marginBottom:12},children:"Check Out"}),B&&i.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",B.toLocaleString()]}),w&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:w}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),i.jsxs("form",{onSubmit:re,style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{style:{display:"flex",gap:12,position:"relative"},children:[i.jsxs("div",{style:{flex:1,position:"relative"},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Return Date"}),i.jsx("div",{onClick:Z=>{Z.stopPropagation(),j(v==="return"?null:"return")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:u?new Date(u).toLocaleDateString():"Select date"})]}),v==="return"&&i.jsxs("div",{onClick:Z=>Z.stopPropagation(),style:{position:"absolute",top:"100%",left:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:12,marginTop:4,zIndex:10,minWidth:280,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("button",{type:"button",onClick:Z=>{Z.stopPropagation(),fe(-1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""}),i.jsx("span",{style:{fontWeight:600},children:new Date(S,k).toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("button",{type:"button",onClick:Z=>{Z.stopPropagation(),fe(1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,marginBottom:8},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(Z=>i.jsx("div",{style:{textAlign:"center",fontSize:12,fontWeight:600},children:Z},Z))}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:W()})]})]}),i.jsxs("div",{style:{flex:1,position:"relative"},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Return Time"}),i.jsx("div",{onClick:Z=>{Z.stopPropagation(),j(v==="return-time"?null:"return-time")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:p})]}),v==="return-time"&&i.jsx("div",{onClick:Z=>Z.stopPropagation(),style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:8,marginTop:4,zIndex:1001,maxHeight:240,overflow:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:Ne.map(Z=>i.jsx("div",{onClick:se=>{se.stopPropagation(),g(Z),j(null)},style:{padding:"8px 12px",cursor:"pointer",background:Z===p?"#e3f2fd":"#fff",color:Z===p?"#1976d2":"#333",fontWeight:Z===p?"600":"400",borderRadius:4,marginBottom:4},children:Z},Z))})]})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-out Notes"}),i.jsx("textarea",{rows:4,value:s,onChange:Z=>a(Z.target.value),placeholder:"Notes about the vehicle condition upon return, battery level, etc."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Damage Fee (VND)"}),i.jsx("input",{type:"number",min:"0",value:l,onChange:Z=>c(Z.target.value),placeholder:"Enter damage fee (based on incidents reviewed)"})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:_,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:_?"Processing":"Confirm Check Out"})]})]})]})]})}function Hj({bookingId:e,onClose:t}){const[n,s]=y.useState([]),[a,l]=y.useState(!0),[c,u]=y.useState(""),[f,p]=y.useState(1),g=20;y.useEffect(()=>{e&&(async()=>{try{l(!0),u("");const j=await staffApi.getIncidentsByBooking(e,f,g);s(Array.isArray(j)?j:[]),console.log(" Incidents loaded:",j)}catch(j){console.error(" Failed to load incidents:",j),u((j==null?void 0:j.message)||"Failed to load incidents")}finally{l(!1)}})()},[e,f]);const v=j=>{const k=String(j||"").toLowerCase();return k.includes("high")?"#d32f2f":k.includes("medium")?"#f57c00":k.includes("low")?"#fbc02d":"#666"};return i.jsxs("div",{className:"modal-content",style:{width:"min(420px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("h3",{style:{margin:0},children:"Related Incidents"}),i.jsx("span",{className:"close-btn",onClick:t,style:{cursor:"pointer",fontSize:24},children:""})]}),a?i.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" Loading incidents..."}):c?i.jsxs("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6},children:[" ",c]}):n.length===0?i.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" No incidents reported for this booking"}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:n.map((j,k)=>i.jsxs("div",{style:{border:"1px solid #eee",padding:12,borderRadius:6},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[i.jsx("h4",{style:{margin:"0 0 4px",fontSize:14,fontWeight:600},children:j.title}),i.jsx("div",{style:{background:v(j.severity),color:"#fff",padding:"2px 8px",borderRadius:4,fontSize:11,fontWeight:600},children:j.severity||"N/A"})]}),i.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#555",lineHeight:1.4},children:j.description}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,color:"#999"},children:[i.jsxs("span",{children:["Est. Cost: ",i.jsx("strong",{children:j.estimatedCost?`$${Number(j.estimatedCost).toFixed(2)}`:"N/A"})]}),i.jsx("span",{children:j.timestamp?new Date(j.timestamp).toLocaleDateString():"N/A"})]})]},k))}),!a&&n.length>0&&i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:[i.jsx("button",{onClick:()=>p(j=>Math.max(1,j-1)),disabled:f===1,style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:f===1?"not-allowed":"pointer"},children:" Prev"}),i.jsxs("span",{style:{padding:"6px 12px"},children:["Page ",f]}),i.jsx("button",{onClick:()=>p(j=>j+1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Next "})]})]})}function Zj({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:a,onContinuePayment:l,onCancelBooking:c,onStatusUpdated:u}){const[f,p]=y.useState(null),[g,v]=y.useState(null),[j,k]=y.useState(null);Yn.useEffect(()=>{if(!(j!=null&&j.id))return;const S=setInterval(async()=>{try{const P=localStorage.getItem("activeCheckOutBookingId");if(!P)return;const _=await staffApi.getBookingById(P);console.log(" Polling booking status:",_==null?void 0:_.bookingStatus),((_==null?void 0:_.bookingStatus)===5||(_==null?void 0:_.status)===5||(_==null?void 0:_.bookingStatus)==="completed"||(_==null?void 0:_.status)==="completed")&&(console.log(" Payment completed! Booking status = 5"),localStorage.removeItem("activeCheckOutBookingId"),clearInterval(S),k(null),u==null||u(P))}catch(P){console.warn(" Polling error:",P==null?void 0:P.message)}},3e3);return()=>clearInterval(S)},[j==null?void 0:j.id,u]),Yn.useEffect(()=>{if(!(g!=null&&g.id))return;const S=setInterval(async()=>{try{const P=localStorage.getItem("activeCheckInBookingId");if(!P)return;const _=await staffApi.getBookingById(P);console.log(" Polling check-in booking status:",_==null?void 0:_.bookingStatus),((_==null?void 0:_.bookingStatus)===3||(_==null?void 0:_.status)===3||(_==null?void 0:_.bookingStatus)>=3)&&(console.log(" Check-in payment completed! Booking status = 3+"),localStorage.removeItem("activeCheckInBookingId"),clearInterval(S),v(null),u==null||u(P))}catch(P){console.warn(" Polling error (check-in):",P==null?void 0:P.message)}},3e3);return()=>clearInterval(S)},[g==null?void 0:g.id,u]);const C=e.filter(S=>(S.title.toLowerCase().includes(t.toLowerCase())||(S.customer||"").toLowerCase().includes(t.toLowerCase())||(S.userName||"").toLowerCase().includes(t.toLowerCase())||(S.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||S.status===s));return i.jsxs("div",{id:"booking",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsx("input",{type:"text",id:"searchBooking",placeholder:"Search by customer or car...",value:t,onChange:S=>n(S.target.value)}),i.jsxs("select",{id:"statusFilter",value:s,onChange:S=>a(S.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending (Awaiting Payment)"}),i.jsx("option",{value:"booked",children:"Active Rental"}),i.jsx("option",{value:"waiting-checkin",children:"Waiting Check-in"}),i.jsx("option",{value:"checked-in",children:"Checked-in"}),i.jsx("option",{value:"checkout-pending",children:"Check-out Pending"}),i.jsx("option",{value:"completed",children:"Completed"}),i.jsx("option",{value:"cancelled-pending",children:"Cancelled (Pending Refund)"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsx("div",{className:"booking-grid",id:"bookingGrid",children:C.map(S=>S.uiStage==="waiting-payment"?i.jsx(Oj,{booking:S,onClick:()=>p(S)},S.id):S.uiStage==="checkin-payment"?i.jsx(Dj,{booking:S,onClick:()=>p(S)},S.id):i.jsx(Mj,{booking:S,onClick:()=>p(S)},S.id))}),i.jsx(zj,{booking:f,onClose:()=>p(null),onProceed:(S,P)=>{S&&(P==="checkout"?(k(S),p(null)):(v(S),p(null)))},onCancel:()=>{f&&(c==null||c(f))},onStatusUpdated:u}),g&&i.jsx($j,{booking:g,onClose:()=>v(null)}),j&&i.jsxs("div",{style:{display:"flex",gap:24,position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:1e3,alignItems:"center",justifyContent:"center",padding:20,overflow:"auto"},children:[i.jsx("div",{style:{flex:"0 0 auto",width:"720px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:i.jsx(Wj,{booking:j,onClose:()=>k(null)})}),i.jsx("div",{style:{flex:"0 0 auto",width:"420px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:i.jsx(Hj,{bookingId:j==null?void 0:j.id,onClose:()=>k(null)})})]})]})}function Vj({vehicle:e,onOpen:t}){const n=s=>{wl(s.currentTarget)};return i.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[i.jsx("img",{src:jl(e.img),alt:e.name,onError:n}),i.jsxs("div",{className:"vehicle-info",children:[i.jsx("div",{className:"vehicle-title",children:e.name}),i.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),i.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),i.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),i.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function qj({open:e,onClose:t,onSubmit:n,stationId:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(""),[P,_]=y.useState(""),[x,w]=y.useState(""),[b,B]=y.useState(""),[T,F]=y.useState(""),[R,O]=y.useState(""),[I,D]=y.useState("");if(!e)return null;async function q(){if(D(""),!s){D("Please select a station before creating a vehicle.");return}if(!a.trim()||!c.trim()||!j.trim()||!f||!C||!P||!x||!b){D("Please fill all required fields: Brand, Model, Year, License Plate, Battery Capacity, Current Battery, Price/hour, Price/day.");return}const te=Number(f),G=Number(C),E=Number(P),oe=Number(x),Ne=Number(b);if(!Number.isFinite(te)||te<1900||te>2100){D("Year must be between 1900 and 2100.");return}if(!Number.isFinite(G)||G<0||G>100){D("Battery Capacity must be between 0 and 100 (kWh).");return}if(!Number.isFinite(E)||E<0||E>100){D("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(oe)||oe<=0||!Number.isFinite(Ne)||Ne<=0){D("Rental prices must be positive numbers.");return}const W={brand:a.trim(),model:c.trim(),year:te,color:g||void 0,licensePlate:j.trim(),batteryCapacity:G,currentBatteryLevel:E,rentalPricePerHour:oe,rentalPricePerDate:Ne,currentStationId:s,imageUrl:T||void 0,description:R||void 0};try{await n(W),l(""),u(""),p(""),v(""),k(""),S(""),_(""),w(""),B(""),F(""),O(""),t()}catch(fe){D((fe==null?void 0:fe.message)||"Failed to create vehicle")}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),I&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[i.jsx("input",{value:a,onChange:te=>l(te.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:c,onChange:te=>u(te.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:f,onChange:te=>p(te.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:g,onChange:te=>v(te.target.value),placeholder:"Color",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:j,onChange:te=>k(te.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:C,onChange:te=>S(te.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:P,onChange:te=>_(te.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:x,onChange:te=>w(te.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:b,onChange:te=>B(te.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:T,onChange:te=>F(te.target.value),placeholder:"Image URL",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}}),i.jsx("input",{value:R,onChange:te=>O(te.target.value),placeholder:"Description",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{onClick:q,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function Gj({open:e,onClose:t,vehicle:n,onSubmit:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState("");if(y.useEffect(()=>{n&&(l(n.battery??""),u(n.tech??""),p(n.issue??""))},[n]),!e||!n)return null;function g(){s(n.id,{battery:a,tech:c,issue:f}),t()}return i.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"vehicle-modal-content",children:[i.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),i.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),i.jsx("label",{children:"Battery Status"}),i.jsx("input",{value:a,onChange:v=>l(v.target.value),placeholder:"e.g. 80"}),i.jsx("label",{children:"Condition"}),i.jsxs("select",{value:c,onChange:v=>u(v.target.value),children:[i.jsx("option",{children:"Open"}),i.jsx("option",{children:"Running"}),i.jsx("option",{children:"Rented"}),i.jsx("option",{children:"Maintained"})]}),i.jsx("label",{children:"Issue"}),i.jsx("textarea",{value:f,onChange:v=>p(v.target.value)}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:g,children:"Submit Update"})})]})})}function Yj({open:e,vehicle:t,onClose:n,onEdit:s,onUpdate:a}){const[l,c]=y.useState(!1),[u,f]=y.useState(""),[p,g]=y.useState(""),[v,j]=y.useState(""),[k,C]=y.useState(!1);if(!e||!t)return null;const S=t.img,P=()=>{f(t.battery??""),g(t.tech??""),j(t.issue??""),c(!0)},_=async()=>{if(a){C(!0);try{await a(t.id,{battery:u,tech:p,issue:v}),c(!1)}catch(w){alert((w==null?void 0:w.message)||"Failed to update vehicle")}finally{C(!1)}}},x=()=>{c(!1),f(""),g(""),j("")};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsx("img",{src:S,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),i.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[i.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[i.jsx("h3",{style:{marginTop:4},children:t.name}),i.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Detail:"}),i.jsx("div",{children:t.detail||"N/A"})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Battery:"}),l?i.jsx("input",{type:"number",min:"0",max:"100",value:u,onChange:w=>f(w.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):i.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Condition:"}),l?i.jsx("input",{type:"text",value:p,onChange:w=>g(w.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):i.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[i.jsx("strong",{children:"Issue:"}),l?i.jsx("textarea",{value:v,onChange:w=>j(w.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):i.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),i.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:S,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),i.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:l?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:_,disabled:k,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:k?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:k?.6:1},children:[i.jsx("i",{className:"fas fa-save"})," ",k?"Saving...":"Save Changes"]}),i.jsxs("button",{onClick:x,disabled:k,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:k?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):a&&i.jsxs("button",{onClick:P,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]})})]})})}function Kj({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return i.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[i.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function Qj({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:a,canDelete:l=!0,stationSlots:c=null}){const[u,f]=y.useState(null),[p,g]=y.useState(!1),[v,j]=y.useState(!1),[k,C]=y.useState(!1),[S,P]=y.useState(""),_=e.filter(b=>{if(!S)return!0;const B=S.toLowerCase(),T=(b.name||"").toLowerCase(),F=(b.model||"").toLowerCase(),R=(b.brand||"").toLowerCase(),O=(b.licensePlate||"").toLowerCase();return T.includes(B)||F.includes(B)||R.includes(B)||O.includes(B)});function x(b){f(b),C(!0)}function w(b){f(b),g(!0)}return i.jsxs("div",{id:"vehicle",className:"section",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>j(!0),children:[i.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),i.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:S,onChange:b=>P(b.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),a&&c&&i.jsx(Kj,{stationSlots:c})]}),i.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!_||_.length===0)&&i.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:S?"No vehicles match your search.":"No vehicles available to display."}),_.map((b,B)=>i.jsx("div",{children:i.jsx(Vj,{vehicle:b,onOpen:()=>w(b)})},b.id||b.licensePlate||`${b.name}-${b.stationId||""}-${B}`))]}),i.jsx(qj,{open:v,onClose:()=>j(!1),onSubmit:t,stationId:a}),i.jsx(Gj,{open:k,onClose:()=>C(!1),vehicle:u,onSubmit:s}),i.jsx(Yj,{open:p,vehicle:u,onClose:()=>g(!1),onEdit:u?()=>x(u):null,onUpdate:s})]})}function Jj({open:e,onClose:t,inline:n=!1}){const[s,a]=y.useState(!1),[l,c]=y.useState({}),[u,f]=y.useState({}),[p,g]=y.useState("");if(y.useEffect(()=>{if(!e)return;let B=!0;async function T(){var F,R,O;try{a(!0),g("");let I={},D={};try{I=await staffApi.getMyProfile()}catch(q){((F=q==null?void 0:q.response)==null?void 0:F.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{D=await staffApi.getMe()}catch(q){((R=q==null?void 0:q.response)==null?void 0:R.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!B)return;c(I||{}),f(D||{});try{let q=(I==null?void 0:I.id)||(I==null?void 0:I.userId)||(D==null?void 0:D.userId)||(D==null?void 0:D.id);if(!q){const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=staffApi.decodeJwt(G);q=E["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||E.nameidentifier||E.sub||E.userId||E.UserId||E.id||E.Id}}if(!(D!=null&&D.role)&&!(I!=null&&I.role))try{const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=staffApi.decodeJwt(G),oe=(E==null?void 0:E.role)||(E==null?void 0:E.Role)||E["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];oe&&(D={...D,role:oe})}}catch{}const te=!(I!=null&&I.userName)&&!(D!=null&&D.userName)||!(I!=null&&I.address)||!(I!=null&&I.stationName);if(q&&te)try{const G=await staffApi.getUserById(q);if(!B)return;const E={...I};E.userName||(E.userName=(G==null?void 0:G.userName)||(G==null?void 0:G.UserName)||(G==null?void 0:G.username)||""),E.address||(E.address=(G==null?void 0:G.address)||(G==null?void 0:G.Address)||""),E.stationName||(E.stationName=(G==null?void 0:G.stationName)||((O=G==null?void 0:G.station)==null?void 0:O.name)||(G==null?void 0:G.StationName)||""),c(E)}catch{}}catch{}if((!I||Object.keys(I).length===0)&&(!D||Object.keys(D).length===0)){const q=typeof localStorage<"u"&&!!localStorage.getItem("token");g(q?"You may not have permission to view this profile.":"You are not logged in. Please log in with a staff account.")}}catch(I){if(!B)return;g((I==null?void 0:I.message)||"Failed to load profile")}finally{B&&a(!1)}}return T(),()=>{B=!1}},[e]),!e)return null;let v=l.userName||l.username||u.userName||u.username||"";if(!v)try{const B=typeof localStorage<"u"?localStorage.getItem("token"):null;if(B){const T=staffApi.decodeJwt(B);v=(T==null?void 0:T.preferred_username)||(T==null?void 0:T.unique_name)||(T==null?void 0:T.userName)||(T==null?void 0:T.username)||(T==null?void 0:T.name)||""}}catch{}const j=l.firstName?`${l.firstName} ${l.lastName||""}`.trim():l.fullName||u.fullName||u.name||"",k=l.email||u.email||"",C=l.phoneNumber||u.phoneNumber||"",S=l.address||u.address||"",P=l.createdAt||u.createdAt||"",_=l.employeeId||l.id||u.userId||u.id||"",x=l.stationName||l.station||"",w=l.role||u.role||(Array.isArray(u.roles)?u.roles.join(", "):u.roles||""),b=l.avatarUrl||u.avatarUrl||"https://via.placeholder.com/180x180?text=Staff";return n?i.jsxs("div",{className:"staff-profile-page",children:[i.jsx("div",{className:"staff-cover",children:i.jsx("div",{className:"staff-cover-gradient"})}),i.jsx("div",{className:"staff-header",children:i.jsxs("div",{className:"staff-header-inner",children:[i.jsx("div",{className:"staff-avatar",children:i.jsx("img",{src:b,alt:"Avatar"})}),i.jsxs("div",{className:"staff-title",children:[i.jsx("h1",{children:j}),i.jsxs("div",{className:"staff-meta",children:[i.jsx("span",{className:"staff-role",children:w||""}),i.jsx("span",{className:"staff-sep",children:""}),i.jsx("span",{className:"staff-station",children:x})]})]})]})}),i.jsxs("div",{className:"staff-content",children:[i.jsx("div",{className:"staff-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"About"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Full Name"}),i.jsx("span",{className:"value",children:j})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Role"}),i.jsx("span",{className:"value",children:w||""})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Station"}),i.jsx("span",{className:"value",children:x})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Employee ID"}),i.jsx("span",{className:"value",children:_})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Joined"}),i.jsx("span",{className:"value",children:String(P).toString().slice(0,10)||""})]})]})]})}),i.jsx("div",{className:"staff-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"Contact"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Email"}),i.jsx("span",{className:"value",children:k})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Phone"}),i.jsx("span",{className:"value",children:C})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Address"}),i.jsx("span",{className:"value",children:S})]})]})]})})]}),p&&i.jsx("div",{className:"staff-error",children:p})]}):i.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"profile-modal-content",children:[i.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),i.jsx("h2",{children:"Staff Profile"}),p&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:p}),i.jsx("img",{src:b,alt:"Staff",style:{borderRadius:"50%"}}),s?i.jsx("div",{style:{padding:16},children:"Loading profile"}):i.jsxs("div",{className:"profile-info-grid",children:[i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Name"}),i.jsx("div",{children:j})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Email"}),i.jsx("div",{children:k})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Role"}),i.jsx("div",{children:w||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Phone"}),i.jsx("div",{children:C})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Address"}),i.jsx("div",{children:S})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Joined"}),i.jsx("div",{children:String(P).toString().slice(0,10)||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Employee ID"}),i.jsx("div",{children:_})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Station"}),i.jsx("div",{children:x})]})]})]})})}function Xj(){return i.jsx("div",{id:"profile",className:"section",style:{padding:24},children:i.jsx(Jj,{open:!0,inline:!0,onClose:()=>{}})})}function e1({incident:e,onClick:t}){var l;const n=c=>{const u={Pending:{background:"#fef3c7",color:"#92400e",icon:"fa-clock"},InProgress:{background:"#dbeafe",color:"#1e40af",icon:"fa-spinner"},Resolved:{background:"#d1fae5",color:"#065f46",icon:"fa-check-circle"}},f=u[c]||u.Pending;return i.jsxs("span",{style:{...f,padding:"4px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:`fas ${f.icon}`}),c]})},s=c=>c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",a=c=>c==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(c);return i.jsxs("div",{className:"incident-card",onClick:()=>t(e),children:[i.jsxs("div",{className:"incident-card-header",children:[i.jsxs("div",{className:"incident-card-title",children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b",marginRight:"8px"}}),i.jsxs("span",{children:["Incident #",(l=e.id)==null?void 0:l.slice(0,8)]})]}),n(e.status)]}),i.jsxs("div",{className:"incident-card-body",children:[i.jsx("div",{className:"incident-description",children:e.description}),i.jsxs("div",{className:"incident-metadata",children:[i.jsxs("div",{className:"incident-meta-item",children:[i.jsx("i",{className:"fas fa-calendar"}),i.jsx("span",{children:s(e.reportedAt)})]}),e.bookingId&&i.jsxs("div",{className:"incident-meta-item",children:[i.jsx("i",{className:"fas fa-ticket-alt"}),i.jsxs("span",{children:["Booking: ",e.bookingId.slice(0,8),"..."]})]}),e.costIncurred!=null&&i.jsxs("div",{className:"incident-meta-item",style:{color:"#dc2626",fontWeight:"600"},children:[i.jsx("i",{className:"fas fa-dollar-sign"}),i.jsx("span",{children:a(e.costIncurred)})]}),e.images&&e.images.length>0&&i.jsxs("div",{className:"incident-meta-item",children:[i.jsx("i",{className:"fas fa-image"}),i.jsxs("span",{children:[e.images.length," image",e.images.length>1?"s":""]})]})]})]}),i.jsx("div",{className:"incident-card-footer",children:i.jsxs("span",{className:"incident-view-details",children:["View Details ",i.jsx("i",{className:"fas fa-arrow-right"})]})})]})}function t1({open:e,onClose:t,onSubmit:n,bookings:s=[]}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState([]),[g,v]=y.useState([]),[j,k]=y.useState(""),[C,S]=y.useState(!1);if(!e)return null;const P=w=>{const B=Array.from(w.target.files).filter(F=>["image/jpeg","image/jpg","image/png","image/gif"].includes(F.type)?F.size>26214400?(k(`File too large: ${F.name}. Max 25MB per file.`),!1):!0:(k(`Invalid file type: ${F.name}. Only JPG, PNG, GIF allowed.`),!1));p(B);const T=B.map(F=>URL.createObjectURL(F));v(T)},_=w=>{const b=f.filter((T,F)=>F!==w),B=g.filter((T,F)=>F!==w);URL.revokeObjectURL(g[w]),p(b),v(B)},x=async()=>{if(k(""),!a){k("Please select a booking");return}if(!c.trim()){k("Please provide incident description");return}S(!0);try{const w=new FormData;w.append("bookingId",a),w.append("description",c.trim()),f.forEach(b=>{w.append("images",b)}),await n(w),l(""),u(""),p([]),g.forEach(b=>URL.revokeObjectURL(b)),v([]),t()}catch(w){k((w==null?void 0:w.message)||"Failed to create incident")}finally{S(!1)}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"650px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("h3",{style:{marginTop:0,marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b"}}),"Report Incident"]}),j&&i.jsxs("div",{style:{background:"#fee2e2",color:"#b91c1c",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:[i.jsx("i",{className:"fas fa-exclamation-circle"})," ",j]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Select Booking ",i.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),i.jsxs("select",{value:a,onChange:w=>l(w.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"-- Select Booking --"}),s.map(w=>i.jsxs("option",{value:w.id,children:["Booking #",w.id.slice(0,8)," - ",w.vehicleName||"Vehicle"," (",w.status,")"]},w.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Incident Description ",i.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),i.jsx("textarea",{value:c,onChange:w=>u(w.target.value),placeholder:"Describe the incident in detail...",rows:5,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",resize:"vertical",fontFamily:"inherit"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:"Upload Images (Optional)"}),i.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.gif",multiple:!0,onChange:P,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",cursor:"pointer"}}),i.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:"Max 25MB per file. Formats: JPG, PNG, GIF"})]}),g.length>0&&i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:["Preview (",g.length," image",g.length>1?"s":"",")"]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px"},children:g.map((w,b)=>i.jsxs("div",{style:{position:"relative"},children:[i.jsx("img",{src:w,alt:`Preview ${b+1}`,style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e5e7eb"}}),i.jsx("button",{onClick:()=>_(b),style:{position:"absolute",top:"4px",right:"4px",background:"#dc2626",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fas fa-times"})})]},b))})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},children:[i.jsx("button",{onClick:t,disabled:C,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",opacity:C?.6:1},children:"Cancel"}),i.jsx("button",{onClick:x,disabled:C,style:{padding:"10px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:C?.6:1},children:C?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-spinner fa-spin"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-plus"}),"Create Incident"]})})]})]})})}function n1({open:e,incident:t,onClose:n,onUpdate:s,onResolve:a,onDelete:l,canDelete:c=!1}){var F,R;const[u,f]=y.useState(!1),[p,g]=y.useState(""),[v,j]=y.useState(""),[k,C]=y.useState(""),[S,P]=y.useState(!1);if(!e||!t)return null;const _=O=>O?new Date(O).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",x=O=>O==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(O),w=()=>{g(t.status||"Pending"),j(t.resolutionNotes||""),C(t.costIncurred||""),f(!0)},b=async()=>{P(!0);try{const O=new FormData;p&&O.append("status",p),v&&O.append("resolutionNotes",v),k&&O.append("costIncurred",k),await s(t.id,O),f(!1)}catch(O){alert((O==null?void 0:O.message)||"Failed to update incident")}finally{P(!1)}},B=async()=>{if(window.confirm("Mark this incident as resolved?")){P(!0);try{await a(t.id,v,k||0),n()}catch(O){alert((O==null?void 0:O.message)||"Failed to resolve incident")}finally{P(!1)}}},T=async()=>{if(window.confirm("Are you sure you want to delete this incident? This action cannot be undone.")){P(!0);try{await l(t.id),n()}catch(O){alert((O==null?void 0:O.message)||"Failed to delete incident")}finally{P(!1)}}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",background:"#fef9e7",border:"2px solid #d4af37",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",position:"relative"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsxs("div",{style:{textAlign:"center",borderBottom:"3px double #d4af37",paddingBottom:"20px",marginBottom:"24px"},children:[i.jsx("h2",{style:{margin:"0 0 8px 0",fontFamily:"Georgia, serif",color:"#1f2937",fontSize:"28px",fontWeight:"bold"},children:"INCIDENT REPORT"}),i.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",fontFamily:"Georgia, serif"},children:"Official Documentation"}),i.jsxs("div",{style:{display:"inline-block",marginTop:"12px",padding:"6px 16px",background:t.status==="Resolved"?"#d1fae5":t.status==="InProgress"?"#dbeafe":"#fef3c7",color:t.status==="Resolved"?"#065f46":t.status==="InProgress"?"#1e40af":"#92400e",borderRadius:"20px",fontSize:"13px",fontWeight:"600",border:`2px solid ${t.status==="Resolved"?"#10b981":t.status==="InProgress"?"#3b82f6":"#f59e0b"}`},children:["STATUS: ",(F=t.status)==null?void 0:F.toUpperCase()]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"24px",fontFamily:"Georgia, serif"},children:[i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Report ID:"}),i.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.id})]}),i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Reported Date:"}),i.jsx("div",{style:{color:"#1f2937",marginTop:"4px"},children:_(t.reportedAt)})]}),i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Booking Reference:"}),i.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[(R=t.bookingId)==null?void 0:R.slice(0,16),"..."]})]}),t.stationId&&i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Station ID:"}),i.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[t.stationId.slice(0,16),"..."]})]})]}),i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Incident Description:"}),i.jsx("p",{style:{color:"#1f2937",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.description})]}),t.images&&t.images.length>0&&i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsxs("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:["Evidence Photos (",t.images.length,"):"]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:t.images.map((O,I)=>i.jsx("a",{href:O,target:"_blank",rel:"noopener noreferrer",style:{display:"block"},children:i.jsx("img",{src:O,alt:`Evidence ${I+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",border:"2px solid #d4af37",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:D=>D.currentTarget.style.transform="scale(1.05)",onMouseOut:D=>D.currentTarget.style.transform="scale(1)"})},I))})]}),u?i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"2px solid #3b82f6"},children:[i.jsx("strong",{style:{fontSize:"16px",display:"block",marginBottom:"12px"},children:"Update Incident:"}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Status:"}),i.jsxs("select",{value:p,onChange:O=>g(O.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"},children:[i.jsx("option",{value:"Pending",children:"Pending"}),i.jsx("option",{value:"InProgress",children:"In Progress"}),i.jsx("option",{value:"Resolved",children:"Resolved"})]})]}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Resolution Notes:"}),i.jsx("textarea",{value:v,onChange:O=>j(O.target.value),rows:4,placeholder:"Enter resolution details...",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Cost Incurred (VND):"}),i.jsx("input",{type:"number",value:k,onChange:O=>C(O.target.value),placeholder:"0",min:"0",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"}})]})]}):i.jsxs(i.Fragment,{children:[t.resolutionNotes&&i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#d1fae5",borderRadius:"8px",border:"1px solid #10b981"},children:[i.jsx("strong",{style:{color:"#065f46",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Resolution Notes:"}),i.jsx("p",{style:{color:"#047857",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.resolutionNotes})]}),t.costIncurred!=null&&i.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#fee2e2",borderRadius:"8px",border:"1px solid #dc2626"},children:[i.jsx("strong",{style:{color:"#991b1b",fontSize:"16px",display:"block",marginBottom:"8px",fontFamily:"Georgia, serif"},children:"Cost Incurred:"}),i.jsx("div",{style:{color:"#dc2626",fontSize:"24px",fontWeight:"bold",fontFamily:"Georgia, serif"},children:x(t.costIncurred)})]})]}),i.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"20px",borderTop:"2px solid #e5e7eb",flexWrap:"wrap"},children:u?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>f(!1),disabled:S,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer",opacity:S?.6:1},children:[i.jsx("i",{className:"fas fa-times"})," Cancel"]}),i.jsxs("button",{onClick:b,disabled:S,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer",opacity:S?.6:1},children:[i.jsx("i",{className:"fas fa-save"})," ",S?"Saving...":"Save Changes"]})]}):i.jsxs(i.Fragment,{children:[c&&i.jsxs("button",{onClick:T,disabled:S,style:{padding:"10px 20px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer",marginRight:"auto"},children:[i.jsx("i",{className:"fas fa-trash"})," Delete"]}),t.status!=="Resolved"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:w,disabled:S,style:{padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:[i.jsx("i",{className:"fas fa-edit"})," Edit"]}),i.jsxs("button",{onClick:B,disabled:S,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:S?"not-allowed":"pointer"},children:[i.jsx("i",{className:"fas fa-check-circle"})," ",S?"Resolving...":"Mark Resolved"]})]}),i.jsx("button",{onClick:n,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Close"})]})})]})})}function r1({incidents:e=[],bookings:t=[],onCreateIncident:n,onUpdateIncident:s,onResolveIncident:a,onDeleteIncident:l,onRefresh:c,canDelete:u=!0,stationFilter:f=null}){const[p,g]=y.useState(!1),[v,j]=y.useState(!1),[k,C]=y.useState(null),[S,P]=y.useState(""),[_,x]=y.useState(""),w=e.filter(O=>{if(S&&O.status!==S)return!1;if(_){const I=_.toLowerCase(),D=(O.description||"").toLowerCase(),q=(O.id||"").toLowerCase(),te=(O.bookingId||"").toLowerCase();if(!D.includes(I)&&!q.includes(I)&&!te.includes(I))return!1}return!0}),b=O=>{C(O),j(!0)},B=async O=>{await n(O),c&&await c()},T=async(O,I)=>{await s(O,I),c&&await c(),j(!1)},F=async(O,I,D)=>{await a(O,I,D),c&&await c()},R=async O=>{await l(O),c&&await c()};return i.jsxs("div",{id:"incident",className:"section",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[i.jsxs("button",{className:"incident-add-btn",onClick:()=>g(!0),children:[i.jsx("i",{className:"fas fa-plus"})," Report Incident"]}),i.jsxs("div",{className:"incident-filters",style:{flex:1,display:"flex",gap:"12px"},children:[i.jsxs("select",{className:"incident-filter-select",value:S,onChange:O=>P(O.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"Pending",children:"Pending"}),i.jsx("option",{value:"InProgress",children:"In Progress"}),i.jsx("option",{value:"Resolved",children:"Resolved"})]}),i.jsx("input",{className:"incident-search-input",type:"text",placeholder:"Search by description, ID, or booking...",value:_,onChange:O=>x(O.target.value)})]})]}),i.jsx("div",{style:{padding:"8px 8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},children:w.length===0?"No incidents found":`Showing ${w.length} incident${w.length>1?"s":""}`}),w.length>0?i.jsx("div",{className:"incident-grid",children:w.map(O=>i.jsx(e1,{incident:O,onClick:b},O.id))}):i.jsxs("div",{className:"incident-empty-state",children:[i.jsx("i",{className:"fas fa-clipboard-check"}),i.jsx("h3",{children:"No Incidents"}),i.jsx("p",{children:_||S?"No incidents match your filters":"No incidents have been reported yet"})]}),i.jsx(t1,{open:p,onClose:()=>g(!1),onSubmit:B,bookings:t}),i.jsx(n1,{open:v,incident:k,onClose:()=>j(!1),onUpdate:T,onResolve:F,onDelete:R,canDelete:u})]})}const i1=[],s1=[];function a1(){var Ve,ft,qe,Nt;const[e,t]=y.useState("booking"),[n,s]=y.useState(i1),[a,l]=y.useState(s1),[c,u]=y.useState(!1),[f,p]=y.useState(""),[g,v]=y.useState(""),[j,k]=y.useState([]),[C,S]=y.useState([]),[P,_]=y.useState(!1),[x,w]=y.useState(""),[b,B]=y.useState(!1),[T,F]=y.useState(!1),[R,O]=y.useState(!1),[I,D]=y.useState(""),[q,te]=y.useState(""),[G,E]=y.useState(""),[oe,Ne]=y.useState(null),W=async ge=>{try{await Fe.confirmBooking(ge.id,"Cash",""),s(ae=>ae.map(ye=>ye.id===ge.id?{...ye,status:"booked"}:ye))}catch(ae){D((ae==null?void 0:ae.message)||"Failed to proceed to payment")}},fe=async(ge,ae="")=>{var ye;try{await Fe.cancelBooking(ge.id,ae||""),s(ue=>ue.map(xe=>xe.id===ge.id?{...xe,status:"denied"}:xe))}catch(ue){const xe=(ye=ue==null?void 0:ue.response)==null?void 0:ye.status;if(xe===401||xe===403){alert("You don't have permission to cancel this booking.");return}D((ue==null?void 0:ue.message)||"Failed to cancel booking")}},re=(ge,ae)=>{const ye=ae==="pending"?"Pending":ae==="booked"?"Active Rental":ae==="waiting-checkin"?"Waiting Check-in":ae==="checked-in"?"Checked-in":ae==="checkout-pending"?"Check-out Pending":ae==="completed"?"Completed":ae==="cancelled-pending"?"Cancelled (Pending Refund)":ae==="cancelled"?"Cancelled":ae;s(ue=>ue.map(xe=>xe.id===ge?{...xe,status:ae,statusLabel:ye}:xe))},U=async ge=>{var ae;try{const ye=ge.get("bookingId")||"",ue=ge.get("description")||"";let xe=[];try{xe=ge.getAll?ge.getAll("images"):[]}catch{xe=[]}const Ie=await Fe.createIncident(ye,ue,xe);try{await ie(x)}catch{}return Ie}catch(ye){throw console.error(" create incident failed",((ae=ye==null?void 0:ye.response)==null?void 0:ae.data)||(ye==null?void 0:ye.message)||ye),ye}},ie=async ge=>{if(!ge){S([]);return}_(!0);try{const ae=await Fe.getAllIncidents(ge,null,null,null,1,200),ue=((ae==null?void 0:ae.incidents)||[]||[]).map(xe=>({id:xe.id||xe.Id||xe.incidentId||xe.IncidentId||xe._id&&String(xe._id),description:xe.description||xe.Description||xe.details||"",bookingId:xe.bookingId||xe.BookingId||xe.booking||null,images:xe.images||xe.Images||[],status:xe.status||xe.Status||"Pending",reportedAt:xe.reportedAt||xe.ReportedAt||xe.createdAt||xe.CreatedAt||xe.date||null,costIncurred:xe.costIncurred??xe.CostIncurred??xe.cost??null,stationId:xe.stationId||xe.StationId||null,raw:xe}));S(ue)}catch(ae){console.error(" failed to load incidents for station",ae),S([])}finally{_(!1)}},Z=async(ge,ae)=>{try{await Fe.updateIncident(ge,ae),await ie(x)}catch(ye){throw console.error(" update incident failed",ye),ye}},se=async(ge,ae,ye)=>{try{await Fe.resolveIncident(ge,ae,Number(ye)||0),await ie(x)}catch(ue){throw console.error(" resolve incident failed",ue),ue}},ne=async ge=>{try{await Fe.deleteIncident(ge),await ie(x)}catch(ae){throw console.error(" delete incident failed",ae),ae}},ce=async ge=>{try{if(!x){D("Please select a station before creating a vehicle.");return}const ae={...ge};ae.currentStationId=x,ae.stationId=x,ae.StationId=x,ae.rentalPricePerDate!=null&&ae.rentalPricePerDay==null&&(ae.rentalPricePerDay=ae.rentalPricePerDate),ae.rentalPricePerDay!=null&&ae.rentalPricePerDate==null&&(ae.rentalPricePerDate=ae.rentalPricePerDay),ae.batteryCapacity!=null&&ae.BatteryCapacity==null&&(ae.BatteryCapacity=ae.batteryCapacity),ae.currentBatteryLevel!=null&&ae.CurrentBatteryLevel==null&&(ae.CurrentBatteryLevel=ae.currentBatteryLevel);const ye=await Fe.createCar(ae),ue=ye||{},xe=Ie=>({id:Ie.id||Ie.Id||Ie.carId||Ie.CarId,name:Ie.name||Ie.Name||[Ie.brand,Ie.model].filter(Boolean).join(" ")||"Car",model:Ie.model||Ie.Model||null,brand:Ie.brand||Ie.Brand||null,licensePlate:Ie.licensePlate||Ie.LicensePlate||null,img:Ie.imageUrl||Ie.image||Ie.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Ie.name||Ie.Name||Ie.model||"Car")}`,battery:Number.isFinite(Ie.currentBatteryLevel)?Math.round(Ie.currentBatteryLevel):void 0,tech:Ie.condition??Ie.status??Ie.Status??null,issue:Ie.issue??Ie.issueDescription??null,capacity:Ie.batteryCapacity??Ie.BatteryCapacity??Ie.capacity??Ie.capacityKWh??Ie.batteryCapacityKWh??null});return l(Ie=>[...Ie,xe(ue)]),await he(x),ye}catch(ae){throw D((ae==null?void 0:ae.message)||"Failed to create vehicle"),ae}},ke=async ge=>{var ae;try{await Fe.deleteCar(ge),l(ye=>ye.filter(ue=>ue.id!==ge)),await he(x)}catch(ye){const ue=(ae=ye==null?void 0:ye.response)==null?void 0:ae.status;if(ue===401||ue===403){te("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const xe=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Ie=!1;for(const Ft of xe)try{await Fe.updateStatus(ge,Ft),Ie=!0;break}catch{}if(Ie){l(Ft=>Ft.filter(wn=>wn.id!==ge));return}}catch{}D((ye==null?void 0:ye.message)||"Failed to delete vehicle")}},we=async(ge,ae)=>{try{if(ae.battery!==void 0&&ae.battery!==""){let ye=Number(ae.battery);Number.isNaN(ye)||(ye=Math.max(0,Math.min(100,Math.round(ye))),await Fe.updateBatteryLevel(ge,ye))}if(ae.tech&&await Fe.updateStatus(ge,ae.tech),ae.issue)try{await Fe.updateCarDescription(ge,ae.issue)}catch{await Fe.updateCar(ge,{description:ae.issue})}}catch(ye){D((ye==null?void 0:ye.message)||"Failed to update vehicle")}l(ye=>ye.map(ue=>ue.id===ge?{...ue,...ae}:ue))},he=async ge=>{if(!ge){Ne(null);return}try{const ae=await Fe.getCarStatusReport(ge,null);ae&&Ne({totalCars:ae.totalCars||0,availableCars:ae.availableCars||0})}catch(ae){console.warn("Failed to load station slots:",ae)}};return y.useEffect(()=>{c?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[c]),y.useEffect(()=>{let ge=!0;async function ae(){try{const ue=await Fe.getMe(),xe=(ue==null?void 0:ue.role)||(ue==null?void 0:ue.Role)||(ue==null?void 0:ue.roleName)||(ue==null?void 0:ue.userRole)||(Array.isArray(ue==null?void 0:ue.roles)?ue.roles[0]:"");ge&&E(xe||"")}catch{try{const ue=localStorage.getItem("token");if(ue){const xe=Fe.decodeJwt(ue),Ie=(xe==null?void 0:xe.role)||(xe==null?void 0:xe.Role)||xe["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];ge&&E(Ie||"")}}catch{}}}async function ye(){try{F(!0);const ue=localStorage.getItem("stationId");if(ue){console.log(" Staff assigned station from localStorage:",ue),ge&&w(ue);try{const Ie=await Fe.getAllStations(1,100);ge&&k(Ie||[])}catch(Ie){console.warn(" Failed to load stations for display:",Ie)}return}console.warn(" No stationId found in localStorage for staff user");const xe=await Fe.getAllStations(1,100);if(!ge)return;k(xe||[])}catch(ue){if(!ge)return;D((ue==null?void 0:ue.message)||"Failed to load stations")}finally{ge&&F(!1)}}return ae(),ye(),()=>{ge=!1}},[]),y.useEffect(()=>{let ge=!0;async function ae(){try{B(!0);let ue=[];if(x){let Se=[],z=[];try{Se=await Fe.getCarsByStation(x)}catch{}try{z=await Fe.getAvailableCarsByStation(x)}catch{}const X=J=>Array.isArray(J)?J:J?[J]:[],ee=X(Se),Q=X(z),M=new Map;for(const J of[...ee,...Q]){const Me=String((J==null?void 0:J.id)||(J==null?void 0:J.Id)||(J==null?void 0:J.carId)||(J==null?void 0:J.CarId)||(J==null?void 0:J.licensePlate)||(J==null?void 0:J.LicensePlate)||Math.random());M.has(Me)||M.set(Me,J)}ue=Array.from(M.values());try{const J=await Fe.getAllCars(1,1e3),Me=je=>je==null?"":String(je).replace(/[{}]/g,"").toLowerCase(),ve=Me(x),We=(J||[]).filter(je=>{var Le,Be,me,V;return[je.currentStationId,je.CurrentStationId,je.currentStationID,je.stationId,je.StationId,je.stationID,(Le=je.station)==null?void 0:Le.id,(Be=je.station)==null?void 0:Be.Id,(me=je.station)==null?void 0:me.stationId,(V=je.station)==null?void 0:V.StationId].some($e=>$e!=null&&Me($e)===ve)});for(const je of We){const $=String((je==null?void 0:je.id)||(je==null?void 0:je.Id)||(je==null?void 0:je.carId)||(je==null?void 0:je.CarId)||(je==null?void 0:je.licensePlate)||(je==null?void 0:je.LicensePlate));$&&!M.has($)&&M.set($,je)}ue=Array.from(M.values())}catch{}}else try{ue=await Fe.getAllCars(1,1e3)}catch{try{ue=await Fe.listCars({page:1,pageSize:1e3})}catch{ue=[]}}if(Array.isArray(ue)||(ue=ue?[ue]:[]),!ge)return;const xe=Se=>{const z=Number(Se);return Number.isFinite(z)&&z>=0&&z<=100?Math.round(z):null},Ie=(ue||[]).map(Se=>{var J,Me,ve,We;const X=((...je)=>je.find($=>$!=null&&$!==""))(Se.currentStationId,Se.CurrentStationId,Se.currentStationID,Se.stationId,Se.StationId,Se.stationID,(J=Se.station)==null?void 0:J.id,(Me=Se.station)==null?void 0:Me.Id,(ve=Se.station)==null?void 0:ve.stationId,(We=Se.station)==null?void 0:We.StationId),ee=je=>je==null?"":String(je).replace(/[{}]/g,"").toLowerCase(),Q=X||"",M=(()=>{if(!Q)return null;const je=j.find($=>ee($.id||$.Id)===ee(Q))||null;return je&&(je.name||je.Name)||null})();return{id:Se.id||Se.Id||Se.carId||Se.CarId,name:Se.name||Se.Name||Se.model||Se.CarName||"Car",model:Se.model||Se.Model||null,brand:Se.brand||Se.Brand||null,licensePlate:Se.licensePlate||Se.LicensePlate||null,img:Se.imageUrl||Se.image||Se.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Se.name||Se.Name||"Car")}`,battery:xe(Se.currentBatteryLevel??Se.CurrentBatteryLevel??Se.batteryPercent??Se.battery),tech:Se.condition??Se.status??Se.Status??null,issue:Se.issue??Se.issueDescription??null,capacity:Se.batteryCapacity??Se.BatteryCapacity??Se.capacity??Se.capacityKWh??Se.batteryCapacityKWh??null,stationId:Q,stationName:M||null}});l(Ie);const Ft=Ie.filter(Se=>Se.battery==null),wn=Ie.filter(Se=>Se.capacity==null);if(Ft.length>0)try{const Se=await Promise.all(Ft.map(async z=>{try{const X=await Fe.getCarBattery(z.id);return{id:z.id,battery:xe(X)}}catch{return{id:z.id,battery:null}}}));if(!ge)return;l(z=>z.map(X=>{const ee=Se.find(Q=>Q.id===X.id);return ee&&ee.battery!=null?{...X,battery:ee.battery}:X}))}catch{}if(wn.length>0)try{const Se=await Promise.all(wn.map(async z=>{try{const X=await Fe.getCarCapacity(z.id);return{id:z.id,capacity:X}}catch{return{id:z.id,capacity:null}}}));if(!ge)return;l(z=>z.map(X=>{const ee=Se.find(Q=>Q.id===X.id);return ee&&ee.capacity!=null?{...X,capacity:ee.capacity}:X}))}catch{}}catch(ue){if(!ge)return;D((ue==null?void 0:ue.message)||"Failed to load vehicles")}finally{ge&&B(!1)}}async function ye(){ge&&await he(x)}return ae(),ye(),()=>{ge=!1}},[x,j]),y.useEffect(()=>{let ge=!0;async function ae(){try{O(!0);let ye=[];if(x){console.log(" Loading active bookings for station:",x);try{ye=await Fe.getBookingsByStation(x,1,200),console.log(" Loaded active bookings:",ye==null?void 0:ye.length)}catch(z){console.error(" Error loading bookings:",z),ye=[]}}else console.warn(" No station ID set"),ye=[];if(!ge)return;const ue=(ye||[]).map(z=>{var Ut,pt,mt,en,Li,Ei,Ti,Kr,It,Pe,gr,yr,vr,xr,Kn,_r,dn,wr,Qr,Jr,Xr,ei,jr,ti,Fn,ni,ri,ii,si,ai,Qn,jn,Sr,Nr,Sn,Oe,Ke,Un,un,fn,Jn,Te,Je;const X=z.id||z.Id||z.bookingId||z.BookingId,ee=((Ut=z.car)==null?void 0:Ut.brand)||((pt=z.car)==null?void 0:pt.Brand)||((mt=z.vehicle)==null?void 0:mt.brand)||((en=z.vehicle)==null?void 0:en.Brand)||z.carBrand||z.CarBrand||null,Q=((Li=z.car)==null?void 0:Li.model)||((Ei=z.car)==null?void 0:Ei.Model)||((Ti=z.vehicle)==null?void 0:Ti.model)||((Kr=z.vehicle)==null?void 0:Kr.Model)||z.carModel||z.CarModel||null;let M=z.carName||z.vehicleName||((It=z.car)==null?void 0:It.name)||((Pe=z.car)==null?void 0:Pe.Name)||null;!M&&(ee||Q)&&(M=[ee,Q].filter(Boolean).join(" ").trim()||null),!M&&typeof z.carInfo=="string"&&z.carInfo.trim()&&(M=z.carInfo.trim()),!M&&typeof z.CarInfo=="string"&&z.CarInfo.trim()&&(M=z.CarInfo.trim()),M=M||"Booking";const J=((gr=z.user)==null?void 0:gr.firstName)||((yr=z.customer)==null?void 0:yr.firstName)||z.firstName||z.FirstName||((vr=z.user)==null?void 0:vr.FirstName)||((xr=z.customer)==null?void 0:xr.FirstName),Me=((Kn=z.user)==null?void 0:Kn.lastName)||((_r=z.customer)==null?void 0:_r.lastName)||z.lastName||z.LastName||((dn=z.user)==null?void 0:dn.LastName)||((wr=z.customer)==null?void 0:wr.LastName),ve=[J,Me].filter(Boolean).join(" "),We=ve||z.customerName||z.userFullName||((Qr=z.user)==null?void 0:Qr.fullName)||((Jr=z.customer)==null?void 0:Jr.name)||((Xr=z.user)==null?void 0:Xr.name)||"Customer",je=z.userId||z.UserId||((ei=z.user)==null?void 0:ei.id)||((jr=z.user)==null?void 0:jr.Id)||z.customerId||z.CustomerId||z.appUserId||z.AppUserId||z.accountId||z.AccountId||z.UserID||z.ownerId||z.OwnerId||z.createdById||z.CreatedById||"",$=((ti=z.user)==null?void 0:ti.userName)||((Fn=z.user)==null?void 0:Fn.UserName)||((ni=z.user)==null?void 0:ni.username)||z.userName||z.UserName||z.username||null,Le=((ri=z.user)==null?void 0:ri.email)||z.customerEmail||z.email||z.userEmail||"",Be=((ii=z.user)==null?void 0:ii.address)||z.customerAddress||z.address||"",me=z.statusCode??z.StatusCode??z.bookingStatus??z.BookingStatus??z.status??z.Status;let V="booked";if(me!=null&&(typeof me=="number"||/^\d+$/.test(String(me)))){const Ge=Number(me);Ge===0?V="pending":Ge===1?V="booked":Ge===2?V="waiting-checkin":Ge===3?V="checked-in":Ge===4?V="checkout-pending":Ge===5?V="completed":Ge===6?V="cancelled-pending":Ge===7&&(V="cancelled")}else{const Ge=String(me||"").toLowerCase();Ge.includes("pending")||Ge.includes("wait")?V="pending":Ge.includes("check")&&Ge.includes("in")?V="checked-in":Ge.includes("complete")||Ge.includes("finish")?V="completed":Ge.includes("cancel")?V="cancelled":V="booked"}const $e=V==="pending"?"Pending":V==="booked"?"Active Rental":V==="waiting-checkin"?"Waiting Check-in":V==="checked-in"?"Checked-in":V==="checkout-pending"?"Check-out Pending":V==="completed"?"Completed":V==="cancelled-pending"?"Cancelled (Pending Refund)":V==="cancelled"?"Cancelled":String(me||"")||"Booked",Ye=String(me||"").toLowerCase(),be=Number(me)===0||Ye.includes("pending")||Ye.includes("wait")?"waiting-payment":Ye.includes("check")&&Ye.includes("in")&&(Ye.includes("pay")||Ye.includes("payment"))?"checkin-payment":null;let tt=z.date||z.createdAt||z.bookingDate||"";if(tt)try{const Ge=new Date(tt);isNaN(Ge.getTime())||(tt=Ge.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:void 0}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5"))}catch{}const Zt=z.carImageUrl||((si=z.car)==null?void 0:si.imageUrl)||((ai=z.vehicle)==null?void 0:ai.imageUrl)||`https://via.placeholder.com/440x280?text=${encodeURIComponent(M)}`,cn=Ge=>{if(!Ge)return null;try{const Nn=new Date(Ge);if(!isNaN(Nn.getTime()))return Nn.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5")}catch{}return Ge},pr=cn(z.pickupDate||z.rentalStartDate||z.startDateTime||z.startDate),mr=cn(z.returnDate||z.rentalEndDate||z.endDateTime||z.endDate);return{id:X,title:M,firstName:J||null,lastName:Me||null,fullName:ve||z.userFullName||((Qn=z.user)==null?void 0:Qn.fullName)||((jn=z.customer)==null?void 0:jn.name)||((Sr=z.user)==null?void 0:Sr.name)||null,customer:We,userId:je,userName:$,email:Le,address:Be,status:V,statusLabel:$e,uiStage:be,date:tt,pickupDate:pr,returnDate:mr,img:Zt,cccdFrontUrl:z.cccdFrontUrl||z.identityFrontUrl||z.idFrontUrl||z.frontImageUrl||z.frontIdUrl||z.cccdFrontImageUrl||((Nr=z.customer)==null?void 0:Nr.cccdFrontUrl)||((Sn=z.user)==null?void 0:Sn.cccdFrontUrl),cccdBackUrl:z.cccdBackUrl||z.identityBackUrl||z.idBackUrl||z.backImageUrl||z.backIdUrl||z.cccdBackImageUrl||((Oe=z.customer)==null?void 0:Oe.cccdBackUrl)||((Ke=z.user)==null?void 0:Ke.cccdBackUrl),gplxFrontUrl:z.gplxFrontUrl||z.driverLicenseFrontUrl||z.gplxImageUrl_Front||((Un=z.customer)==null?void 0:Un.gplxImageUrl_Front)||((un=z.user)==null?void 0:un.gplxImageUrl_Front),gplxBackUrl:z.gplxBackUrl||z.driverLicenseBackUrl||z.gplxImageUrl_Back||((fn=z.customer)==null?void 0:fn.gplxImageUrl_Back)||((Jn=z.user)==null?void 0:Jn.gplxImageUrl_Back),idString:z.customerIdNumber||((Te=z.user)==null?void 0:Te.identityNumber)||"",phone:z.customerPhone||((Je=z.user)==null?void 0:Je.phoneNumber)||""}});s(ue);const xe=ue.filter(z=>z.userId&&!(z.firstName&&z.lastName));if(xe.length>0)try{const z=Array.from(new Set(xe.map(Q=>Q.userId))),X=await Promise.all(z.map(async Q=>{try{const M=await Fe.getUserById(Q),J=(M==null?void 0:M.firstName)||(M==null?void 0:M.FirstName)||(M==null?void 0:M.givenName)||(M==null?void 0:M.GivenName)||null,Me=(M==null?void 0:M.lastName)||(M==null?void 0:M.LastName)||(M==null?void 0:M.surname)||(M==null?void 0:M.Surname)||null,ve=(M==null?void 0:M.fullName)||(M==null?void 0:M.FullName)||[J,Me].filter(Boolean).join(" ")||null,We=(M==null?void 0:M.userName)||(M==null?void 0:M.UserName)||(M==null?void 0:M.username)||(M==null?void 0:M.user_name)||null,je=(M==null?void 0:M.address)||(M==null?void 0:M.Address)||"";return{uid:Q,firstName:J,lastName:Me,fullName:ve,userName:We,address:je}}catch{return{uid:Q,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!ge)return;const ee=new Map(X.map(Q=>[Q.uid,Q]));s(Q=>Q.map(M=>{if(M.userId&&ee.has(M.userId)){const J=ee.get(M.userId),Me=M.fullName||J.fullName||[J.firstName,J.lastName].filter(Boolean).join(" ");return{...M,firstName:M.firstName??J.firstName??null,lastName:M.lastName??J.lastName??null,fullName:Me||M.customer||M.userName||null,userName:M.userName??J.userName,address:M.address||J.address}}return M}))}catch{}const Ie=z=>{var X,ee,Q,M;return z.carId||z.CarId||z.vehicleId||z.VehicleId||((X=z.car)==null?void 0:X.id)||((ee=z.car)==null?void 0:ee.Id)||((Q=z.vehicle)==null?void 0:Q.id)||((M=z.vehicle)==null?void 0:M.Id)},Ft=ue.filter(z=>(!z.title||z.title==="Booking")&&Ie(z));if(Ft.length>0)try{const z=Array.from(new Set(Ft.map(Ie).filter(Boolean))),X=await Promise.all(z.map(async Q=>{try{let M=await Fe.getCarById(Q);if(!M||!M.id&&!M.Id)try{M=await Fe.getCarByIdRest(Q)}catch{}const J=(M==null?void 0:M.name)||(M==null?void 0:M.Name)||[M==null?void 0:M.brand,M==null?void 0:M.model].filter(Boolean).join(" ")||null,Me=(M==null?void 0:M.imageUrl)||(M==null?void 0:M.thumbnailUrl)||null;return{cid:Q,name:J,img:Me}}catch{return{cid:Q,name:null,img:null}}})),ee=new Map(X.map(Q=>[String(Q.cid),Q]));s(Q=>Q.map(M=>{const J=Ie(M),Me=J!=null?String(J):null;if(Me&&ee.has(Me)){const ve=ee.get(Me);return{...M,title:M.title&&M.title!=="Booking"?M.title:ve.name||M.title,img:M.img||ve.img||M.img}}return M}))}catch{}const Se=(z=>z.filter(X=>!X.title||X.title==="Booking"))(ue);if(Se.length>0)try{const z=await Promise.all(Se.map(async ee=>{try{const Q=await Fe.getVehicleModelFromBooking(ee.id),M=(Q==null?void 0:Q.name)||[Q==null?void 0:Q.brand,Q==null?void 0:Q.model].filter(Boolean).join(" ")||null;return{id:ee.id,title:M}}catch{return{id:ee.id,title:null}}})),X=new Map(z.map(ee=>[ee.id,ee.title]));s(ee=>ee.map(Q=>X.has(Q.id)&&X.get(Q.id)?{...Q,title:X.get(Q.id)}:Q))}catch{}}catch(ye){if(!ge)return;D((ye==null?void 0:ye.message)||"Failed to load bookings")}finally{ge&&O(!1)}}return ae(),()=>{ge=!1}},[x]),y.useEffect(()=>{ie(x)},[x]),i.jsxs("div",{className:"app-layout",children:[i.jsx(Fj,{}),i.jsx("div",{className:"sidebar-hover-zone",onMouseEnter:()=>u(!0)}),i.jsx("div",{className:`sidebar-wrapper ${c?"visible":""}`,onMouseLeave:()=>u(!1),children:i.jsx(Uj,{onSelect:t,isOpen:!0})}),i.jsxs("main",{className:`main-content ${c?"shifted":""}`,children:[q&&i.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:q}),I&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),e==="booking"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((Ve=j.find(ge=>(ge.id||ge.Id)===x))==null?void 0:Ve.name)||((ft=j.find(ge=>(ge.id||ge.Id)===x))==null?void 0:ft.Name)||x}),R&&i.jsx("span",{children:"Loading bookings"})]}),!R&&n.length===0&&i.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),i.jsx(Zj,{bookings:n,search:f,setSearch:p,statusFilter:g,setStatusFilter:v,onContinuePayment:W,onCancelBooking:fe,onStatusUpdated:re})]}),e==="vehicle"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((qe=j.find(ge=>(ge.id||ge.Id)===x))==null?void 0:qe.name)||((Nt=j.find(ge=>(ge.id||ge.Id)===x))==null?void 0:Nt.Name)||x}),b&&i.jsx("span",{children:"Loading vehicles"})]}),i.jsx(Qj,{vehicles:a,onAdd:ce,onRemove:ke,onUpdate:we,stationId:x,canDelete:String(G).toLowerCase()==="admin",stationSlots:oe})]}),e==="incident"&&i.jsx(r1,{incidents:C,bookings:n,onCreateIncident:U,onUpdateIncident:Z,onResolveIncident:se,onDeleteIncident:ne,onRefresh:async()=>{await ie(x)},canDelete:!0,stationFilter:x}),e==="profile"&&i.jsx(Xj,{})]})]})}function o1(){return i.jsxs("header",{className:"header-bar",children:[i.jsx("div",{className:"header-title",children:"Admin Page"}),i.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function l1({onSelect:e,isOpen:t,toggleSidebar:n}){return y.useEffect(()=>{t?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[t]),i.jsxs(i.Fragment,{children:[t&&i.jsx("div",{className:"sidebar-collider",onClick:n}),i.jsxs("div",{className:`sidebar ${t?"active":""}`,children:[i.jsx("h2",{children:"FEC Admin"}),i.jsx("div",{style:{marginTop:"60px"}}),i.jsxs("button",{onClick:()=>e("booking"),children:[i.jsx("i",{className:"fas fa-calendar-alt"})," Booking"]}),i.jsxs("button",{onClick:()=>e("vehicle"),children:[i.jsx("i",{className:"fas fa-car"})," Vehicle"]}),i.jsxs("button",{onClick:()=>e("user"),children:[i.jsx("i",{className:"fas fa-users"})," User"]}),i.jsxs("button",{onClick:()=>e("staff"),children:[i.jsx("i",{className:"fas fa-user-tie"})," Staff"]}),i.jsxs("button",{onClick:()=>e("incident"),children:[i.jsx("i",{className:"fas fa-exclamation-triangle"})," Incident"]}),i.jsxs("button",{onClick:()=>e("profile"),children:[i.jsx("i",{className:"fas fa-user-circle"})," Profile"]})]})]})}function c1({booking:e,onClick:t}){let n="booking-status-chip ";e.status==="booked"?n+="booking-status-booked":e.status==="denied"?n+="booking-status-denied":e.status==="completed"?n+="booking-status-completed":e.status==="pending"?n+="booking-status-pending":e.status==="checked-in"&&(n+="booking-status-checkedin");const s=a=>{wl(a.currentTarget)};return i.jsxs("div",{className:"booking-card",onClick:t,children:[i.jsx("img",{src:jl(e.img),alt:e.title,onError:s}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),i.jsx("div",{className:n,children:e.statusLabel||(e.status?e.status.toUpperCase():"")})]})}function d1({booking:e,onClick:t}){const n="booking-status-chip booking-status-pending",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return i.jsxs("div",{className:"booking-card waiting-payment",onClick:t,children:[i.jsx("img",{src:e.img,alt:e.title}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsxs("div",{className:"loading-row",title:"Waiting for payment confirmation",children:[i.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),i.jsx("div",{className:"booking-subtext",children:"Waiting for Payment"})]})]}),i.jsx("div",{className:n,children:"Pending"})]})}function u1({booking:e,onClick:t}){const n="booking-status-chip booking-status-checkedin",s=e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||"";return i.jsxs("div",{className:"booking-card checkin-payment",onClick:t,children:[i.jsx("img",{src:e.img,alt:e.title}),i.jsxs("div",{className:"booking-info",children:[i.jsx("div",{className:"booking-title",children:e.title}),i.jsxs("div",{className:"booking-customer",children:["Customer: ",s]}),i.jsx("div",{className:"booking-subtext",children:"Payment In Waiting"})]}),i.jsx("div",{className:n,children:"Payment In Waiting"})]})}const Re={confirmBooking:zt.confirmBooking,cancelBooking:zt.cancelBooking,completeBooking:zt.completeBooking,getBookingById:zt.getBookingById,listBookings:async(e={})=>{var t;try{const{page:n=1,pageSize:s=100}=e;console.log(` Listing bookings: page=${n}, pageSize=${s}`);const a=await de.get("/Bookings/Get-All",{params:{pageNumber:n,pageSize:s}}),l=a==null?void 0:a.data;return Array.isArray(l)?l:l!=null&&l.data&&Array.isArray(l.data)?l.data:(t=l==null?void 0:l.data)!=null&&t.data&&Array.isArray(l.data.data)?l.data.data:l!=null&&l.items&&Array.isArray(l.items)?l.items:(console.warn(" No bookings array found in listBookings response"),[])}catch(n){return console.error(" Error listing bookings:",n.message),[]}},createCar:Fe.createCar,deleteCar:Fe.deleteCar,updateCar:Fe.updateCar,updateStatus:Fe.updateStatus,updateBatteryLevel:Fe.updateBatteryLevel,updateCarDescription:Fe.updateCarDescription,getCarStatusReport:Fe.getCarStatusReport,getCarsByStation:Fe.getCarsByStation,getAllCars:En.getAllCars,getCarById:En.getCarById,getAvailableCarsByStation:En.getAvailableCarsByStation,getAllStations:Fe.getAllStations,getBookingsByStation:Fe.getBookingsByStation,getAllUsers:async(e=1,t=100,n=null)=>{var l,c;const s={pageNumber:e,pageSize:t};n&&(s.role=n);const a=[{url:"/Users/Get-All",params:s},{url:"/Admin/Users",params:s},{url:"/users",params:s}];for(const u of a)try{const f=await de.get(u.url,{params:u.params}),p=f==null?void 0:f.data;if(Array.isArray(p))return p;if(Array.isArray((l=p==null?void 0:p.data)==null?void 0:l.data))return p.data.data;if(Array.isArray(p==null?void 0:p.data))return p.data;if(Array.isArray(p==null?void 0:p.items))return p.items}catch(f){const p=(c=f==null?void 0:f.response)==null?void 0:c.status;if(p&&p!==404&&p!==405)throw f}return[]},assignStaffRole:async(e,t="")=>{var l;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Admin/Users/${n}/Assign-Staff-Role${s}`,`/Users/${n}/Assign-Staff-Role${s}`,`/Admin/Users/Assign-Staff-Role${s}`];for(const c of a)try{const u=await de.post(c,t?{userId:e,reason:t}:{userId:e}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Assign staff role endpoint not found")},removeStaffRole:async(e,t="")=>{var l;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Admin/Users/${n}/Remove-Staff-Role${s}`,`/Users/${n}/Remove-Staff-Role${s}`,`/Admin/Users/Remove-Staff-Role${s}`];for(const c of a)try{const u=await de.post(c,t?{userId:e,reason:t}:{userId:e}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Remove staff role endpoint not found")},getStaffByStation:async e=>{var s;if(!e)return[];const t=encodeURIComponent(e),n=[`/Admin/Staff/By-Station/${t}`,`/Staff/By-Station/${t}`,{url:"/Admin/Staff/By-Station",params:{stationId:e}}];for(const a of n)try{const l=typeof a=="string"?await de.get(a):await de.get(a.url,{params:a.params}),c=l==null?void 0:l.data;if(Array.isArray(c))return c;if(Array.isArray(c==null?void 0:c.data))return c.data;if(Array.isArray(c==null?void 0:c.items))return c.items}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return[]},getStationByStaff:async e=>{var s;if(!e)throw new Error("staffId is required");const t=encodeURIComponent(e),n=[`/Admin/Staff/${t}/Station`,`/Staff/${t}/Station`,`/Admin/Users/${t}/Station`,`/Users/${t}/Station`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data,u=c&&typeof c=="object"&&"data"in c?c.data:c;if(u)return u}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}return null},getCustomerProfile:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Customers/${t}/Profile`,`/Admin/Users/${t}/Profile`,`/Users/${t}/Profile`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Customer profile endpoint not found")},getUserDocuments:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Documents`,`/Users/${t}/Documents`];for(const a of n)try{const l=await de.get(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("User documents endpoint not found")},softDeleteUser:async(e,t="")=>{var l;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Admin/Users/${n}/Soft-Delete${s}`,`/Users/${n}/Soft-Delete${s}`];for(const c of a)try{const u=await de.post(c,t?{reason:t}:{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Soft delete user endpoint not found")},restoreUser:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Restore`,`/Users/${t}/Restore`];for(const a of n)try{const l=await de.post(a),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Restore user endpoint not found")},getDeletedAccounts:async(e=1,t=20,n=null)=>{var l;(!e||e<1)&&(e=1),(!t||t<1)&&(t=20);const s=new URLSearchParams({page:e.toString(),pageSize:t.toString()});n&&s.append("role",n);const a=[`/Admin/Users/Deleted-Accounts?${s}`,`/Users/Deleted-Accounts?${s}`];for(const c of a)try{const u=await de.get(c),f=u==null?void 0:u.data,p=f&&typeof f=="object"&&"data"in f?f.data:f;return(p==null?void 0:p.deletedAccounts)||p||[]}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Get deleted accounts endpoint not found")},getAdminDashboard:async()=>{var t;const e=["/Admin/Dashboard","/Dashboard"];for(const n of e)try{const s=await de.get(n),a=s==null?void 0:s.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(s){const a=(t=s==null?void 0:s.response)==null?void 0:t.status;if(a&&a!==404&&a!==405)throw s}throw new Error("Dashboard endpoint not found")},getFleetOverview:async()=>{var t;const e=["/Admin/Fleet/Overview","/Fleet/Overview"];for(const n of e)try{const s=await de.get(n),a=s==null?void 0:s.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(s){const a=(t=s==null?void 0:s.response)==null?void 0:t.status;if(a&&a!==404&&a!==405)throw s}return null},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Re.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},transferCar:async(e,t,n="")=>{var l;if(!e||!t)throw new Error("carId and targetStationId are required");const s={carId:e,targetStationId:t};n&&(s.reason=n);const a=["/Admin/Fleet/Transfer-Car","/Fleet/Transfer-Car"];for(const c of a)try{const u=await de.post(c,null,{params:s}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw new Error("Transfer car endpoint not found")},assignStaffToStation:async(e,t)=>{var s;if(!e||!t)throw new Error("stationId and staffId are required");const n=[{url:`/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}},{url:`/Admin/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}}];for(const a of n)try{const l=await de.post(a.url,null,{params:a.params}),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Assign staff to station endpoint not found")},unassignStaffFromStation:async e=>{var n;if(!e)throw new Error("staffId is required");const t=[{url:"/Stations/Unassign-Staff",params:{staffId:e}},{url:"/Admin/Stations/Unassign-Staff",params:{staffId:e}}];for(const s of t)try{const a=await de.post(s.url,null,{params:s.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(n=a==null?void 0:a.response)==null?void 0:n.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Unassign staff from station endpoint not found")},reassignStaff:async(e,t)=>{var s;if(!e||!t)throw new Error("staffId and toStationId are required");const n=[{url:"/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}},{url:"/Admin/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}}];for(const a of n)try{const l=await de.post(a.url,null,{params:a.params}),c=l==null?void 0:l.data;return c&&typeof c=="object"&&"data"in c?c.data:c}catch(l){const c=(s=l==null?void 0:l.response)==null?void 0:s.status;if(c&&c!==404&&c!==405)throw l}throw new Error("Reassign staff endpoint not found")},post:async(e,t,n={})=>{const s=await de.post(e,t,n);return s==null?void 0:s.data},get:async(e,t={})=>{const n=await de.get(e,t);return n==null?void 0:n.data},put:async(e,t,n={})=>{const s=await de.put(e,t,n);return s==null?void 0:s.data},patch:async(e,t,n={})=>{const s=await de.patch(e,t,n);return s==null?void 0:s.data},delete:async(e,t={})=>{const n=await de.delete(e,t);return n==null?void 0:n.data}};function f1({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:a}){var U,ie;const[l,c]=y.useState(!1),[u,f]=y.useState(!1),[p,g]=y.useState(!1),[v,j]=y.useState(!1),[k,C]=y.useState(""),[S,P]=y.useState(!1),[_,x]=y.useState(!1),[w,b]=y.useState(null),[B,T]=y.useState(!1),[F,R]=y.useState(null),[O,I]=y.useState(""),[D,q]=y.useState(""),[te,G]=y.useState("");if(y.useEffect(()=>{if(!e)return;c(!1),f(!1),g(!1),j(!1),C("");const Z=(we,he)=>[we,he].filter(Boolean).join(" "),se=e.fullName||Z(e.firstName,e.lastName);if(!(!se||/^customer$/i.test(se)||se==="")){C(se);return}if(!e.id)return;let ce=!1;async function ke(){P(!0);try{const{firstName:we,lastName:he}=await adminApi.getUserNameByBookingId(e.id);ce||C(Z(we,he))}catch{}finally{ce||P(!1)}}return ke(),()=>{ce=!0}},[e]),!e)return null;const E=(e==null?void 0:e.status)==="booked"?l&&u:!1,oe=()=>{if(!e)return;const Z=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,Z)},Ne=Z=>{let se="booked";if(Z!=null&&(typeof Z=="number"||/^\d+$/.test(String(Z)))){const ne=Number(Z);ne===0?se="pending":ne===1?se="booked":ne===2?se="waiting-checkin":ne===3?se="checked-in":ne===4?se="checkout-pending":ne===5?se="completed":ne===6?se="cancelled-pending":ne===7&&(se="cancelled")}else{const ne=String(Z||"").toLowerCase();ne.includes("pending")||ne.includes("wait")?se="pending":ne.includes("check")&&ne.includes("in")?se="checked-in":ne.includes("complete")||ne.includes("finish")?se="completed":ne.includes("deny")||ne.includes("reject")||ne.includes("cancel")?se="cancelled":se="booked"}return se},W=async()=>{var Z,se,ne,ce,ke;if(e!=null&&e.id){I(""),x(!0);try{const we=await adminApi.createPayment(e.id,"Rental","Rental payment at check-in");try{localStorage.setItem("currentBookingId",e.id)}catch{}const he=(we==null?void 0:we.checkoutUrl)||((Z=we==null?void 0:we.data)==null?void 0:Z.checkoutUrl)||(we==null?void 0:we.url)||"",Ve=(we==null?void 0:we.qrCode)||((se=we==null?void 0:we.data)==null?void 0:se.qrCode)||"";if(q(he),G(Ve),b(we),he)try{window.open(he,"_blank","noopener,noreferrer")}catch{}}catch(we){const he=(ne=we==null?void 0:we.response)==null?void 0:ne.status;if(he&&he!==400&&he!==409){x(!1),I(((ke=(ce=we==null?void 0:we.response)==null?void 0:ce.data)==null?void 0:ke.message)||(we==null?void 0:we.message)||"Failed to create payment");return}}x(!1)}},fe=async()=>{var Z,se;if(e!=null&&e.id){I(""),x(!0);try{await adminApi.syncPaymentStatus(e.id),R(new Date);const ne=await adminApi.getBookingById(e.id),ce=(ne==null?void 0:ne.statusCode)??(ne==null?void 0:ne.StatusCode)??(ne==null?void 0:ne.bookingStatus)??(ne==null?void 0:ne.BookingStatus)??(ne==null?void 0:ne.status)??(ne==null?void 0:ne.Status),ke=Ne(ce);if(ke&&ke!==e.status){a==null||a(e.id,ke),t==null||t();return}alert("Synced. Status unchanged; try again shortly if the gateway is still processing.")}catch(ne){I(((se=(Z=ne==null?void 0:ne.response)==null?void 0:Z.data)==null?void 0:se.message)||(ne==null?void 0:ne.message)||"Retry sync failed")}finally{x(!1)}}},re=async()=>{var Z,se;if(e!=null&&e.id){T(!0),I("");try{const ne=await adminApi.getPaymentByBooking(e.id);b(ne)}catch(ne){I(((se=(Z=ne==null?void 0:ne.response)==null?void 0:Z.data)==null?void 0:se.message)||(ne==null?void 0:ne.message)||"Unable to load payment info")}finally{T(!1)}}};return i.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("img",{id:"modalImage",src:e.facePhoto||e.img,alt:"",style:{width:"100%",borderRadius:8,objectFit:"cover",display:"block"}}),i.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),i.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),i.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((U=e.car)==null?void 0:U.name)||((ie=e.car)==null?void 0:ie.Name)||""]}),i.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(S?"Loading":"")]}),i.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",e.date]})]}),i.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:e.idString||""})})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontWeight:600},children:"Address:"}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:e.address||""})})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"CCCD Images:"}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),e.cccdFrontUrl?i.jsx("a",{href:e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:Z=>c(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),e.cccdBackUrl?i.jsx("a",{href:e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:u,onChange:Z=>f(Z.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Driver License (GPLX) Images:"}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Front"}),e.gplxFrontUrl?i.jsx("a",{href:e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:p,onChange:Z=>g(Z.target.checked)})," Verified"]})]}),i.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[i.jsx("div",{style:{marginBottom:6},children:"Back"}),e.gplxBackUrl?i.jsx("a",{href:e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:i.jsx("img",{src:e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):i.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),i.jsxs("label",{style:{display:"block",marginTop:6},children:[i.jsx("input",{type:"checkbox",checked:v,onChange:Z=>j(Z.target.checked)})," Verified"]})]})]})]}),i.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{id:"customerPhone",style:{padding:6},children:e.phone||""}),e.phone&&i.jsx("a",{href:`tel:${e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!E,style:{background:E?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),i.jsx("button",{onClick:oe,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:W,disabled:_,style:{background:"#43a047",color:"#fff",padding:"8px 16px",borderRadius:14},children:_?"Processing":"Confirm Check In"}),i.jsx("button",{onClick:fe,disabled:_,style:{background:"#1565c0",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Retry Sync"}),i.jsx("button",{onClick:re,disabled:B,style:{background:"#455a64",color:"#fff",padding:"8px 16px",borderRadius:14},children:B?"Loading":"View Payment Status"})]})]}),O&&i.jsx("div",{style:{marginTop:8,color:"#b00020"},children:O}),F&&i.jsxs("div",{style:{marginTop:4,color:"#555",fontSize:12},children:["Last sync: ",F.toLocaleTimeString()]}),(te||D)&&i.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #e0e0e0",borderRadius:8},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Complete Payment"}),te?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("img",{alt:"Pay QR",src:te,style:{width:160,height:160,objectFit:"contain",border:"1px solid #eee",borderRadius:6}}),i.jsx("div",{style:{color:"#555"},children:'Scan the QR to pay. After payment completes, use "Retry Sync" to update the booking.'})]}):i.jsx("div",{style:{color:"#555"},children:'Open the checkout to complete your payment, then return and press "Retry Sync".'}),D&&i.jsx("div",{style:{marginTop:10},children:i.jsx("a",{href:D,target:"_blank",rel:"noreferrer",style:{background:"#1565c0",color:"#fff",padding:"8px 14px",borderRadius:10,textDecoration:"none"},children:"Open Checkout"})})]}),w&&i.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #eee",borderRadius:8},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Payment"}),i.jsxs("div",{children:["Status: ",String(w.status||w.Status||w.paymentStatus||"")]}),i.jsxs("div",{children:["Gateway: ",String(w.gatewayStatus||w.GatewayStatus||w.providerStatus||"")]}),i.jsxs("div",{children:["Amount: ",w.amount??w.Amount??""]}),i.jsxs("div",{children:["Transaction: ",w.transactionId||w.TransactionId||w.txnId||""]}),i.jsxs("div",{children:["Updated: ",w.updatedAt||w.UpdatedAt||w.lastUpdated||""]})]})]})]}),i.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[i.jsx("h4",{children:"Transaction Details"}),i.jsxs("ul",{style:{fontSize:"1rem"},children:[i.jsx("li",{children:"Find rental location on map"}),i.jsx("li",{children:"View available vehicles (type, battery, price)"}),i.jsx("li",{children:"Book in advance or on-site"}),i.jsx("li",{children:"Check-in at counter/app"}),i.jsx("li",{children:"Sign electronic contract"}),i.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),i.jsx("li",{children:"Return vehicle at rental location"}),i.jsx("li",{children:"Staff checks and confirms vehicle condition"}),i.jsx("li",{children:"Pay any additional fees"})]})]})]})})}function h1({booking:e,onClose:t,onCheckedIn:n}){const[s,a]=y.useState(""),[l,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[v,j]=y.useState(!1),[k,C]=y.useState(""),[S,P]=y.useState(null);Yn.useEffect(()=>{let x=!0;return(async()=>{try{const w=await adminApi.getServerTime();x&&P(w);try{const b=w?w.getTime()-Date.now():0;console.log(" Server time:",w,"Client time:",new Date,"(ms):",b)}catch{}}catch{}})(),()=>{x=!1}},[]);async function _(x){var w,b;if(x.preventDefault(),!!(e!=null&&e.id)){j(!0),C("");try{const B=localStorage.getItem("token");if(!B||B==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let T="";try{T=await adminApi.resolveStaffId()}catch(I){try{T=localStorage.getItem("userId")||""}catch{}if(!T)throw I}const F={bookingId:e.id,adminId:T,adminSignature:u.trim()||"Admin",customerSignature:p.trim()||"Customer"},R=(s||"").trim();R&&(F.checkInNotes=R);const O=(l||"").trim();if(O)try{const I=new URL(O);(I.protocol==="http:"||I.protocol==="https:")&&(F.checkInPhotoUrl=O)}catch{}await adminApi.checkInWithContract(F),typeof n=="function"&&n(e.id,F),t==null||t()}catch(B){const T=(B==null?void 0:B.body)||((w=B==null?void 0:B.response)==null?void 0:w.data),F=T&&(T.errors||T.Errors)||null,R=(Array.isArray(F)&&F.length?F.join("; "):null)||(T==null?void 0:T.message)||(B==null?void 0:B.message)||"Failed to save check-in";C(R);try{console.error(" Check-in failed:",{error:B==null?void 0:B.message,status:(B==null?void 0:B.status)||((b=B==null?void 0:B.response)==null?void 0:b.status),body:T})}catch{}}finally{j(!1)}}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h3",{style:{marginBottom:12},children:"Check In"}),S&&i.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",S.toLocaleString()]}),k&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:k}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[i.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),i.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),i.jsxs("form",{onSubmit:_,style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Notes"}),i.jsx("textarea",{rows:5,value:s,onChange:x=>a(x.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("span",{children:"Check-in Photo URL"}),i.jsx("input",{type:"url",value:l,onChange:x=>c(x.target.value),placeholder:"https://..."})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsxs("span",{children:["Admin/Staff Signature ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",value:u,onChange:x=>f(x.target.value),placeholder:"Type admin/staff name or paste signature URL",required:!0})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsxs("span",{children:["Customer Signature ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",value:p,onChange:x=>g(x.target.value),placeholder:"Type customer name or paste signature URL",required:!0})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:v||!u.trim()||!p.trim(),style:{background:v||!u.trim()||!p.trim()?"#ccc":"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px",cursor:v||!u.trim()||!p.trim()?"not-allowed":"pointer"},children:v?"Saving":"Confirm Check In"})]})]})]})})}function p1({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:a,onContinuePayment:l,onCancelBooking:c,onStatusUpdated:u}){const[f,p]=y.useState(null),[g,v]=y.useState(null),j=e.filter(k=>(k.title.toLowerCase().includes(t.toLowerCase())||(k.customer||"").toLowerCase().includes(t.toLowerCase())||(k.userName||"").toLowerCase().includes(t.toLowerCase())||(k.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||k.status===s));return i.jsxs("div",{id:"booking",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsx("input",{type:"text",id:"searchBooking",placeholder:"Search by customer or car...",value:t,onChange:k=>n(k.target.value)}),i.jsxs("select",{id:"statusFilter",value:s,onChange:k=>a(k.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending"}),i.jsx("option",{value:"booked",children:"Booked"}),i.jsx("option",{value:"checked-in",children:"Check-in Pending"}),i.jsx("option",{value:"denied",children:"Denied"}),i.jsx("option",{value:"completed",children:"Completed"})]})]}),i.jsx("div",{className:"booking-grid",id:"bookingGrid",children:j.map(k=>k.uiStage==="waiting-payment"?i.jsx(d1,{booking:k,onClick:()=>p(k)},k.id):k.uiStage==="checkin-payment"?i.jsx(u1,{booking:k,onClick:()=>p(k)},k.id):i.jsx(c1,{booking:k,onClick:()=>p(k)},k.id))}),i.jsx(f1,{booking:f,onClose:()=>p(null),onProceed:()=>{f&&(v(f),p(null))},onCancel:()=>{f&&(c==null||c(f))},onStatusUpdated:u}),g&&i.jsx(h1,{booking:g,onClose:()=>v(null)})]})}function m1({vehicle:e,onOpen:t}){return i.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[i.jsx("img",{src:e.img,alt:e.name}),i.jsxs("div",{className:"vehicle-info",children:[i.jsx("div",{className:"vehicle-title",children:e.name}),i.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),i.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),i.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),i.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function g1({open:e,onClose:t,onSubmit:n,stationId:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(""),[P,_]=y.useState(""),[x,w]=y.useState(""),[b,B]=y.useState(""),[T,F]=y.useState(""),[R,O]=y.useState(null),[I,D]=y.useState(""),q=5*1024*1024,te=["image/jpeg","image/png","image/webp","image/jpg"];if(!e)return null;async function G(){if(D(""),!s){D("Please select a station before creating a vehicle.");return}if(!a.trim()||!c.trim()||!g.trim()||!j.trim()||!f||!C||!P||!x||!b||!T){D("Please fill all required fields: Brand, Model, Color, Year, License Plate, Battery Capacity, Current Battery, Seats, Price/hour, Price/day.");return}const E=Number(f),oe=Number(C),Ne=Number(P),W=Number(x),fe=Number(b),re=Number(T);if(!Number.isFinite(E)||E<1900||E>2100){D("Year must be between 1900 and 2100.");return}if(!Number.isFinite(oe)||oe<0||oe>1e4){D("Battery Capacity must be a positive number (kWh).");return}if(!Number.isFinite(Ne)||Ne<0||Ne>100){D("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(W)||W<=0||!Number.isFinite(fe)||fe<=0){D("Rental prices must be positive numbers.");return}if(!Number.isFinite(re)||re<=0){D("Seats must be a positive number.");return}if(R){if(!te.includes(R.type)){D(`Invalid file type. Allowed: ${te.join(", ")}`);return}if(R.size>q){D(`File size must be less than ${q/1024/1024}MB. Current: ${(R.size/1024/1024).toFixed(2)}MB`);return}}const U=new FormData;U.append("Brand",a.trim()),U.append("Model",c.trim()),U.append("Year",E),U.append("Color",g.trim()),U.append("LicensePlate",j.trim()),U.append("BatteryCapacity",oe),U.append("CurrentBatteryLevel",Ne),U.append("RentalPricePerHour",W),U.append("RentalPricePerDay",fe),U.append("Seats",re),U.append("CurrentStationId",s),R&&(U.append("CarImage",R,R.name),console.log(" Added CarImage:",R.name,"size:",R.size,"type:",R.type));try{await n(U),l(""),u(""),p(""),v(""),k(""),S(""),_(""),w(""),B(""),F(""),O(null),t()}catch(ie){D((ie==null?void 0:ie.message)||"Failed to create vehicle")}}return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),I&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:I}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[i.jsx("input",{value:a,onChange:E=>l(E.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:c,onChange:E=>u(E.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:f,onChange:E=>p(E.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:g,onChange:E=>v(E.target.value),placeholder:"Color *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:j,onChange:E=>k(E.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:C,onChange:E=>S(E.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:P,onChange:E=>_(E.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:x,onChange:E=>w(E.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:b,onChange:E=>B(E.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{value:T,onChange:E=>F(E.target.value),placeholder:"Seats *",type:"number",min:1,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),i.jsx("input",{type:"file",accept:"image/*",onChange:E=>{var Ne;const oe=((Ne=E.target.files)==null?void 0:Ne[0])||null;if(oe){if(!te.includes(oe.type)){D(`Invalid file type. Allowed: ${te.join(", ")}`),O(null);return}if(oe.size>q){D(`File size must be less than ${q/1024/1024}MB. Current: ${(oe.size/1024/1024).toFixed(2)}MB`),O(null);return}D(""),O(oe)}else O(null)},placeholder:"Car Image",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{onClick:G,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function y1({open:e,onClose:t,vehicle:n,onSubmit:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState("");if(y.useEffect(()=>{n&&(l(n.battery??""),u(n.tech??""),p(n.issue??""))},[n]),!e||!n)return null;function g(){s(n.id,{battery:a,tech:c,issue:f}),t()}return i.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"vehicle-modal-content",children:[i.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),i.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),i.jsx("label",{children:"Battery Status"}),i.jsx("input",{value:a,onChange:v=>l(v.target.value),placeholder:"e.g. 80"}),i.jsx("label",{children:"Condition"}),i.jsxs("select",{value:c,onChange:v=>u(v.target.value),children:[i.jsx("option",{children:"Open"}),i.jsx("option",{children:"Running"}),i.jsx("option",{children:"Rented"}),i.jsx("option",{children:"Maintained"})]}),i.jsx("label",{children:"Issue"}),i.jsx("textarea",{value:f,onChange:v=>p(v.target.value)}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{onClick:g,children:"Submit Update"})})]})})}function v1({open:e,vehicle:t,onClose:n,onEdit:s,onTransfer:a,onUpdate:l}){const[c,u]=y.useState(!1),[f,p]=y.useState(""),[g,v]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(!1);if(!e||!t)return null;const P=t.img,_=()=>{p(t.battery??""),v(t.tech??""),k(t.issue??""),u(!0)},x=async()=>{if(l){S(!0);try{await l(t.id,{battery:f,tech:g,issue:j}),u(!1)}catch(b){alert((b==null?void 0:b.message)||"Failed to update vehicle")}finally{S(!1)}}},w=()=>{u(!1),p(""),v(""),k("")};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsx("img",{src:P,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),i.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[i.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[i.jsx("h3",{style:{marginTop:4},children:t.name}),i.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Detail:"}),i.jsx("div",{children:t.detail||"N/A"})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Battery:"}),c?i.jsx("input",{type:"number",min:"0",max:"100",value:f,onChange:b=>p(b.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):i.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[i.jsx("strong",{children:"Condition:"}),c?i.jsx("input",{type:"text",value:g,onChange:b=>v(b.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):i.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[i.jsx("strong",{children:"Issue:"}),c?i.jsx("textarea",{value:j,onChange:b=>k(b.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):i.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),i.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:P,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),i.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:c?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:x,disabled:C,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:C?.6:1},children:[i.jsx("i",{className:"fas fa-save"})," ",C?"Saving...":"Save Changes"]}),i.jsxs("button",{onClick:w,disabled:C,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:C?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):i.jsxs(i.Fragment,{children:[l&&i.jsxs("button",{onClick:_,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]}),a&&i.jsxs("button",{onClick:()=>{n(),a()},style:{padding:"10px 24px",background:"#8b5cf6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fas fa-exchange-alt"})," Transfer Station"]})]})})]})})}function x1({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return i.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[i.jsx("i",{className:"fas fa-parking"})," ",t," Slot / ",n," Slot Taken"]})}function _1({open:e,onClose:t,vehicle:n,stations:s,currentStationId:a,onSubmit:l}){const[c,u]=y.useState(""),[f,p]=y.useState("Fleet rebalancing"),[g,v]=y.useState(!1);if(!e||!n)return null;const j=s.filter(C=>{const S=C.id||C.Id;return S&&S!==a}),k=async C=>{if(C.preventDefault(),!c){alert("Please select a station");return}v(!0);try{await l(n,c,f),u(""),p("Fleet rebalancing"),t()}catch(S){console.error("Transfer failed:",S)}finally{v(!1)}};return i.jsx("div",{className:"modal-backdrop",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{className:"modal-content",onClick:C=>C.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 10px 40px rgba(0,0,0,0.2)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsxs("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:[i.jsx("i",{className:"fas fa-exchange-alt",style:{marginRight:"8px",color:"#0ea5e9"}}),"Transfer Vehicle"]}),i.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",padding:"0",width:"32px",height:"32px"},children:""})]}),i.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"20px"},children:[i.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:n.name}),i.jsxs("div",{style:{fontSize:"14px",color:"#6b7280"},children:["Current Station: ",n.stationName||"Unknown"]})]}),i.jsxs("form",{onSubmit:k,children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:["Transfer to Station ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsxs("select",{value:c,onChange:C=>u(C.target.value),required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[i.jsx("option",{value:"",children:"-- Select Station --"}),j.map(C=>{const S=C.id||C.Id,P=C.name||C.Name||`Station ${S}`;return i.jsx("option",{value:S,children:P},S)})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:"Reason (optional)"}),i.jsx("textarea",{value:f,onChange:C=>p(C.target.value),placeholder:"Enter reason for transfer...",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),i.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i.jsx("button",{type:"button",onClick:t,disabled:g,style:{flex:1,padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",fontSize:"14px",fontWeight:"500",cursor:g?"not-allowed":"pointer",opacity:g?.6:1},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:g||!c,style:{flex:1,padding:"10px",border:"none",borderRadius:"6px",background:c&&!g?"#0ea5e9":"#9ca3af",color:"white",fontSize:"14px",fontWeight:"500",cursor:c&&!g?"pointer":"not-allowed"},children:g?"Transferring...":"Transfer Vehicle"})]})]})]})})}function w1({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:a,canDelete:l=!0,stationSlots:c=null,onTransferCar:u,stations:f}){const[p,g]=y.useState(null),[v,j]=y.useState(!1),[k,C]=y.useState(!1),[S,P]=y.useState(!1),[_,x]=y.useState(!1),[w,b]=y.useState(null),[B,T]=y.useState(""),F=e.filter(q=>{if(!B)return!0;const te=B.toLowerCase(),G=(q.name||"").toLowerCase(),E=(q.model||"").toLowerCase(),oe=(q.brand||"").toLowerCase(),Ne=(q.licensePlate||"").toLowerCase();return G.includes(te)||E.includes(te)||oe.includes(te)||Ne.includes(te)});function R(q){g(q),P(!0)}function O(q){g(q),j(!0)}function I(q){b(q),x(!0)}const D=async(q,te,G)=>{u&&await u(q,te,G)};return i.jsxs("div",{id:"vehicle",className:"section",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>C(!0),children:[i.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),i.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:B,onChange:q=>T(q.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),a&&c&&i.jsx(x1,{stationSlots:c})]}),i.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[(!F||F.length===0)&&i.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:B?"No vehicles match your search.":"No vehicles available to display."}),F.map((q,te)=>i.jsx("div",{children:i.jsx(m1,{vehicle:q,onOpen:()=>O(q)})},q.id||q.licensePlate||`${q.name}-${q.stationId||""}-${te}`))]}),i.jsx(g1,{open:k,onClose:()=>C(!1),onSubmit:t,stationId:a}),i.jsx(y1,{open:S,onClose:()=>P(!1),vehicle:p,onSubmit:s}),i.jsx(v1,{open:v,vehicle:p,onClose:()=>j(!1),onEdit:p?()=>R(p):null,onTransfer:u&&p?()=>I(p):null,onUpdate:s}),i.jsx(_1,{open:_,onClose:()=>{x(!1),b(null)},vehicle:w,stations:f||[],currentStationId:a,onSubmit:D})]})}function j1({user:e,onClick:t}){const n=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",s=e.email||e.Email||"",a=e.role||e.Role||e.userRole||"Customer",l=e.phoneNumber||e.PhoneNumber||e.phone||"";return i.jsxs("div",{className:"user-card",onClick:t,children:[i.jsx("div",{className:"user-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsxs("div",{className:"user-info",children:[i.jsx("div",{className:"user-name",children:n}),i.jsx("div",{className:"user-email",children:s}),i.jsx("div",{className:"user-role",children:a}),l!==""&&i.jsx("div",{className:"user-phone",children:l})]})]})}function S1({userId:e,userName:t,onClose:n}){const[s,a]=y.useState([]),[l,c]=y.useState(!0),[u,f]=y.useState(""),[p,g]=y.useState(""),[v,j]=y.useState("newest");y.useEffect(()=>{k()},[e]);const k=async()=>{var _,x;try{c(!0),f(""),console.log(" Fetching bookings for user:",e);const w=await zt.getUserBookings(e);console.log(" Bookings loaded:",w),a(w||[])}catch(w){console.error(" Error loading bookings:",w),f(((x=(_=w==null?void 0:w.response)==null?void 0:_.data)==null?void 0:x.message)||"Failed to load booking history")}finally{c(!1)}},C=_=>{const x={0:{text:"Pending",class:"status-pending",color:"#ff9800"},1:{text:"Active",class:"status-active",color:"#2196f3"},2:{text:"Waiting for check-in",class:"status-waiting",color:"#ff5722"},3:{text:"Checked-in",class:"status-checked-in",color:"#4caf50"},4:{text:"Check-out pending",class:"status-checkout-pending",color:"#9c27b0"},5:{text:"Completed",class:"status-completed",color:"#4caf50"},6:{text:"Cancelled pending refund",class:"status-cancelled-refund",color:"#f44336"},7:{text:"Cancelled",class:"status-cancelled",color:"#9e9e9e"}},w=Number(_);return x[w]||x[0]},S=_=>{if(!_)return"N/A";try{const x=new Date(_);return isNaN(x.getTime())?_:x.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return _}};let P=[...s];return p&&(P=P.filter(_=>String(_.bookingStatus)===p)),P.sort((_,x)=>{switch(v){case"oldest":return new Date(_.createdAt)-new Date(x.createdAt);case"price-high":return(x.totalAmount||0)-(_.totalAmount||0);case"price-low":return(_.totalAmount||0)-(x.totalAmount||0);default:return new Date(x.createdAt)-new Date(_.createdAt)}}),i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:n,children:i.jsxs("div",{style:{background:"white",borderRadius:"12px",width:"100%",maxWidth:"900px",maxHeight:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:_=>_.stopPropagation(),children:[i.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("h2",{style:{margin:0,marginBottom:"4px"},children:"Booking History"}),i.jsxs("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:["for ",t]})]}),i.jsx("button",{onClick:n,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#999",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"15px 20px",borderBottom:"1px solid #eee",display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("label",{style:{fontWeight:500},children:"Status:"}),i.jsxs("select",{value:p,onChange:_=>g(_.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"",children:"All"}),i.jsx("option",{value:"0",children:"Pending"}),i.jsx("option",{value:"1",children:"Active"}),i.jsx("option",{value:"2",children:"Waiting for check-in"}),i.jsx("option",{value:"3",children:"Checked-in"}),i.jsx("option",{value:"4",children:"Check-out pending"}),i.jsx("option",{value:"5",children:"Completed"}),i.jsx("option",{value:"6",children:"Cancelled pending refund"}),i.jsx("option",{value:"7",children:"Cancelled"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("label",{style:{fontWeight:500},children:"Sort by:"}),i.jsxs("select",{value:v,onChange:_=>j(_.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"newest",children:"Newest"}),i.jsx("option",{value:"oldest",children:"Oldest"}),i.jsx("option",{value:"price-high",children:"Price (High to Low)"}),i.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),i.jsx("button",{onClick:k,style:{padding:"8px 16px",background:"#1976d2",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:" Refresh"})]}),i.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[l&&i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[i.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"10px"}}),"Loading bookings..."]}),u&&i.jsxs("div",{style:{background:"#ffebee",color:"#c62828",padding:"15px",borderRadius:"8px",marginBottom:"15px",border:"1px solid #ef5350"},children:[i.jsx("strong",{children:"Error:"})," ",u]}),!l&&P.length===0&&i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[i.jsx("i",{className:"fas fa-inbox",style:{fontSize:"36px",marginBottom:"15px",display:"block"}}),i.jsx("p",{children:"No bookings found"})]}),!l&&P.length>0&&i.jsx("div",{style:{display:"grid",gap:"15px"},children:P.map((_,x)=>{const w=C(_.bookingStatus),b=S(_.startTime||_.pickupDateTime),B=S(_.endTime||_.expectedReturnDateTime),T=_.carInfo||"Car Rental",F=_.pickupStationName||"N/A",R=_.id||_.bookingId||"N/A";return i.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"15px",background:"#fafafa",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:"15px",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Car"}),i.jsx("div",{style:{fontWeight:500},children:T}),i.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:["Booking ID: ",R]})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Pick-up"}),i.jsx("div",{style:{fontSize:"13px"},children:F}),i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:b})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Return"}),i.jsx("div",{style:{fontSize:"13px"},children:B})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Total"}),i.jsx("div",{style:{fontWeight:600,fontSize:"15px",color:"#1976d2"},children:Rt(_.totalAmount||0)})]}),i.jsx("div",{style:{padding:"6px 12px",background:w.color,color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:500,textAlign:"center",whiteSpace:"nowrap"},children:w.text})]},x)})})]})]})})}function N1({user:e,onClose:t,onAssignStaff:n,onDelete:s}){const[a,l]=y.useState(!1),[c,u]=y.useState(!1);if(!e)return null;const f=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",p=e.email||e.Email||"",g=e.phoneNumber||e.PhoneNumber||e.phone||"",v=e.role||e.Role||e.userRole||"Customer",j=e.id||e.Id||e.userId||e.UserId;if(c)return i.jsx(S1,{userId:j,userName:f,onClose:()=>u(!1)});const k=async()=>{const S=window.prompt("Enter reason for promoting to staff (optional):")||"";if(S!==null){l(!0);try{await(n==null?void 0:n(e,S)),t==null||t()}catch(P){alert((P==null?void 0:P.message)||"Failed to assign staff role")}finally{l(!1)}}},C=async()=>{if(!window.confirm(`Are you sure you want to delete ${f}?`))return;const S=window.prompt("Enter reason for deletion (optional):")||"";l(!0);try{await(s==null?void 0:s(e,S)),t==null||t()}catch(P){alert((P==null?void 0:P.message)||"Failed to delete user")}finally{l(!1)}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsxs("div",{style:{textAlign:"center",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{"aria-hidden":!0,style:{width:"120px",height:"120px",borderRadius:"50%",background:"#eceff1",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"15px",color:"#607d8b"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),i.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),i.jsx("h2",{style:{margin:"10px 0"},children:f}),i.jsx("div",{style:{color:"#666",marginBottom:"20px"},children:v})]}),i.jsxs("div",{style:{padding:"0 20px 20px"},children:[i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Email:"}),i.jsx("span",{children:p})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Phone:"}),i.jsx("span",{children:g})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"User ID:"}),i.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:j})]})]}),i.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("button",{onClick:()=>u(!0),style:{background:"#1976d2",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:"pointer",opacity:a?.6:1},children:[i.jsx("i",{className:"fas fa-history",style:{marginRight:"6px"}}),"Booking History"]}),i.jsx("button",{onClick:k,disabled:a,style:{background:"#43a047",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:a?"not-allowed":"pointer",opacity:a?.6:1},children:a?"Processing...":"Promote to Staff"}),i.jsx("button",{onClick:C,disabled:a,style:{background:"#d32f2f",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:a?"not-allowed":"pointer",opacity:a?.6:1},children:a?"Processing...":"Delete User"})]})]})})}function C1({open:e,onClose:t,onSuccess:n}){const[s,a]=y.useState(""),[l,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[v,j]=y.useState(!1),[k,C]=y.useState(""),S=async P=>{var _,x;P.preventDefault(),C(""),j(!0);try{await adminApi.post("/Auth/Register",{fullName:s,email:l,phoneNumber:u,password:p}),a(""),c(""),f(""),g(""),n==null||n(),t()}catch(w){const b=((x=(_=w==null?void 0:w.response)==null?void 0:_.data)==null?void 0:x.message)||(w==null?void 0:w.message)||"Failed to create user";C(b)}finally{j(!1)}};return e?i.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:i.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h2",{children:"Create New User"}),i.jsxs("form",{onSubmit:S,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:s,onChange:P=>a(P.target.value),placeholder:"Full Name",required:!0,disabled:v}),i.jsx("i",{className:"fas fa-user"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:l,onChange:P=>c(P.target.value),placeholder:"Email",required:!0,disabled:v}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:u,onChange:P=>f(P.target.value),placeholder:"Phone",required:!0,disabled:v}),i.jsx("i",{className:"fas fa-phone"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:p,onChange:P=>g(P.target.value),placeholder:"Password",required:!0,disabled:v}),i.jsx("i",{className:"fas fa-lock"})]}),k&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:k}),i.jsx("button",{type:"submit",disabled:v,children:v?"Creating Account...":"Create User"})]})]})}):null}function k1({user:e,onClick:t}){const n=e.fullName||e.FullName||"Unknown User",s=e.email||e.Email||"N/A",a=e.userRole||e.role||e.Role||"N/A",l=e.deactivatedAt||"Unknown",c=e.daysDeactivated||0;return i.jsxs("div",{className:"user-card deleted-user-card",onClick:t,children:[i.jsxs("div",{className:"user-card-header",children:[i.jsx("div",{className:"user-avatar deleted",children:i.jsx("i",{className:"fas fa-user-slash"})}),i.jsxs("div",{className:"user-info",children:[i.jsx("h4",{className:"user-name",children:n}),i.jsx("p",{className:"user-email",children:s})]})]}),i.jsxs("div",{className:"user-card-body",children:[i.jsxs("div",{className:"user-detail",children:[i.jsx("span",{className:"label",children:"Role:"}),i.jsx("span",{className:"value",children:a})]}),i.jsxs("div",{className:"user-detail",children:[i.jsx("span",{className:"label",children:"Deleted:"}),i.jsx("span",{className:"value",children:l})]}),i.jsxs("div",{className:"user-detail",children:[i.jsx("span",{className:"label",children:"Days Inactive:"}),i.jsxs("span",{className:"value deleted-badge",children:[c," days"]})]})]}),i.jsx("div",{className:"user-card-footer",children:i.jsxs("span",{className:"user-status deleted-status",children:[i.jsx("i",{className:"fas fa-ban"})," Deleted"]})})]})}function P1({users:e,deletedUsers:t=[],loadingDeleted:n=!1,onAssignStaff:s,onDeleteUser:a,onRestoreUser:l,onUserCreated:c,onLoadDeleted:u}){const[f,p]=y.useState(null),[g,v]=y.useState(null),[j,k]=y.useState(""),[C,S]=y.useState(!1),[P,_]=y.useState("active");y.useEffect(()=>{P==="deleted"&&t.length===0&&!n&&u&&u()},[P,t.length,n,u]);const x=e.filter(B=>{const T=(B.role||B.Role||B.userRole||"").toLowerCase();return(j===""||(B.fullName||B.FullName||"").toLowerCase().includes(j.toLowerCase())||(B.email||B.Email||"").toLowerCase().includes(j.toLowerCase())||(B.userName||B.UserName||"").toLowerCase().includes(j.toLowerCase()))&&T!=="station staff"&&T!=="stationstaff"&&T!=="admin"}),w=t.filter(B=>j===""||(B.fullName||B.FullName||"").toLowerCase().includes(j.toLowerCase())||(B.email||B.Email||"").toLowerCase().includes(j.toLowerCase())||(B.userName||B.UserName||"").toLowerCase().includes(j.toLowerCase())),b=P==="active"?x:w;return i.jsxs("div",{id:"users",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>S(!0),style:{marginRight:"12px"},children:[i.jsx("i",{className:"fas fa-plus"})," Create User"]}),i.jsxs("div",{className:"view-mode-toggle",style:{marginRight:"12px"},children:[i.jsxs("button",{className:`toggle-btn ${P==="active"?"active":""}`,onClick:()=>_("active"),children:[i.jsx("i",{className:"fas fa-users"})," Active Users"]}),i.jsxs("button",{className:`toggle-btn ${P==="deleted"?"active":""}`,onClick:()=>_("deleted"),children:[i.jsx("i",{className:"fas fa-user-slash"})," Deleted Users"]})]}),i.jsx("input",{type:"text",placeholder:"Search by name, email, or username...",value:j,onChange:B=>k(B.target.value)}),i.jsxs("div",{style:{color:"#666",fontSize:"14px"},children:["Showing ",b.length," ",P==="active"?"active":"deleted"," users"]})]}),n&&P==="deleted"&&i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Loading deleted users..."}),!n&&i.jsxs("div",{className:"user-grid",children:[P==="active"&&x.map(B=>i.jsx(j1,{user:B,onClick:()=>p(B)},B.id||B.Id)),P==="deleted"&&w.map(B=>i.jsx(k1,{user:B,onClick:()=>v(B)},B.userId||B.id||B.Id))]}),b.length===0&&!n&&i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:["No ",P==="deleted"?"deleted":""," users found"]}),i.jsx(N1,{user:f,onClose:()=>p(null),onAssignStaff:s,onDelete:a}),g&&i.jsx("div",{className:"modal-overlay",onClick:()=>v(null),children:i.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Deleted User Details"}),i.jsx("button",{className:"modal-close",onClick:()=>v(null),children:i.jsx("i",{className:"fas fa-times"})})]}),i.jsxs("div",{className:"modal-body",children:[i.jsxs("div",{className:"user-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Name:"}),i.jsx("span",{children:g.fullName||g.FullName||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Email:"}),i.jsx("span",{children:g.email||g.Email||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Role:"}),i.jsx("span",{children:g.userRole||g.role||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Deleted At:"}),i.jsx("span",{children:g.deactivatedAt||"N/A"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("strong",{children:"Days Deactivated:"}),i.jsxs("span",{children:[g.daysDeactivated||0," days"]})]})]}),i.jsx("div",{className:"modal-actions",style:{marginTop:"20px"},children:i.jsxs("button",{className:"btn-restore",onClick:()=>{l&&(l(g),v(null))},children:[i.jsx("i",{className:"fas fa-undo"})," Restore User"]})})]})]})}),i.jsx(C1,{open:C,onClose:()=>S(!1),onSuccess:c})]})}function b1({staff:e,stations:t,onClick:n}){const s=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",a=e.email||e.Email||"",l=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/100x100?text=${encodeURIComponent(s.charAt(0))}`,c=e.phoneNumber||e.PhoneNumber||e.phone||"",u=e.stationId||e.StationId,f=t.find(v=>(v.id||v.Id)===u),p=f?f.name||f.Name:e.stationName||e.StationName||(u?`Station ${u.substring(0,8)}...`:"Not Assigned"),g=!u&&!e.stationName&&!e.StationName;return i.jsxs("div",{className:"staff-card",onClick:n,children:[i.jsx("img",{src:l,alt:s,className:"staff-avatar"}),i.jsxs("div",{className:"staff-info",children:[i.jsx("div",{className:"staff-name",children:s}),i.jsx("div",{className:"staff-email",children:a}),i.jsxs("div",{className:"staff-station",style:{color:g?"#ff9800":"inherit"},children:[g?"":""," ",p]}),c!==""&&i.jsxs("div",{className:"staff-phone",children:[" ",c]})]})]})}function I1({staff:e,stations:t,onClose:n,onRemoveStaff:s,onAssignStation:a,onUnassignStation:l}){const[c,u]=y.useState(!1),[f,p]=y.useState("");if(!e)return null;const g=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",v=e.email||e.Email||"",j=e.phoneNumber||e.PhoneNumber||e.phone||"",k=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/150x150?text=${encodeURIComponent(g.charAt(0))}`,C=e.id||e.Id||e.userId||e.UserId,S=e.stationId||e.StationId,P=t.find(T=>(T.id||T.Id)===S),_=P?P.name||P.Name:e.stationName||e.StationName||(S?`Station ${S.substring(0,8)}...`:"Not Assigned"),x=S||e.stationName||e.StationName,w=async()=>{if(!window.confirm(`Are you sure you want to remove staff role from ${g}?`))return;const T=window.prompt("Enter reason for removing staff role (optional):")||"";u(!0);try{await(s==null?void 0:s(e,T)),n==null||n()}catch(F){alert((F==null?void 0:F.message)||"Failed to remove staff role")}finally{u(!1)}},b=async()=>{if(!f){alert("Please select a station");return}if(window.confirm(`Assign ${g} to this station?`)){u(!0);try{await(a==null?void 0:a(e,f)),n==null||n()}catch(T){alert((T==null?void 0:T.message)||"Failed to assign station")}finally{u(!1)}}},B=async()=>{if(window.confirm(`Unassign ${g} from ${_}?`)){u(!0);try{await(l==null?void 0:l(e)),n==null||n()}catch(T){alert((T==null?void 0:T.message)||"Failed to unassign station")}finally{u(!1)}}};return i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[i.jsx("span",{className:"close-btn",onClick:n,children:""}),i.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[i.jsx("img",{src:k,alt:g,style:{width:"120px",height:"120px",borderRadius:"50%",objectFit:"cover",marginBottom:"15px"}}),i.jsx("h2",{style:{margin:"10px 0"},children:g}),i.jsx("div",{style:{color:"#43a047",fontWeight:600,marginBottom:"20px"},children:"Station Staff"})]}),i.jsxs("div",{style:{padding:"0 20px 20px"},children:[i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Email:"}),i.jsx("span",{children:v})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Phone:"}),i.jsx("span",{children:j})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"Station:"}),i.jsx("span",{children:_})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("strong",{children:"User ID:"}),i.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:C})]})]}),i.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee"},children:[i.jsx("h4",{style:{marginBottom:"12px",color:"#333"},children:x?"Reassign to Different Station":"Assign to Station"}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:x?"10px":"0"},children:[i.jsxs("select",{value:f,onChange:T=>p(T.target.value),style:{flex:1,padding:"10px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},disabled:c,children:[i.jsx("option",{value:"",children:"Select a station..."}),t.map(T=>i.jsxs("option",{value:T.id||T.Id,disabled:(T.id||T.Id)===S,children:[T.name||T.Name||`Station ${T.id||T.Id}`,(T.id||T.Id)===S?" (Current)":""]},T.id||T.Id))]}),i.jsx("button",{onClick:b,disabled:c||!f,style:{background:"#2196f3",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:c||!f?"not-allowed":"pointer",opacity:c||!f?.6:1,whiteSpace:"nowrap"},children:c?"Assigning...":x?"Reassign":"Assign"})]}),x&&l&&i.jsx("button",{onClick:B,disabled:c,style:{background:"#ff9800",color:"white",padding:"8px 16px",borderRadius:"8px",border:"none",cursor:c?"not-allowed":"pointer",opacity:c?.6:1,fontSize:"13px",width:"100%"},children:c?"Unassigning...":" Unassign from Station"})]}),i.jsx("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:w,disabled:c,style:{background:"#ff9800",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:c?"not-allowed":"pointer",opacity:c?.6:1},children:c?"Processing...":"Remove Staff Role"})})]})})}function L1({open:e,onClose:t,stations:n,onSuccess:s}){const[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState(""),[j,k]=y.useState(""),[C,S]=y.useState(!1),[P,_]=y.useState(""),x=async w=>{var b,B,T,F;w.preventDefault(),_(""),S(!0);try{const R=await adminApi.post("/Auth/Register",{fullName:a,email:c,phoneNumber:f,password:g}),O=((b=R==null?void 0:R.data)==null?void 0:b.id)||((B=R==null?void 0:R.data)==null?void 0:B.userId);if(!O)throw new Error("Failed to get user ID from registration response");try{await adminApi.assignStaffRole(O,"Assigned to station staff role during creation")}catch(I){throw console.warn("Failed to assign staff role:",I),new Error("User created but failed to assign staff role")}if(j)try{await adminApi.assignStaffToStation(j,O)}catch(I){console.warn("Staff role assigned but station assignment failed:",I)}l(""),u(""),p(""),v(""),k(""),s==null||s(),t()}catch(R){const O=((F=(T=R==null?void 0:R.response)==null?void 0:T.data)==null?void 0:F.message)||(R==null?void 0:R.message)||"Failed to create staff member";_(O)}finally{S(!1)}};return e?i.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:i.jsxs("div",{className:"modal-content",onClick:w=>w.stopPropagation(),children:[i.jsx("span",{className:"close-btn",onClick:t,children:""}),i.jsx("h2",{children:"Create New Staff Member"}),i.jsxs("form",{onSubmit:x,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:a,onChange:w=>l(w.target.value),placeholder:"Full Name",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-user"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:c,onChange:w=>u(w.target.value),placeholder:"Email",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:f,onChange:w=>p(w.target.value),placeholder:"Phone",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-phone"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:g,onChange:w=>v(w.target.value),placeholder:"Password",required:!0,disabled:C}),i.jsx("i",{className:"fas fa-lock"})]}),i.jsxs("div",{className:"input-group",style:{marginBottom:"15px"},children:[i.jsxs("select",{value:j,onChange:w=>k(w.target.value),required:!0,disabled:C,style:{width:"100%",padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",paddingLeft:"40px"},children:[i.jsx("option",{value:"",children:"Select Station"}),n.map(w=>i.jsx("option",{value:w.id||w.Id,children:w.name||w.Name||`Station ${w.id||w.Id}`},w.id||w.Id))]}),i.jsx("i",{className:"fas fa-map-marker-alt",style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",color:"#999"}})]}),P&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:P}),i.jsx("button",{type:"submit",disabled:C,children:C?"Creating Staff Member...":"Create Staff"})]})]})}):null}function E1({users:e,staffByStation:t=[],stations:n,onRemoveStaff:s,onAssignStation:a,onUnassignStation:l,onStaffCreated:c}){const[u,f]=y.useState(null),[p,g]=y.useState(""),[v,j]=y.useState(""),[k,C]=y.useState(!1),P=y.useMemo(()=>{const _=new Map;return t.forEach(x=>{const w=x.userId||x.id||x.Id;w&&_.set(w,x)}),e.forEach(x=>{const w=(x.role||x.Role||x.userRole||"").toLowerCase();if(w==="station staff"||w==="stationstaff"){const b=x.id||x.Id||x.userId;b&&!_.has(b)&&_.set(b,x)}}),Array.from(_.values())},[e,t]).filter(_=>{const x=p===""||(_.fullName||_.FullName||"").toLowerCase().includes(p.toLowerCase())||(_.email||_.Email||"").toLowerCase().includes(p.toLowerCase())||(_.userName||_.UserName||"").toLowerCase().includes(p.toLowerCase()),w=v===""||(_.stationId||_.StationId||"")===v;return x&&w});return i.jsxs("div",{id:"staff",className:"section",children:[i.jsxs("div",{className:"filter-bar",children:[i.jsxs("button",{className:"vehicle-add-btn",onClick:()=>C(!0),style:{marginRight:"12px"},children:[i.jsx("i",{className:"fas fa-plus"})," Create Staff"]}),i.jsx("input",{type:"text",placeholder:"Search staff by name, email, or username...",value:p,onChange:_=>g(_.target.value)}),i.jsxs("select",{value:v,onChange:_=>j(_.target.value),style:{padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"All Stations"}),n.map(_=>i.jsx("option",{value:_.id||_.Id,children:_.name||_.Name||`Station ${_.id||_.Id}`},_.id||_.Id))]}),i.jsxs("div",{style:{color:"#666",fontSize:"14px",whiteSpace:"nowrap"},children:[P.length," staff"]})]}),i.jsx("div",{className:"staff-grid",children:P.map(_=>i.jsx(b1,{staff:_,stations:n,onClick:()=>f(_)},_.id||_.Id))}),P.length===0&&i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No staff members found"}),i.jsx(I1,{staff:u,stations:n,onClose:()=>f(null),onRemoveStaff:s,onAssignStation:a,onUnassignStation:l}),i.jsx(L1,{open:k,onClose:()=>C(!1),stations:n,onSuccess:c})]})}function T1({open:e,onClose:t,inline:n=!1}){const[s,a]=y.useState(!1),[l,c]=y.useState({}),[u,f]=y.useState({}),[p,g]=y.useState("");if(y.useEffect(()=>{if(!e)return;let B=!0;async function T(){var F,R,O;try{a(!0),g("");let I={},D={};try{I=await Re.getMyProfile()}catch(q){((F=q==null?void 0:q.response)==null?void 0:F.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{D=await Re.getMe()}catch(q){((R=q==null?void 0:q.response)==null?void 0:R.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!B)return;c(I||{}),f(D||{});try{let q=(I==null?void 0:I.id)||(I==null?void 0:I.userId)||(D==null?void 0:D.userId)||(D==null?void 0:D.id);if(!q){const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=Re.decodeJwt(G);q=E["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||E.nameidentifier||E.sub||E.userId||E.UserId||E.id||E.Id}}if(!(D!=null&&D.role)&&!(I!=null&&I.role))try{const G=typeof localStorage<"u"?localStorage.getItem("token"):null;if(G){const E=Re.decodeJwt(G),oe=(E==null?void 0:E.role)||(E==null?void 0:E.Role)||E["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];oe&&(D={...D,role:oe})}}catch{}const te=!(I!=null&&I.userName)&&!(D!=null&&D.userName)||!(I!=null&&I.address)||!(I!=null&&I.stationName);if(q&&te)try{const G=await Re.getUserById(q);if(!B)return;const E={...I};E.userName||(E.userName=(G==null?void 0:G.userName)||(G==null?void 0:G.UserName)||(G==null?void 0:G.username)||""),E.address||(E.address=(G==null?void 0:G.address)||(G==null?void 0:G.Address)||""),E.stationName||(E.stationName=(G==null?void 0:G.stationName)||((O=G==null?void 0:G.station)==null?void 0:O.name)||(G==null?void 0:G.StationName)||""),c(E)}catch{}}catch{}if((!I||Object.keys(I).length===0)&&(!D||Object.keys(D).length===0)){const q=typeof localStorage<"u"&&!!localStorage.getItem("token");g(q?"You may not have permission to view this profile.":"You are not logged in. Please log in with a admin account.")}}catch(I){if(!B)return;g((I==null?void 0:I.message)||"Failed to load profile")}finally{B&&a(!1)}}return T(),()=>{B=!1}},[e]),!e)return null;let v=l.userName||l.username||u.userName||u.username||"";if(!v)try{const B=typeof localStorage<"u"?localStorage.getItem("token"):null;if(B){const T=Re.decodeJwt(B);v=(T==null?void 0:T.preferred_username)||(T==null?void 0:T.unique_name)||(T==null?void 0:T.userName)||(T==null?void 0:T.username)||(T==null?void 0:T.name)||""}}catch{}const j=l.firstName?`${l.firstName} ${l.lastName||""}`.trim():l.fullName||u.fullName||u.name||"",k=l.email||u.email||"",C=l.phoneNumber||u.phoneNumber||"",S=l.address||u.address||"",P=l.createdAt||u.createdAt||"",_=l.employeeId||l.id||u.userId||u.id||"",x=l.stationName||l.station||"",w=l.role||u.role||(Array.isArray(u.roles)?u.roles.join(", "):u.roles||""),b=l.avatarUrl||u.avatarUrl||"https://via.placeholder.com/180x180?text=Admin";return n?i.jsxs("div",{className:"admin-profile-page",children:[i.jsx("div",{className:"admin-cover",children:i.jsx("div",{className:"admin-cover-gradient"})}),i.jsx("div",{className:"admin-header",children:i.jsxs("div",{className:"admin-header-inner",children:[i.jsx("div",{className:"admin-avatar",children:i.jsx("img",{src:b,alt:"Avatar"})}),i.jsxs("div",{className:"admin-title",children:[i.jsx("h1",{children:j}),i.jsxs("div",{className:"admin-meta",children:[i.jsx("span",{className:"admin-role",children:w||""}),i.jsx("span",{className:"admin-sep",children:""}),i.jsx("span",{className:"admin-station",children:x})]})]})]})}),i.jsxs("div",{className:"admin-content",children:[i.jsx("div",{className:"admin-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"About"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Full Name"}),i.jsx("span",{className:"value",children:j})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Role"}),i.jsx("span",{className:"value",children:w||""})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Station"}),i.jsx("span",{className:"value",children:x})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Employee ID"}),i.jsx("span",{className:"value",children:_})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Joined"}),i.jsx("span",{className:"value",children:String(P).toString().slice(0,10)||""})]})]})]})}),i.jsx("div",{className:"admin-col",children:i.jsxs("div",{className:"card",children:[i.jsx("div",{className:"card-header",children:"Contact"}),i.jsxs("div",{className:"card-body info-list",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Email"}),i.jsx("span",{className:"value",children:k})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Phone"}),i.jsx("span",{className:"value",children:C})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"label",children:"Address"}),i.jsx("span",{className:"value",children:S})]})]})]})})]}),p&&i.jsx("div",{className:"admin-error",children:p})]}):i.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"profile-modal-content",children:[i.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),i.jsx("h2",{children:"Admin Profile"}),p&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:p}),i.jsx("img",{src:b,alt:"Admin",style:{borderRadius:"50%"}}),s?i.jsx("div",{style:{padding:16},children:"Loading profile"}):i.jsxs("div",{className:"profile-info-grid",children:[i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Name"}),i.jsx("div",{children:j})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Email"}),i.jsx("div",{children:k})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Role"}),i.jsx("div",{children:w||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Phone"}),i.jsx("div",{children:C})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Address"}),i.jsx("div",{children:S})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Joined"}),i.jsx("div",{children:String(P).toString().slice(0,10)||""})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Employee ID"}),i.jsx("div",{children:_})]}),i.jsxs("div",{className:"profile-info-card",children:[i.jsx("strong",{children:"Station"}),i.jsx("div",{children:x})]})]})]})})}function B1(){return i.jsx("div",{id:"profile",className:"section",style:{padding:24},children:i.jsx(T1,{open:!0,inline:!0,onClose:()=>{}})})}const R1=[],A1=[];function F1(){const[e,t]=y.useState("booking"),[n,s]=y.useState(R1),[a,l]=y.useState(A1),[c,u]=y.useState([]),[f,p]=y.useState([]),[g,v]=y.useState([]),[j,k]=y.useState(!1),[C,S]=y.useState(""),[P,_]=y.useState(""),[x,w]=y.useState([]),[b,B]=y.useState(""),[T,F]=y.useState(!1),[R,O]=y.useState(!1),[I,D]=y.useState(!1),[q,te]=y.useState(!1),[G,E]=y.useState(!1),[oe,Ne]=y.useState(!1),[W,fe]=y.useState(""),[re,U]=y.useState(""),[ie,Z]=y.useState(""),[se,ne]=y.useState(null),ce=async X=>{try{await Re.confirmBooking(X.id,"Cash",""),s(ee=>ee.map(Q=>Q.id===X.id?{...Q,status:"booked"}:Q))}catch(ee){fe((ee==null?void 0:ee.message)||"Failed to proceed to payment")}},ke=async(X,ee="")=>{var Q;try{await Re.cancelBooking(X.id,ee||""),s(M=>M.map(J=>J.id===X.id?{...J,status:"denied"}:J))}catch(M){const J=(Q=M==null?void 0:M.response)==null?void 0:Q.status;if(J===401||J===403){alert("You don't have permission to cancel this booking.");return}fe((M==null?void 0:M.message)||"Failed to cancel booking")}},we=(X,ee)=>{const Q=ee==="pending"?"Pending":ee==="booked"?"Booked":ee==="checked-in"?"Check-in Pending":ee==="completed"?"Completed":ee==="denied"?"Denied":ee;s(M=>M.map(J=>J.id===X?{...J,status:ee,statusLabel:Q}:J))},he=async X=>{try{if(!b){fe("Please select a station before creating a vehicle.");return}if(X instanceof FormData)console.log(" Received FormData payload for vehicle creation"),X.append("CurrentStationId",b);else{const J=X;J.currentStationId=b,J.stationId=b,J.StationId=b,J.rentalPricePerDate!=null&&J.rentalPricePerDay==null&&(J.rentalPricePerDay=J.rentalPricePerDate),J.rentalPricePerDay!=null&&J.rentalPricePerDate==null&&(J.rentalPricePerDate=J.rentalPricePerDay),J.batteryCapacity!=null&&J.BatteryCapacity==null&&(J.BatteryCapacity=J.batteryCapacity),J.currentBatteryLevel!=null&&J.CurrentBatteryLevel==null&&(J.CurrentBatteryLevel=J.currentBatteryLevel)}const ee=await Re.createCar(X),Q=ee||{},M=J=>({id:J.id||J.Id||J.carId||J.CarId,name:J.name||J.Name||[J.brand,J.model].filter(Boolean).join(" ")||"Car",model:J.model||J.Model||null,brand:J.brand||J.Brand||null,licensePlate:J.licensePlate||J.LicensePlate||null,img:J.imageUrl||J.image||J.thumbnailUrl||null,battery:Number.isFinite(J.currentBatteryLevel)?Math.round(J.currentBatteryLevel):void 0,tech:J.condition??J.status??J.Status??null,issue:J.issue??J.issueDescription??null,capacity:J.batteryCapacity??J.BatteryCapacity??J.capacity??J.capacityKWh??J.batteryCapacityKWh??null});return l(J=>[...J,M(Q)]),await Se(b),ee}catch(ee){throw fe((ee==null?void 0:ee.message)||"Failed to create vehicle"),ee}},Ve=async X=>{var ee;try{await Re.deleteCar(X),l(Q=>Q.filter(M=>M.id!==X)),await Se(b)}catch(Q){const M=(ee=Q==null?void 0:Q.response)==null?void 0:ee.status;if(M===401||M===403){U("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const J=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let Me=!1;for(const ve of J)try{await Re.updateStatus(X,ve),Me=!0;break}catch{}if(Me){l(ve=>ve.filter(We=>We.id!==X));return}}catch{}fe((Q==null?void 0:Q.message)||"Failed to delete vehicle")}},ft=async(X,ee)=>{try{if(ee.battery!==void 0&&ee.battery!==""){let Q=Number(ee.battery);Number.isNaN(Q)||(Q=Math.max(0,Math.min(100,Math.round(Q))),await Re.updateBatteryLevel(X,Q))}if(ee.tech&&await Re.updateStatus(X,ee.tech),ee.issue)try{await Re.updateCarDescription(X,ee.issue)}catch{await Re.updateCar(X,{description:ee.issue})}}catch(Q){fe((Q==null?void 0:Q.message)||"Failed to update vehicle")}l(Q=>Q.map(M=>M.id===X?{...M,...ee}:M))},qe=async()=>{te(!0);try{const ee=(await Re.getAllUsers(1,1e3)||[]).filter(Q=>Q.isActive!==!1&&Q.IsActive!==!1);u(ee)}catch(X){fe((X==null?void 0:X.message)||"Failed to load users")}finally{te(!1)}},Nt=async()=>{E(!0);try{const X=await Re.getDeletedAccounts(1,1e3);p(X||[])}catch(X){fe((X==null?void 0:X.message)||"Failed to load deleted users")}finally{E(!1)}},ge=async X=>{if(!X){v([]);return}Ne(!0);try{const ee=await Re.getStaffByStation(X);v(ee||[])}catch(ee){fe((ee==null?void 0:ee.message)||"Failed to load staff by station"),v([])}finally{Ne(!1)}},ae=async(X,ee)=>{try{await Re.assignStaffRole(X.id||X.Id||X.userId,ee),await qe(),b&&await ge(b),alert("User promoted to Station Staff successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to assign staff role")}},ye=async(X,ee)=>{try{await Re.removeStaffRole(X.id||X.Id||X.userId,ee),await qe(),b&&await ge(b),alert("Staff role removed successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to remove staff role")}},ue=async(X,ee)=>{try{const Q=X.id||X.Id||X.userId;X.stationId||X.StationId?await Re.reassignStaff(Q,ee):await Re.assignStaffToStation(ee,Q),await qe(),b&&await ge(b),alert("Staff assigned to station successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to assign staff to station")}},xe=async X=>{try{const ee=X.id||X.Id||X.userId;await Re.unassignStaffFromStation(ee),await qe(),b&&await ge(b),alert("Staff unassigned from station successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to unassign staff from station")}},Ie=async(X,ee)=>{try{const Q=X.id||X.Id||X.userId;await Re.softDeleteUser(Q,ee),u(M=>M.filter(J=>(J.id||J.Id||J.userId)!==Q)),await qe(),alert("User deleted successfully")}catch(Q){alert((Q==null?void 0:Q.message)||"Failed to delete user")}},Ft=async X=>{try{const ee=X.userId||X.id||X.Id;await Re.restoreUser(ee),p(Q=>Q.filter(M=>(M.userId||M.id||M.Id)!==ee)),await Nt(),await qe(),alert("User restored successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to restore user")}},wn=async(X,ee,Q)=>{try{await Re.transferCar(X.id,ee,Q||"");const M=x.find(J=>(J.id||J.Id)===ee);alert(`Vehicle transferred successfully to ${(M==null?void 0:M.name)||(M==null?void 0:M.Name)||"target station"}`),await z(b),await Se(b)}catch(M){throw alert((M==null?void 0:M.message)||"Failed to transfer vehicle"),M}},Se=async X=>{if(!X){ne(null);return}try{const ee=await Re.getCarStatusReport(X,null);ee&&ne({totalCars:ee.totalCars||0,availableCars:ee.availableCars||0})}catch(ee){console.warn("Failed to load station slots:",ee)}},z=async X=>{try{F(!0);let ee=[];if(X){let ve=[],We=[];try{ve=await Re.getCarsByStation(X)}catch{}try{We=await Re.getAvailableCarsByStation(X)}catch{}const je=me=>Array.isArray(me)?me:me?[me]:[],$=je(ve),Le=je(We),Be=new Map;for(const me of[...$,...Le]){const V=String((me==null?void 0:me.id)||(me==null?void 0:me.Id)||(me==null?void 0:me.carId)||(me==null?void 0:me.CarId)||(me==null?void 0:me.licensePlate)||(me==null?void 0:me.LicensePlate)||Math.random());Be.has(V)||Be.set(V,me)}ee=Array.from(Be.values());try{const me=await Re.getAllCars(1,1e3),V=be=>be==null?"":String(be).replace(/[{}]/g,"").toLowerCase(),$e=V(X),Ye=(me||[]).filter(be=>{var Zt,cn,pr,mr;return[be.currentStationId,be.CurrentStationId,be.currentStationID,be.stationId,be.StationId,be.stationID,(Zt=be.station)==null?void 0:Zt.id,(cn=be.station)==null?void 0:cn.Id,(pr=be.station)==null?void 0:pr.stationId,(mr=be.station)==null?void 0:mr.StationId].some(Ut=>Ut!=null&&V(Ut)===$e)});for(const be of Ye){const tt=String((be==null?void 0:be.id)||(be==null?void 0:be.Id)||(be==null?void 0:be.carId)||(be==null?void 0:be.CarId)||(be==null?void 0:be.licensePlate)||(be==null?void 0:be.LicensePlate));tt&&!Be.has(tt)&&Be.set(tt,be)}ee=Array.from(Be.values())}catch{}}else try{ee=await Re.getAllCars(1,1e3)}catch{try{ee=await Re.listCars({page:1,pageSize:1e3})}catch{ee=[]}}Array.isArray(ee)||(ee=ee?[ee]:[]);const Q=ve=>{const We=Number(ve);return Number.isFinite(We)&&We>=0&&We<=100?Math.round(We):null},M=(ee||[]).map(ve=>{var me,V,$e,Ye;const je=((...be)=>be.find(tt=>tt!=null&&tt!==""))(ve.currentStationId,ve.CurrentStationId,ve.currentStationID,ve.stationId,ve.StationId,ve.stationID,(me=ve.station)==null?void 0:me.id,(V=ve.station)==null?void 0:V.Id,($e=ve.station)==null?void 0:$e.stationId,(Ye=ve.station)==null?void 0:Ye.StationId),$=be=>be==null?"":String(be).replace(/[{}]/g,"").toLowerCase(),Le=je||"",Be=(()=>{if(!Le)return null;const be=x.find(tt=>$(tt.id||tt.Id)===$(Le))||null;return be&&(be.name||be.Name)||null})();return{id:ve.id||ve.Id||ve.carId||ve.CarId,name:ve.name||ve.Name||ve.model||ve.CarName||"Car",model:ve.model||ve.Model||null,brand:ve.brand||ve.Brand||null,licensePlate:ve.licensePlate||ve.LicensePlate||null,img:ve.imageUrl||ve.image||ve.thumbnailUrl||null,battery:Q(ve.currentBatteryLevel??ve.CurrentBatteryLevel??ve.batteryPercent??ve.battery),tech:ve.condition??ve.status??ve.Status??null,issue:ve.issue??ve.issueDescription??null,capacity:ve.batteryCapacity??ve.BatteryCapacity??ve.capacity??ve.capacityKWh??ve.batteryCapacityKWh??null,stationId:Le,stationName:Be||null}});l(M);const J=M.filter(ve=>ve.battery==null),Me=M.filter(ve=>ve.capacity==null);if(J.length>0)try{const ve=await Promise.all(J.map(async We=>{try{const je=await Re.getCarBattery(We.id);return{id:We.id,battery:Q(je)}}catch{return{id:We.id,battery:null}}}));l(We=>We.map(je=>{const $=ve.find(Le=>Le.id===je.id);return $&&$.battery!=null?{...je,battery:$.battery}:je}))}catch{}if(Me.length>0)try{const ve=await Promise.all(Me.map(async We=>{try{const je=await Re.getCarCapacity(We.id);return{id:We.id,capacity:je}}catch{return{id:We.id,capacity:null}}}));l(We=>We.map(je=>{const $=ve.find(Le=>Le.id===je.id);return $&&$.capacity!=null?{...je,capacity:$.capacity}:je}))}catch{}}catch(ee){fe((ee==null?void 0:ee.message)||"Failed to load vehicles")}finally{F(!1)}};return y.useEffect(()=>{j?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[j]),y.useEffect(()=>{let X=!0;async function ee(){try{const M=await Re.getMe(),J=(M==null?void 0:M.role)||(M==null?void 0:M.Role)||(M==null?void 0:M.roleName)||(M==null?void 0:M.userRole)||(Array.isArray(M==null?void 0:M.roles)?M.roles[0]:"");X&&Z(J||"")}catch{try{const M=localStorage.getItem("token");if(M){const J=Re.decodeJwt(M),Me=(J==null?void 0:J.role)||(J==null?void 0:J.Role)||J["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];X&&Z(Me||"")}}catch{}}}async function Q(){try{O(!0);const M=await Re.getAllStations(1,100);if(!X)return;w(M||[]);const J=M&&M[0]&&(M[0].id||M[0].Id)||"";B(Me=>Me||J)}catch(M){if(!X)return;fe((M==null?void 0:M.message)||"Failed to load stations")}finally{X&&O(!1)}}return ee(),Q(),qe(),()=>{X=!1}},[]),y.useEffect(()=>{let X=!0;async function ee(){X&&(await z(b),await Se(b))}return ee(),()=>{X=!1}},[b,x]),y.useEffect(()=>{let X=!0;async function ee(){try{D(!0);let Q=[];if(b){try{Q=await Re.getBookingsByStation(b)}catch{Q=[]}if(!Q||Q.length===0)try{const $=await Re.listBookings({page:1,pageSize:200}),Le=String(b);Q=($||[]).filter(Be=>{var V,$e;const me=Be.stationId||Be.StationId||((V=Be.station)==null?void 0:V.id)||(($e=Be.station)==null?void 0:$e.Id)||Be.pickupStationId||Be.PickupStationId;return me!=null&&String(me)===Le})}catch{}if(Q&&Q.length>0){const $=String(b);Q=Q.filter(Le=>{var me,V,$e,Ye,be,tt,Zt;return[Le.stationId,Le.StationId,(me=Le.station)==null?void 0:me.id,(V=Le.station)==null?void 0:V.Id,Le.pickupStationId,Le.PickupStationId,Le.pickUpStationId,Le.PickUpStationId,Le.startStationId,Le.StartStationId,Le.originStationId,Le.OriginStationId,Le.fromStationId,Le.FromStationId,($e=Le.car)==null?void 0:$e.stationId,(Ye=Le.car)==null?void 0:Ye.StationId,(be=Le.car)==null?void 0:be.currentStationId,(tt=Le.vehicle)==null?void 0:tt.stationId,(Zt=Le.vehicle)==null?void 0:Zt.StationId].some(cn=>cn!=null&&String(cn)===$)})}}else Q=await Re.listBookings({page:1,pageSize:100});if(!X)return;const M=(Q||[]).map($=>{var Kr,It,Pe,gr,yr,vr,xr,Kn,_r,dn,wr,Qr,Jr,Xr,ei,jr,ti,Fn,ni,ri,ii,si,ai,Qn,jn,Sr,Nr,Sn,Oe,Ke,Un,un,fn,Jn,Te,Je,Ge,Nn,Mt,ba,oi,Mn,at;const Le=$.id||$.Id||$.bookingId||$.BookingId,Be=((Kr=$.car)==null?void 0:Kr.brand)||((It=$.car)==null?void 0:It.Brand)||((Pe=$.vehicle)==null?void 0:Pe.brand)||((gr=$.vehicle)==null?void 0:gr.Brand)||$.carBrand||$.CarBrand||null,me=((yr=$.car)==null?void 0:yr.model)||((vr=$.car)==null?void 0:vr.Model)||((xr=$.vehicle)==null?void 0:xr.model)||((Kn=$.vehicle)==null?void 0:Kn.Model)||$.carModel||$.CarModel||null;let V=$.carName||$.vehicleName||((_r=$.car)==null?void 0:_r.name)||((dn=$.car)==null?void 0:dn.Name)||null;!V&&(Be||me)&&(V=[Be,me].filter(Boolean).join(" ").trim()||null),!V&&typeof $.carInfo=="string"&&$.carInfo.trim()&&(V=$.carInfo.trim()),!V&&typeof $.CarInfo=="string"&&$.CarInfo.trim()&&(V=$.CarInfo.trim()),V=V||"Booking";const $e=((wr=$.user)==null?void 0:wr.firstName)||((Qr=$.customer)==null?void 0:Qr.firstName)||$.firstName||$.FirstName||((Jr=$.user)==null?void 0:Jr.FirstName)||((Xr=$.customer)==null?void 0:Xr.FirstName),Ye=((ei=$.user)==null?void 0:ei.lastName)||((jr=$.customer)==null?void 0:jr.lastName)||$.lastName||$.LastName||((ti=$.user)==null?void 0:ti.LastName)||((Fn=$.customer)==null?void 0:Fn.LastName),be=[$e,Ye].filter(Boolean).join(" "),tt=be||$.customerName||$.userFullName||((ni=$.user)==null?void 0:ni.fullName)||((ri=$.customer)==null?void 0:ri.name)||((ii=$.user)==null?void 0:ii.name)||"Customer",Zt=$.userId||$.UserId||((si=$.user)==null?void 0:si.id)||((ai=$.user)==null?void 0:ai.Id)||$.customerId||$.CustomerId||$.appUserId||$.AppUserId||$.accountId||$.AccountId||$.UserID||$.ownerId||$.OwnerId||$.createdById||$.CreatedById||"",cn=((Qn=$.user)==null?void 0:Qn.userName)||((jn=$.user)==null?void 0:jn.UserName)||((Sr=$.user)==null?void 0:Sr.username)||$.userName||$.UserName||$.username||null,pr=((Nr=$.user)==null?void 0:Nr.email)||$.customerEmail||$.email||$.userEmail||"",mr=((Sn=$.user)==null?void 0:Sn.address)||$.customerAddress||$.address||"",Ut=$.statusCode??$.StatusCode??$.bookingStatus??$.BookingStatus??$.status??$.Status;let pt="booked",mt="Booked";if(Ut!=null&&(typeof Ut=="number"||/^\d+$/.test(String(Ut)))){const nt=Number(Ut);nt===0?(pt="pending",mt="Pending"):nt===1?(pt="booked",mt="Active"):nt===2?(pt="waiting-checkin",mt="Waiting for check-in"):nt===3?(pt="checked-in",mt="Checked-in"):nt===4?(pt="checkout-pending",mt="Check-out pending"):nt===5?(pt="completed",mt="Completed"):nt===6?(pt="cancelled-refund",mt="Cancelled pending refund"):nt===7&&(pt="cancelled",mt="Cancelled")}else{const nt=String(Ut||"").toLowerCase();nt.includes("pending")||nt.includes("wait")?(pt="pending",mt="Pending"):nt.includes("active")?(pt="booked",mt="Active"):nt.includes("check")&&nt.includes("in")?(pt="checked-in",mt="Checked-in"):nt.includes("complete")||nt.includes("finish")?(pt="completed",mt="Completed"):nt.includes("cancel")?(pt="cancelled",mt="Cancelled"):(pt="booked",mt="Booked")}const en=String(Ut||"").toLowerCase(),Li=Number(Ut)===0||en.includes("pending")||en.includes("wait")?"waiting-payment":en.includes("check")&&en.includes("in")&&(en.includes("pay")||en.includes("payment"))?"checkin-payment":null,Ei=$.date||$.createdAt||$.bookingDate||"",Ti=$.carImageUrl||((Oe=$.car)==null?void 0:Oe.imageUrl)||((Ke=$.vehicle)==null?void 0:Ke.imageUrl)||null;return{id:Le,title:V,firstName:$e||null,lastName:Ye||null,fullName:be||$.userFullName||((Un=$.user)==null?void 0:Un.fullName)||((un=$.customer)==null?void 0:un.name)||((fn=$.user)==null?void 0:fn.name)||null,customer:tt,userId:Zt,userName:cn,email:pr,address:mr,status:pt,statusLabel:mt,uiStage:Li,date:Ei,img:Ti,cccdFrontUrl:$.cccdFrontUrl||$.identityFrontUrl||$.idFrontUrl||$.frontImageUrl||$.frontIdUrl||$.cccdFrontImageUrl||((Jn=$.customer)==null?void 0:Jn.cccdFrontUrl)||((Te=$.user)==null?void 0:Te.cccdFrontUrl),cccdBackUrl:$.cccdBackUrl||$.identityBackUrl||$.idBackUrl||$.backImageUrl||$.backIdUrl||$.cccdBackImageUrl||((Je=$.customer)==null?void 0:Je.cccdBackUrl)||((Ge=$.user)==null?void 0:Ge.cccdBackUrl),gplxFrontUrl:$.gplxFrontUrl||$.driverLicenseFrontUrl||$.gplxImageUrl_Front||((Nn=$.customer)==null?void 0:Nn.gplxImageUrl_Front)||((Mt=$.user)==null?void 0:Mt.gplxImageUrl_Front),gplxBackUrl:$.gplxBackUrl||$.driverLicenseBackUrl||$.gplxImageUrl_Back||((ba=$.customer)==null?void 0:ba.gplxImageUrl_Back)||((oi=$.user)==null?void 0:oi.gplxImageUrl_Back),idString:$.customerIdNumber||((Mn=$.user)==null?void 0:Mn.identityNumber)||"",phone:$.customerPhone||((at=$.user)==null?void 0:at.phoneNumber)||""}});s(M);const J=M.filter($=>$.userId&&!($.firstName&&$.lastName));if(J.length>0)try{const $=Array.from(new Set(J.map(me=>me.userId))),Le=await Promise.all($.map(async me=>{try{const V=await Re.getUserById(me),$e=(V==null?void 0:V.firstName)||(V==null?void 0:V.FirstName)||(V==null?void 0:V.givenName)||(V==null?void 0:V.GivenName)||null,Ye=(V==null?void 0:V.lastName)||(V==null?void 0:V.LastName)||(V==null?void 0:V.surname)||(V==null?void 0:V.Surname)||null,be=(V==null?void 0:V.fullName)||(V==null?void 0:V.FullName)||[$e,Ye].filter(Boolean).join(" ")||null,tt=(V==null?void 0:V.userName)||(V==null?void 0:V.UserName)||(V==null?void 0:V.username)||(V==null?void 0:V.user_name)||null,Zt=(V==null?void 0:V.address)||(V==null?void 0:V.Address)||"";return{uid:me,firstName:$e,lastName:Ye,fullName:be,userName:tt,address:Zt}}catch{return{uid:me,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!X)return;const Be=new Map(Le.map(me=>[me.uid,me]));s(me=>me.map(V=>{if(V.userId&&Be.has(V.userId)){const $e=Be.get(V.userId),Ye=V.fullName||$e.fullName||[$e.firstName,$e.lastName].filter(Boolean).join(" ");return{...V,firstName:V.firstName??$e.firstName??null,lastName:V.lastName??$e.lastName??null,fullName:Ye||V.customer||V.userName||null,userName:V.userName??$e.userName,address:V.address||$e.address}}return V}))}catch{}const Me=$=>{var Le,Be,me,V;return $.carId||$.CarId||$.vehicleId||$.VehicleId||((Le=$.car)==null?void 0:Le.id)||((Be=$.car)==null?void 0:Be.Id)||((me=$.vehicle)==null?void 0:me.id)||((V=$.vehicle)==null?void 0:V.Id)},ve=M.filter($=>(!$.title||$.title==="Booking")&&Me($));if(ve.length>0)try{const $=Array.from(new Set(ve.map(Me).filter(Boolean))),Le=await Promise.all($.map(async me=>{try{let V=await Re.getCarById(me);if(!V||!V.id&&!V.Id)try{V=await Re.getCarByIdRest(me)}catch{}const $e=(V==null?void 0:V.name)||(V==null?void 0:V.Name)||[V==null?void 0:V.brand,V==null?void 0:V.model].filter(Boolean).join(" ")||null,Ye=(V==null?void 0:V.imageUrl)||(V==null?void 0:V.thumbnailUrl)||null;return{cid:me,name:$e,img:Ye}}catch{return{cid:me,name:null,img:null}}})),Be=new Map(Le.map(me=>[String(me.cid),me]));s(me=>me.map(V=>{const $e=Me(V),Ye=$e!=null?String($e):null;if(Ye&&Be.has(Ye)){const be=Be.get(Ye);return{...V,title:V.title&&V.title!=="Booking"?V.title:be.name||V.title,img:V.img||be.img||V.img}}return V}))}catch{}const je=($=>$.filter(Le=>!Le.title||Le.title==="Booking"))(M);if(je.length>0)try{const $=await Promise.all(je.map(async Be=>{try{const me=await Re.getVehicleModelFromBooking(Be.id),V=(me==null?void 0:me.name)||[me==null?void 0:me.brand,me==null?void 0:me.model].filter(Boolean).join(" ")||null;return{id:Be.id,title:V}}catch{return{id:Be.id,title:null}}})),Le=new Map($.map(Be=>[Be.id,Be.title]));s(Be=>Be.map(me=>Le.has(me.id)&&Le.get(me.id)?{...me,title:Le.get(me.id)}:me))}catch{}}catch(Q){if(!X)return;fe((Q==null?void 0:Q.message)||"Failed to load bookings")}finally{X&&D(!1)}}return ee(),()=>{X=!1}},[b]),y.useEffect(()=>{e==="staff"&&b&&ge(b)},[e,b]),i.jsxs("div",{className:"app-layout",children:[i.jsx(o1,{}),i.jsx("div",{className:"sidebar-hover-zone",onMouseEnter:()=>k(!0)}),i.jsx("div",{className:`sidebar-wrapper ${j?"visible":""}`,onMouseLeave:()=>k(!1),children:i.jsx(l1,{onSelect:t,isOpen:!0})}),i.jsxs("main",{className:`main-content ${j?"shifted":""}`,children:[re&&i.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:re}),W&&i.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:W}),e==="booking"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsxs("select",{value:b,onChange:X=>B(X.target.value),disabled:R,children:[i.jsx("option",{value:"",children:"All stations"}),x.map(X=>{const ee=X.id||X.Id,Q=X.name||X.Name||X.stationName||`Station ${ee}`;return i.jsx("option",{value:ee,children:Q},ee)})]}),I&&i.jsx("span",{children:"Loading bookings"})]}),!I&&n.length===0&&i.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),i.jsx(p1,{bookings:n,search:C,setSearch:S,statusFilter:P,setStatusFilter:_,onContinuePayment:ce,onCancelBooking:ke,onStatusUpdated:we})]}),e==="vehicle"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("label",{style:{fontWeight:600},children:"Station:"}),i.jsxs("select",{value:b,onChange:X=>B(X.target.value),disabled:R,children:[i.jsx("option",{value:"",children:"All stations"}),x.map(X=>{const ee=X.id||X.Id,Q=X.name||X.Name||X.stationName||`Station ${ee}`;return i.jsx("option",{value:ee,children:Q},ee)})]}),T&&i.jsx("span",{children:"Loading vehicles"})]}),i.jsx(w1,{vehicles:a,onAdd:he,onRemove:Ve,onUpdate:ft,stationId:b,canDelete:!0,stationSlots:se,onTransferCar:wn,stations:x})]}),e==="user"&&i.jsxs(i.Fragment,{children:[q&&i.jsx("div",{style:{padding:"10px 12px"},children:"Loading users..."}),i.jsx(P1,{users:c,deletedUsers:f,loadingDeleted:G,onAssignStaff:ae,onDeleteUser:Ie,onRestoreUser:Ft,onUserCreated:qe,onLoadDeleted:Nt})]}),e==="staff"&&i.jsxs(i.Fragment,{children:[(q||oe)&&i.jsx("div",{style:{padding:"10px 12px"},children:"Loading staff..."}),i.jsx(E1,{users:c,staffByStation:g,stations:x,onRemoveStaff:ye,onAssignStation:ue,onUnassignStation:xe,onStaffCreated:qe})]}),e==="incident"&&i.jsx(i.Fragment,{children:i.jsx("div",{style:{padding:"10px 12px",color:"#666"},children:i.jsx("p",{children:"Incident management section. Incidents are managed through booking details."})})}),e==="profile"&&i.jsx(B1,{})]})]})}const sy=y.createContext(null);function bu(){return y.useContext(sy)}function U1({children:e}){const[t,n]=y.useState(()=>{try{return JSON.parse(localStorage.getItem("user"))||null}catch{return null}}),[s,a]=y.useState(()=>localStorage.getItem("token")||null),[l,c]=y.useState(!1),[u,f]=y.useState(!1);y.useEffect(()=>{s?localStorage.setItem("token",s):localStorage.removeItem("token")},[s]),y.useEffect(()=>{t?(localStorage.setItem("user",JSON.stringify(t)),t.email&&localStorage.setItem("userEmail",t.email)):(localStorage.removeItem("user"),localStorage.removeItem("userEmail"))},[t]);async function p(k,C){var x,w,b,B;const S=await Zn.login(k,C),P=S.token||((x=S.payload)==null?void 0:x.token)||((w=S.raw)==null?void 0:w.token);P&&a(P);const _=((b=S.payload)==null?void 0:b.user)||((B=S.raw)==null?void 0:B.user)||S.payload&&S.payload.user||JSON.parse(localStorage.getItem("user"));return _&&n(_),c(!1),S}async function g(k,C,S,P){return await Zn.register({fullName:k,email:C,phoneNumber:S,password:P})}function v(){a(null),n(null),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userEmail"),localStorage.removeItem("stationId"),localStorage.removeItem("userRole")}const j={user:t,token:s,login:p,logout:v,register:g,showLogin:l,setShowLogin:c,showRegister:u,setShowRegister:f};return i.jsx(sy.Provider,{value:j,children:e})}function M1(){const{user:e,logout:t,setShowLogin:n,setShowRegister:s}=bu(),a=hr(),[l,c]=y.useState(!1);function u(){c(p=>!p)}y.useEffect(()=>{const p=()=>{console.log(" Navigating to update profile page"),a("/update-profile"),c(!1)};return window.addEventListener("openUpdateProfile",p),()=>window.removeEventListener("openUpdateProfile",p)},[a]),y.useEffect(()=>{function p(g){l&&!g.target.closest(".user-menu")&&c(!1)}return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[l]);const f=e&&e.userRole==="Station Staff";return i.jsx(i.Fragment,{children:i.jsx("header",{className:"header",children:i.jsxs("div",{className:"container header-container",children:[i.jsx("div",{className:"logo",children:i.jsx("a",{href:"/",children:"FEC"})}),i.jsxs("nav",{className:"nav",children:[i.jsx("div",{className:"navbar-left",children:f&&i.jsxs("a",{href:"/staff",className:"staff-portal-btn",children:[i.jsx("i",{className:"fas fa-user-shield"})," Staff Portal"]})}),i.jsxs("div",{className:"navbar-right",children:[!e&&i.jsx("button",{id:"loginBtn",onClick:()=>n(!0),className:"login-nav-btn",children:"Login"}),e&&i.jsxs("div",{className:"user-menu",children:[i.jsxs("button",{className:"user-menu-btn",onClick:u,children:[i.jsx("i",{className:"fas fa-user-circle"}),i.jsx("i",{className:"fas fa-chevron-down"})]}),i.jsxs("div",{className:`user-dropdown ${l?"show":""}`,children:[i.jsxs("div",{className:"dropdown-header",children:[i.jsx("i",{className:"fas fa-user-circle"}),i.jsx("span",{id:"userEmail",children:e.email||"User Account"})]}),i.jsx("hr",{}),i.jsxs("a",{href:"/profile",children:[" ",i.jsx("i",{className:"fas fa-user-cog"})," User Profile"]}),i.jsxs("a",{href:"/update-profile",children:[" ",i.jsx("i",{className:"fas fa-edit"})," Update Profile"]}),i.jsxs("a",{href:"/booking-history",children:[" ",i.jsx("i",{className:"fas fa-history"})," Booking History"]}),i.jsxs("a",{href:"#",onClick:p=>{p.preventDefault(),t(),c(!1)},children:[" ",i.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})]})]})]})]})]})})})}function O1(){return i.jsx("footer",{className:"footer",children:i.jsx("div",{className:"container",children:i.jsx("p",{children:" 2025 FEC. All rights reserved."})})})}function D1(){const e=_a(),t=e.pathname.startsWith("/staff")||e.pathname.startsWith("/admin");return i.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",flex:1},children:[!t&&i.jsx(M1,{}),i.jsx("main",{style:{flex:1},children:i.jsxs(__,{children:[i.jsx(tn,{path:"/",element:i.jsx(bj,{})}),i.jsx(tn,{path:"/cars",element:i.jsx(Ij,{})}),i.jsx(tn,{path:"/cars/:id",element:i.jsx(Lj,{})}),i.jsx(tn,{path:"/payment",element:i.jsx(Ej,{})}),i.jsx(tn,{path:"/payment-success",element:i.jsx(Tj,{})}),i.jsx(tn,{path:"/payment-cancel",element:i.jsx(Bj,{})}),i.jsx(tn,{path:"/transaction",element:i.jsx(Rj,{})}),i.jsx(tn,{path:"/booking-history",element:i.jsx(Aj,{})}),i.jsx(tn,{path:"/profile",element:i.jsx(tj,{})}),i.jsx(tn,{path:"/update-profile",element:i.jsx(rj,{})}),i.jsx(tn,{path:"/staff",element:i.jsx(a1,{})}),i.jsx(tn,{path:"/admin",element:i.jsx(F1,{})})]})}),!t&&i.jsx(O1,{})]})}function z1(){return i.jsx(N_,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:i.jsx(D1,{})})}function $1(){const{showLogin:e,setShowLogin:t,login:n,setShowRegister:s}=bu(),[a,l]=y.useState(""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState({isOpen:!1,type:"info",title:"",message:""}),[j,k]=y.useState(!1),[C,S]=y.useState(!1);if(!e&&!g.isOpen)return null;const P=async w=>{try{console.log(" Checking profile completeness for user:",w);const b=await Zn.getMyProfile();console.log(" Profile data from /Users/Get-My-Profile:",b);const B=[];return(!b.address||b.address.trim()==="")&&B.push("Address"),(!b.dateOfBirth||b.dateOfBirth.trim()==="")&&B.push("Date of Birth"),(!b.driverLicenseNumber||b.driverLicenseNumber.trim()==="")&&B.push("Driver License Number"),(!b.driverLicenseExpiry||b.driverLicenseExpiry.trim()==="")&&B.push("Driver License Expiry"),B.length>0?(console.log(" Incomplete profile fields:",B),v({isOpen:!0,type:"warning",title:"Complete Your Profile ",message:`Your profile is incomplete. Please update: ${B.join(", ")}`}),S(!0),!0):(console.log(" Profile is complete"),!1)}catch(b){return console.error(" Error checking profile:",b),!1}};async function _(w){var b,B;w.preventDefault(),p(""),k(!0);try{console.log(" Logging in user:",a);const T=await n(a,c),F=localStorage.getItem("userRole")||(T==null?void 0:T.role);if(console.log(" User role:",F),(F==="Renter"||F==="Customer")&&await P(localStorage.getItem("userId"))){t(!1),k(!1);return}v({isOpen:!0,type:"success",title:"Login Successful! ",message:"Welcome back! You are now logged in."}),l(""),u(""),setTimeout(()=>{t(!1),v({...g,isOpen:!1})},1500)}catch(T){console.error(" Login error:",T);const F=T.message||((B=(b=T.response)==null?void 0:b.data)==null?void 0:B.message)||"Login failed";p(F),v({isOpen:!0,type:"error",title:"Login Failed",message:F})}finally{k(!1)}}function x(){t(!1),s(!0)}return i.jsxs(i.Fragment,{children:[e&&i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),i.jsx("h2",{children:"LOGIN"}),i.jsxs("form",{onSubmit:_,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:a,onChange:w=>l(w.target.value),placeholder:"Enter Email",required:!0,disabled:j}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:c,onChange:w=>u(w.target.value),placeholder:"Enter Password",required:!0,disabled:j}),i.jsx("i",{className:"fas fa-lock"})]}),f&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:f}),i.jsx("button",{type:"submit",disabled:j,children:j?"Logging in...":"Login"}),i.jsxs("p",{className:"modal-footer-text",children:["Don't have an account? ",i.jsx("a",{href:"#",onClick:w=>{w.preventDefault(),x()},children:"Register here"})]})]})]})}),i.jsx(Ca,{isOpen:g.isOpen,type:g.type,title:g.title,message:g.message,onClose:()=>v({...g,isOpen:!1}),actionLabel:C?"Update Profile":void 0,onAction:C?()=>{window.dispatchEvent(new CustomEvent("openUpdateProfile")),S(!1)}:void 0})]})}function W1(){const{showRegister:e,setShowRegister:t,register:n}=bu(),[s,a]=y.useState(""),[l,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[v,j]=y.useState(""),[k,C]=y.useState({isOpen:!1,type:"info",title:"",message:""}),[S,P]=y.useState(!1);if(!e&&!k.isOpen)return null;async function _(x){var w,b;x.preventDefault(),j(""),P(!0);try{console.log(" Registering user:",l),await n(s,l,u,p),C({isOpen:!0,type:"success",title:"Account Created! ",message:"Your account has been created successfully. You can now login and complete your profile."}),a(""),c(""),f(""),g(""),setTimeout(()=>{console.log(" Registration complete - closing register modal"),t(!1),C({...k,isOpen:!1})},2e3)}catch(B){console.error(" Registration error:",B);const T=B.message||((b=(w=B.response)==null?void 0:w.data)==null?void 0:b.message)||"Registration failed";j(T),C({isOpen:!0,type:"error",title:"Registration Failed",message:T})}finally{P(!1)}}return i.jsxs(i.Fragment,{children:[e&&i.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),i.jsx("h2",{children:"Register"}),i.jsxs("form",{onSubmit:_,children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:s,onChange:x=>a(x.target.value),placeholder:"Full Name",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-user"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"email",value:l,onChange:x=>c(x.target.value),placeholder:"Email",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-envelope"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{value:u,onChange:x=>f(x.target.value),placeholder:"Phone",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-phone"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",value:p,onChange:x=>g(x.target.value),placeholder:"Password",required:!0,disabled:S}),i.jsx("i",{className:"fas fa-lock"})]}),v&&i.jsx("div",{style:{color:"red",marginBottom:"10px"},children:v}),i.jsx("button",{type:"submit",disabled:S,children:S?"Creating Account...":"Create Account"}),i.jsxs("p",{className:"modal-footer-text",children:["Already have an account? ",i.jsx("a",{href:"#",onClick:x=>{x.preventDefault(),t(!1)},children:"Login here"})]})]})]})}),i.jsx(Ca,{isOpen:k.isOpen,type:k.type,title:k.title,message:k.message,onClose:()=>C({...k,isOpen:!1})})]})}const H1=mg(document.getElementById("root"));H1.render(i.jsx(U1,{children:i.jsxs(sj,{children:[i.jsx(z1,{}),i.jsx($1,{}),i.jsx(W1,{})]})}));
