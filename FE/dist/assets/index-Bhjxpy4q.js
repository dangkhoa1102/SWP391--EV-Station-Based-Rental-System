function kx(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(s,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var wp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sp={exports:{}},_l={},Cp={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ha=Symbol.for("react.element"),bx=Symbol.for("react.portal"),Ix=Symbol.for("react.fragment"),Lx=Symbol.for("react.strict_mode"),Px=Symbol.for("react.profiler"),Ex=Symbol.for("react.provider"),Tx=Symbol.for("react.context"),Bx=Symbol.for("react.forward_ref"),Rx=Symbol.for("react.suspense"),Ax=Symbol.for("react.memo"),Mx=Symbol.for("react.lazy"),Bh=Symbol.iterator;function Fx(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var Np={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kp=Object.assign,bp={};function Fs(e,t,n){this.props=e,this.context=t,this.refs=bp,this.updater=n||Np}Fs.prototype.isReactComponent={};Fs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ip(){}Ip.prototype=Fs.prototype;function $d(e,t,n){this.props=e,this.context=t,this.refs=bp,this.updater=n||Np}var Wd=$d.prototype=new Ip;Wd.constructor=$d;kp(Wd,Fs.prototype);Wd.isPureReactComponent=!0;var Rh=Array.isArray,Lp=Object.prototype.hasOwnProperty,Hd={current:null},Pp={key:!0,ref:!0,__self:!0,__source:!0};function Ep(e,t,n){var s,o={},a=null,l=null;if(t!=null)for(s in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(a=""+t.key),t)Lp.call(t,s)&&!Pp.hasOwnProperty(s)&&(o[s]=t[s]);var d=arguments.length-2;if(d===1)o.children=n;else if(1<d){for(var u=Array(d),f=0;f<d;f++)u[f]=arguments[f+2];o.children=u}if(e&&e.defaultProps)for(s in d=e.defaultProps,d)o[s]===void 0&&(o[s]=d[s]);return{$$typeof:Ha,type:e,key:a,ref:l,props:o,_owner:Hd.current}}function Ux(e,t){return{$$typeof:Ha,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Zd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ha}function Ox(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Ah=/\/+/g;function tc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ox(""+e.key):t.toString(36)}function Bo(e,t,n,s,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ha:case bx:l=!0}}if(l)return l=e,o=o(l),e=s===""?"."+tc(l,0):s,Rh(o)?(n="",e!=null&&(n=e.replace(Ah,"$&/")+"/"),Bo(o,t,n,"",function(f){return f})):o!=null&&(Zd(o)&&(o=Ux(o,n+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(Ah,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=s===""?".":s+":",Rh(e))for(var d=0;d<e.length;d++){a=e[d];var u=s+tc(a,d);l+=Bo(a,t,n,u,o)}else if(u=Fx(e),typeof u=="function")for(e=u.call(e),d=0;!(a=e.next()).done;)a=a.value,u=s+tc(a,d++),l+=Bo(a,t,n,u,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function po(e,t,n){if(e==null)return e;var s=[],o=0;return Bo(e,s,"","",function(a){return t.call(n,a,o++)}),s}function Dx(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var tn={current:null},Ro={transition:null},zx={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:Ro,ReactCurrentOwner:Hd};function Tp(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:po,forEach:function(e,t,n){po(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return po(e,function(){t++}),t},toArray:function(e){return po(e,function(t){return t})||[]},only:function(e){if(!Zd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=Fs;Ye.Fragment=Ix;Ye.Profiler=Px;Ye.PureComponent=$d;Ye.StrictMode=Lx;Ye.Suspense=Rx;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zx;Ye.act=Tp;Ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=kp({},e.props),o=e.key,a=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,l=Hd.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var d=e.type.defaultProps;for(u in t)Lp.call(t,u)&&!Pp.hasOwnProperty(u)&&(s[u]=t[u]===void 0&&d!==void 0?d[u]:t[u])}var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){d=Array(u);for(var f=0;f<u;f++)d[f]=arguments[f+2];s.children=d}return{$$typeof:Ha,type:e.type,key:o,ref:a,props:s,_owner:l}};Ye.createContext=function(e){return e={$$typeof:Tx,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ex,_context:e},e.Consumer=e};Ye.createElement=Ep;Ye.createFactory=function(e){var t=Ep.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:Bx,render:e}};Ye.isValidElement=Zd;Ye.lazy=function(e){return{$$typeof:Mx,_payload:{_status:-1,_result:e},_init:Dx}};Ye.memo=function(e,t){return{$$typeof:Ax,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=Ro.transition;Ro.transition={};try{e()}finally{Ro.transition=t}};Ye.unstable_act=Tp;Ye.useCallback=function(e,t){return tn.current.useCallback(e,t)};Ye.useContext=function(e){return tn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return tn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return tn.current.useEffect(e,t)};Ye.useId=function(){return tn.current.useId()};Ye.useImperativeHandle=function(e,t,n){return tn.current.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return tn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return tn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return tn.current.useMemo(e,t)};Ye.useReducer=function(e,t,n){return tn.current.useReducer(e,t,n)};Ye.useRef=function(e){return tn.current.useRef(e)};Ye.useState=function(e){return tn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return tn.current.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return tn.current.useTransition()};Ye.version="18.3.1";Cp.exports=Ye;var _=Cp.exports;const mr=jp(_),$x=kx({__proto__:null,default:mr},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx=_,Hx=Symbol.for("react.element"),Zx=Symbol.for("react.fragment"),Vx=Object.prototype.hasOwnProperty,qx=Wx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gx={key:!0,ref:!0,__self:!0,__source:!0};function Bp(e,t,n){var s,o={},a=null,l=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)Vx.call(t,s)&&!Gx.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:Hx,type:e,key:a,ref:l,props:o,_owner:qx.current}}_l.Fragment=Zx;_l.jsx=Bp;_l.jsxs=Bp;Sp.exports=_l;var r=Sp.exports,Rp={exports:{}},wn={},Ap={exports:{}},Mp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,ge){var re=$.length;$.push(ge);e:for(;0<re;){var fe=re-1>>>1,_e=$[fe];if(0<o(_e,ge))$[fe]=ge,$[re]=_e,re=fe;else break e}}function n($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var ge=$[0],re=$.pop();if(re!==ge){$[0]=re;e:for(var fe=0,_e=$.length,se=_e>>>1;fe<se;){var O=2*(fe+1)-1,ne=$[O],q=O+1,we=$[q];if(0>o(ne,re))q<_e&&0>o(we,ne)?($[fe]=we,$[q]=re,fe=q):($[fe]=ne,$[O]=re,fe=O);else if(q<_e&&0>o(we,re))$[fe]=we,$[q]=re,fe=q;else break e}}return ge}function o($,ge){var re=$.sortIndex-ge.sortIndex;return re!==0?re:$.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var u=[],f=[],m=1,g=null,y=3,k=!1,v=!1,x=!1,C=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N($){for(var ge=n(f);ge!==null;){if(ge.callback===null)s(f);else if(ge.startTime<=$)s(f),ge.sortIndex=ge.expirationTime,t(u,ge);else break;ge=n(f)}}function b($){if(x=!1,N($),!v)if(n(u)!==null)v=!0,K(T);else{var ge=n(f);ge!==null&&F(b,ge.startTime-$)}}function T($,ge){v=!1,x&&(x=!1,j(B),B=-1),k=!0;var re=y;try{for(N(ge),g=n(u);g!==null&&(!(g.expirationTime>ge)||$&&!M());){var fe=g.callback;if(typeof fe=="function"){g.callback=null,y=g.priorityLevel;var _e=fe(g.expirationTime<=ge);ge=e.unstable_now(),typeof _e=="function"?g.callback=_e:g===n(u)&&s(u),N(ge)}else s(u);g=n(u)}if(g!==null)var se=!0;else{var O=n(f);O!==null&&F(b,O.startTime-ge),se=!1}return se}finally{g=null,y=re,k=!1}}var I=!1,R=null,B=-1,A=5,E=-1;function M(){return!(e.unstable_now()-E<A)}function G(){if(R!==null){var $=e.unstable_now();E=$;var ge=!0;try{ge=R(!0,$)}finally{ge?Y():(I=!1,R=null)}}else I=!1}var Y;if(typeof w=="function")Y=function(){w(G)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,X=z.port2;z.port1.onmessage=G,Y=function(){X.postMessage(null)}}else Y=function(){C(G,0)};function K($){R=$,I||(I=!0,Y())}function F($,ge){B=C(function(){$(e.unstable_now())},ge)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){v||k||(v=!0,K(T))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function($){switch(y){case 1:case 2:case 3:var ge=3;break;default:ge=y}var re=y;y=ge;try{return $()}finally{y=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,ge){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var re=y;y=$;try{return ge()}finally{y=re}},e.unstable_scheduleCallback=function($,ge,re){var fe=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?fe+re:fe):re=fe,$){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=re+_e,$={id:m++,callback:ge,priorityLevel:$,startTime:re,expirationTime:_e,sortIndex:-1},re>fe?($.sortIndex=re,t(f,$),n(u)===null&&$===n(f)&&(x?(j(B),B=-1):x=!0,F(b,re-fe))):($.sortIndex=_e,t(u,$),v||k||(v=!0,K(T))),$},e.unstable_shouldYield=M,e.unstable_wrapCallback=function($){var ge=y;return function(){var re=y;y=ge;try{return $.apply(this,arguments)}finally{y=re}}}})(Mp);Ap.exports=Mp;var Yx=Ap.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx=_,_n=Yx;function me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fp=new Set,Na={};function Ui(e,t){Is(e,t),Is(e+"Capture",t)}function Is(e,t){for(Na[e]=t,e=0;e<t.length;e++)Fp.add(t[e])}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mc=Object.prototype.hasOwnProperty,Jx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mh={},Fh={};function Qx(e){return Mc.call(Fh,e)?!0:Mc.call(Mh,e)?!1:Jx.test(e)?Fh[e]=!0:(Mh[e]=!0,!1)}function Xx(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ev(e,t,n,s){if(t===null||typeof t>"u"||Xx(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function nn(e,t,n,s,o,a,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ht[e]=new nn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ht[t]=new nn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ht[e]=new nn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ht[e]=new nn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ht[e]=new nn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ht[e]=new nn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ht[e]=new nn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ht[e]=new nn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ht[e]=new nn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Vd=/[\-:]([a-z])/g;function qd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Vd,qd);Ht[t]=new nn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Vd,qd);Ht[t]=new nn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Vd,qd);Ht[t]=new nn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ht[e]=new nn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ht[e]=new nn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Gd(e,t,n,s){var o=Ht.hasOwnProperty(t)?Ht[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ev(t,n,o,s)&&(n=null),s||o===null?Qx(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,s=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Mr=Kx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mo=Symbol.for("react.element"),ds=Symbol.for("react.portal"),us=Symbol.for("react.fragment"),Yd=Symbol.for("react.strict_mode"),Fc=Symbol.for("react.profiler"),Up=Symbol.for("react.provider"),Op=Symbol.for("react.context"),Kd=Symbol.for("react.forward_ref"),Uc=Symbol.for("react.suspense"),Oc=Symbol.for("react.suspense_list"),Jd=Symbol.for("react.memo"),Kr=Symbol.for("react.lazy"),Dp=Symbol.for("react.offscreen"),Uh=Symbol.iterator;function na(e){return e===null||typeof e!="object"?null:(e=Uh&&e[Uh]||e["@@iterator"],typeof e=="function"?e:null)}var wt=Object.assign,nc;function ha(e){if(nc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);nc=t&&t[1]||""}return`
`+nc+e}var rc=!1;function ic(e,t){if(!e||rc)return"";rc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var s=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){s=f}e.call(t.prototype)}else{try{throw Error()}catch(f){s=f}e()}}catch(f){if(f&&s&&typeof f.stack=="string"){for(var o=f.stack.split(`
`),a=s.stack.split(`
`),l=o.length-1,d=a.length-1;1<=l&&0<=d&&o[l]!==a[d];)d--;for(;1<=l&&0<=d;l--,d--)if(o[l]!==a[d]){if(l!==1||d!==1)do if(l--,d--,0>d||o[l]!==a[d]){var u=`
`+o[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=d);break}}}finally{rc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ha(e):""}function tv(e){switch(e.tag){case 5:return ha(e.type);case 16:return ha("Lazy");case 13:return ha("Suspense");case 19:return ha("SuspenseList");case 0:case 2:case 15:return e=ic(e.type,!1),e;case 11:return e=ic(e.type.render,!1),e;case 1:return e=ic(e.type,!0),e;default:return""}}function Dc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case us:return"Fragment";case ds:return"Portal";case Fc:return"Profiler";case Yd:return"StrictMode";case Uc:return"Suspense";case Oc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Op:return(e.displayName||"Context")+".Consumer";case Up:return(e._context.displayName||"Context")+".Provider";case Kd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Jd:return t=e.displayName||null,t!==null?t:Dc(e.type)||"Memo";case Kr:t=e._payload,e=e._init;try{return Dc(e(t))}catch{}}return null}function nv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dc(t);case 8:return t===Yd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function rv(e){var t=zp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(l){s=""+l,a.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function go(e){e._valueTracker||(e._valueTracker=rv(e))}function $p(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=zp(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Go(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zc(e,t){var n=t.checked;return wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Oh(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=hi(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Wp(e,t){t=t.checked,t!=null&&Gd(e,"checked",t,!1)}function $c(e,t){Wp(e,t);var n=hi(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Wc(e,t.type,hi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Dh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Wc(e,t,n){(t!=="number"||Go(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var fa=Array.isArray;function js(e,t,n,s){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&s&&(e[n].defaultSelected=!0)}else{for(n=""+hi(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Hc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(me(91));return wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function zh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(me(92));if(fa(n)){if(1<n.length)throw Error(me(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:hi(n)}}function Hp(e,t){var n=hi(t.value),s=hi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function $h(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Zp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Zp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var yo,Vp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(yo=yo||document.createElement("div"),yo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=yo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ka(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ga={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iv=["Webkit","ms","Moz","O"];Object.keys(ga).forEach(function(e){iv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ga[t]=ga[e]})});function qp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ga.hasOwnProperty(e)&&ga[e]?(""+t).trim():t+"px"}function Gp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,o=qp(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,o):e[n]=o}}var sv=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vc(e,t){if(t){if(sv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(me(62))}}function qc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gc=null;function Qd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Yc=null,Ss=null,Cs=null;function Wh(e){if(e=qa(e)){if(typeof Yc!="function")throw Error(me(280));var t=e.stateNode;t&&(t=Nl(t),Yc(e.stateNode,e.type,t))}}function Yp(e){Ss?Cs?Cs.push(e):Cs=[e]:Ss=e}function Kp(){if(Ss){var e=Ss,t=Cs;if(Cs=Ss=null,Wh(e),t)for(e=0;e<t.length;e++)Wh(t[e])}}function Jp(e,t){return e(t)}function Qp(){}var sc=!1;function Xp(e,t,n){if(sc)return e(t,n);sc=!0;try{return Jp(e,t,n)}finally{sc=!1,(Ss!==null||Cs!==null)&&(Qp(),Kp())}}function ba(e,t){var n=e.stateNode;if(n===null)return null;var s=Nl(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(me(231,t,typeof n));return n}var Kc=!1;if(Tr)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){Kc=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{Kc=!1}function av(e,t,n,s,o,a,l,d,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(m){this.onError(m)}}var ya=!1,Yo=null,Ko=!1,Jc=null,ov={onError:function(e){ya=!0,Yo=e}};function lv(e,t,n,s,o,a,l,d,u){ya=!1,Yo=null,av.apply(ov,arguments)}function cv(e,t,n,s,o,a,l,d,u){if(lv.apply(this,arguments),ya){if(ya){var f=Yo;ya=!1,Yo=null}else throw Error(me(198));Ko||(Ko=!0,Jc=f)}}function Oi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function em(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Hh(e){if(Oi(e)!==e)throw Error(me(188))}function dv(e){var t=e.alternate;if(!t){if(t=Oi(e),t===null)throw Error(me(188));return t!==e?null:e}for(var n=e,s=t;;){var o=n.return;if(o===null)break;var a=o.alternate;if(a===null){if(s=o.return,s!==null){n=s;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return Hh(o),e;if(a===s)return Hh(o),t;a=a.sibling}throw Error(me(188))}if(n.return!==s.return)n=o,s=a;else{for(var l=!1,d=o.child;d;){if(d===n){l=!0,n=o,s=a;break}if(d===s){l=!0,s=o,n=a;break}d=d.sibling}if(!l){for(d=a.child;d;){if(d===n){l=!0,n=a,s=o;break}if(d===s){l=!0,s=a,n=o;break}d=d.sibling}if(!l)throw Error(me(189))}}if(n.alternate!==s)throw Error(me(190))}if(n.tag!==3)throw Error(me(188));return n.stateNode.current===n?e:t}function tm(e){return e=dv(e),e!==null?nm(e):null}function nm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=nm(e);if(t!==null)return t;e=e.sibling}return null}var rm=_n.unstable_scheduleCallback,Zh=_n.unstable_cancelCallback,uv=_n.unstable_shouldYield,hv=_n.unstable_requestPaint,Ct=_n.unstable_now,fv=_n.unstable_getCurrentPriorityLevel,Xd=_n.unstable_ImmediatePriority,im=_n.unstable_UserBlockingPriority,Jo=_n.unstable_NormalPriority,pv=_n.unstable_LowPriority,sm=_n.unstable_IdlePriority,wl=null,fr=null;function mv(e){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(wl,e,void 0,(e.current.flags&128)===128)}catch{}}var Gn=Math.clz32?Math.clz32:xv,gv=Math.log,yv=Math.LN2;function xv(e){return e>>>=0,e===0?32:31-(gv(e)/yv|0)|0}var xo=64,vo=4194304;function pa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Qo(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,o=e.suspendedLanes,a=e.pingedLanes,l=n&268435455;if(l!==0){var d=l&~o;d!==0?s=pa(d):(a&=l,a!==0&&(s=pa(a)))}else l=n&~o,l!==0?s=pa(l):a!==0&&(s=pa(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-Gn(t),o=1<<n,s|=e[n],t&=~o;return s}function vv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _v(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-Gn(a),d=1<<l,u=o[l];u===-1?(!(d&n)||d&s)&&(o[l]=vv(d,t)):u<=t&&(e.expiredLanes|=d),a&=~d}}function Qc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function am(){var e=xo;return xo<<=1,!(xo&4194240)&&(xo=64),e}function ac(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Za(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gn(t),e[t]=n}function wv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Gn(n),a=1<<o;t[o]=0,s[o]=-1,e[o]=-1,n&=~a}}function eu(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Gn(n),o=1<<s;o&t|e[s]&t&&(e[s]|=t),n&=~o}}var at=0;function om(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var lm,tu,cm,dm,um,Xc=!1,_o=[],ri=null,ii=null,si=null,Ia=new Map,La=new Map,Qr=[],jv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vh(e,t){switch(e){case"focusin":case"focusout":ri=null;break;case"dragenter":case"dragleave":ii=null;break;case"mouseover":case"mouseout":si=null;break;case"pointerover":case"pointerout":Ia.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":La.delete(t.pointerId)}}function ia(e,t,n,s,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[o]},t!==null&&(t=qa(t),t!==null&&tu(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Sv(e,t,n,s,o){switch(t){case"focusin":return ri=ia(ri,e,t,n,s,o),!0;case"dragenter":return ii=ia(ii,e,t,n,s,o),!0;case"mouseover":return si=ia(si,e,t,n,s,o),!0;case"pointerover":var a=o.pointerId;return Ia.set(a,ia(Ia.get(a)||null,e,t,n,s,o)),!0;case"gotpointercapture":return a=o.pointerId,La.set(a,ia(La.get(a)||null,e,t,n,s,o)),!0}return!1}function hm(e){var t=Ni(e.target);if(t!==null){var n=Oi(t);if(n!==null){if(t=n.tag,t===13){if(t=em(n),t!==null){e.blockedOn=t,um(e.priority,function(){cm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ao(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ed(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Gc=s,n.target.dispatchEvent(s),Gc=null}else return t=qa(n),t!==null&&tu(t),e.blockedOn=n,!1;t.shift()}return!0}function qh(e,t,n){Ao(e)&&n.delete(t)}function Cv(){Xc=!1,ri!==null&&Ao(ri)&&(ri=null),ii!==null&&Ao(ii)&&(ii=null),si!==null&&Ao(si)&&(si=null),Ia.forEach(qh),La.forEach(qh)}function sa(e,t){e.blockedOn===t&&(e.blockedOn=null,Xc||(Xc=!0,_n.unstable_scheduleCallback(_n.unstable_NormalPriority,Cv)))}function Pa(e){function t(o){return sa(o,e)}if(0<_o.length){sa(_o[0],e);for(var n=1;n<_o.length;n++){var s=_o[n];s.blockedOn===e&&(s.blockedOn=null)}}for(ri!==null&&sa(ri,e),ii!==null&&sa(ii,e),si!==null&&sa(si,e),Ia.forEach(t),La.forEach(t),n=0;n<Qr.length;n++)s=Qr[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Qr.length&&(n=Qr[0],n.blockedOn===null);)hm(n),n.blockedOn===null&&Qr.shift()}var Ns=Mr.ReactCurrentBatchConfig,Xo=!0;function Nv(e,t,n,s){var o=at,a=Ns.transition;Ns.transition=null;try{at=1,nu(e,t,n,s)}finally{at=o,Ns.transition=a}}function kv(e,t,n,s){var o=at,a=Ns.transition;Ns.transition=null;try{at=4,nu(e,t,n,s)}finally{at=o,Ns.transition=a}}function nu(e,t,n,s){if(Xo){var o=ed(e,t,n,s);if(o===null)gc(e,t,s,el,n),Vh(e,s);else if(Sv(o,e,t,n,s))s.stopPropagation();else if(Vh(e,s),t&4&&-1<jv.indexOf(e)){for(;o!==null;){var a=qa(o);if(a!==null&&lm(a),a=ed(e,t,n,s),a===null&&gc(e,t,s,el,n),a===o)break;o=a}o!==null&&s.stopPropagation()}else gc(e,t,s,null,n)}}var el=null;function ed(e,t,n,s){if(el=null,e=Qd(s),e=Ni(e),e!==null)if(t=Oi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=em(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return el=e,null}function fm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fv()){case Xd:return 1;case im:return 4;case Jo:case pv:return 16;case sm:return 536870912;default:return 16}default:return 16}}var ei=null,ru=null,Mo=null;function pm(){if(Mo)return Mo;var e,t=ru,n=t.length,s,o="value"in ei?ei.value:ei.textContent,a=o.length;for(e=0;e<n&&t[e]===o[e];e++);var l=n-e;for(s=1;s<=l&&t[n-s]===o[a-s];s++);return Mo=o.slice(e,1<s?1-s:void 0)}function Fo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wo(){return!0}function Gh(){return!1}function jn(e){function t(n,s,o,a,l){this._reactName=n,this._targetInst=o,this.type=s,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var d in e)e.hasOwnProperty(d)&&(n=e[d],this[d]=n?n(a):a[d]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?wo:Gh,this.isPropagationStopped=Gh,this}return wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wo)},persist:function(){},isPersistent:wo}),t}var Us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iu=jn(Us),Va=wt({},Us,{view:0,detail:0}),bv=jn(Va),oc,lc,aa,jl=wt({},Va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:su,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==aa&&(aa&&e.type==="mousemove"?(oc=e.screenX-aa.screenX,lc=e.screenY-aa.screenY):lc=oc=0,aa=e),oc)},movementY:function(e){return"movementY"in e?e.movementY:lc}}),Yh=jn(jl),Iv=wt({},jl,{dataTransfer:0}),Lv=jn(Iv),Pv=wt({},Va,{relatedTarget:0}),cc=jn(Pv),Ev=wt({},Us,{animationName:0,elapsedTime:0,pseudoElement:0}),Tv=jn(Ev),Bv=wt({},Us,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rv=jn(Bv),Av=wt({},Us,{data:0}),Kh=jn(Av),Mv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ov(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Uv[e])?!!t[e]:!1}function su(){return Ov}var Dv=wt({},Va,{key:function(e){if(e.key){var t=Mv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Fo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:su,charCode:function(e){return e.type==="keypress"?Fo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Fo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zv=jn(Dv),$v=wt({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jh=jn($v),Wv=wt({},Va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:su}),Hv=jn(Wv),Zv=wt({},Us,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vv=jn(Zv),qv=wt({},jl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Gv=jn(qv),Yv=[9,13,27,32],au=Tr&&"CompositionEvent"in window,xa=null;Tr&&"documentMode"in document&&(xa=document.documentMode);var Kv=Tr&&"TextEvent"in window&&!xa,mm=Tr&&(!au||xa&&8<xa&&11>=xa),Qh=" ",Xh=!1;function gm(e,t){switch(e){case"keyup":return Yv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ym(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hs=!1;function Jv(e,t){switch(e){case"compositionend":return ym(t);case"keypress":return t.which!==32?null:(Xh=!0,Qh);case"textInput":return e=t.data,e===Qh&&Xh?null:e;default:return null}}function Qv(e,t){if(hs)return e==="compositionend"||!au&&gm(e,t)?(e=pm(),Mo=ru=ei=null,hs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mm&&t.locale!=="ko"?null:t.data;default:return null}}var Xv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ef(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xv[e.type]:t==="textarea"}function xm(e,t,n,s){Yp(s),t=tl(t,"onChange"),0<t.length&&(n=new iu("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var va=null,Ea=null;function e_(e){Lm(e,0)}function Sl(e){var t=ms(e);if($p(t))return e}function t_(e,t){if(e==="change")return t}var vm=!1;if(Tr){var dc;if(Tr){var uc="oninput"in document;if(!uc){var tf=document.createElement("div");tf.setAttribute("oninput","return;"),uc=typeof tf.oninput=="function"}dc=uc}else dc=!1;vm=dc&&(!document.documentMode||9<document.documentMode)}function nf(){va&&(va.detachEvent("onpropertychange",_m),Ea=va=null)}function _m(e){if(e.propertyName==="value"&&Sl(Ea)){var t=[];xm(t,Ea,e,Qd(e)),Xp(e_,t)}}function n_(e,t,n){e==="focusin"?(nf(),va=t,Ea=n,va.attachEvent("onpropertychange",_m)):e==="focusout"&&nf()}function r_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Sl(Ea)}function i_(e,t){if(e==="click")return Sl(t)}function s_(e,t){if(e==="input"||e==="change")return Sl(t)}function a_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kn=typeof Object.is=="function"?Object.is:a_;function Ta(e,t){if(Kn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var o=n[s];if(!Mc.call(t,o)||!Kn(e[o],t[o]))return!1}return!0}function rf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sf(e,t){var n=rf(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rf(n)}}function wm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?wm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jm(){for(var e=window,t=Go();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Go(e.document)}return t}function ou(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function o_(e){var t=jm(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&wm(n.ownerDocument.documentElement,n)){if(s!==null&&ou(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(s.start,o);s=s.end===void 0?a:Math.min(s.end,o),!e.extend&&a>s&&(o=s,s=a,a=o),o=sf(n,a);var l=sf(n,s);o&&l&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var l_=Tr&&"documentMode"in document&&11>=document.documentMode,fs=null,td=null,_a=null,nd=!1;function af(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nd||fs==null||fs!==Go(s)||(s=fs,"selectionStart"in s&&ou(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),_a&&Ta(_a,s)||(_a=s,s=tl(td,"onSelect"),0<s.length&&(t=new iu("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=fs)))}function jo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ps={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionend:jo("Transition","TransitionEnd")},hc={},Sm={};Tr&&(Sm=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function Cl(e){if(hc[e])return hc[e];if(!ps[e])return e;var t=ps[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Sm)return hc[e]=t[n];return e}var Cm=Cl("animationend"),Nm=Cl("animationiteration"),km=Cl("animationstart"),bm=Cl("transitionend"),Im=new Map,of="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pi(e,t){Im.set(e,t),Ui(t,[e])}for(var fc=0;fc<of.length;fc++){var pc=of[fc],c_=pc.toLowerCase(),d_=pc[0].toUpperCase()+pc.slice(1);pi(c_,"on"+d_)}pi(Cm,"onAnimationEnd");pi(Nm,"onAnimationIteration");pi(km,"onAnimationStart");pi("dblclick","onDoubleClick");pi("focusin","onFocus");pi("focusout","onBlur");pi(bm,"onTransitionEnd");Is("onMouseEnter",["mouseout","mouseover"]);Is("onMouseLeave",["mouseout","mouseover"]);Is("onPointerEnter",["pointerout","pointerover"]);Is("onPointerLeave",["pointerout","pointerover"]);Ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ui("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u_=new Set("cancel close invalid load scroll toggle".split(" ").concat(ma));function lf(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,cv(s,t,void 0,e),e.currentTarget=null}function Lm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],o=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var l=s.length-1;0<=l;l--){var d=s[l],u=d.instance,f=d.currentTarget;if(d=d.listener,u!==a&&o.isPropagationStopped())break e;lf(o,d,f),a=u}else for(l=0;l<s.length;l++){if(d=s[l],u=d.instance,f=d.currentTarget,d=d.listener,u!==a&&o.isPropagationStopped())break e;lf(o,d,f),a=u}}}if(Ko)throw e=Jc,Ko=!1,Jc=null,e}function pt(e,t){var n=t[od];n===void 0&&(n=t[od]=new Set);var s=e+"__bubble";n.has(s)||(Pm(t,e,2,!1),n.add(s))}function mc(e,t,n){var s=0;t&&(s|=4),Pm(n,e,s,t)}var So="_reactListening"+Math.random().toString(36).slice(2);function Ba(e){if(!e[So]){e[So]=!0,Fp.forEach(function(n){n!=="selectionchange"&&(u_.has(n)||mc(n,!1,e),mc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[So]||(t[So]=!0,mc("selectionchange",!1,t))}}function Pm(e,t,n,s){switch(fm(t)){case 1:var o=Nv;break;case 4:o=kv;break;default:o=nu}n=o.bind(null,t,n,e),o=void 0,!Kc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function gc(e,t,n,s,o){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var d=s.stateNode.containerInfo;if(d===o||d.nodeType===8&&d.parentNode===o)break;if(l===4)for(l=s.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;l=l.return}for(;d!==null;){if(l=Ni(d),l===null)return;if(u=l.tag,u===5||u===6){s=a=l;continue e}d=d.parentNode}}s=s.return}Xp(function(){var f=a,m=Qd(n),g=[];e:{var y=Im.get(e);if(y!==void 0){var k=iu,v=e;switch(e){case"keypress":if(Fo(n)===0)break e;case"keydown":case"keyup":k=zv;break;case"focusin":v="focus",k=cc;break;case"focusout":v="blur",k=cc;break;case"beforeblur":case"afterblur":k=cc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Yh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=Lv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=Hv;break;case Cm:case Nm:case km:k=Tv;break;case bm:k=Vv;break;case"scroll":k=bv;break;case"wheel":k=Gv;break;case"copy":case"cut":case"paste":k=Rv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Jh}var x=(t&4)!==0,C=!x&&e==="scroll",j=x?y!==null?y+"Capture":null:y;x=[];for(var w=f,N;w!==null;){N=w;var b=N.stateNode;if(N.tag===5&&b!==null&&(N=b,j!==null&&(b=ba(w,j),b!=null&&x.push(Ra(w,b,N)))),C)break;w=w.return}0<x.length&&(y=new k(y,v,null,n,m),g.push({event:y,listeners:x}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",k=e==="mouseout"||e==="pointerout",y&&n!==Gc&&(v=n.relatedTarget||n.fromElement)&&(Ni(v)||v[Br]))break e;if((k||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,k?(v=n.relatedTarget||n.toElement,k=f,v=v?Ni(v):null,v!==null&&(C=Oi(v),v!==C||v.tag!==5&&v.tag!==6)&&(v=null)):(k=null,v=f),k!==v)){if(x=Yh,b="onMouseLeave",j="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(x=Jh,b="onPointerLeave",j="onPointerEnter",w="pointer"),C=k==null?y:ms(k),N=v==null?y:ms(v),y=new x(b,w+"leave",k,n,m),y.target=C,y.relatedTarget=N,b=null,Ni(m)===f&&(x=new x(j,w+"enter",v,n,m),x.target=N,x.relatedTarget=C,b=x),C=b,k&&v)t:{for(x=k,j=v,w=0,N=x;N;N=cs(N))w++;for(N=0,b=j;b;b=cs(b))N++;for(;0<w-N;)x=cs(x),w--;for(;0<N-w;)j=cs(j),N--;for(;w--;){if(x===j||j!==null&&x===j.alternate)break t;x=cs(x),j=cs(j)}x=null}else x=null;k!==null&&cf(g,y,k,x,!1),v!==null&&C!==null&&cf(g,C,v,x,!0)}}e:{if(y=f?ms(f):window,k=y.nodeName&&y.nodeName.toLowerCase(),k==="select"||k==="input"&&y.type==="file")var T=t_;else if(ef(y))if(vm)T=s_;else{T=r_;var I=n_}else(k=y.nodeName)&&k.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(T=i_);if(T&&(T=T(e,f))){xm(g,T,n,m);break e}I&&I(e,y,f),e==="focusout"&&(I=y._wrapperState)&&I.controlled&&y.type==="number"&&Wc(y,"number",y.value)}switch(I=f?ms(f):window,e){case"focusin":(ef(I)||I.contentEditable==="true")&&(fs=I,td=f,_a=null);break;case"focusout":_a=td=fs=null;break;case"mousedown":nd=!0;break;case"contextmenu":case"mouseup":case"dragend":nd=!1,af(g,n,m);break;case"selectionchange":if(l_)break;case"keydown":case"keyup":af(g,n,m)}var R;if(au)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else hs?gm(e,n)&&(B="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(B="onCompositionStart");B&&(mm&&n.locale!=="ko"&&(hs||B!=="onCompositionStart"?B==="onCompositionEnd"&&hs&&(R=pm()):(ei=m,ru="value"in ei?ei.value:ei.textContent,hs=!0)),I=tl(f,B),0<I.length&&(B=new Kh(B,e,null,n,m),g.push({event:B,listeners:I}),R?B.data=R:(R=ym(n),R!==null&&(B.data=R)))),(R=Kv?Jv(e,n):Qv(e,n))&&(f=tl(f,"onBeforeInput"),0<f.length&&(m=new Kh("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:f}),m.data=R))}Lm(g,t)})}function Ra(e,t,n){return{instance:e,listener:t,currentTarget:n}}function tl(e,t){for(var n=t+"Capture",s=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=ba(e,n),a!=null&&s.unshift(Ra(e,a,o)),a=ba(e,t),a!=null&&s.push(Ra(e,a,o))),e=e.return}return s}function cs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function cf(e,t,n,s,o){for(var a=t._reactName,l=[];n!==null&&n!==s;){var d=n,u=d.alternate,f=d.stateNode;if(u!==null&&u===s)break;d.tag===5&&f!==null&&(d=f,o?(u=ba(n,a),u!=null&&l.unshift(Ra(n,u,d))):o||(u=ba(n,a),u!=null&&l.push(Ra(n,u,d)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var h_=/\r\n?/g,f_=/\u0000|\uFFFD/g;function df(e){return(typeof e=="string"?e:""+e).replace(h_,`
`).replace(f_,"")}function Co(e,t,n){if(t=df(t),df(e)!==t&&n)throw Error(me(425))}function nl(){}var rd=null,id=null;function sd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ad=typeof setTimeout=="function"?setTimeout:void 0,p_=typeof clearTimeout=="function"?clearTimeout:void 0,uf=typeof Promise=="function"?Promise:void 0,m_=typeof queueMicrotask=="function"?queueMicrotask:typeof uf<"u"?function(e){return uf.resolve(null).then(e).catch(g_)}:ad;function g_(e){setTimeout(function(){throw e})}function yc(e,t){var n=t,s=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(s===0){e.removeChild(o),Pa(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=o}while(n);Pa(t)}function ai(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Os=Math.random().toString(36).slice(2),hr="__reactFiber$"+Os,Aa="__reactProps$"+Os,Br="__reactContainer$"+Os,od="__reactEvents$"+Os,y_="__reactListeners$"+Os,x_="__reactHandles$"+Os;function Ni(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Br]||n[hr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=hf(e);e!==null;){if(n=e[hr])return n;e=hf(e)}return t}e=n,n=e.parentNode}return null}function qa(e){return e=e[hr]||e[Br],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ms(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(me(33))}function Nl(e){return e[Aa]||null}var ld=[],gs=-1;function mi(e){return{current:e}}function mt(e){0>gs||(e.current=ld[gs],ld[gs]=null,gs--)}function ht(e,t){gs++,ld[gs]=e.current,e.current=t}var fi={},Kt=mi(fi),un=mi(!1),Ti=fi;function Ls(e,t){var n=e.type.contextTypes;if(!n)return fi;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in n)o[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function hn(e){return e=e.childContextTypes,e!=null}function rl(){mt(un),mt(Kt)}function ff(e,t,n){if(Kt.current!==fi)throw Error(me(168));ht(Kt,t),ht(un,n)}function Em(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(me(108,nv(e)||"Unknown",o));return wt({},n,s)}function il(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fi,Ti=Kt.current,ht(Kt,e),ht(un,un.current),!0}function pf(e,t,n){var s=e.stateNode;if(!s)throw Error(me(169));n?(e=Em(e,t,Ti),s.__reactInternalMemoizedMergedChildContext=e,mt(un),mt(Kt),ht(Kt,e)):mt(un),ht(un,n)}var kr=null,kl=!1,xc=!1;function Tm(e){kr===null?kr=[e]:kr.push(e)}function v_(e){kl=!0,Tm(e)}function gi(){if(!xc&&kr!==null){xc=!0;var e=0,t=at;try{var n=kr;for(at=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}kr=null,kl=!1}catch(o){throw kr!==null&&(kr=kr.slice(e+1)),rm(Xd,gi),o}finally{at=t,xc=!1}}return null}var ys=[],xs=0,sl=null,al=0,En=[],Tn=0,Bi=null,br=1,Ir="";function Si(e,t){ys[xs++]=al,ys[xs++]=sl,sl=e,al=t}function Bm(e,t,n){En[Tn++]=br,En[Tn++]=Ir,En[Tn++]=Bi,Bi=e;var s=br;e=Ir;var o=32-Gn(s)-1;s&=~(1<<o),n+=1;var a=32-Gn(t)+o;if(30<a){var l=o-o%5;a=(s&(1<<l)-1).toString(32),s>>=l,o-=l,br=1<<32-Gn(t)+o|n<<o|s,Ir=a+e}else br=1<<a|n<<o|s,Ir=e}function lu(e){e.return!==null&&(Si(e,1),Bm(e,1,0))}function cu(e){for(;e===sl;)sl=ys[--xs],ys[xs]=null,al=ys[--xs],ys[xs]=null;for(;e===Bi;)Bi=En[--Tn],En[Tn]=null,Ir=En[--Tn],En[Tn]=null,br=En[--Tn],En[Tn]=null}var vn=null,xn=null,gt=!1,Vn=null;function Rm(e,t){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function mf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vn=e,xn=ai(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vn=e,xn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Bi!==null?{id:br,overflow:Ir}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,vn=e,xn=null,!0):!1;default:return!1}}function cd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function dd(e){if(gt){var t=xn;if(t){var n=t;if(!mf(e,t)){if(cd(e))throw Error(me(418));t=ai(n.nextSibling);var s=vn;t&&mf(e,t)?Rm(s,n):(e.flags=e.flags&-4097|2,gt=!1,vn=e)}}else{if(cd(e))throw Error(me(418));e.flags=e.flags&-4097|2,gt=!1,vn=e}}}function gf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vn=e}function No(e){if(e!==vn)return!1;if(!gt)return gf(e),gt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!sd(e.type,e.memoizedProps)),t&&(t=xn)){if(cd(e))throw Am(),Error(me(418));for(;t;)Rm(e,t),t=ai(t.nextSibling)}if(gf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){xn=ai(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}xn=null}}else xn=vn?ai(e.stateNode.nextSibling):null;return!0}function Am(){for(var e=xn;e;)e=ai(e.nextSibling)}function Ps(){xn=vn=null,gt=!1}function du(e){Vn===null?Vn=[e]:Vn.push(e)}var __=Mr.ReactCurrentBatchConfig;function oa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(me(309));var s=n.stateNode}if(!s)throw Error(me(147,e));var o=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(l){var d=o.refs;l===null?delete d[a]:d[a]=l},t._stringRef=a,t)}if(typeof e!="string")throw Error(me(284));if(!n._owner)throw Error(me(290,e))}return e}function ko(e,t){throw e=Object.prototype.toString.call(t),Error(me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yf(e){var t=e._init;return t(e._payload)}function Mm(e){function t(j,w){if(e){var N=j.deletions;N===null?(j.deletions=[w],j.flags|=16):N.push(w)}}function n(j,w){if(!e)return null;for(;w!==null;)t(j,w),w=w.sibling;return null}function s(j,w){for(j=new Map;w!==null;)w.key!==null?j.set(w.key,w):j.set(w.index,w),w=w.sibling;return j}function o(j,w){return j=di(j,w),j.index=0,j.sibling=null,j}function a(j,w,N){return j.index=N,e?(N=j.alternate,N!==null?(N=N.index,N<w?(j.flags|=2,w):N):(j.flags|=2,w)):(j.flags|=1048576,w)}function l(j){return e&&j.alternate===null&&(j.flags|=2),j}function d(j,w,N,b){return w===null||w.tag!==6?(w=Nc(N,j.mode,b),w.return=j,w):(w=o(w,N),w.return=j,w)}function u(j,w,N,b){var T=N.type;return T===us?m(j,w,N.props.children,b,N.key):w!==null&&(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Kr&&yf(T)===w.type)?(b=o(w,N.props),b.ref=oa(j,w,N),b.return=j,b):(b=Ho(N.type,N.key,N.props,null,j.mode,b),b.ref=oa(j,w,N),b.return=j,b)}function f(j,w,N,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==N.containerInfo||w.stateNode.implementation!==N.implementation?(w=kc(N,j.mode,b),w.return=j,w):(w=o(w,N.children||[]),w.return=j,w)}function m(j,w,N,b,T){return w===null||w.tag!==7?(w=Pi(N,j.mode,b,T),w.return=j,w):(w=o(w,N),w.return=j,w)}function g(j,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Nc(""+w,j.mode,N),w.return=j,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case mo:return N=Ho(w.type,w.key,w.props,null,j.mode,N),N.ref=oa(j,null,w),N.return=j,N;case ds:return w=kc(w,j.mode,N),w.return=j,w;case Kr:var b=w._init;return g(j,b(w._payload),N)}if(fa(w)||na(w))return w=Pi(w,j.mode,N,null),w.return=j,w;ko(j,w)}return null}function y(j,w,N,b){var T=w!==null?w.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return T!==null?null:d(j,w,""+N,b);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case mo:return N.key===T?u(j,w,N,b):null;case ds:return N.key===T?f(j,w,N,b):null;case Kr:return T=N._init,y(j,w,T(N._payload),b)}if(fa(N)||na(N))return T!==null?null:m(j,w,N,b,null);ko(j,N)}return null}function k(j,w,N,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return j=j.get(N)||null,d(w,j,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case mo:return j=j.get(b.key===null?N:b.key)||null,u(w,j,b,T);case ds:return j=j.get(b.key===null?N:b.key)||null,f(w,j,b,T);case Kr:var I=b._init;return k(j,w,N,I(b._payload),T)}if(fa(b)||na(b))return j=j.get(N)||null,m(w,j,b,T,null);ko(w,b)}return null}function v(j,w,N,b){for(var T=null,I=null,R=w,B=w=0,A=null;R!==null&&B<N.length;B++){R.index>B?(A=R,R=null):A=R.sibling;var E=y(j,R,N[B],b);if(E===null){R===null&&(R=A);break}e&&R&&E.alternate===null&&t(j,R),w=a(E,w,B),I===null?T=E:I.sibling=E,I=E,R=A}if(B===N.length)return n(j,R),gt&&Si(j,B),T;if(R===null){for(;B<N.length;B++)R=g(j,N[B],b),R!==null&&(w=a(R,w,B),I===null?T=R:I.sibling=R,I=R);return gt&&Si(j,B),T}for(R=s(j,R);B<N.length;B++)A=k(R,j,B,N[B],b),A!==null&&(e&&A.alternate!==null&&R.delete(A.key===null?B:A.key),w=a(A,w,B),I===null?T=A:I.sibling=A,I=A);return e&&R.forEach(function(M){return t(j,M)}),gt&&Si(j,B),T}function x(j,w,N,b){var T=na(N);if(typeof T!="function")throw Error(me(150));if(N=T.call(N),N==null)throw Error(me(151));for(var I=T=null,R=w,B=w=0,A=null,E=N.next();R!==null&&!E.done;B++,E=N.next()){R.index>B?(A=R,R=null):A=R.sibling;var M=y(j,R,E.value,b);if(M===null){R===null&&(R=A);break}e&&R&&M.alternate===null&&t(j,R),w=a(M,w,B),I===null?T=M:I.sibling=M,I=M,R=A}if(E.done)return n(j,R),gt&&Si(j,B),T;if(R===null){for(;!E.done;B++,E=N.next())E=g(j,E.value,b),E!==null&&(w=a(E,w,B),I===null?T=E:I.sibling=E,I=E);return gt&&Si(j,B),T}for(R=s(j,R);!E.done;B++,E=N.next())E=k(R,j,B,E.value,b),E!==null&&(e&&E.alternate!==null&&R.delete(E.key===null?B:E.key),w=a(E,w,B),I===null?T=E:I.sibling=E,I=E);return e&&R.forEach(function(G){return t(j,G)}),gt&&Si(j,B),T}function C(j,w,N,b){if(typeof N=="object"&&N!==null&&N.type===us&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case mo:e:{for(var T=N.key,I=w;I!==null;){if(I.key===T){if(T=N.type,T===us){if(I.tag===7){n(j,I.sibling),w=o(I,N.props.children),w.return=j,j=w;break e}}else if(I.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Kr&&yf(T)===I.type){n(j,I.sibling),w=o(I,N.props),w.ref=oa(j,I,N),w.return=j,j=w;break e}n(j,I);break}else t(j,I);I=I.sibling}N.type===us?(w=Pi(N.props.children,j.mode,b,N.key),w.return=j,j=w):(b=Ho(N.type,N.key,N.props,null,j.mode,b),b.ref=oa(j,w,N),b.return=j,j=b)}return l(j);case ds:e:{for(I=N.key;w!==null;){if(w.key===I)if(w.tag===4&&w.stateNode.containerInfo===N.containerInfo&&w.stateNode.implementation===N.implementation){n(j,w.sibling),w=o(w,N.children||[]),w.return=j,j=w;break e}else{n(j,w);break}else t(j,w);w=w.sibling}w=kc(N,j.mode,b),w.return=j,j=w}return l(j);case Kr:return I=N._init,C(j,w,I(N._payload),b)}if(fa(N))return v(j,w,N,b);if(na(N))return x(j,w,N,b);ko(j,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,w!==null&&w.tag===6?(n(j,w.sibling),w=o(w,N),w.return=j,j=w):(n(j,w),w=Nc(N,j.mode,b),w.return=j,j=w),l(j)):n(j,w)}return C}var Es=Mm(!0),Fm=Mm(!1),ol=mi(null),ll=null,vs=null,uu=null;function hu(){uu=vs=ll=null}function fu(e){var t=ol.current;mt(ol),e._currentValue=t}function ud(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function ks(e,t){ll=e,uu=vs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(dn=!0),e.firstContext=null)}function An(e){var t=e._currentValue;if(uu!==e)if(e={context:e,memoizedValue:t,next:null},vs===null){if(ll===null)throw Error(me(308));vs=e,ll.dependencies={lanes:0,firstContext:e}}else vs=vs.next=e;return t}var ki=null;function pu(e){ki===null?ki=[e]:ki.push(e)}function Um(e,t,n,s){var o=t.interleaved;return o===null?(n.next=n,pu(t)):(n.next=o.next,o.next=n),t.interleaved=n,Rr(e,s)}function Rr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Jr=!1;function mu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Om(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function oi(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,et&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,Rr(e,n)}return o=s.interleaved,o===null?(t.next=t,pu(s)):(t.next=o.next,o.next=t),s.interleaved=t,Rr(e,n)}function Uo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,eu(e,n)}}function xf(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var o=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?o=a=l:a=a.next=l,n=n.next}while(n!==null);a===null?o=a=t:a=a.next=t}else o=a=t;n={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function cl(e,t,n,s){var o=e.updateQueue;Jr=!1;var a=o.firstBaseUpdate,l=o.lastBaseUpdate,d=o.shared.pending;if(d!==null){o.shared.pending=null;var u=d,f=u.next;u.next=null,l===null?a=f:l.next=f,l=u;var m=e.alternate;m!==null&&(m=m.updateQueue,d=m.lastBaseUpdate,d!==l&&(d===null?m.firstBaseUpdate=f:d.next=f,m.lastBaseUpdate=u))}if(a!==null){var g=o.baseState;l=0,m=f=u=null,d=a;do{var y=d.lane,k=d.eventTime;if((s&y)===y){m!==null&&(m=m.next={eventTime:k,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var v=e,x=d;switch(y=t,k=n,x.tag){case 1:if(v=x.payload,typeof v=="function"){g=v.call(k,g,y);break e}g=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,y=typeof v=="function"?v.call(k,g,y):v,y==null)break e;g=wt({},g,y);break e;case 2:Jr=!0}}d.callback!==null&&d.lane!==0&&(e.flags|=64,y=o.effects,y===null?o.effects=[d]:y.push(d))}else k={eventTime:k,lane:y,tag:d.tag,payload:d.payload,callback:d.callback,next:null},m===null?(f=m=k,u=g):m=m.next=k,l|=y;if(d=d.next,d===null){if(d=o.shared.pending,d===null)break;y=d,d=y.next,y.next=null,o.lastBaseUpdate=y,o.shared.pending=null}}while(!0);if(m===null&&(u=g),o.baseState=u,o.firstBaseUpdate=f,o.lastBaseUpdate=m,t=o.shared.interleaved,t!==null){o=t;do l|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Ai|=l,e.lanes=l,e.memoizedState=g}}function vf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=n,typeof o!="function")throw Error(me(191,o));o.call(s)}}}var Ga={},pr=mi(Ga),Ma=mi(Ga),Fa=mi(Ga);function bi(e){if(e===Ga)throw Error(me(174));return e}function gu(e,t){switch(ht(Fa,t),ht(Ma,e),ht(pr,Ga),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zc(t,e)}mt(pr),ht(pr,t)}function Ts(){mt(pr),mt(Ma),mt(Fa)}function Dm(e){bi(Fa.current);var t=bi(pr.current),n=Zc(t,e.type);t!==n&&(ht(Ma,e),ht(pr,n))}function yu(e){Ma.current===e&&(mt(pr),mt(Ma))}var vt=mi(0);function dl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vc=[];function xu(){for(var e=0;e<vc.length;e++)vc[e]._workInProgressVersionPrimary=null;vc.length=0}var Oo=Mr.ReactCurrentDispatcher,_c=Mr.ReactCurrentBatchConfig,Ri=0,_t=null,Bt=null,Dt=null,ul=!1,wa=!1,Ua=0,w_=0;function Zt(){throw Error(me(321))}function vu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kn(e[n],t[n]))return!1;return!0}function _u(e,t,n,s,o,a){if(Ri=a,_t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Oo.current=e===null||e.memoizedState===null?N_:k_,e=n(s,o),wa){a=0;do{if(wa=!1,Ua=0,25<=a)throw Error(me(301));a+=1,Dt=Bt=null,t.updateQueue=null,Oo.current=b_,e=n(s,o)}while(wa)}if(Oo.current=hl,t=Bt!==null&&Bt.next!==null,Ri=0,Dt=Bt=_t=null,ul=!1,t)throw Error(me(300));return e}function wu(){var e=Ua!==0;return Ua=0,e}function ur(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?_t.memoizedState=Dt=e:Dt=Dt.next=e,Dt}function Mn(){if(Bt===null){var e=_t.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=Dt===null?_t.memoizedState:Dt.next;if(t!==null)Dt=t,Bt=e;else{if(e===null)throw Error(me(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Dt===null?_t.memoizedState=Dt=e:Dt=Dt.next=e}return Dt}function Oa(e,t){return typeof t=="function"?t(e):t}function wc(e){var t=Mn(),n=t.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=e;var s=Bt,o=s.baseQueue,a=n.pending;if(a!==null){if(o!==null){var l=o.next;o.next=a.next,a.next=l}s.baseQueue=o=a,n.pending=null}if(o!==null){a=o.next,s=s.baseState;var d=l=null,u=null,f=a;do{var m=f.lane;if((Ri&m)===m)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),s=f.hasEagerState?f.eagerState:e(s,f.action);else{var g={lane:m,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(d=u=g,l=s):u=u.next=g,_t.lanes|=m,Ai|=m}f=f.next}while(f!==null&&f!==a);u===null?l=s:u.next=d,Kn(s,t.memoizedState)||(dn=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=u,n.lastRenderedState=s}if(e=n.interleaved,e!==null){o=e;do a=o.lane,_t.lanes|=a,Ai|=a,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function jc(e){var t=Mn(),n=t.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=e;var s=n.dispatch,o=n.pending,a=t.memoizedState;if(o!==null){n.pending=null;var l=o=o.next;do a=e(a,l.action),l=l.next;while(l!==o);Kn(a,t.memoizedState)||(dn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,s]}function zm(){}function $m(e,t){var n=_t,s=Mn(),o=t(),a=!Kn(s.memoizedState,o);if(a&&(s.memoizedState=o,dn=!0),s=s.queue,ju(Zm.bind(null,n,s,e),[e]),s.getSnapshot!==t||a||Dt!==null&&Dt.memoizedState.tag&1){if(n.flags|=2048,Da(9,Hm.bind(null,n,s,o,t),void 0,null),zt===null)throw Error(me(349));Ri&30||Wm(n,t,o)}return o}function Wm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Hm(e,t,n,s){t.value=n,t.getSnapshot=s,Vm(t)&&qm(e)}function Zm(e,t,n){return n(function(){Vm(t)&&qm(e)})}function Vm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kn(e,n)}catch{return!0}}function qm(e){var t=Rr(e,1);t!==null&&Yn(t,e,1,-1)}function _f(e){var t=ur();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:e},t.queue=e,e=e.dispatch=C_.bind(null,_t,e),[t.memoizedState,e]}function Da(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Gm(){return Mn().memoizedState}function Do(e,t,n,s){var o=ur();_t.flags|=e,o.memoizedState=Da(1|t,n,void 0,s===void 0?null:s)}function bl(e,t,n,s){var o=Mn();s=s===void 0?null:s;var a=void 0;if(Bt!==null){var l=Bt.memoizedState;if(a=l.destroy,s!==null&&vu(s,l.deps)){o.memoizedState=Da(t,n,a,s);return}}_t.flags|=e,o.memoizedState=Da(1|t,n,a,s)}function wf(e,t){return Do(8390656,8,e,t)}function ju(e,t){return bl(2048,8,e,t)}function Ym(e,t){return bl(4,2,e,t)}function Km(e,t){return bl(4,4,e,t)}function Jm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Qm(e,t,n){return n=n!=null?n.concat([e]):null,bl(4,4,Jm.bind(null,t,e),n)}function Su(){}function Xm(e,t){var n=Mn();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&vu(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function eg(e,t){var n=Mn();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&vu(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function tg(e,t,n){return Ri&21?(Kn(n,t)||(n=am(),_t.lanes|=n,Ai|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,dn=!0),e.memoizedState=n)}function j_(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var s=_c.transition;_c.transition={};try{e(!1),t()}finally{at=n,_c.transition=s}}function ng(){return Mn().memoizedState}function S_(e,t,n){var s=ci(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},rg(e))ig(t,n);else if(n=Um(e,t,n,s),n!==null){var o=en();Yn(n,e,s,o),sg(n,t,s)}}function C_(e,t,n){var s=ci(e),o={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(rg(e))ig(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var l=t.lastRenderedState,d=a(l,n);if(o.hasEagerState=!0,o.eagerState=d,Kn(d,l)){var u=t.interleaved;u===null?(o.next=o,pu(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Um(e,t,o,s),n!==null&&(o=en(),Yn(n,e,s,o),sg(n,t,s))}}function rg(e){var t=e.alternate;return e===_t||t!==null&&t===_t}function ig(e,t){wa=ul=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sg(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,eu(e,n)}}var hl={readContext:An,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},N_={readContext:An,useCallback:function(e,t){return ur().memoizedState=[e,t===void 0?null:t],e},useContext:An,useEffect:wf,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Do(4194308,4,Jm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){return Do(4,2,e,t)},useMemo:function(e,t){var n=ur();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=ur();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=S_.bind(null,_t,e),[s.memoizedState,e]},useRef:function(e){var t=ur();return e={current:e},t.memoizedState=e},useState:_f,useDebugValue:Su,useDeferredValue:function(e){return ur().memoizedState=e},useTransition:function(){var e=_f(!1),t=e[0];return e=j_.bind(null,e[1]),ur().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=_t,o=ur();if(gt){if(n===void 0)throw Error(me(407));n=n()}else{if(n=t(),zt===null)throw Error(me(349));Ri&30||Wm(s,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,wf(Zm.bind(null,s,a,e),[e]),s.flags|=2048,Da(9,Hm.bind(null,s,a,n,t),void 0,null),n},useId:function(){var e=ur(),t=zt.identifierPrefix;if(gt){var n=Ir,s=br;n=(s&~(1<<32-Gn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ua++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=w_++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},k_={readContext:An,useCallback:Xm,useContext:An,useEffect:ju,useImperativeHandle:Qm,useInsertionEffect:Ym,useLayoutEffect:Km,useMemo:eg,useReducer:wc,useRef:Gm,useState:function(){return wc(Oa)},useDebugValue:Su,useDeferredValue:function(e){var t=Mn();return tg(t,Bt.memoizedState,e)},useTransition:function(){var e=wc(Oa)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:zm,useSyncExternalStore:$m,useId:ng,unstable_isNewReconciler:!1},b_={readContext:An,useCallback:Xm,useContext:An,useEffect:ju,useImperativeHandle:Qm,useInsertionEffect:Ym,useLayoutEffect:Km,useMemo:eg,useReducer:jc,useRef:Gm,useState:function(){return jc(Oa)},useDebugValue:Su,useDeferredValue:function(e){var t=Mn();return Bt===null?t.memoizedState=e:tg(t,Bt.memoizedState,e)},useTransition:function(){var e=jc(Oa)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:zm,useSyncExternalStore:$m,useId:ng,unstable_isNewReconciler:!1};function Hn(e,t){if(e&&e.defaultProps){t=wt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function hd(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:wt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Il={isMounted:function(e){return(e=e._reactInternals)?Oi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=en(),o=ci(e),a=Pr(s,o);a.payload=t,n!=null&&(a.callback=n),t=oi(e,a,o),t!==null&&(Yn(t,e,o,s),Uo(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=en(),o=ci(e),a=Pr(s,o);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=oi(e,a,o),t!==null&&(Yn(t,e,o,s),Uo(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=en(),s=ci(e),o=Pr(n,s);o.tag=2,t!=null&&(o.callback=t),t=oi(e,o,s),t!==null&&(Yn(t,e,s,n),Uo(t,e,s))}};function jf(e,t,n,s,o,a,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,l):t.prototype&&t.prototype.isPureReactComponent?!Ta(n,s)||!Ta(o,a):!0}function ag(e,t,n){var s=!1,o=fi,a=t.contextType;return typeof a=="object"&&a!==null?a=An(a):(o=hn(t)?Ti:Kt.current,s=t.contextTypes,a=(s=s!=null)?Ls(e,o):fi),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Il,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function Sf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Il.enqueueReplaceState(t,t.state,null)}function fd(e,t,n,s){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},mu(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=An(a):(a=hn(t)?Ti:Kt.current,o.context=Ls(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(hd(e,t,a,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Il.enqueueReplaceState(o,o.state,null),cl(e,n,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Bs(e,t){try{var n="",s=t;do n+=tv(s),s=s.return;while(s);var o=n}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function Sc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function pd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var I_=typeof WeakMap=="function"?WeakMap:Map;function og(e,t,n){n=Pr(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){pl||(pl=!0,Cd=s),pd(e,t)},n}function lg(e,t,n){n=Pr(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;n.payload=function(){return s(o)},n.callback=function(){pd(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){pd(e,t),typeof s!="function"&&(li===null?li=new Set([this]):li.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Cf(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new I_;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(n)||(o.add(n),e=$_.bind(null,e,t,n),t.then(e,e))}function Nf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function kf(e,t,n,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Pr(-1,1),t.tag=2,oi(n,t,1))),n.lanes|=1),e)}var L_=Mr.ReactCurrentOwner,dn=!1;function Qt(e,t,n,s){t.child=e===null?Fm(t,null,n,s):Es(t,e.child,n,s)}function bf(e,t,n,s,o){n=n.render;var a=t.ref;return ks(t,o),s=_u(e,t,n,s,a,o),n=wu(),e!==null&&!dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ar(e,t,o)):(gt&&n&&lu(t),t.flags|=1,Qt(e,t,s,o),t.child)}function If(e,t,n,s,o){if(e===null){var a=n.type;return typeof a=="function"&&!Eu(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,cg(e,t,a,s,o)):(e=Ho(n.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var l=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ta,n(l,s)&&e.ref===t.ref)return Ar(e,t,o)}return t.flags|=1,e=di(a,s),e.ref=t.ref,e.return=t,t.child=e}function cg(e,t,n,s,o){if(e!==null){var a=e.memoizedProps;if(Ta(a,s)&&e.ref===t.ref)if(dn=!1,t.pendingProps=s=a,(e.lanes&o)!==0)e.flags&131072&&(dn=!0);else return t.lanes=e.lanes,Ar(e,t,o)}return md(e,t,n,s,o)}function dg(e,t,n){var s=t.pendingProps,o=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(ws,yn),yn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(ws,yn),yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:n,ht(ws,yn),yn|=s}else a!==null?(s=a.baseLanes|n,t.memoizedState=null):s=n,ht(ws,yn),yn|=s;return Qt(e,t,o,n),t.child}function ug(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function md(e,t,n,s,o){var a=hn(n)?Ti:Kt.current;return a=Ls(t,a),ks(t,o),n=_u(e,t,n,s,a,o),s=wu(),e!==null&&!dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ar(e,t,o)):(gt&&s&&lu(t),t.flags|=1,Qt(e,t,n,o),t.child)}function Lf(e,t,n,s,o){if(hn(n)){var a=!0;il(t)}else a=!1;if(ks(t,o),t.stateNode===null)zo(e,t),ag(t,n,s),fd(t,n,s,o),s=!0;else if(e===null){var l=t.stateNode,d=t.memoizedProps;l.props=d;var u=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=An(f):(f=hn(n)?Ti:Kt.current,f=Ls(t,f));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";g||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(d!==s||u!==f)&&Sf(t,l,s,f),Jr=!1;var y=t.memoizedState;l.state=y,cl(t,s,l,o),u=t.memoizedState,d!==s||y!==u||un.current||Jr?(typeof m=="function"&&(hd(t,n,m,s),u=t.memoizedState),(d=Jr||jf(t,n,d,s,y,u,f))?(g||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=u),l.props=s,l.state=u,l.context=f,s=d):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{l=t.stateNode,Om(e,t),d=t.memoizedProps,f=t.type===t.elementType?d:Hn(t.type,d),l.props=f,g=t.pendingProps,y=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=An(u):(u=hn(n)?Ti:Kt.current,u=Ls(t,u));var k=n.getDerivedStateFromProps;(m=typeof k=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(d!==g||y!==u)&&Sf(t,l,s,u),Jr=!1,y=t.memoizedState,l.state=y,cl(t,s,l,o);var v=t.memoizedState;d!==g||y!==v||un.current||Jr?(typeof k=="function"&&(hd(t,n,k,s),v=t.memoizedState),(f=Jr||jf(t,n,f,s,y,v,u)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,v,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,v,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=v),l.props=s,l.state=v,l.context=u,s=f):(typeof l.componentDidUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),s=!1)}return gd(e,t,n,s,a,o)}function gd(e,t,n,s,o,a){ug(e,t);var l=(t.flags&128)!==0;if(!s&&!l)return o&&pf(t,n,!1),Ar(e,t,a);s=t.stateNode,L_.current=t;var d=l&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&l?(t.child=Es(t,e.child,null,a),t.child=Es(t,null,d,a)):Qt(e,t,d,a),t.memoizedState=s.state,o&&pf(t,n,!0),t.child}function hg(e){var t=e.stateNode;t.pendingContext?ff(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ff(e,t.context,!1),gu(e,t.containerInfo)}function Pf(e,t,n,s,o){return Ps(),du(o),t.flags|=256,Qt(e,t,n,s),t.child}var yd={dehydrated:null,treeContext:null,retryLane:0};function xd(e){return{baseLanes:e,cachePool:null,transitions:null}}function fg(e,t,n){var s=t.pendingProps,o=vt.current,a=!1,l=(t.flags&128)!==0,d;if((d=l)||(d=e!==null&&e.memoizedState===null?!1:(o&2)!==0),d?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),ht(vt,o&1),e===null)return dd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=El(l,s,0,null),e=Pi(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=xd(n),t.memoizedState=yd,e):Cu(t,l));if(o=e.memoizedState,o!==null&&(d=o.dehydrated,d!==null))return P_(e,t,l,s,d,o,n);if(a){a=s.fallback,l=t.mode,o=e.child,d=o.sibling;var u={mode:"hidden",children:s.children};return!(l&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=u,t.deletions=null):(s=di(o,u),s.subtreeFlags=o.subtreeFlags&14680064),d!==null?a=di(d,a):(a=Pi(a,l,n,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=e.child.memoizedState,l=l===null?xd(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=yd,s}return a=e.child,e=a.sibling,s=di(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Cu(e,t){return t=El({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bo(e,t,n,s){return s!==null&&du(s),Es(t,e.child,null,n),e=Cu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function P_(e,t,n,s,o,a,l){if(n)return t.flags&256?(t.flags&=-257,s=Sc(Error(me(422))),bo(e,t,l,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,o=t.mode,s=El({mode:"visible",children:s.children},o,0,null),a=Pi(a,o,l,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&Es(t,e.child,null,l),t.child.memoizedState=xd(l),t.memoizedState=yd,a);if(!(t.mode&1))return bo(e,t,l,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var d=s.dgst;return s=d,a=Error(me(419)),s=Sc(a,s,void 0),bo(e,t,l,s)}if(d=(l&e.childLanes)!==0,dn||d){if(s=zt,s!==null){switch(l&-l){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|l)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,Rr(e,o),Yn(s,e,o,-1))}return Pu(),s=Sc(Error(me(421))),bo(e,t,l,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=W_.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,xn=ai(o.nextSibling),vn=t,gt=!0,Vn=null,e!==null&&(En[Tn++]=br,En[Tn++]=Ir,En[Tn++]=Bi,br=e.id,Ir=e.overflow,Bi=t),t=Cu(t,s.children),t.flags|=4096,t)}function Ef(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ud(e.return,t,n)}function Cc(e,t,n,s,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=o)}function pg(e,t,n){var s=t.pendingProps,o=s.revealOrder,a=s.tail;if(Qt(e,t,s.children,n),s=vt.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ef(e,n,t);else if(e.tag===19)Ef(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ht(vt,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&dl(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Cc(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&dl(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Cc(t,!0,n,null,a);break;case"together":Cc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ar(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ai|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(me(153));if(t.child!==null){for(e=t.child,n=di(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=di(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function E_(e,t,n){switch(t.tag){case 3:hg(t),Ps();break;case 5:Dm(t);break;case 1:hn(t.type)&&il(t);break;case 4:gu(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;ht(ol,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ht(vt,vt.current&1),t.flags|=128,null):n&t.child.childLanes?fg(e,t,n):(ht(vt,vt.current&1),e=Ar(e,t,n),e!==null?e.sibling:null);ht(vt,vt.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return pg(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),ht(vt,vt.current),s)break;return null;case 22:case 23:return t.lanes=0,dg(e,t,n)}return Ar(e,t,n)}var mg,vd,gg,yg;mg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vd=function(){};gg=function(e,t,n,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,bi(pr.current);var a=null;switch(n){case"input":o=zc(e,o),s=zc(e,s),a=[];break;case"select":o=wt({},o,{value:void 0}),s=wt({},s,{value:void 0}),a=[];break;case"textarea":o=Hc(e,o),s=Hc(e,s),a=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=nl)}Vc(n,s);var l;n=null;for(f in o)if(!s.hasOwnProperty(f)&&o.hasOwnProperty(f)&&o[f]!=null)if(f==="style"){var d=o[f];for(l in d)d.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Na.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in s){var u=s[f];if(d=o!=null?o[f]:void 0,s.hasOwnProperty(f)&&u!==d&&(u!=null||d!=null))if(f==="style")if(d){for(l in d)!d.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&d[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(a||(a=[]),a.push(f,n)),n=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,d=d?d.__html:void 0,u!=null&&d!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Na.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&pt("scroll",e),a||d===u||(a=[])):(a=a||[]).push(f,u))}n&&(a=a||[]).push("style",n);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};yg=function(e,t,n,s){n!==s&&(t.flags|=4)};function la(e,t){if(!gt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Vt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function T_(e,t,n){var s=t.pendingProps;switch(cu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(t),null;case 1:return hn(t.type)&&rl(),Vt(t),null;case 3:return s=t.stateNode,Ts(),mt(un),mt(Kt),xu(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(No(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Vn!==null&&(bd(Vn),Vn=null))),vd(e,t),Vt(t),null;case 5:yu(t);var o=bi(Fa.current);if(n=t.type,e!==null&&t.stateNode!=null)gg(e,t,n,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(me(166));return Vt(t),null}if(e=bi(pr.current),No(t)){s=t.stateNode,n=t.type;var a=t.memoizedProps;switch(s[hr]=t,s[Aa]=a,e=(t.mode&1)!==0,n){case"dialog":pt("cancel",s),pt("close",s);break;case"iframe":case"object":case"embed":pt("load",s);break;case"video":case"audio":for(o=0;o<ma.length;o++)pt(ma[o],s);break;case"source":pt("error",s);break;case"img":case"image":case"link":pt("error",s),pt("load",s);break;case"details":pt("toggle",s);break;case"input":Oh(s,a),pt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},pt("invalid",s);break;case"textarea":zh(s,a),pt("invalid",s)}Vc(n,a),o=null;for(var l in a)if(a.hasOwnProperty(l)){var d=a[l];l==="children"?typeof d=="string"?s.textContent!==d&&(a.suppressHydrationWarning!==!0&&Co(s.textContent,d,e),o=["children",d]):typeof d=="number"&&s.textContent!==""+d&&(a.suppressHydrationWarning!==!0&&Co(s.textContent,d,e),o=["children",""+d]):Na.hasOwnProperty(l)&&d!=null&&l==="onScroll"&&pt("scroll",s)}switch(n){case"input":go(s),Dh(s,a,!0);break;case"textarea":go(s),$h(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=nl)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{l=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Zp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=l.createElement(n,{is:s.is}):(e=l.createElement(n),n==="select"&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,n),e[hr]=t,e[Aa]=s,mg(e,t,!1,!1),t.stateNode=e;e:{switch(l=qc(n,s),n){case"dialog":pt("cancel",e),pt("close",e),o=s;break;case"iframe":case"object":case"embed":pt("load",e),o=s;break;case"video":case"audio":for(o=0;o<ma.length;o++)pt(ma[o],e);o=s;break;case"source":pt("error",e),o=s;break;case"img":case"image":case"link":pt("error",e),pt("load",e),o=s;break;case"details":pt("toggle",e),o=s;break;case"input":Oh(e,s),o=zc(e,s),pt("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=wt({},s,{value:void 0}),pt("invalid",e);break;case"textarea":zh(e,s),o=Hc(e,s),pt("invalid",e);break;default:o=s}Vc(n,o),d=o;for(a in d)if(d.hasOwnProperty(a)){var u=d[a];a==="style"?Gp(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Vp(e,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ka(e,u):typeof u=="number"&&ka(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Na.hasOwnProperty(a)?u!=null&&a==="onScroll"&&pt("scroll",e):u!=null&&Gd(e,a,u,l))}switch(n){case"input":go(e),Dh(e,s,!1);break;case"textarea":go(e),$h(e);break;case"option":s.value!=null&&e.setAttribute("value",""+hi(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?js(e,!!s.multiple,a,!1):s.defaultValue!=null&&js(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=nl)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Vt(t),null;case 6:if(e&&t.stateNode!=null)yg(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(me(166));if(n=bi(Fa.current),bi(pr.current),No(t)){if(s=t.stateNode,n=t.memoizedProps,s[hr]=t,(a=s.nodeValue!==n)&&(e=vn,e!==null))switch(e.tag){case 3:Co(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Co(s.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[hr]=t,t.stateNode=s}return Vt(t),null;case 13:if(mt(vt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(gt&&xn!==null&&t.mode&1&&!(t.flags&128))Am(),Ps(),t.flags|=98560,a=!1;else if(a=No(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(me(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(me(317));a[hr]=t}else Ps(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Vt(t),a=!1}else Vn!==null&&(bd(Vn),Vn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||vt.current&1?Rt===0&&(Rt=3):Pu())),t.updateQueue!==null&&(t.flags|=4),Vt(t),null);case 4:return Ts(),vd(e,t),e===null&&Ba(t.stateNode.containerInfo),Vt(t),null;case 10:return fu(t.type._context),Vt(t),null;case 17:return hn(t.type)&&rl(),Vt(t),null;case 19:if(mt(vt),a=t.memoizedState,a===null)return Vt(t),null;if(s=(t.flags&128)!==0,l=a.rendering,l===null)if(s)la(a,!1);else{if(Rt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=dl(e),l!==null){for(t.flags|=128,la(a,!1),s=l.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)a=n,e=s,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ht(vt,vt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ct()>Rs&&(t.flags|=128,s=!0,la(a,!1),t.lanes=4194304)}else{if(!s)if(e=dl(l),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),la(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!gt)return Vt(t),null}else 2*Ct()-a.renderingStartTime>Rs&&n!==1073741824&&(t.flags|=128,s=!0,la(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(n=a.last,n!==null?n.sibling=l:t.child=l,a.last=l)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ct(),t.sibling=null,n=vt.current,ht(vt,s?n&1|2:n&1),t):(Vt(t),null);case 22:case 23:return Lu(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?yn&1073741824&&(Vt(t),t.subtreeFlags&6&&(t.flags|=8192)):Vt(t),null;case 24:return null;case 25:return null}throw Error(me(156,t.tag))}function B_(e,t){switch(cu(t),t.tag){case 1:return hn(t.type)&&rl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ts(),mt(un),mt(Kt),xu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return yu(t),null;case 13:if(mt(vt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(me(340));Ps()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return mt(vt),null;case 4:return Ts(),null;case 10:return fu(t.type._context),null;case 22:case 23:return Lu(),null;case 24:return null;default:return null}}var Io=!1,qt=!1,R_=typeof WeakSet=="function"?WeakSet:Set,be=null;function _s(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){St(e,t,s)}else n.current=null}function _d(e,t,n){try{n()}catch(s){St(e,t,s)}}var Tf=!1;function A_(e,t){if(rd=Xo,e=jm(),ou(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var o=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var l=0,d=-1,u=-1,f=0,m=0,g=e,y=null;t:for(;;){for(var k;g!==n||o!==0&&g.nodeType!==3||(d=l+o),g!==a||s!==0&&g.nodeType!==3||(u=l+s),g.nodeType===3&&(l+=g.nodeValue.length),(k=g.firstChild)!==null;)y=g,g=k;for(;;){if(g===e)break t;if(y===n&&++f===o&&(d=l),y===a&&++m===s&&(u=l),(k=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=k}n=d===-1||u===-1?null:{start:d,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(id={focusedElem:e,selectionRange:n},Xo=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,C=v.memoizedState,j=t.stateNode,w=j.getSnapshotBeforeUpdate(t.elementType===t.type?x:Hn(t.type,x),C);j.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var N=t.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(b){St(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return v=Tf,Tf=!1,v}function ja(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&_d(t,n,a)}o=o.next}while(o!==s)}}function Ll(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function wd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function xg(e){var t=e.alternate;t!==null&&(e.alternate=null,xg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[hr],delete t[Aa],delete t[od],delete t[y_],delete t[x_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function vg(e){return e.tag===5||e.tag===3||e.tag===4}function Bf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function jd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nl));else if(s!==4&&(e=e.child,e!==null))for(jd(e,t,n),e=e.sibling;e!==null;)jd(e,t,n),e=e.sibling}function Sd(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Sd(e,t,n),e=e.sibling;e!==null;)Sd(e,t,n),e=e.sibling}var $t=null,Zn=!1;function Yr(e,t,n){for(n=n.child;n!==null;)_g(e,t,n),n=n.sibling}function _g(e,t,n){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(wl,n)}catch{}switch(n.tag){case 5:qt||_s(n,t);case 6:var s=$t,o=Zn;$t=null,Yr(e,t,n),$t=s,Zn=o,$t!==null&&(Zn?(e=$t,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(Zn?(e=$t,n=n.stateNode,e.nodeType===8?yc(e.parentNode,n):e.nodeType===1&&yc(e,n),Pa(e)):yc($t,n.stateNode));break;case 4:s=$t,o=Zn,$t=n.stateNode.containerInfo,Zn=!0,Yr(e,t,n),$t=s,Zn=o;break;case 0:case 11:case 14:case 15:if(!qt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var a=o,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&_d(n,t,l),o=o.next}while(o!==s)}Yr(e,t,n);break;case 1:if(!qt&&(_s(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(d){St(n,t,d)}Yr(e,t,n);break;case 21:Yr(e,t,n);break;case 22:n.mode&1?(qt=(s=qt)||n.memoizedState!==null,Yr(e,t,n),qt=s):Yr(e,t,n);break;default:Yr(e,t,n)}}function Rf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new R_),t.forEach(function(s){var o=H_.bind(null,e,s);n.has(s)||(n.add(s),s.then(o,o))})}}function Wn(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];try{var a=e,l=t,d=l;e:for(;d!==null;){switch(d.tag){case 5:$t=d.stateNode,Zn=!1;break e;case 3:$t=d.stateNode.containerInfo,Zn=!0;break e;case 4:$t=d.stateNode.containerInfo,Zn=!0;break e}d=d.return}if($t===null)throw Error(me(160));_g(a,l,o),$t=null,Zn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(f){St(o,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)wg(t,e),t=t.sibling}function wg(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Wn(t,e),cr(e),s&4){try{ja(3,e,e.return),Ll(3,e)}catch(x){St(e,e.return,x)}try{ja(5,e,e.return)}catch(x){St(e,e.return,x)}}break;case 1:Wn(t,e),cr(e),s&512&&n!==null&&_s(n,n.return);break;case 5:if(Wn(t,e),cr(e),s&512&&n!==null&&_s(n,n.return),e.flags&32){var o=e.stateNode;try{ka(o,"")}catch(x){St(e,e.return,x)}}if(s&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,l=n!==null?n.memoizedProps:a,d=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{d==="input"&&a.type==="radio"&&a.name!=null&&Wp(o,a),qc(d,l);var f=qc(d,a);for(l=0;l<u.length;l+=2){var m=u[l],g=u[l+1];m==="style"?Gp(o,g):m==="dangerouslySetInnerHTML"?Vp(o,g):m==="children"?ka(o,g):Gd(o,m,g,f)}switch(d){case"input":$c(o,a);break;case"textarea":Hp(o,a);break;case"select":var y=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var k=a.value;k!=null?js(o,!!a.multiple,k,!1):y!==!!a.multiple&&(a.defaultValue!=null?js(o,!!a.multiple,a.defaultValue,!0):js(o,!!a.multiple,a.multiple?[]:"",!1))}o[Aa]=a}catch(x){St(e,e.return,x)}}break;case 6:if(Wn(t,e),cr(e),s&4){if(e.stateNode===null)throw Error(me(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(x){St(e,e.return,x)}}break;case 3:if(Wn(t,e),cr(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Pa(t.containerInfo)}catch(x){St(e,e.return,x)}break;case 4:Wn(t,e),cr(e);break;case 13:Wn(t,e),cr(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(bu=Ct())),s&4&&Rf(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(qt=(f=qt)||m,Wn(t,e),qt=f):Wn(t,e),cr(e),s&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!m&&e.mode&1)for(be=e,m=e.child;m!==null;){for(g=be=m;be!==null;){switch(y=be,k=y.child,y.tag){case 0:case 11:case 14:case 15:ja(4,y,y.return);break;case 1:_s(y,y.return);var v=y.stateNode;if(typeof v.componentWillUnmount=="function"){s=y,n=y.return;try{t=s,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){St(s,n,x)}}break;case 5:_s(y,y.return);break;case 22:if(y.memoizedState!==null){Mf(g);continue}}k!==null?(k.return=y,be=k):Mf(g)}m=m.sibling}e:for(m=null,g=e;;){if(g.tag===5){if(m===null){m=g;try{o=g.stateNode,f?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(d=g.stateNode,u=g.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,d.style.display=qp("display",l))}catch(x){St(e,e.return,x)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=f?"":g.memoizedProps}catch(x){St(e,e.return,x)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Wn(t,e),cr(e),s&4&&Rf(e);break;case 21:break;default:Wn(t,e),cr(e)}}function cr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(vg(n)){var s=n;break e}n=n.return}throw Error(me(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ka(o,""),s.flags&=-33);var a=Bf(e);Sd(e,a,o);break;case 3:case 4:var l=s.stateNode.containerInfo,d=Bf(e);jd(e,d,l);break;default:throw Error(me(161))}}catch(u){St(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function M_(e,t,n){be=e,jg(e)}function jg(e,t,n){for(var s=(e.mode&1)!==0;be!==null;){var o=be,a=o.child;if(o.tag===22&&s){var l=o.memoizedState!==null||Io;if(!l){var d=o.alternate,u=d!==null&&d.memoizedState!==null||qt;d=Io;var f=qt;if(Io=l,(qt=u)&&!f)for(be=o;be!==null;)l=be,u=l.child,l.tag===22&&l.memoizedState!==null?Ff(o):u!==null?(u.return=l,be=u):Ff(o);for(;a!==null;)be=a,jg(a),a=a.sibling;be=o,Io=d,qt=f}Af(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,be=a):Af(e)}}function Af(e){for(;be!==null;){var t=be;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:qt||Ll(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!qt)if(n===null)s.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Hn(t.type,n.memoizedProps);s.componentDidUpdate(o,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&vf(t,a,s);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}vf(t,l,n)}break;case 5:var d=t.stateNode;if(n===null&&t.flags&4){n=d;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var m=f.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&Pa(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}qt||t.flags&512&&wd(t)}catch(y){St(t,t.return,y)}}if(t===e){be=null;break}if(n=t.sibling,n!==null){n.return=t.return,be=n;break}be=t.return}}function Mf(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var n=t.sibling;if(n!==null){n.return=t.return,be=n;break}be=t.return}}function Ff(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ll(4,t)}catch(u){St(t,n,u)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(u){St(t,o,u)}}var a=t.return;try{wd(t)}catch(u){St(t,a,u)}break;case 5:var l=t.return;try{wd(t)}catch(u){St(t,l,u)}}}catch(u){St(t,t.return,u)}if(t===e){be=null;break}var d=t.sibling;if(d!==null){d.return=t.return,be=d;break}be=t.return}}var F_=Math.ceil,fl=Mr.ReactCurrentDispatcher,Nu=Mr.ReactCurrentOwner,Rn=Mr.ReactCurrentBatchConfig,et=0,zt=null,Pt=null,Wt=0,yn=0,ws=mi(0),Rt=0,za=null,Ai=0,Pl=0,ku=0,Sa=null,cn=null,bu=0,Rs=1/0,Nr=null,pl=!1,Cd=null,li=null,Lo=!1,ti=null,ml=0,Ca=0,Nd=null,$o=-1,Wo=0;function en(){return et&6?Ct():$o!==-1?$o:$o=Ct()}function ci(e){return e.mode&1?et&2&&Wt!==0?Wt&-Wt:__.transition!==null?(Wo===0&&(Wo=am()),Wo):(e=at,e!==0||(e=window.event,e=e===void 0?16:fm(e.type)),e):1}function Yn(e,t,n,s){if(50<Ca)throw Ca=0,Nd=null,Error(me(185));Za(e,n,s),(!(et&2)||e!==zt)&&(e===zt&&(!(et&2)&&(Pl|=n),Rt===4&&Xr(e,Wt)),fn(e,s),n===1&&et===0&&!(t.mode&1)&&(Rs=Ct()+500,kl&&gi()))}function fn(e,t){var n=e.callbackNode;_v(e,t);var s=Qo(e,e===zt?Wt:0);if(s===0)n!==null&&Zh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Zh(n),t===1)e.tag===0?v_(Uf.bind(null,e)):Tm(Uf.bind(null,e)),m_(function(){!(et&6)&&gi()}),n=null;else{switch(om(s)){case 1:n=Xd;break;case 4:n=im;break;case 16:n=Jo;break;case 536870912:n=sm;break;default:n=Jo}n=Pg(n,Sg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Sg(e,t){if($o=-1,Wo=0,et&6)throw Error(me(327));var n=e.callbackNode;if(bs()&&e.callbackNode!==n)return null;var s=Qo(e,e===zt?Wt:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=gl(e,s);else{t=s;var o=et;et|=2;var a=Ng();(zt!==e||Wt!==t)&&(Nr=null,Rs=Ct()+500,Li(e,t));do try{D_();break}catch(d){Cg(e,d)}while(!0);hu(),fl.current=a,et=o,Pt!==null?t=0:(zt=null,Wt=0,t=Rt)}if(t!==0){if(t===2&&(o=Qc(e),o!==0&&(s=o,t=kd(e,o))),t===1)throw n=za,Li(e,0),Xr(e,s),fn(e,Ct()),n;if(t===6)Xr(e,s);else{if(o=e.current.alternate,!(s&30)&&!U_(o)&&(t=gl(e,s),t===2&&(a=Qc(e),a!==0&&(s=a,t=kd(e,a))),t===1))throw n=za,Li(e,0),Xr(e,s),fn(e,Ct()),n;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(me(345));case 2:Ci(e,cn,Nr);break;case 3:if(Xr(e,s),(s&130023424)===s&&(t=bu+500-Ct(),10<t)){if(Qo(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){en(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ad(Ci.bind(null,e,cn,Nr),t);break}Ci(e,cn,Nr);break;case 4:if(Xr(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var l=31-Gn(s);a=1<<l,l=t[l],l>o&&(o=l),s&=~a}if(s=o,s=Ct()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*F_(s/1960))-s,10<s){e.timeoutHandle=ad(Ci.bind(null,e,cn,Nr),s);break}Ci(e,cn,Nr);break;case 5:Ci(e,cn,Nr);break;default:throw Error(me(329))}}}return fn(e,Ct()),e.callbackNode===n?Sg.bind(null,e):null}function kd(e,t){var n=Sa;return e.current.memoizedState.isDehydrated&&(Li(e,t).flags|=256),e=gl(e,t),e!==2&&(t=cn,cn=n,t!==null&&bd(t)),e}function bd(e){cn===null?cn=e:cn.push.apply(cn,e)}function U_(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var o=n[s],a=o.getSnapshot;o=o.value;try{if(!Kn(a(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xr(e,t){for(t&=~ku,t&=~Pl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Gn(t),s=1<<n;e[n]=-1,t&=~s}}function Uf(e){if(et&6)throw Error(me(327));bs();var t=Qo(e,0);if(!(t&1))return fn(e,Ct()),null;var n=gl(e,t);if(e.tag!==0&&n===2){var s=Qc(e);s!==0&&(t=s,n=kd(e,s))}if(n===1)throw n=za,Li(e,0),Xr(e,t),fn(e,Ct()),n;if(n===6)throw Error(me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ci(e,cn,Nr),fn(e,Ct()),null}function Iu(e,t){var n=et;et|=1;try{return e(t)}finally{et=n,et===0&&(Rs=Ct()+500,kl&&gi())}}function Mi(e){ti!==null&&ti.tag===0&&!(et&6)&&bs();var t=et;et|=1;var n=Rn.transition,s=at;try{if(Rn.transition=null,at=1,e)return e()}finally{at=s,Rn.transition=n,et=t,!(et&6)&&gi()}}function Lu(){yn=ws.current,mt(ws)}function Li(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,p_(n)),Pt!==null)for(n=Pt.return;n!==null;){var s=n;switch(cu(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&rl();break;case 3:Ts(),mt(un),mt(Kt),xu();break;case 5:yu(s);break;case 4:Ts();break;case 13:mt(vt);break;case 19:mt(vt);break;case 10:fu(s.type._context);break;case 22:case 23:Lu()}n=n.return}if(zt=e,Pt=e=di(e.current,null),Wt=yn=t,Rt=0,za=null,ku=Pl=Ai=0,cn=Sa=null,ki!==null){for(t=0;t<ki.length;t++)if(n=ki[t],s=n.interleaved,s!==null){n.interleaved=null;var o=s.next,a=n.pending;if(a!==null){var l=a.next;a.next=o,s.next=l}n.pending=s}ki=null}return e}function Cg(e,t){do{var n=Pt;try{if(hu(),Oo.current=hl,ul){for(var s=_t.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}ul=!1}if(Ri=0,Dt=Bt=_t=null,wa=!1,Ua=0,Nu.current=null,n===null||n.return===null){Rt=1,za=t,Pt=null;break}e:{var a=e,l=n.return,d=n,u=t;if(t=Wt,d.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,m=d,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var k=Nf(l);if(k!==null){k.flags&=-257,kf(k,l,d,a,t),k.mode&1&&Cf(a,f,t),t=k,u=f;var v=t.updateQueue;if(v===null){var x=new Set;x.add(u),t.updateQueue=x}else v.add(u);break e}else{if(!(t&1)){Cf(a,f,t),Pu();break e}u=Error(me(426))}}else if(gt&&d.mode&1){var C=Nf(l);if(C!==null){!(C.flags&65536)&&(C.flags|=256),kf(C,l,d,a,t),du(Bs(u,d));break e}}a=u=Bs(u,d),Rt!==4&&(Rt=2),Sa===null?Sa=[a]:Sa.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var j=og(a,u,t);xf(a,j);break e;case 1:d=u;var w=a.type,N=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(li===null||!li.has(N)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=lg(a,d,t);xf(a,b);break e}}a=a.return}while(a!==null)}bg(n)}catch(T){t=T,Pt===n&&n!==null&&(Pt=n=n.return);continue}break}while(!0)}function Ng(){var e=fl.current;return fl.current=hl,e===null?hl:e}function Pu(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),zt===null||!(Ai&268435455)&&!(Pl&268435455)||Xr(zt,Wt)}function gl(e,t){var n=et;et|=2;var s=Ng();(zt!==e||Wt!==t)&&(Nr=null,Li(e,t));do try{O_();break}catch(o){Cg(e,o)}while(!0);if(hu(),et=n,fl.current=s,Pt!==null)throw Error(me(261));return zt=null,Wt=0,Rt}function O_(){for(;Pt!==null;)kg(Pt)}function D_(){for(;Pt!==null&&!uv();)kg(Pt)}function kg(e){var t=Lg(e.alternate,e,yn);e.memoizedProps=e.pendingProps,t===null?bg(e):Pt=t,Nu.current=null}function bg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=B_(n,t),n!==null){n.flags&=32767,Pt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rt=6,Pt=null;return}}else if(n=T_(n,t,yn),n!==null){Pt=n;return}if(t=t.sibling,t!==null){Pt=t;return}Pt=t=e}while(t!==null);Rt===0&&(Rt=5)}function Ci(e,t,n){var s=at,o=Rn.transition;try{Rn.transition=null,at=1,z_(e,t,n,s)}finally{Rn.transition=o,at=s}return null}function z_(e,t,n,s){do bs();while(ti!==null);if(et&6)throw Error(me(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(me(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(wv(e,a),e===zt&&(Pt=zt=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Lo||(Lo=!0,Pg(Jo,function(){return bs(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Rn.transition,Rn.transition=null;var l=at;at=1;var d=et;et|=4,Nu.current=null,A_(e,n),wg(n,e),o_(id),Xo=!!rd,id=rd=null,e.current=n,M_(n),hv(),et=d,at=l,Rn.transition=a}else e.current=n;if(Lo&&(Lo=!1,ti=e,ml=o),a=e.pendingLanes,a===0&&(li=null),mv(n.stateNode),fn(e,Ct()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],s(o.value,{componentStack:o.stack,digest:o.digest});if(pl)throw pl=!1,e=Cd,Cd=null,e;return ml&1&&e.tag!==0&&bs(),a=e.pendingLanes,a&1?e===Nd?Ca++:(Ca=0,Nd=e):Ca=0,gi(),null}function bs(){if(ti!==null){var e=om(ml),t=Rn.transition,n=at;try{if(Rn.transition=null,at=16>e?16:e,ti===null)var s=!1;else{if(e=ti,ti=null,ml=0,et&6)throw Error(me(331));var o=et;for(et|=4,be=e.current;be!==null;){var a=be,l=a.child;if(be.flags&16){var d=a.deletions;if(d!==null){for(var u=0;u<d.length;u++){var f=d[u];for(be=f;be!==null;){var m=be;switch(m.tag){case 0:case 11:case 15:ja(8,m,a)}var g=m.child;if(g!==null)g.return=m,be=g;else for(;be!==null;){m=be;var y=m.sibling,k=m.return;if(xg(m),m===f){be=null;break}if(y!==null){y.return=k,be=y;break}be=k}}}var v=a.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var C=x.sibling;x.sibling=null,x=C}while(x!==null)}}be=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,be=l;else e:for(;be!==null;){if(a=be,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ja(9,a,a.return)}var j=a.sibling;if(j!==null){j.return=a.return,be=j;break e}be=a.return}}var w=e.current;for(be=w;be!==null;){l=be;var N=l.child;if(l.subtreeFlags&2064&&N!==null)N.return=l,be=N;else e:for(l=w;be!==null;){if(d=be,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:Ll(9,d)}}catch(T){St(d,d.return,T)}if(d===l){be=null;break e}var b=d.sibling;if(b!==null){b.return=d.return,be=b;break e}be=d.return}}if(et=o,gi(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(wl,e)}catch{}s=!0}return s}finally{at=n,Rn.transition=t}}return!1}function Of(e,t,n){t=Bs(n,t),t=og(e,t,1),e=oi(e,t,1),t=en(),e!==null&&(Za(e,1,t),fn(e,t))}function St(e,t,n){if(e.tag===3)Of(e,e,n);else for(;t!==null;){if(t.tag===3){Of(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(li===null||!li.has(s))){e=Bs(n,e),e=lg(t,e,1),t=oi(t,e,1),e=en(),t!==null&&(Za(t,1,e),fn(t,e));break}}t=t.return}}function $_(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=en(),e.pingedLanes|=e.suspendedLanes&n,zt===e&&(Wt&n)===n&&(Rt===4||Rt===3&&(Wt&130023424)===Wt&&500>Ct()-bu?Li(e,0):ku|=n),fn(e,t)}function Ig(e,t){t===0&&(e.mode&1?(t=vo,vo<<=1,!(vo&130023424)&&(vo=4194304)):t=1);var n=en();e=Rr(e,t),e!==null&&(Za(e,t,n),fn(e,n))}function W_(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ig(e,n)}function H_(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(me(314))}s!==null&&s.delete(t),Ig(e,n)}var Lg;Lg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||un.current)dn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return dn=!1,E_(e,t,n);dn=!!(e.flags&131072)}else dn=!1,gt&&t.flags&1048576&&Bm(t,al,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;zo(e,t),e=t.pendingProps;var o=Ls(t,Kt.current);ks(t,n),o=_u(null,t,s,e,o,n);var a=wu();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hn(s)?(a=!0,il(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,mu(t),o.updater=Il,t.stateNode=o,o._reactInternals=t,fd(t,s,e,n),t=gd(null,t,s,!0,a,n)):(t.tag=0,gt&&a&&lu(t),Qt(null,t,o,n),t=t.child),t;case 16:s=t.elementType;e:{switch(zo(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=V_(s),e=Hn(s,e),o){case 0:t=md(null,t,s,e,n);break e;case 1:t=Lf(null,t,s,e,n);break e;case 11:t=bf(null,t,s,e,n);break e;case 14:t=If(null,t,s,Hn(s.type,e),n);break e}throw Error(me(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Hn(s,o),md(e,t,s,o,n);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Hn(s,o),Lf(e,t,s,o,n);case 3:e:{if(hg(t),e===null)throw Error(me(387));s=t.pendingProps,a=t.memoizedState,o=a.element,Om(e,t),cl(t,s,null,n);var l=t.memoizedState;if(s=l.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Bs(Error(me(423)),t),t=Pf(e,t,s,n,o);break e}else if(s!==o){o=Bs(Error(me(424)),t),t=Pf(e,t,s,n,o);break e}else for(xn=ai(t.stateNode.containerInfo.firstChild),vn=t,gt=!0,Vn=null,n=Fm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ps(),s===o){t=Ar(e,t,n);break e}Qt(e,t,s,n)}t=t.child}return t;case 5:return Dm(t),e===null&&dd(t),s=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,l=o.children,sd(s,o)?l=null:a!==null&&sd(s,a)&&(t.flags|=32),ug(e,t),Qt(e,t,l,n),t.child;case 6:return e===null&&dd(t),null;case 13:return fg(e,t,n);case 4:return gu(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Es(t,null,s,n):Qt(e,t,s,n),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Hn(s,o),bf(e,t,s,o,n);case 7:return Qt(e,t,t.pendingProps,n),t.child;case 8:return Qt(e,t,t.pendingProps.children,n),t.child;case 12:return Qt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,a=t.memoizedProps,l=o.value,ht(ol,s._currentValue),s._currentValue=l,a!==null)if(Kn(a.value,l)){if(a.children===o.children&&!un.current){t=Ar(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var d=a.dependencies;if(d!==null){l=a.child;for(var u=d.firstContext;u!==null;){if(u.context===s){if(a.tag===1){u=Pr(-1,n&-n),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var m=f.pending;m===null?u.next=u:(u.next=m.next,m.next=u),f.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),ud(a.return,n,t),d.lanes|=n;break}u=u.next}}else if(a.tag===10)l=a.type===t.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(me(341));l.lanes|=n,d=l.alternate,d!==null&&(d.lanes|=n),ud(l,n,t),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===t){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}Qt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,ks(t,n),o=An(o),s=s(o),t.flags|=1,Qt(e,t,s,n),t.child;case 14:return s=t.type,o=Hn(s,t.pendingProps),o=Hn(s.type,o),If(e,t,s,o,n);case 15:return cg(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Hn(s,o),zo(e,t),t.tag=1,hn(s)?(e=!0,il(t)):e=!1,ks(t,n),ag(t,s,o),fd(t,s,o,n),gd(null,t,s,!0,e,n);case 19:return pg(e,t,n);case 22:return dg(e,t,n)}throw Error(me(156,t.tag))};function Pg(e,t){return rm(e,t)}function Z_(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(e,t,n,s){return new Z_(e,t,n,s)}function Eu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function V_(e){if(typeof e=="function")return Eu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Kd)return 11;if(e===Jd)return 14}return 2}function di(e,t){var n=e.alternate;return n===null?(n=Bn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ho(e,t,n,s,o,a){var l=2;if(s=e,typeof e=="function")Eu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case us:return Pi(n.children,o,a,t);case Yd:l=8,o|=8;break;case Fc:return e=Bn(12,n,t,o|2),e.elementType=Fc,e.lanes=a,e;case Uc:return e=Bn(13,n,t,o),e.elementType=Uc,e.lanes=a,e;case Oc:return e=Bn(19,n,t,o),e.elementType=Oc,e.lanes=a,e;case Dp:return El(n,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Up:l=10;break e;case Op:l=9;break e;case Kd:l=11;break e;case Jd:l=14;break e;case Kr:l=16,s=null;break e}throw Error(me(130,e==null?e:typeof e,""))}return t=Bn(l,n,t,o),t.elementType=e,t.type=s,t.lanes=a,t}function Pi(e,t,n,s){return e=Bn(7,e,s,t),e.lanes=n,e}function El(e,t,n,s){return e=Bn(22,e,s,t),e.elementType=Dp,e.lanes=n,e.stateNode={isHidden:!1},e}function Nc(e,t,n){return e=Bn(6,e,null,t),e.lanes=n,e}function kc(e,t,n){return t=Bn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function q_(e,t,n,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ac(0),this.expirationTimes=ac(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ac(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Tu(e,t,n,s,o,a,l,d,u){return e=new q_(e,t,n,d,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Bn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},mu(a),e}function G_(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ds,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Eg(e){if(!e)return fi;e=e._reactInternals;e:{if(Oi(e)!==e||e.tag!==1)throw Error(me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(me(171))}if(e.tag===1){var n=e.type;if(hn(n))return Em(e,n,t)}return t}function Tg(e,t,n,s,o,a,l,d,u){return e=Tu(n,s,!0,e,o,a,l,d,u),e.context=Eg(null),n=e.current,s=en(),o=ci(n),a=Pr(s,o),a.callback=t??null,oi(n,a,o),e.current.lanes=o,Za(e,o,s),fn(e,s),e}function Tl(e,t,n,s){var o=t.current,a=en(),l=ci(o);return n=Eg(n),t.context===null?t.context=n:t.pendingContext=n,t=Pr(a,l),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=oi(o,t,l),e!==null&&(Yn(e,o,l,a),Uo(e,o,l)),l}function yl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Df(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Bu(e,t){Df(e,t),(e=e.alternate)&&Df(e,t)}function Y_(){return null}var Bg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ru(e){this._internalRoot=e}Bl.prototype.render=Ru.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(me(409));Tl(e,t,null,null)};Bl.prototype.unmount=Ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Mi(function(){Tl(null,e,null,null)}),t[Br]=null}};function Bl(e){this._internalRoot=e}Bl.prototype.unstable_scheduleHydration=function(e){if(e){var t=dm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Qr.length&&t!==0&&t<Qr[n].priority;n++);Qr.splice(n,0,e),n===0&&hm(e)}};function Au(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function zf(){}function K_(e,t,n,s,o){if(o){if(typeof s=="function"){var a=s;s=function(){var f=yl(l);a.call(f)}}var l=Tg(t,s,e,0,null,!1,!1,"",zf);return e._reactRootContainer=l,e[Br]=l.current,Ba(e.nodeType===8?e.parentNode:e),Mi(),l}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var d=s;s=function(){var f=yl(u);d.call(f)}}var u=Tu(e,0,!1,null,null,!1,!1,"",zf);return e._reactRootContainer=u,e[Br]=u.current,Ba(e.nodeType===8?e.parentNode:e),Mi(function(){Tl(t,u,n,s)}),u}function Al(e,t,n,s,o){var a=n._reactRootContainer;if(a){var l=a;if(typeof o=="function"){var d=o;o=function(){var u=yl(l);d.call(u)}}Tl(t,l,e,o)}else l=K_(n,t,e,o,s);return yl(l)}lm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=pa(t.pendingLanes);n!==0&&(eu(t,n|1),fn(t,Ct()),!(et&6)&&(Rs=Ct()+500,gi()))}break;case 13:Mi(function(){var s=Rr(e,1);if(s!==null){var o=en();Yn(s,e,1,o)}}),Bu(e,1)}};tu=function(e){if(e.tag===13){var t=Rr(e,134217728);if(t!==null){var n=en();Yn(t,e,134217728,n)}Bu(e,134217728)}};cm=function(e){if(e.tag===13){var t=ci(e),n=Rr(e,t);if(n!==null){var s=en();Yn(n,e,t,s)}Bu(e,t)}};dm=function(){return at};um=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Yc=function(e,t,n){switch(t){case"input":if($c(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var o=Nl(s);if(!o)throw Error(me(90));$p(s),$c(s,o)}}}break;case"textarea":Hp(e,n);break;case"select":t=n.value,t!=null&&js(e,!!n.multiple,t,!1)}};Jp=Iu;Qp=Mi;var J_={usingClientEntryPoint:!1,Events:[qa,ms,Nl,Yp,Kp,Iu]},ca={findFiberByHostInstance:Ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Q_={bundleType:ca.bundleType,version:ca.version,rendererPackageName:ca.rendererPackageName,rendererConfig:ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=tm(e),e===null?null:e.stateNode},findFiberByHostInstance:ca.findFiberByHostInstance||Y_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Po=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Po.isDisabled&&Po.supportsFiber)try{wl=Po.inject(Q_),fr=Po}catch{}}wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J_;wn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Au(t))throw Error(me(200));return G_(e,t,null,n)};wn.createRoot=function(e,t){if(!Au(e))throw Error(me(299));var n=!1,s="",o=Bg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Tu(e,1,!1,null,null,n,!1,s,o),e[Br]=t.current,Ba(e.nodeType===8?e.parentNode:e),new Ru(t)};wn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(me(188)):(e=Object.keys(e).join(","),Error(me(268,e)));return e=tm(t),e=e===null?null:e.stateNode,e};wn.flushSync=function(e){return Mi(e)};wn.hydrate=function(e,t,n){if(!Rl(t))throw Error(me(200));return Al(null,e,t,!0,n)};wn.hydrateRoot=function(e,t,n){if(!Au(e))throw Error(me(405));var s=n!=null&&n.hydratedSources||null,o=!1,a="",l=Bg;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Tg(t,null,e,1,n??null,o,!1,a,l),e[Br]=t.current,Ba(e),s)for(e=0;e<s.length;e++)n=s[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Bl(t)};wn.render=function(e,t,n){if(!Rl(t))throw Error(me(200));return Al(null,e,t,!1,n)};wn.unmountComponentAtNode=function(e){if(!Rl(e))throw Error(me(40));return e._reactRootContainer?(Mi(function(){Al(null,null,e,!1,function(){e._reactRootContainer=null,e[Br]=null})}),!0):!1};wn.unstable_batchedUpdates=Iu;wn.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Rl(n))throw Error(me(200));if(e==null||e._reactInternals===void 0)throw Error(me(38));return Al(e,t,n,!1,s)};wn.version="18.3.1-next-f1338f8080-20240426";function Rg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rg)}catch(e){console.error(e)}}Rg(),Rp.exports=wn;var Ag=Rp.exports,Mg,$f=Ag;Mg=$f.createRoot,$f.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $a(){return $a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},$a.apply(this,arguments)}var ni;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ni||(ni={}));const Wf="popstate";function X_(e){e===void 0&&(e={});function t(s,o){let{pathname:a,search:l,hash:d}=s.location;return Id("",{pathname:a,search:l,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){return typeof o=="string"?o:xl(o)}return t0(t,n,null,e)}function Nt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Fg(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function e0(){return Math.random().toString(36).substr(2,8)}function Hf(e,t){return{usr:e.state,key:e.key,idx:t}}function Id(e,t,n,s){return n===void 0&&(n=null),$a({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ds(t):t,{state:n,key:t&&t.key||s||e0()})}function xl(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Ds(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function t0(e,t,n,s){s===void 0&&(s={});let{window:o=document.defaultView,v5Compat:a=!1}=s,l=o.history,d=ni.Pop,u=null,f=m();f==null&&(f=0,l.replaceState($a({},l.state,{idx:f}),""));function m(){return(l.state||{idx:null}).idx}function g(){d=ni.Pop;let C=m(),j=C==null?null:C-f;f=C,u&&u({action:d,location:x.location,delta:j})}function y(C,j){d=ni.Push;let w=Id(x.location,C,j);f=m()+1;let N=Hf(w,f),b=x.createHref(w);try{l.pushState(N,"",b)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;o.location.assign(b)}a&&u&&u({action:d,location:x.location,delta:1})}function k(C,j){d=ni.Replace;let w=Id(x.location,C,j);f=m();let N=Hf(w,f),b=x.createHref(w);l.replaceState(N,"",b),a&&u&&u({action:d,location:x.location,delta:0})}function v(C){let j=o.location.origin!=="null"?o.location.origin:o.location.href,w=typeof C=="string"?C:xl(C);return w=w.replace(/ $/,"%20"),Nt(j,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,j)}let x={get action(){return d},get location(){return e(o,l)},listen(C){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(Wf,g),u=C,()=>{o.removeEventListener(Wf,g),u=null}},createHref(C){return t(o,C)},createURL:v,encodeLocation(C){let j=v(C);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:y,replace:k,go(C){return l.go(C)}};return x}var Zf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Zf||(Zf={}));function n0(e,t,n){return n===void 0&&(n="/"),r0(e,t,n)}function r0(e,t,n,s){let o=typeof t=="string"?Ds(t):t,a=Mu(o.pathname||"/",n);if(a==null)return null;let l=Ug(e);i0(l);let d=null;for(let u=0;d==null&&u<l.length;++u){let f=g0(a);d=f0(l[u],f)}return d}function Ug(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let o=(a,l,d)=>{let u={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};u.relativePath.startsWith("/")&&(Nt(u.relativePath.startsWith(s),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(s.length));let f=ui([s,u.relativePath]),m=n.concat(u);a.children&&a.children.length>0&&(Nt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),Ug(a.children,t,m,f)),!(a.path==null&&!a.index)&&t.push({path:f,score:u0(f,a.index),routesMeta:m})};return e.forEach((a,l)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))o(a,l);else for(let u of Og(a.path))o(a,l,u)}),t}function Og(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return o?[a,""]:[a];let l=Og(s.join("/")),d=[];return d.push(...l.map(u=>u===""?a:[a,u].join("/"))),o&&d.push(...l),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function i0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:h0(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const s0=/^:[\w-]+$/,a0=3,o0=2,l0=1,c0=10,d0=-2,Vf=e=>e==="*";function u0(e,t){let n=e.split("/"),s=n.length;return n.some(Vf)&&(s+=d0),t&&(s+=o0),n.filter(o=>!Vf(o)).reduce((o,a)=>o+(s0.test(a)?a0:a===""?l0:c0),s)}function h0(e,t){return e.length===t.length&&e.slice(0,-1).every((s,o)=>s===t[o])?e[e.length-1]-t[t.length-1]:0}function f0(e,t,n){let{routesMeta:s}=e,o={},a="/",l=[];for(let d=0;d<s.length;++d){let u=s[d],f=d===s.length-1,m=a==="/"?t:t.slice(a.length)||"/",g=p0({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},m),y=u.route;if(!g)return null;Object.assign(o,g.params),l.push({params:o,pathname:ui([a,g.pathname]),pathnameBase:_0(ui([a,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(a=ui([a,g.pathnameBase]))}return l}function p0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=m0(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let a=o[0],l=a.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((f,m,g)=>{let{paramName:y,isOptional:k}=m;if(y==="*"){let x=d[g]||"";l=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const v=d[g];return k&&!v?f[y]=void 0:f[y]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:e}}function m0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Fg(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,u)=>(s.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),s]}function g0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Fg(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Mu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function y0(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:o=""}=typeof e=="string"?Ds(e):e;return{pathname:n?n.startsWith("/")?n:x0(n,t):t,search:w0(s),hash:j0(o)}}function x0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function bc(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function v0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Fu(e,t){let n=v0(e);return t?n.map((s,o)=>o===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Uu(e,t,n,s){s===void 0&&(s=!1);let o;typeof e=="string"?o=Ds(e):(o=$a({},e),Nt(!o.pathname||!o.pathname.includes("?"),bc("?","pathname","search",o)),Nt(!o.pathname||!o.pathname.includes("#"),bc("#","pathname","hash",o)),Nt(!o.search||!o.search.includes("#"),bc("#","search","hash",o)));let a=e===""||o.pathname==="",l=a?"/":o.pathname,d;if(l==null)d=n;else{let g=t.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),g-=1;o.pathname=y.join("/")}d=g>=0?t[g]:"/"}let u=y0(o,d),f=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(f||m)&&(u.pathname+="/"),u}const ui=e=>e.join("/").replace(/\/\/+/g,"/"),_0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),w0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,j0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function S0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Dg=["post","put","patch","delete"];new Set(Dg);const C0=["get",...Dg];new Set(C0);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wa(){return Wa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Wa.apply(this,arguments)}const Ou=_.createContext(null),N0=_.createContext(null),yi=_.createContext(null),Ml=_.createContext(null),Fr=_.createContext({outlet:null,matches:[],isDataRoute:!1}),zg=_.createContext(null);function k0(e,t){let{relative:n}=t===void 0?{}:t;zs()||Nt(!1);let{basename:s,navigator:o}=_.useContext(yi),{hash:a,pathname:l,search:d}=Hg(e,{relative:n}),u=l;return s!=="/"&&(u=l==="/"?s:ui([s,l])),o.createHref({pathname:u,search:d,hash:a})}function zs(){return _.useContext(Ml)!=null}function xi(){return zs()||Nt(!1),_.useContext(Ml).location}function $g(e){_.useContext(yi).static||_.useLayoutEffect(e)}function rn(){let{isDataRoute:e}=_.useContext(Fr);return e?O0():b0()}function b0(){zs()||Nt(!1);let e=_.useContext(Ou),{basename:t,future:n,navigator:s}=_.useContext(yi),{matches:o}=_.useContext(Fr),{pathname:a}=xi(),l=JSON.stringify(Fu(o,n.v7_relativeSplatPath)),d=_.useRef(!1);return $g(()=>{d.current=!0}),_.useCallback(function(f,m){if(m===void 0&&(m={}),!d.current)return;if(typeof f=="number"){s.go(f);return}let g=Uu(f,JSON.parse(l),a,m.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:ui([t,g.pathname])),(m.replace?s.replace:s.push)(g,m.state,m)},[t,s,l,a,e])}function Wg(){let{matches:e}=_.useContext(Fr),t=e[e.length-1];return t?t.params:{}}function Hg(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=_.useContext(yi),{matches:o}=_.useContext(Fr),{pathname:a}=xi(),l=JSON.stringify(Fu(o,s.v7_relativeSplatPath));return _.useMemo(()=>Uu(e,JSON.parse(l),a,n==="path"),[e,l,a,n])}function I0(e,t){return L0(e,t)}function L0(e,t,n,s){zs()||Nt(!1);let{navigator:o}=_.useContext(yi),{matches:a}=_.useContext(Fr),l=a[a.length-1],d=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let f=xi(),m;if(t){var g;let C=typeof t=="string"?Ds(t):t;u==="/"||(g=C.pathname)!=null&&g.startsWith(u)||Nt(!1),m=C}else m=f;let y=m.pathname||"/",k=y;if(u!=="/"){let C=u.replace(/^\//,"").split("/");k="/"+y.replace(/^\//,"").split("/").slice(C.length).join("/")}let v=n0(e,{pathname:k}),x=R0(v&&v.map(C=>Object.assign({},C,{params:Object.assign({},d,C.params),pathname:ui([u,o.encodeLocation?o.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?u:ui([u,o.encodeLocation?o.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),a,n,s);return t&&x?_.createElement(Ml.Provider,{value:{location:Wa({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:ni.Pop}},x):x}function P0(){let e=U0(),t=S0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),n?_.createElement("pre",{style:o},n):null,null)}const E0=_.createElement(P0,null);class T0 extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?_.createElement(Fr.Provider,{value:this.props.routeContext},_.createElement(zg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function B0(e){let{routeContext:t,match:n,children:s}=e,o=_.useContext(Ou);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Fr.Provider,{value:t},s)}function R0(e,t,n,s){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=s)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,d=(o=n)==null?void 0:o.errors;if(d!=null){let m=l.findIndex(g=>g.route.id&&(d==null?void 0:d[g.route.id])!==void 0);m>=0||Nt(!1),l=l.slice(0,Math.min(l.length,m+1))}let u=!1,f=-1;if(n&&s&&s.v7_partialHydration)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:y,errors:k}=n,v=g.route.loader&&y[g.route.id]===void 0&&(!k||k[g.route.id]===void 0);if(g.route.lazy||v){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((m,g,y)=>{let k,v=!1,x=null,C=null;n&&(k=d&&g.route.id?d[g.route.id]:void 0,x=g.route.errorElement||E0,u&&(f<0&&y===0?(D0("route-fallback"),v=!0,C=null):f===y&&(v=!0,C=g.route.hydrateFallbackElement||null)));let j=t.concat(l.slice(0,y+1)),w=()=>{let N;return k?N=x:v?N=C:g.route.Component?N=_.createElement(g.route.Component,null):g.route.element?N=g.route.element:N=m,_.createElement(B0,{match:g,routeContext:{outlet:m,matches:j,isDataRoute:n!=null},children:N})};return n&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?_.createElement(T0,{location:n.location,revalidation:n.revalidation,component:x,error:k,children:w(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):w()},null)}var Zg=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Zg||{}),Vg=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Vg||{});function A0(e){let t=_.useContext(Ou);return t||Nt(!1),t}function M0(e){let t=_.useContext(N0);return t||Nt(!1),t}function F0(e){let t=_.useContext(Fr);return t||Nt(!1),t}function qg(e){let t=F0(),n=t.matches[t.matches.length-1];return n.route.id||Nt(!1),n.route.id}function U0(){var e;let t=_.useContext(zg),n=M0(),s=qg();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function O0(){let{router:e}=A0(Zg.UseNavigateStable),t=qg(Vg.UseNavigateStable),n=_.useRef(!1);return $g(()=>{n.current=!0}),_.useCallback(function(o,a){a===void 0&&(a={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,Wa({fromRouteId:t},a)))},[e,t])}const qf={};function D0(e,t,n){qf[e]||(qf[e]=!0)}function z0(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Ic(e){let{to:t,replace:n,state:s,relative:o}=e;zs()||Nt(!1);let{future:a,static:l}=_.useContext(yi),{matches:d}=_.useContext(Fr),{pathname:u}=xi(),f=rn(),m=Uu(t,Fu(d,a.v7_relativeSplatPath),u,o==="path"),g=JSON.stringify(m);return _.useEffect(()=>f(JSON.parse(g),{replace:n,state:s,relative:o}),[f,g,o,n,s]),null}function Ot(e){Nt(!1)}function $0(e){let{basename:t="/",children:n=null,location:s,navigationType:o=ni.Pop,navigator:a,static:l=!1,future:d}=e;zs()&&Nt(!1);let u=t.replace(/^\/*/,"/"),f=_.useMemo(()=>({basename:u,navigator:a,static:l,future:Wa({v7_relativeSplatPath:!1},d)}),[u,d,a,l]);typeof s=="string"&&(s=Ds(s));let{pathname:m="/",search:g="",hash:y="",state:k=null,key:v="default"}=s,x=_.useMemo(()=>{let C=Mu(m,u);return C==null?null:{location:{pathname:C,search:g,hash:y,state:k,key:v},navigationType:o}},[u,m,g,y,k,v,o]);return x==null?null:_.createElement(yi.Provider,{value:f},_.createElement(Ml.Provider,{children:n,value:x}))}function W0(e){let{children:t,location:n}=e;return I0(Ld(t),n)}new Promise(()=>{});function Ld(e,t){t===void 0&&(t=[]);let n=[];return _.Children.forEach(e,(s,o)=>{if(!_.isValidElement(s))return;let a=[...t,o];if(s.type===_.Fragment){n.push.apply(n,Ld(s.props.children,a));return}s.type!==Ot&&Nt(!1),!s.props.index||!s.props.children||Nt(!1);let l={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=Ld(s.props.children,a)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pd(){return Pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Pd.apply(this,arguments)}function H0(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,a;for(a=0;a<s.length;a++)o=s[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function Z0(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function V0(e,t){return e.button===0&&(!t||t==="_self")&&!Z0(e)}function Ed(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let s=e[n];return t.concat(Array.isArray(s)?s.map(o=>[n,o]):[[n,s]])},[]))}function q0(e,t){let n=Ed(e);return t&&t.forEach((s,o)=>{n.has(o)||t.getAll(o).forEach(a=>{n.append(o,a)})}),n}const G0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Y0="6";try{window.__reactRouterVersion=Y0}catch{}const K0="startTransition",Gf=$x[K0];function J0(e){let{basename:t,children:n,future:s,window:o}=e,a=_.useRef();a.current==null&&(a.current=X_({window:o,v5Compat:!0}));let l=a.current,[d,u]=_.useState({action:l.action,location:l.location}),{v7_startTransition:f}=s||{},m=_.useCallback(g=>{f&&Gf?Gf(()=>u(g)):u(g)},[u,f]);return _.useLayoutEffect(()=>l.listen(m),[l,m]),_.useEffect(()=>z0(s),[s]),_.createElement($0,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:l,future:s})}const Q0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",X0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lc=_.forwardRef(function(t,n){let{onClick:s,relative:o,reloadDocument:a,replace:l,state:d,target:u,to:f,preventScrollReset:m,viewTransition:g}=t,y=H0(t,G0),{basename:k}=_.useContext(yi),v,x=!1;if(typeof f=="string"&&X0.test(f)&&(v=f,Q0))try{let N=new URL(window.location.href),b=f.startsWith("//")?new URL(N.protocol+f):new URL(f),T=Mu(b.pathname,k);b.origin===N.origin&&T!=null?f=T+b.search+b.hash:x=!0}catch{}let C=k0(f,{relative:o}),j=ew(f,{replace:l,state:d,target:u,preventScrollReset:m,relative:o,viewTransition:g});function w(N){s&&s(N),N.defaultPrevented||j(N)}return _.createElement("a",Pd({},y,{href:v||C,onClick:x||a?s:w,ref:n,target:u}))});var Yf;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Yf||(Yf={}));var Kf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Kf||(Kf={}));function ew(e,t){let{target:n,replace:s,state:o,preventScrollReset:a,relative:l,viewTransition:d}=t===void 0?{}:t,u=rn(),f=xi(),m=Hg(e,{relative:l});return _.useCallback(g=>{if(V0(g,n)){g.preventDefault();let y=s!==void 0?s:xl(f)===xl(m);u(e,{replace:y,state:o,preventScrollReset:a,relative:l,viewTransition:d})}},[f,u,m,s,o,n,e,a,l,d])}function Gg(e){let t=_.useRef(Ed(e)),n=_.useRef(!1),s=xi(),o=_.useMemo(()=>q0(s.search,n.current?null:t.current),[s.search]),a=rn(),l=_.useCallback((d,u)=>{const f=Ed(typeof d=="function"?d(o):d);n.current=!0,a("?"+f,u)},[a,o]);return[o,l]}function Yg(e,t){return function(){return e.apply(t,arguments)}}const{toString:tw}=Object.prototype,{getPrototypeOf:Du}=Object,{iterator:Fl,toStringTag:Kg}=Symbol,Ul=(e=>t=>{const n=tw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Jn=e=>(e=e.toLowerCase(),t=>Ul(t)===e),Ol=e=>t=>typeof t===e,{isArray:$s}=Array,As=Ol("undefined");function Ya(e){return e!==null&&!As(e)&&e.constructor!==null&&!As(e.constructor)&&pn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Jg=Jn("ArrayBuffer");function nw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Jg(e.buffer),t}const rw=Ol("string"),pn=Ol("function"),Qg=Ol("number"),Ka=e=>e!==null&&typeof e=="object",iw=e=>e===!0||e===!1,Zo=e=>{if(Ul(e)!=="object")return!1;const t=Du(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Kg in e)&&!(Fl in e)},sw=e=>{if(!Ka(e)||Ya(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},aw=Jn("Date"),ow=Jn("File"),lw=Jn("Blob"),cw=Jn("FileList"),dw=e=>Ka(e)&&pn(e.pipe),uw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||pn(e.append)&&((t=Ul(e))==="formdata"||t==="object"&&pn(e.toString)&&e.toString()==="[object FormData]"))},hw=Jn("URLSearchParams"),[fw,pw,mw,gw]=["ReadableStream","Request","Response","Headers"].map(Jn),yw=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ja(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,o;if(typeof e!="object"&&(e=[e]),$s(e))for(s=0,o=e.length;s<o;s++)t.call(null,e[s],s,e);else{if(Ya(e))return;const a=n?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let d;for(s=0;s<l;s++)d=a[s],t.call(null,e[d],d,e)}}function Xg(e,t){if(Ya(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,o;for(;s-- >0;)if(o=n[s],t===o.toLowerCase())return o;return null}const Ii=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ey=e=>!As(e)&&e!==Ii;function Td(){const{caseless:e,skipUndefined:t}=ey(this)&&this||{},n={},s=(o,a)=>{const l=e&&Xg(n,a)||a;Zo(n[l])&&Zo(o)?n[l]=Td(n[l],o):Zo(o)?n[l]=Td({},o):$s(o)?n[l]=o.slice():(!t||!As(o))&&(n[l]=o)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&Ja(arguments[o],s);return n}const xw=(e,t,n,{allOwnKeys:s}={})=>(Ja(t,(o,a)=>{n&&pn(o)?e[a]=Yg(o,n):e[a]=o},{allOwnKeys:s}),e),vw=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),_w=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},ww=(e,t,n,s)=>{let o,a,l;const d={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)l=o[a],(!s||s(l,e,t))&&!d[l]&&(t[l]=e[l],d[l]=!0);e=n!==!1&&Du(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},jw=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},Sw=e=>{if(!e)return null;if($s(e))return e;let t=e.length;if(!Qg(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Cw=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Du(Uint8Array)),Nw=(e,t)=>{const s=(e&&e[Fl]).call(e);let o;for(;(o=s.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},kw=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},bw=Jn("HTMLFormElement"),Iw=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),Jf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Lw=Jn("RegExp"),ty=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};Ja(n,(o,a)=>{let l;(l=t(o,a,e))!==!1&&(s[a]=l||o)}),Object.defineProperties(e,s)},Pw=e=>{ty(e,(t,n)=>{if(pn(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(pn(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ew=(e,t)=>{const n={},s=o=>{o.forEach(a=>{n[a]=!0})};return $s(e)?s(e):s(String(e).split(t)),n},Tw=()=>{},Bw=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Rw(e){return!!(e&&pn(e.append)&&e[Kg]==="FormData"&&e[Fl])}const Aw=e=>{const t=new Array(10),n=(s,o)=>{if(Ka(s)){if(t.indexOf(s)>=0)return;if(Ya(s))return s;if(!("toJSON"in s)){t[o]=s;const a=$s(s)?[]:{};return Ja(s,(l,d)=>{const u=n(l,o+1);!As(u)&&(a[d]=u)}),t[o]=void 0,a}}return s};return n(e,0)},Mw=Jn("AsyncFunction"),Fw=e=>e&&(Ka(e)||pn(e))&&pn(e.then)&&pn(e.catch),ny=((e,t)=>e?setImmediate:t?((n,s)=>(Ii.addEventListener("message",({source:o,data:a})=>{o===Ii&&a===n&&s.length&&s.shift()()},!1),o=>{s.push(o),Ii.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",pn(Ii.postMessage)),Uw=typeof queueMicrotask<"u"?queueMicrotask.bind(Ii):typeof process<"u"&&process.nextTick||ny,Ow=e=>e!=null&&pn(e[Fl]),Q={isArray:$s,isArrayBuffer:Jg,isBuffer:Ya,isFormData:uw,isArrayBufferView:nw,isString:rw,isNumber:Qg,isBoolean:iw,isObject:Ka,isPlainObject:Zo,isEmptyObject:sw,isReadableStream:fw,isRequest:pw,isResponse:mw,isHeaders:gw,isUndefined:As,isDate:aw,isFile:ow,isBlob:lw,isRegExp:Lw,isFunction:pn,isStream:dw,isURLSearchParams:hw,isTypedArray:Cw,isFileList:cw,forEach:Ja,merge:Td,extend:xw,trim:yw,stripBOM:vw,inherits:_w,toFlatObject:ww,kindOf:Ul,kindOfTest:Jn,endsWith:jw,toArray:Sw,forEachEntry:Nw,matchAll:kw,isHTMLForm:bw,hasOwnProperty:Jf,hasOwnProp:Jf,reduceDescriptors:ty,freezeMethods:Pw,toObjectSet:Ew,toCamelCase:Iw,noop:Tw,toFiniteNumber:Bw,findKey:Xg,global:Ii,isContextDefined:ey,isSpecCompliantForm:Rw,toJSONObject:Aw,isAsyncFn:Mw,isThenable:Fw,setImmediate:ny,asap:Uw,isIterable:Ow};function He(e,t,n,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}Q.inherits(He,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Q.toJSONObject(this.config),code:this.code,status:this.status}}});const ry=He.prototype,iy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{iy[e]={value:e}});Object.defineProperties(He,iy);Object.defineProperty(ry,"isAxiosError",{value:!0});He.from=(e,t,n,s,o,a)=>{const l=Object.create(ry);Q.toFlatObject(e,l,function(m){return m!==Error.prototype},f=>f!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=t==null&&e?e.code:t;return He.call(l,d,u,n,s,o),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",a&&Object.assign(l,a),l};const Dw=null;function Bd(e){return Q.isPlainObject(e)||Q.isArray(e)}function sy(e){return Q.endsWith(e,"[]")?e.slice(0,-2):e}function Qf(e,t,n){return e?e.concat(t).map(function(o,a){return o=sy(o),!n&&a?"["+o+"]":o}).join(n?".":""):t}function zw(e){return Q.isArray(e)&&!e.some(Bd)}const $w=Q.toFlatObject(Q,{},null,function(t){return/^is[A-Z]/.test(t)});function Dl(e,t,n){if(!Q.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Q.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,C){return!Q.isUndefined(C[x])});const s=n.metaTokens,o=n.visitor||m,a=n.dots,l=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&Q.isSpecCompliantForm(t);if(!Q.isFunction(o))throw new TypeError("visitor must be a function");function f(v){if(v===null)return"";if(Q.isDate(v))return v.toISOString();if(Q.isBoolean(v))return v.toString();if(!u&&Q.isBlob(v))throw new He("Blob is not supported. Use a Buffer instead.");return Q.isArrayBuffer(v)||Q.isTypedArray(v)?u&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function m(v,x,C){let j=v;if(v&&!C&&typeof v=="object"){if(Q.endsWith(x,"{}"))x=s?x:x.slice(0,-2),v=JSON.stringify(v);else if(Q.isArray(v)&&zw(v)||(Q.isFileList(v)||Q.endsWith(x,"[]"))&&(j=Q.toArray(v)))return x=sy(x),j.forEach(function(N,b){!(Q.isUndefined(N)||N===null)&&t.append(l===!0?Qf([x],b,a):l===null?x:x+"[]",f(N))}),!1}return Bd(v)?!0:(t.append(Qf(C,x,a),f(v)),!1)}const g=[],y=Object.assign($w,{defaultVisitor:m,convertValue:f,isVisitable:Bd});function k(v,x){if(!Q.isUndefined(v)){if(g.indexOf(v)!==-1)throw Error("Circular reference detected in "+x.join("."));g.push(v),Q.forEach(v,function(j,w){(!(Q.isUndefined(j)||j===null)&&o.call(t,j,Q.isString(w)?w.trim():w,x,y))===!0&&k(j,x?x.concat(w):[w])}),g.pop()}}if(!Q.isObject(e))throw new TypeError("data must be an object");return k(e),t}function Xf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function zu(e,t){this._pairs=[],e&&Dl(e,this,t)}const ay=zu.prototype;ay.append=function(t,n){this._pairs.push([t,n])};ay.toString=function(t){const n=t?function(s){return t.call(this,s,Xf)}:Xf;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function Ww(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function oy(e,t,n){if(!t)return e;const s=n&&n.encode||Ww;Q.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(t,n):a=Q.isURLSearchParams(t)?t.toString():new zu(t,n).toString(s),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class ep{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Q.forEach(this.handlers,function(s){s!==null&&t(s)})}}const ly={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Hw=typeof URLSearchParams<"u"?URLSearchParams:zu,Zw=typeof FormData<"u"?FormData:null,Vw=typeof Blob<"u"?Blob:null,qw={isBrowser:!0,classes:{URLSearchParams:Hw,FormData:Zw,Blob:Vw},protocols:["http","https","file","blob","url","data"]},$u=typeof window<"u"&&typeof document<"u",Rd=typeof navigator=="object"&&navigator||void 0,Gw=$u&&(!Rd||["ReactNative","NativeScript","NS"].indexOf(Rd.product)<0),Yw=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Kw=$u&&window.location.href||"http://localhost",Jw=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$u,hasStandardBrowserEnv:Gw,hasStandardBrowserWebWorkerEnv:Yw,navigator:Rd,origin:Kw},Symbol.toStringTag,{value:"Module"})),Gt={...Jw,...qw};function Qw(e,t){return Dl(e,new Gt.classes.URLSearchParams,{visitor:function(n,s,o,a){return Gt.isNode&&Q.isBuffer(n)?(this.append(s,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function Xw(e){return Q.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ej(e){const t={},n=Object.keys(e);let s;const o=n.length;let a;for(s=0;s<o;s++)a=n[s],t[a]=e[a];return t}function cy(e){function t(n,s,o,a){let l=n[a++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),u=a>=n.length;return l=!l&&Q.isArray(o)?o.length:l,u?(Q.hasOwnProp(o,l)?o[l]=[o[l],s]:o[l]=s,!d):((!o[l]||!Q.isObject(o[l]))&&(o[l]=[]),t(n,s,o[l],a)&&Q.isArray(o[l])&&(o[l]=ej(o[l])),!d)}if(Q.isFormData(e)&&Q.isFunction(e.entries)){const n={};return Q.forEachEntry(e,(s,o)=>{t(Xw(s),o,n,0)}),n}return null}function tj(e,t,n){if(Q.isString(e))try{return(t||JSON.parse)(e),Q.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const Qa={transitional:ly,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,a=Q.isObject(t);if(a&&Q.isHTMLForm(t)&&(t=new FormData(t)),Q.isFormData(t))return o?JSON.stringify(cy(t)):t;if(Q.isArrayBuffer(t)||Q.isBuffer(t)||Q.isStream(t)||Q.isFile(t)||Q.isBlob(t)||Q.isReadableStream(t))return t;if(Q.isArrayBufferView(t))return t.buffer;if(Q.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Qw(t,this.formSerializer).toString();if((d=Q.isFileList(t))||s.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Dl(d?{"files[]":t}:t,u&&new u,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),tj(t)):t}],transformResponse:[function(t){const n=this.transitional||Qa.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(Q.isResponse(t)||Q.isReadableStream(t))return t;if(t&&Q.isString(t)&&(s&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(d){if(l)throw d.name==="SyntaxError"?He.from(d,He.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Gt.classes.FormData,Blob:Gt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Q.forEach(["delete","get","head","post","put","patch"],e=>{Qa.headers[e]={}});const nj=Q.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),rj=e=>{const t={};let n,s,o;return e&&e.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),s=l.substring(o+1).trim(),!(!n||t[n]&&nj[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},tp=Symbol("internals");function da(e){return e&&String(e).trim().toLowerCase()}function Vo(e){return e===!1||e==null?e:Q.isArray(e)?e.map(Vo):String(e)}function ij(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const sj=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Pc(e,t,n,s,o){if(Q.isFunction(s))return s.call(this,t,n);if(o&&(t=n),!!Q.isString(t)){if(Q.isString(s))return t.indexOf(s)!==-1;if(Q.isRegExp(s))return s.test(t)}}function aj(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function oj(e,t){const n=Q.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(o,a,l){return this[s].call(this,t,o,a,l)},configurable:!0})})}let mn=class{constructor(t){t&&this.set(t)}set(t,n,s){const o=this;function a(d,u,f){const m=da(u);if(!m)throw new Error("header name must be a non-empty string");const g=Q.findKey(o,m);(!g||o[g]===void 0||f===!0||f===void 0&&o[g]!==!1)&&(o[g||u]=Vo(d))}const l=(d,u)=>Q.forEach(d,(f,m)=>a(f,m,u));if(Q.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(Q.isString(t)&&(t=t.trim())&&!sj(t))l(rj(t),n);else if(Q.isObject(t)&&Q.isIterable(t)){let d={},u,f;for(const m of t){if(!Q.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[f=m[0]]=(u=d[f])?Q.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}l(d,n)}else t!=null&&a(n,t,s);return this}get(t,n){if(t=da(t),t){const s=Q.findKey(this,t);if(s){const o=this[s];if(!n)return o;if(n===!0)return ij(o);if(Q.isFunction(n))return n.call(this,o,s);if(Q.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=da(t),t){const s=Q.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||Pc(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let o=!1;function a(l){if(l=da(l),l){const d=Q.findKey(s,l);d&&(!n||Pc(s,s[d],d,n))&&(delete s[d],o=!0)}}return Q.isArray(t)?t.forEach(a):a(t),o}clear(t){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const a=n[s];(!t||Pc(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const n=this,s={};return Q.forEach(this,(o,a)=>{const l=Q.findKey(s,a);if(l){n[l]=Vo(o),delete n[a];return}const d=t?aj(a):String(a).trim();d!==a&&delete n[a],n[d]=Vo(o),s[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Q.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=t&&Q.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(o=>s.set(o)),s}static accessor(t){const s=(this[tp]=this[tp]={accessors:{}}).accessors,o=this.prototype;function a(l){const d=da(l);s[d]||(oj(o,l),s[d]=!0)}return Q.isArray(t)?t.forEach(a):a(t),this}};mn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Q.reduceDescriptors(mn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});Q.freezeMethods(mn);function Ec(e,t){const n=this||Qa,s=t||n,o=mn.from(s.headers);let a=s.data;return Q.forEach(e,function(d){a=d.call(n,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function dy(e){return!!(e&&e.__CANCEL__)}function Ws(e,t,n){He.call(this,e??"canceled",He.ERR_CANCELED,t,n),this.name="CanceledError"}Q.inherits(Ws,He,{__CANCEL__:!0});function uy(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new He("Request failed with status code "+n.status,[He.ERR_BAD_REQUEST,He.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function lj(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function cj(e,t){e=e||10;const n=new Array(e),s=new Array(e);let o=0,a=0,l;return t=t!==void 0?t:1e3,function(u){const f=Date.now(),m=s[a];l||(l=f),n[o]=u,s[o]=f;let g=a,y=0;for(;g!==o;)y+=n[g++],g=g%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),f-l<t)return;const k=m&&f-m;return k?Math.round(y*1e3/k):void 0}}function dj(e,t){let n=0,s=1e3/t,o,a;const l=(f,m=Date.now())=>{n=m,o=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const m=Date.now(),g=m-n;g>=s?l(f,m):(o=f,a||(a=setTimeout(()=>{a=null,l(o)},s-g)))},()=>o&&l(o)]}const vl=(e,t,n=3)=>{let s=0;const o=cj(50,250);return dj(a=>{const l=a.loaded,d=a.lengthComputable?a.total:void 0,u=l-s,f=o(u),m=l<=d;s=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:u,rate:f||void 0,estimated:f&&d&&m?(d-l)/f:void 0,event:a,lengthComputable:d!=null,[t?"download":"upload"]:!0};e(g)},n)},np=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},rp=e=>(...t)=>Q.asap(()=>e(...t)),uj=Gt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Gt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Gt.origin),Gt.navigator&&/(msie|trident)/i.test(Gt.navigator.userAgent)):()=>!0,hj=Gt.hasStandardBrowserEnv?{write(e,t,n,s,o,a){const l=[e+"="+encodeURIComponent(t)];Q.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),Q.isString(s)&&l.push("path="+s),Q.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function fj(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function pj(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function hy(e,t,n){let s=!fj(t);return e&&(s||n==!1)?pj(e,t):t}const ip=e=>e instanceof mn?{...e}:e;function Fi(e,t){t=t||{};const n={};function s(f,m,g,y){return Q.isPlainObject(f)&&Q.isPlainObject(m)?Q.merge.call({caseless:y},f,m):Q.isPlainObject(m)?Q.merge({},m):Q.isArray(m)?m.slice():m}function o(f,m,g,y){if(Q.isUndefined(m)){if(!Q.isUndefined(f))return s(void 0,f,g,y)}else return s(f,m,g,y)}function a(f,m){if(!Q.isUndefined(m))return s(void 0,m)}function l(f,m){if(Q.isUndefined(m)){if(!Q.isUndefined(f))return s(void 0,f)}else return s(void 0,m)}function d(f,m,g){if(g in t)return s(f,m);if(g in e)return s(void 0,f)}const u={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(f,m,g)=>o(ip(f),ip(m),g,!0)};return Q.forEach(Object.keys({...e,...t}),function(m){const g=u[m]||o,y=g(e[m],t[m],m);Q.isUndefined(y)&&g!==d||(n[m]=y)}),n}const fy=e=>{const t=Fi({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:a,headers:l,auth:d}=t;if(t.headers=l=mn.from(l),t.url=oy(hy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),Q.isFormData(n)){if(Gt.hasStandardBrowserEnv||Gt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Q.isFunction(n.getHeaders)){const u=n.getHeaders(),f=["content-type","content-length"];Object.entries(u).forEach(([m,g])=>{f.includes(m.toLowerCase())&&l.set(m,g)})}}if(Gt.hasStandardBrowserEnv&&(s&&Q.isFunction(s)&&(s=s(t)),s||s!==!1&&uj(t.url))){const u=o&&a&&hj.read(a);u&&l.set(o,u)}return t},mj=typeof XMLHttpRequest<"u",gj=mj&&function(e){return new Promise(function(n,s){const o=fy(e);let a=o.data;const l=mn.from(o.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:f}=o,m,g,y,k,v;function x(){k&&k(),v&&v(),o.cancelToken&&o.cancelToken.unsubscribe(m),o.signal&&o.signal.removeEventListener("abort",m)}let C=new XMLHttpRequest;C.open(o.method.toUpperCase(),o.url,!0),C.timeout=o.timeout;function j(){if(!C)return;const N=mn.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),T={data:!d||d==="text"||d==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:N,config:e,request:C};uy(function(R){n(R),x()},function(R){s(R),x()},T),C=null}"onloadend"in C?C.onloadend=j:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(j)},C.onabort=function(){C&&(s(new He("Request aborted",He.ECONNABORTED,e,C)),C=null)},C.onerror=function(b){const T=b&&b.message?b.message:"Network Error",I=new He(T,He.ERR_NETWORK,e,C);I.event=b||null,s(I),C=null},C.ontimeout=function(){let b=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const T=o.transitional||ly;o.timeoutErrorMessage&&(b=o.timeoutErrorMessage),s(new He(b,T.clarifyTimeoutError?He.ETIMEDOUT:He.ECONNABORTED,e,C)),C=null},a===void 0&&l.setContentType(null),"setRequestHeader"in C&&Q.forEach(l.toJSON(),function(b,T){C.setRequestHeader(T,b)}),Q.isUndefined(o.withCredentials)||(C.withCredentials=!!o.withCredentials),d&&d!=="json"&&(C.responseType=o.responseType),f&&([y,v]=vl(f,!0),C.addEventListener("progress",y)),u&&C.upload&&([g,k]=vl(u),C.upload.addEventListener("progress",g),C.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(m=N=>{C&&(s(!N||N.type?new Ws(null,e,C):N),C.abort(),C=null)},o.cancelToken&&o.cancelToken.subscribe(m),o.signal&&(o.signal.aborted?m():o.signal.addEventListener("abort",m)));const w=lj(o.url);if(w&&Gt.protocols.indexOf(w)===-1){s(new He("Unsupported protocol "+w+":",He.ERR_BAD_REQUEST,e));return}C.send(a||null)})},yj=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,o;const a=function(f){if(!o){o=!0,d();const m=f instanceof Error?f:this.reason;s.abort(m instanceof He?m:new Ws(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,a(new He(`timeout ${t} of ms exceeded`,He.ETIMEDOUT))},t);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:u}=s;return u.unsubscribe=()=>Q.asap(d),u}},xj=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,o;for(;s<n;)o=s+t,yield e.slice(s,o),s=o},vj=async function*(e,t){for await(const n of _j(e))yield*xj(n,t)},_j=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},sp=(e,t,n,s)=>{const o=vj(e,t);let a=0,l,d=u=>{l||(l=!0,s&&s(u))};return new ReadableStream({async pull(u){try{const{done:f,value:m}=await o.next();if(f){d(),u.close();return}let g=m.byteLength;if(n){let y=a+=g;n(y)}u.enqueue(new Uint8Array(m))}catch(f){throw d(f),f}},cancel(u){return d(u),o.return()}},{highWaterMark:2})},ap=64*1024,{isFunction:Eo}=Q,wj=(({Request:e,Response:t})=>({Request:e,Response:t}))(Q.global),{ReadableStream:op,TextEncoder:lp}=Q.global,cp=(e,...t)=>{try{return!!e(...t)}catch{return!1}},jj=e=>{e=Q.merge.call({skipUndefined:!0},wj,e);const{fetch:t,Request:n,Response:s}=e,o=t?Eo(t):typeof fetch=="function",a=Eo(n),l=Eo(s);if(!o)return!1;const d=o&&Eo(op),u=o&&(typeof lp=="function"?(v=>x=>v.encode(x))(new lp):async v=>new Uint8Array(await new n(v).arrayBuffer())),f=a&&d&&cp(()=>{let v=!1;const x=new n(Gt.origin,{body:new op,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!x}),m=l&&d&&cp(()=>Q.isReadableStream(new s("").body)),g={stream:m&&(v=>v.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!g[v]&&(g[v]=(x,C)=>{let j=x&&x[v];if(j)return j.call(x);throw new He(`Response type '${v}' is not supported`,He.ERR_NOT_SUPPORT,C)})});const y=async v=>{if(v==null)return 0;if(Q.isBlob(v))return v.size;if(Q.isSpecCompliantForm(v))return(await new n(Gt.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(Q.isArrayBufferView(v)||Q.isArrayBuffer(v))return v.byteLength;if(Q.isURLSearchParams(v)&&(v=v+""),Q.isString(v))return(await u(v)).byteLength},k=async(v,x)=>{const C=Q.toFiniteNumber(v.getContentLength());return C??y(x)};return async v=>{let{url:x,method:C,data:j,signal:w,cancelToken:N,timeout:b,onDownloadProgress:T,onUploadProgress:I,responseType:R,headers:B,withCredentials:A="same-origin",fetchOptions:E}=fy(v),M=t||fetch;R=R?(R+"").toLowerCase():"text";let G=yj([w,N&&N.toAbortSignal()],b),Y=null;const z=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let X;try{if(I&&f&&C!=="get"&&C!=="head"&&(X=await k(B,j))!==0){let fe=new n(x,{method:"POST",body:j,duplex:"half"}),_e;if(Q.isFormData(j)&&(_e=fe.headers.get("content-type"))&&B.setContentType(_e),fe.body){const[se,O]=np(X,vl(rp(I)));j=sp(fe.body,ap,se,O)}}Q.isString(A)||(A=A?"include":"omit");const K=a&&"credentials"in n.prototype,F={...E,signal:G,method:C.toUpperCase(),headers:B.normalize().toJSON(),body:j,duplex:"half",credentials:K?A:void 0};Y=a&&new n(x,F);let $=await(a?M(Y,E):M(x,F));const ge=m&&(R==="stream"||R==="response");if(m&&(T||ge&&z)){const fe={};["status","statusText","headers"].forEach(ne=>{fe[ne]=$[ne]});const _e=Q.toFiniteNumber($.headers.get("content-length")),[se,O]=T&&np(_e,vl(rp(T),!0))||[];$=new s(sp($.body,ap,se,()=>{O&&O(),z&&z()}),fe)}R=R||"text";let re=await g[Q.findKey(g,R)||"text"]($,v);return!ge&&z&&z(),await new Promise((fe,_e)=>{uy(fe,_e,{data:re,headers:mn.from($.headers),status:$.status,statusText:$.statusText,config:v,request:Y})})}catch(K){throw z&&z(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new He("Network Error",He.ERR_NETWORK,v,Y),{cause:K.cause||K}):He.from(K,K&&K.code,v,Y)}}},Sj=new Map,py=e=>{let t=e?e.env:{};const{fetch:n,Request:s,Response:o}=t,a=[s,o,n];let l=a.length,d=l,u,f,m=Sj;for(;d--;)u=a[d],f=m.get(u),f===void 0&&m.set(u,f=d?new Map:jj(t)),m=f;return f};py();const Ad={http:Dw,xhr:gj,fetch:{get:py}};Q.forEach(Ad,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const dp=e=>`- ${e}`,Cj=e=>Q.isFunction(e)||e===null||e===!1,my={getAdapter:(e,t)=>{e=Q.isArray(e)?e:[e];const{length:n}=e;let s,o;const a={};for(let l=0;l<n;l++){s=e[l];let d;if(o=s,!Cj(s)&&(o=Ad[(d=String(s)).toLowerCase()],o===void 0))throw new He(`Unknown adapter '${d}'`);if(o&&(Q.isFunction(o)||(o=o.get(t))))break;a[d||"#"+l]=o}if(!o){const l=Object.entries(a).map(([u,f])=>`adapter ${u} `+(f===!1?"is not supported by the environment":"is not available in the build"));let d=n?l.length>1?`since :
`+l.map(dp).join(`
`):" "+dp(l[0]):"as no adapter specified";throw new He("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return o},adapters:Ad};function Tc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ws(null,e)}function up(e){return Tc(e),e.headers=mn.from(e.headers),e.data=Ec.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),my.getAdapter(e.adapter||Qa.adapter,e)(e).then(function(s){return Tc(e),s.data=Ec.call(e,e.transformResponse,s),s.headers=mn.from(s.headers),s},function(s){return dy(s)||(Tc(e),s&&s.response&&(s.response.data=Ec.call(e,e.transformResponse,s.response),s.response.headers=mn.from(s.response.headers))),Promise.reject(s)})}const gy="1.12.2",zl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{zl[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const hp={};zl.transitional=function(t,n,s){function o(a,l){return"[Axios v"+gy+"] Transitional option '"+a+"'"+l+(s?". "+s:"")}return(a,l,d)=>{if(t===!1)throw new He(o(l," has been removed"+(n?" in "+n:"")),He.ERR_DEPRECATED);return n&&!hp[l]&&(hp[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,l,d):!0}};zl.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Nj(e,t,n){if(typeof e!="object")throw new He("options must be an object",He.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let o=s.length;for(;o-- >0;){const a=s[o],l=t[a];if(l){const d=e[a],u=d===void 0||l(d,a,e);if(u!==!0)throw new He("option "+a+" must be "+u,He.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new He("Unknown option "+a,He.ERR_BAD_OPTION)}}const qo={assertOptions:Nj,validators:zl},dr=qo.validators;let Ei=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ep,response:new ep}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?a&&!String(s.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+a):s.stack=a}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Fi(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:a}=n;s!==void 0&&qo.assertOptions(s,{silentJSONParsing:dr.transitional(dr.boolean),forcedJSONParsing:dr.transitional(dr.boolean),clarifyTimeoutError:dr.transitional(dr.boolean)},!1),o!=null&&(Q.isFunction(o)?n.paramsSerializer={serialize:o}:qo.assertOptions(o,{encode:dr.function,serialize:dr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),qo.assertOptions(n,{baseUrl:dr.spelling("baseURL"),withXsrfToken:dr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=a&&Q.merge(a.common,a[n.method]);a&&Q.forEach(["delete","get","head","post","put","patch","common"],v=>{delete a[v]}),n.headers=mn.concat(l,a);const d=[];let u=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(n)===!1||(u=u&&x.synchronous,d.unshift(x.fulfilled,x.rejected))});const f=[];this.interceptors.response.forEach(function(x){f.push(x.fulfilled,x.rejected)});let m,g=0,y;if(!u){const v=[up.bind(this),void 0];for(v.unshift(...d),v.push(...f),y=v.length,m=Promise.resolve(n);g<y;)m=m.then(v[g++],v[g++]);return m}y=d.length;let k=n;for(;g<y;){const v=d[g++],x=d[g++];try{k=v(k)}catch(C){x.call(this,C);break}}try{m=up.call(this,k)}catch(v){return Promise.reject(v)}for(g=0,y=f.length;g<y;)m=m.then(f[g++],f[g++]);return m}getUri(t){t=Fi(this.defaults,t);const n=hy(t.baseURL,t.url,t.allowAbsoluteUrls);return oy(n,t.params,t.paramsSerializer)}};Q.forEach(["delete","get","head","options"],function(t){Ei.prototype[t]=function(n,s){return this.request(Fi(s||{},{method:t,url:n,data:(s||{}).data}))}});Q.forEach(["post","put","patch"],function(t){function n(s){return function(a,l,d){return this.request(Fi(d||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Ei.prototype[t]=n(),Ei.prototype[t+"Form"]=n(!0)});let kj=class yy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(o=>{if(!s._listeners)return;let a=s._listeners.length;for(;a-- >0;)s._listeners[a](o);s._listeners=null}),this.promise.then=o=>{let a;const l=new Promise(d=>{s.subscribe(d),a=d}).then(o);return l.cancel=function(){s.unsubscribe(a)},l},t(function(a,l,d){s.reason||(s.reason=new Ws(a,l,d),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new yy(function(o){t=o}),cancel:t}}};function bj(e){return function(n){return e.apply(null,n)}}function Ij(e){return Q.isObject(e)&&e.isAxiosError===!0}const Md={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Md).forEach(([e,t])=>{Md[t]=e});function xy(e){const t=new Ei(e),n=Yg(Ei.prototype.request,t);return Q.extend(n,Ei.prototype,t,{allOwnKeys:!0}),Q.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return xy(Fi(e,o))},n}const xt=xy(Qa);xt.Axios=Ei;xt.CanceledError=Ws;xt.CancelToken=kj;xt.isCancel=dy;xt.VERSION=gy;xt.toFormData=Dl;xt.AxiosError=He;xt.Cancel=xt.CanceledError;xt.all=function(t){return Promise.all(t)};xt.spread=bj;xt.isAxiosError=Ij;xt.mergeConfig=Fi;xt.AxiosHeaders=mn;xt.formToJSON=e=>cy(Q.isHTMLForm(e)?new FormData(e):e);xt.getAdapter=my.getAdapter;xt.HttpStatusCode=Md;xt.default=xt;const{Axios:V1,AxiosError:q1,CanceledError:G1,isCancel:Y1,CancelToken:K1,VERSION:J1,all:Q1,Cancel:X1,isAxiosError:eC,spread:tC,toFormData:nC,AxiosHeaders:rC,HttpStatusCode:iC,formToJSON:sC,getAdapter:aC,mergeConfig:oC}=xt,Di="http://localhost:5054/api",te=xt.create({baseURL:Di,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});te.interceptors.request.use(e=>{try{const t=localStorage.getItem("token");t&&t!=="null"&&(e.headers.Authorization=`Bearer ${t}`)}catch{}return e},e=>Promise.reject(e));let To=!1,Fd=[];const fp=(e,t=null)=>{Fd.forEach(n=>{e?n.reject(e):n.resolve(t)}),Fd=[]};te.interceptors.response.use(e=>e,async e=>{var n,s,o,a,l,d,u,f;const t=e.config;if(((n=e.response)==null?void 0:n.status)===401&&!t._retry){if(To)return new Promise((m,g)=>{Fd.push({resolve:m,reject:g})}).then(m=>(t.headers.Authorization=`Bearer ${m}`,te(t))).catch(m=>Promise.reject(m));t._retry=!0,To=!0;try{console.log(" Token expired, refreshing...");const m=localStorage.getItem("refreshToken");if(!m)throw new Error("No refresh token available");const g=await xt.post(`${Di}/Auth/Refresh-Token`,{refreshToken:m}),y=((o=(s=g.data)==null?void 0:s.data)==null?void 0:o.token)||((a=g.data)==null?void 0:a.token)||((l=g.data)==null?void 0:l.accessToken),k=((u=(d=g.data)==null?void 0:d.data)==null?void 0:u.refreshToken)||((f=g.data)==null?void 0:f.refreshToken);if(y)return console.log(" Token refreshed successfully"),localStorage.setItem("token",y),k&&localStorage.setItem("refreshToken",k),t.headers.Authorization=`Bearer ${y}`,fp(null,y),To=!1,te(t);throw new Error("No token in refresh response")}catch(m){return console.error(" Token refresh failed:",m),fp(m,null),To=!1,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),window.location.href="/",Promise.reject(m)}}return Promise.reject(e)});const Er=e=>{if(!e)return{};try{const t=e.split(".");if(t.length<2)return{};const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(n).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch(t){return console.warn("decodeJwt failed",t),{}}},yt={register:async({fullName:e,email:t,phoneNumber:n,password:s})=>{const o={FullName:e,Email:t,PhoneNumber:n,Password:s,ConfirmPassword:s};return(await te.post("/Auth/Register",o)).data},login:async(e,t)=>{var n,s,o,a,l,d,u,f,m,g;try{const y=await te.post("/Auth/Login",{Email:e,Password:t}),k=((n=y.data)==null?void 0:n.data)||y.data||{},v=k.token||k.accessToken||((s=y.data)==null?void 0:s.token),x=k.refreshToken||((o=y.data)==null?void 0:o.refreshToken);if(v){localStorage.setItem("token",v);try{const C=Er(v),j=C["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||C.nameidentifier||C.UserId||C.userId||C.uid||C.nameid||C.sub||C.id||C.Id;j&&localStorage.setItem("userId",j);const w=C["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]||C.role||C.Role;w&&localStorage.setItem("userRole",w)}catch(C){console.error(" Error decoding JWT in authApi.login:",C)}}x&&localStorage.setItem("refreshToken",x),k.user&&localStorage.setItem("user",JSON.stringify(k.user)),(a=k.user)!=null&&a.email?localStorage.setItem("userEmail",k.user.email):e&&localStorage.setItem("userEmail",e);try{const C=localStorage.getItem("userRole");if(C&&(C.includes("Staff")||C.includes("staff")||C==="StationManager"||C.includes("Manager"))){const w=await yt.getMyProfile(),N=(w==null?void 0:w.stationId)||(w==null?void 0:w.StationId);N&&localStorage.setItem("stationId",N)}}catch(C){console.warn(" Could not fetch staff profile after login:",C)}return{raw:y.data,token:v,refreshToken:x,payload:k}}catch(y){const k=((d=(l=y.response)==null?void 0:l.data)==null?void 0:d.message)||((u=y.response)!=null&&u.data&&typeof y.response.data=="string"?y.response.data:null)||((m=(f=y.response)==null?void 0:f.data)==null?void 0:m.errors)&&Object.values(y.response.data.errors).flat().join("; ")||y.message||"Login failed",v=new Error(k);throw v.status=(g=y.response)==null?void 0:g.status,v}},logout:async()=>{const e=await te.post("/Auth/Logout");return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("userId"),localStorage.removeItem("userRole"),localStorage.removeItem("stationId"),e.data},refreshToken:async()=>{var s,o,a,l,d,u,f;const e=await te.post("/Auth/Refresh-Token"),t=((o=(s=e.data)==null?void 0:s.data)==null?void 0:o.token)||((a=e.data)==null?void 0:a.token)||((l=e.data)==null?void 0:l.accessToken),n=((u=(d=e.data)==null?void 0:d.data)==null?void 0:u.refreshToken)||((f=e.data)==null?void 0:f.refreshToken);return t&&localStorage.setItem("token",t),n&&localStorage.setItem("refreshToken",n),e.data},uploadCCCD:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await te.post("/Auth/cccd",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},uploadGPLX:async(e,t)=>{const n=new FormData;return e&&n.append("fileFront",e,e.name),t&&n.append("fileBack",t,t.name),(await te.post("/Auth/gplx",n,{headers:{"Content-Type":void 0},timeout:3e4})).data},getMe:async()=>{var t;const e=await te.get("/Auth/Me");return((t=e.data)==null?void 0:t.data)||e.data||{}},getMyProfile:async()=>{var t;const e=await te.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},getUserById:async e=>{var t,n;try{const s=await te.get(`/Users/Get-By-${encodeURIComponent(e)}`);return((t=s.data)==null?void 0:t.data)||s.data||{}}catch{try{const o=await te.get(`/Users/${encodeURIComponent(e)}`);return((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error("authApi.getUserById failed:",o),o}}}};function Ur({isOpen:e,type:t="info",title:n,message:s,onClose:o,actionLabel:a="OK",onAction:l,autoCloseMs:d=null}){if(mr.useEffect(()=>{if(!e||!d)return;const m=setTimeout(o,d);return()=>clearTimeout(m)},[e,d,o]),!e)return null;const u=()=>{l&&l(),o()},f={success:"",error:"",info:"",warning:""}[t]||"";return r.jsx("div",{className:`notification-backdrop notification-${t}`,children:r.jsxs("div",{className:`notification-modal notification-${t}`,children:[r.jsxs("div",{className:"notification-header",children:[r.jsx("span",{className:"notification-icon",children:f}),r.jsx("h3",{className:"notification-title",children:n}),r.jsx("button",{className:"notification-close",onClick:o,children:""})]}),r.jsx("div",{className:"notification-body",children:Array.isArray(s)?r.jsx("ul",{children:s.map((m,g)=>r.jsx("li",{children:m},g))}):r.jsx("p",{children:s})}),r.jsxs("div",{className:"notification-footer",children:[r.jsx("button",{className:"btn-close",onClick:o,children:"Close"}),l&&r.jsx("button",{className:`btn-action btn-${t}`,onClick:u,children:a})]})]})})}function vy({documents:e,setDocuments:t,onDocumentUploadSuccess:n}){const[s,o]=_.useState({cccdFront:null,cccdBack:null,licenseFront:null,licenseBack:null}),[a,l]=_.useState({}),[d,u]=_.useState({isOpen:!1,type:"info",title:"",message:""}),f=(y,k)=>{if(!k)return;if(!k.type.startsWith("image/")){u({isOpen:!0,type:"error",title:"Invalid File Type",message:"Please select an image file (JPG, PNG, etc.)"});return}if(k.size>25*1024*1024){u({isOpen:!0,type:"error",title:"File Too Large",message:"Please select a file smaller than 25MB"});return}const v=new FileReader;v.onload=x=>{const C=x.target.result;t(j=>({...j,[y]:C}))},v.readAsDataURL(k),o(x=>({...x,[y]:k}))},m=async()=>{var v,x;const y=s.cccdFront,k=s.cccdBack;if(!y&&!k){u({isOpen:!0,type:"error",title:"No Files Selected",message:"Please select at least one CCCD image"});return}l(C=>({...C,cccdFront:!0,cccdBack:!0}));try{await yt.uploadCCCD(y,k);const j=await yt.getMe()||{};t(w=>({...w,cccdFront:j.cccdImageUrl_Front||"",cccdBack:j.cccdImageUrl_Back||""})),o(w=>({...w,cccdFront:null,cccdBack:null})),u({isOpen:!0,type:"success",title:"Upload Successful",message:" CCCD uploaded successfully!",autoCloseMs:2e3}),n&&n()}catch(C){u({isOpen:!0,type:"error",title:"Upload Failed",message:((x=(v=C.response)==null?void 0:v.data)==null?void 0:x.message)||"Failed to upload CCCD"})}finally{l(C=>({...C,cccdFront:!1,cccdBack:!1}))}},g=async()=>{var v,x;const y=s.licenseFront,k=s.licenseBack;if(!y&&!k){u({isOpen:!0,type:"error",title:"No Files Selected",message:"Please select at least one driver license image"});return}l(C=>({...C,licenseFront:!0,licenseBack:!0}));try{await yt.uploadGPLX(y,k);const j=await yt.getMe()||{};t(w=>({...w,licenseFront:j.gplxImageUrl_Front||"",licenseBack:j.gplxImageUrl_Back||""})),o(w=>({...w,licenseFront:null,licenseBack:null})),u({isOpen:!0,type:"success",title:"Upload Successful",message:" Driver License uploaded successfully!",autoCloseMs:2e3}),n&&n()}catch(C){u({isOpen:!0,type:"error",title:"Upload Failed",message:((x=(v=C.response)==null?void 0:v.data)==null?void 0:x.message)||"Failed to upload driver license"})}finally{l(C=>({...C,licenseFront:!1,licenseBack:!1}))}};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"document-upload-section",children:[r.jsx("h2",{className:"document-upload-title",children:" Upload Documents"}),r.jsx("p",{className:"document-upload-description",children:"Upload clear images of your ID card and driver license (both sides)"}),r.jsxs("div",{className:"document-upload-subsection",children:[r.jsx("h3",{children:"ID Card (CCCD)"}),r.jsxs("div",{className:"documents-grid",children:[r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"ID Card (Front)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("cccdFront-input").click(),children:[e.cccdFront&&e.cccdFront.trim()?r.jsx("img",{src:e.cccdFront,alt:"CCCD Front",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card"}),r.jsx("span",{children:"Click to select"})]}),a.cccdFront&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"cccdFront-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("cccdFront",(k=y.target.files)==null?void 0:k[0])}})]}),r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"ID Card (Back)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("cccdBack-input").click(),children:[e.cccdBack&&e.cccdBack.trim()?r.jsx("img",{src:e.cccdBack,alt:"CCCD Back",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card"}),r.jsx("span",{children:"Click to select"})]}),a.cccdBack&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"cccdBack-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("cccdBack",(k=y.target.files)==null?void 0:k[0])}})]})]}),r.jsxs("button",{type:"button",className:"btn-upload-docs",onClick:m,disabled:!s.cccdFront&&!s.cccdBack||a.cccdFront||a.cccdBack,children:[r.jsx("i",{className:"fas fa-upload"})," Upload ID Card"]})]}),r.jsxs("div",{className:"document-upload-subsection",children:[r.jsx("h3",{children:"Driver License (GPLX)"}),r.jsxs("div",{className:"documents-grid",children:[r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"Driver License (Front)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("licenseFront-input").click(),children:[e.licenseFront&&e.licenseFront.trim()?r.jsx("img",{src:e.licenseFront,alt:"License Front",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card-alt"}),r.jsx("span",{children:"Click to select"})]}),a.licenseFront&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"licenseFront-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("licenseFront",(k=y.target.files)==null?void 0:k[0])}})]}),r.jsxs("div",{className:"document-upload-box",children:[r.jsx("label",{children:"Driver License (Back)"}),r.jsxs("div",{className:"upload-area",onClick:()=>document.getElementById("licenseBack-input").click(),children:[e.licenseBack&&e.licenseBack.trim()?r.jsx("img",{src:e.licenseBack,alt:"License Back",className:"doc-preview",crossOrigin:"anonymous"}):r.jsxs("div",{className:"upload-placeholder",children:[r.jsx("i",{className:"fas fa-id-card-alt"}),r.jsx("span",{children:"Click to select"})]}),a.licenseBack&&r.jsx("div",{className:"upload-overlay",children:"Uploading..."})]}),r.jsx("input",{id:"licenseBack-input",type:"file",accept:"image/*",style:{display:"none"},onChange:y=>{var k;return f("licenseBack",(k=y.target.files)==null?void 0:k[0])}})]})]}),r.jsxs("button",{type:"button",className:"btn-upload-docs",onClick:g,disabled:!s.licenseFront&&!s.licenseBack||a.licenseFront||a.licenseBack,children:[r.jsx("i",{className:"fas fa-upload"})," Upload Driver License"]})]})]}),r.jsx(Ur,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,autoCloseMs:d.autoCloseMs,onClose:()=>u(y=>({...y,isOpen:!1}))})]})}function Lj(){const e=rn(),[t,n]=_.useState({}),[s,o]=_.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""});return _.useEffect(()=>{(async()=>{try{console.log(" Fetching user profile from /api/Users/Get-My-Profile...");const l=await yt.getMyProfile();console.log(" User profile:",l),n(l||{}),console.log(" Fetching document URLs from /api/Auth/me...");const d=await yt.getMe();console.log(" Auth response from /api/Auth/me:",d);const u=d||{};console.log(" Extracted auth data:",u);const f=u.cccdImageUrl_Front&&u.cccdImageUrl_Front.trim()?u.cccdImageUrl_Front:"",m=u.cccdImageUrl_Back&&u.cccdImageUrl_Back.trim()?u.cccdImageUrl_Back:"",g=u.gplxImageUrl_Front&&u.gplxImageUrl_Front.trim()?u.gplxImageUrl_Front:"",y=u.gplxImageUrl_Back&&u.gplxImageUrl_Back.trim()?u.gplxImageUrl_Back:"";console.log(" Loaded document URLs:",{cccdFront:f,cccdBack:m,licenseFront:g,licenseBack:y}),o({cccdFront:f,cccdBack:m,licenseFront:g,licenseBack:y})}catch(l){console.error(" Error loading profile:",l);const d=localStorage.getItem("userEmail"),u=localStorage.getItem("username"),f=localStorage.getItem("userPhone");n({email:d,fullName:u,phoneNumber:f}),o({cccdFront:localStorage.getItem("cccdFront")||"",cccdBack:localStorage.getItem("cccdBack")||"",licenseFront:localStorage.getItem("licenseFront")||"",licenseBack:localStorage.getItem("licenseBack")||""})}})()},[]),r.jsx("main",{className:"profile-main",children:r.jsxs("div",{className:"profile-container",children:[r.jsx("h2",{children:"USER PROFILE"}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Full Name"}),r.jsx("input",{type:"text",value:t.firstName?`${t.firstName} ${t.lastName}`:t.fullName||"",readOnly:!0})]}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:t.email||"",readOnly:!0})]}),r.jsxs("div",{className:"profile-field",children:[r.jsx("label",{children:"Phone Number"}),r.jsx("input",{type:"tel",value:t.phoneNumber||"",readOnly:!0})]}),r.jsx(vy,{documents:s,setDocuments:o,onDocumentUploadSuccess:()=>{console.log(" Document upload successful")}}),r.jsx("div",{className:"profile-actions",children:r.jsxs("button",{className:"btn-update-profile",onClick:()=>e("/update-profile"),children:[r.jsx("i",{className:"fas fa-edit"})," Update Profile Information"]})})]})})}const $l={getMyProfile:async()=>{var t;const e=await te.get("/Users/Get-My-Profile");return((t=e.data)==null?void 0:t.data)||e.data||{}},updateMyProfile:async e=>{var t,n;try{console.log(" Updating user profile:",e);const s=await te.put("/Users/Update-My-Profile",e);return console.log(" Profile updated:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error updating profile:",((n=s.response)==null?void 0:n.data)||s.message),s}},changePassword:async(e,t)=>{var n,s;try{console.log(" Changing password");const o=await te.post("/Users/Change-Password",{currentPassword:e,newPassword:t});return console.log(" Password changed successfully"),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error changing password:",((s=o.response)==null?void 0:s.data)||o.message),o}},updateUserAvatar:async(e,t)=>{var n,s;try{console.log(" Updating avatar for user:",e);const o=await te.post(`/Users/${encodeURIComponent(e)}/avatar`,{avatarUrl:t});return console.log(" Avatar updated:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error updating avatar:",((s=o.response)==null?void 0:s.data)||o.message),o}},getUserById:async e=>{var t,n;try{console.log(" Fetching user by ID:",e);const s=await te.get(`/Users/Get-By-${encodeURIComponent(e)}`);return console.log(" User data:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching user:",((n=s.response)==null?void 0:n.data)||s.message),s}},searchUsers:async(e,t=1,n=10)=>{var s,o,a;try{console.log(" Searching users by email:",e);const l=await te.get("/Users/Search",{params:{email:e,pageNumber:t,pageSize:n}});return console.log(" Search results:",l.data),Array.isArray(l.data)?l.data:(s=l.data)!=null&&s.data&&Array.isArray(l.data.data)?l.data.data:(o=l.data)!=null&&o.items&&Array.isArray(l.data.items)?l.data.items:l.data||[]}catch(l){return console.error(" Error searching users:",((a=l.response)==null?void 0:a.data)||l.message),[]}},deactivateUser:async(e,t="")=>{var n;try{const s=encodeURIComponent(e),o=t?`?reason=${encodeURIComponent(t)}`:"",a=[`/Users/Deactivate-By-${s}${o}`,`/User/Deactivate-By-${s}${o}`];for(const l of a)try{const d=await te.patch(l,t?{reason:t}:{}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(n=d==null?void 0:d.response)==null?void 0:n.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Deactivate user endpoint not found")}catch(s){throw console.error(" Error deactivating user:",s.message),s}},activateUser:async e=>{var t;try{const n=encodeURIComponent(e),s=[`/Users/Activate-By-${n}`,`/User/Activate-By-${n}`];for(const o of s)try{const a=await te.patch(o,{}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(t=a==null?void 0:a.response)==null?void 0:t.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Activate user endpoint not found")}catch(n){throw console.error(" Error activating user:",n.message),n}},updateUserRole:async(e,t)=>{var n;try{const s=encodeURIComponent(e),o=[`/Users/Update-Role-By-${s}`,`/User/Update-Role-By-${s}`];for(const a of o)try{const l=await te.patch(a,{role:t}),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){const d=(n=l==null?void 0:l.response)==null?void 0:n.status;if(d&&d!==404&&d!==405)throw l}throw new Error("Update user role endpoint not found")}catch(s){throw console.error(" Error updating user role:",s.message),s}},updateUserProfileByAdmin:async(e,t)=>{var n;try{const s=encodeURIComponent(e),o=[`/Users/Update-Profile-By-${s}`,`/User/Update-Profile-By-${s}`];for(const a of o)try{const l=await te.put(a,t),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){const d=(n=l==null?void 0:l.response)==null?void 0:n.status;if(d&&d!==404&&d!==405)throw l}throw new Error("Update user profile endpoint not found")}catch(s){throw console.error(" Error updating user profile:",s.message),s}},getTotalUserCount:async()=>{var e;try{const t=["/Users/Get-Total-Count","/User/Get-Total-Count"];for(const n of t)try{const s=await te.get(n),o=s==null?void 0:s.data,a=o&&typeof o=="object"&&"data"in o?o.data:o;return(a==null?void 0:a.totalCount)||(a==null?void 0:a.count)||a||0}catch(s){const o=(e=s==null?void 0:s.response)==null?void 0:e.status;if(o&&o!==404&&o!==405)throw s}return 0}catch(t){return console.error(" Error getting total user count:",t.message),0}},getUserStatisticsByRole:async()=>{var e;try{const t=["/Users/Get-Statistics-By-Role","/User/Get-Statistics-By-Role","/Users/Statistics-By-Role"];for(const n of t)try{const s=await te.get(n),o=s==null?void 0:s.data;return(o&&typeof o=="object"&&"data"in o?o.data:o)||{}}catch(s){const o=(e=s==null?void 0:s.response)==null?void 0:e.status;if(o&&o!==404&&o!==405)throw s}return{}}catch(t){return console.error(" Error getting user statistics:",t.message),{}}}};function Pj(){const e=rn(),[t,n]=_.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[s,o]=_.useState(!1),[a,l]=_.useState(!0),[d,u]=_.useState([]),[f,m]=_.useState({isOpen:!1,type:"info",title:"",message:""}),[g,y]=_.useState({cccdFront:"",cccdBack:"",licenseFront:"",licenseBack:""});_.useEffect(()=>{k()},[]);const k=async()=>{try{l(!0),console.log(" Initializing profile form...");const j=localStorage.getItem("userFirstName")||"",w=localStorage.getItem("userLastName")||"",N=localStorage.getItem("userPhone")||"";console.log(" Profile initialized from localStorage");const b=[],T=localStorage.getItem("userAddress"),I=localStorage.getItem("userDateOfBirth"),R=localStorage.getItem("userDriverLicenseNumber"),B=localStorage.getItem("userDriverLicenseExpiry");console.log(" Checking 4 required fields:"),console.log("  Address:",T),console.log("  DateOfBirth:",I),console.log("  DriverLicenseNumber:",R),console.log("  DriverLicenseExpiry:",B),(!T||T.trim()==="")&&b.push("address"),(!I||I.trim()==="")&&b.push("dateOfBirth"),(!R||R.trim()==="")&&b.push("driverLicenseNumber"),(!B||B.trim()==="")&&b.push("driverLicenseExpiry"),u(b),console.log(" Missing fields:",b),n({firstName:j,lastName:w,phoneNumber:N,address:localStorage.getItem("userAddress")||"",dateOfBirth:localStorage.getItem("userDateOfBirth")||"",yearOfBirth:localStorage.getItem("userYearOfBirth")||"",identityNumber:localStorage.getItem("userIdentityNumber")||"",driverLicenseNumber:localStorage.getItem("userDriverLicenseNumber")||"",driverLicenseExpiry:localStorage.getItem("userDriverLicenseExpiry")||"",driverLicenseClass:localStorage.getItem("userDriverLicenseClass")||""});const E=await yt.getMe()||{};y({cccdFront:E.cccdImageUrl_Front||"",cccdBack:E.cccdImageUrl_Back||"",licenseFront:E.gplxImageUrl_Front||"",licenseBack:E.gplxImageUrl_Back||""})}catch(j){console.error(" Error initializing profile:",j)}finally{l(!1)}},v=j=>{const{name:w,value:N}=j.target,b={...t,[w]:N};if(w==="dateOfBirth"&&N){const T=new Date(N).getFullYear();b.yearOfBirth=String(T),console.log(` Extracted year ${T} from date ${N}`)}n(b)},x=()=>t.firstName.trim()?t.lastName.trim()?t.phoneNumber.trim()?t.phoneNumber.match(/^[0-9]{10,11}$/)?t.address.trim()?t.driverLicenseNumber.trim()?t.driverLicenseExpiry.trim()?!0:(m({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Expiry is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Driver License Number is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Address is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number must be 10-11 digits"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Phone number is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"Last name is required"}),!1):(m({isOpen:!0,type:"error",title:"Validation Error",message:"First name is required"}),!1),C=async j=>{var w,N;if(j.preventDefault(),!!x()){o(!0);try{console.log(" Updating profile with data:",t);const b={request:"UpdateProfile",firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber,address:t.address||"",dateOfBirth:t.dateOfBirth||"",yearOfBirth:t.yearOfBirth?String(t.yearOfBirth):"",identityNumber:t.identityNumber||"",driverLicenseNumber:t.driverLicenseNumber||"",driverLicenseExpiry:t.driverLicenseExpiry||"",driverLicenseClass:t.driverLicenseClass||""},T=await $l.updateMyProfile(b);console.log(" Profile updated successfully:",T),localStorage.setItem("userFirstName",t.firstName),localStorage.setItem("userLastName",t.lastName),localStorage.setItem("userPhone",t.phoneNumber),localStorage.setItem("userAddress",t.address),localStorage.setItem("userDateOfBirth",t.dateOfBirth),localStorage.setItem("userYearOfBirth",t.yearOfBirth),localStorage.setItem("userIdentityNumber",t.identityNumber),localStorage.setItem("userDriverLicenseNumber",t.driverLicenseNumber),localStorage.setItem("userDriverLicenseExpiry",t.driverLicenseExpiry),localStorage.setItem("userDriverLicenseClass",t.driverLicenseClass),m({isOpen:!0,type:"success",title:"Success! ",message:"Your profile has been updated successfully.",autoCloseMs:2e3,onAction:()=>{e("/")},actionLabel:"Go to Home"})}catch(b){console.error(" Error updating profile:",b),m({isOpen:!0,type:"error",title:"Update Failed",message:((N=(w=b.response)==null?void 0:w.data)==null?void 0:N.message)||"Failed to update profile. Please try again."})}finally{o(!1)}}};return a?r.jsx("div",{className:"update-profile-page",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Loading your profile..."})]})}):r.jsxs("div",{className:"update-profile-page",children:[r.jsx(Ur,{isOpen:f.isOpen,type:f.type,title:f.title,message:f.message,onClose:()=>m({...f,isOpen:!1}),autoCloseMs:f.autoCloseMs||0,onAction:f.onAction,actionLabel:f.actionLabel}),r.jsxs("div",{className:"container",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("h1",{children:" Update Your Profile"}),r.jsx("p",{style:{color:"white"},children:"Keep your information up to date to enjoy our services"})]}),d.length>0&&r.jsxs("div",{className:"warning-banner",children:[r.jsx("span",{className:"warning-icon",children:""}),r.jsxs("div",{children:[r.jsx("strong",{children:"Missing Information"}),r.jsxs("p",{children:["Please complete the following fields: ",d.map(j=>j==="address"?"Address":j==="driverLicenseNumber"?"Driver License Number":j==="driverLicenseExpiry"?"Driver License Expiry":j).join(", ")]})]})]}),r.jsxs("form",{onSubmit:C,className:"update-profile-form",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Basic Information"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"firstName",children:"First Name *"}),r.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:v,placeholder:"John",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),r.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:v,placeholder:"Doe",required:!0})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),r.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:t.phoneNumber,onChange:v,placeholder:"0912345678",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"address",children:["Address *",d.includes("address")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"address",name:"address",value:t.address,onChange:v,placeholder:"123 Main St, City, Country",className:d.includes("address")?"field-missing":"",required:!0})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Birth Information"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),r.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:t.dateOfBirth,onChange:v})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth (Auto-filled)"}),r.jsx("input",{type:"text",id:"yearOfBirth",name:"yearOfBirth",value:t.yearOfBirth,disabled:!0,placeholder:"Will auto-fill from date above",style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Driver License Information *"}),r.jsxs("div",{className:`form-group ${d.includes("driverLicenseNumber")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number *",d.includes("driverLicenseNumber")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:t.driverLicenseNumber,onChange:v,placeholder:"ABC123456",className:d.includes("driverLicenseNumber")?"field-missing":"",required:!0})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:`form-group ${d.includes("driverLicenseExpiry")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry *",d.includes("driverLicenseExpiry")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:t.driverLicenseExpiry,onChange:v,className:d.includes("driverLicenseExpiry")?"field-missing":"",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),r.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:t.driverLicenseClass,onChange:v,children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"A",children:"Class A"}),r.jsx("option",{value:"A1",children:"Class A1"}),r.jsx("option",{value:"B",children:"Class B"}),r.jsx("option",{value:"C",children:"Class C"}),r.jsx("option",{value:"D",children:"Class D"}),r.jsx("option",{value:"E",children:"Class E"})]})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h2",{className:"section-title",children:" Additional Information"}),r.jsxs("div",{className:`form-group ${d.includes("identityNumber")?"field-missing-group":""}`,children:[r.jsxs("label",{htmlFor:"identityNumber",children:["Identity Number (CCCD) *",d.includes("identityNumber")&&r.jsx("span",{className:"required-badge",children:"Required"})]}),r.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:t.identityNumber,onChange:v,placeholder:"123456789012",className:d.includes("identityNumber")?"field-missing":"",required:!0})]})]}),r.jsx(vy,{documents:g,setDocuments:y,onDocumentUploadSuccess:()=>{console.log(" Document upload successful")}}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e(-1),disabled:s,children:" Go Back"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?" Saving...":" Save Profile"})]})]})]})]})}const Ud={getAllStations:async(e=1,t=100)=>{var n;try{console.log(" Fetching stations from:",`${Di}/Stations/Get-All`);const s=await te.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Stations response:",s.data);const o=s.data;return Array.isArray(o)?(console.log(" Returning stations array:",o.length,"items"),o):o.data&&o.data.data&&Array.isArray(o.data.data)?(console.log(" Returning stations from data.data.data:",o.data.data.length,"items"),o.data.data):o.data&&o.data.items&&Array.isArray(o.data.items)?(console.log(" Returning stations from data.data.items:",o.data.items.length,"items"),o.data.items):o.data&&Array.isArray(o.data)?(console.log(" Returning stations from data.data:",o.data.length,"items"),o.data):o.items&&Array.isArray(o.items)?(console.log(" Returning stations from data.items:",o.items.length,"items"),o.items):(console.warn(" No stations found in response"),[])}catch(s){return console.error(" Error fetching stations:",((n=s.response)==null?void 0:n.data)||s.message),[]}}},Qe={getAllCars:async(e=1,t=100)=>{var n;try{console.log(" Fetching cars from:",`${Di}/Cars/Get-All`);const s=await te.get("/Cars/Get-All",{params:{pageNumber:e,pageSize:t}});console.log(" Cars response:",s.data);const o=s.data;return Array.isArray(o)?(console.log(" Returning cars array:",o.length,"items"),o):o.data&&o.data.data&&Array.isArray(o.data.data)?(console.log(" Returning cars from data.data.data:",o.data.data.length,"items"),o.data.data):o.data&&o.data.items&&Array.isArray(o.data.items)?(console.log(" Returning cars from data.data.items:",o.data.items.length,"items"),o.data.items):o.data&&Array.isArray(o.data)?(console.log(" Returning cars from data.data:",o.data.length,"items"),o.data):o.items&&Array.isArray(o.items)?(console.log(" Returning cars from data.items:",o.items.length,"items"),o.items):(console.warn(" No cars found in response"),[])}catch(s){return console.error(" Error fetching cars:",((n=s.response)==null?void 0:n.data)||s.message),[]}},getCarById:async e=>{var t;try{console.log(" Fetching car details for ID:",e);const n=await te.get(`/Cars/Get-By-${encodeURIComponent(e)}`);console.log(" Car detail response:",n.data);const s=n.data;return s.id||s.Id?(console.log(" Returning car object directly"),s):s.data&&s.data.data&&(s.data.data.id||s.data.data.Id)?(console.log(" Returning car from data.data.data"),s.data.data):s.data&&(s.data.id||s.data.Id)?(console.log(" Returning car from data.data"),s.data):(console.warn(" No car found in response"),null)}catch(n){throw console.error(" Error fetching car details:",((t=n.response)==null?void 0:t.data)||n.message),n}},getAvailableCarsByStation:async(e,t,n)=>{var s;try{console.log(" Fetching available cars for station:",e,"startTime:",t,"endTime:",n);try{const o=await te.get("/Bookings/available-cars-by-station",{params:{stationId:e,startTime:t,endTime:n}});console.log(" Available cars response:",o.data);const a=o.data;if(Array.isArray(a))return console.log(" Returning available cars array:",a.length,"items"),a;if(a.data&&a.data.data&&Array.isArray(a.data.data))return console.log(" Returning available cars from data.data.data:",a.data.data.length,"items"),a.data.data;if(a.data&&a.data.items&&Array.isArray(a.data.items))return console.log(" Returning available cars from data.data.items:",a.data.items.length,"items"),a.data.items;if(a.data&&Array.isArray(a.data))return console.log(" Returning available cars from data.data:",a.data.length,"items"),a.data;if(a.items&&Array.isArray(a.items))return console.log(" Returning available cars from data.items:",a.items.length,"items"),a.items}catch(o){console.warn(" Primary endpoint failed, trying fallback - getting all cars and filtering:",o.message);try{const a=await Qe.getAllCars(),l=(a||[]).filter(d=>{var f,m;return(d.currentStationId||d.stationId||((f=d.station)==null?void 0:f.id)||((m=d.station)==null?void 0:m.Id))===e});return console.log(` Filtered ${l.length} cars for station ${e} from ${a.length} total cars`),l}catch(a){return console.warn(" Failed to get all cars for filtering:",a.message),[]}}return console.warn(" No available cars found in response"),[]}catch(o){return console.error(" Error fetching available cars:",((s=o.response)==null?void 0:s.data)||o.message),[]}},createCar:async e=>{var t,n;try{if(e instanceof FormData){const s={headers:{"Content-Type":void 0}};console.log(" Sending FormData with image for car creation");const o=await te.post("/Cars/Create",e,s);return((t=o.data)==null?void 0:t.data)||o.data}else{const s=await te.post("/Cars/Create",e);return((n=s.data)==null?void 0:n.data)||s.data}}catch(s){throw console.error("Error creating car:",s),s}},deleteCar:async e=>{var t;try{const n=await te.delete(`/Cars/Delete-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error deleting car:",n),n}},updateCar:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,t);return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car:",s),s}},updateStatus:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{tech:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car status:",s),s}},updateBatteryLevel:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{battery:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating battery level:",s),s}},updateCarDescription:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{issue:t});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car description:",s),s}},updateCarAvailability:async(e,t)=>{var n;try{const s=await te.put(`/Cars/Update-By-${encodeURIComponent(e)}`,{isAvailable:t===1||t===!0});return((n=s.data)==null?void 0:n.data)||s.data}catch(s){throw console.error("Error updating car availability:",s),s}},softDeleteCar:async e=>{var t;try{const n=await te.patch(`/Cars/Soft-Delete-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error soft deleting car:",n),n}},restoreCar:async e=>{var t;try{const n=await te.patch(`/Cars/Restore-By-${encodeURIComponent(e)}`);return((t=n.data)==null?void 0:t.data)||n.data}catch(n){throw console.error("Error restoring car:",n),n}},getDeletedCars:async()=>{var e;try{const n=(await te.get("/Cars/Get-Deleted")).data;return Array.isArray(n)?n:n.data&&Array.isArray(n.data)?n.data:n.data&&n.data.data&&Array.isArray(n.data.data)?n.data.data:n.items&&Array.isArray(n.items)?n.items:(console.warn(" No deleted cars found in response"),[])}catch(t){return console.error(" Error fetching deleted cars:",((e=t.response)==null?void 0:e.data)||t.message),[]}}},Ej=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"})),Tj=24e3;function Yt(e,t={convertFromUSD:!1}){const{convertFromUSD:n}=t||{},s=Number(e)||0,o=Math.round(n?s*Tj:s);return new Intl.NumberFormat("vi-VN").format(o)+" "}const _y=_.createContext(null);function Bj({children:e}){const[t,n]=_.useState([]),s=_.useCallback((a,l="info",d=3500,u=null)=>{const f=Date.now()+Math.random();let m=null;try{if(u&&typeof u.getBoundingClientRect=="function"){const g=u.getBoundingClientRect(),y=Math.round(g.top+g.height+8),k=Math.round(g.left+g.width/2);m={top:y,left:k}}}catch{m=null}n(g=>[...g,{id:f,message:a,type:l,pos:m}]),setTimeout(()=>{n(g=>g.filter(y=>y.id!==f))},d)},[]),o=_.useCallback(a=>{n(l=>l.filter(d=>d.id!==a))},[]);return r.jsxs(_y.Provider,{value:{showToast:s},children:[e,r.jsx("div",{className:"toast-viewport","aria-live":"polite",children:t.filter(a=>!a.pos).map(a=>r.jsxs("div",{className:`toast ${a.type}`,onClick:()=>o(a.id),children:[r.jsx("div",{className:"toast-message",children:a.message}),r.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},a.id))}),t.filter(a=>a.pos).map(a=>r.jsxs("div",{className:`toast ${a.type} anchored`,style:{position:"fixed",top:`${a.pos.top}px`,left:`${a.pos.left}px`,transform:"translateX(-50%)"},onClick:()=>o(a.id),children:[r.jsx("div",{className:"toast-message",children:a.message}),r.jsx("button",{className:"toast-close","aria-label":"Close",children:""})]},a.id))]})}function Wu(){const e=_.useContext(_y);if(!e)throw new Error("useToast must be used within ToastProvider");return e}function wy(e,t){const n=_.useRef(t);_.useEffect(function(){t!==n.current&&e.attributionControl!=null&&(n.current!=null&&e.attributionControl.removeAttribution(n.current),t!=null&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}const Rj=1;function Aj(e){return Object.freeze({__version:Rj,map:e})}function Mj(e,t){return Object.freeze({...e,...t})}const jy=_.createContext(null),Sy=jy.Provider;function Hu(){const e=_.useContext(jy);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Fj(e){function t(n,s){const{instance:o,context:a}=e(n).current;return _.useImperativeHandle(s,()=>o),n.children==null?null:mr.createElement(Sy,{value:a},n.children)}return _.forwardRef(t)}function Uj(e){function t(n,s){const[o,a]=_.useState(!1),{instance:l}=e(n,a).current;_.useImperativeHandle(s,()=>l),_.useEffect(function(){o&&l.update()},[l,o,n.children]);const d=l._contentNode;return d?Ag.createPortal(n.children,d):null}return _.forwardRef(t)}function Oj(e){function t(n,s){const{instance:o}=e(n).current;return _.useImperativeHandle(s,()=>o),null}return _.forwardRef(t)}function Cy(e,t){const n=_.useRef();_.useEffect(function(){return t!=null&&e.instance.on(t),n.current=t,function(){n.current!=null&&e.instance.off(n.current),n.current=null}},[e,t])}function Zu(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function Dj(e,t){return function(s,o){const a=Hu(),l=e(Zu(s,a),a);return wy(a.map,s.attribution),Cy(l.current,s.eventHandlers),t(l.current,a,s,o),l}}var Od={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(n,s){s(t)})(wp,function(n){var s="1.9.4";function o(i){var c,h,p,S;for(h=1,p=arguments.length;h<p;h++){S=arguments[h];for(c in S)i[c]=S[c]}return i}var a=Object.create||function(){function i(){}return function(c){return i.prototype=c,new i}}();function l(i,c){var h=Array.prototype.slice;if(i.bind)return i.bind.apply(i,h.call(arguments,1));var p=h.call(arguments,2);return function(){return i.apply(c,p.length?p.concat(h.call(arguments)):arguments)}}var d=0;function u(i){return"_leaflet_id"in i||(i._leaflet_id=++d),i._leaflet_id}function f(i,c,h){var p,S,P,U;return U=function(){p=!1,S&&(P.apply(h,S),S=!1)},P=function(){p?S=arguments:(i.apply(h,arguments),setTimeout(U,c),p=!0)},P}function m(i,c,h){var p=c[1],S=c[0],P=p-S;return i===p&&h?i:((i-S)%P+P)%P+S}function g(){return!1}function y(i,c){if(c===!1)return i;var h=Math.pow(10,c===void 0?6:c);return Math.round(i*h)/h}function k(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function v(i){return k(i).split(/\s+/)}function x(i,c){Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?a(i.options):{});for(var h in c)i.options[h]=c[h];return i.options}function C(i,c,h){var p=[];for(var S in i)p.push(encodeURIComponent(h?S.toUpperCase():S)+"="+encodeURIComponent(i[S]));return(!c||c.indexOf("?")===-1?"?":"&")+p.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function w(i,c){return i.replace(j,function(h,p){var S=c[p];if(S===void 0)throw new Error("No value provided for variable "+h);return typeof S=="function"&&(S=S(c)),S})}var N=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function b(i,c){for(var h=0;h<i.length;h++)if(i[h]===c)return h;return-1}var T="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var R=0;function B(i){var c=+new Date,h=Math.max(0,16-(c-R));return R=c+h,window.setTimeout(i,h)}var A=window.requestAnimationFrame||I("RequestAnimationFrame")||B,E=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function M(i,c,h){if(h&&A===B)i.call(c);else return A.call(window,l(i,c))}function G(i){i&&E.call(window,i)}var Y={__proto__:null,extend:o,create:a,bind:l,get lastId(){return d},stamp:u,throttle:f,wrapNum:m,falseFn:g,formatNum:y,trim:k,splitWords:v,setOptions:x,getParamString:C,template:w,isArray:N,indexOf:b,emptyImageUrl:T,requestFn:A,cancelFn:E,requestAnimFrame:M,cancelAnimFrame:G};function z(){}z.extend=function(i){var c=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,p=a(h);p.constructor=c,c.prototype=p;for(var S in this)Object.prototype.hasOwnProperty.call(this,S)&&S!=="prototype"&&S!=="__super__"&&(c[S]=this[S]);return i.statics&&o(c,i.statics),i.includes&&(X(i.includes),o.apply(null,[p].concat(i.includes))),o(p,i),delete p.statics,delete p.includes,p.options&&(p.options=h.options?a(h.options):{},o(p.options,i.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,U=p._initHooks.length;P<U;P++)p._initHooks[P].call(this)}},c},z.include=function(i){var c=this.prototype.options;return o(this.prototype,i),i.options&&(this.prototype.options=c,this.mergeOptions(i.options)),this},z.mergeOptions=function(i){return o(this.prototype.options,i),this},z.addInitHook=function(i){var c=Array.prototype.slice.call(arguments,1),h=typeof i=="function"?i:function(){this[i].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function X(i){if(!(typeof L>"u"||!L||!L.Mixin)){i=N(i)?i:[i];for(var c=0;c<i.length;c++)i[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(i,c,h){if(typeof i=="object")for(var p in i)this._on(p,i[p],c);else{i=v(i);for(var S=0,P=i.length;S<P;S++)this._on(i[S],c,h)}return this},off:function(i,c,h){if(!arguments.length)delete this._events;else if(typeof i=="object")for(var p in i)this._off(p,i[p],c);else{i=v(i);for(var S=arguments.length===1,P=0,U=i.length;P<U;P++)S?this._off(i[P]):this._off(i[P],c,h)}return this},_on:function(i,c,h,p){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(i,c,h)===!1){h===this&&(h=void 0);var S={fn:c,ctx:h};p&&(S.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(S)}},_off:function(i,c,h){var p,S,P;if(this._events&&(p=this._events[i],!!p)){if(arguments.length===1){if(this._firingCount)for(S=0,P=p.length;S<P;S++)p[S].fn=g;delete this._events[i];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var U=this._listens(i,c,h);if(U!==!1){var Z=p[U];this._firingCount&&(Z.fn=g,this._events[i]=p=p.slice()),p.splice(U,1)}}},fire:function(i,c,h){if(!this.listens(i,h))return this;var p=o({},c,{type:i,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var S=this._events[i];if(S){this._firingCount=this._firingCount+1||1;for(var P=0,U=S.length;P<U;P++){var Z=S[P],J=Z.fn;Z.once&&this.off(i,J,Z.ctx),J.call(Z.ctx||this,p)}this._firingCount--}}return h&&this._propagateEvent(p),this},listens:function(i,c,h,p){typeof i!="string"&&console.warn('"string" type argument expected');var S=c;typeof c!="function"&&(p=!!c,S=void 0,h=void 0);var P=this._events&&this._events[i];if(P&&P.length&&this._listens(i,S,h)!==!1)return!0;if(p){for(var U in this._eventParents)if(this._eventParents[U].listens(i,c,h,p))return!0}return!1},_listens:function(i,c,h){if(!this._events)return!1;var p=this._events[i]||[];if(!c)return!!p.length;h===this&&(h=void 0);for(var S=0,P=p.length;S<P;S++)if(p[S].fn===c&&p[S].ctx===h)return S;return!1},once:function(i,c,h){if(typeof i=="object")for(var p in i)this._on(p,i[p],c,!0);else{i=v(i);for(var S=0,P=i.length;S<P;S++)this._on(i[S],c,h,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[u(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[u(i)],this},_propagateEvent:function(i){for(var c in this._eventParents)this._eventParents[c].fire(i.type,o({layer:i.target,propagatedFrom:i.target},i),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var F=z.extend(K);function $(i,c,h){this.x=h?Math.round(i):i,this.y=h?Math.round(c):c}var ge=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};$.prototype={clone:function(){return new $(this.x,this.y)},add:function(i){return this.clone()._add(re(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(re(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new $(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new $(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ge(this.x),this.y=ge(this.y),this},distanceTo:function(i){i=re(i);var c=i.x-this.x,h=i.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(i){return i=re(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=re(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function re(i,c,h){return i instanceof $?i:N(i)?new $(i[0],i[1]):i==null?i:typeof i=="object"&&"x"in i&&"y"in i?new $(i.x,i.y):new $(i,c,h)}function fe(i,c){if(i)for(var h=c?[i,c]:i,p=0,S=h.length;p<S;p++)this.extend(h[p])}fe.prototype={extend:function(i){var c,h;if(!i)return this;if(i instanceof $||typeof i[0]=="number"||"x"in i)c=h=re(i);else if(i=_e(i),c=i.min,h=i.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(i){return re((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return re(this.min.x,this.max.y)},getTopRight:function(){return re(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var c,h;return typeof i[0]=="number"||i instanceof $?i=re(i):i=_e(i),i instanceof fe?(c=i.min,h=i.max):c=h=i,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(i){i=_e(i);var c=this.min,h=this.max,p=i.min,S=i.max,P=S.x>=c.x&&p.x<=h.x,U=S.y>=c.y&&p.y<=h.y;return P&&U},overlaps:function(i){i=_e(i);var c=this.min,h=this.max,p=i.min,S=i.max,P=S.x>c.x&&p.x<h.x,U=S.y>c.y&&p.y<h.y;return P&&U},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var c=this.min,h=this.max,p=Math.abs(c.x-h.x)*i,S=Math.abs(c.y-h.y)*i;return _e(re(c.x-p,c.y-S),re(h.x+p,h.y+S))},equals:function(i){return i?(i=_e(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight())):!1}};function _e(i,c){return!i||i instanceof fe?i:new fe(i,c)}function se(i,c){if(i)for(var h=c?[i,c]:i,p=0,S=h.length;p<S;p++)this.extend(h[p])}se.prototype={extend:function(i){var c=this._southWest,h=this._northEast,p,S;if(i instanceof ne)p=i,S=i;else if(i instanceof se){if(p=i._southWest,S=i._northEast,!p||!S)return this}else return i?this.extend(q(i)||O(i)):this;return!c&&!h?(this._southWest=new ne(p.lat,p.lng),this._northEast=new ne(S.lat,S.lng)):(c.lat=Math.min(p.lat,c.lat),c.lng=Math.min(p.lng,c.lng),h.lat=Math.max(S.lat,h.lat),h.lng=Math.max(S.lng,h.lng)),this},pad:function(i){var c=this._southWest,h=this._northEast,p=Math.abs(c.lat-h.lat)*i,S=Math.abs(c.lng-h.lng)*i;return new se(new ne(c.lat-p,c.lng-S),new ne(h.lat+p,h.lng+S))},getCenter:function(){return new ne((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ne(this.getNorth(),this.getWest())},getSouthEast:function(){return new ne(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){typeof i[0]=="number"||i instanceof ne||"lat"in i?i=q(i):i=O(i);var c=this._southWest,h=this._northEast,p,S;return i instanceof se?(p=i.getSouthWest(),S=i.getNorthEast()):p=S=i,p.lat>=c.lat&&S.lat<=h.lat&&p.lng>=c.lng&&S.lng<=h.lng},intersects:function(i){i=O(i);var c=this._southWest,h=this._northEast,p=i.getSouthWest(),S=i.getNorthEast(),P=S.lat>=c.lat&&p.lat<=h.lat,U=S.lng>=c.lng&&p.lng<=h.lng;return P&&U},overlaps:function(i){i=O(i);var c=this._southWest,h=this._northEast,p=i.getSouthWest(),S=i.getNorthEast(),P=S.lat>c.lat&&p.lat<h.lat,U=S.lng>c.lng&&p.lng<h.lng;return P&&U},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,c){return i?(i=O(i),this._southWest.equals(i.getSouthWest(),c)&&this._northEast.equals(i.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function O(i,c){return i instanceof se?i:new se(i,c)}function ne(i,c,h){if(isNaN(i)||isNaN(c))throw new Error("Invalid LatLng object: ("+i+", "+c+")");this.lat=+i,this.lng=+c,h!==void 0&&(this.alt=+h)}ne.prototype={equals:function(i,c){if(!i)return!1;i=q(i);var h=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return h<=(c===void 0?1e-9:c)},toString:function(i){return"LatLng("+y(this.lat,i)+", "+y(this.lng,i)+")"},distanceTo:function(i){return Le.distance(this,q(i))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(i){var c=180*i/40075017,h=c/Math.cos(Math.PI/180*this.lat);return O([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new ne(this.lat,this.lng,this.alt)}};function q(i,c,h){return i instanceof ne?i:N(i)&&typeof i[0]!="object"?i.length===3?new ne(i[0],i[1],i[2]):i.length===2?new ne(i[0],i[1]):null:i==null?i:typeof i=="object"&&"lat"in i?new ne(i.lat,"lng"in i?i.lng:i.lon,i.alt):c===void 0?null:new ne(i,c,h)}var we={latLngToPoint:function(i,c){var h=this.projection.project(i),p=this.scale(c);return this.transformation._transform(h,p)},pointToLatLng:function(i,c){var h=this.scale(c),p=this.transformation.untransform(i,h);return this.projection.unproject(p)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(i),p=this.transformation.transform(c.min,h),S=this.transformation.transform(c.max,h);return new fe(p,S)},infinite:!1,wrapLatLng:function(i){var c=this.wrapLng?m(i.lng,this.wrapLng,!0):i.lng,h=this.wrapLat?m(i.lat,this.wrapLat,!0):i.lat,p=i.alt;return new ne(h,c,p)},wrapLatLngBounds:function(i){var c=i.getCenter(),h=this.wrapLatLng(c),p=c.lat-h.lat,S=c.lng-h.lng;if(p===0&&S===0)return i;var P=i.getSouthWest(),U=i.getNorthEast(),Z=new ne(P.lat-p,P.lng-S),J=new ne(U.lat-p,U.lng-S);return new se(Z,J)}},Le=o({},we,{wrapLng:[-180,180],R:6371e3,distance:function(i,c){var h=Math.PI/180,p=i.lat*h,S=c.lat*h,P=Math.sin((c.lat-i.lat)*h/2),U=Math.sin((c.lng-i.lng)*h/2),Z=P*P+Math.cos(p)*Math.cos(S)*U*U,J=2*Math.atan2(Math.sqrt(Z),Math.sqrt(1-Z));return this.R*J}}),Ne=6378137,Se={R:Ne,MAX_LATITUDE:85.0511287798,project:function(i){var c=Math.PI/180,h=this.MAX_LATITUDE,p=Math.max(Math.min(h,i.lat),-h),S=Math.sin(p*c);return new $(this.R*i.lng*c,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(i){var c=180/Math.PI;return new ne((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*c,i.x*c/this.R)},bounds:function(){var i=Ne*Math.PI;return new fe([-i,-i],[i,i])}()};function ze(i,c,h,p){if(N(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=c,this._c=h,this._d=p}ze.prototype={transform:function(i,c){return this._transform(i.clone(),c)},_transform:function(i,c){return c=c||1,i.x=c*(this._a*i.x+this._b),i.y=c*(this._c*i.y+this._d),i},untransform:function(i,c){return c=c||1,new $((i.x/c-this._b)/this._a,(i.y/c-this._d)/this._c)}};function pe(i,c,h,p){return new ze(i,c,h,p)}var nt=o({},Le,{code:"EPSG:3857",projection:Se,transformation:function(){var i=.5/(Math.PI*Se.R);return pe(i,.5,-i,.5)}()}),sn=o({},nt,{code:"EPSG:900913"});function he(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function oe(i,c){var h="",p,S,P,U,Z,J;for(p=0,P=i.length;p<P;p++){for(Z=i[p],S=0,U=Z.length;S<U;S++)J=Z[S],h+=(S?"L":"M")+J.x+" "+J.y;h+=c?ve.svg?"z":"x":""}return h||"M0 0"}var le=document.documentElement.style,ye="ActiveXObject"in window,de=ye&&!document.addEventListener,ke="msLaunchUri"in navigator&&!("documentMode"in document),tt=je("webkit"),Qn=je("android"),Ie=je("android 2")||je("android 3"),D=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ke=Qn&&je("Google")&&D<537&&!("AudioNode"in window),Ve=!!window.opera,Ee=!ke&&je("chrome"),ie=je("gecko")&&!tt&&!Ve&&!ye,Ae=!Ee&&je("safari"),ot=je("phantom"),At="OTransition"in le,Sn=navigator.platform.indexOf("Win")===0,Me=ye&&"transition"in le,ut="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ie,Xn="MozPerspective"in le,Cn=!window.L_DISABLE_3D&&(Me||ut||Xn)&&!At&&!ot,Et=typeof orientation<"u"||je("mobile"),rt=Et&&tt,Or=Et&&ut,Fn=!window.PointerEvent&&window.MSPointerEvent,$i=!!(window.PointerEvent||Fn),yr="ontouchstart"in window||!!window.TouchEvent,Hs=!window.L_NO_TOUCH&&(yr||$i),er=Et&&Ve,Wi=Et&&ie,Zs=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Hi=function(){var i=!1;try{var c=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",g,c),window.removeEventListener("testPassiveEventSupport",g,c)}catch{}return i}(),V=function(){return!!document.createElement("canvas").getContext}(),ee=!!(document.createElementNS&&he("svg").createSVGRect),ae=!!ee&&function(){var i=document.createElement("div");return i.innerHTML="<svg/>",(i.firstChild&&i.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ce=!ee&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var c=i.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Be=navigator.platform.indexOf("Mac")===0,Ue=navigator.platform.indexOf("Linux")===0;function je(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var ve={ie:ye,ielt9:de,edge:ke,webkit:tt,android:Qn,android23:Ie,androidStock:Ke,opera:Ve,chrome:Ee,gecko:ie,safari:Ae,phantom:ot,opera12:At,win:Sn,ie3d:Me,webkit3d:ut,gecko3d:Xn,any3d:Cn,mobile:Et,mobileWebkit:rt,mobileWebkit3d:Or,msPointer:Fn,pointer:$i,touch:Hs,touchNative:yr,mobileOpera:er,mobileGecko:Wi,retina:Zs,passiveEvents:Hi,canvas:V,svg:ee,vml:ce,inlineSvg:ae,mac:Be,linux:Ue},ft=ve.msPointer?"MSPointerDown":"pointerdown",H=ve.msPointer?"MSPointerMove":"pointermove",Re=ve.msPointer?"MSPointerUp":"pointerup",$e=ve.msPointer?"MSPointerCancel":"pointercancel",xe={touchstart:ft,touchmove:H,touchend:Re,touchcancel:$e},W={touchstart:kt,touchmove:Mt,touchend:Mt,touchcancel:Mt},Ze={},lt=!1;function Pe(i,c,h){return c==="touchstart"&&xr(),W[c]?(h=W[c].bind(this,h),i.addEventListener(xe[c],h,!1),h):(console.warn("wrong event specified:",c),g)}function jt(i,c,h){if(!xe[c]){console.warn("wrong event specified:",c);return}i.removeEventListener(xe[c],h,!1)}function an(i){Ze[i.pointerId]=i}function on(i){Ze[i.pointerId]&&(Ze[i.pointerId]=i)}function Nn(i){delete Ze[i.pointerId]}function xr(){lt||(document.addEventListener(ft,an,!0),document.addEventListener(H,on,!0),document.addEventListener(Re,Nn,!0),document.addEventListener($e,Nn,!0),lt=!0)}function Mt(i,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in Ze)c.touches.push(Ze[h]);c.changedTouches=[c],i(c)}}function kt(i,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&It(c),Mt(i,c)}function bt(i){var c={},h,p;for(p in i)h=i[p],c[p]=h&&h.bind?h.bind(i):h;return i=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Un=200;function Zi(i,c){i.addEventListener("dblclick",c);var h=0,p;function S(P){if(P.detail!==1){p=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var U=Gs(P);if(!(U.some(function(J){return J instanceof HTMLLabelElement&&J.attributes.for})&&!U.some(function(J){return J instanceof HTMLInputElement||J instanceof HTMLSelectElement}))){var Z=Date.now();Z-h<=Un?(p++,p===2&&c(bt(P))):p=1,h=Z}}}return i.addEventListener("click",S),{dblclick:c,simDblclick:S}}function Vi(i,c){i.removeEventListener("dblclick",c.dblclick),i.removeEventListener("click",c.simDblclick)}var Dr=rr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),On=rr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),zr=On==="webkitTransition"||On==="OTransition"?On+"End":"transitionend";function $r(i){return typeof i=="string"?document.getElementById(i):i}function Dn(i,c){var h=i.style[c]||i.currentStyle&&i.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(i,null);h=p?p[c]:null}return h==="auto"?null:h}function qe(i,c,h){var p=document.createElement(i);return p.className=c||"",h&&h.appendChild(p),p}function it(i){var c=i.parentNode;c&&c.removeChild(i)}function tr(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function kn(i){var c=i.parentNode;c&&c.lastChild!==i&&c.appendChild(i)}function bn(i){var c=i.parentNode;c&&c.firstChild!==i&&c.insertBefore(i,c.firstChild)}function vr(i,c){if(i.classList!==void 0)return i.classList.contains(c);var h=nr(i);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function Oe(i,c){if(i.classList!==void 0)for(var h=v(c),p=0,S=h.length;p<S;p++)i.classList.add(h[p]);else if(!vr(i,c)){var P=nr(i);_r(i,(P?P+" ":"")+c)}}function ct(i,c){i.classList!==void 0?i.classList.remove(c):_r(i,k((" "+nr(i)+" ").replace(" "+c+" "," ")))}function _r(i,c){i.className.baseVal===void 0?i.className=c:i.className.baseVal=c}function nr(i){return i.correspondingElement&&(i=i.correspondingElement),i.className.baseVal===void 0?i.className:i.className.baseVal}function Ft(i,c){"opacity"in i.style?i.style.opacity=c:"filter"in i.style&&vi(i,c)}function vi(i,c){var h=!1,p="DXImageTransform.Microsoft.Alpha";try{h=i.filters.item(p)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):i.style.filter+=" progid:"+p+"(opacity="+c+")"}function rr(i){for(var c=document.documentElement.style,h=0;h<i.length;h++)if(i[h]in c)return i[h];return!1}function Je(i,c,h){var p=c||new $(0,0);i.style[Dr]=(ve.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(h?" scale("+h+")":"")}function dt(i,c){i._leaflet_pos=c,ve.any3d?Je(i,c):(i.style.left=c.x+"px",i.style.top=c.y+"px")}function ir(i){return i._leaflet_pos||new $(0,0)}var Wr,Hr,qi;if("onselectstart"in document)Wr=function(){De(window,"selectstart",It)},Hr=function(){st(window,"selectstart",It)};else{var Zr=rr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Wr=function(){if(Zr){var i=document.documentElement.style;qi=i[Zr],i[Zr]="none"}},Hr=function(){Zr&&(document.documentElement.style[Zr]=qi,qi=void 0)}}function Gi(){De(window,"dragstart",It)}function Yi(){st(window,"dragstart",It)}var _i,Ki;function Ji(i){for(;i.tabIndex===-1;)i=i.parentNode;i.style&&(wi(),_i=i,Ki=i.style.outlineStyle,i.style.outlineStyle="none",De(window,"keydown",wi))}function wi(){_i&&(_i.style.outlineStyle=Ki,_i=void 0,Ki=void 0,st(window,"keydown",wi))}function Vs(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body);return i}function Qi(i){var c=i.getBoundingClientRect();return{x:c.width/i.offsetWidth||1,y:c.height/i.offsetHeight||1,boundingClientRect:c}}var eo={__proto__:null,TRANSFORM:Dr,TRANSITION:On,TRANSITION_END:zr,get:$r,getStyle:Dn,create:qe,remove:it,empty:tr,toFront:kn,toBack:bn,hasClass:vr,addClass:Oe,removeClass:ct,setClass:_r,getClass:nr,setOpacity:Ft,testProp:rr,setTransform:Je,setPosition:dt,getPosition:ir,get disableTextSelection(){return Wr},get enableTextSelection(){return Hr},disableImageDrag:Gi,enableImageDrag:Yi,preventOutline:Ji,restoreOutline:wi,getSizedParentNode:Vs,getScale:Qi};function De(i,c,h,p){if(c&&typeof c=="object")for(var S in c)es(i,S,c[S],h);else{c=v(c);for(var P=0,U=c.length;P<U;P++)es(i,c[P],h,p)}return this}var gn="_leaflet_events";function st(i,c,h,p){if(arguments.length===1)qs(i),delete i[gn];else if(c&&typeof c=="object")for(var S in c)ts(i,S,c[S],h);else if(c=v(c),arguments.length===2)qs(i,function(Z){return b(c,Z)!==-1});else for(var P=0,U=c.length;P<U;P++)ts(i,c[P],h,p);return this}function qs(i,c){for(var h in i[gn]){var p=h.split(/\d/)[0];(!c||c(p))&&ts(i,p,null,null,h)}}var Xi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function es(i,c,h,p){var S=c+u(h)+(p?"_"+u(p):"");if(i[gn]&&i[gn][S])return this;var P=function(Z){return h.call(p||i,Z||window.event)},U=P;!ve.touchNative&&ve.pointer&&c.indexOf("touch")===0?P=Pe(i,c,P):ve.touch&&c==="dblclick"?P=Zi(i,P):"addEventListener"in i?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?i.addEventListener(Xi[c]||c,P,ve.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(P=function(Z){Z=Z||window.event,Wl(i,Z)&&U(Z)},i.addEventListener(Xi[c],P,!1)):i.addEventListener(c,U,!1):i.attachEvent("on"+c,P),i[gn]=i[gn]||{},i[gn][S]=P}function ts(i,c,h,p,S){S=S||c+u(h)+(p?"_"+u(p):"");var P=i[gn]&&i[gn][S];if(!P)return this;!ve.touchNative&&ve.pointer&&c.indexOf("touch")===0?jt(i,c,P):ve.touch&&c==="dblclick"?Vi(i,P):"removeEventListener"in i?i.removeEventListener(Xi[c]||c,P,!1):i.detachEvent("on"+c,P),i[gn][S]=null}function sr(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function ns(i){return es(i,"wheel",sr),this}function Vr(i){return De(i,"mousedown touchstart dblclick contextmenu",sr),i._leaflet_disable_click=!0,this}function It(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function ar(i){return It(i),sr(i),this}function Gs(i){if(i.composedPath)return i.composedPath();for(var c=[],h=i.target;h;)c.push(h),h=h.parentNode;return c}function Ys(i,c){if(!c)return new $(i.clientX,i.clientY);var h=Qi(c),p=h.boundingClientRect;return new $((i.clientX-p.left)/h.x-c.clientLeft,(i.clientY-p.top)/h.y-c.clientTop)}var Tt=ve.linux&&ve.chrome?window.devicePixelRatio:ve.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ju(i){return ve.edge?i.wheelDeltaY/2:i.deltaY&&i.deltaMode===0?-i.deltaY/Tt:i.deltaY&&i.deltaMode===1?-i.deltaY*20:i.deltaY&&i.deltaMode===2?-i.deltaY*60:i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&Math.abs(i.detail)<32765?-i.detail*20:i.detail?i.detail/-32765*60:0}function Wl(i,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==i;)h=h.parentNode}catch{return!1}return h!==i}var Ry={__proto__:null,on:De,off:st,stopPropagation:sr,disableScrollPropagation:ns,disableClickPropagation:Vr,preventDefault:It,stop:ar,getPropagationPath:Gs,getMousePosition:Ys,getWheelDelta:Ju,isExternalTarget:Wl,addListener:De,removeListener:st},Qu=F.extend({run:function(i,c,h,p){this.stop(),this._el=i,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=ir(i),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(i){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),i):(this._runFrame(1),this._complete())},_runFrame:function(i,c){var h=this._startPos.add(this._offset.multiplyBy(i));c&&h._round(),dt(this._el,h),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),Xe=F.extend({options:{crs:nt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,c){c=x(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(q(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=On&&ve.any3d&&!ve.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),De(this._proxy,zr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),i=this._limitCenter(q(i),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=o({animate:h.animate},h.zoom),h.pan=o({animate:h.animate,duration:h.duration},h.pan));var p=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,c,h.zoom):this._tryAnimatedPan(i,h.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(i,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(i,c){return this._loaded?this.setView(this.getCenter(),i,{zoom:c}):(this._zoom=i,this)},zoomIn:function(i,c){return i=i||(ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,c)},zoomOut:function(i,c){return i=i||(ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,c)},setZoomAround:function(i,c,h){var p=this.getZoomScale(c),S=this.getSize().divideBy(2),P=i instanceof $?i:this.latLngToContainerPoint(i),U=P.subtract(S).multiplyBy(1-1/p),Z=this.containerPointToLatLng(S.add(U));return this.setView(Z,c,{zoom:h})},_getBoundsCenterZoom:function(i,c){c=c||{},i=i.getBounds?i.getBounds():O(i);var h=re(c.paddingTopLeft||c.padding||[0,0]),p=re(c.paddingBottomRight||c.padding||[0,0]),S=this.getBoundsZoom(i,!1,h.add(p));if(S=typeof c.maxZoom=="number"?Math.min(c.maxZoom,S):S,S===1/0)return{center:i.getCenter(),zoom:S};var P=p.subtract(h).divideBy(2),U=this.project(i.getSouthWest(),S),Z=this.project(i.getNorthEast(),S),J=this.unproject(U.add(Z).divideBy(2).add(P),S);return{center:J,zoom:S}},fitBounds:function(i,c){if(i=O(i),!i.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(i,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,c){return this.setView(i,this._zoom,{pan:c})},panBy:function(i,c){if(i=re(i).round(),c=c||{},!i.x&&!i.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Qu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){Oe(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,c,h){if(h=h||{},h.animate===!1||!ve.any3d)return this.setView(i,c,h);this._stop();var p=this.project(this.getCenter()),S=this.project(i),P=this.getSize(),U=this._zoom;i=q(i),c=c===void 0?U:c;var Z=Math.max(P.x,P.y),J=Z*this.getZoomScale(U,c),ue=S.distanceTo(p)||1,Ce=1.42,Fe=Ce*Ce;function Ge(Lt){var fo=Lt?-1:1,jx=Lt?J:Z,Sx=J*J-Z*Z+fo*Fe*Fe*ue*ue,Cx=2*jx*Fe*ue,ec=Sx/Cx,Th=Math.sqrt(ec*ec+1)-ec,Nx=Th<1e-9?-18:Math.log(Th);return Nx}function Jt(Lt){return(Math.exp(Lt)-Math.exp(-Lt))/2}function Ut(Lt){return(Math.exp(Lt)+Math.exp(-Lt))/2}function Ln(Lt){return Jt(Lt)/Ut(Lt)}var ln=Ge(0);function ls(Lt){return Z*(Ut(ln)/Ut(ln+Ce*Lt))}function xx(Lt){return Z*(Ut(ln)*Ln(ln+Ce*Lt)-Jt(ln))/Fe}function vx(Lt){return 1-Math.pow(1-Lt,1.5)}var _x=Date.now(),Ph=(Ge(1)-ln)/Ce,wx=h.duration?1e3*h.duration:1e3*Ph*.8;function Eh(){var Lt=(Date.now()-_x)/wx,fo=vx(Lt)*Ph;Lt<=1?(this._flyToFrame=M(Eh,this),this._move(this.unproject(p.add(S.subtract(p).multiplyBy(xx(fo)/ue)),U),this.getScaleZoom(Z/ls(fo),U),{flyTo:!0})):this._move(i,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Eh.call(this),this},flyToBounds:function(i,c){var h=this._getBoundsCenterZoom(i,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(i){return i=O(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid()?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var c=this.options.minZoom;return this.options.minZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(i):this},setMaxZoom:function(i){var c=this.options.maxZoom;return this.options.maxZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(i):this},panInsideBounds:function(i,c){this._enforcingBounds=!0;var h=this.getCenter(),p=this._limitCenter(h,this._zoom,O(i));return h.equals(p)||this.panTo(p,c),this._enforcingBounds=!1,this},panInside:function(i,c){c=c||{};var h=re(c.paddingTopLeft||c.padding||[0,0]),p=re(c.paddingBottomRight||c.padding||[0,0]),S=this.project(this.getCenter()),P=this.project(i),U=this.getPixelBounds(),Z=_e([U.min.add(h),U.max.subtract(p)]),J=Z.getSize();if(!Z.contains(P)){this._enforcingBounds=!0;var ue=P.subtract(Z.getCenter()),Ce=Z.extend(P).getSize().subtract(J);S.x+=ue.x<0?-Ce.x:Ce.x,S.y+=ue.y<0?-Ce.y:Ce.y,this.panTo(this.unproject(S),c),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=o({animate:!1,pan:!0},i===!0?{animate:!0}:i);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),p=c.divideBy(2).round(),S=h.divideBy(2).round(),P=p.subtract(S);return!P.x&&!P.y?this:(i.animate&&i.pan?this.panBy(P):(i.pan&&this._rawPanBy(P),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=o({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,i):navigator.geolocation.getCurrentPosition(c,h,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var c=i.code,h=i.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var c=i.coords.latitude,h=i.coords.longitude,p=new ne(c,h),S=p.toBounds(i.coords.accuracy*2),P=this._locateOptions;if(P.setView){var U=this.getBoundsZoom(S);this.setView(p,P.maxZoom?Math.min(U,P.maxZoom):U)}var Z={latlng:p,bounds:S,timestamp:i.timestamp};for(var J in i.coords)typeof i.coords[J]=="number"&&(Z[J]=i.coords[J]);this.fire("locationfound",Z)}},addHandler:function(i,c){if(!c)return this;var h=this[i]=new c(this);return this._handlers.push(h),this.options[i]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),it(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)it(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,c){var h="leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),p=qe("div",h,c||this._mapPane);return i&&(this._panes[i]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),c=this.unproject(i.getBottomLeft()),h=this.unproject(i.getTopRight());return new se(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,c,h){i=O(i),h=re(h||[0,0]);var p=this.getZoom()||0,S=this.getMinZoom(),P=this.getMaxZoom(),U=i.getNorthWest(),Z=i.getSouthEast(),J=this.getSize().subtract(h),ue=_e(this.project(Z,p),this.project(U,p)).getSize(),Ce=ve.any3d?this.options.zoomSnap:1,Fe=J.x/ue.x,Ge=J.y/ue.y,Jt=c?Math.max(Fe,Ge):Math.min(Fe,Ge);return p=this.getScaleZoom(Jt,p),Ce&&(p=Math.round(p/(Ce/100))*(Ce/100),p=c?Math.ceil(p/Ce)*Ce:Math.floor(p/Ce)*Ce),Math.max(S,Math.min(P,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new $(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,c){var h=this._getTopLeftPoint(i,c);return new fe(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(i===void 0?this.getZoom():i)},getPane:function(i){return typeof i=="string"?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(i)/h.scale(c)},getScaleZoom:function(i,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var p=h.zoom(i*h.scale(c));return isNaN(p)?1/0:p},project:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(q(i),c)},unproject:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(re(i),c)},layerPointToLatLng:function(i){var c=re(i).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(i){var c=this.project(q(i))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(q(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(O(i))},distance:function(i,c){return this.options.crs.distance(q(i),q(c))},containerPointToLayerPoint:function(i){return re(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return re(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var c=this.containerPointToLayerPoint(re(i));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(i)))},mouseEventToContainerPoint:function(i){return Ys(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var c=this._container=$r(i);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");De(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&ve.any3d,Oe(i,"leaflet-container"+(ve.touch?" leaflet-touch":"")+(ve.retina?" leaflet-retina":"")+(ve.ielt9?" leaflet-oldie":"")+(ve.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Dn(i,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),dt(this._mapPane,new $(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Oe(i.markerPane,"leaflet-zoom-hide"),Oe(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,c,h){dt(this._mapPane,new $(0,0));var p=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var S=this._zoom!==c;this._moveStart(S,h)._move(i,c)._moveEnd(S),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(i,c){return i&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(i,c,h,p){c===void 0&&(c=this._zoom);var S=this._zoom!==c;return this._zoom=c,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),p?h&&h.pinch&&this.fire("zoom",h):((S||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){dt(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[u(this._container)]=this;var c=i?st:De;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),ve.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,c){for(var h=[],p,S=c==="mouseout"||c==="mouseover",P=i.target||i.srcElement,U=!1;P;){if(p=this._targets[u(P)],p&&(c==="click"||c==="preclick")&&this._draggableMoved(p)){U=!0;break}if(p&&p.listens(c,!0)&&(S&&!Wl(P,i)||(h.push(p),S))||P===this._container)break;P=P.parentNode}return!h.length&&!U&&!S&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var c=i.target||i.srcElement;if(!(!this._loaded||c._leaflet_disable_events||i.type==="click"&&this._isClickDisabled(c))){var h=i.type;h==="mousedown"&&Ji(c),this._fireDOMEvent(i,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,c,h){if(i.type==="click"){var p=o({},i);p.type="preclick",this._fireDOMEvent(p,p.type,h)}var S=this._findEventTargets(i,c);if(h){for(var P=[],U=0;U<h.length;U++)h[U].listens(c,!0)&&P.push(h[U]);S=P.concat(S)}if(S.length){c==="contextmenu"&&It(i);var Z=S[0],J={originalEvent:i};if(i.type!=="keypress"&&i.type!=="keydown"&&i.type!=="keyup"){var ue=Z.getLatLng&&(!Z._radius||Z._radius<=10);J.containerPoint=ue?this.latLngToContainerPoint(Z.getLatLng()):this.mouseEventToContainerPoint(i),J.layerPoint=this.containerPointToLayerPoint(J.containerPoint),J.latlng=ue?Z.getLatLng():this.layerPointToLatLng(J.layerPoint)}for(U=0;U<S.length;U++)if(S[U].fire(c,J,!0),J.originalEvent._stopped||S[U].options.bubblingMouseEvents===!1&&b(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(i){return i=i.dragging&&i.dragging.enabled()?i:this,i.dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,c=this._handlers.length;i<c;i++)this._handlers[i].disable()},whenReady:function(i,c){return this._loaded?i.call(c||this,{target:this}):this.on("load",i,c),this},_getMapPanePos:function(){return ir(this._mapPane)||new $(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,c){var h=i&&c!==void 0?this._getNewPixelOrigin(i,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,c){var h=this.getSize()._divideBy(2);return this.project(i,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,c,h){var p=this._getNewPixelOrigin(h,c);return this.project(i,c)._subtract(p)},_latLngBoundsToNewLayerBounds:function(i,c,h){var p=this._getNewPixelOrigin(h,c);return _e([this.project(i.getSouthWest(),c)._subtract(p),this.project(i.getNorthWest(),c)._subtract(p),this.project(i.getSouthEast(),c)._subtract(p),this.project(i.getNorthEast(),c)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,c,h){if(!h)return i;var p=this.project(i,c),S=this.getSize().divideBy(2),P=new fe(p.subtract(S),p.add(S)),U=this._getBoundsOffset(P,h,c);return Math.abs(U.x)<=1&&Math.abs(U.y)<=1?i:this.unproject(p.add(U),c)},_limitOffset:function(i,c){if(!c)return i;var h=this.getPixelBounds(),p=new fe(h.min.add(i),h.max.add(i));return i.add(this._getBoundsOffset(p,c))},_getBoundsOffset:function(i,c,h){var p=_e(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),S=p.min.subtract(i.min),P=p.max.subtract(i.max),U=this._rebound(S.x,-P.x),Z=this._rebound(S.y,-P.y);return new $(U,Z)},_rebound:function(i,c){return i+c>0?Math.round(i-c)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(c))},_limitZoom:function(i){var c=this.getMinZoom(),h=this.getMaxZoom(),p=ve.any3d?this.options.zoomSnap:1;return p&&(i=Math.round(i/p)*p),Math.max(c,Math.min(h,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ct(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,c){var h=this._getCenterOffset(i)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var i=this._proxy=qe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(c){var h=Dr,p=this._proxy.style[h];Je(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),p===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){it(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),c=this.getZoom();Je(this._proxy,this.project(i,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(c),S=this._getCenterOffset(i)._divideBy(1-1/p);return h.animate!==!0&&!this.getSize().contains(S)?!1:(M(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(i,c,!0)},this),!0)},_animateZoom:function(i,c,h,p){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=c,Oe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:c,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ct(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ay(i,c){return new Xe(i,c)}var zn=z.extend({options:{position:"topright"},initialize:function(i){x(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var c=this._map;return c&&c.removeControl(this),this.options.position=i,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var c=this._container=this.onAdd(i),h=this.getPosition(),p=i._controlCorners[h];return Oe(c,"leaflet-control"),h.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(it(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),Ks=function(i){return new zn(i)};Xe.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},c="leaflet-",h=this._controlContainer=qe("div",c+"control-container",this._container);function p(S,P){var U=c+S+" "+c+P;i[S+P]=qe("div",U,h)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)it(this._controlCorners[i]);it(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Xu=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,c,h,p){return h<p?-1:p<h?1:0}},initialize:function(i,c,h){x(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in i)this._addLayer(i[p],p);for(p in c)this._addLayer(c[p],p,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return zn.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,c){return this._addLayer(i,c),this._map?this._update():this},addOverlay:function(i,c){return this._addLayer(i,c,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(i));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){Oe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(Oe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):ct(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ct(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",c=this._container=qe("div",i),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Vr(c),ns(c);var p=this._section=qe("section",i+"-list");h&&(this._map.on("click",this.collapse,this),De(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var S=this._layersLink=qe("a",i+"-toggle",c);S.href="#",S.title="Layers",S.setAttribute("role","button"),De(S,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){It(P),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=qe("div",i+"-base",p),this._separator=qe("div",i+"-separator",p),this._overlaysList=qe("div",i+"-overlays",p),c.appendChild(p)},_getLayer:function(i){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===i)return this._layers[c]},_addLayer:function(i,c,h){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(p,S){return this.options.sortFunction(p.layer,S.layer,p.name,S.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;tr(this._baseLayersList),tr(this._overlaysList),this._layerControlInputs=[];var i,c,h,p,S=0;for(h=0;h<this._layers.length;h++)p=this._layers[h],this._addItem(p),c=c||p.overlay,i=i||!p.overlay,S+=p.overlay?0:1;return this.options.hideSingleBase&&(i=i&&S>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=c&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var c=this._getLayer(u(i.target)),h=c.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(i,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(c?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=h,p.firstChild},_addItem:function(i){var c=document.createElement("label"),h=this._map.hasLayer(i.layer),p;i.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=h):p=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(p),p.layerId=u(i.layer),De(p,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+i.name;var P=document.createElement("span");c.appendChild(P),P.appendChild(p),P.appendChild(S);var U=i.overlay?this._overlaysList:this._baseLayersList;return U.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var i=this._layerControlInputs,c,h,p=[],S=[];this._handlingClick=!0;for(var P=i.length-1;P>=0;P--)c=i[P],h=this._getLayer(c.layerId).layer,c.checked?p.push(h):c.checked||S.push(h);for(P=0;P<S.length;P++)this._map.hasLayer(S[P])&&this._map.removeLayer(S[P]);for(P=0;P<p.length;P++)this._map.hasLayer(p[P])||this._map.addLayer(p[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i=this._layerControlInputs,c,h,p=this._map.getZoom(),S=i.length-1;S>=0;S--)c=i[S],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&p<h.options.minZoom||h.options.maxZoom!==void 0&&p>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,De(i,"click",It),this.expand();var c=this;setTimeout(function(){st(i,"click",It),c._preventClick=!1})}}),My=function(i,c,h){return new Xu(i,c,h)},Hl=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var c="leaflet-control-zoom",h=qe("div",c+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,c,h,p,S){var P=qe("a",h,p);return P.innerHTML=i,P.href="#",P.title=c,P.setAttribute("role","button"),P.setAttribute("aria-label",c),Vr(P),De(P,"click",ar),De(P,"click",S,this),De(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var i=this._map,c="leaflet-disabled";ct(this._zoomInButton,c),ct(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(Oe(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(Oe(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Xe.mergeOptions({zoomControl:!0}),Xe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Hl,this.addControl(this.zoomControl))});var Fy=function(i){return new Hl(i)},eh=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var c="leaflet-control-scale",h=qe("div",c),p=this.options;return this._addScales(p,c+"-line",h),i.on(p.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),h},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,c,h){i.metric&&(this._mScale=qe("div",c,h)),i.imperial&&(this._iScale=qe("div",c,h))},_update:function(){var i=this._map,c=i.getSize().y/2,h=i.distance(i.containerPointToLatLng([0,c]),i.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var c=this._getRoundNum(i),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/i)},_updateImperial:function(i){var c=i*3.2808399,h,p,S;c>5280?(h=c/5280,p=this._getRoundNum(h),this._updateScale(this._iScale,p+" mi",p/h)):(S=this._getRoundNum(c),this._updateScale(this._iScale,S+" ft",S/c))},_updateScale:function(i,c,h){i.style.width=Math.round(this.options.maxWidth*h)+"px",i.innerHTML=c},_getRoundNum:function(i){var c=Math.pow(10,(Math.floor(i)+"").length-1),h=i/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),Uy=function(i){return new eh(i)},Oy='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Zl=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ve.inlineSvg?Oy+" ":"")+"Leaflet</a>"},initialize:function(i){x(this,i),this._attributions={}},onAdd:function(i){i.attributionControl=this,this._container=qe("div","leaflet-control-attribution"),Vr(this._container);for(var c in i._layers)i._layers[c].getAttribution&&this.addAttribution(i._layers[c].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i?(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update(),this):this},removeAttribution:function(i){return i?(this._attributions[i]&&(this._attributions[i]--,this._update()),this):this},_update:function(){if(this._map){var i=[];for(var c in this._attributions)this._attributions[c]&&i.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),i.length&&h.push(i.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});Xe.mergeOptions({attributionControl:!0}),Xe.addInitHook(function(){this.options.attributionControl&&new Zl().addTo(this)});var Dy=function(i){return new Zl(i)};zn.Layers=Xu,zn.Zoom=Hl,zn.Scale=eh,zn.Attribution=Zl,Ks.layers=My,Ks.zoom=Fy,Ks.scale=Uy,Ks.attribution=Dy;var or=z.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});or.addTo=function(i,c){return i.addHandler(c,this),this};var zy={Events:K},th=ve.touch?"touchstart mousedown":"mousedown",qr=F.extend({options:{clickTolerance:3},initialize:function(i,c,h,p){x(this,p),this._element=i,this._dragStartTarget=c||i,this._preventOutline=h},enable:function(){this._enabled||(De(this._dragStartTarget,th,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(qr._dragging===this&&this.finishDrag(!0),st(this._dragStartTarget,th,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(this._enabled&&(this._moved=!1,!vr(this._element,"leaflet-zoom-anim"))){if(i.touches&&i.touches.length!==1){qr._dragging===this&&this.finishDrag();return}if(!(qr._dragging||i.shiftKey||i.which!==1&&i.button!==1&&!i.touches)&&(qr._dragging=this,this._preventOutline&&Ji(this._element),Gi(),Wr(),!this._moving)){this.fire("down");var c=i.touches?i.touches[0]:i,h=Vs(this._element);this._startPoint=new $(c.clientX,c.clientY),this._startPos=ir(this._element),this._parentScale=Qi(h);var p=i.type==="mousedown";De(document,p?"mousemove":"touchmove",this._onMove,this),De(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var c=i.touches&&i.touches.length===1?i.touches[0]:i,h=new $(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,It(i),this._moved||(this.fire("dragstart"),this._moved=!0,Oe(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Oe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=i,this._updatePosition())}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),dt(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){ct(document.body,"leaflet-dragging"),this._lastTarget&&(ct(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),st(document,"mousemove touchmove",this._onMove,this),st(document,"mouseup touchend touchcancel",this._onUp,this),Yi(),Hr();var c=this._moved&&this._moving;this._moving=!1,qr._dragging=!1,c&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function nh(i,c,h){var p,S=[1,4,2,8],P,U,Z,J,ue,Ce,Fe,Ge;for(P=0,Ce=i.length;P<Ce;P++)i[P]._code=ji(i[P],c);for(Z=0;Z<4;Z++){for(Fe=S[Z],p=[],P=0,Ce=i.length,U=Ce-1;P<Ce;U=P++)J=i[P],ue=i[U],J._code&Fe?ue._code&Fe||(Ge=to(ue,J,Fe,c,h),Ge._code=ji(Ge,c),p.push(Ge)):(ue._code&Fe&&(Ge=to(ue,J,Fe,c,h),Ge._code=ji(Ge,c),p.push(Ge)),p.push(J));i=p}return i}function rh(i,c){var h,p,S,P,U,Z,J,ue,Ce;if(!i||i.length===0)throw new Error("latlngs not passed");In(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Fe=q([0,0]),Ge=O(i),Jt=Ge.getNorthWest().distanceTo(Ge.getSouthWest())*Ge.getNorthEast().distanceTo(Ge.getNorthWest());Jt<1700&&(Fe=Vl(i));var Ut=i.length,Ln=[];for(h=0;h<Ut;h++){var ln=q(i[h]);Ln.push(c.project(q([ln.lat-Fe.lat,ln.lng-Fe.lng])))}for(Z=J=ue=0,h=0,p=Ut-1;h<Ut;p=h++)S=Ln[h],P=Ln[p],U=S.y*P.x-P.y*S.x,J+=(S.x+P.x)*U,ue+=(S.y+P.y)*U,Z+=U*3;Z===0?Ce=Ln[0]:Ce=[J/Z,ue/Z];var ls=c.unproject(re(Ce));return q([ls.lat+Fe.lat,ls.lng+Fe.lng])}function Vl(i){for(var c=0,h=0,p=0,S=0;S<i.length;S++){var P=q(i[S]);c+=P.lat,h+=P.lng,p++}return q([c/p,h/p])}var $y={__proto__:null,clipPolygon:nh,polygonCenter:rh,centroid:Vl};function ih(i,c){if(!c||!i.length)return i.slice();var h=c*c;return i=Zy(i,h),i=Hy(i,h),i}function sh(i,c,h){return Math.sqrt(Js(i,c,h,!0))}function Wy(i,c,h){return Js(i,c,h)}function Hy(i,c){var h=i.length,p=typeof Uint8Array<"u"?Uint8Array:Array,S=new p(h);S[0]=S[h-1]=1,ql(i,S,c,0,h-1);var P,U=[];for(P=0;P<h;P++)S[P]&&U.push(i[P]);return U}function ql(i,c,h,p,S){var P=0,U,Z,J;for(Z=p+1;Z<=S-1;Z++)J=Js(i[Z],i[p],i[S],!0),J>P&&(U=Z,P=J);P>h&&(c[U]=1,ql(i,c,h,p,U),ql(i,c,h,U,S))}function Zy(i,c){for(var h=[i[0]],p=1,S=0,P=i.length;p<P;p++)Vy(i[p],i[S])>c&&(h.push(i[p]),S=p);return S<P-1&&h.push(i[P-1]),h}var ah;function oh(i,c,h,p,S){var P=p?ah:ji(i,h),U=ji(c,h),Z,J,ue;for(ah=U;;){if(!(P|U))return[i,c];if(P&U)return!1;Z=P||U,J=to(i,c,Z,h,S),ue=ji(J,h),Z===P?(i=J,P=ue):(c=J,U=ue)}}function to(i,c,h,p,S){var P=c.x-i.x,U=c.y-i.y,Z=p.min,J=p.max,ue,Ce;return h&8?(ue=i.x+P*(J.y-i.y)/U,Ce=J.y):h&4?(ue=i.x+P*(Z.y-i.y)/U,Ce=Z.y):h&2?(ue=J.x,Ce=i.y+U*(J.x-i.x)/P):h&1&&(ue=Z.x,Ce=i.y+U*(Z.x-i.x)/P),new $(ue,Ce,S)}function ji(i,c){var h=0;return i.x<c.min.x?h|=1:i.x>c.max.x&&(h|=2),i.y<c.min.y?h|=4:i.y>c.max.y&&(h|=8),h}function Vy(i,c){var h=c.x-i.x,p=c.y-i.y;return h*h+p*p}function Js(i,c,h,p){var S=c.x,P=c.y,U=h.x-S,Z=h.y-P,J=U*U+Z*Z,ue;return J>0&&(ue=((i.x-S)*U+(i.y-P)*Z)/J,ue>1?(S=h.x,P=h.y):ue>0&&(S+=U*ue,P+=Z*ue)),U=i.x-S,Z=i.y-P,p?U*U+Z*Z:new $(S,P)}function In(i){return!N(i[0])||typeof i[0][0]!="object"&&typeof i[0][0]<"u"}function lh(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),In(i)}function ch(i,c){var h,p,S,P,U,Z,J,ue;if(!i||i.length===0)throw new Error("latlngs not passed");In(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Ce=q([0,0]),Fe=O(i),Ge=Fe.getNorthWest().distanceTo(Fe.getSouthWest())*Fe.getNorthEast().distanceTo(Fe.getNorthWest());Ge<1700&&(Ce=Vl(i));var Jt=i.length,Ut=[];for(h=0;h<Jt;h++){var Ln=q(i[h]);Ut.push(c.project(q([Ln.lat-Ce.lat,Ln.lng-Ce.lng])))}for(h=0,p=0;h<Jt-1;h++)p+=Ut[h].distanceTo(Ut[h+1])/2;if(p===0)ue=Ut[0];else for(h=0,P=0;h<Jt-1;h++)if(U=Ut[h],Z=Ut[h+1],S=U.distanceTo(Z),P+=S,P>p){J=(P-p)/S,ue=[Z.x-J*(Z.x-U.x),Z.y-J*(Z.y-U.y)];break}var ln=c.unproject(re(ue));return q([ln.lat+Ce.lat,ln.lng+Ce.lng])}var qy={__proto__:null,simplify:ih,pointToSegmentDistance:sh,closestPointOnSegment:Wy,clipSegment:oh,_getEdgeIntersection:to,_getBitCode:ji,_sqClosestPointOnSegment:Js,isFlat:In,_flat:lh,polylineCenter:ch},Gl={project:function(i){return new $(i.lng,i.lat)},unproject:function(i){return new ne(i.y,i.x)},bounds:new fe([-180,-90],[180,90])},Yl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new fe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(i){var c=Math.PI/180,h=this.R,p=i.lat*c,S=this.R_MINOR/h,P=Math.sqrt(1-S*S),U=P*Math.sin(p),Z=Math.tan(Math.PI/4-p/2)/Math.pow((1-U)/(1+U),P/2);return p=-h*Math.log(Math.max(Z,1e-10)),new $(i.lng*c*h,p)},unproject:function(i){for(var c=180/Math.PI,h=this.R,p=this.R_MINOR/h,S=Math.sqrt(1-p*p),P=Math.exp(-i.y/h),U=Math.PI/2-2*Math.atan(P),Z=0,J=.1,ue;Z<15&&Math.abs(J)>1e-7;Z++)ue=S*Math.sin(U),ue=Math.pow((1-ue)/(1+ue),S/2),J=Math.PI/2-2*Math.atan(P*ue)-U,U+=J;return new ne(U*c,i.x*c/h)}},Gy={__proto__:null,LonLat:Gl,Mercator:Yl,SphericalMercator:Se},Yy=o({},Le,{code:"EPSG:3395",projection:Yl,transformation:function(){var i=.5/(Math.PI*Yl.R);return pe(i,.5,-i,.5)}()}),dh=o({},Le,{code:"EPSG:4326",projection:Gl,transformation:pe(1/180,1,-1/180,.5)}),Ky=o({},we,{projection:Gl,transformation:pe(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,c){var h=c.lng-i.lng,p=c.lat-i.lat;return Math.sqrt(h*h+p*p)},infinite:!0});we.Earth=Le,we.EPSG3395=Yy,we.EPSG3857=nt,we.EPSG900913=sn,we.EPSG4326=dh,we.Simple=Ky;var $n=F.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[u(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[u(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var c=i.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Xe.include({addLayer:function(i){if(!i._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(i);return this._layers[c]?this:(this._layers[c]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i),this)},removeLayer:function(i){var c=u(i);return this._layers[c]?(this._loaded&&i.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this},hasLayer:function(i){return u(i)in this._layers},eachLayer:function(i,c){for(var h in this._layers)i.call(c,this._layers[h]);return this},_addLayers:function(i){i=i?N(i)?i:[i]:[];for(var c=0,h=i.length;c<h;c++)this.addLayer(i[c])},_addZoomLimit:function(i){(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom))&&(this._zoomBoundLayers[u(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var c=u(i);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,c=-1/0,h=this._getZoomSpan();for(var p in this._zoomBoundLayers){var S=this._zoomBoundLayers[p].options;i=S.minZoom===void 0?i:Math.min(i,S.minZoom),c=S.maxZoom===void 0?c:Math.max(c,S.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=i===1/0?void 0:i,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var rs=$n.extend({initialize:function(i,c){x(this,c),this._layers={};var h,p;if(i)for(h=0,p=i.length;h<p;h++)this.addLayer(i[h])},addLayer:function(i){var c=this.getLayerId(i);return this._layers[c]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var c=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(i){var c=typeof i=="number"?i:this.getLayerId(i);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var c=Array.prototype.slice.call(arguments,1),h,p;for(h in this._layers)p=this._layers[h],p[i]&&p[i].apply(p,c);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,c){for(var h in this._layers)i.call(c,this._layers[h]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return u(i)}}),Jy=function(i,c){return new rs(i,c)},wr=rs.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),rs.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),rs.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new se;for(var c in this._layers){var h=this._layers[c];i.extend(h.getBounds?h.getBounds():h.getLatLng())}return i}}),Qy=function(i,c){return new wr(i,c)},is=z.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){x(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,c){var h=this._getIconUrl(i);if(!h){if(i==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(p,i),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(i,c){var h=this.options,p=h[c+"Size"];typeof p=="number"&&(p=[p,p]);var S=re(p),P=re(c==="shadow"&&h.shadowAnchor||h.iconAnchor||S&&S.divideBy(2,!0));i.className="leaflet-marker-"+c+" "+(h.className||""),P&&(i.style.marginLeft=-P.x+"px",i.style.marginTop=-P.y+"px"),S&&(i.style.width=S.x+"px",i.style.height=S.y+"px")},_createImg:function(i,c){return c=c||document.createElement("img"),c.src=i,c},_getIconUrl:function(i){return ve.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}});function Xy(i){return new is(i)}var Qs=is.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return typeof Qs.imagePath!="string"&&(Qs.imagePath=this._detectIconPath()),(this.options.imagePath||Qs.imagePath)+is.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var c=function(h,p,S){var P=p.exec(h);return P&&P[S]};return i=c(i,/^url\((['"])?(.+)\1\)$/,2),i&&c(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=qe("div","leaflet-default-icon-path",document.body),c=Dn(i,"background-image")||Dn(i,"backgroundImage");if(document.body.removeChild(i),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),uh=or.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new qr(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Oe(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ct(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var c=this._marker,h=c._map,p=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,P=ir(c._icon),U=h.getPixelBounds(),Z=h.getPixelOrigin(),J=_e(U.min._subtract(Z).add(S),U.max._subtract(Z).subtract(S));if(!J.contains(P)){var ue=re((Math.max(J.max.x,P.x)-J.max.x)/(U.max.x-J.max.x)-(Math.min(J.min.x,P.x)-J.min.x)/(U.min.x-J.min.x),(Math.max(J.max.y,P.y)-J.max.y)/(U.max.y-J.max.y)-(Math.min(J.min.y,P.y)-J.min.y)/(U.min.y-J.min.y)).multiplyBy(p);h.panBy(ue,{animate:!1}),this._draggable._newPos._add(ue),this._draggable._startPos._add(ue),dt(c._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=M(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,i)))},_onDrag:function(i){var c=this._marker,h=c._shadow,p=ir(c._icon),S=c._map.layerPointToLatLng(p);h&&dt(h,p),c._latlng=S,i.latlng=S,i.oldLatLng=this._oldLatLng,c.fire("move",i).fire("drag",i)},_onDragEnd:function(i){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),no=$n.extend({options:{icon:new Qs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,c){x(this,c),this._latlng=q(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var c=this._latlng;return this._latlng=q(i),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=i.icon.createIcon(this._icon),p=!1;h!==this._icon&&(this._icon&&this._removeIcon(),p=!0,i.title&&(h.title=i.title),h.tagName==="IMG"&&(h.alt=i.alt||"")),Oe(h,c),i.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&De(h,"focus",this._panOnFocus,this);var S=i.icon.createShadow(this._shadow),P=!1;S!==this._shadow&&(this._removeShadow(),P=!0),S&&(Oe(S,c),S.alt=""),this._shadow=S,i.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&P&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(this._icon,"focus",this._panOnFocus,this),it(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&it(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&dt(this._icon,i),this._shadow&&dt(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(Oe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),uh)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new uh(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&Ft(this._icon,i),this._shadow&&Ft(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var c=this.options.icon.options,h=c.iconSize?re(c.iconSize):re(0,0),p=c.iconAnchor?re(c.iconAnchor):re(0,0);i.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:h.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ex(i,c){return new no(i,c)}var Gr=$n.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return x(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ro=Gr.extend({options:{fill:!0,radius:10},initialize:function(i,c){x(this,c),this._latlng=q(i),this._radius=this.options.radius},setLatLng:function(i){var c=this._latlng;return this._latlng=q(i),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var c=i&&i.radius||this._radius;return Gr.prototype.setStyle.call(this,i),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,c=this._radiusY||i,h=this._clickTolerance(),p=[i+h,c+h];this._pxBounds=new fe(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function tx(i,c){return new ro(i,c)}var Kl=ro.extend({initialize:function(i,c,h){if(typeof c=="number"&&(c=o({},h,{radius:c})),x(this,c),this._latlng=q(i),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new se(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:Gr.prototype.setStyle,_project:function(){var i=this._latlng.lng,c=this._latlng.lat,h=this._map,p=h.options.crs;if(p.distance===Le.distance){var S=Math.PI/180,P=this._mRadius/Le.R/S,U=h.project([c+P,i]),Z=h.project([c-P,i]),J=U.add(Z).divideBy(2),ue=h.unproject(J).lat,Ce=Math.acos((Math.cos(P*S)-Math.sin(c*S)*Math.sin(ue*S))/(Math.cos(c*S)*Math.cos(ue*S)))/S;(isNaN(Ce)||Ce===0)&&(Ce=P/Math.cos(Math.PI/180*c)),this._point=J.subtract(h.getPixelOrigin()),this._radius=isNaN(Ce)?0:J.x-h.project([ue,i-Ce]).x,this._radiusY=J.y-U.y}else{var Fe=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(Fe).x}this._updateBounds()}});function nx(i,c,h){return new Kl(i,c,h)}var jr=Gr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,c){x(this,c),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var c=1/0,h=null,p=Js,S,P,U=0,Z=this._parts.length;U<Z;U++)for(var J=this._parts[U],ue=1,Ce=J.length;ue<Ce;ue++){S=J[ue-1],P=J[ue];var Fe=p(i,S,P,!0);Fe<c&&(c=Fe,h=p(i,S,P))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ch(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,c){return c=c||this._defaultShape(),i=q(i),c.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new se,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return In(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var c=[],h=In(i),p=0,S=i.length;p<S;p++)h?(c[p]=q(i[p]),this._bounds.extend(c[p])):c[p]=this._convertLatLngs(i[p]);return c},_project:function(){var i=new fe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),c=new $(i,i);this._rawPxBounds&&(this._pxBounds=new fe([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(i,c,h){var p=i[0]instanceof ne,S=i.length,P,U;if(p){for(U=[],P=0;P<S;P++)U[P]=this._map.latLngToLayerPoint(i[P]),h.extend(U[P]);c.push(U)}else for(P=0;P<S;P++)this._projectLatlngs(i[P],c,h)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,p,S,P,U,Z,J;for(h=0,S=0,P=this._rings.length;h<P;h++)for(J=this._rings[h],p=0,U=J.length;p<U-1;p++)Z=oh(J[p],J[p+1],i,p,!0),Z&&(c[S]=c[S]||[],c[S].push(Z[0]),(Z[1]!==J[p+1]||p===U-2)&&(c[S].push(Z[1]),S++))}},_simplifyPoints:function(){for(var i=this._parts,c=this.options.smoothFactor,h=0,p=i.length;h<p;h++)i[h]=ih(i[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,c){var h,p,S,P,U,Z,J=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(h=0,P=this._parts.length;h<P;h++)for(Z=this._parts[h],p=0,U=Z.length,S=U-1;p<U;S=p++)if(!(!c&&p===0)&&sh(i,Z[S],Z[p])<=J)return!0;return!1}});function rx(i,c){return new jr(i,c)}jr._flat=lh;var ss=jr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return rh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var c=jr.prototype._convertLatLngs.call(this,i),h=c.length;return h>=2&&c[0]instanceof ne&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(i){jr.prototype._setLatLngs.call(this,i),In(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return In(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,c=this.options.weight,h=new $(c,c);if(i=new fe(i.min.subtract(h),i.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,S=this._rings.length,P;p<S;p++)P=nh(this._rings[p],i,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var c=!1,h,p,S,P,U,Z,J,ue;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(P=0,J=this._parts.length;P<J;P++)for(h=this._parts[P],U=0,ue=h.length,Z=ue-1;U<ue;Z=U++)p=h[U],S=h[Z],p.y>i.y!=S.y>i.y&&i.x<(S.x-p.x)*(i.y-p.y)/(S.y-p.y)+p.x&&(c=!c);return c||jr.prototype._containsPoint.call(this,i,!0)}});function ix(i,c){return new ss(i,c)}var Sr=wr.extend({initialize:function(i,c){x(this,c),this._layers={},i&&this.addData(i)},addData:function(i){var c=N(i)?i:i.features,h,p,S;if(c){for(h=0,p=c.length;h<p;h++)S=c[h],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var P=this.options;if(P.filter&&!P.filter(i))return this;var U=io(i,P);return U?(U.feature=oo(i),U.defaultOptions=U.options,this.resetStyle(U),P.onEachFeature&&P.onEachFeature(i,U),this.addLayer(U)):this},resetStyle:function(i){return i===void 0?this.eachLayer(this.resetStyle,this):(i.options=o({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(c){this._setLayerStyle(c,i)},this)},_setLayerStyle:function(i,c){i.setStyle&&(typeof c=="function"&&(c=c(i.feature)),i.setStyle(c))}});function io(i,c){var h=i.type==="Feature"?i.geometry:i,p=h?h.coordinates:null,S=[],P=c&&c.pointToLayer,U=c&&c.coordsToLatLng||Jl,Z,J,ue,Ce;if(!p&&!h)return null;switch(h.type){case"Point":return Z=U(p),hh(P,i,Z,c);case"MultiPoint":for(ue=0,Ce=p.length;ue<Ce;ue++)Z=U(p[ue]),S.push(hh(P,i,Z,c));return new wr(S);case"LineString":case"MultiLineString":return J=so(p,h.type==="LineString"?0:1,U),new jr(J,c);case"Polygon":case"MultiPolygon":return J=so(p,h.type==="Polygon"?1:2,U),new ss(J,c);case"GeometryCollection":for(ue=0,Ce=h.geometries.length;ue<Ce;ue++){var Fe=io({geometry:h.geometries[ue],type:"Feature",properties:i.properties},c);Fe&&S.push(Fe)}return new wr(S);case"FeatureCollection":for(ue=0,Ce=h.features.length;ue<Ce;ue++){var Ge=io(h.features[ue],c);Ge&&S.push(Ge)}return new wr(S);default:throw new Error("Invalid GeoJSON object.")}}function hh(i,c,h,p){return i?i(c,h):new no(h,p&&p.markersInheritOptions&&p)}function Jl(i){return new ne(i[1],i[0],i[2])}function so(i,c,h){for(var p=[],S=0,P=i.length,U;S<P;S++)U=c?so(i[S],c-1,h):(h||Jl)(i[S]),p.push(U);return p}function Ql(i,c){return i=q(i),i.alt!==void 0?[y(i.lng,c),y(i.lat,c),y(i.alt,c)]:[y(i.lng,c),y(i.lat,c)]}function ao(i,c,h,p){for(var S=[],P=0,U=i.length;P<U;P++)S.push(c?ao(i[P],In(i[P])?0:c-1,h,p):Ql(i[P],p));return!c&&h&&S.length>0&&S.push(S[0].slice()),S}function as(i,c){return i.feature?o({},i.feature,{geometry:c}):oo(c)}function oo(i){return i.type==="Feature"||i.type==="FeatureCollection"?i:{type:"Feature",properties:{},geometry:i}}var Xl={toGeoJSON:function(i){return as(this,{type:"Point",coordinates:Ql(this.getLatLng(),i)})}};no.include(Xl),Kl.include(Xl),ro.include(Xl),jr.include({toGeoJSON:function(i){var c=!In(this._latlngs),h=ao(this._latlngs,c?1:0,!1,i);return as(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ss.include({toGeoJSON:function(i){var c=!In(this._latlngs),h=c&&!In(this._latlngs[0]),p=ao(this._latlngs,h?2:c?1:0,!0,i);return c||(p=[p]),as(this,{type:(h?"Multi":"")+"Polygon",coordinates:p})}}),rs.include({toMultiPoint:function(i){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(i).geometry.coordinates)}),as(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(i){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(i);var h=c==="GeometryCollection",p=[];return this.eachLayer(function(S){if(S.toGeoJSON){var P=S.toGeoJSON(i);if(h)p.push(P.geometry);else{var U=oo(P);U.type==="FeatureCollection"?p.push.apply(p,U.features):p.push(U)}}}),h?as(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function fh(i,c){return new Sr(i,c)}var sx=fh,lo=$n.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,c,h){this._url=i,this._bounds=O(c),x(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Oe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){it(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&kn(this._image),this},bringToBack:function(){return this._map&&bn(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=O(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i=this._url.tagName==="IMG",c=this._image=i?this._url:qe("img");if(Oe(c,"leaflet-image-layer"),this._zoomAnimated&&Oe(c,"leaflet-zoom-animated"),this.options.className&&Oe(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(i){var c=this._map.getZoomScale(i.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;Je(this._image,h,c)},_reset:function(){var i=this._image,c=new fe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();dt(i,c.min),i.style.width=h.x+"px",i.style.height=h.y+"px"},_updateOpacity:function(){Ft(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),ax=function(i,c,h){return new lo(i,c,h)},ph=lo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i=this._url.tagName==="VIDEO",c=this._image=i?this._url:qe("video");if(Oe(c,"leaflet-image-layer"),this._zoomAnimated&&Oe(c,"leaflet-zoom-animated"),this.options.className&&Oe(c,this.options.className),c.onselectstart=g,c.onmousemove=g,c.onloadeddata=l(this.fire,this,"load"),i){for(var h=c.getElementsByTagName("source"),p=[],S=0;S<h.length;S++)p.push(h[S].src);this._url=h.length>0?p:[c.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var U=qe("source");U.src=this._url[P],c.appendChild(U)}}});function ox(i,c,h){return new ph(i,c,h)}var mh=lo.extend({_initImage:function(){var i=this._image=this._url;Oe(i,"leaflet-image-layer"),this._zoomAnimated&&Oe(i,"leaflet-zoom-animated"),this.options.className&&Oe(i,this.options.className),i.onselectstart=g,i.onmousemove=g}});function lx(i,c,h){return new mh(i,c,h)}var lr=$n.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,c){i&&(i instanceof ne||N(i))?(this._latlng=q(i),x(this,c)):(x(this,i),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&Ft(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&Ft(this._container,1),this.bringToFront(),this.options.interactive&&(Oe(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(Ft(this._container,0),this._removeTimeout=setTimeout(l(it,void 0,this._container),200)):it(this._container),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=q(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&kn(this._container),this},bringToBack:function(){return this._map&&bn(this._container),this},_prepareOpen:function(i){var c=this._source;if(!c._map)return!1;if(c instanceof wr){c=null;var h=this._source._layers;for(var p in h)if(h[p]._map){c=h[p];break}if(!c)return!1;this._source=c}if(!i)if(c.getCenter)i=c.getCenter();else if(c.getLatLng)i=c.getLatLng();else if(c.getBounds)i=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")i.innerHTML=c;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),c=re(this.options.offset),h=this._getAnchor();this._zoomAnimated?dt(this._container,i.add(h)):c=c.add(i).add(h);var p=this._containerBottom=-c.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=p+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}});Xe.include({_initOverlay:function(i,c,h,p){var S=c;return S instanceof i||(S=new i(p).setContent(c)),h&&S.setLatLng(h),S}}),$n.include({_initOverlay:function(i,c,h,p){var S=h;return S instanceof i?(x(S,p),S._source=this):(S=c&&!p?c:new i(p,this),S.setContent(h)),S}});var co=lr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,lr.prototype.openOn.call(this,i)},onAdd:function(i){lr.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Gr||this._source.on("preclick",sr))},onRemove:function(i){lr.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Gr||this._source.off("preclick",sr))},getEvents:function(){var i=lr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",c=this._container=qe("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=qe("div",i+"-content-wrapper",c);if(this._contentNode=qe("div",i+"-content",h),Vr(c),ns(this._contentNode),De(c,"contextmenu",sr),this._tipContainer=qe("div",i+"-tip-container",c),this._tip=qe("div",i+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=qe("a",i+"-close-button",c);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',De(p,"click",function(S){It(S),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,c=i.style;c.width="",c.whiteSpace="nowrap";var h=i.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var p=i.offsetHeight,S=this.options.maxHeight,P="leaflet-popup-scrolled";S&&p>S?(c.height=S+"px",Oe(i,P)):ct(i,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),h=this._getAnchor();dt(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,c=parseInt(Dn(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,p=this._containerWidth,S=new $(this._containerLeft,-h-this._containerBottom);S._add(ir(this._container));var P=i.layerPointToContainerPoint(S),U=re(this.options.autoPanPadding),Z=re(this.options.autoPanPaddingTopLeft||U),J=re(this.options.autoPanPaddingBottomRight||U),ue=i.getSize(),Ce=0,Fe=0;P.x+p+J.x>ue.x&&(Ce=P.x+p-ue.x+J.x),P.x-Ce-Z.x<0&&(Ce=P.x-Z.x),P.y+h+J.y>ue.y&&(Fe=P.y+h-ue.y+J.y),P.y-Fe-Z.y<0&&(Fe=P.y-Z.y),(Ce||Fe)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([Ce,Fe]))}},_getAnchor:function(){return re(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),cx=function(i,c){return new co(i,c)};Xe.mergeOptions({closePopupOnClick:!0}),Xe.include({openPopup:function(i,c,h){return this._initOverlay(co,i,c,h).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),$n.include({bindPopup:function(i,c){return this._popup=this._initOverlay(co,this._popup,i,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof wr||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(!(!this._popup||!this._map)){ar(i);var c=i.layer||i.target;if(this._popup._source===c&&!(c instanceof Gr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=c,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){i.originalEvent.keyCode===13&&this._openPopup(i)}});var uo=lr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){lr.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){lr.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=lr.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip",c=i+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=qe("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var c,h,p=this._map,S=this._container,P=p.latLngToContainerPoint(p.getCenter()),U=p.layerPointToContainerPoint(i),Z=this.options.direction,J=S.offsetWidth,ue=S.offsetHeight,Ce=re(this.options.offset),Fe=this._getAnchor();Z==="top"?(c=J/2,h=ue):Z==="bottom"?(c=J/2,h=0):Z==="center"?(c=J/2,h=ue/2):Z==="right"?(c=0,h=ue/2):Z==="left"?(c=J,h=ue/2):U.x<P.x?(Z="right",c=0,h=ue/2):(Z="left",c=J+(Ce.x+Fe.x)*2,h=ue/2),i=i.subtract(re(c,h,!0)).add(Ce).add(Fe),ct(S,"leaflet-tooltip-right"),ct(S,"leaflet-tooltip-left"),ct(S,"leaflet-tooltip-top"),ct(S,"leaflet-tooltip-bottom"),Oe(S,"leaflet-tooltip-"+Z),dt(S,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&Ft(this._container,i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(c)},_getAnchor:function(){return re(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),dx=function(i,c){return new uo(i,c)};Xe.include({openTooltip:function(i,c,h){return this._initOverlay(uo,i,c,h).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),$n.include({bindTooltip:function(i,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(uo,this._tooltip,i,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(!(!i&&this._tooltipHandlersAdded)){var c=i?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof wr||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&(De(c,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),De(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var c=i.latlng,h,p;this._tooltip.options.sticky&&i.originalEvent&&(h=this._map.mouseEventToContainerPoint(i.originalEvent),p=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(c)}});var gh=is.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var c=i&&i.tagName==="DIV"?i:document.createElement("div"),h=this.options;if(h.html instanceof Element?(tr(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var p=re(h.bgPos);c.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function ux(i){return new gh(i)}is.Default=Qs;var Xs=$n.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ve.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){x(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),it(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(kn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(bn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof $?i:new $(i,i)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var c=this.getPane().children,h=-i(-1/0,1/0),p=0,S=c.length,P;p<S;p++)P=c[p].style.zIndex,c[p]!==this._container&&P&&(h=i(h,+P));isFinite(h)&&(this.options.zIndex=h+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ve.ielt9){Ft(this._container,this.options.opacity);var i=+new Date,c=!1,h=!1;for(var p in this._tiles){var S=this._tiles[p];if(!(!S.current||!S.loaded)){var P=Math.min(1,(i-S.loaded)/200);Ft(S.el,P),P<1?c=!0:(S.active?h=!0:this._onOpaqueTile(S),S.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(G(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=qe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,c=this.options.maxZoom;if(i!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===i?(this._levels[h].el.style.zIndex=c-Math.abs(i-h),this._onUpdateLevel(h)):(it(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var p=this._levels[i],S=this._map;return p||(p=this._levels[i]={},p.el=qe("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=c,p.origin=S.project(S.unproject(S.getPixelOrigin()),i).round(),p.zoom=i,this._setZoomTransform(p,S.getCenter(),S.getZoom()),g(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var i,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)c=this._tiles[i],c.retain=c.current;for(i in this._tiles)if(c=this._tiles[i],c.current&&!c.active){var p=c.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var c in this._tiles)this._tiles[c].coords.z===i&&this._removeTile(c)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)it(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,c,h,p){var S=Math.floor(i/2),P=Math.floor(c/2),U=h-1,Z=new $(+S,+P);Z.z=+U;var J=this._tileCoordsToKey(Z),ue=this._tiles[J];return ue&&ue.active?(ue.retain=!0,!0):(ue&&ue.loaded&&(ue.retain=!0),U>p?this._retainParent(S,P,U,p):!1)},_retainChildren:function(i,c,h,p){for(var S=2*i;S<2*i+2;S++)for(var P=2*c;P<2*c+2;P++){var U=new $(S,P);U.z=h+1;var Z=this._tileCoordsToKey(U),J=this._tiles[Z];if(J&&J.active){J.retain=!0;continue}else J&&J.loaded&&(J.retain=!0);h+1<p&&this._retainChildren(S,P,h+1,p)}},_resetView:function(i){var c=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var c=this.options;return c.minNativeZoom!==void 0&&i<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<i?c.maxNativeZoom:i},_setView:function(i,c,h,p){var S=Math.round(c);this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom?S=void 0:S=this._clampZoom(S);var P=this.options.updateWhenZooming&&S!==this._tileZoom;(!p||P)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(i),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(i,c)},_setZoomTransforms:function(i,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],i,c)},_setZoomTransform:function(i,c,h){var p=this._map.getZoomScale(h,i.zoom),S=i.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(c,h)).round();ve.any3d?Je(i.el,S,p):dt(i.el,S)},_resetGrid:function(){var i=this._map,c=i.options.crs,h=this._tileSize=this.getTileSize(),p=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,c.wrapLng[0]],p).x/h.x),Math.ceil(i.project([0,c.wrapLng[1]],p).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([c.wrapLat[0],0],p).y/h.x),Math.ceil(i.project([c.wrapLat[1],0],p).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(i){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),p=c.getZoomScale(h,this._tileZoom),S=c.project(i,this._tileZoom).floor(),P=c.getSize().divideBy(p*2);return new fe(S.subtract(P),S.add(P))},_update:function(i){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(i===void 0&&(i=c.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(i),S=this._pxBoundsToTileRange(p),P=S.getCenter(),U=[],Z=this.options.keepBuffer,J=new fe(S.getBottomLeft().subtract([Z,-Z]),S.getTopRight().add([Z,-Z]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ue in this._tiles){var Ce=this._tiles[ue].coords;(Ce.z!==this._tileZoom||!J.contains(new $(Ce.x,Ce.y)))&&(this._tiles[ue].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(i,h);return}for(var Fe=S.min.y;Fe<=S.max.y;Fe++)for(var Ge=S.min.x;Ge<=S.max.x;Ge++){var Jt=new $(Ge,Fe);if(Jt.z=this._tileZoom,!!this._isValidTile(Jt)){var Ut=this._tiles[this._tileCoordsToKey(Jt)];Ut?Ut.current=!0:U.push(Jt)}}if(U.sort(function(ln,ls){return ln.distanceTo(P)-ls.distanceTo(P)}),U.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ln=document.createDocumentFragment();for(Ge=0;Ge<U.length;Ge++)this._addTile(U[Ge],Ln);this._level.el.appendChild(Ln)}}}},_isValidTile:function(i){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(i.x<h.min.x||i.x>h.max.x)||!c.wrapLat&&(i.y<h.min.y||i.y>h.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(i);return O(this.options.bounds).overlaps(p)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var c=this._map,h=this.getTileSize(),p=i.scaleBy(h),S=p.add(h),P=c.unproject(p,i.z),U=c.unproject(S,i.z);return[P,U]},_tileCoordsToBounds:function(i){var c=this._tileCoordsToNwSe(i),h=new se(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var c=i.split(":"),h=new $(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(i){var c=this._tiles[i];c&&(it(c.el),delete this._tiles[i],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){Oe(i,"leaflet-tile");var c=this.getTileSize();i.style.width=c.x+"px",i.style.height=c.y+"px",i.onselectstart=g,i.onmousemove=g,ve.ielt9&&this.options.opacity<1&&Ft(i,this.options.opacity)},_addTile:function(i,c){var h=this._getTilePos(i),p=this._tileCoordsToKey(i),S=this.createTile(this._wrapCoords(i),l(this._tileReady,this,i));this._initTile(S),this.createTile.length<2&&M(l(this._tileReady,this,i,null,S)),dt(S,h),this._tiles[p]={el:S,coords:i,current:!0},c.appendChild(S),this.fire("tileloadstart",{tile:S,coords:i})},_tileReady:function(i,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:i});var p=this._tileCoordsToKey(i);h=this._tiles[p],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Ft(h.el,0),G(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(Oe(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ve.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var c=new $(this._wrapX?m(i.x,this._wrapX):i.x,this._wrapY?m(i.y,this._wrapY):i.y);return c.z=i.z,c},_pxBoundsToTileRange:function(i){var c=this.getTileSize();return new fe(i.min.unscaleBy(c).floor(),i.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}});function hx(i){return new Xs(i)}var os=Xs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,c){this._url=i,c=x(this,c),c.detectRetina&&ve.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,c){return this._url===i&&c===void 0&&(c=!0),this._url=i,c||this.redraw(),this},createTile:function(i,c){var h=document.createElement("img");return De(h,"load",l(this._tileOnLoad,this,c,h)),De(h,"error",l(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(i),h},getTileUrl:function(i){var c={r:ve.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-i.y;this.options.tms&&(c.y=h),c["-y"]=h}return w(this._url,o(c,this.options))},_tileOnLoad:function(i,c){ve.ielt9?setTimeout(l(i,this,null,c),0):i(null,c)},_tileOnError:function(i,c,h){var p=this.options.errorTileUrl;p&&c.getAttribute("src")!==p&&(c.src=p),i(h,c)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,p=this.options.zoomOffset;return h&&(i=c-i),i+p},_getSubdomain:function(i){var c=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var i,c;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(c=this._tiles[i].el,c.onload=g,c.onerror=g,!c.complete)){c.src=T;var h=this._tiles[i].coords;it(c),delete this._tiles[i],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(i){var c=this._tiles[i];if(c)return c.el.setAttribute("src",T),Xs.prototype._removeTile.call(this,i)},_tileReady:function(i,c,h){if(!(!this._map||h&&h.getAttribute("src")===T))return Xs.prototype._tileReady.call(this,i,c,h)}});function yh(i,c){return new os(i,c)}var xh=os.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,c){this._url=i;var h=o({},this.defaultWmsParams);for(var p in c)p in this.options||(h[p]=c[p]);c=x(this,c);var S=c.detectRetina&&ve.retina?2:1,P=this.getTileSize();h.width=P.x*S,h.height=P.y*S,this.wmsParams=h},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,os.prototype.onAdd.call(this,i)},getTileUrl:function(i){var c=this._tileCoordsToNwSe(i),h=this._crs,p=_e(h.project(c[0]),h.project(c[1])),S=p.min,P=p.max,U=(this._wmsVersion>=1.3&&this._crs===dh?[S.y,S.x,P.y,P.x]:[S.x,S.y,P.x,P.y]).join(","),Z=os.prototype.getTileUrl.call(this,i);return Z+C(this.wmsParams,Z,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+U},setParams:function(i,c){return o(this.wmsParams,i),c||this.redraw(),this}});function fx(i,c){return new xh(i,c)}os.WMS=xh,yh.wms=fx;var Cr=$n.extend({options:{padding:.1},initialize:function(i){x(this,i),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Oe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,c){var h=this._map.getZoomScale(c,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),S=this._map.project(this._center,c),P=p.multiplyBy(-h).add(S).subtract(this._map._getNewPixelOrigin(i,c));ve.any3d?Je(this._container,P,h):dt(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var i in this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-i)).round();this._bounds=new fe(h,h.add(c.multiplyBy(1+i*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),vh=Cr.extend({options:{tolerance:0},getEvents:function(){var i=Cr.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Cr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");De(i,"mousemove",this._onMouseMove,this),De(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),De(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,it(this._container),st(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var i;this._redrawBounds=null;for(var c in this._layers)i=this._layers[c],i._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Cr.prototype._update.call(this);var i=this._bounds,c=this._container,h=i.getSize(),p=ve.retina?2:1;dt(c,i.min),c.width=p*h.x,c.height=p*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",ve.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){Cr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[u(i)]=i;var c=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var c=i._order,h=c.next,p=c.prev;h?h.prev=p:this._drawLast=p,p?p.next=h:this._drawFirst=h,delete i._order,delete this._layers[u(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if(typeof i.options.dashArray=="string"){var c=i.options.dashArray.split(/[, ]+/),h=[],p,S;for(S=0;S<c.length;S++){if(p=Number(c[S]),isNaN(p))return;h.push(p)}i.options._dashArray=h}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var c=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new fe,this._redrawBounds.extend(i._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(i._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var c=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)i=p.layer,(!c||i._pxBounds&&i._pxBounds.intersects(c))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,c){if(this._drawing){var h,p,S,P,U=i._parts,Z=U.length,J=this._ctx;if(Z){for(J.beginPath(),h=0;h<Z;h++){for(p=0,S=U[h].length;p<S;p++)P=U[h][p],J[p?"lineTo":"moveTo"](P.x,P.y);c&&J.closePath()}this._fillStroke(J,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var c=i._point,h=this._ctx,p=Math.max(Math.round(i._radius),1),S=(Math.max(Math.round(i._radiusY),1)||p)/p;S!==1&&(h.save(),h.scale(1,S)),h.beginPath(),h.arc(c.x,c.y/S,p,0,Math.PI*2,!1),S!==1&&h.restore(),this._fillStroke(h,i)}},_fillStroke:function(i,c){var h=c.options;h.fill&&(i.globalAlpha=h.fillOpacity,i.fillStyle=h.fillColor||h.color,i.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(i.setLineDash&&i.setLineDash(c.options&&c.options._dashArray||[]),i.globalAlpha=h.opacity,i.lineWidth=h.weight,i.strokeStyle=h.color,i.lineCap=h.lineCap,i.lineJoin=h.lineJoin,i.stroke())},_onClick:function(i){for(var c=this._map.mouseEventToLayerPoint(i),h,p,S=this._drawFirst;S;S=S.next)h=S.layer,h.options.interactive&&h._containsPoint(c)&&(!(i.type==="click"||i.type==="preclick")||!this._map._draggableMoved(h))&&(p=h);this._fireEvent(p?[p]:!1,i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,c)}},_handleMouseOut:function(i){var c=this._hoveredLayer;c&&(ct(this._container,"leaflet-interactive"),this._fireEvent([c],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,c){if(!this._mouseHoverThrottled){for(var h,p,S=this._drawFirst;S;S=S.next)h=S.layer,h.options.interactive&&h._containsPoint(c)&&(p=h);p!==this._hoveredLayer&&(this._handleMouseOut(i),p&&(Oe(this._container,"leaflet-interactive"),this._fireEvent([p],i,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,i),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,c,h){this._map._fireDOMEvent(c,h||c.type,i)},_bringToFront:function(i){var c=i._order;if(c){var h=c.next,p=c.prev;if(h)h.prev=p;else return;p?p.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(i)}},_bringToBack:function(i){var c=i._order;if(c){var h=c.next,p=c.prev;if(p)p.next=h;else return;h?h.prev=p:p&&(this._drawLast=p),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(i)}}});function _h(i){return ve.canvas?new vh(i):null}var ea=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch{}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),px={_initContainer:function(){this._container=qe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Cr.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var c=i._container=ea("shape");Oe(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",i._path=ea("path"),c.appendChild(i._path),this._updateStyle(i),this._layers[u(i)]=i},_addPath:function(i){var c=i._container;this._container.appendChild(c),i.options.interactive&&i.addInteractiveTarget(c)},_removePath:function(i){var c=i._container;it(c),i.removeInteractiveTarget(c),delete this._layers[u(i)]},_updateStyle:function(i){var c=i._stroke,h=i._fill,p=i.options,S=i._container;S.stroked=!!p.stroke,S.filled=!!p.fill,p.stroke?(c||(c=i._stroke=ea("stroke")),S.appendChild(c),c.weight=p.weight+"px",c.color=p.color,c.opacity=p.opacity,p.dashArray?c.dashStyle=N(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=p.lineCap.replace("butt","flat"),c.joinstyle=p.lineJoin):c&&(S.removeChild(c),i._stroke=null),p.fill?(h||(h=i._fill=ea("fill")),S.appendChild(h),h.color=p.fillColor||p.color,h.opacity=p.fillOpacity):h&&(S.removeChild(h),i._fill=null)},_updateCircle:function(i){var c=i._point.round(),h=Math.round(i._radius),p=Math.round(i._radiusY||h);this._setPath(i,i._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+p+" 0,"+65535*360)},_setPath:function(i,c){i._path.v=c},_bringToFront:function(i){kn(i._container)},_bringToBack:function(i){bn(i._container)}},ho=ve.vml?ea:he,ta=Cr.extend({_initContainer:function(){this._container=ho("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ho("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){it(this._container),st(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Cr.prototype._update.call(this);var i=this._bounds,c=i.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),dt(h,i.min),h.setAttribute("viewBox",[i.min.x,i.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(i){var c=i._path=ho("path");i.options.className&&Oe(c,i.options.className),i.options.interactive&&Oe(c,"leaflet-interactive"),this._updateStyle(i),this._layers[u(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){it(i._path),i.removeInteractiveTarget(i._path),delete this._layers[u(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var c=i._path,h=i.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(i,c){this._setPath(i,oe(i._parts,c))},_updateCircle:function(i){var c=i._point,h=Math.max(Math.round(i._radius),1),p=Math.max(Math.round(i._radiusY),1)||h,S="a"+h+","+p+" 0 1,0 ",P=i._empty()?"M0 0":"M"+(c.x-h)+","+c.y+S+h*2+",0 "+S+-h*2+",0 ";this._setPath(i,P)},_setPath:function(i,c){i._path.setAttribute("d",c)},_bringToFront:function(i){kn(i._path)},_bringToBack:function(i){bn(i._path)}});ve.vml&&ta.include(px);function wh(i){return ve.svg||ve.vml?new ta(i):null}Xe.include({getRenderer:function(i){var c=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(i){if(i==="overlayPane"||i===void 0)return!1;var c=this._paneRenderers[i];return c===void 0&&(c=this._createRenderer({pane:i}),this._paneRenderers[i]=c),c},_createRenderer:function(i){return this.options.preferCanvas&&_h(i)||wh(i)}});var jh=ss.extend({initialize:function(i,c){ss.prototype.initialize.call(this,this._boundsToLatLngs(i),c)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return i=O(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});function mx(i,c){return new jh(i,c)}ta.create=ho,ta.pointsToPath=oe,Sr.geometryToLayer=io,Sr.coordsToLatLng=Jl,Sr.coordsToLatLngs=so,Sr.latLngToCoords=Ql,Sr.latLngsToCoords=ao,Sr.getFeature=as,Sr.asFeature=oo,Xe.mergeOptions({boxZoom:!0});var Sh=or.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){De(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){it(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||i.which!==1&&i.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Wr(),Gi(),this._startPoint=this._map.mouseEventToContainerPoint(i),De(document,{contextmenu:ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=qe("div","leaflet-zoom-box",this._container),Oe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var c=new fe(this._point,this._startPoint),h=c.getSize();dt(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(it(this._box),ct(this._container,"leaflet-crosshair")),Hr(),Yi(),st(document,{contextmenu:ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if(!(i.which!==1&&i.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new se(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(i){i.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Xe.addInitHook("addHandler","boxZoom",Sh),Xe.mergeOptions({doubleClickZoom:!0});var Ch=or.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var c=this._map,h=c.getZoom(),p=c.options.zoomDelta,S=i.originalEvent.shiftKey?h-p:h+p;c.options.doubleClickZoom==="center"?c.setZoom(S):c.setZoomAround(i.containerPoint,S)}});Xe.addInitHook("addHandler","doubleClickZoom",Ch),Xe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Nh=or.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new qr(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}Oe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ct(this._map._container,"leaflet-grab"),ct(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=O(this._map.options.maxBounds);this._offsetLimit=_e(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,c){return i-(i-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var i=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;i.x<c.min.x&&(i.x=this._viscousLimit(i.x,c.min.x)),i.y<c.min.y&&(i.y=this._viscousLimit(i.y,c.min.y)),i.x>c.max.x&&(i.x=this._viscousLimit(i.x,c.max.x)),i.y>c.max.y&&(i.y=this._viscousLimit(i.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,c=Math.round(i/2),h=this._initialWorldOffset,p=this._draggable._newPos.x,S=(p-c+h)%i+c-h,P=(p+c+h)%i-c-h,U=Math.abs(S+h)<Math.abs(P+h)?S:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=U},_onDragEnd:function(i){var c=this._map,h=c.options,p=!h.inertia||i.noInertia||this._times.length<2;if(c.fire("dragend",i),p)c.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,U=h.easeLinearity,Z=S.multiplyBy(U/P),J=Z.distanceTo([0,0]),ue=Math.min(h.inertiaMaxSpeed,J),Ce=Z.multiplyBy(ue/J),Fe=ue/(h.inertiaDeceleration*U),Ge=Ce.multiplyBy(-Fe/2).round();!Ge.x&&!Ge.y?c.fire("moveend"):(Ge=c._limitOffset(Ge,c.options.maxBounds),M(function(){c.panBy(Ge,{duration:Fe,easeLinearity:U,noMoveStart:!0,animate:!0})}))}}});Xe.addInitHook("addHandler","dragging",Nh),Xe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var kh=or.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),De(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),st(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,c=document.documentElement,h=i.scrollTop||c.scrollTop,p=i.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(p,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var c=this._panKeys={},h=this.keyCodes,p,S;for(p=0,S=h.left.length;p<S;p++)c[h.left[p]]=[-1*i,0];for(p=0,S=h.right.length;p<S;p++)c[h.right[p]]=[i,0];for(p=0,S=h.down.length;p<S;p++)c[h.down[p]]=[0,i];for(p=0,S=h.up.length;p<S;p++)c[h.up[p]]=[0,-1*i]},_setZoomDelta:function(i){var c=this._zoomKeys={},h=this.keyCodes,p,S;for(p=0,S=h.zoomIn.length;p<S;p++)c[h.zoomIn[p]]=i;for(p=0,S=h.zoomOut.length;p<S;p++)c[h.zoomOut[p]]=-i},_addHooks:function(){De(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){st(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!(i.altKey||i.ctrlKey||i.metaKey)){var c=i.keyCode,h=this._map,p;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(p=this._panKeys[c],i.shiftKey&&(p=re(p).multiplyBy(3)),h.options.maxBounds&&(p=h._limitOffset(re(p),h.options.maxBounds)),h.options.worldCopyJump){var S=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(p)));h.panTo(S)}else h.panBy(p)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;ar(i)}}});Xe.addInitHook("addHandler","keyboard",kh),Xe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bh=or.extend({addHooks:function(){De(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var c=Ju(i),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var p=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),p),ar(i)},_performZoom:function(){var i=this._map,c=i.getZoom(),h=this._map.options.zoomSnap||0;i._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,P=h?Math.ceil(S/h)*h:S,U=i._limitZoom(c+(this._delta>0?P:-P))-c;this._delta=0,this._startTime=null,U&&(i.options.scrollWheelZoom==="center"?i.setZoom(c+U):i.setZoomAround(this._lastMousePos,c+U))}});Xe.addInitHook("addHandler","scrollWheelZoom",bh);var gx=600;Xe.mergeOptions({tapHold:ve.touchNative&&ve.safari&&ve.mobile,tapTolerance:15});var Ih=or.extend({addHooks:function(){De(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),i.touches.length===1){var c=i.touches[0];this._startPos=this._newPos=new $(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(De(document,"touchend",It),De(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),gx),De(document,"touchend touchcancel contextmenu",this._cancel,this),De(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){st(document,"touchend",It),st(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)},_onMove:function(i){var c=i.touches[0];this._newPos=new $(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,c){var h=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});Xe.addInitHook("addHandler","tapHold",Ih),Xe.mergeOptions({touchZoom:ve.touch,bounceAtZoomLimits:!0});var Lh=or.extend({addHooks:function(){Oe(this._map._container,"leaflet-touch-zoom"),De(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var c=this._map;if(!(!i.touches||i.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(p)._divideBy(2))),this._startDist=h.distanceTo(p),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),De(document,"touchmove",this._onTouchMove,this),De(document,"touchend touchcancel",this._onTouchEnd,this),It(i)}},_onTouchMove:function(i){if(!(!i.touches||i.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]),S=h.distanceTo(p)/this._startDist;if(this._zoom=c.getScaleZoom(S,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&S<1||this._zoom>c.getMaxZoom()&&S>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var P=h._add(p)._divideBy(2)._subtract(this._centerPoint);if(S===1&&P.x===0&&P.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var U=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(U,this,!0),It(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Xe.addInitHook("addHandler","touchZoom",Lh),Xe.BoxZoom=Sh,Xe.DoubleClickZoom=Ch,Xe.Drag=Nh,Xe.Keyboard=kh,Xe.ScrollWheelZoom=bh,Xe.TapHold=Ih,Xe.TouchZoom=Lh,n.Bounds=fe,n.Browser=ve,n.CRS=we,n.Canvas=vh,n.Circle=Kl,n.CircleMarker=ro,n.Class=z,n.Control=zn,n.DivIcon=gh,n.DivOverlay=lr,n.DomEvent=Ry,n.DomUtil=eo,n.Draggable=qr,n.Evented=F,n.FeatureGroup=wr,n.GeoJSON=Sr,n.GridLayer=Xs,n.Handler=or,n.Icon=is,n.ImageOverlay=lo,n.LatLng=ne,n.LatLngBounds=se,n.Layer=$n,n.LayerGroup=rs,n.LineUtil=qy,n.Map=Xe,n.Marker=no,n.Mixin=zy,n.Path=Gr,n.Point=$,n.PolyUtil=$y,n.Polygon=ss,n.Polyline=jr,n.Popup=co,n.PosAnimation=Qu,n.Projection=Gy,n.Rectangle=jh,n.Renderer=Cr,n.SVG=ta,n.SVGOverlay=mh,n.TileLayer=os,n.Tooltip=uo,n.Transformation=ze,n.Util=Y,n.VideoOverlay=ph,n.bind=l,n.bounds=_e,n.canvas=_h,n.circle=nx,n.circleMarker=tx,n.control=Ks,n.divIcon=ux,n.extend=o,n.featureGroup=Qy,n.geoJSON=fh,n.geoJson=sx,n.gridLayer=hx,n.icon=Xy,n.imageOverlay=ax,n.latLng=q,n.latLngBounds=O,n.layerGroup=Jy,n.map=Ay,n.marker=ex,n.point=re,n.polygon=ix,n.polyline=rx,n.popup=cx,n.rectangle=mx,n.setOptions=x,n.stamp=u,n.svg=wh,n.svgOverlay=lx,n.tileLayer=yh,n.tooltip=dx,n.transformation=pe,n.version=s,n.videoOverlay=ox;var yx=window.L;n.noConflict=function(){return window.L=yx,this},window.L=n})})(Od,Od.exports);var Xa=Od.exports;const zi=jp(Xa);function Vu(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function qu(e,t){return t==null?function(s,o){const a=_.useRef();return a.current||(a.current=e(s,o)),a}:function(s,o){const a=_.useRef();a.current||(a.current=e(s,o));const l=_.useRef(s),{instance:d}=a.current;return _.useEffect(function(){l.current!==s&&(t(d,s,l.current),l.current=s)},[d,s,o]),a}}function zj(e,t){_.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var a;(a=t.layerContainer)==null||a.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Ny(e){return function(n){const s=Hu(),o=e(Zu(n,s),s);return wy(s.map,n.attribution),Cy(o.current,n.eventHandlers),zj(o.current,s),o}}function $j(e,t){const n=qu(e,t),s=Ny(n);return Fj(s)}function Wj(e,t){const n=qu(e),s=Dj(n,t);return Uj(s)}function Hj(e,t){const n=qu(e,t),s=Ny(n);return Oj(s)}function Zj(e,t,n){const{opacity:s,zIndex:o}=t;s!=null&&s!==n.opacity&&e.setOpacity(s),o!=null&&o!==n.zIndex&&e.setZIndex(o)}function Vj(){return Hu().map}function Dd(){return Dd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Dd.apply(this,arguments)}function qj({bounds:e,boundsOptions:t,center:n,children:s,className:o,id:a,placeholder:l,style:d,whenReady:u,zoom:f,...m},g){const[y]=_.useState({className:o,id:a,style:d}),[k,v]=_.useState(null);_.useImperativeHandle(g,()=>(k==null?void 0:k.map)??null,[k]);const x=_.useCallback(j=>{if(j!==null&&k===null){const w=new Xa.Map(j,m);n!=null&&f!=null?w.setView(n,f):e!=null&&w.fitBounds(e,t),u!=null&&w.whenReady(u),v(Aj(w))}},[]);_.useEffect(()=>()=>{k==null||k.map.remove()},[k]);const C=k?mr.createElement(Sy,{value:k},s):l??null;return mr.createElement("div",Dd({},y,{ref:x}),C)}const Gj=_.forwardRef(qj),pp=$j(function({position:t,...n},s){const o=new Xa.Marker(t,n);return Vu(o,Mj(s,{overlayContainer:o}))},function(t,n,s){n.position!==s.position&&t.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&t.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&t.setOpacity(n.opacity),t.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?t.dragging.enable():t.dragging.disable())}),mp=Wj(function(t,n){const s=new Xa.Popup(t,n.overlayContainer);return Vu(s,n)},function(t,n,{position:s},o){_.useEffect(function(){const{instance:l}=t;function d(f){f.popup===l&&(l.update(),o(!0))}function u(f){f.popup===l&&o(!1)}return n.map.on({popupopen:d,popupclose:u}),n.overlayContainer==null?(s!=null&&l.setLatLng(s),l.openOn(n.map)):n.overlayContainer.bindPopup(l),function(){var m;n.map.off({popupopen:d,popupclose:u}),(m=n.overlayContainer)==null||m.unbindPopup(),n.map.removeLayer(l)}},[t,n,o,s])}),Yj=Hj(function({url:t,...n},s){const o=new Xa.TileLayer(t,Zu(n,s));return Vu(o,s)},function(t,n,s){Zj(t,n,s);const{url:o}=n;o!=null&&o!==s.url&&t.setUrl(o)});var gp={exports:{}};(function(e,t){(function(n,s){s(t)})(wp,function(n){var s=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var l=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,l?this._withAnimation:this._noAnimation),this._markerCluster=l?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof L.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(a,this._maxZoom),this.fire("layeradd",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var l=a,d=this._zoom;if(a.__parent)for(;l.__parent._zoom>=d;)l=l.__parent;return this._currentShownBounds.contains(l.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,l):this._animationAddLayerNonAnimated(a,l)),this},removeLayer:function(a){return a instanceof L.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,l){if(!L.Util.isArray(a))return this.addLayer(a);var d=this._featureGroup,u=this._nonPointGroup,f=this.options.chunkedLoading,m=this.options.chunkInterval,g=this.options.chunkProgress,y=a.length,k=0,v=!0,x;if(this._map){var C=new Date().getTime(),j=L.bind(function(){var N=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();k<y;k++){if(f&&k%200===0){var b=new Date().getTime()-N;if(b>m)break}if(x=a[k],x instanceof L.LayerGroup){v&&(a=a.slice(),v=!1),this._extractNonGroupLayers(x,a),y=a.length;continue}if(!x.getLatLng){u.addLayer(x),l||this.fire("layeradd",{layer:x});continue}if(!this.hasLayer(x)&&(this._addLayer(x,this._maxZoom),l||this.fire("layeradd",{layer:x}),x.__parent&&x.__parent.getChildCount()===2)){var T=x.__parent.getAllChildMarkers(),I=T[0]===x?T[1]:T[0];d.removeLayer(I)}}g&&g(k,y,new Date().getTime()-C),k===y?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(j,this.options.chunkDelay)},this);j()}else for(var w=this._needsClustering;k<y;k++){if(x=a[k],x instanceof L.LayerGroup){v&&(a=a.slice(),v=!1),this._extractNonGroupLayers(x,a),y=a.length;continue}if(!x.getLatLng){u.addLayer(x);continue}this.hasLayer(x)||w.push(x)}return this},removeLayers:function(a){var l,d,u=a.length,f=this._featureGroup,m=this._nonPointGroup,g=!0;if(!this._map){for(l=0;l<u;l++){if(d=a[l],d instanceof L.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(d,a),u=a.length;continue}this._arraySplice(this._needsClustering,d),m.removeLayer(d),this.hasLayer(d)&&this._needsRemoving.push({layer:d,latlng:d._latlng}),this.fire("layerremove",{layer:d})}return this}if(this._unspiderfy){this._unspiderfy();var y=a.slice(),k=u;for(l=0;l<k;l++){if(d=y[l],d instanceof L.LayerGroup){this._extractNonGroupLayers(d,y),k=y.length;continue}this._unspiderfyLayer(d)}}for(l=0;l<u;l++){if(d=a[l],d instanceof L.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(d,a),u=a.length;continue}if(!d.__parent){m.removeLayer(d),this.fire("layerremove",{layer:d});continue}this._removeLayer(d,!0,!0),this.fire("layerremove",{layer:d}),f.hasLayer(d)&&(f.removeLayer(d),d.clusterShow&&d.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this),delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var l=this._needsClustering.length-1;l>=0;l--)a.extend(this._needsClustering[l].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,l){var d=this._needsClustering.slice(),u=this._needsRemoving,f,m,g;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(d),m=d.length-1;m>=0;m--){for(f=!0,g=u.length-1;g>=0;g--)if(u[g].layer===d[m]){f=!1;break}f&&a.call(l,d[m])}this._nonPointGroup.eachLayer(a,l)},getLayers:function(){var a=[];return this.eachLayer(function(l){a.push(l)}),a},getLayer:function(a){var l=null;return a=parseInt(a,10),this.eachLayer(function(d){L.stamp(d)===a&&(l=d)}),l},hasLayer:function(a){if(!a)return!1;var l,d=this._needsClustering;for(l=d.length-1;l>=0;l--)if(d[l]===a)return!0;for(d=this._needsRemoving,l=d.length-1;l>=0;l--)if(d[l].layer===a)return!1;return!!(a.__parent&&a.__parent._group===this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,l){var d=this._map;typeof l!="function"&&(l=function(){});var u=function(){(d.hasLayer(a)||d.hasLayer(a.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",u,this),this.off("animationend",u,this),d.hasLayer(a)?l():a.__parent._icon&&(this.once("spiderfied",l,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?l():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",u,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",u,this),this.on("animationend",u,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var l,d,u;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(a),this._nonPointGroup.addTo(a),this._gridClusters||this._generateInitialClusters(),this._maxLat=a.options.crs.projection.MAX_LATITUDE,l=0,d=this._needsRemoving.length;l<d;l++)u=this._needsRemoving[l],u.newlatlng=u.layer._latlng,u.layer._latlng=u.latlng;for(l=0,d=this._needsRemoving.length;l<d;l++)u=this._needsRemoving[l],this._removeLayer(u.layer,!0),u.layer._latlng=u.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),d=this._needsClustering,this._needsClustering=[],this.addLayers(d,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(a){for(var l=a;l&&!l._icon;)l=l.__parent;return l||null},_arraySplice:function(a,l){for(var d=a.length-1;d>=0;d--)if(a[d]===l)return a.splice(d,1),!0},_removeFromGridUnclustered:function(a,l){for(var d=this._map,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom());l>=f&&u[l].removeObject(a,d.project(a.getLatLng(),l));l--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var l=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng),l&&a.target.openPopup()}},_moveChild:function(a,l,d){a._latlng=l,this.removeLayer(a),a._latlng=d,this.addLayer(a)},_childMarkerDragEnd:function(a){var l=a.target.__dragStart;delete a.target.__dragStart,l&&this._moveChild(a.target,l,a.target._latlng)},_removeLayer:function(a,l,d){var u=this._gridClusters,f=this._gridUnclustered,m=this._featureGroup,g=this._map,y=Math.floor(this._map.getMinZoom());l&&this._removeFromGridUnclustered(a,this._maxZoom);var k=a.__parent,v=k._markers,x;for(this._arraySplice(v,a);k&&(k._childCount--,k._boundsNeedUpdate=!0,!(k._zoom<y));)l&&k._childCount<=1?(x=k._markers[0]===a?k._markers[1]:k._markers[0],u[k._zoom].removeObject(k,g.project(k._cLatLng,k._zoom)),f[k._zoom].addObject(x,g.project(x.getLatLng(),k._zoom)),this._arraySplice(k.__parent._childClusters,k),k.__parent._markers.push(x),x.__parent=k.__parent,k._icon&&(m.removeLayer(k),d||m.addLayer(x))):k._iconNeedsUpdate=!0,k=k.__parent;delete a.__parent},_isOrIsParent:function(a,l){for(;l;){if(a===l)return!0;l=l.parentNode}return!1},fire:function(a,l,d){if(l&&l.layer instanceof L.MarkerCluster){if(l.originalEvent&&this._isOrIsParent(l.layer._icon,l.originalEvent.relatedTarget))return;a="cluster"+a}L.FeatureGroup.prototype.fire.call(this,a,l,d)},listens:function(a,l){return L.FeatureGroup.prototype.listens.call(this,a,l)||L.FeatureGroup.prototype.listens.call(this,"cluster"+a,l)},_defaultIconCreateFunction:function(a){var l=a.getChildCount(),d=" marker-cluster-";return l<10?d+="small":l<100?d+="medium":d+="large",new L.DivIcon({html:"<div><span>"+l+"</span></div>",className:"marker-cluster"+d,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,l=this.options.spiderfyOnMaxZoom,d=this.options.showCoverageOnHover,u=this.options.zoomToBoundsOnClick,f=this.options.spiderfyOnEveryZoom;(l||u||f)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),d&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){var l=a.layer,d=l;if(!(a.type==="clusterkeypress"&&a.originalEvent&&a.originalEvent.keyCode!==13)){for(;d._childClusters.length===1;)d=d._childClusters[0];d._zoom===this._maxZoom&&d._childCount===l._childCount&&this.options.spiderfyOnMaxZoom?l.spiderfy():this.options.zoomToBoundsOnClick&&l.zoomToBounds(),this.options.spiderfyOnEveryZoom&&l.spiderfy(),a.originalEvent&&a.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(a){var l=this._map;this._inZoomAnimation||(this._shownPolygon&&l.removeLayer(this._shownPolygon),a.layer.getChildCount()>2&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),l.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom,f=this._map;(a||d||u)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),f.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a),this._currentShownBounds=a}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),l=Math.floor(this._map.getMinZoom()),d=this.options.maxClusterRadius,u=d;typeof d!="function"&&(u=function(){return d}),this.options.disableClusteringAtZoom!==null&&(a=this.options.disableClusteringAtZoom-1),this._maxZoom=a,this._gridClusters={},this._gridUnclustered={};for(var f=a;f>=l;f--)this._gridClusters[f]=new L.DistanceGrid(u(f)),this._gridUnclustered[f]=new L.DistanceGrid(u(f));this._topClusterLevel=new this._markerCluster(this,l-1)},_addLayer:function(a,l){var d=this._gridClusters,u=this._gridUnclustered,f=Math.floor(this._map.getMinZoom()),m,g;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(a),a.on(this._childMarkerEventHandlers,this);l>=f;l--){m=this._map.project(a.getLatLng(),l);var y=d[l].getNearObject(m);if(y){y._addChild(a),a.__parent=y;return}if(y=u[l].getNearObject(m),y){var k=y.__parent;k&&this._removeLayer(y,!1);var v=new this._markerCluster(this,l,y,a);d[l].addObject(v,this._map.project(v._cLatLng,l)),y.__parent=v,a.__parent=v;var x=v;for(g=l-1;g>k._zoom;g--)x=new this._markerCluster(this,g,x),d[g].addObject(x,this._map.project(y.getLatLng(),g));k._addChild(x),this._removeFromGridUnclustered(y,l);return}u[l].addObject(a,m)}this._topClusterLevel._addChild(a),a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue(),this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(a){var l=this._maxLat;return l!==void 0&&(a.getNorth()>=l&&(a._northEast.lat=1/0),a.getSouth()<=-l&&(a._southWest.lat=-1/0)),a},_animationAddLayerNonAnimated:function(a,l){if(l===a)this._featureGroup.addLayer(a);else if(l._childCount===2){l._addToMap();var d=l.getAllChildMarkers();this._featureGroup.removeLayer(d[0]),this._featureGroup.removeLayer(d[1])}else l._updateIcon()},_extractNonGroupLayers:function(a,l){var d=a.getLayers(),u=0,f;for(l=l||[];u<d.length;u++){if(f=d[u],f instanceof L.LayerGroup){this._extractNonGroupLayers(f,l);continue}l.push(f)}return l},_overrideMarkerIcon:function(a){var l=a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}});return l}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,l){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(a,l){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(a,l){this._animationAddLayerNonAnimated(a,l)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(a,l){var d=this._getExpandedVisibleBounds(),u=this._featureGroup,f=Math.floor(this._map.getMinZoom()),m;this._ignoreMove=!0,this._topClusterLevel._recursively(d,a,f,function(g){var y=g._latlng,k=g._markers,v;for(d.contains(y)||(y=null),g._isSingleParent()&&a+1===l?(u.removeLayer(g),g._recursivelyAddChildrenToMap(null,l,d)):(g.clusterHide(),g._recursivelyAddChildrenToMap(y,l,d)),m=k.length-1;m>=0;m--)v=k[m],d.contains(v._latlng)||u.removeLayer(v)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(d,l),u.eachLayer(function(g){!(g instanceof L.MarkerCluster)&&g._icon&&g.clusterShow()}),this._topClusterLevel._recursively(d,a,l,function(g){g._recursivelyRestoreChildPositions(l)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(d,a,f,function(g){u.removeLayer(g),g.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(a,l){this._animationZoomOutSingle(this._topClusterLevel,a-1,l),this._topClusterLevel._recursivelyAddChildrenToMap(null,l,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,l){var d=this,u=this._featureGroup;u.addLayer(a),l!==a&&(l._childCount>2?(l._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(l.getLatLng())),a.clusterHide(),this._enqueue(function(){u.removeLayer(a),a.clusterShow(),d._animationEnd()})):(this._forceLayout(),d._animationStart(),d._animationZoomOutSingle(l,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,l,d){var u=this._getExpandedVisibleBounds(),f=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(u,f,l+1,d);var m=this;this._forceLayout(),a._recursivelyBecomeVisible(u,d),this._enqueue(function(){if(a._childCount===1){var g=a._markers[0];this._ignoreMove=!0,g.setLatLng(g.getLatLng()),this._ignoreMove=!1,g.clusterShow&&g.clusterShow()}else a._recursively(u,d,f,function(y){y._recursivelyRemoveChildrenFromMap(u,f,l+1)});m._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)};var o=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(a,l,d,u){L.Marker.prototype.initialize.call(this,d?d._cLatLng||d.getLatLng():new L.LatLng(0,0),{icon:this,pane:a.options.clusterPane}),this._group=a,this._zoom=l,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,d&&this._addChild(d),u&&this._addChild(u)},getAllChildMarkers:function(a,l){a=a||[];for(var d=this._childClusters.length-1;d>=0;d--)this._childClusters[d].getAllChildMarkers(a,l);for(var u=this._markers.length-1;u>=0;u--)l&&this._markers[u].__dragStart||a.push(this._markers[u]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){for(var l=this._childClusters.slice(),d=this._group._map,u=d.getBoundsZoom(this._bounds),f=this._zoom+1,m=d.getZoom(),g;l.length>0&&u>f;){f++;var y=[];for(g=0;g<l.length;g++)y=y.concat(l[g]._childClusters);l=y}u>f?this._group._map.setView(this._latlng,f):u<=m?this._group._map.setView(this._latlng,m+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,l){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(a),a instanceof L.MarkerCluster?(l||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(l||this._markers.push(a),this._childCount++),this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=1/0,a._southWest.lng=1/0),a._northEast&&(a._northEast.lat=-1/0,a._northEast.lng=-1/0)},_recalculateBounds:function(){var a=this._markers,l=this._childClusters,d=0,u=0,f=this._childCount,m,g,y,k;if(f!==0){for(this._resetBounds(),m=0;m<a.length;m++)y=a[m]._latlng,this._bounds.extend(y),d+=y.lat,u+=y.lng;for(m=0;m<l.length;m++)g=l[m],g._boundsNeedUpdate&&g._recalculateBounds(),this._bounds.extend(g._bounds),y=g._wLatLng,k=g._childCount,d+=y.lat*k,u+=y.lng*k;this._latlng=this._wLatLng=new L.LatLng(d/f,u/f),this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,l,d){this._recursively(a,this._group._map.getMinZoom(),d-1,function(u){var f=u._markers,m,g;for(m=f.length-1;m>=0;m--)g=f[m],g._icon&&(g._setPos(l),g.clusterHide())},function(u){var f=u._childClusters,m,g;for(m=f.length-1;m>=0;m--)g=f[m],g._icon&&(g._setPos(l),g.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,l,d,u){this._recursively(a,u,l,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),d),f._isSingleParent()&&d-1===u?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,l,d)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(a,l){this._recursively(a,this._group._map.getMinZoom(),l,null,function(d){d.clusterShow()})},_recursivelyAddChildrenToMap:function(a,l,d){this._recursively(d,this._group._map.getMinZoom()-1,l,function(u){if(l!==u._zoom)for(var f=u._markers.length-1;f>=0;f--){var m=u._markers[f];d.contains(m._latlng)&&(a&&(m._backupLatlng=m.getLatLng(),m.setLatLng(a),m.clusterHide&&m.clusterHide()),u._group._featureGroup.addLayer(m))}},function(u){u._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var l=this._markers.length-1;l>=0;l--){var d=this._markers[l];d._backupLatlng&&(d.setLatLng(d._backupLatlng),delete d._backupLatlng)}if(a-1===this._zoom)for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._restorePosition();else for(var f=this._childClusters.length-1;f>=0;f--)this._childClusters[f]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,l,d,u){var f,m;this._recursively(a,l-1,d-1,function(g){for(m=g._markers.length-1;m>=0;m--)f=g._markers[m],(!u||!u.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(g){for(m=g._childClusters.length-1;m>=0;m--)f=g._childClusters[m],(!u||!u.contains(f._latlng))&&(g._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(a,l,d,u,f){var m=this._childClusters,g=this._zoom,y,k;if(l<=g&&(u&&u(this),f&&g===d&&f(this)),g<l||g<d)for(y=m.length-1;y>=0;y--)k=m[y],k._boundsNeedUpdate&&k._recalculateBounds(),a.intersects(k._bounds)&&k._recursively(a,l,d,u,f)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var a=this.options.opacity;return this.setOpacity(0),this.options.opacity=a,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(a){this._cellSize=a,this._sqCellSize=a*a,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(a,l){var d=this._getCoord(l.x),u=this._getCoord(l.y),f=this._grid,m=f[u]=f[u]||{},g=m[d]=m[d]||[],y=L.Util.stamp(a);this._objectPoint[y]=l,g.push(a)},updateObject:function(a,l){this.removeObject(a),this.addObject(a,l)},removeObject:function(a,l){var d=this._getCoord(l.x),u=this._getCoord(l.y),f=this._grid,m=f[u]=f[u]||{},g=m[d]=m[d]||[],y,k;for(delete this._objectPoint[L.Util.stamp(a)],y=0,k=g.length;y<k;y++)if(g[y]===a)return g.splice(y,1),k===1&&delete m[d],!0},eachObject:function(a,l){var d,u,f,m,g,y,k,v=this._grid;for(d in v){g=v[d];for(u in g)for(y=g[u],f=0,m=y.length;f<m;f++)k=a.call(l,y[f]),k&&(f--,m--)}},getNearObject:function(a){var l=this._getCoord(a.x),d=this._getCoord(a.y),u,f,m,g,y,k,v,x,C=this._objectPoint,j=this._sqCellSize,w=null;for(u=d-1;u<=d+1;u++)if(g=this._grid[u],g){for(f=l-1;f<=l+1;f++)if(y=g[f],y)for(m=0,k=y.length;m<k;m++)v=y[m],x=this._sqDist(C[L.Util.stamp(v)],a),(x<j||x<=j&&w===null)&&(j=x,w=v)}return w},_getCoord:function(a){var l=Math.floor(a/this._cellSize);return isFinite(l)?l:a},_sqDist:function(a,l){var d=l.x-a.x,u=l.y-a.y;return d*d+u*u}},function(){L.QuickHull={getDistant:function(a,l){var d=l[1].lat-l[0].lat,u=l[0].lng-l[1].lng;return u*(a.lat-l[0].lat)+d*(a.lng-l[0].lng)},findMostDistantPointFromBaseLine:function(a,l){var d=0,u=null,f=[],m,g,y;for(m=l.length-1;m>=0;m--){if(g=l[m],y=this.getDistant(g,a),y>0)f.push(g);else continue;y>d&&(d=y,u=g)}return{maxPoint:u,newPoints:f}},buildConvexHull:function(a,l){var d=[],u=this.findMostDistantPointFromBaseLine(a,l);return u.maxPoint?(d=d.concat(this.buildConvexHull([a[0],u.maxPoint],u.newPoints)),d=d.concat(this.buildConvexHull([u.maxPoint,a[1]],u.newPoints)),d):[a[0]]},getConvexHull:function(a){var l=!1,d=!1,u=!1,f=!1,m=null,g=null,y=null,k=null,v=null,x=null,C;for(C=a.length-1;C>=0;C--){var j=a[C];(l===!1||j.lat>l)&&(m=j,l=j.lat),(d===!1||j.lat<d)&&(g=j,d=j.lat),(u===!1||j.lng>u)&&(y=j,u=j.lng),(f===!1||j.lng<f)&&(k=j,f=j.lng)}d!==l?(x=g,v=m):(x=k,v=y);var w=[].concat(this.buildConvexHull([x,v],a),this.buildConvexHull([v,x],a));return w}}}(),L.MarkerCluster.include({getConvexHull:function(){var a=this.getAllChildMarkers(),l=[],d,u;for(u=a.length-1;u>=0;u--)d=a[u].getLatLng(),l.push(d);return L.QuickHull.getConvexHull(l)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var a=this.getAllChildMarkers(null,!0),l=this._group,d=l._map,u=d.latLngToLayerPoint(this._latlng),f;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?f=this._group.options.spiderfyShapePositions(a.length,u):a.length>=this._circleSpiralSwitchover?f=this._generatePointsSpiral(a.length,u):(u.y+=10,f=this._generatePointsCircle(a.length,u)),this._animationSpiderfy(a,f)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,l){var d=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a),u=d/this._2PI,f=this._2PI/a,m=[],g,y;for(u=Math.max(u,35),m.length=a,g=0;g<a;g++)y=this._circleStartAngle+g*f,m[g]=new L.Point(l.x+u*Math.cos(y),l.y+u*Math.sin(y))._round();return m},_generatePointsSpiral:function(a,l){var d=this._group.options.spiderfyDistanceMultiplier,u=d*this._spiralLengthStart,f=d*this._spiralFootSeparation,m=d*this._spiralLengthFactor*this._2PI,g=0,y=[],k;for(y.length=a,k=a;k>=0;k--)k<a&&(y[k]=new L.Point(l.x+u*Math.cos(g),l.y+u*Math.sin(g))._round()),g+=f/u+k*5e-4,u+=m/g;return y},_noanimationUnspiderfy:function(){var a=this._group,l=a._map,d=a._featureGroup,u=this.getAllChildMarkers(null,!0),f,m;for(a._ignoreMove=!0,this.setOpacity(1),m=u.length-1;m>=0;m--)f=u[m],d.removeLayer(f),f._preSpiderfyLatlng&&(f.setLatLng(f._preSpiderfyLatlng),delete f._preSpiderfyLatlng),f.setZIndexOffset&&f.setZIndexOffset(0),f._spiderLeg&&(l.removeLayer(f._spiderLeg),delete f._spiderLeg);a.fire("unspiderfied",{cluster:this,markers:u}),a._ignoreMove=!1,a._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(a,l){var d=this._group,u=d._map,f=d._featureGroup,m=this._group.options.spiderLegPolylineOptions,g,y,k,v;for(d._ignoreMove=!0,g=0;g<a.length;g++)v=u.layerPointToLatLng(l[g]),y=a[g],k=new L.Polyline([this._latlng,v],m),u.addLayer(k),y._spiderLeg=k,y._preSpiderfyLatlng=y._latlng,y.setLatLng(v),y.setZIndexOffset&&y.setZIndexOffset(1e6),f.addLayer(y);this.setOpacity(.3),d._ignoreMove=!1,d.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(a,l){var d=this,u=this._group,f=u._map,m=u._featureGroup,g=this._latlng,y=f.latLngToLayerPoint(g),k=L.Path.SVG,v=L.extend({},this._group.options.spiderLegPolylineOptions),x=v.opacity,C,j,w,N,b,T;for(x===void 0&&(x=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),k?(v.opacity=0,v.className=(v.className||"")+" leaflet-cluster-spider-leg"):v.opacity=x,u._ignoreMove=!0,C=0;C<a.length;C++)j=a[C],T=f.layerPointToLatLng(l[C]),w=new L.Polyline([g,T],v),f.addLayer(w),j._spiderLeg=w,k&&(N=w._path,b=N.getTotalLength()+.1,N.style.strokeDasharray=b,N.style.strokeDashoffset=b),j.setZIndexOffset&&j.setZIndexOffset(1e6),j.clusterHide&&j.clusterHide(),m.addLayer(j),j._setPos&&j._setPos(y);for(u._forceLayout(),u._animationStart(),C=a.length-1;C>=0;C--)T=f.layerPointToLatLng(l[C]),j=a[C],j._preSpiderfyLatlng=j._latlng,j.setLatLng(T),j.clusterShow&&j.clusterShow(),k&&(w=j._spiderLeg,N=w._path,N.style.strokeDashoffset=0,w.setStyle({opacity:x}));this.setOpacity(.3),u._ignoreMove=!1,setTimeout(function(){u._animationEnd(),u.fire("spiderfied",{cluster:d,markers:a})},200)},_animationUnspiderfy:function(a){var l=this,d=this._group,u=d._map,f=d._featureGroup,m=a?u._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):u.latLngToLayerPoint(this._latlng),g=this.getAllChildMarkers(null,!0),y=L.Path.SVG,k,v,x,C,j,w;for(d._ignoreMove=!0,d._animationStart(),this.setOpacity(1),v=g.length-1;v>=0;v--)k=g[v],k._preSpiderfyLatlng&&(k.closePopup(),k.setLatLng(k._preSpiderfyLatlng),delete k._preSpiderfyLatlng,w=!0,k._setPos&&(k._setPos(m),w=!1),k.clusterHide&&(k.clusterHide(),w=!1),w&&f.removeLayer(k),y&&(x=k._spiderLeg,C=x._path,j=C.getTotalLength()+.1,C.style.strokeDashoffset=j,x.setStyle({opacity:0})));d._ignoreMove=!1,setTimeout(function(){var N=0;for(v=g.length-1;v>=0;v--)k=g[v],k._spiderLeg&&N++;for(v=g.length-1;v>=0;v--)k=g[v],k._spiderLeg&&(k.clusterShow&&k.clusterShow(),k.setZIndexOffset&&k.setZIndexOffset(0),N>1&&f.removeLayer(k),u.removeLayer(k._spiderLeg),delete k._spiderLeg);d._animationEnd(),d.fire("unspiderfied",{cluster:l,markers:g})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof L.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof L.LayerGroup?a=a._layers:a instanceof L.MarkerCluster?a=a.getAllChildMarkers():a instanceof L.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var l,d;for(l in a)for(d=a[l].__parent;d;)d._iconNeedsUpdate=!0,d=d.__parent},_refreshSingleMarkerModeMarkers:function(a){var l,d;for(l in a)d=a[l],this.hasLayer(d)&&d.setIcon(this._overrideMarkerIcon(d))}}),L.Marker.include({refreshIconOptions:function(a,l){var d=this.options.icon;return L.setOptions(d,a),this.setIcon(d),l&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),n.MarkerClusterGroup=s,n.MarkerCluster=o,Object.defineProperty(n,"__esModule",{value:!0})})})(gp,gp.exports);const Kj="https://nominatim.openstreetmap.org/search",Gu="ev_station_geocoding_cache",qn=new Map;function Jj(){try{const e=localStorage.getItem(Gu);if(e){const t=JSON.parse(e);return Object.entries(t).forEach(([n,s])=>{qn.set(n,s)}),console.log(` Loaded ${qn.size} cached geocoding results from localStorage`),!0}}catch(e){console.warn(" Failed to load geocoding cache from localStorage:",e.message)}return!1}function Bc(){try{const e=Object.fromEntries(qn);localStorage.setItem(Gu,JSON.stringify(e))}catch(e){console.warn(" Failed to save geocoding cache to localStorage:",e.message)}}Jj();async function Qj(e,t="Vietnam"){if(!e||typeof e!="string")return null;const n=`${e}|${t}`;if(qn.has(n)){const s=qn.get(n);return s&&console.log(` Geocoding cache hit for "${e}"`),s}try{const o=e.split(",").map(u=>u.trim())[0]||e,a=[`${e}, Vietnam`,`${o}, ${t}, Vietnam`,`${o} ${t} Vietnam`,e];console.log(` Geocoding address: "${e}" (city: "${t}")`);let l=null,d="";for(const u of a){d=u;const f=await fetch(`${Kj}?q=${encodeURIComponent(u)}&format=json&limit=10&timeout=10&accept-language=vi&countrycodes=vn`,{headers:{Accept:"application/json","User-Agent":"EVStationRental-FE"}});if(f.ok){if(l=await f.json(),Array.isArray(l)&&l.length>0){const m=l.filter(v=>{const x=(v.type||v.class||"").toLowerCase(),C=(v.addresstype||"").toLowerCase();return!["state","province","country"].includes(x)&&!["state","province","country"].includes(C)}),g=m.length>0?m:l,y=g.find(v=>{var j;const x=((j=v.display_name)==null?void 0:j.toLowerCase())||"",C=(t==null?void 0:t.toLowerCase())||"";return C&&x.includes(C)})||g[0],k={lat:parseFloat(y.lat),lng:parseFloat(y.lon)};if(!isNaN(k.lat)&&!isNaN(k.lng))return console.log(` Geocoded "${e}" (via "${d}")  ${k.lat.toFixed(4)}, ${k.lng.toFixed(4)}`),qn.set(n,k),Bc(),k}await new Promise(m=>setTimeout(m,100))}}return console.warn(` Could not geocode: "${e}" (tried: ${a.join(" | ")})`),qn.set(n,null),Bc(),null}catch(s){return console.error(` Geocoding error for "${e}":`,s.message),qn.set(n,null),Bc(),null}}async function Xj(e,t=500){if(!Array.isArray(e)||e.length===0)return console.warn(" geocodeAddressesBatch: Empty or invalid items array"),new Map;const n=new Map;let s=0;for(const o of e){const a=o.address||o.Address||"",l=o.city||"Vietnam";if(!a){console.warn(` Station ${o.id}: No address found - skipping geocoding`),n.set(o.id,null);continue}const d=await Qj(a,l);d&&s++,n.set(o.id,d),e.indexOf(o)<e.length-1&&await new Promise(u=>setTimeout(u,t))}return console.log(` Batch geocoding complete: ${s}/${e.length} stations geocoded`),n}function eS(){var e;return{size:qn.size,entries:Array.from(qn.entries()),storageSize:((e=localStorage.getItem(Gu))==null?void 0:e.length)||0}}function tS(e,t="Vietnam"){const n=`${e}|${t}`;return qn.get(n)||null}delete zi.Icon.Default.prototype._getIconUrl;zi.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const nS=new zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),rS=new zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),iS=new zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),sS=new zi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function aS({stations:e,userLocation:t,stationCoords:n}){const s=Vj();return _.useEffect(()=>{if(!(!s||!e||e.length===0))try{const o=setTimeout(()=>{if(!s||!s._container)return;const a=[];let l=0;for(const u of e){const f=u.id||u.Id||u.stationId,m=n.get(f);m&&Number.isFinite(m.lat)&&Number.isFinite(m.lng)?(a.push([m.lat,m.lng]),l++):console.warn(` Station ${f} has invalid coords:`,m)}console.log(` Valid station markers for map: ${l}/${e.length}`),console.log(" Station markers array:",a.slice(0,5).map((u,f)=>` [${f}]: [${u[0]}, ${u[1]}]`).join(", "),l>5?`... +${l-5} more`:"");const d=(u,f,m,g)=>{const k=(m-u)*Math.PI/180,v=(g-f)*Math.PI/180,x=Math.sin(k/2)*Math.sin(k/2)+Math.cos(u*Math.PI/180)*Math.cos(m*Math.PI/180)*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x)))};if(a.length>0)try{if(t)console.log(` Zooming to user location: [${t.lat}, ${t.lng}]`),s.setView([t.lat,t.lng],14,{animate:!0,duration:.5}),console.log(" Zoomed to user location with zoom level 14");else{const u=a;console.log(` Building bounds from ${u.length} coordinates...`);const f=zi.latLngBounds(u);console.log(` Bounds calculated: NE: ${f.getNorthEast()}, SW: ${f.getSouthWest()}`),console.log(" Calling fitBounds..."),s.fitBounds(f,{padding:[50,50],animate:!0,duration:.5}),console.log(" Fitted map bounds"),console.log(` Map zoom after fitBounds: ${s.getZoom()}`)}}catch(u){console.warn(" Error fitting bounds:",u.message),t&&s.setView([t.lat,t.lng],10)}else t&&s.setView([t.lat,t.lng],12)},100);return()=>clearTimeout(o)}catch(o){console.warn(" Error in MapController:",o.message)}},[s,e,t,n]),null}function oS({isOpen:e,onClose:t,stations:n,onSelectStation:s,selectedStationId:o,userLocation:a}){const[l,d]=_.useState(0),[u,f]=_.useState(new Map),[m,g]=_.useState(null),[y,k]=_.useState(!1),[v,x]=_.useState(!1),[C,j]=_.useState([]),[w,N]=_.useState(()=>{const I=localStorage.getItem("bookmarkedStations");return I?JSON.parse(I):[]}),b=I=>{N(R=>{const B=R.includes(I)?R.filter(A=>A!==I):[...R,I];return localStorage.setItem("bookmarkedStations",JSON.stringify(B)),B})};if(_.useEffect(()=>{if(!e||!n||n.length===0)return;const I=eS();g(I),console.log(" Geocoding cache stats:",I);const R=new Map;let B=0,A=0;const E=[];for(const z of n){const X=z.id||z.Id||z.stationId,K=z.address||z.Address||"",F=z.stationName||z.name||z.Name||"Unknown",$=tS(K,"Vietnam");$&&Number.isFinite($.lat)&&Number.isFinite($.lng)?(R.set(X,$),B++):$===null?E.push(`${F} (address: "${K}" - geocoding failed)`):$&&(!Number.isFinite($.lat)||!Number.isFinite($.lng))?E.push(`${F} (address: "${K}" - invalid coords: lat=${$.lat}, lng=${$.lng})`):(A++,E.push(`${F} (address: "${K}" - not geocoded yet)`))}console.log(` Using ${B}/${n.length} cached coordinates (${A} never attempted)`),E.length>0&&console.log(` Stations without valid coordinates (${E.length}):`,E),console.log(` stationCoords map contents (${R.size} entries):`);const M=new Map;let G=0;for(const[z,X]of R){if(X){const K=`${X.lat.toFixed(6)},${X.lng.toFixed(6)}`;M.set(K,(M.get(K)||0)+1)}G<10&&(console.log(`  - ID: ${z} => ${X?`[${X.lat}, ${X.lng}]`:"null"}`),G++)}const Y=Array.from(M.entries()).filter(([z,X])=>X>1);Y.length>0&&console.warn(` Found ${Y.length} duplicate coordinates:`,Y.map(([z,X])=>`${z} (${X} stations)`).join(", ")),j(Y),f(R),x(!0),A>0?k(!0):k(!1)},[e,n]),!e)return null;const T=a||{lat:10.8231,lng:106.6297};return r.jsxs("div",{className:`map-modal ${e?"active":""}`,children:[r.jsxs("div",{className:"map-modal-header",children:[r.jsxs("h3",{children:[r.jsx("i",{className:"fas fa-map-marked-alt"})," Select Location on Map"]}),r.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:r.jsx("button",{className:"map-modal-close",onClick:t,children:r.jsx("i",{className:"fas fa-times"})})})]}),r.jsx("div",{className:"map-container",children:r.jsxs(Gj,{center:[T.lat,T.lng],zoom:12,style:{height:"100%",width:"100%"},zoomControl:!0,children:[r.jsx(Yj,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.jsx(aS,{stations:n,userLocation:a,stationCoords:u}),a&&r.jsx(pp,{position:[a.lat,a.lng],icon:nS,children:r.jsx(mp,{children:r.jsx("div",{style:{padding:"4px"},children:r.jsx("strong",{children:"Your Location"})})})}),v&&(()=>{let I=0,R=0;const B=n.map((A,E)=>{const M=A.id||A.Id||A.stationId,G=u.get(M),Y=A.stationName||A.name||A.Name||"Unknown Station",z=A.address||A.Address||"";if(console.log(` Station ${E}: "${Y}" | ID: ${M} | Coords: ${G?`[${G.lat}, ${G.lng}]`:"MISSING"}`),!G)return R++,null;I++;const X=M===o,K=w.includes(M),F=X?sS:K?iS:rS;return r.jsx(pp,{position:[G.lat,G.lng],icon:F,children:r.jsx(mp,{children:r.jsxs("div",{style:{padding:"8px",minWidth:"200px"},children:[r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#333"},children:Y}),r.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#666"},children:z}),r.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:r.jsx("button",{onClick:()=>b(M),style:{background:K?"#4caf50":"#2196f3",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",flex:1},children:K?" Bookmarked":" Bookmark"})}),r.jsx("button",{onClick:()=>s(M,Y,z),style:{background:"#ff6b35",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",width:"100%"},children:X?" Selected":"Select Location"})]})})},M)});return console.log(` Total markers rendered: ${I}, skipped: ${R}`),I+R!==n.length&&console.error(` MISMATCH: Expected ${n.length} total but got ${I+R}`),B})()]},l)}),r.jsx("div",{className:"map-modal-footer",children:r.jsxs("p",{children:[r.jsx("i",{className:"fas fa-info-circle"})," Click on a marker to select a station",C.length>0&&r.jsx("span",{style:{color:"#f44336",marginLeft:"16px"}})]})})]})}function ky({isOpen:e,onClose:t,stations:n=[],userLocation:s=null,onSearch:o,currentSearchData:a=null}){const[l,d]=_.useState(!1),[u,f]=_.useState(()=>{if(a)return{location:a.location||"",locationName:a.locationName||"Select location",pickupDate:a.pickupDate||new Date().toISOString().split("T")[0],pickupTime:a.pickupTime||"15:00",returnDate:a.returnDate||new Date(new Date().getTime()+24*60*60*1e3).toISOString().split("T")[0],returnTime:a.returnTime||"19:00",calendarMode:null,currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear()};const B=new Date,A=new Date(B.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:B.toISOString().split("T")[0],pickupTime:"15:00",returnDate:A.toISOString().split("T")[0],returnTime:"19:00",calendarMode:null,currentMonth:B.getMonth(),currentYear:B.getFullYear()}}),[m,g]=_.useState(""),y=Array.from({length:18},(B,A)=>`${(6+A).toString().padStart(2,"0")}:00`);_.useEffect(()=>{T()},[u.pickupDate,u.pickupTime,u.returnDate,u.returnTime]),_.useEffect(()=>{if(e){const B=document.querySelector(".search-modal-body");B&&(B.scrollTop=0)}},[e]),_.useEffect(()=>{e&&a&&f(B=>({...B,location:a.location||"",locationName:a.locationName||"Select location",pickupDate:a.pickupDate||B.pickupDate,pickupTime:a.pickupTime||"15:00",returnDate:a.returnDate||B.returnDate,returnTime:a.returnTime||"19:00"}))},[e,a]);function k(){d(!1),t()}function v(){d(!0)}function x(B,A,E){f(M=>({...M,location:B,locationName:A})),d(!1)}function C(B){f(A=>({...A,calendarMode:A.calendarMode===B?null:B}))}function j(B){const A=`${B}-time`;f(E=>({...E,calendarMode:E.calendarMode===A?null:A}))}function w(B){f(A=>{let E=A.currentMonth+B,M=A.currentYear;return E>11&&(E=0,M++),E<0&&(E=11,M--),{...A,currentMonth:E,currentYear:M}})}function N(B){f(A=>{const E={...A};if(A.calendarMode==="pickup"){E.pickupDate=B;const M=new Date(`${B}T${A.pickupTime}`);if(new Date(`${A.returnDate}T${A.returnTime}`)<=M){E.returnDate=B;const Y=parseInt(A.pickupTime.split(":")[0]),z=Math.min(Y+2,23);E.returnTime=`${z.toString().padStart(2,"0")}:00`}}else E.returnDate=B;return E.calendarMode=null,E})}function b(B,A){f(E=>({...E,[B+"Time"]:A,calendarMode:null}))}function T(){try{const B=new Date(`${u.pickupDate}T${u.pickupTime}`),E=new Date(`${u.returnDate}T${u.returnTime}`)-B,M=Math.floor(E/(1e3*60*60));if(M<0)return g("Invalid duration");if(M===0)return g("Less than 1 hour");const G=Math.floor(M/24),Y=M%24;let z="";G>0&&(z+=`${G} day${G>1?"s":""} `),Y>0&&(z+=`${Y} hour${Y>1?"s":""}`),g(z.trim()||"0 hours")}catch{g("")}}function I(){if(!u.location){alert("Please select a pick-up location");return}const B=new Date(`${u.pickupDate}T${u.pickupTime}`),A=new Date(`${u.returnDate}T${u.returnTime}`);if(B<new Date){alert("Pick-up date and time must be in the future.");return}if(A<=B){alert("Return date and time must be after pick-up date and time.");return}if((A-B)/(1e3*60*60)<1){alert("Minimum rental duration is 1 hour.");return}o&&o(u)}function R(){const B=new Date(u.currentYear,u.currentMonth,1),A=new Date(u.currentYear,u.currentMonth+1,0),E=new Date;E.setHours(0,0,0,0);const M=[];for(let G=0;G<B.getDay();G++)M.push(r.jsx("div",{className:"calendar-day"},`empty-${G}`));for(let G=1;G<=A.getDate();G++){const Y=`${u.currentYear}-${(u.currentMonth+1).toString().padStart(2,"0")}-${G.toString().padStart(2,"0")}`,z=new Date(u.currentYear,u.currentMonth,G),X=z.toDateString()===E.toDateString(),K=z<E,F=Y===(u.calendarMode==="pickup"?u.pickupDate:u.returnDate),$=["calendar-day"];K&&$.push("disabled"),X&&$.push("today"),F&&$.push("selected"),M.push(r.jsx("div",{className:$.join(" "),onClick:()=>{K||N(Y)},children:G},Y))}return M}return e?r.jsxs(r.Fragment,{children:[!l&&r.jsx("div",{className:"search-modal-backdrop",onClick:k}),r.jsx(oS,{isOpen:l,onClose:()=>d(!1),stations:n,onSelectStation:x,selectedStationId:u.location,userLocation:s}),r.jsx("div",{className:`search-modal ${e?"active":""} ${l?"with-map":""}`,children:r.jsxs("div",{className:"search-modal-content",children:[r.jsxs("div",{className:"search-modal-header",children:[r.jsx("h3",{children:"Search Cars"}),r.jsx("button",{className:"search-modal-close",onClick:k,children:""})]}),r.jsxs("div",{className:"search-modal-body",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),r.jsxs("div",{className:"search-input",onClick:v,children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),r.jsx("span",{children:u.locationName})]})]}),r.jsxs("div",{className:"search-field-row",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),r.jsxs("div",{className:"search-input",onClick:()=>C("pickup"),children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsx("span",{children:new Date(u.pickupDate).toLocaleDateString()})]}),u.calendarMode==="pickup"&&r.jsxs("div",{className:"calendar-dropdown active",children:[r.jsxs("div",{className:"calendar-header",children:[r.jsx("button",{onClick:()=>w(-1),children:"<"}),r.jsx("span",{children:new Date(u.currentYear,u.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{onClick:()=>w(1),children:">"})]}),r.jsxs("div",{className:"calendar-weekdays",children:[r.jsx("div",{children:"Sun"}),r.jsx("div",{children:"Mon"}),r.jsx("div",{children:"Tue"}),r.jsx("div",{children:"Wed"}),r.jsx("div",{children:"Thu"}),r.jsx("div",{children:"Fri"}),r.jsx("div",{children:"Sat"})]}),r.jsx("div",{className:"calendar-days",children:R()})]})]}),r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),r.jsxs("div",{className:"search-input",onClick:()=>j("pickup"),children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:u.pickupTime})]}),r.jsxs("div",{className:`time-picker-dropdown ${u.calendarMode==="pickup-time"?"active":""}`,children:[r.jsx("div",{className:"time-picker-label",children:"Choose pick-up time"}),r.jsx("div",{className:"time-picker-options",children:y.map(B=>r.jsx("div",{className:`time-option ${B===u.pickupTime?"selected":""}`,onClick:()=>b("pickup",B),children:B},B))})]})]})]}),r.jsxs("div",{className:"search-field-row",children:[r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),r.jsxs("div",{className:"search-input",onClick:()=>C("return"),children:[r.jsx("i",{className:"fas fa-calendar-check"}),r.jsx("span",{children:new Date(u.returnDate).toLocaleDateString()})]}),u.calendarMode==="return"&&r.jsxs("div",{className:"calendar-dropdown active",children:[r.jsxs("div",{className:"calendar-header",children:[r.jsx("button",{onClick:()=>w(-1),children:"<"}),r.jsx("span",{children:new Date(u.currentYear,u.currentMonth).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{onClick:()=>w(1),children:">"})]}),r.jsxs("div",{className:"calendar-weekdays",children:[r.jsx("div",{children:"Sun"}),r.jsx("div",{children:"Mon"}),r.jsx("div",{children:"Tue"}),r.jsx("div",{children:"Wed"}),r.jsx("div",{children:"Thu"}),r.jsx("div",{children:"Fri"}),r.jsx("div",{children:"Sat"})]}),r.jsx("div",{className:"calendar-days",children:R()})]})]}),r.jsxs("div",{className:"search-field",children:[r.jsxs("label",{children:[r.jsx("i",{className:"fas fa-clock"})," Return Time"]}),r.jsxs("div",{className:"search-input",onClick:()=>j("return"),children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:u.returnTime})]}),r.jsxs("div",{className:`time-picker-dropdown ${u.calendarMode==="return-time"?"active":""}`,children:[r.jsx("div",{className:"time-picker-label",children:"Choose return time"}),r.jsx("div",{className:"time-picker-options",children:y.map(B=>r.jsx("div",{className:`time-option ${B===u.returnTime?"selected":""}`,onClick:()=>b("return",B),children:B},B))})]})]})]}),r.jsxs("div",{className:"rental-duration",children:[r.jsx("i",{className:"fas fa-info-circle"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Rental Duration"}),r.jsx("p",{children:m})]})]}),r.jsxs("div",{className:"rental-warning",children:[r.jsx("i",{className:"fas fa-exclamation-circle"}),r.jsx("p",{children:"Minimum rental duration is 1 hour. Same-day rentals are available. To ensure cars are properly prepared and meet environmental standards, please book at least 2 hours in advance."})]}),r.jsxs("button",{className:"btn-search-submit",onClick:I,children:[r.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})]})})]}):null}function lS(){const[e,t]=_.useState([]),[n,s]=_.useState([]),[o,a]=_.useState(!0),[l,d]=_.useState(0),u=_.useRef(null),[f,m]=_.useState(null),[g,y]=_.useState(!1),[k,v]=_.useState(0),x=["/Picture/E car 1.jpg","/Picture/E car 3.png","/Picture/E car 2.png"],C=_.useRef(null),{showToast:j}=Wu();_.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(B=>{const A=B.coords.accuracy;m({lat:B.coords.latitude,lng:B.coords.longitude}),console.log(" User location:",B.coords.latitude,B.coords.longitude),console.log(" Accuracy:",A,"meters"),A>100&&console.warn(" Location accuracy is low (>"+A+"m). Position may not be precise.")},B=>{console.error(" Could not get user location:",B.message),m({lat:10.8231,lng:106.6297}),j("Could not detect your location. Using default location.","warning",3e3)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.warn("Geolocation is not supported by this browser"),m({lat:10.8231,lng:106.6297}),j("Your browser does not support geolocation","warning",3e3));const I=async()=>{try{if(!Ud.getAllStations){console.warn("stationApi.getAllStations not available");return}const B=await Ud.getAllStations(1,500);console.log(" Loaded stations in HomePage:",B.length,"items"),t(B||[]),B&&B.length>0&&(console.log(" Geocoding all stations in background..."),Xj(B,300))}catch(B){console.error("Failed to load stations",B)}},R=async()=>{try{if(!Qe.getAllCars){console.warn("carApi.getAllCars not available"),a(!1);return}a(!0);const B=await Qe.getAllCars(1,100);console.log(" Loaded cars in HomePage:",B.length,"items"),s(B||[])}catch(B){console.error("Failed to load cars",B)}finally{a(!1)}};I(),R()},[]),_.useEffect(()=>{if(g)return;const I=setInterval(()=>{v(R=>(R+1)%x.length)},6e3);return()=>clearInterval(I)},[x.length,g]),_.useEffect(()=>{const I=u.current;if(!I)return;const R=I.querySelector(".car-card-item");if(!R)return;const B=R.offsetWidth,E=l*(B+20);I.style.transform=`translateX(-${E}px)`},[l,n]),_.useEffect(()=>{const I=()=>{const R=C.current;if(!R)return;const B=document.querySelector(".header"),A=B?B.offsetHeight:80;window.scrollY>A+50?(R.classList.add("sticky"),R.style.top=`${A}px`):(R.classList.remove("sticky"),R.style.top="")};return window.addEventListener("scroll",I,{passive:!0}),I(),()=>window.removeEventListener("scroll",I)},[]);function w(){y(!0)}function N(){y(!1)}function b(I){const R={stationId:I.location,stationName:I.locationName,pickupDate:I.pickupDate,pickupTime:I.pickupTime,returnDate:I.returnDate,returnTime:I.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(R))}catch{}const B=new URLSearchParams({location:I.location,"pickup-date":I.pickupDate,"pickup-time":I.pickupTime,"return-date":I.returnDate,"return-time":I.returnTime});window.location.href=`/cars?${B.toString()}`}function T(){const I=u.current;if(!I)return;const R=I.querySelector(".car-card-item");if(!R)return;const B=Math.floor(I.parentElement.offsetWidth/(R.offsetWidth+20))||1,A=Math.min(n.length,10),E=Math.max(0,Math.ceil(A-B));d(M=>Math.min(E,M+1))}return r.jsxs("main",{children:[r.jsxs("section",{className:"hero-slideshow",children:[r.jsx("div",{className:"slideshow-container",children:x.map((I,R)=>r.jsx("div",{className:`slide fade ${R===k?"active":""}`,children:r.jsx("img",{src:I,alt:`Electric Car ${R+1}`})},R))}),r.jsx("div",{className:"search-form-overlay",id:"searchFormOverlay",ref:C,children:r.jsx("div",{className:"container",children:r.jsxs("div",{className:"search-form-wrapper",children:[r.jsx("h2",{children:"Find Your Perfect Rental Car"}),r.jsxs("div",{className:"search-summary",children:[r.jsxs("div",{className:"summary-item",onClick:w,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Location"}),r.jsx("div",{className:"summary-value",id:"summaryLocation",children:"Select location"})]}),r.jsxs("div",{className:"summary-item",onClick:w,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Date"}),r.jsx("div",{className:"summary-value",children:new Date().toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:w,children:[r.jsx("div",{className:"summary-label",children:"Pick-up Time"}),r.jsx("div",{className:"summary-value",children:"15:00"})]}),r.jsxs("div",{className:"summary-item",onClick:w,children:[r.jsx("div",{className:"summary-label",children:"Return Date"}),r.jsx("div",{className:"summary-value",children:new Date(Date.now()+24*60*60*1e3).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:w,children:[r.jsx("div",{className:"summary-label",children:"Return Time"}),r.jsx("div",{className:"summary-value",children:"19:00"})]}),r.jsxs("button",{type:"button",className:"btn-search",onClick:w,children:[r.jsx("i",{className:"fas fa-search"})," SEARCH"]})]})]})})})]}),r.jsx(ky,{isOpen:g,onClose:N,stations:e,userLocation:f,onSearch:b}),r.jsx("section",{className:"car-section","data-type":"models",children:r.jsxs("div",{className:"container",children:[r.jsx("div",{className:"car-section-header",children:r.jsx("h2",{children:"Our Electric Car Models"})}),r.jsxs("div",{className:"car-carousel-wrapper",children:[r.jsx("button",{className:"carousel-nav prev-carousel",onClick:()=>d(I=>Math.max(0,I-1)),children:r.jsx("i",{className:"fas fa-chevron-left"})}),r.jsx("div",{className:"car-carousel-container",id:"carCarouselContainer",children:r.jsxs("div",{className:"car-carousel-inner",id:"carCarouselInner",ref:u,children:[o&&r.jsx("div",{className:"car-card-item loading-placeholder",style:{textAlign:"center",padding:20},children:"Loading cars..."}),!o&&n.slice(0,10).map((I,R)=>{I.id||I.Id||I.carId;const B=I.name||I.Name||I.model||I.modelName||"Unknown",A=I.imageUrl||I.ImageUrl||I.image||"/Picture/E car 1.jpg",E=parseFloat(I.rentalPricePerHour||I.RentalPricePerHour||0),M=I.seats||I.Seats;return r.jsxs("div",{className:"car-card-item",children:[r.jsx("div",{className:"car-image",children:r.jsx("img",{src:A,alt:B,onError:G=>G.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"car-info",children:[r.jsx("h3",{className:"car-name",children:B}),r.jsxs("div",{className:"car-price-simple",children:[r.jsx("span",{className:"price-amount",children:Yt(E)}),r.jsx("span",{className:"price-label",children:"/hour"})]}),r.jsx("div",{className:"car-specs",children:M?r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-users"})," ",M," Seats"]}):null})]})]},R)})]})}),r.jsx("button",{className:"carousel-nav next-carousel",onClick:()=>T(),children:r.jsx("i",{className:"fas fa-chevron-right"})})]})]})})]})}function cS(){const[e,t]=_.useState([]),[n,s]=_.useState([]),[o,a]=_.useState(!0),[l,d]=_.useState([]),[u,f]=_.useState({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),[m,g]=_.useState("default"),[y,k]=_.useState(()=>{const E=new Date,M=new Date(E.getTime()+24*60*60*1e3);return{location:"",locationName:"Select location",pickupDate:E.toISOString().split("T")[0],pickupTime:"07:00",returnDate:M.toISOString().split("T")[0],returnTime:"24:00"}}),[v,x]=_.useState(!1),[C,j]=_.useState(null);_.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(E=>{j({lat:E.coords.latitude,lng:E.coords.longitude})},E=>{console.error(" Could not get user location:",E.message),j({lat:10.8231,lng:106.6297})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):j({lat:10.8231,lng:106.6297}),w(),N()},[]);const w=async()=>{try{const E=await Ud.getAllStations(1,500);d(E||[])}catch(E){console.error("Failed to load stations",E)}},N=async()=>{try{a(!0);let E=null,M=null;try{const Y=JSON.parse(localStorage.getItem("rentalContext")||"null");Y&&(E=Y.stationId,M=Y,k(z=>({...z,location:Y.stationId,locationName:Y.stationName,pickupDate:Y.pickupDate,pickupTime:Y.pickupTime,returnDate:Y.returnDate,returnTime:Y.returnTime})))}catch{}let G=[];if(E&&M){console.log(" Loading cars for station:",E);try{const Y=`${M.pickupDate}T${M.pickupTime}:00`,z=`${M.returnDate}T${M.returnTime}:00`;console.log(" Pickup DateTime (local):",Y),console.log(" Return DateTime (local):",z),G=await Qe.getAvailableCarsByStation(E,Y,z),console.log(" Found",G.length,"cars at this station")}catch(Y){console.error("Failed to load cars by station, falling back to all cars",Y),G=await Qe.getAllCars(1,100)}}else G=await Qe.getAllCars(1,100);t(G||[]),s(G||[])}catch(E){console.error(E)}finally{a(!1)}};function b(){x(!0)}function T(){x(!1)}function I(E){k({location:E.location,locationName:E.locationName,pickupDate:E.pickupDate,pickupTime:E.pickupTime,returnDate:E.returnDate,returnTime:E.returnTime});const M={stationId:E.location,stationName:E.locationName,pickupDate:E.pickupDate,pickupTime:E.pickupTime,returnDate:E.returnDate,returnTime:E.returnTime,createdAt:new Date().toISOString()};try{localStorage.setItem("rentalContext",JSON.stringify(M))}catch{}a(!0);const G=`${E.pickupDate}T${E.pickupTime}:00`,Y=`${E.returnDate}T${E.returnTime}:00`;console.log(" Pickup DateTime (local):",G),console.log(" Return DateTime (local):",Y),Qe.getAvailableCarsByStation(E.location,G,Y).then(z=>{t(z||[]),s(z||[]),a(!1),T()}).catch(z=>{console.error("Failed to load station cars:",z),alert("Failed to load cars for this station"),a(!1)})}_.useEffect(()=>{let E=[...e];u.brand&&(E=E.filter(M=>(M.brand||"").toLowerCase().includes(u.brand.toLowerCase()))),u.color&&(E=E.filter(M=>(M.color||"").toLowerCase().includes(u.color.toLowerCase()))),u.seats&&(E=E.filter(M=>M.seats===parseInt(u.seats))),u.year&&(E=E.filter(M=>M.year>=parseInt(u.year))),u.priceMin&&(E=E.filter(M=>parseFloat(M.rentalPricePerHour||0)>=parseFloat(u.priceMin))),u.priceMax&&(E=E.filter(M=>parseFloat(M.rentalPricePerHour||0)<=parseFloat(u.priceMax))),m==="name-asc"?E.sort((M,G)=>{const Y=`${M.brand||""} ${M.model||""}`.trim().toLowerCase(),z=`${G.brand||""} ${G.model||""}`.trim().toLowerCase();return Y.localeCompare(z)}):m==="name-desc"?E.sort((M,G)=>{const Y=`${M.brand||""} ${M.model||""}`.trim().toLowerCase();return`${G.brand||""} ${G.model||""}`.trim().toLowerCase().localeCompare(Y)}):m==="price-asc"?E.sort((M,G)=>{const Y=parseFloat(M.rentalPricePerHour||M.RentalPricePerHour||0),z=parseFloat(G.rentalPricePerHour||G.RentalPricePerHour||0);return Y-z}):m==="price-desc"&&E.sort((M,G)=>{const Y=parseFloat(M.rentalPricePerHour||M.RentalPricePerHour||0);return parseFloat(G.rentalPricePerHour||G.RentalPricePerHour||0)-Y}),s(E)},[e,u,m]);const R=()=>{f({brand:"",color:"",seats:"",year:"",priceMin:"",priceMax:""}),s(e)},B=[...new Set(e.map(E=>E.brand).filter(Boolean))],A=[...new Set(e.map(E=>E.color).filter(Boolean))];return Array.from({length:18},(E,M)=>`${(6+M).toString().padStart(2,"0")}:00`),r.jsxs("main",{className:"car-list-main",children:[r.jsx("div",{className:"search-form-container",children:r.jsxs("div",{className:"search-summary",children:[r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-map-marker-alt"})," Pick-up Location"]}),r.jsx("div",{className:"summary-value",children:y.locationName})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-calendar"})," Pick-up Date"]}),r.jsx("div",{className:"summary-value",children:new Date(y.pickupDate).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-clock"})," Pick-up Time"]}),r.jsx("div",{className:"summary-value",children:y.pickupTime})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-calendar-check"})," Return Date"]}),r.jsx("div",{className:"summary-value",children:new Date(y.returnDate).toLocaleDateString()})]}),r.jsxs("div",{className:"summary-item",onClick:b,children:[r.jsxs("div",{className:"summary-label",children:[r.jsx("i",{className:"fas fa-clock"})," Return Time"]}),r.jsx("div",{className:"summary-value",children:y.returnTime})]}),r.jsxs("button",{className:"btn-search-submit",onClick:b,children:[r.jsx("i",{className:"fas fa-search"})," Search Cars"]})]})}),r.jsxs("div",{className:"container",children:[r.jsxs("aside",{className:"filters-sidebar",children:[r.jsx("h3",{className:"filters-title",children:"Filters"}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Brand"}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:u.brand,onChange:E=>f({...u,brand:E.target.value}),children:[r.jsx("option",{value:"",children:"Any Brand"}),B.map(E=>r.jsx("option",{value:E,children:E},E))]})})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Color"}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:u.color,onChange:E=>f({...u,color:E.target.value}),children:[r.jsx("option",{value:"",children:"Any Color"}),A.map(E=>r.jsx("option",{value:E,children:E},E))]})})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Specifications"}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Seats"}),r.jsxs("select",{value:u.seats,onChange:E=>f({...u,seats:E.target.value}),children:[r.jsx("option",{value:"",children:"Any"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"4",children:"4"}),r.jsx("option",{value:"5",children:"5"}),r.jsx("option",{value:"7",children:"7"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Year (min)"}),r.jsx("input",{type:"number",min:"1900",max:"2100",placeholder:"2020",value:u.year,onChange:E=>f({...u,year:E.target.value})})]})]}),r.jsxs("div",{className:"filter-section",children:[r.jsx("h4",{children:"Price Range"}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Min Price (VND/hour)"}),r.jsx("input",{type:"number",min:"0",placeholder:"0",value:u.priceMin,onChange:E=>f({...u,priceMin:E.target.value})})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Max Price (VND/hour)"}),r.jsx("input",{type:"number",min:"0",placeholder:"999,000",value:u.priceMax,onChange:E=>f({...u,priceMax:E.target.value})})]})]}),r.jsx("div",{className:"filter-actions",children:r.jsx("button",{type:"button",className:"btn-reset-filters",onClick:R,children:"Reset Filters"})})]}),r.jsxs("div",{className:"cars-content",children:[r.jsxs("div",{className:"cars-header",children:[r.jsxs("div",{children:[r.jsx("h2",{children:"Available Cars"}),r.jsxs("div",{className:"cars-count",children:["Showing ",n.length," cars"]})]}),r.jsxs("div",{className:"sort-controls",children:[r.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),r.jsxs("select",{id:"sortBy",value:m,onChange:E=>g(E.target.value),className:"sort-select",children:[r.jsx("option",{value:"default",children:"Default"}),r.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),r.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),r.jsx("option",{value:"price-asc",children:"Price (Low to High)"}),r.jsx("option",{value:"price-desc",children:"Price (High to Low)"})]})]})]}),r.jsxs("div",{className:"car-list",children:[o&&r.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading cars..."}),!o&&n.length===0&&r.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"No cars found"}),!o&&n.map((E,M)=>{const G=E.id||E.Id,Y=`${E.brand||""} ${E.model||"Car"}`.trim(),z=E.imageUrl||E.image||"/Picture/E car 1.jpg",X=parseFloat(E.rentalPricePerHour||E.RentalPricePerHour||0),K=E.seats||E.Seats||5,F=E.year||"",$=E.color||"N/A";return r.jsxs("div",{className:"car-card",onClick:()=>window.location.href=`/cars/${G}`,children:[r.jsx("div",{className:"car-image",children:r.jsx("img",{src:z,alt:Y,onError:ge=>ge.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"car-info",children:[r.jsxs("div",{className:"car-info-top",children:[r.jsxs("div",{children:[r.jsx("div",{className:"car-name",children:Y}),r.jsxs("div",{className:"car-location",children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),y.locationName||"Location"]})]}),r.jsxs("div",{className:"car-pricing",children:[r.jsx("div",{className:"car-price",children:Yt(X)}),r.jsx("div",{className:"car-price-label",children:"/hour"})]})]}),r.jsxs("div",{className:"car-details",children:[r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-palette"})," ",$]}),r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-calendar"})," ",F||"N/A"]}),r.jsxs("span",{children:[r.jsx("i",{className:"fas fa-users"})," ",K," seats"]})]})]})]},M)})]})]})," "]})," ",r.jsx(ky,{isOpen:v,onClose:T,stations:l,userLocation:C,onSearch:I,currentSearchData:y})]})}const yp=(e={},t={})=>{const n=[];return(!e.fullName||e.fullName.trim()==="")&&n.push("Full Name"),(!e.email||e.email.trim()==="")&&n.push("Email"),(!e.phoneNumber||e.phoneNumber.trim()==="")&&n.push("Phone Number"),(!e.dateOfBirth||e.dateOfBirth.trim()==="")&&n.push("Date of Birth"),(!t.cccdFront||t.cccdFront.trim()==="")&&n.push("CCCD Front Image"),(!t.cccdBack||t.cccdBack.trim()==="")&&n.push("CCCD Back Image"),(!t.licenseFront||t.licenseFront.trim()==="")&&n.push("Driver License Front Image"),(!t.licenseBack||t.licenseBack.trim()==="")&&n.push("Driver License Back Image"),{isComplete:n.length===0,missingFields:n}};function dS(){const{id:e}=Wg(),t=rn(),[n,s]=_.useState(null),[o,a]=_.useState(!0),[l,d]=_.useState({}),[u,f]=_.useState({}),[m,g]=_.useState(!1),[y,k]=_.useState({isOpen:!1,type:"error",title:"",message:""});if(_.useEffect(()=>{(async()=>{try{const w=await yt.getMyProfile();d(w||{});const b=await yt.getMe()||{},T={cccdFront:b.cccdImageUrl_Front||"",cccdBack:b.cccdImageUrl_Back||"",licenseFront:b.gplxImageUrl_Front||"",licenseBack:b.gplxImageUrl_Back||""};f(T);const{isComplete:I}=yp(w,T);g(I)}catch(w){console.error(" Error loading profile:",w),g(!1)}})()},[]),_.useEffect(()=>{e&&(async()=>{try{a(!0);const w=await Qe.getCarById(e);s(w)}catch(w){console.error(w)}finally{a(!1)}})()},[e]),o)return r.jsx("main",{className:"car-detail-main",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"loading-message",children:"Loading..."})})});if(!n)return r.jsx("main",{className:"car-detail-main",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"error-message",children:"Car not found"})})});const v=n.imageUrl||n.image||"/Picture/E car 1.jpg",x=`${n.brand||""} ${n.model||"Car"}`.trim(),C=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return r.jsxs("main",{className:"car-detail-main",children:[r.jsx(Ur,{isOpen:y.isOpen,onClose:()=>k(j=>({...j,isOpen:!1})),type:y.type,title:y.title,message:y.message}),r.jsxs("div",{className:"container",children:[r.jsxs("button",{className:"back-btn",onClick:()=>t("/cars"),children:[r.jsx("i",{className:"fas fa-arrow-left"})," Back to Cars"]}),r.jsxs("div",{className:"car-detail-grid",children:[r.jsxs("div",{className:"car-left-section",children:[r.jsx("div",{className:"car-image-section",children:r.jsx("div",{className:"main-image",children:r.jsx("img",{src:v,alt:x,onError:j=>j.currentTarget.src="/Picture/E car 1.jpg"})})}),r.jsxs("div",{className:"car-specs",children:[r.jsx("h3",{children:"Car Information"}),r.jsxs("div",{className:"specs-grid",children:[r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-car"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Brand"}),r.jsx("div",{className:"spec-value",children:n.brand||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-palette"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Color"}),r.jsx("div",{className:"spec-value",children:n.color||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-users"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Seats"}),r.jsx("div",{className:"spec-value",children:n.seats||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Year"}),r.jsx("div",{className:"spec-value",children:n.year||"N/A"})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-battery-full"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Battery Range"}),r.jsxs("div",{className:"spec-value",children:[n.batteryCapacity||"N/A"," km"]})]})]}),r.jsxs("div",{className:"spec-item",children:[r.jsx("i",{className:"fas fa-cog"}),r.jsxs("div",{className:"spec-info",children:[r.jsx("div",{className:"spec-label",children:"Transmission"}),r.jsx("div",{className:"spec-value",children:n.transmission||"Automatic"})]})]})]})]}),n.description&&r.jsxs("div",{className:"car-description",children:[r.jsx("h3",{children:"Description"}),r.jsx("p",{children:n.description||n.Description})]})]}),r.jsx("div",{className:"car-right-section",children:r.jsxs("div",{className:"pricing-card",children:[r.jsxs("div",{className:"car-header",children:[r.jsx("h1",{className:"car-title",children:x}),n.year&&r.jsx("span",{className:"car-year",children:n.year})]}),r.jsxs("div",{className:"price-section",children:[r.jsx("div",{className:"price-label",children:"Rental Price"}),r.jsxs("div",{className:"price-value",children:[Yt(C),"/hour"]}),r.jsxs("div",{className:"price-note",children:["Estimated daily rate: ",Yt(Math.round(C*24)),"/day"]})]}),r.jsxs("div",{className:"rental-info",children:[r.jsx("h3",{children:"Rental Details"}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-clock"}),r.jsx("span",{children:"Minimum rental: 1 hour"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-shield-alt"}),r.jsx("span",{children:"Insurance included"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-gas-pump"}),r.jsx("span",{children:"Fuel policy: Same to same"})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("i",{className:"fas fa-map-marked-alt"}),r.jsx("span",{children:"Unlimited mileage"})]})]}),r.jsxs("button",{className:"book-now-btn",onClick:()=>{if(!m){const{missingFields:j}=yp(l,u);k({isOpen:!0,type:"warning",title:" Incomplete Profile",message:`Please complete your profile before booking.

Missing fields:
${j.join(", ")}

You will be redirected to update your profile.`}),setTimeout(()=>{t("/profile")},2e3);return}localStorage.setItem("selectedCarId",n.id||n.Id),t("/payment")},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",m?"Book Now":"Complete Profile First"]})]})})]})]})]})}const Xt={createBooking:async(e,t)=>{var n,s,o,a;try{console.log(" Creating booking for user:",t),console.log(" Booking data:",e);const l={carId:e.carId,stationId:e.pickupStationId||e.returnStationId||e.stationId,pickupDateTime:e.pickupDateTime,expectedReturnDateTime:e.expectedReturnDateTime};console.log(" Sending payload:",l);const d=await te.post(`/Bookings/Create-With-Deposit?userId=${encodeURIComponent(t)}`,l);return console.log(" Booking created:",d.data),((n=d.data)==null?void 0:n.data)||d.data||{}}catch(l){throw console.error(" Error creating booking:",((s=l.response)==null?void 0:s.data)||l.message),(a=(o=l.response)==null?void 0:o.data)!=null&&a.errors&&console.error(" Validation errors:",l.response.data.errors),l}},confirmBooking:async(e,t,n="")=>{var s,o;try{console.log(" Confirming booking:",e);const a={bookingId:e,paymentMethod:t,paymentTransactionId:n},l=await te.post("/Bookings/Confirm",a);return console.log(" Booking confirmed:",l.data),((s=l.data)==null?void 0:s.data)||l.data||{}}catch(a){throw console.error(" Error confirming booking:",((o=a.response)==null?void 0:o.data)||a.message),a}},completeBooking:async e=>{var t,n;try{console.log(" Completing booking:",e);const s=await te.post(`/Bookings/Complete-By-${encodeURIComponent(e)}`);return console.log(" Booking completed:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error completing booking:",((n=s.response)==null?void 0:n.data)||s.message),s}},getUserBookings:async e=>{var t;try{console.log(" Fetching bookings for current user");const n=await te.get("/Bookings/My-Bookings");console.log(" Raw /Bookings/My-Bookings response:",n.data);const s=n.data||{};return Array.isArray(s)?(console.log(" Returning bookings (direct array), count:",s.length),s):s.data&&Array.isArray(s.data)?(console.log(" Returning bookings from response.data, count:",s.data.length),s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?(console.log(" Returning bookings from response.data.data, count:",s.data.data.length),s.data.data):s.data&&s.data.items&&Array.isArray(s.data.items)?(console.log(" Returning bookings from response.data.items, count:",s.data.items.length),s.data.items):s.items&&Array.isArray(s.items)?(console.log(" Returning bookings from response.items, count:",s.items.length),s.items):s.bookings&&Array.isArray(s.bookings)?(console.log(" Returning bookings from response.bookings, count:",s.bookings.length),s.bookings):s&&(s.id||s.bookingId||s.bookingStatus)?(console.log(" Response looks like a single booking object, wrapping in array"),[s]):(console.warn(" No bookings array found in /Bookings/My-Bookings response; returning empty array"),[])}catch(n){if(console.error(" Error fetching user bookings:",((t=n.response)==null?void 0:t.data)||n.message),n.response&&n.response.status===401)throw n;return[]}},cancelBooking:async(e,t)=>{var n,s;try{console.log(" Cancelling booking:",e);const o=await te.post(`/Bookings/Cancel-By-${encodeURIComponent(e)}`,null,{params:{userId:t}});return console.log(" Booking cancelled:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error cancelling booking:",((s=o.response)==null?void 0:s.data)||o.message),o}},getBookingById:async e=>{var t,n;try{console.log(" Fetching booking details for ID:",e);const s=await te.get(`/Bookings/Get-By-${encodeURIComponent(e)}`);return console.log(" Booking details:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking details:",((n=s.response)==null?void 0:n.data)||s.message),s}}},gr={getContractByBooking:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Booking/${t}`,`/Contract/Get-By-Booking/${t}`,`/Contracts/By-Booking/${t}`,`/contracts/booking/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},getContractByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contract/Get-By-Renter/${t}`,`/Contracts/By-Renter/${t}`,`/contracts/renter/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createRentalContract:async(e,t=null,n=null)=>{var l;if(!e)throw new Error("bookingId is required");let s=`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(e)}`;t&&(s+=`&renterId=${encodeURIComponent(t)}`);const o=[{url:s,method:"post",data:n},{url:"/Contracts/Create",method:"post",data:{bookingId:e}},{url:"/Contract/Create",method:"post",data:{bookingId:e}}];let a;for(const d of o)try{const u=await te[d.method](d.url,d.data||{}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create contract endpoint not found")},sendContractEmail:async(e,t=null)=>{var a,l,d;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e);console.log(" sendContractEmail called with contractId:",e,"email:",t);const s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,"/Contract/SendEmail"];let o;for(const u of s)try{console.log(" Trying endpoint:",u);const f=await te.post(u,t?{email:t}:{}),m=f==null?void 0:f.data;return console.log(" Success on endpoint:",u,"response:",m),m&&typeof m=="object"&&"data"in m?m.data:m}catch(f){console.warn(" Failed on endpoint:",u,"status:",(a=f==null?void 0:f.response)==null?void 0:a.status,"error:",((l=f==null?void 0:f.response)==null?void 0:l.data)||(f==null?void 0:f.message)),o=f;const m=(d=f==null?void 0:f.response)==null?void 0:d.status;if(m&&m!==404&&m!==405)throw f}throw console.error(" All endpoints failed for sendContractEmail"),o||new Error("Send contract email endpoint not found")},isContractConfirmed:async e=>{var s;if(!e)return!1;const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/xac-nhan`,`/Contracts/Get-By-Booking/${t}`,`/Contracts/${t}/Is-Confirmed`,"/Contract/IsConfirmed"];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;return d===!0||(d==null?void 0:d.isConfirmed)===!0||(d==null?void 0:d.IsConfirmed)===!0}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return!1},confirmContractSigning:async e=>{var o;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}/ky`,`/Contracts/${t}/Confirm`,"/Contract/ConfirmSigning"];let s;for(const a of n)try{const l=await te.post(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Confirm contract signing endpoint not found")},deleteContract:async e=>{var o;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/${t}`,`/Contracts/${t}`,`/Contract/Delete/${t}`];let s;for(const a of n)try{const l=await te.delete(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Delete contract endpoint not found")},downloadContract:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/${t}/Download`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract endpoint not found")},getContractDownloadByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Get contract download link endpoint not found")},getContractViewingByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/View/${t}`,`/Contract/View/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createContract:async e=>{var s;const t=[{url:"/Contracts/Create",method:"post"},{url:"/Contract/Create",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Create contract endpoint not found")},fillContract:async e=>{var s;const t=[{url:"/Contracts/Fill",method:"post"},{url:"/Contract/Fill",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Fill contract endpoint not found")},requestConfirmation:async(e,t)=>{var a;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e),s=[`/Contracts/Request-Confirmation-By-${n}`,`/Contracts/${n}/Request-Confirmation`,`/Contract/RequestConfirmation/${n}`];let o;for(const l of s)try{const d=await te.post(l,{email:t}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Request confirmation endpoint not found")},confirmContract:async e=>{var s;const t=[{url:"/Contracts/Confirm",method:"post"},{url:"/Contract/Confirm",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,e),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Confirm contract endpoint not found")},getContractsByRenter:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Contracts/Get-By-Renter/${t}`,`/Contracts/Renter/${t}`,`/Contract/Get-By-Renter/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},createHopDong:async(e,t,n)=>{var l;if(!t||!n)throw new Error("bookingId and renterId are required");const o=[{url:`/Contracts/hopdong/tao?bookingId=${encodeURIComponent(t)}&renterId=${encodeURIComponent(n)}`,method:"post"},{url:"/Contracts/Create",method:"post"}];let a;for(const d of o)try{const u=await te[d.method](d.url,e),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create HopDong endpoint not found")},sendConfirmationEmail:async(e,t)=>{var a;if(!e)throw new Error("contractId is required");const n=encodeURIComponent(e),s=[`/Contracts/hopdong/${n}/gui-email`,`/Contracts/${n}/Send-Email`,`/Contract/SendEmail/${n}`];let o;for(const l of s)try{const d=await te.post(l,{email:t}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Send confirmation email endpoint not found")},getContractForConfirmation:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/xac-nhan/${t}`,`/Contracts/Confirmation/${t}`,`/Contract/GetForConfirmation/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},signContract:async e=>{var s;if(!e)throw new Error("token is required");const t=[{url:"/Contracts/hopdong/ky",method:"post"},{url:"/Contracts/Sign",method:"post"},{url:"/Contract/Sign",method:"post"}];let n;for(const o of t)try{const a=await te[o.method](o.url,{token:e}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){n=a;const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw n||new Error("Sign contract endpoint not found")},downloadContractByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/download/${t}`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract by token endpoint not found")},downloadContractById:async e=>{var s;if(!e)throw new Error("contractId is required");const t=encodeURIComponent(e),n=[`/Contracts/${t}/download`,`/Contracts/Download/${t}`,`/Contract/Download/${t}`];for(const o of n)try{return(await te.get(o,{responseType:"blob"})).data}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Download contract by ID endpoint not found")},downloadLatestContractByUserId:async e=>{var n;if(!e)throw new Error("userId is required");const t=[{url:"/Contracts/user/download-latest-by-userId",params:{userId:e}},{url:"/Contracts/Download-Latest",params:{userId:e}}];for(const s of t)try{return(await te.get(s.url,{params:s.params,responseType:"blob"})).data}catch(o){const a=(n=o==null?void 0:o.response)==null?void 0:n.status;if(a&&a!==404&&a!==405)throw o}throw new Error("Download latest contract by user ID endpoint not found")},downloadMyLatestContract:async()=>{var t;const e=["/Contracts/download-my-contract","/Contracts/download-latest"];for(const n of e)try{return(await te.get(n,{responseType:"blob"})).data}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}throw new Error("Download my latest contract endpoint not found")},getContractByToken:async e=>{var s;if(!e)throw new Error("token is required");const t=encodeURIComponent(e),n=[`/Contracts/hopdong/token/${t}`,`/Contracts/Token/${t}`,`/Contract/GetByToken/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null}},Lr={createPayment:async(e,t=0,n="Payment",s=0)=>{var o,a;try{console.log(" Creating payment for booking:",e,"| Type:",t,"| Extra amount:",s);const l={bookingId:e,paymentType:t,description:n};s>0&&(l.extraAmount=s);const d=await te.post("/Payment/create",l);return console.log(" Payment created:",d.data),((o=d.data)==null?void 0:o.data)||d.data||{}}catch(l){throw console.error(" Error creating payment:",((a=l.response)==null?void 0:a.data)||l.message),l}},syncPayment:async e=>{var t,n;try{console.log(" Syncing payment for booking:",e);const s=await te.post(`/Payment/sync/${encodeURIComponent(e)}`);return console.log(" Payment synced:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error syncing payment:",((n=s.response)==null?void 0:n.data)||s.message),s}}};async function uS(e,t={}){if(!e)throw new Error("stationId is required");const{from:n,to:s,token:o}=t||{},a={};n&&(a.from=n),s&&(a.to=s);const l={params:a};o&&(l.headers={Authorization:`Bearer ${o}`});const d=await te.get(`/Payment/station/${encodeURIComponent(e)}/revenue`,l);return(d==null?void 0:d.data)||d}function hS(){const e=rn(),{showToast:t}=Wu(),[n,s]=_.useState(null),[o,a]=_.useState(null),[l,d]=_.useState(!1),[u,f]=_.useState(!1),[m,g]=_.useState(!1),[y,k]=_.useState(!1),[v,x]=_.useState({isOpen:!1,type:"info",title:"",message:""});_.useEffect(()=>{try{const B=JSON.parse(localStorage.getItem("rentalContext")||"null");if(!B){alert("No rental information found. Please search for a car first."),e("/");return}a(B);const A=localStorage.getItem("selectedCarId");A&&Qe.getCarById(A).then(E=>s(E))}catch(B){console.error(B)}},[e]);const C=()=>{if(!o||!n)return 0;const B=new Date(`${o.pickupDate}T${o.pickupTime}`),A=new Date(`${o.returnDate}T${o.returnTime}`),E=Math.ceil((A-B)/(1e3*60*60)),M=parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0);return E*M},j=()=>{if(!o)return 0;const B=new Date(`${o.pickupDate}T${o.pickupTime}`),A=new Date(`${o.returnDate}T${o.returnTime}`);return Math.ceil((A-B)/(1e3*60*60))},w=()=>n?parseFloat(n.rentalPricePerHour||n.RentalPricePerHour||0):0,N=()=>C()*.3,b=()=>{const B=new Date,A=String(B.getDate()).padStart(2,"0"),E=String(B.getMonth()+1).padStart(2,"0"),M=B.getFullYear(),G=localStorage.getItem("userFirstName")||"",Y=localStorage.getItem("userLastName")||"",z=localStorage.getItem("userDateOfBirth")||"",X=localStorage.getItem("userIdentityNumber")||"",K=localStorage.getItem("userAddress")||"",F=localStorage.getItem("userDriverLicenseClass")||"",$=localStorage.getItem("userDriverLicenseNumber")||"",ge=localStorage.getItem("userDriverLicenseExpiry")||"",re=new Date(`${o.pickupDate}T${o.pickupTime}`),fe=new Date(`${o.returnDate}T${o.returnTime}`),_e=Math.ceil((fe-re)/(1e3*60*60*24)),se=C(),O=z?new Date(z).getFullYear().toString():"";return{soHopDong:`H-${B.getTime()}`,ngayKy:A,thangKy:E,namKy:M.toString(),benA:{hoTen:`${G} ${Y}`,namSinh:O,cccdHoacHoChieu:X,hoKhauThuongTru:K},xe:{nhanHieu:n.brand||"",bienSo:n.licensePlate||"",loaiXe:n.model||"",mauSon:n.color||"",choNgoi:(n.seats||0).toString(),xeDangKiHan:(n.year||"").toString()},giaThue:{giaThueSo:se.toString(),giaThueChu:se.toString(),phuongThucThanhToan:"Chuyn khon",ngayThanhToan:B.toISOString().split("T")[0]},thoiHanThueSo:_e.toString(),thoiHanThueChu:_e.toString(),thoiHanThue:_e,donViThoiHan:"ngay",gplx:{hang:F,so:$,hanSuDung:ge}}},T=async()=>{var B,A;if(!l){alert("Please agree to the Terms and Conditions and Privacy Policy to continue.");return}if(!n||!o){alert("Missing booking information. Please try again.");return}k(!0);try{const E=localStorage.getItem("userId");if(!E){alert("User ID not found. Please logout and login again."),e("/");return}const M=new Date(`${o.pickupDate}T${o.pickupTime}`).toISOString(),G=new Date(`${o.returnDate}T${o.returnTime}`).toISOString(),Y=o.stationId;console.log(" Using station from rental context:",o.stationName,"- ID:",Y);const z={carId:n.id||n.Id,userId:E,pickupStationId:Y,returnStationId:Y,pickupDateTime:M,expectedReturnDateTime:G,totalAmount:C()};console.log(" Creating booking with user-selected station..."),console.log(" Booking data:",z);const X=await Xt.createBooking(z,E),K=X.id||X.Id||X.bookingId;if(!K)throw new Error("Booking ID not received from server");console.log(" Booking created:",K),console.log(" Creating contract...");const F=b(),$=await gr.createRentalContract(K,E,F),ge=($==null?void 0:$.id)||($==null?void 0:$.contractId)||$;console.log(" Contract created with ID:",ge),console.log(" Full contract response:",$);try{const re=localStorage.getItem("userEmail");if(re&&ge){console.log(" Waiting 1s before sending email..."),await new Promise(_e=>setTimeout(_e,1e3)),console.log(" Sending contract email to:",re),console.log(" Contract ID being used:",ge);const fe=await gr.sendContractEmail(ge,re);console.log(" Email sent, response:",fe)}}catch(re){console.warn(" Email failed (non-critical):",re.message),console.error(" Full error:",re)}try{console.log(" Creating deposit payment...");const re=N(),fe=await Lr.createPayment(K,0,"Cc thu xe");console.log(" Payment created:",fe)}catch(re){console.warn(" Payment creation failed (non-critical):",re.message)}x({isOpen:!0,type:"success",title:"Booking Created Successfully! ",message:"The contract has been sent to your email. You have 10 minutes to sign the contract and complete the deposit payment before the reservation expires. You can view details in your Booking History."}),setTimeout(()=>{localStorage.removeItem("selectedCarId"),localStorage.removeItem("rentalContext"),e("/booking-history")},3e3)}catch(E){console.error(" Error:",E);const M=((A=(B=E.response)==null?void 0:B.data)==null?void 0:A.message)||E.message||"Failed to create booking";M.toLowerCase().includes("car not available")?(t("This car is not available, please choose another one!","error",4e3),setTimeout(()=>e("/cars"),2e3)):alert(M)}finally{k(!1)}};if(!o||!n)return r.jsx("div",{className:"loading-container",children:r.jsx("p",{children:"Loading..."})});const I=C(),R=N();return r.jsxs("main",{className:"payment-page",children:[r.jsxs("div",{className:"container",children:[r.jsx("h2",{children:"Confirm Your Reservation"}),r.jsx("div",{className:"payment-layout",children:r.jsxs("div",{className:"payment-info-column",children:[r.jsxs("div",{className:"info-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h3",{className:"section-heading",children:"Rental Information"}),r.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Change]"})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Pick-up Location:"}),r.jsx("span",{className:"info-value",children:o.stationName})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Pick-up Date & Time:"}),r.jsxs("span",{className:"info-value",children:[o.pickupDate," ",o.pickupTime]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Return Date & Time:"}),r.jsxs("span",{className:"info-value",children:[o.returnDate," ",o.returnTime]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Total Rental Time:"}),r.jsxs("span",{className:"info-value",children:[j()," hour",j()!==1?"s":""]})]})]}),r.jsxs("div",{className:"info-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h3",{className:"section-heading",children:"Car Information"}),r.jsx("button",{type:"button",className:"edit-link",onClick:()=>e("/cars"),children:"[Pick another car ]"})]}),r.jsxs("div",{className:"car-preview",children:[r.jsx("img",{src:n.imageUrl||n.image||"/Picture/E car 1.jpg",alt:`${n.brand} ${n.model}`,onError:B=>{B.target.src="/Picture/E car 1.jpg"}}),r.jsxs("div",{className:"car-details",children:[r.jsxs("h4",{children:[n.brand," ",n.model]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Color:"})," ",n.color]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Seats:"})," ",n.seats]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Year:"})," ",n.year]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Price:"})," ",Yt(parseFloat(n.rentalPricePerHour||0)),"/hour"]})]})]})]}),r.jsxs("div",{className:"info-section price-summary-section",children:[r.jsx("h3",{className:"section-heading",children:"Price Summary"}),r.jsxs("div",{className:"price-breakdown",children:[r.jsxs("div",{className:"price-row",children:[r.jsx("span",{className:"price-label",children:"Unit Price:"}),r.jsxs("span",{className:"price-value",children:[r.jsx("span",{className:"price-amount",children:Yt(w())}),r.jsx("span",{className:"unit",children:"/hour"})]})]}),r.jsxs("div",{className:"price-row",children:[r.jsx("span",{className:"price-label",children:"Rental Time:"}),r.jsxs("span",{className:"price-value",children:[r.jsxs("span",{className:"price-amount",children:[" ",j()]}),r.jsxs("span",{className:"unit",children:[" hour",j()!==1?"s":""]})]})]}),r.jsx("div",{className:"price-divider"}),r.jsxs("div",{className:"price-row total-row",children:[r.jsx("span",{className:"price-label",children:"Total Rental Cost:"}),r.jsx("span",{className:"price-value-total",children:r.jsx("span",{className:"price-amount",children:Yt(I)})})]}),r.jsxs("div",{className:"price-row deposit-row-summary",children:[r.jsx("span",{className:"price-label",children:"Deposit Required (30%):"}),r.jsx("span",{className:"price-value-deposit",children:r.jsx("span",{className:"price-amount",children:Yt(R)})})]})]})]})]})}),r.jsx("div",{className:"terms-section",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:B=>d(B.target.checked)}),r.jsxs("span",{children:["I agree to the ",r.jsx("button",{type:"button",className:"link-button",onClick:()=>f(!0),children:"Terms and Conditions"})," and ",r.jsx("button",{type:"button",className:"link-button",onClick:()=>g(!0),children:"Privacy Policy"})]})]})}),r.jsx("div",{className:"cta-button-container",children:r.jsx("button",{className:"btn-confirm-booking",onClick:T,disabled:!l||y,children:y?"Creating...":"Confirm and Deposit"})})]}),r.jsx("div",{className:"page-actions",children:r.jsx("div",{className:"page-actions-inner"})}),u&&r.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:r.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Terms and Conditions"}),r.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsx("h4",{children:"1. Rental Agreement"}),r.jsx("p",{children:"By renting a vehicle from our service, you agree to use the vehicle responsibly and return it in the same condition as received."}),r.jsx("h4",{children:"2. Driver Requirements"}),r.jsx("p",{children:"The driver must be at least 21 years old and possess a valid driver's license for at least 1 year."}),r.jsx("h4",{children:"3. Vehicle Usage"}),r.jsx("p",{children:"The vehicle may only be driven by the person(s) listed on the rental agreement. Unauthorized drivers are prohibited."}),r.jsx("h4",{children:"4. Fuel Policy"}),r.jsx("p",{children:"For electric vehicles, please return the car with at least 70% battery charge. Additional charging fees may apply if returned below this level."}),r.jsx("h4",{children:"5. Damage and Liability"}),r.jsx("p",{children:"The renter is responsible for any damage to the vehicle during the rental period, excluding normal wear and tear."}),r.jsx("h4",{children:"6. Cancellation Policy"}),r.jsx("p",{children:"Cancellations made more than 24 hours before pick-up time will receive a full refund. Cancellations within 24 hours will forfeit the deposit."}),r.jsx("h4",{children:"7. Late Returns"}),r.jsx("p",{children:"Late returns will be charged at 1.5x the hourly rate for each additional hour."}),r.jsx("h4",{children:"8. Insurance"}),r.jsx("p",{children:"Basic insurance is included in the rental price. Additional coverage options are available at checkout."})]})]})}),m&&r.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:r.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Privacy Policy"}),r.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsx("h4",{children:"1. Information Collection"}),r.jsx("p",{children:"We collect personal information including name, email, phone number, driver's license details, and payment information necessary to process your rental booking."}),r.jsx("h4",{children:"2. Use of Information"}),r.jsx("p",{children:"Your information is used solely for processing rentals, communication regarding your booking, and improving our services."}),r.jsx("h4",{children:"3. Data Security"}),r.jsx("p",{children:"We implement industry-standard security measures to protect your personal information from unauthorized access, disclosure, or misuse."}),r.jsx("h4",{children:"4. Third-Party Sharing"}),r.jsx("p",{children:"We do not sell or share your personal information with third parties except as required for payment processing or legal compliance."}),r.jsx("h4",{children:"5. Cookies"}),r.jsx("p",{children:"Our website uses cookies to enhance user experience and analyze site traffic. You can disable cookies in your browser settings."}),r.jsx("h4",{children:"6. Data Retention"}),r.jsx("p",{children:"We retain your booking information for 7 years as required by law. You may request deletion of your data at any time."}),r.jsx("h4",{children:"7. Your Rights"}),r.jsx("p",{children:"You have the right to access, correct, or delete your personal information. Contact our support team to exercise these rights."}),r.jsx("h4",{children:"8. Contact"}),r.jsx("p",{children:"For privacy concerns or questions, please contact us at privacy@carental.com"})]})]})}),r.jsx(Ur,{isOpen:v.isOpen,type:v.type,title:v.title,message:v.message,onClose:()=>x({...v,isOpen:!1})})]})}function fS(){const e=rn(),[t,n]=_.useState(!0),[s,o]=_.useState(null);return _.useEffect(()=>{console.log(" Payment successful! Checking user role and payment type...");const a=async()=>{try{const d=localStorage.getItem("userRole");console.log(" User role:",d);let u=localStorage.getItem("currentBookingId"),f="user-deposit";if(u||(u=localStorage.getItem("activeCheckInBookingId"),u&&(f="staff-checkin",console.log(" Found check-in booking ID (staff payment):",u))),u||(u=localStorage.getItem("activeCheckOutBookingId"),u&&(f="staff-checkout",console.log(" Found check-out booking ID (staff payment):",u))),!u){console.warn(" No booking ID found in localStorage"),o("Booking ID not found"),n(!1),l(d);return}console.log(" Auto-syncing payment for booking:",u),await Lr.syncPayment(u),console.log(" Payment status synced successfully"),console.log(" Fetching booking details to check status...");const m=await Xt.getBookingById(u),g=Number((m==null?void 0:m.bookingStatus)||(m==null?void 0:m.BookingStatus));console.log(" Booking status after payment:",g,"(0=Pending, 1=Active, 2=Waiting Check-in, 3=Checked-in, 4=Check-out Pending, 5=Completed)"),n(!1),setTimeout(()=>{try{localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),localStorage.removeItem("activeCheckInBookingId"),localStorage.removeItem("activeCheckOutBookingId")}catch(y){console.warn("Failed to clear storage:",y)}l(d)},1500)}catch(d){console.error(" Error in payment sync flow:",d),o("Failed to process payment or create contract"),n(!1);const u=localStorage.getItem("userRole");setTimeout(()=>l(u),3e3)}},l=d=>{if(console.log(" Redirecting based on user role:",d,"type:",typeof d),!d){console.warn(" No role found, redirecting to booking history as default"),e("/booking-history");return}const u=String(d).toLowerCase().trim();if(console.log(" Normalized role:",u),u.includes("admin")){console.log(" Redirecting to Admin page"),e("/admin");return}if(u.includes("staff")||u.includes("manager")||u==="stationstaff"||u==="stationmanager"){console.log(" Redirecting to Staff page"),e("/staff");return}if(u.includes("renter")||u.includes("evrenter")||u==="evrenter"){console.log(" Redirecting to Booking History page"),e("/booking-history");return}console.log(" Unknown role, redirecting to booking history as default"),e("/booking-history")};a()},[e]),r.jsx("main",{className:"payment-success-main",children:r.jsx("div",{className:"payment-success-container",children:t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon processing",children:""}),r.jsx("h1",{children:"Processing Payment..."}),r.jsx("p",{children:"Please wait while we confirm your payment."})]}):s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon error",children:""}),r.jsx("h1",{children:"Payment Sync Issue"}),r.jsx("p",{children:s}),r.jsx("p",{className:"small",children:"Redirecting to booking history..."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-success-icon success",children:""}),r.jsx("h1",{children:"Payment Successful!"}),r.jsx("p",{children:"Your payment has been processed."}),r.jsx("p",{className:"small",children:"Redirecting to booking history..."})]})})})}function pS(){const e=rn(),{showToast:t}=Wu(),[n]=Gg(),[s,o]=_.useState(!0);return _.useEffect(()=>{(async()=>{console.log(" PaymentCancel component mounted!"),console.log(" Current URL:",window.location.href);try{const l=n.get("orderCode"),d=n.get("status"),u=n.get("cancel");if(console.log(" Payment cancelled:",{orderCode:l,status:d,cancel:u}),u==="true"&&d==="CANCELLED"){const f=localStorage.getItem("currentBookingId");f?(console.log(" Payment cancelled for booking:",f),console.log(" Payment session cleared - booking status unchanged"),localStorage.removeItem("currentBookingId"),localStorage.removeItem("depositAmount"),t("Payment cancelled. You can retry payment from your booking history.","info",3e3)):(console.warn(" No booking ID found in localStorage"),t("Payment cancelled.","info",3e3)),setTimeout(()=>{e("/booking-history")},2e3)}else t("Invalid payment cancellation.","error",3e3),setTimeout(()=>{e("/booking-history")},1500)}catch(l){console.error(" Error handling payment cancellation:",l),t("An error occurred. Redirecting to home...","error",3e3),setTimeout(()=>{e("/")},2e3)}finally{o(!1)}})()},[n,e,t]),r.jsx("main",{className:"payment-cancel-container",children:r.jsx("div",{className:"payment-cancel-card",children:s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-cancel-icon processing",children:""}),r.jsx("h1",{children:"Processing Cancellation..."}),r.jsx("p",{children:"Clearing payment session. You can retry payment later."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"payment-cancel-icon cancelled",children:""}),r.jsx("h1",{children:"Payment Cancelled"}),r.jsx("p",{children:"Your payment has been cancelled. Your booking is still active and you can retry payment anytime."}),r.jsx("p",{className:"small",style:{fontSize:"13px",color:"#999",marginTop:"20px"},children:"Redirecting to booking history..."})]})})})}const mS=()=>{const e=rn(),t=xi(),[n,s]=_.useState(10),[o,a]=_.useState(!1),[l,d]=_.useState(!1),{bookingId:u,depositAmount:f,totalAmount:m,carInfo:g,rentalInfo:y}=t.state||{};_.useEffect(()=>{if(!u){e("/payment");return}const v=setInterval(()=>{s(x=>x<=1?(clearInterval(v),k(),0):x-1)},1e3);return()=>clearInterval(v)},[u]);const k=async()=>{a(!0);try{await new Promise(v=>setTimeout(v,1e3)),console.log(" Payment simulation completed for booking:",u),console.log("  Booking is in Pending status. Admin will confirm after payment verification."),d(!0),setTimeout(()=>{e("/booking-history")},2e3)}catch(v){console.error("Error in payment flow:",v),alert("An error occurred. Redirecting to booking history..."),e("/booking-history")}finally{a(!1)}};return u?r.jsx("main",{className:"transaction-page",children:r.jsx("div",{className:"container",children:r.jsx("div",{className:"transaction-content",children:l?r.jsxs("div",{className:"success-section",children:[r.jsx("div",{className:"success-icon",children:r.jsx("i",{className:"fas fa-check-circle"})}),r.jsx("h2",{children:"Booking Created Successfully!"}),r.jsx("p",{children:"Your booking is pending payment confirmation."}),r.jsxs("p",{style:{fontSize:"0.95rem",color:"#666",margin:"1rem 0"},children:["Booking ID: ",r.jsx("strong",{children:u})]}),r.jsx("p",{className:"redirect-text",children:"Redirecting to booking history..."})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"transaction-header",children:[r.jsx("div",{className:"icon-circle",children:r.jsx("i",{className:"fas fa-credit-card"})}),r.jsx("h2",{children:"Complete Your Payment"}),r.jsxs("p",{className:"booking-id",children:["Booking ID: ",r.jsx("span",{children:u})]})]}),r.jsxs("div",{className:"payment-layout",children:[r.jsxs("div",{className:"qr-section",children:[r.jsx("h3",{children:"Scan QR Code to Pay"}),r.jsxs("div",{className:"qr-placeholder",children:[r.jsx("i",{className:"fas fa-qrcode"}),r.jsx("p",{children:"QR Code Here"})]}),r.jsxs("div",{className:"payment-instructions",children:[r.jsx("h4",{children:"Payment Instructions:"}),r.jsxs("ol",{children:[r.jsx("li",{children:"Open your banking app"}),r.jsx("li",{children:"Scan the QR code above"}),r.jsx("li",{children:"Confirm the payment amount"}),r.jsx("li",{children:"Complete the transaction"})]})]})]}),r.jsxs("div",{className:"payment-details",children:[r.jsx("h3",{children:"Payment Details"}),r.jsxs("div",{className:"detail-card",children:[r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Deposit Amount:"}),r.jsx("span",{className:"value highlight",children:Yt(f)})]}),r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Total Rental Cost:"}),r.jsx("span",{className:"value",children:Yt(m)})]}),r.jsxs("div",{className:"detail-row",children:[r.jsx("span",{className:"label",children:"Remaining Balance:"}),r.jsx("span",{className:"value",children:Yt((m||0)-(f||0))})]})]}),g&&r.jsxs("div",{className:"detail-card",children:[r.jsxs("h4",{children:[r.jsx("i",{className:"fas fa-car"})," Vehicle"]}),r.jsx("p",{children:r.jsxs("strong",{children:[g.brand," ",g.model]})}),r.jsxs("p",{children:[g.color,"  ",g.seats," seats  ",g.year]})]}),y&&r.jsxs("div",{className:"detail-card",children:[r.jsxs("h4",{children:[r.jsx("i",{className:"fas fa-calendar-alt"})," Rental Period"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Pick-up:"})," ",y.pickupDate," ",y.pickupTime]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Return:"})," ",y.returnDate," ",y.returnTime]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Location:"})," ",y.stationName]})]}),r.jsxs("div",{className:"countdown-section",children:[r.jsxs("div",{className:"countdown-circle",children:[r.jsx("span",{className:"countdown-number",children:n}),r.jsx("span",{className:"countdown-label",children:"seconds"})]}),r.jsx("p",{className:"countdown-text",children:o?"Processing payment...":"Simulating payment completion in..."})]}),r.jsxs("div",{className:"info-box",children:[r.jsx("i",{className:"fas fa-info-circle"}),r.jsxs("p",{children:["This is a demo. Your booking will be created in ",r.jsx("strong",{children:"Pending"})," status. Admin will confirm after receiving payment. Payment simulation completes after ",n," second",n!==1?"s":"","."]})]})]})]})]})})})}):null},zd={getAllFeedbacks:async(e=1,t=10)=>{var n,s;try{console.log(" Fetching all feedbacks - page:",e,"size:",t);const o=await te.get("/Feedback/Get-All",{params:{pageNumber:e,pageSize:t}});return console.log(" Feedbacks fetched:",o.data),((n=o.data)==null?void 0:n.data)||o.data||[]}catch(o){throw console.error(" Error fetching feedbacks:",((s=o.response)==null?void 0:s.data)||o.message),o}},getFeedbackById:async e=>{var t,n;try{console.log(" Fetching feedback:",e);const s=await te.get(`/Feedback/Get-By-${encodeURIComponent(e)}`);return console.log(" Feedback fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching feedback:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByCarId:async e=>{var t,n;try{console.log(" Fetching feedbacks for car:",e);const s=await te.get(`/Feedback/Get-By-Car/${encodeURIComponent(e)}`);return console.log(" Car feedbacks fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||[]}catch(s){throw console.error(" Error fetching car feedbacks:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByUserId:async e=>{var t,n;try{console.log(" Fetching feedbacks for user:",e);const s=await te.get(`/Feedback/Get-By-User/${encodeURIComponent(e)}`);return console.log(" User feedbacks fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||[]}catch(s){throw console.error(" Error fetching user feedbacks:",((n=s.response)==null?void 0:n.data)||s.message),s}},getFeedbackByBookingId:async e=>{var t,n;try{console.log(" Fetching feedback for booking:",e);const s=await te.get(`/Feedback/Get-By-Booking/${encodeURIComponent(e)}`);return console.log(" Booking feedback fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching booking feedback:",((n=s.response)==null?void 0:n.data)||s.message),s}},createFeedback:async(e,t)=>{var n,s,o,a,l;try{console.log(" Creating feedback for user:",e),console.log(" Feedback data:",t);const d={...t,userId:e};console.log(" Sending payload:",d);const u=await te.post(`/Feedback/Create-By-User/${encodeURIComponent(e)}`,d);return console.log(" Feedback created:",u.data),((n=u.data)==null?void 0:n.data)||u.data||{}}catch(d){throw console.error(" Error creating feedback:",((s=d.response)==null?void 0:s.data)||d.message),console.error(" Full error response:",d.response),console.error(" Error status:",(o=d.response)==null?void 0:o.status),console.error(" Error details:",(l=(a=d.response)==null?void 0:a.data)==null?void 0:l.errors),d}},updateFeedback:async(e,t,n)=>{var s,o;try{console.log(" Updating feedback:",e),console.log(" Updated data:",t);const a=await te.put(`/Feedback/Update-By-${encodeURIComponent(e)}`,t,{params:n?{userId:n}:{}});return console.log(" Feedback updated:",a.data),((s=a.data)==null?void 0:s.data)||a.data||{}}catch(a){throw console.error(" Error updating feedback:",((o=a.response)==null?void 0:o.data)||a.message),a}},deleteFeedback:async(e,t)=>{var n,s;try{console.log(" Deleting feedback:",e);const o=await te.delete(`/Feedback/Delete-By-${encodeURIComponent(e)}`,{params:t?{userId:t}:{}});return console.log(" Feedback deleted:",o.data),((n=o.data)==null?void 0:n.data)||o.data||{}}catch(o){throw console.error(" Error deleting feedback:",((s=o.response)==null?void 0:s.data)||o.message),o}},getFeedbackSummaryByCar:async e=>{var t,n;try{console.log(" Fetching feedback summary for car:",e);const s=await te.get(`/Feedback/Get-Summary-By-Car/${encodeURIComponent(e)}`);return console.log(" Feedback summary fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||{}}catch(s){throw console.error(" Error fetching feedback summary:",((n=s.response)==null?void 0:n.data)||s.message),s}},getAverageRatingByCar:async e=>{var t,n;try{console.log(" Fetching average rating for car:",e);const s=await te.get(`/Feedback/Get-Average-Rating-By-Car/${encodeURIComponent(e)}`);return console.log(" Average rating fetched:",s.data),((t=s.data)==null?void 0:t.data)||s.data||0}catch(s){throw console.error(" Error fetching average rating:",((n=s.response)==null?void 0:n.data)||s.message),s}}};function gS({isOpen:e,selectedBooking:t,feedbackData:n,setFeedbackData:s,isEditingFeedback:o,currentFeedbackId:a,onClose:l,onSubmitSuccess:d}){const[u,f]=_.useState(!1),[m,g]=_.useState(!1);_.useEffect(()=>{console.log(" FeedbackModal useEffect triggered:",{isOpen:e,feedbackId:t==null?void 0:t.feedbackId,hasComment:!!(n!=null&&n.comment),feedbackData:n}),e&&(t!=null&&t.feedbackId)&&(n!=null&&n.comment)?(console.log(" Entering VIEW mode - showing existing feedback"),f(!0)):e&&(console.log(" Entering EDIT mode - creating/editing feedback"),f(!1))},[e,t==null?void 0:t.feedbackId]);const y=()=>{f(!1)},k=async()=>{var v,x,C;try{const j=localStorage.getItem("userId");if(!j){alert("User ID not found. Please login again.");return}if(!n.carId){alert("Car ID not found for this booking.");return}if(!n.comment.trim()){alert("Please enter your feedback comment.");return}g(!0),console.log(" Submitting feedback:",n),o&&a?(await zd.updateFeedback(a,n,j),alert("Feedback updated successfully!")):(await zd.createFeedback(j,n),alert("Feedback submitted successfully!")),s({bookingId:"",carId:"",rating:5,comment:""}),f(!1),l(),d()}catch(j){console.error(" Error submitting feedback:",j);const w=((C=(x=(v=j.response)==null?void 0:v.data)==null?void 0:x.errors)==null?void 0:C[0])||"Failed to submit feedback. Please try again.";alert(w)}finally{g(!1)}};return e?r.jsx("div",{className:"modal-overlay",onClick:l,children:r.jsxs("div",{className:"modal-content",onClick:v=>v.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:u?"Your Feedback":"We want your opinion!"}),r.jsx("button",{className:"modal-close",onClick:l,children:""})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"feedback-form",children:[r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:["Car: ",(t==null?void 0:t.carInfo)||"N/A"]})}),u?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Your Rating"}),r.jsxs("div",{className:"rating-display",children:[r.jsx("div",{className:"stars-display",children:[1,2,3,4,5].map(v=>r.jsx("i",{className:`fas fa-star ${n.rating>=v?"active":"inactive"}`,style:{color:n.rating>=v?"#ffc107":"#ddd"}},v))}),r.jsxs("span",{className:"rating-text",children:[n.rating," / 5"]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Your Comment"}),r.jsx("div",{className:"comment-display",children:r.jsx("p",{children:n.comment})})]}),r.jsxs("div",{className:"feedback-meta",children:[r.jsxs("small",{children:["Created: ",(t==null?void 0:t.feedbackCreatedDate)||"N/A"]}),(t==null?void 0:t.feedbackUpdatedDate)&&t.feedbackUpdatedDate!==t.feedbackCreatedDate&&r.jsxs("small",{children:["Updated: ",t.feedbackUpdatedDate]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Close"}),r.jsxs("button",{className:"btn btn-continue",onClick:y,children:[r.jsx("i",{className:"fas fa-edit"})," Edit Feedback"]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"rating",children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[[1,2,3,4,5].map(v=>r.jsx("button",{type:"button",className:`star-btn ${n.rating>=v?"active":""}`,onClick:()=>s({...n,rating:v}),children:r.jsx("i",{className:`fas fa-star ${n.rating>=v?"":"far"}`})},v)),r.jsxs("span",{className:"rating-text",children:[n.rating," / 5"]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"comment",children:"Comment"}),r.jsx("textarea",{id:"comment",rows:"5",value:n.comment,onChange:v=>s({...n,comment:v.target.value}),placeholder:"Share your experience with this car..."})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancel"}),r.jsx("button",{className:"btn btn-continue",onClick:k,disabled:m,children:m?"Processing...":o?"Update":"Continue"})]})]})]})})]})}):null}function yS(){const e=rn(),[t,n]=_.useState([]),[s,o]=_.useState([]),[a,l]=_.useState(!0),[d,u]=_.useState(""),[f,m]=_.useState({}),[g,y]=_.useState(""),[k,v]=_.useState("newest"),[x,C]=_.useState(null),[j,w]=_.useState(!1),[N,b]=_.useState(!1),[T,I]=_.useState({bookingId:"",carId:"",rating:5,comment:""}),[R,B]=_.useState(!1),[A,E]=_.useState(null),[M,G]=_.useState({isOpen:!1,type:"info",title:"",message:""}),[Y,z]=_.useState(!1),X=()=>{b(!1),I({bookingId:"",carId:"",rating:5,comment:""}),B(!1),E(null)},K=_.useCallback(async()=>{try{l(!0),u("");const O=localStorage.getItem("token");if(!O||O==="null"){console.warn("No auth token found in localStorage"),n([]),u("You are not signed in. Please sign in to view your bookings.");return}const ne=await Xt.getUserBookings();console.log(" Bookings loaded - count:",ne==null?void 0:ne.length),console.log(" First booking sample:",ne==null?void 0:ne[0]),console.log(" All bookings:",ne);const q={};for(const we of ne||[]){const Le=we.carId||we.CarId;if(Le)try{const Ne=await Qe.getCarById(Le),Se=(Ne==null?void 0:Ne.imageUrl)||(Ne==null?void 0:Ne.ImageUrl)||"/Picture/E car 1.jpg";q[Le]=Se,console.log(" Loaded image for car",Le,":",Se)}catch(Ne){console.warn(" Failed to load car image for",Le,":",Ne.message),q[Le]="/Picture/E car 1.jpg"}}m(q),n(ne||[])}catch(O){if(console.error("Error loading bookings:",O),O&&O.response&&O.response.status===401){u("Session expired or unauthorized. Please sign in again."),n([]);return}u("Failed to load bookings. Please try again later.")}finally{l(!1)}},[]),F=_.useCallback(()=>{K()},[K]),$=_.useCallback(()=>{let O=[...t];g&&(O=O.filter(ne=>String(ne.bookingStatus)===g)),O.sort((ne,q)=>{switch(k){case"oldest":return new Date(ne.createdAt)-new Date(q.createdAt);case"price-high":return(q.totalAmount||0)-(ne.totalAmount||0);case"price-low":return(ne.totalAmount||0)-(q.totalAmount||0);default:return new Date(q.createdAt)-new Date(ne.createdAt)}}),o(O)},[t,g,k]);_.useEffect(()=>{K()},[K]),_.useEffect(()=>{t.length>0&&$()},[t,g,k]);const ge=O=>{const ne={0:{text:"Pending",class:"status-pending"},1:{text:"Active",class:"status-active"},2:{text:"Waiting for check-in",class:"status-waiting-check-in"},3:{text:"Checked-in",class:"status-checked-in"},4:{text:"Check-out pending",class:"status-check-out-pending"},5:{text:"Completed",class:"status-completed"},6:{text:"Cancelled pending refund",class:"status-cancelled-pending-refund"},7:{text:"Cancelled",class:"status-cancelled"}},q=Number(O);return Number.isNaN(q)||!(q in ne)?(console.warn(" Unknown booking status:",O,"type:",typeof O),ne[0]):ne[q]},re=O=>{if(!O)return"N/A";try{const ne=new Date(O);return isNaN(ne.getTime())?O:ne.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return O}},fe=async(O,ne)=>{ne&&(ne.preventDefault(),ne.stopPropagation());const q=O.id||O.bookingId||O.bookingIdString;if(!q){alert("Cannot cancel: Booking ID not found");return}if(Number(O.bookingStatus)===7){alert("This booking has already been cancelled.");return}if(window.confirm(`Are you sure you want to cancel booking for "${O.carInfo||"this car"}"?`))try{const Le=localStorage.getItem("userId");if(!Le){alert("User ID not found. Please login again.");return}console.log(" Cancelling booking:",q,"for user:",Le),await Xt.cancelBooking(q,Le),alert("Booking cancelled successfully!"),K()}catch(Le){console.error(" Error cancelling booking:",Le),alert("Failed to cancel booking. Please try again.")}},_e=async(O,ne)=>{var we,Le,Ne,Se,ze;ne&&(ne.preventDefault(),ne.stopPropagation());const q=O.id||O.bookingId||O.bookingIdString;if(!q){alert("Booking ID not found");return}z(!0);try{console.log(" Creating deposit payment for booking:",q);const pe=await Lr.createPayment(q),nt=pe.checkoutUrl||((we=pe.data)==null?void 0:we.checkoutUrl);if(!nt)throw new Error("No checkout URL received");localStorage.setItem("currentBookingId",q),console.log(" Redirecting to PayOS:",nt),window.location.href=nt}catch(pe){console.error(" Error initiating payment:",pe);let nt=((Ne=(Le=pe.response)==null?void 0:Le.data)==null?void 0:Ne.message)||pe.message||"Failed to initiate payment";(((ze=(Se=pe.response)==null?void 0:Se.data)==null?void 0:ze.errors)||[]).some(he=>typeof he=="string"&&he.toLowerCase().includes("contract"))?(nt="Contract not found or not confirmed for this booking",G({isOpen:!0,type:"error",title:" Contract Required",message:"Please wait for the contract to be confirmed. Check your email for the contract document and ensure it has been processed."})):G({isOpen:!0,type:"error",title:"Payment Error",message:nt})}finally{z(!1)}},se=(O,ne)=>{var Le,Ne;if(ne&&(ne.preventDefault(),ne.stopPropagation()),N){console.log(" Modal already open, ignoring click");return}console.log(" Opening feedback modal for booking:",O);const q=O.id||O.bookingId||O.bookingIdString||"",we=O.carId||((Le=O.car)==null?void 0:Le.id)||((Ne=O.car)==null?void 0:Ne.carId)||"";if(!q){alert("Cannot create feedback: Booking ID not found.");return}if(!we){alert("Cannot create feedback: Car ID not found in booking data. Please contact support.");return}console.log(" Attempting to fetch existing feedback for booking:",q),zd.getFeedbackByBookingId(q).then(Se=>{if(console.log(" Raw feedback response:",Se),console.log(" Feedback rating:",Se==null?void 0:Se.rating),console.log(" Feedback comment:",Se==null?void 0:Se.comment),!Se||!Se.comment||Se.comment.trim()===""){console.log(" No existing feedback found - entering CREATE mode"),B(!1),E(null),I({bookingId:q,carId:we,rating:5,comment:""}),C(O),b(!0);return}console.log(" Valid feedback found - entering VIEW/EDIT mode"),B(!0),E(Se.feedbackId||Se.id),I({bookingId:q,carId:we,rating:Se.rating||5,comment:Se.comment||""});const ze={...O,feedbackId:Se.feedbackId||Se.id,feedbackCreatedDate:Se.createdAt,feedbackUpdatedDate:Se.updatedAt};console.log(" Setting booking with feedback:",ze),C(ze),b(!0)}).catch(Se=>{var ze;console.error(" Error fetching feedback:",((ze=Se.response)==null?void 0:ze.data)||Se.message),B(!1),E(null),I({bookingId:q,carId:we,rating:5,comment:""}),C(O),b(!0)})};return r.jsxs("main",{className:"main-content",children:[r.jsxs("div",{className:"container",children:[r.jsxs("div",{className:"page-header",children:[r.jsx("i",{className:"fas fa-history"}),r.jsxs("div",{className:"page-header-text",children:[r.jsx("h1",{children:"Booking History"}),r.jsx("p",{style:{color:"white"},children:"Manage all your car rentals"})]})]}),r.jsxs("div",{className:"filters-section",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Status:"}),r.jsxs("select",{value:g,onChange:O=>y(O.target.value),children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"0",children:"Pending"}),r.jsx("option",{value:"1",children:"Active"}),r.jsx("option",{value:"2",children:"Waiting for check-in"}),r.jsx("option",{value:"3",children:"Checked-in"}),r.jsx("option",{value:"4",children:"Checked-out pending"}),r.jsx("option",{value:"5",children:"Completed"}),r.jsx("option",{value:"6",children:"Cancelled pending refund"}),r.jsx("option",{value:"7",children:"Cancelled"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Sort By:"}),r.jsxs("select",{value:k,onChange:O=>v(O.target.value),children:[r.jsx("option",{value:"newest",children:"Newest"}),r.jsx("option",{value:"oldest",children:"Oldest"}),r.jsx("option",{value:"price-high",children:"Price (High to Low)"}),r.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),r.jsxs("button",{className:"btn-refresh",onClick:K,children:[r.jsx("i",{className:"fas fa-sync"})," Refresh"]})]}),a&&r.jsxs("div",{className:"loading",children:[r.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading..."]}),!a&&s.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("i",{className:"fas fa-inbox"}),r.jsx("h2",{children:"No Bookings Yet"}),r.jsx("p",{children:"Start booking a car to find your perfect ride"}),r.jsxs("button",{className:"btn btn-primary",onClick:()=>e("/cars"),children:[r.jsx("i",{className:"fas fa-car"})," View Cars"]})]}),!a&&s.length>0&&r.jsx("div",{className:"bookings-list",children:s.map((O,ne)=>{var nt,sn,he,oe,le,ye;const q=ge(O.bookingStatus),we=re(O.startTime||O.StartTime||O.pickupDateTime||O.PickupDateTime),Le=re(O.endTime||O.EndTime||O.expectedReturnDateTime||O.ExpectedReturnDateTime),Ne=O.carInfo||O.CarInfo||((nt=O.car)!=null&&nt.brand&&((sn=O.car)!=null&&sn.model)?`${O.car.brand} ${O.car.model}`:null)||((he=O.Car)!=null&&he.Brand&&((oe=O.Car)!=null&&oe.Model)?`${O.Car.Brand} ${O.Car.Model}`:null)||"Car Rental",Se=O.pickupStationName||O.PickupStationName||O.stationName||O.StationName||((le=O.station)==null?void 0:le.name)||((ye=O.Station)==null?void 0:ye.Name)||"N/A",ze=O.carId||O.CarId,pe=f[ze]||"/Picture/E car 1.jpg";return O.id||O.bookingId||O.bookingIdString,ne===0&&(console.log(" First booking car image sources:"),console.log("   - carId:",ze),console.log("   - carImagesCache[carId]:",f[ze]),console.log("   - Final carImage:",pe),console.log("   - Full booking object:",O)),r.jsxs("div",{className:`booking-card-shopee ${q.class}`,children:[r.jsx("div",{className:"booking-card-header",children:r.jsx("span",{className:`status-badge ${q.class}`,children:q.text})}),r.jsxs("div",{className:"booking-card-body",children:[r.jsx("div",{className:"car-image-container",children:r.jsx("img",{src:pe,alt:Ne,onError:de=>de.currentTarget.src="/Picture/E car 1.jpg"})}),r.jsxs("div",{className:"booking-details",children:[r.jsx("h3",{className:"car-name",children:Ne}),r.jsxs("div",{className:"booking-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-map-marker-alt"}),"Pick-up Location"]}),r.jsx("div",{className:"info-value",children:Se})]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-calendar-alt"}),"Start Date & Time"]}),r.jsx("div",{className:"info-value",children:we})]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("div",{className:"info-label",children:[r.jsx("i",{className:"fas fa-calendar-check"}),"End Date & Time"]}),r.jsx("div",{className:"info-value",children:Le})]})]})]})]}),r.jsxs("div",{className:"booking-card-footer",children:[r.jsxs("div",{className:"total-price",children:[r.jsx("span",{className:"price-label",children:"Total Amount:"}),r.jsx("span",{className:"price-value",children:Yt(O.totalAmount||O.TotalAmount||0)})]}),r.jsxs("div",{className:"booking-actions",children:[Number(O.bookingStatus)===0&&r.jsxs("button",{className:"btn btn-deposit",onClick:de=>_e(O,de),disabled:Y,type:"button",children:[r.jsx("i",{className:"fas fa-wallet"})," ",Y?"Processing...":"Pay Deposit"]}),Number(O.bookingStatus)===5&&r.jsxs("button",{className:"btn btn-feedback",onClick:de=>se(O,de),type:"button",children:[r.jsx("i",{className:"fas fa-comment"})," ",O.feedbackId?"Edit Feedback":"Feedback"]}),r.jsxs("button",{className:"btn btn-cancel",onClick:de=>fe(O,de),disabled:Number(O.bookingStatus)===7,title:Number(O.bookingStatus)===7?"Already cancelled":"Cancel booking",type:"button",children:[r.jsx("i",{className:"fas fa-times-circle"})," Cancel Booking"]})]})]})]},ne)})})]}),j&&x&&r.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),children:r.jsxs("div",{className:"modal-content",onClick:O=>O.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:"Booking Details"}),r.jsx("button",{className:"modal-close",onClick:()=>w(!1),children:""})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"detail-section car-section",children:[r.jsx("div",{className:"section-icon",children:""}),r.jsxs("div",{className:"section-content",children:[r.jsx("h3",{children:x.carInfo||"Car Rental"}),r.jsx("div",{className:"status-row",children:r.jsx("span",{className:`status-badge ${ge(x.bookingStatus).class}`,children:ge(x.bookingStatus).text})})]})]}),r.jsxs("div",{className:"detail-section datetime-section",children:[r.jsxs("div",{className:"datetime-card pickup",children:[r.jsx("div",{className:"datetime-icon",children:""}),r.jsxs("div",{className:"datetime-info",children:[r.jsx("label",{children:"Pick-up"}),r.jsx("p",{className:"location",children:x.pickupStationName||"N/A"}),r.jsx("p",{className:"time",children:re(x.startTime||x.pickupDateTime)})]})]}),r.jsx("div",{className:"datetime-arrow",children:""}),r.jsxs("div",{className:"datetime-card return",children:[r.jsx("div",{className:"datetime-icon",children:""}),r.jsxs("div",{className:"datetime-info",children:[r.jsx("label",{children:"Return"}),r.jsx("p",{className:"location",children:x.returnStationName||"N/A"}),r.jsx("p",{className:"time",children:re(x.endTime||x.expectedReturnDateTime)})]})]})]}),r.jsx("div",{className:"detail-section pricing-section",children:r.jsxs("div",{className:"pricing-grid",children:[r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Hourly Rate"}),r.jsxs("p",{children:[Yt(x.hourlyRate||0),"/hour"]})]})]}),r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Daily Rate"}),r.jsxs("p",{children:[Yt(x.dailyRate||0),"/day"]})]})]}),r.jsxs("div",{className:"pricing-item",children:[r.jsx("span",{className:"pricing-icon",children:""}),r.jsxs("div",{children:[r.jsx("label",{children:"Created At"}),r.jsx("p",{children:re(x.createdAt)})]})]})]})}),r.jsx("div",{className:"detail-section total-section",children:r.jsxs("div",{className:"total-content",children:[r.jsx("span",{className:"total-label",children:"Total Amount"}),r.jsx("span",{className:"total-amount",children:Yt(x.totalAmount||0)})]})})]})]})}),r.jsx(gS,{isOpen:N,selectedBooking:x,feedbackData:T,setFeedbackData:I,isEditingFeedback:R,currentFeedbackId:A,onClose:X,onSubmitSuccess:F}),r.jsx(Ur,{isOpen:M.isOpen,type:M.type,title:M.title,message:M.message,onClose:()=>G({...M,isOpen:!1})})]})}function xS({toggleSidebar:e,sidebarVisible:t}){return r.jsxs("header",{className:"header-bar",children:[r.jsx("div",{className:"header-left",children:r.jsx("button",{className:"sidebar-toggle","aria-label":t?"Close sidebar":"Open sidebar",onClick:e,children:r.jsx("i",{className:t?"fas fa-times":"fas fa-bars"})})}),r.jsx("div",{className:"header-title",children:"Staff Page"}),r.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}function by({title:e="Menu",menuItems:t=[],isOpen:n=!1,toggleSidebar:s,onSelect:o,activeKey:a}){const l=rn();_.useEffect(()=>{n?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[n]);function d(u){try{typeof u.onClick=="function"?u.onClick():u.to&&l(u.to)}catch(f){console.warn("Sidebar navigation error",f)}typeof o=="function"&&o(u.key)}return r.jsxs(r.Fragment,{children:[n&&r.jsx("div",{className:"sidebar-collider",onClick:s}),r.jsxs("div",{className:`sidebar ${n?"active":""}`,children:[r.jsx("h2",{children:e}),r.jsx("div",{style:{marginTop:"60px"}}),Array.isArray(t)&&t.map(u=>r.jsxs("button",{className:a===u.key?"sidebar-item active":"sidebar-item",onClick:()=>d(u),children:[u.icon&&r.jsx("i",{className:u.icon,"aria-hidden":!0}),r.jsx("span",{style:{marginLeft:u.icon?8:0},children:u.label})]},u.key))]})]})}const Iy=()=>'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2"><path d="M3 9l1-3h16l1 3M3 9v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9M3 9h18M7 13a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/></svg>',Yu=e=>{e&&(e.style.objectFit="contain",e.style.backgroundColor="#f0f0f0",e.src=Iy())},Ku=e=>!e||typeof e=="string"&&e.trim()===""?Iy():e;function vS({booking:e,onClick:t}){const[n,s]=_.useState(null);_.useEffect(()=>{(async()=>{try{const m=e.carId||e.CarId;if(console.log(" BookingCard - Attempting to load image for booking:",e.id,"carId:",m),!m){console.warn(" BookingCard - No carId found in booking:",e);return}const g=await Qe.getCarById(m),y=(g==null?void 0:g.imageUrl)||(g==null?void 0:g.ImageUrl)||"/Picture/E car 1.jpg";s(y),console.log(" BookingCard - Loaded car image:",y)}catch(m){console.warn(" BookingCard - Failed to load car image:",m.message)}})()},[e.carId,e.CarId,e.id]);const a=(f=>{if(!f)return"UNKNOWN";if(typeof f=="string")return f.toLowerCase();if(typeof f=="number")switch(f){case 0:return"pending";case 1:return"booked";case 2:return"waiting-checkin";case 3:return"checked-in";case 4:return"checkout-pending";case 5:return"completed";default:return"unknown"}return"unknown"})(e.status);let l="booking-status-chip ";a==="booked"?l+="booking-status-booked":a==="pending"?l+="booking-status-pending":a==="waiting-checkin"?l+="booking-status-waiting-checkin":a==="checked-in"||a==="checkedin"?l+="booking-status-checkedin":a==="checkout-pending"?l+="booking-status-checkout-pending":a==="completed"?l+="booking-status-completed":a==="cancelled-pending"?l+="booking-status-cancelled-pending":a==="cancelled"?l+="booking-status-cancelled":a==="denied"?l+="booking-status-denied":l+="booking-status-unknown";const d=f=>{Yu(f.currentTarget)},u=n||e.img||Ku(e.img);return r.jsxs("div",{className:"booking-card",onClick:t,children:[r.jsx("img",{src:u,alt:e.title,onError:d}),r.jsxs("div",{className:"booking-info",children:[r.jsx("div",{className:"booking-title",children:e.title}),r.jsxs("div",{className:"booking-customer",children:["Customer: ",e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||""]})]}),(()=>{const f=e.statusLabel||a.toUpperCase();return r.jsx("div",{className:l,children:f})})()]})}const Pn={createIncident:async(e,t,n=[])=>{var l;if(!e||!t)throw new Error("bookingId and description are required");const s=new FormData;if(s.append("bookingId",e),s.append("description",t),n&&n.length)for(const d of n)s.append("images",d);const o=["/Incidents/Create","/incidents/Create","/Incidents/CreateIncident"];let a=null;for(const d of o)try{const u=await te.post(d,s,{headers:{"Content-Type":"multipart/form-data"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const m=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(m);throw g.body=f,g}return f.data}return f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Create incident endpoint not found")},getIncidentsByBooking:async(e,t=1,n=20)=>{var a;if(!e)return[];const s=encodeURIComponent(e),o=[{url:`/Incidents/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/Incident/GetByBooking/${s}`,opts:{params:{page:t,pageSize:n}}},{url:`/incidents/get-by-booking/${s}`,opts:{params:{page:t,pageSize:n}}}];for(const l of o)try{const d=await te.get(l.url,l.opts),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;if(!f)continue;return Array.isArray(f)?f:Array.isArray(f==null?void 0:f.items)?f.items:Array.isArray(f==null?void 0:f.data)?f.data:Array.isArray(f==null?void 0:f.incidents)?f.incidents:Array.isArray(f)?f:[]}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)return[]}return[]},getMyIncidents:async()=>{var t;const e=["/Incidents/My-Incidents","/Incidents/My","/Incidents/Get-My"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data,a=o&&typeof o=="object"&&"data"in o?o.data:o;if(!a)continue;return Array.isArray(a)?a:Array.isArray(a==null?void 0:a.items)?a.items:Array.isArray(a==null?void 0:a.data)?a.data:Array.isArray(a)?a:[]}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)return[]}return[]},getAllIncidents:async(e=null,t=null,n=null,s=null,o=1,a=100)=>{try{const l={};e&&(l.stationId=e),t&&(l.status=t),n&&(l.dateFrom=n),s&&(l.dateTo=s),l.page=o,l.pageSize=a;const d=await te.get("/Incidents/Get-All",{params:l}),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;if(!f)return{incidents:[],totalCount:0,page:o,pageSize:a};if(Array.isArray(f))return{incidents:f,totalCount:f.length,page:o,pageSize:a};const m=f.incidents||f.items||f.data||[],g=f.totalCount||f.total||(Array.isArray(m)?m.length:0);return{incidents:Array.isArray(m)?m:[],totalCount:g||0,page:f.page||o,pageSize:f.pageSize||a}}catch{return{incidents:[],totalCount:0,page:o,pageSize:a}}},getIncidentById:async e=>{var s;if(!e)return null;const t=encodeURIComponent(e),n=[`/Incidents/Get-By-${t}`,`/Incidents/Get-By-Id/${t}`,`/Incidents/${t}`,`/incident/${t}`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(!d)continue;return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},updateIncident:async(e,t)=>{var a;if(!e)throw new Error("incidentId is required");const n=encodeURIComponent(e),s=[`/Incidents/Update-By-${n}`,`/Incidents/Update-By-Id/${n}`,`/Incidents/Update/${n}`,`/Incidents/${n}`];let o=null;for(const l of s)try{const d=await te.put(l,t,{headers:{"Content-Type":"multipart/form-data"}}),u=d==null?void 0:d.data;return(u&&typeof u=="object"&&"data"in u?u.data:u)||u}catch(d){o=d;const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw o||new Error("Update incident endpoint not found")},resolveIncident:async(e,t="",n=0)=>{var l;if(!e)throw new Error("incidentId is required");const s=encodeURIComponent(e),o=[`/Incidents/Resolve-By-${s}`,`/Incidents/Resolve-By-Id/${s}`,`/Incidents/Resolve/${s}`];let a=null;for(const d of o)try{const u=await te.patch(d,{resolutionNotes:t,costIncurred:n}),f=u==null?void 0:u.data;return f&&typeof f=="object"&&"data"in f?f.data:f}catch(u){a=u;const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}throw a||new Error("Resolve incident endpoint not found")},deleteIncident:async e=>{var o;if(!e)throw new Error("incidentId is required");const t=encodeURIComponent(e),n=[`/Incidents/Delete-By-${t}`,`/Incidents/Delete-By-Id/${t}`,`/Incidents/Delete/${t}`,`/Incidents/${t}`];let s=null;for(const a of n)try{const l=await te.delete(a),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(l){s=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}throw s||new Error("Delete incident endpoint not found")}},We={confirmBooking:Xt.confirmBooking,cancelBooking:Xt.cancelBooking,completeBooking:Xt.completeBooking,getBookingById:Xt.getBookingById,createIncident:Pn.createIncident,getIncidentsByBooking:Pn.getIncidentsByBooking,getMyIncidents:Pn.getMyIncidents,getAllIncidents:Pn.getAllIncidents,getIncidentById:Pn.getIncidentById,updateIncident:Pn.updateIncident,resolveIncident:Pn.resolveIncident,deleteIncident:Pn.deleteIncident,post:(e,t={})=>te.post(e,t).then(n=>n.data),get:(e,t={})=>te.get(e,t).then(n=>n.data),put:(e,t={})=>te.put(e,t).then(n=>n.data),patch:(e,t={})=>te.patch(e,t).then(n=>n.data),delete:e=>te.delete(e).then(t=>t.data),createCar:Qe.createCar,deleteCar:Qe.deleteCar,updateCar:Qe.updateCar,updateStatus:Qe.updateStatus,updateBatteryLevel:Qe.updateBatteryLevel,updateCarDescription:Qe.updateCarDescription,getCarsByStation:async e=>{var t;try{const n=await te.get(`/Cars/Get-Available-By-Station/${encodeURIComponent(e)}`),s=n==null?void 0:n.data;return Array.isArray(s)?s:s!=null&&s.data&&Array.isArray(s.data)?s.data:(t=s==null?void 0:s.data)!=null&&t.data&&Array.isArray(s.data.data)?s.data.data:s!=null&&s.items&&Array.isArray(s.items)?s.items:(console.warn(" No cars found in response for station:",e),[])}catch(n){return console.warn(" getCarsByStation error (endpoint may not exist):",n.message),[]}},checkInWithContract:async e=>{var t,n;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");try{const s=new FormData;s.append("BookingId",e.bookingId),s.append("StaffId",e.staffId),e.checkInNotes&&s.append("CheckInNotes",e.checkInNotes),e.checkInPhotoFile&&e.checkInPhotoFile instanceof File?s.append("CheckInPhoto",e.checkInPhotoFile,e.checkInPhotoFile.name):s.append("CheckInPhoto","");const o=(()=>{try{return localStorage.getItem("token")}catch{return null}})(),a={};o&&o!=="null"&&(a.Authorization=`Bearer ${o}`);const l=await xt.post(`${Di}/Bookings/Check-In-With-Contract`,s,{headers:a}),d=l==null?void 0:l.data;return d&&typeof d=="object"&&"data"in d?d.data:d}catch(s){throw console.error(" checkInWithContract failed:",(t=s==null?void 0:s.response)==null?void 0:t.status,((n=s==null?void 0:s.response)==null?void 0:n.data)||(s==null?void 0:s.message)),s}},checkOutWithPayment:async e=>{var s,o;if(!e||!e.bookingId||!e.staffId)throw new Error("Missing required fields: bookingId, staffId");const t=["/Bookings/Check-Out-With-Payment","/Bookings/CheckOutWithPayment","/bookings/check-out-with-payment"];let n;for(const a of t){if(e.checkOutPhotoFile&&e.checkOutPhotoFile instanceof File)try{const l=new FormData;l.append("bookingId",e.bookingId),l.append("staffId",e.staffId),e.actualReturnDateTime&&l.append("actualReturnDateTime",e.actualReturnDateTime),e.damageFee!==void 0&&e.damageFee!==null&&l.append("damageFee",String(e.damageFee)),e.checkOutNotes&&l.append("checkOutNotes",e.checkOutNotes),e.checkOutPhotoUrl&&!e.checkOutPhotoUrl.startsWith("blob:")&&l.append("checkOutPhotoUrl",e.checkOutPhotoUrl),l.append("checkOutPhotoFile",e.checkOutPhotoFile);const d=await te.post(a,l,{headers:{"Content-Type":"multipart/form-data"}}),u=d==null?void 0:d.data;if(u&&typeof u=="object"&&"data"in u){if(u.isSuccess===!1){const f=u.message||(Array.isArray(u.errors)?u.errors.join("; "):"Request failed"),m=new Error(f);throw m.body=u,m}return u.data}return u}catch(l){n=l;const d=(s=l==null?void 0:l.response)==null?void 0:s.status;if(d&&d!==404&&d!==405)throw l}try{const{checkOutPhotoFile:l,...d}=e,u=await te.post(a,d,{headers:{"Content-Type":"application/json"}}),f=u==null?void 0:u.data;if(f&&typeof f=="object"&&"data"in f){if(f.isSuccess===!1){const m=f.message||(Array.isArray(f.errors)?f.errors.join("; "):"Request failed"),g=new Error(m);throw g.body=f,g}return f.data}return f}catch(l){n=l;const d=(o=l==null?void 0:l.response)==null?void 0:o.status;if(d&&d!==404&&d!==405)throw l}}throw n||new Error("Check-Out-With-Payment endpoint not found")},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await We.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},getAllStations:async(e=1,t=100)=>{var n;try{const s=await te.get("/Stations/Get-All",{params:{pageNumber:e,pageSize:t}}),o=s==null?void 0:s.data;return Array.isArray(o)?o:o!=null&&o.data&&Array.isArray(o.data)?o.data:(n=o==null?void 0:o.data)!=null&&n.data&&Array.isArray(o.data.data)?o.data.data:o!=null&&o.items&&Array.isArray(o.items)?o.items:(console.warn(" No stations found in response"),[])}catch(s){return console.warn(" getAllStations error:",s.message),[]}},getBookingsByStation:async(e,t=1,n=100)=>{var o;if(!e)throw new Error("stationId is required");const s=encodeURIComponent(e);try{const a=await te.get(`/Bookings/By-Station/${s}`,{params:{pageNumber:t,pageSize:n}}),l=a==null?void 0:a.data;return Array.isArray(l)?l:l!=null&&l.data&&Array.isArray(l.data)?l.data:(o=l==null?void 0:l.data)!=null&&o.data&&Array.isArray(l.data.data)?l.data.data:l!=null&&l.items&&Array.isArray(l.items)?l.items:(console.warn(" No bookings found in response for station:",e),[])}catch(a){return console.warn(" getBookingsByStation error:",a.message),[]}},getAvailableCarsByStation:async e=>{var n;if(!e)return[];const t=encodeURIComponent(e);try{const s=await te.get(`/Cars/Get-Available-By-Station/${t}`),o=s==null?void 0:s.data;return Array.isArray(o)?o:o!=null&&o.data&&Array.isArray(o.data)?o.data:(n=o==null?void 0:o.data)!=null&&n.data&&Array.isArray(o.data.data)?o.data.data:o!=null&&o.items&&Array.isArray(o.items)?o.items:(console.warn(" No available cars found for station:",e),[])}catch(s){return console.warn(" getAvailableCarsByStation error:",s.message),[]}}};function Ly({booking:e={},onClose:t=()=>{},actions:n=null,children:s}){return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,borderBottom:"1px solid #eee"},children:[r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:(e==null?void 0:e.title)||(e==null?void 0:e.carName)||"Booking"}),r.jsx("div",{style:{color:"#666"},children:(e==null?void 0:e.statusLabel)||(e==null?void 0:e.status)})]}),r.jsxs("div",{children:[n,r.jsx("button",{onClick:t,style:{marginLeft:8,padding:"6px 10px",borderRadius:6},children:"Close"})]})]}),r.jsx("div",{style:{padding:16},children:s}),r.jsx("div",{style:{padding:12,borderTop:"1px solid #eee",textAlign:"right"},children:n})]})}function _S(e){if(e==null)return null;if(typeof e=="number")switch(e){case 1:return"booked";case 2:return"waiting_payment";case 3:return"checked-in";case 4:return"completed";case 0:return"cancelled";default:return String(e)}const t=String(e).toLowerCase();return t==="1"?"booked":t==="2"?"waiting_payment":t==="3"?"checked-in":t==="4"?"completed":t==="0"||t.includes("cancel")?"cancelled":t.includes("book")?"booked":t.includes("wait")?"waiting_payment":t.includes("check")?"checked-in":t.includes("complete")?"completed":t}function Py(e){if(!e&&e!==0)return"";const t=new Date(e);return isNaN(t)?String(e):t.toLocaleString()}function wS({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:o}){var se,O;const[a,l]=_.useState(!1),[d,u]=_.useState(!1),[f,m]=_.useState(!1),[g,y]=_.useState(!1),[k,v]=_.useState(""),[x,C]=_.useState(!1),[j,w]=_.useState(!1),[N,b]=_.useState(null),[T,I]=_.useState(!1),[R,B]=_.useState(null),[A,E]=_.useState(""),[M,G]=_.useState(""),[Y,z]=_.useState(null),[X,K]=_.useState(""),[F,$]=_.useState(null),[ge,re]=_.useState(!1);if(_.useEffect(()=>{if(!e)return;l(!1),u(!1),m(!1),y(!1),v(""),$(null),z(null);const ne=e.carId||e.CarId;ne&&Qe.getCarById(ne).then(pe=>{const nt=(pe==null?void 0:pe.imageUrl)||(pe==null?void 0:pe.ImageUrl)||"/Picture/E car 1.jpg";z(nt),console.log(" Loaded car image:",nt)}).catch(pe=>{console.warn(" Failed to load car image:",pe.message),z("/Picture/E car 1.jpg")});const q=(pe,nt)=>[pe,nt].filter(Boolean).join(" "),we=e.fullName||q(e.firstName,e.lastName);if(!we||/^customer$/i.test(we)||we===""||v(we),!e.id)return;let Ne=!1;async function Se(){C(!0);try{const{firstName:pe,lastName:nt}=await We.getUserNameByBookingId(e.id);Ne||v(q(pe,nt))}catch{}finally{Ne||C(!1)}}async function ze(){if(!e.userId){console.warn(" No userId in booking");return}re(!0);try{console.log(" Fetching user details for userId:",e.userId);const pe=await yt.getUserById(e.userId);Ne||($(pe),console.log(" Fetched user details:",pe),console.log(" CCCD Images:",{cccdFrontUrl:pe==null?void 0:pe.cccdFrontUrl,identityFrontUrl:pe==null?void 0:pe.identityFrontUrl,idFrontUrl:pe==null?void 0:pe.idFrontUrl,cccdImageUrl_Front:pe==null?void 0:pe.cccdImageUrl_Front,cccdBackUrl:pe==null?void 0:pe.cccdBackUrl,identityBackUrl:pe==null?void 0:pe.identityBackUrl,idBackUrl:pe==null?void 0:pe.idBackUrl,cccdImageUrl_Back:pe==null?void 0:pe.cccdImageUrl_Back}),console.log(" GPLX Images:",{gplxFrontUrl:pe==null?void 0:pe.gplxFrontUrl,driverLicenseFrontUrl:pe==null?void 0:pe.driverLicenseFrontUrl,gplxImageUrl_Front:pe==null?void 0:pe.gplxImageUrl_Front,gplxBackUrl:pe==null?void 0:pe.gplxBackUrl,driverLicenseBackUrl:pe==null?void 0:pe.driverLicenseBackUrl,gplxImageUrl_Back:pe==null?void 0:pe.gplxImageUrl_Back}))}catch(pe){console.warn(" Failed to fetch user details:",(pe==null?void 0:pe.message)||pe),console.error("Full error:",pe),Ne||$(null)}finally{Ne||re(!1)}}return Se(),ze(),()=>{Ne=!0}},[e]),!e)return null;const fe=(e==null?void 0:e.status)==="booked"?a&&d&&f&&g:!1,_e=()=>{if(!e)return;const ne=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,ne)};return r.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:r.jsx("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:r.jsxs(Ly,{booking:e,onClose:t,actions:null,children:[r.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("img",{id:"modalImage",src:Y||"/Picture/E car 1.jpg",alt:"Vehicle",onError:ne=>ne.currentTarget.src="/Picture/E car 1.jpg",style:{width:"100%",height:160,borderRadius:8,objectFit:"cover",display:"block"}}),r.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),r.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),r.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((se=e.car)==null?void 0:se.name)||((O=e.car)==null?void 0:O.Name)||""]}),r.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(x?"Loading":"")]}),r.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",Py(e.date)]})]}),r.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Pickup Date:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"pickupDate",style:{fontWeight:600},children:e.pickupDate||e.startDate||e.date||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Return Date:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"returnDate",style:{fontWeight:600},children:e.returnDate||e.endDate||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:ge?"Loading...":(F==null?void 0:F.identityNumber)||(F==null?void 0:F.idNumber)||(F==null?void 0:F.cmnd)||e.idString||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Address:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:ge?"Loading...":(F==null?void 0:F.address)||e.address||""})})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["CCCD Images: ",ge&&"(Loading...)"]}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),F!=null&&F.cccdFrontUrl||F!=null&&F.identityFrontUrl||F!=null&&F.idFrontUrl||F!=null&&F.cccdImageUrl_Front||e.cccdFrontUrl?r.jsx("a",{href:(F==null?void 0:F.cccdFrontUrl)||(F==null?void 0:F.identityFrontUrl)||(F==null?void 0:F.idFrontUrl)||(F==null?void 0:F.cccdImageUrl_Front)||e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(F==null?void 0:F.cccdFrontUrl)||(F==null?void 0:F.identityFrontUrl)||(F==null?void 0:F.idFrontUrl)||(F==null?void 0:F.cccdImageUrl_Front)||e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:a,onChange:ne=>l(ne.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),F!=null&&F.cccdBackUrl||F!=null&&F.identityBackUrl||F!=null&&F.idBackUrl||F!=null&&F.cccdImageUrl_Back||e.cccdBackUrl?r.jsx("a",{href:(F==null?void 0:F.cccdBackUrl)||(F==null?void 0:F.identityBackUrl)||(F==null?void 0:F.idBackUrl)||(F==null?void 0:F.cccdImageUrl_Back)||e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(F==null?void 0:F.cccdBackUrl)||(F==null?void 0:F.identityBackUrl)||(F==null?void 0:F.idBackUrl)||(F==null?void 0:F.cccdImageUrl_Back)||e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:d,onChange:ne=>u(ne.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:["Driver License (GPLX) Images: ",ge&&"(Loading...)"]}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),F!=null&&F.gplxFrontUrl||F!=null&&F.driverLicenseFrontUrl||F!=null&&F.gplxImageUrl_Front||e.gplxFrontUrl?r.jsx("a",{href:(F==null?void 0:F.gplxFrontUrl)||(F==null?void 0:F.driverLicenseFrontUrl)||(F==null?void 0:F.gplxImageUrl_Front)||e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(F==null?void 0:F.gplxFrontUrl)||(F==null?void 0:F.driverLicenseFrontUrl)||(F==null?void 0:F.gplxImageUrl_Front)||e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:ne=>m(ne.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),F!=null&&F.gplxBackUrl||F!=null&&F.driverLicenseBackUrl||F!=null&&F.gplxImageUrl_Back||e.gplxBackUrl?r.jsx("a",{href:(F==null?void 0:F.gplxBackUrl)||(F==null?void 0:F.driverLicenseBackUrl)||(F==null?void 0:F.gplxImageUrl_Back)||e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:(F==null?void 0:F.gplxBackUrl)||(F==null?void 0:F.driverLicenseBackUrl)||(F==null?void 0:F.gplxImageUrl_Back)||e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:g,onChange:ne=>y(ne.target.checked)})," Verified"]})]})]})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{id:"customerPhone",style:{padding:6},children:ge?"Loading...":(F==null?void 0:F.phoneNumber)||(F==null?void 0:F.phone)||e.phone||""}),((F==null?void 0:F.phoneNumber)||(F==null?void 0:F.phone)||e.phone)&&r.jsx("a",{href:`tel:${(F==null?void 0:F.phoneNumber)||(F==null?void 0:F.phone)||e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!fe,style:{background:fe?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),r.jsx("button",{onClick:_e,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&r.jsx("button",{onClick:()=>n==null?void 0:n(e,"checkout"),style:{background:"#d32f2f",color:"#fff",width:"100%",padding:"12px",borderRadius:6,border:"none",cursor:"pointer",fontWeight:600,fontSize:14},children:"Check Out"})]}),A&&r.jsx("div",{style:{marginTop:8,color:"#b00020"},children:A})]})]}),r.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[r.jsx("h4",{children:"Transaction Details"}),r.jsxs("ul",{style:{fontSize:"1rem"},children:[r.jsx("li",{children:"Find rental location on map"}),r.jsx("li",{children:"View available vehicles (type, battery, price)"}),r.jsx("li",{children:"Book in advance or on-site"}),r.jsx("li",{children:"Check-in at counter/app"}),r.jsx("li",{children:"Sign electronic contract"}),r.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),r.jsx("li",{children:"Return vehicle at rental location"}),r.jsx("li",{children:"Staff checks and confirms vehicle condition"}),r.jsx("li",{children:"Pay any additional fees"})]})]})]})})})}function jS({bookings:e=[],search:t="",setSearch:n=()=>{},statusFilter:s="",setStatusFilter:o=()=>{},onRowClick:a=()=>{}}){const l=(e||[]).filter(v=>(v.title||"").toLowerCase().includes((t||"").toLowerCase())||(v.customer||"").toLowerCase().includes((t||"").toLowerCase())||(v.userName||"").toLowerCase().includes((t||"").toLowerCase())||(v.email||"").toLowerCase().includes((t||"").toLowerCase())).filter(v=>s===""||v.status===s),[d,u]=_.useState({}),[f,m]=_.useState({});_.useEffect(()=>{let v=!0;async function x(){try{const C=Array.from(new Set((e||[]).map(N=>{var b,T,I,R;return N.carId||N.CarId||((b=N.car)==null?void 0:b.id)||((T=N.car)==null?void 0:T.Id)||((I=N.vehicle)==null?void 0:I.id)||((R=N.vehicle)==null?void 0:R.Id)}).filter(Boolean)));if(C.length===0)return;const j=await Promise.all(C.map(async N=>{try{const b=await Qe.getCarById(N),T=(b==null?void 0:b.imageUrl)||(b==null?void 0:b.ImageUrl)||(b==null?void 0:b.thumbnailUrl)||(b==null?void 0:b.image)||null,I=(b==null?void 0:b.licensePlate)||(b==null?void 0:b.LicensePlate)||(b==null?void 0:b.plate)||(b==null?void 0:b.Plate)||null;return[String(N),{image:T,licensePlate:I}]}catch{return[String(N),{image:null,licensePlate:null}]}}));if(!v)return;const w={};for(const[N,b]of j)w[N]=b;u(w)}catch{}}return x(),()=>{v=!1}},[e]);const g=v=>{if(!v)return"-";try{const x=new Date(v);if(!isNaN(x.getTime()))return x.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5")}catch{}return v},y=(v,x=[])=>{if(!v)return null;for(const C of x){const j=[C,C[0].toLowerCase()+C.slice(1),C[0].toUpperCase()+C.slice(1)];for(const w of j)try{const N=v[w];if(N!=null&&String(N).trim()!=="")return N}catch{}}return null},k=v=>{var b,T,I,R;if(!v)return{name:null,email:null,phone:null};const x=v.userId||v.UserId||v.customerId||v.CustomerId||v.UserID||v.User||((b=v.user)==null?void 0:b.id),C=x?f[String(x)]||{}:{},j=v.fullName||v.userFullName||v.customerName||v.customer||((T=v.user)==null?void 0:T.fullName)||C.fullName||[v.firstName,v.lastName].filter(Boolean).join(" ")||v.userName||v.UserName||C.userName||null,w=v.email||v.customerEmail||v.userEmail||((I=v.user)==null?void 0:I.email)||C.email||null,N=v.phone||v.customerPhone||((R=v.user)==null?void 0:R.phoneNumber)||v.mobile||v.mobileNumber||C.phone||null;return{name:j,email:w,phone:N}};return _.useEffect(()=>{let v=!0;async function x(){try{const C=Array.from(new Set((e||[]).map(N=>N.userId||N.UserId||N.customerId||N.CustomerId).filter(Boolean)));if(C.length===0)return;const j=await Promise.all(C.map(async N=>{try{const b=await $l.getUserById(N),T=(b==null?void 0:b.email)||(b==null?void 0:b.Email)||(b==null?void 0:b.userEmail)||(b==null?void 0:b.userName)||null,I=(b==null?void 0:b.phoneNumber)||(b==null?void 0:b.phone)||(b==null?void 0:b.Phone)||(b==null?void 0:b.mobile)||null,R=(b==null?void 0:b.fullName)||(b==null?void 0:b.FullName)||[b==null?void 0:b.firstName,b==null?void 0:b.lastName].filter(Boolean).join(" ")||null;return[String(N),{email:T,phone:I,fullName:R}]}catch{return[String(N),{email:null,phone:null,fullName:null}]}}));if(!v)return;const w={};for(const[N,b]of j)w[N]=b;m(w)}catch{}}return x(),()=>{v=!1}},[e]),_.useEffect(()=>{try{if(!Array.isArray(e)||e.length===0)return;e.slice(0,8).forEach(x=>{const C={id:x.id||x.Id||x.bookingId||x.BookingId,pickupDate:x.pickupDate,rentalStartDate:x.rentalStartDate,startDateTime:x.startDateTime,startDate:x.startDate,pickup:x.pickup,fromDate:x.fromDate,returnDate:x.returnDate,rentalEndDate:x.rentalEndDate,endDateTime:x.endDateTime,endDate:x.endDate,toDate:x.toDate,bookingDate:x.bookingDate,date:x.date,createdAt:x.createdAt,created:x.created};console.debug("BookingTable: booking date fields for",C.id,C)})}catch(v){console.warn("BookingTable debug failed",v)}},[e]),r.jsxs("div",{className:"booking-model",children:[r.jsxs("div",{className:"booking-filter",style:{display:"flex",gap:8,marginBottom:12,alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Search bookings...",value:t,onChange:v=>n(v.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd",flex:"1 1 320px"}}),r.jsxs("select",{value:s,onChange:v=>o(v.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"",children:"All statuses"}),r.jsx("option",{value:"booked",children:"Booked"}),r.jsx("option",{value:"waiting_payment",children:"Waiting Payment"}),r.jsx("option",{value:"checked-in",children:"Checked In"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"booking-table",style:{width:"100%",borderCollapse:"collapse",minWidth:840},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",background:"#fafafa"},children:[r.jsx("th",{style:{padding:"12px 10px"},children:"Vehicle"}),r.jsx("th",{style:{padding:"12px 10px",width:220},children:"Email"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Phone"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Return"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Booking Date"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Status"}),r.jsx("th",{style:{padding:"12px 10px",width:120},children:"Actions"})]})}),r.jsxs("tbody",{children:[l.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{padding:24,color:"#666"},children:"No bookings found"})}),l.map(v=>r.jsxs("tr",{className:"booking-row",onClick:()=>a(v),style:{cursor:"pointer",borderBottom:"1px solid #eee"},children:[r.jsxs("td",{style:{padding:"12px 10px",display:"flex",gap:12,alignItems:"center"},children:[r.jsx("img",{src:(()=>{var w,N,b,T;const x=v.carId||v.CarId||((w=v.car)==null?void 0:w.id)||((N=v.car)==null?void 0:N.Id)||((b=v.vehicle)==null?void 0:b.id)||((T=v.vehicle)==null?void 0:T.Id),C=x?d[String(x)]:null;return C&&C.image||v.img||Ku(v.img)||"https://via.placeholder.com/100x60?text=Car"})(),onError:x=>{x.target.onerror=null,Yu(x.currentTarget)},alt:"car",style:{width:100,height:60,objectFit:"cover",borderRadius:6,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",background:"#fff"}}),r.jsx("div",{children:r.jsx("div",{style:{fontWeight:600},children:v.title||"Vehicle"})})]}),(()=>{const x=k(v);return r.jsxs(r.Fragment,{children:[r.jsx("td",{style:{padding:"12px 10px"},children:x.email||"-"}),r.jsx("td",{style:{padding:"12px 10px"},children:x.phone||"-"})]})})(),r.jsx("td",{style:{padding:"12px 10px"},children:g(y(v,["ExpectedReturnDateTime","returnDate","rentalEndDate","endDateTime","endDate","toDate","actualReturnDate","actualReturnDateTime","end","end_at","return_at"]))}),r.jsx("td",{style:{padding:"12px 10px"},children:g(y(v,["date","bookingDate","createdAt","created","CreatedAt","Created","created_date"]))}),r.jsx("td",{style:{padding:"12px 10px"},children:r.jsx("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:999,background:v.status==="completed"?"#e6f7ec":v.status==="cancelled"?"#fff0f0":"#f0f6ff",color:v.status==="completed"?"#2b8a3e":v.status==="cancelled"?"#b00020":"#1351b4",fontWeight:600,fontSize:12},children:v.statusLabel||v.status||""})}),r.jsx("td",{style:{padding:"12px 10px"},children:r.jsx("button",{onClick:x=>{x.stopPropagation(),a(v)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:"pointer"},children:"Details"})})]},v.id))]})]})})]})}function xp(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function SS({booking:e,onClose:t,onCheckedIn:n}){const[s,o]=_.useState(""),[a,l]=_.useState(null),[d,u]=_.useState(!1),[f,m]=_.useState(""),[g,y]=_.useState(null),[k,v]=_.useState(null),[x,C]=_.useState(""),[j,w]=_.useState(""),[N,b]=_.useState(""),[T,I]=_.useState(!1),[R,B]=_.useState(!1),[A,E]=_.useState(!1);mr.useEffect(()=>{let Y=!0;return(async()=>{try{const z=await We.getServerTime();Y&&y(z);try{const X=z?z.getTime()-Date.now():0;console.log(" Server time:",z,"Client time:",new Date,"(ms):",X)}catch{}}catch{}})(),()=>{Y=!1}},[]);async function M(Y){var z,X;if(Y.preventDefault(),!!(e!=null&&e.id)){u(!0),m("");try{const K=localStorage.getItem("token");if(!K||K==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let F="";try{F=localStorage.getItem("userId")||""}catch{}if(!F)try{const _e=localStorage.getItem("token");if(_e){const se=Er(_e);F=se["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||se.sub||se.userId||se.UserId||se.id||se.Id||""}}catch{}if(!F)throw new Error("Unable to determine userId. Please sign in again.");const $={bookingId:e.id,staffId:F,renterId:e.userId},ge=(s||"").trim();ge&&($.checkInNotes=ge),a&&($.checkInPhotoFile=a),console.log(" Check-in payload:",$),console.log(" Staff check-in info:",{bookingId:e.id,staffId:F,renterId:e.userId});const re=await We.checkInWithContract($);console.log(" Check-in response:",re),localStorage.setItem("activeCheckInBookingId",e.id),console.log(" Saved activeCheckInBookingId to localStorage:",e.id),v(re);const fe=(re==null?void 0:re.totalAmount)||(re==null?void 0:re.TotalAmount)||0;if(console.log(" Total amount for payment:",fe),fe>0){I(!0);try{const _e=await Lr.createPayment(e.id,1,"Rental payment at check-in");console.log(" Payment created:",_e);const se=_e||{},O=se.checkoutUrl||se.url||se.payUrl||"";O?(console.log(" Opening Payos checkout in new tab:",O),C(O),window.open(O,"_blank")):(console.warn(" No checkout URL in payment response:",se),C(""),m("Payment session created but no checkout URL received. Please try again."))}catch(_e){console.error(" Payment creation failed:",_e==null?void 0:_e.message),m(`Check-in succeeded but payment setup failed: ${_e==null?void 0:_e.message}. Please try again.`)}finally{I(!1)}}typeof n=="function"&&n(e.id,$)}catch(K){const F=(K==null?void 0:K.body)||((z=K==null?void 0:K.response)==null?void 0:z.data),$=F&&(F.errors||F.Errors)||null,ge=(Array.isArray($)&&$.length?$.join("; "):null)||(F==null?void 0:F.message)||(K==null?void 0:K.message)||"Failed to save check-in";m(ge);try{console.error(" Check-in failed:",{error:K==null?void 0:K.message,status:(K==null?void 0:K.status)||((X=K==null?void 0:K.response)==null?void 0:X.status),body:F})}catch{}}finally{u(!1)}}}async function G(){if(e!=null&&e.id){B(!0),m("");try{console.log(" Syncing payment for booking:",e.id),await Lr.syncPayment(e.id),console.log(" Payment synced successfully");const Y=await Xt.getBookingById(e.id);console.log(" Updated booking status:",Y.bookingStatus),E(!0),m(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(Y){console.error(" Payment sync failed:",Y),m(`Payment sync failed: ${Y.message}`),E(!1)}finally{B(!1)}}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),k?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check-in Successful"}),r.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(k==null?void 0:k.message)||"Check-in successful!"]}),f&&r.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:f}),T&&r.jsx("div",{style:{background:"#e3f2fd",color:"#1565c0",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Creating payment session and redirecting to Payos..."}),x&&!T&&r.jsx("div",{style:{background:"#f3e5f5",color:"#7b1fa2",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment session created. Payos opened in new tab."}),A&&r.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[r.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),r.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Total Amount:"}),r.jsx("strong",{children:xp((k==null?void 0:k.totalAmount)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:14},children:[r.jsx("span",{children:"Deposit (30%):"}),r.jsx("strong",{children:xp((k==null?void 0:k.depositAmount)||0)})]})]})]}),r.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:r.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment Processing"}),T?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:"Preparing payment link..."}),r.jsx("div",{style:{fontSize:12,color:"#999"},children:"You will be redirected to Payos to complete payment."})]}):x?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:12,lineHeight:1.5},children:" Payment link opened in new tab"}),r.jsx("div",{style:{fontSize:12,color:"#999",marginBottom:16},children:"After customer completes payment, click the button below to sync"}),r.jsx("button",{onClick:G,disabled:R||A,style:{background:A?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:R||A?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:R?" Syncing...":A?" Synced!":" Sync Payment Status"})]}):r.jsx("div",{style:{fontSize:13,color:"#d32f2f",padding:"12px",background:"#ffebee",borderRadius:6},children:" Payment setup incomplete"})]})})]}),r.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",r.jsx("strong",{children:"Note:"})," You will be redirected to Payos to complete payment. After payment completes, you will be redirected to the payment success page."]}),!T&&!x&&r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check In"}),g&&r.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",g.toLocaleString()]}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),r.jsxs("form",{onSubmit:M,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-in Notes"}),r.jsx("textarea",{rows:5,value:s,onChange:Y=>o(Y.target.value),placeholder:"Notes about the vehicle condition, accessories, battery, etc."})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-in Photo (Optional)"}),r.jsx("input",{type:"file",accept:"image/*",onChange:Y=>l(Y.target.files[0]||null),placeholder:"Select an image file"}),a&&r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Selected: ",a.name," (",(a.size/1024/1024).toFixed(2)," MB)"]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:d,style:{background:d?"#9e9e9e":"#2e7d32",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px",cursor:d?"not-allowed":"pointer"},children:d?"Processing":"Confirm Check In"})]})]})]})]})})}function ua(e){try{return(Number(e)||0).toLocaleString("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0})}catch{return`${e} VND`}}function CS({booking:e,onClose:t,onCheckedOut:n}){const[s,o]=_.useState(""),[a,l]=_.useState(0),[d,u]=_.useState(""),[f,m]=_.useState("15:00"),[g,y]=_.useState(null),[k,v]=_.useState(new Date().getMonth()),[x,C]=_.useState(new Date().getFullYear()),[j,w]=_.useState(!1),[N,b]=_.useState(""),[T,I]=_.useState(null),[R,B]=_.useState(null),[A,E]=_.useState(""),[M,G]=_.useState(!1),[Y,z]=_.useState(!1),[X,K]=_.useState(!1),F=Array.from({length:18},(se,O)=>`${(6+O).toString().padStart(2,"0")}:00`);mr.useEffect(()=>{let se=!0;return(async()=>{try{const O=await We.getServerTime();if(se&&(I(O),O)){const q=O.toISOString().split("T")[0];u(q)}try{const ne=O?O.getTime()-Date.now():0;console.log(" Server time:",O,"Client time:",new Date,"(ms):",ne)}catch{}}catch{}})(),()=>{se=!1}},[]);function $(){const se=new Date(x,k,1),O=new Date(x,k+1,0),ne=[];for(let we=0;we<se.getDay();we++)ne.push(r.jsx("div",{},`empty-${we}`));const q=new Date;q.setHours(0,0,0,0);for(let we=1;we<=O.getDate();we++){const Le=`${x}-${(k+1).toString().padStart(2,"0")}-${we.toString().padStart(2,"0")}`,Se=new Date(Le)<q,ze=Le===d,pe=["calendar-day"];Se&&pe.push("past"),ze&&pe.push("selected"),ne.push(r.jsx("div",{className:pe.join(" "),onClick:nt=>{nt.stopPropagation(),Se||(u(Le),y(null))},style:{cursor:Se?"not-allowed":"pointer",opacity:Se?.4:1,pointerEvents:Se?"none":"auto"},children:we},Le))}return ne}function ge(se){let O=k+se,ne=x;O>11&&(O=0,ne++),O<0&&(O=11,ne--),v(O),C(ne)}async function re(se){var O,ne;if(se.preventDefault(),!!(e!=null&&e.id)){w(!0),b("");try{const q=localStorage.getItem("token");if(!q||q==="null")throw new Error("You are not signed in. Please sign in as Staff and try again (401).");let we="";try{we=localStorage.getItem("userId")||""}catch{}if(!we)try{const oe=localStorage.getItem("token");if(oe){const le=decodeJwt(oe);we=le["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||le.sub||le.userId||le.UserId||le.id||le.Id||""}}catch{}if(!we)throw new Error("Unable to determine userId. Please sign in again.");const Le={bookingId:e.id,staffId:we,actualReturnDateTime:d&&f?new Date(`${d}T${f}`).toISOString():new Date().toISOString(),checkOutPhotoUrl:"",damageFee:Number(a)||0},Ne=(s||"").trim();Ne&&(Le.checkOutNotes=Ne);const Se=await We.checkOutWithPayment(Le);console.log(" Check-out response:",Se),localStorage.setItem("activeCheckOutBookingId",e.id),console.log(" Saved activeCheckOutBookingId to localStorage:",e.id),B(Se);const ze=await We.getBookingById(e.id);console.log(" Updated booking:",ze),ze&&B(oe=>({...oe,...ze}));const pe=Number(a)||0,nt=Number((ze==null?void 0:ze.extraAmount)||0),sn=pe+nt;if(console.log(" Payment amounts - Damage:",pe,"Backend Extra:",nt,"Total:",sn),sn>0){G(!0);try{const oe=await Lr.createPayment(e.id,2,"Rental payment at check-out",sn);console.log(" Payment created:",oe);const le=oe||{},ye=le.checkoutUrl||le.url||le.payUrl||"";ye?(console.log(" Opening Payos checkout in new tab:",ye),E(ye),window.open(ye,"_blank")):(console.warn(" No checkout URL in payment response:",le),E(""),b("Payment session created but no checkout URL received. Please try again."))}catch(oe){console.error(" Payment creation failed:",oe==null?void 0:oe.message),b(`Check-out succeeded but payment setup failed: ${oe==null?void 0:oe.message}. Please try again.`)}finally{G(!1)}}else{console.log(" No extra amount - creating checkout-only payment (type 3)");try{G(!0);const oe=await Lr.createPayment(e.id,3,"Checkout without payment");console.log(" Checkout-only payment created:",oe),E(""),setTimeout(()=>{typeof n=="function"&&n(e.id,[])},500)}catch(oe){console.error(" Checkout-only payment creation failed:",oe==null?void 0:oe.message),b(`Check-out succeeded but payment record creation failed: ${oe==null?void 0:oe.message}. Please contact support.`)}finally{G(!1)}}let he=[];try{he=await We.getIncidentsByBooking(e.id,1,20),console.log(" Fetched incidents immediately after checkout:",he)}catch(oe){console.warn(" Failed to fetch incidents after checkout:",(oe==null?void 0:oe.message)||oe)}typeof n=="function"&&n(e.id,he)}catch(q){const we=(q==null?void 0:q.body)||((O=q==null?void 0:q.response)==null?void 0:O.data),Le=we&&(we.errors||we.Errors)||null,Ne=(Array.isArray(Le)&&Le.length?Le.join("; "):null)||(we==null?void 0:we.message)||(q==null?void 0:q.message)||"Failed to save check-out";b(Ne);try{console.error(" Check-out failed:",{error:q==null?void 0:q.message,status:(q==null?void 0:q.status)||((ne=q==null?void 0:q.response)==null?void 0:ne.status),body:we})}catch{}}finally{w(!1)}}}async function fe(){if(e!=null&&e.id){G(!0),b("");try{localStorage.setItem("activeCheckOutBookingId",e.id);const se=Number((R==null?void 0:R.extraAmount)||0),O=Number(a)||0,ne=Math.max(se,O);console.log(" Creating payment - ExtraAmount:",se,"DamageFee:",O,"Using:",ne);const q=await Lr.createPayment(e.id,2,"Rental payment at check-out",ne);console.log(" Payment created:",q);const we=q||{},Le=we.checkoutUrl||we.url||we.payUrl||"";Le?(console.log(" Opening Payos checkout:",Le),E(Le),window.open(Le,"_blank")):(console.warn(" No checkout URL in payment response:",we),b("No checkout URL received. Please try again."))}catch(se){console.error(" Payment creation failed:",se==null?void 0:se.message),b(`Payment setup failed: ${se==null?void 0:se.message}`)}finally{G(!1)}}}async function _e(){if(e!=null&&e.id){z(!0),b("");try{console.log(" Syncing payment for booking:",e.id),await Lr.syncPayment(e.id),console.log(" Payment synced successfully");const se=await Xt.getBookingById(e.id);console.log(" Updated booking status:",se.bookingStatus),K(!0),b(""),setTimeout(()=>{typeof n=="function"&&n(e.id),t()},1500)}catch(se){console.error(" Payment sync failed:",se),b(`Payment sync failed: ${se.message}`),K(!1)}finally{z(!1)}}}return r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),R?r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check-out Successful"}),r.jsxs("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12},children:[" ",(R==null?void 0:R.message)||"Check-out successful!"]}),N&&r.jsx("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6,marginBottom:12},children:N}),X&&r.jsx("div",{style:{background:"#e8f5e9",color:"#2e7d32",padding:"12px",borderRadius:6,marginBottom:12,textAlign:"center"},children:" Payment synced successfully! Closing..."}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",marginBottom:16},children:[r.jsxs("div",{style:{flex:"1 1 300px",minWidth:260},children:[r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/120x80?text=Car",alt:"Car",style:{width:120,height:80,objectFit:"cover",borderRadius:6}}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:"0 0 4px"},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",e==null?void 0:e.id]})]})]}),r.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Damage Fee:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:ua((R==null?void 0:R.damageFee)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,fontSize:14},children:[r.jsx("span",{children:"Late Fee:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:ua((R==null?void 0:R.lateFee)||0)})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid #eee",paddingTop:8,fontSize:14,fontWeight:600},children:[r.jsx("span",{children:"Total Additional Fees:"}),r.jsx("strong",{style:{color:"#d32f2f"},children:ua(((R==null?void 0:R.damageFee)||0)+((R==null?void 0:R.lateFee)||0))})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,fontSize:14},children:[r.jsx("span",{children:"Refund Amount:"}),r.jsx("strong",{style:{color:"#2e7d32"},children:ua((R==null?void 0:R.refundAmount)??(R==null?void 0:R.RefundAmount)??(R==null?void 0:R.refund)??0)})]})]})]}),r.jsx("div",{style:{flex:"1 1 280px",minWidth:260},children:r.jsxs("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12,color:"#333"},children:" Payment"}),((R==null?void 0:R.extraAmount)||0)>0?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{fontSize:13,color:"#666",marginBottom:16,lineHeight:1.5},children:["Amount to pay: ",r.jsx("strong",{children:ua((R==null?void 0:R.extraAmount)||0)})]}),A?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:12},children:" Payment link opened in new tab"}),r.jsx("button",{onClick:_e,disabled:Y||X,style:{background:X?"#2e7d32":"#1976d2",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:Y||X?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%"},children:Y?" Syncing...":X?" Synced!":" Sync Payment Status"})]}):r.jsx("button",{onClick:fe,disabled:M,style:{background:"#4CAF50",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:M?"not-allowed":"pointer",fontSize:14,fontWeight:600,width:"100%",marginBottom:8},children:M?" Opening Payment...":" Go to Payment"})]}):r.jsx("div",{style:{fontSize:13,color:"#2e7d32",padding:"12px",background:"#e8f5e9",borderRadius:6},children:" No additional payment needed"})]})})]}),r.jsxs("div",{style:{background:"#fff9c4",padding:12,borderRadius:6,marginBottom:16,fontSize:13,color:"#f57f17",lineHeight:1.5},children:[" ",r.jsx("strong",{children:"Note:"}),' Click "Go to Payment" to open Payos in new tab. After customer completes payment, click "Sync Payment Status" to update booking.']}),r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600},children:"Close"})})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{style:{marginBottom:12},children:"Check Out"}),T&&r.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:8},children:["Server time: ",T.toLocaleString()]}),N&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:N}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:12},children:[r.jsx("img",{src:(e==null?void 0:e.img)||(e==null?void 0:e.carImageUrl)||"https://via.placeholder.com/160x100?text=Car",alt:"Car",style:{width:160,height:100,objectFit:"cover",borderRadius:8}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:700},children:(e==null?void 0:e.title)||"Vehicle"}),r.jsxs("div",{style:{color:"#555"},children:["Booking: ",e==null?void 0:e.id]})]})]}),r.jsxs("form",{onSubmit:re,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:12,position:"relative"},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Return Date"}),r.jsx("div",{onClick:se=>{se.stopPropagation(),y(g==="return"?null:"return")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:d?new Date(d).toLocaleDateString():"Select date"})]}),g==="return"&&r.jsxs("div",{onClick:se=>se.stopPropagation(),style:{position:"absolute",top:"100%",left:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:12,marginTop:4,zIndex:10,minWidth:280,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("button",{type:"button",onClick:se=>{se.stopPropagation(),ge(-1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""}),r.jsx("span",{style:{fontWeight:600},children:new Date(x,k).toLocaleString("default",{month:"long",year:"numeric"})}),r.jsx("button",{type:"button",onClick:se=>{se.stopPropagation(),ge(1)},style:{background:"none",border:"none",cursor:"pointer",fontSize:16},children:""})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,marginBottom:8},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(se=>r.jsx("div",{style:{textAlign:"center",fontSize:12,fontWeight:600},children:se},se))}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:$()})]})]}),r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Return Time"}),r.jsx("div",{onClick:se=>{se.stopPropagation(),y(g==="return-time"?null:"return-time")},style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:6,cursor:"pointer",background:"#fff"},children:f})]}),g==="return-time"&&r.jsx("div",{onClick:se=>se.stopPropagation(),style:{position:"absolute",top:"100%",left:0,right:0,background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:8,marginTop:4,zIndex:1001,maxHeight:240,overflow:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:F.map(se=>r.jsx("div",{onClick:O=>{O.stopPropagation(),m(se),y(null)},style:{padding:"8px 12px",cursor:"pointer",background:se===f?"#e3f2fd":"#fff",color:se===f?"#1976d2":"#333",fontWeight:se===f?"600":"400",borderRadius:4,marginBottom:4},children:se},se))})]})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Check-out Notes"}),r.jsx("textarea",{rows:4,value:s,onChange:se=>o(se.target.value),placeholder:"Notes about the vehicle condition upon return, battery level, etc."})]}),r.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("span",{children:"Damage Fee (VND)"}),r.jsx("input",{type:"number",min:"0",value:a,onChange:se=>l(se.target.value),placeholder:"Enter damage fee (based on incidents reviewed)"})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:t,style:{background:"transparent",color:"#333",border:"1px solid #aaa",borderRadius:8,padding:"8px 14px"},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:j,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:8,padding:"8px 14px"},children:j?"Processing":"Confirm Check Out"})]})]})]})]})}var NS={};function kS({bookingId:e,onClose:t,refreshKey:n,initialIncidents:s=[]}){const[o,a]=_.useState([]),[l,d]=_.useState(!1),[u,f]=_.useState(!0),[m,g]=_.useState(""),[y,k]=_.useState(1),v=20;_.useEffect(()=>{if(!e)return;let C=!0;return(async()=>{f(!0),g("");try{!l&&Array.isArray(s)&&s.length>0&&(a(s),d(!0));const w=[0,1e3,3e3];for(let N=0;N<w.length&&C;N++){w[N]>0&&await new Promise(b=>setTimeout(b,w[N]));try{const b=await We.getIncidentsByBooking(e,y,v),T=Array.isArray(b)?b:[];if(console.log(` Incidents loaded (attempt ${N+1}):`,T),T.length>0){if(!C)return;a(T);return}if(N===w.length-1){if(!C)return;a([])}}catch(b){console.warn(" Incident fetch attempt failed:",(b==null?void 0:b.message)||b)}}}catch(w){console.error(" Failed to load incidents:",w),C&&g((w==null?void 0:w.message)||"Failed to load incidents")}finally{C&&f(!1)}})(),()=>{C=!1}},[e,y,n]);const x=C=>{const j=String(C).toLowerCase();return j.includes("resolved")||j.includes("low")?"#2e7d32":j.includes("medium")?"#f57c00":j.includes("high")||j.includes("open")||j.includes("new")?"#d32f2f":"#666"};return r.jsxs("div",{className:"modal-content",style:{width:"min(900px,95vw)",maxHeight:"90vh",overflow:"auto",background:"#fff",borderRadius:8,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"16px 16px 0 0"},children:[r.jsx("h3",{style:{margin:0,fontSize:20,fontWeight:700},children:"Related Incidents"}),r.jsx("span",{className:"close-btn",onClick:t,style:{cursor:"pointer",fontSize:24},children:""})]}),u?r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" Loading incidents..."}):m?r.jsxs("div",{style:{background:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:6},children:[" ",m]}):o.length===0?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#999"},children:" No incidents reported for this booking"}),y>1&&!u&&r.jsx("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:r.jsx("button",{onClick:()=>k(1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Reset to Page 1"})})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.map((C,j)=>{var Y;const w=C.id||C._id||"",N=C.description||C.title||"",b=N&&N.length>80?N.slice(0,80)+"":N,T=C.status||C.severity||"N/A",I=C.reportedAt||C.reportedDate||C.timestamp||C.createdAt||null,R=C.resolvedAt||C.resolvedDate||null,B=C.costIncurred??C.estimatedCost??null,A=C.staffName||C.staff||C.reportedBy||null,E=C.resolverName||C.resolvedBy||null,M=Array.isArray(C.images)?C.images:[],G=z=>z?typeof z=="string"&&(z.startsWith("http://")||z.startsWith("https://"))?z:typeof z=="string"&&z.trim()?`${NS.REACT_APP_API_URL||window.location.origin}/${z.replace(/^\//,"")}`:null:null;return r.jsxs("div",{style:{border:"1px solid #eee",padding:16,borderRadius:6,display:"flex",gap:16},children:[r.jsx("div",{style:{flex:"0 0 120px"},children:M.length>0&&G(M[0])?r.jsx("img",{src:G(M[0]),alt:"incident",style:{width:120,height:90,objectFit:"cover",borderRadius:6},onError:z=>{z.target.style.display="none"}}):r.jsx("div",{style:{width:120,height:90,background:"#fafafa",border:"1px dashed #eee",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:12},children:"No image"})}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[r.jsxs("div",{children:[r.jsx("h4",{style:{margin:"0 0 6px",fontSize:15,fontWeight:700},children:b||`Incident ${((Y=w==null?void 0:w.slice)==null?void 0:Y.call(w,0,8))||j+1}`}),r.jsxs("div",{style:{fontSize:12,color:"#666"},children:["ID: ",w||"N/A"]})]}),r.jsx("div",{style:{textAlign:"right"},children:r.jsx("div",{style:{background:x(T),color:"#fff",padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:700},children:T})})]}),r.jsx("p",{style:{margin:"0 0 10px",fontSize:14,color:"#555",lineHeight:1.5},children:N||"No description"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12,fontSize:13,color:"#666"},children:[r.jsxs("div",{children:[" Est. Cost: ",r.jsx("strong",{style:{color:"#d32f2f"},children:B!==null?`${Number(B).toLocaleString()} VND`:"N/A"})]}),r.jsxs("div",{children:[" Reported: ",r.jsx("strong",{children:I?new Date(I).toLocaleString():"N/A"})]}),r.jsxs("div",{children:[" Resolved: ",r.jsx("strong",{children:R?new Date(R).toLocaleString():"N/A"})]}),r.jsxs("div",{children:[" Staff: ",r.jsx("strong",{children:A||"N/A"})]}),E&&r.jsxs("div",{children:[" Resolver: ",r.jsx("strong",{children:E})]})]})]})]},w||j)})}),!u&&o.length>0&&r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16},children:[r.jsx("button",{onClick:()=>k(C=>Math.max(1,C-1)),disabled:y===1,style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:y===1?"not-allowed":"pointer"},children:" Prev"}),r.jsxs("span",{style:{padding:"6px 12px"},children:["Page ",y]}),r.jsx("button",{onClick:()=>k(C=>C+1),style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4,cursor:"pointer"},children:"Next "})]})]})}function bS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onContinuePayment:a,onCancelBooking:l,onStatusUpdated:d}){const[u,f]=_.useState(null),[m,g]=_.useState(null),[y,k]=_.useState(null),[v,x]=_.useState(0),[C,j]=_.useState([]),w=_.useCallback(b=>{typeof d=="function"&&d(b)},[d]);mr.useEffect(()=>{if(!(y!=null&&y.id))return;const b={current:!1},T=setInterval(async()=>{try{const I=localStorage.getItem("activeCheckOutBookingId");if(b.current){if(!I){console.log(" Checkout payment completed (user redirected)"),clearInterval(T),k(null),w(y==null?void 0:y.id);return}I&&I!==String(y.id)&&(b.current=!1)}else if(I===String(y.id))b.current=!0,console.log(" Detected active check-out payment flow for",y.id);else return}catch(I){console.warn(" Polling error:",I==null?void 0:I.message)}},2e3);return()=>clearInterval(T)},[y==null?void 0:y.id,w]),mr.useEffect(()=>{if(!(m!=null&&m.id))return;const b={current:!1},T=setInterval(()=>{try{const I=localStorage.getItem("activeCheckInBookingId");if(b.current){if(!I){console.log(" Check-in payment completed (user redirected)"),clearInterval(T),g(null),w(m==null?void 0:m.id);return}I&&I!==String(m.id)&&(b.current=!1)}else if(I===String(m.id))b.current=!0,console.log(" Detected active check-in payment flow for",m.id);else return}catch(I){console.warn(" Polling error (check-in):",I==null?void 0:I.message)}},2e3);return()=>clearInterval(T)},[m==null?void 0:m.id,w]);const N=e.filter(b=>(b.title.toLowerCase().includes(t.toLowerCase())||(b.customer||"").toLowerCase().includes(t.toLowerCase())||(b.userName||"").toLowerCase().includes(t.toLowerCase())||(b.email||"").toLowerCase().includes(t.toLowerCase()))&&(s===""||b.status===s));return r.jsxs(r.Fragment,{children:[r.jsx(jS,{bookings:N,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onRowClick:b=>f(b)}),r.jsx(wS,{booking:u,onClose:()=>f(null),onProceed:(b,T)=>{b&&(T==="checkout"?(k(b),f(null)):(g(b),f(null)))},onCancel:()=>{u&&(l==null||l(u))},onStatusUpdated:d}),m&&r.jsx(SS,{booking:m,onClose:()=>g(null)}),y&&r.jsxs("div",{style:{display:"flex",gap:24,position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:1e3,alignItems:"center",justifyContent:"center",padding:20,overflow:"auto"},children:[r.jsx("div",{style:{flex:"0 0 auto",width:"720px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:r.jsx(CS,{booking:y,onClose:()=>k(null),onCheckedOut:(b,T=[])=>{x(I=>I+1),j(Array.isArray(T)?T:[]),typeof d=="function"&&d(b)}})}),r.jsx("div",{style:{flex:"0 0 auto",width:"600px",maxWidth:"45vw",maxHeight:"90vh",overflow:"auto",flexShrink:0},children:r.jsx(kS,{bookingId:y==null?void 0:y.id,refreshKey:v,initialIncidents:C,onClose:()=>{k(null),j([])}})})]})]})}function IS({open:e,onClose:t,onSubmit:n,stationId:s}){const[o,a]=_.useState(""),[l,d]=_.useState(""),[u,f]=_.useState(""),[m,g]=_.useState(""),[y,k]=_.useState(""),[v,x]=_.useState(""),[C,j]=_.useState(""),[w,N]=_.useState(""),[b,T]=_.useState(""),[I,R]=_.useState(""),[B,A]=_.useState(""),[E,M]=_.useState("");if(!e)return null;async function G(){if(M(""),!s){M("Please select a station before creating a vehicle.");return}if(!o.trim()||!l.trim()||!y.trim()||!u||!v||!C||!w||!b){M("Please fill all required fields: Brand, Model, Year, License Plate, Battery Capacity, Current Battery, Price/hour, Price/day.");return}const Y=Number(u),z=Number(v),X=Number(C),K=Number(w),F=Number(b);if(!Number.isFinite(Y)||Y<1900||Y>2100){M("Year must be between 1900 and 2100.");return}if(!Number.isFinite(z)||z<0||z>100){M("Battery Capacity must be between 0 and 100 (kWh).");return}if(!Number.isFinite(X)||X<0||X>100){M("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite(K)||K<=0||!Number.isFinite(F)||F<=0){M("Rental prices must be positive numbers.");return}const $={brand:o.trim(),model:l.trim(),year:Y,color:m||void 0,licensePlate:y.trim(),batteryCapacity:z,currentBatteryLevel:X,rentalPricePerHour:K,rentalPricePerDate:F,currentStationId:s,imageUrl:I||void 0,description:B||void 0};try{await n($),a(""),d(""),f(""),g(""),k(""),x(""),j(""),N(""),T(""),R(""),A(""),t()}catch(ge){M((ge==null?void 0:ge.message)||"Failed to create vehicle")}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),E&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:E}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[r.jsx("input",{value:o,onChange:Y=>a(Y.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:l,onChange:Y=>d(Y.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:u,onChange:Y=>f(Y.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:m,onChange:Y=>g(Y.target.value),placeholder:"Color",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:y,onChange:Y=>k(Y.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:v,onChange:Y=>x(Y.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:C,onChange:Y=>j(Y.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:w,onChange:Y=>N(Y.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:b,onChange:Y=>T(Y.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:I,onChange:Y=>R(Y.target.value),placeholder:"Image URL",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}}),r.jsx("input",{value:B,onChange:Y=>A(Y.target.value),placeholder:"Description",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:G,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function LS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[o,a]=_.useState(""),[l,d]=_.useState(""),[u,f]=_.useState("");if(_.useEffect(()=>{n&&(a(n.battery??""),d(n.tech??""),f(n.issue??""))},[n]),!e||!n)return null;function m(){s(n.id,{battery:o,tech:l,issue:u}),t()}return r.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"vehicle-modal-content",children:[r.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),r.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),r.jsx("label",{children:"Battery Status"}),r.jsx("input",{value:o,onChange:g=>a(g.target.value),placeholder:"e.g. 80"}),r.jsx("label",{children:"Condition"}),r.jsxs("select",{value:l,onChange:g=>d(g.target.value),children:[r.jsx("option",{children:"Open"}),r.jsx("option",{children:"Running"}),r.jsx("option",{children:"Rented"}),r.jsx("option",{children:"Maintained"})]}),r.jsx("label",{children:"Issue"}),r.jsx("textarea",{value:u,onChange:g=>f(g.target.value)}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:m,children:"Submit Update"})})]})})}function PS({open:e,vehicle:t,onClose:n,onEdit:s,onUpdate:o}){const[a,l]=_.useState(!1),[d,u]=_.useState(""),[f,m]=_.useState(""),[g,y]=_.useState(""),[k,v]=_.useState(!0),[x,C]=_.useState(!1);if(!e||!t)return null;const j=t.img,w=()=>{u(t.battery??""),m(t.tech??""),y(t.issue??""),v(t.isAvailable!==!1&&t.isAvailable!==0),l(!0)},N=async()=>{if(o){C(!0);try{await o(t.id,{battery:d,tech:f,issue:g,isAvailable:k}),l(!1)}catch(T){alert((T==null?void 0:T.message)||"Failed to update vehicle")}finally{C(!1)}}},b=()=>{l(!1),u(""),m(""),y(""),v(!0)};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsx("img",{src:j,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),r.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[r.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[r.jsx("h3",{style:{marginTop:4},children:t.name}),r.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Detail:"}),r.jsx("div",{children:t.detail||"N/A"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Battery:"}),a?r.jsx("input",{type:"number",min:"0",max:"100",value:d,onChange:T=>u(T.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):r.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Condition:"}),a?r.jsx("input",{type:"text",value:f,onChange:T=>m(T.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):r.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Active Status:"}),a?r.jsxs("label",{style:{marginLeft:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"8px"},children:[r.jsx("input",{type:"checkbox",checked:k,onChange:T=>v(T.target.checked),style:{cursor:"pointer",width:"18px",height:"18px"}}),r.jsx("span",{style:{fontSize:"14px"},children:k?" Available":" Unavailable"})]}):r.jsx("span",{style:{marginLeft:"8px",fontWeight:"600",color:t.isAvailable!==!1&&t.isAvailable!==0?"#10b981":"#ef4444"},children:t.isAvailable!==!1&&t.isAvailable!==0?" Available":" Unavailable"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[r.jsx("strong",{children:"Issue:"}),a?r.jsx("textarea",{value:g,onChange:T=>y(T.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):r.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),r.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:j,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),r.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:a?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:N,disabled:x,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:x?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:x?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",x?"Saving...":"Save Changes"]}),r.jsxs("button",{onClick:b,disabled:x,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:x?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):o&&r.jsxs("button",{onClick:w,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]})})]})})}function ES({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalCars)||0,n=(e==null?void 0:e.availableCars)||0;return r.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[r.jsx("i",{className:"fas fa-parking"})," ",n," Slot Taken / ",t," Slot"]})}function TS({vehicles:e=[],search:t="",setSearch:n=()=>{},onRowClick:s=()=>{},onEdit:o=()=>{},onRemove:a=()=>{},canDelete:l=!0}){const[d,u]=_.useState({});_.useEffect(()=>{let y=!0;async function k(){try{const v=Array.from(new Set((e||[]).map(j=>j.id).filter(Boolean)));if(v.length===0)return;const x=await Promise.all(v.map(async j=>{try{const w=await Qe.getCarById(j),N=(w==null?void 0:w.imageUrl)||(w==null?void 0:w.ImageUrl)||(w==null?void 0:w.thumbnailUrl)||(w==null?void 0:w.image)||null,b=(w==null?void 0:w.licensePlate)||(w==null?void 0:w.LicensePlate)||null;return[String(j),{image:N,licensePlate:b}]}catch{return[String(j),{image:null,licensePlate:null}]}}));if(!y)return;const C={};for(const[j,w]of x)C[j]=w;u(C)}catch{}}return k(),()=>{y=!1}},[e]);const f=(e||[]).filter(y=>{if(!t)return!0;const k=(t||"").toLowerCase();return(y.name||"").toLowerCase().includes(k)||(y.brand||"").toLowerCase().includes(k)||(y.model||"").toLowerCase().includes(k)||(y.licensePlate||"").toLowerCase().includes(k)}),m=y=>y==null||y===""?"-":Number.isFinite(y)?`${y}%`:String(y),g=y=>y==null||y===""?"-":String(y);return r.jsx("div",{className:"vehicle-table-model",children:r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"vehicle-table",style:{width:"100%",borderCollapse:"collapse",minWidth:800},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",background:"#fafafa"},children:[r.jsx("th",{style:{padding:"12px 10px"},children:"Vehicle"}),r.jsx("th",{style:{padding:"12px 10px",width:160},children:"Plate"}),r.jsx("th",{style:{padding:"12px 10px",width:120},children:"Battery"}),r.jsx("th",{style:{padding:"12px 10px",width:120},children:"Capacity"}),r.jsx("th",{style:{padding:"12px 10px"},children:"Status"}),r.jsx("th",{style:{padding:"12px 10px",width:160},children:"Actions"})]})}),r.jsxs("tbody",{children:[f.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,style:{padding:24,color:"#666"},children:"No vehicles found"})}),f.map(y=>r.jsxs("tr",{className:"vehicle-row",style:{borderBottom:"1px solid #eee"},children:[r.jsxs("td",{style:{padding:"12px 10px",display:"flex",gap:12,alignItems:"center"},onClick:()=>s(y),children:[r.jsx("img",{src:d[String(y.id)]&&d[String(y.id)].image||y.img||"https://via.placeholder.com/100x60?text=Car",alt:"car",onError:k=>{k.currentTarget.onerror=null,k.currentTarget.src="https://via.placeholder.com/100x60?text=Car"},style:{width:100,height:60,objectFit:"cover",borderRadius:6,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",background:"#fff"}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600},children:y.name||y.title||"Vehicle"}),r.jsx("div",{style:{fontSize:13,color:"#666"},children:y.brand?`${y.brand}${y.model?"  "+y.model:""}`:y.model||""})]})]}),r.jsx("td",{style:{padding:"12px 10px"},children:d[String(y.id)]&&d[String(y.id)].licensePlate||y.licensePlate||"-"}),r.jsx("td",{style:{padding:"12px 10px"},children:m(y.battery)}),r.jsx("td",{style:{padding:"12px 10px"},children:g(y.capacity)}),r.jsx("td",{style:{padding:"12px 10px"},children:r.jsx("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:999,background:y.tech==="Unavailable"||y.tech==="Removed"?"#fff0f0":"#f0f6ff",color:y.tech==="Unavailable"||y.tech==="Removed"?"#b00020":"#1351b4",fontWeight:600,fontSize:12},children:y.tech||(y.issue?"Issue":"Available")})}),r.jsxs("td",{style:{padding:"12px 10px"},children:[r.jsx("button",{onClick:k=>{k.stopPropagation(),s(y)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:"pointer",marginRight:8},children:"Details"}),l&&r.jsx("button",{onClick:k=>{k.stopPropagation(),window.confirm("Delete this vehicle?")&&a(y.id||y)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #f0c0c0",background:"#fff",cursor:"pointer",color:"#b00020"},children:"Delete"})]})]},y.id||y.licensePlate||Math.random()))]})]})})})}function BS({vehicles:e,onAdd:t,onRemove:n,onUpdate:s,stationId:o,canDelete:a=!0,stationSlots:l=null}){const[d,u]=_.useState(null),[f,m]=_.useState(!1),[g,y]=_.useState(!1),[k,v]=_.useState(!1),[x,C]=_.useState(""),j=e.filter(b=>{if(!x)return!0;const T=x.toLowerCase(),I=(b.name||"").toLowerCase(),R=(b.model||"").toLowerCase(),B=(b.brand||"").toLowerCase(),A=(b.licensePlate||"").toLowerCase();return I.includes(T)||R.includes(T)||B.includes(T)||A.includes(T)});function w(b){u(b),v(!0)}function N(b){u(b),m(!0)}return r.jsxs("div",{id:"vehicle",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:x,onChange:b=>C(b.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),o&&l&&r.jsx(ES,{stationSlots:l})]}),r.jsx("div",{children:r.jsx(TS,{vehicles:j,search:x,setSearch:C,onRowClick:b=>N(b),onEdit:b=>{const T=typeof b=="object"?b:j.find(I=>String(I.id)===String(b));T&&(u(T),v(!0))},onRemove:b=>{const T=typeof b=="object"?b.id||b.carId:b;T&&n(T)},canDelete:a})}),r.jsx(IS,{open:g,onClose:()=>y(!1),onSubmit:t,stationId:o}),r.jsx(LS,{open:k,onClose:()=>v(!1),vehicle:d,onSubmit:s}),r.jsx(PS,{open:f,vehicle:d,onClose:()=>m(!1),onEdit:d?()=>w(d):null,onUpdate:s})]})}function RS({open:e,onClose:t,inline:n=!1}){const[s,o]=_.useState(!1),[a,l]=_.useState({}),[d,u]=_.useState({}),[f,m]=_.useState("");if(_.useEffect(()=>{if(!e)return;let T=!0;async function I(){var R,B,A;try{o(!0),m("");let E={},M={};try{E=await yt.getMyProfile()}catch(G){((R=G==null?void 0:G.response)==null?void 0:R.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{M=await yt.getMe()}catch(G){((B=G==null?void 0:G.response)==null?void 0:B.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!T)return;l(E||{}),u(M||{});try{let G=(E==null?void 0:E.id)||(E==null?void 0:E.userId)||(M==null?void 0:M.userId)||(M==null?void 0:M.id);if(!G){const z=typeof localStorage<"u"?localStorage.getItem("token"):null;if(z){const X=Er(z);G=X["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||X.nameidentifier||X.sub||X.userId||X.UserId||X.id||X.Id}}if(!(M!=null&&M.role)&&!(E!=null&&E.role))try{const z=typeof localStorage<"u"?localStorage.getItem("token"):null;if(z){const X=Er(z),K=(X==null?void 0:X.role)||(X==null?void 0:X.Role)||X["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];K&&(M={...M,role:K})}}catch{}const Y=!(E!=null&&E.userName)&&!(M!=null&&M.userName)||!(E!=null&&E.address)||!(E!=null&&E.stationName);if(G&&Y)try{const z=await yt.getUserById(G);if(!T)return;const X={...E};X.userName||(X.userName=(z==null?void 0:z.userName)||(z==null?void 0:z.UserName)||(z==null?void 0:z.username)||""),X.address||(X.address=(z==null?void 0:z.address)||(z==null?void 0:z.Address)||""),X.stationName||(X.stationName=(z==null?void 0:z.stationName)||((A=z==null?void 0:z.station)==null?void 0:A.name)||(z==null?void 0:z.StationName)||""),l(X)}catch{}}catch{}if((!E||Object.keys(E).length===0)&&(!M||Object.keys(M).length===0)){const G=typeof localStorage<"u"&&!!localStorage.getItem("token");m(G?"You may not have permission to view this profile.":"You are not logged in. Please log in with a staff account.")}}catch(E){if(!T)return;m((E==null?void 0:E.message)||"Failed to load profile")}finally{T&&o(!1)}}return I(),()=>{T=!1}},[e]),!e)return null;let g=a.userName||a.username||d.userName||d.username||"";if(!g)try{const T=typeof localStorage<"u"?localStorage.getItem("token"):null;if(T){const I=Er(T);g=(I==null?void 0:I.preferred_username)||(I==null?void 0:I.unique_name)||(I==null?void 0:I.userName)||(I==null?void 0:I.username)||(I==null?void 0:I.name)||""}}catch{}const y=a.firstName?`${a.firstName} ${a.lastName||""}`.trim():a.fullName||d.fullName||d.name||"",k=a.email||d.email||"",v=a.phoneNumber||d.phoneNumber||"",x=a.address||d.address||"",C=a.createdAt||d.createdAt||"",j=a.employeeId||a.id||d.userId||d.id||"",w=a.stationName||a.station||"",N=a.role||d.role||(Array.isArray(d.roles)?d.roles.join(", "):d.roles||""),b=a.avatarUrl||d.avatarUrl||"https://via.placeholder.com/180x180?text=Staff";return n?r.jsxs("div",{className:"staff-profile-page",children:[r.jsx("div",{className:"staff-cover",children:r.jsx("div",{className:"staff-cover-gradient"})}),r.jsx("div",{className:"staff-header",children:r.jsxs("div",{className:"staff-header-inner",children:[r.jsx("div",{className:"staff-avatar",children:r.jsx("img",{src:b,alt:"Avatar"})}),r.jsxs("div",{className:"staff-title",children:[r.jsx("h1",{children:y}),r.jsxs("div",{className:"staff-meta",children:[r.jsx("span",{className:"staff-role",children:N||""}),r.jsx("span",{className:"staff-sep",children:""}),r.jsx("span",{className:"staff-station",children:w})]})]})]})}),r.jsxs("div",{className:"staff-content",children:[r.jsx("div",{className:"staff-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"About"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Full Name"}),r.jsx("span",{className:"value",children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Role"}),r.jsx("span",{className:"value",children:N||""})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Station"}),r.jsx("span",{className:"value",children:w})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Employee ID"}),r.jsx("span",{className:"value",children:j})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Joined"}),r.jsx("span",{className:"value",children:String(C).toString().slice(0,10)||""})]})]})]})}),r.jsx("div",{className:"staff-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"Contact"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Email"}),r.jsx("span",{className:"value",children:k})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Phone"}),r.jsx("span",{className:"value",children:v})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Address"}),r.jsx("span",{className:"value",children:x})]})]})]})})]}),f&&r.jsx("div",{className:"staff-error",children:f})]}):r.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"profile-modal-content",children:[r.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),r.jsx("h2",{children:"Staff Profile"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsx("img",{src:b,alt:"Staff",style:{borderRadius:"50%"}}),s?r.jsx("div",{style:{padding:16},children:"Loading profile"}):r.jsxs("div",{className:"profile-info-grid",children:[r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Name"}),r.jsx("div",{children:y})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Email"}),r.jsx("div",{children:k})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Role"}),r.jsx("div",{children:N||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Phone"}),r.jsx("div",{children:v})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Address"}),r.jsx("div",{children:x})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Joined"}),r.jsx("div",{children:String(C).toString().slice(0,10)||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Employee ID"}),r.jsx("div",{children:j})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Station"}),r.jsx("div",{children:w})]})]})]})})}function AS(){return r.jsx("div",{id:"profile",className:"section",style:{padding:24},children:r.jsx(RS,{open:!0,inline:!0,onClose:()=>{}})})}function Ey({incident:e,onClick:t}){var a;const n=l=>{const d={Pending:{background:"#fef3c7",color:"#92400e",icon:"fa-clock"},InProgress:{background:"#dbeafe",color:"#1e40af",icon:"fa-spinner"},Resolved:{background:"#d1fae5",color:"#065f46",icon:"fa-check-circle"}},u=d[l]||d.Pending;return r.jsxs("span",{style:{...u,padding:"4px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px"},children:[r.jsx("i",{className:`fas ${u.icon}`}),l]})},s=l=>l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",o=l=>l==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(l);return r.jsxs("div",{className:"incident-card",onClick:()=>t(e),children:[r.jsxs("div",{className:"incident-card-header",children:[r.jsxs("div",{className:"incident-card-title",children:[r.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b",marginRight:"8px"}}),r.jsxs("span",{children:["Incident #",(a=e.id)==null?void 0:a.slice(0,8)]})]}),n(e.status)]}),r.jsxs("div",{className:"incident-card-body",children:[r.jsx("div",{className:"incident-description",children:e.description}),r.jsxs("div",{className:"incident-metadata",children:[r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-calendar"}),r.jsx("span",{children:s(e.reportedAt)})]}),e.bookingId&&r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-ticket-alt"}),r.jsxs("span",{children:["Booking: ",e.bookingId.slice(0,8),"..."]})]}),e.costIncurred!=null&&r.jsxs("div",{className:"incident-meta-item",style:{color:"#dc2626",fontWeight:"600"},children:[r.jsx("i",{className:"fas fa-dollar-sign"}),r.jsx("span",{children:o(e.costIncurred)})]}),e.images&&e.images.length>0&&r.jsxs("div",{className:"incident-meta-item",children:[r.jsx("i",{className:"fas fa-image"}),r.jsxs("span",{children:[e.images.length," image",e.images.length>1?"s":""]})]})]})]}),r.jsx("div",{className:"incident-card-footer",children:r.jsxs("span",{className:"incident-view-details",children:["View Details ",r.jsx("i",{className:"fas fa-arrow-right"})]})})]})}function MS({open:e,onClose:t,onSubmit:n,bookings:s=[]}){const[o,a]=_.useState(""),[l,d]=_.useState(""),[u,f]=_.useState([]),[m,g]=_.useState([]),[y,k]=_.useState(""),[v,x]=_.useState(!1);if(!e)return null;const C=(s||[]).filter(b=>{const T=String((b==null?void 0:b.status)||"").toLowerCase(),I=String((b==null?void 0:b.statusLabel)||"").toLowerCase(),R=Number(b==null?void 0:b.bookingStatus),B=["checked-in","checkedin","checked_in","checked in","checked"].includes(T),A=Number.isFinite(R)&&R===3,E=I.includes("checked-in")||I.includes("checked in")||I.includes("checked")&&!I.includes("wait")&&!I.includes("waiting")&&!I.includes("pending");return B||A||E}),j=b=>{const T=Array.from(b.target.files||[]),I=new Set(u.map(E=>`${E.name}_${E.size}`)),R=T.filter(E=>{if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(E.type))return k(`Invalid file type: ${E.name}. Only JPG, PNG, GIF allowed.`),!1;if(E.size>26214400)return k(`File too large: ${E.name}. Max 25MB per file.`),!1;const Y=`${E.name}_${E.size}`;return I.has(Y)?!1:(I.add(Y),!0)});if(R.length===0)return;const B=[...u,...R];f(B);const A=R.map(E=>URL.createObjectURL(E));g(E=>[...E,...A])},w=b=>{const T=u.filter((R,B)=>B!==b),I=m.filter((R,B)=>B!==b);try{URL.revokeObjectURL(m[b])}catch{}f(T),g(I)},N=async()=>{if(k(""),!o){k("Please select a booking");return}if(!l.trim()){k("Please provide incident description");return}x(!0);try{const b=new FormData;b.append("bookingId",o),b.append("description",l.trim()),u.forEach(T=>{b.append("images",T)}),await n(b),a(""),d(""),f([]),m.forEach(T=>URL.revokeObjectURL(T)),g([]),t()}catch(b){k((b==null?void 0:b.message)||"Failed to create incident")}finally{x(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"650px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsxs("h3",{style:{marginTop:0,marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f59e0b"}}),"Report Incident"]}),y&&r.jsxs("div",{style:{background:"#fee2e2",color:"#b91c1c",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:[r.jsx("i",{className:"fas fa-exclamation-circle"})," ",y]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Select Booking ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),C.length===0?r.jsx("div",{style:{padding:"10px",border:"1px solid #f3f4f6",borderRadius:8,color:"#6b7280"},children:'No bookings in "Checked-in" state available.'}):r.jsxs("select",{value:o,onChange:b=>a(b.target.value),style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"-- Select Booking --"}),C.map(b=>r.jsxs("option",{value:b.id,children:["Booking #",String(b.id).slice(0,8)," - ",b.title||b.vehicleName||"Vehicle"," (",b.statusLabel||b.status,")"]},b.id))]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:["Incident Description ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),r.jsx("textarea",{value:l,onChange:b=>d(b.target.value),placeholder:"Describe the incident in detail...",rows:5,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",resize:"vertical",fontFamily:"inherit"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",fontSize:"14px"},children:"Upload Images (Optional)"}),r.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.gif",multiple:!0,onChange:j,disabled:C.length===0,style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",cursor:C.length===0?"not-allowed":"pointer",opacity:C.length===0?.6:1}}),r.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:"Max 25MB per file. Formats: JPG, PNG, GIF"})]}),m.length>0&&r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:["Preview (",m.length," image",m.length>1?"s":"",")"]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px"},children:m.map((b,T)=>r.jsxs("div",{style:{position:"relative"},children:[r.jsx("img",{src:b,alt:`Preview ${T+1}`,style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e5e7eb"}}),r.jsx("button",{onClick:()=>w(T),style:{position:"absolute",top:"4px",right:"4px",background:"#dc2626",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("i",{className:"fas fa-times"})})]},T))})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"24px"},children:[r.jsx("button",{onClick:t,disabled:v,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:v?"not-allowed":"pointer",opacity:v?.6:1},children:"Cancel"}),r.jsx("button",{onClick:N,disabled:v||C.length===0,style:{padding:"10px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:v?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:v?.6:1},children:v?r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fas fa-spinner fa-spin"}),"Creating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"fas fa-plus"}),"Create Incident"]})})]})]})})}function Ty({open:e,incident:t,onClose:n,onUpdate:s,onResolve:o,onDelete:a,canDelete:l=!1,footerExtras:d=null}){var B;const[u,f]=_.useState(!1),[m,g]=_.useState(""),[y,k]=_.useState(""),[v,x]=_.useState(""),[C,j]=_.useState(!1);if(!e||!t)return null;const w=A=>A?new Date(A).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",N=A=>A==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(A),b=()=>{g(t.status||"Pending"),k(t.resolutionNotes||""),x(t.costIncurred||""),f(!0)},T=async()=>{j(!0);try{const A=new FormData;m&&A.append("status",m),y&&A.append("resolutionNotes",y),v&&A.append("costIncurred",v),await s(t.id,A),f(!1)}catch(A){alert((A==null?void 0:A.message)||"Failed to update incident")}finally{j(!1)}},I=async()=>{if(window.confirm("Mark this incident as resolved?")){j(!0);try{await o(t.id,y,v||0),n()}catch(A){alert((A==null?void 0:A.message)||"Failed to resolve incident")}finally{j(!1)}}},R=async()=>{if(window.confirm("Are you sure you want to delete this incident? This action cannot be undone.")){j(!0);try{await a(t.id),n()}catch(A){alert((A==null?void 0:A.message)||"Failed to delete incident")}finally{j(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",background:"#fef9e7",border:"2px solid #d4af37",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsxs("div",{style:{textAlign:"center",borderBottom:"3px double #d4af37",paddingBottom:"20px",marginBottom:"24px"},children:[r.jsx("h2",{style:{margin:"0 0 8px 0",fontFamily:"Georgia, serif",color:"#1f2937",fontSize:"28px",fontWeight:"bold"},children:"INCIDENT REPORT"}),r.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",fontFamily:"Georgia, serif"},children:"Official Documentation"}),t.status?r.jsx("div",{style:{display:"inline-block",marginTop:"12px",padding:"6px 16px",background:t.status==="Resolved"?"#d1fae5":t.status==="InProgress"?"#dbeafe":"#fef3c7",color:t.status==="Resolved"?"#065f46":t.status==="InProgress"?"#1e40af":"#92400e",borderRadius:"20px",fontSize:"13px",fontWeight:"600",border:`2px solid ${t.status==="Resolved"?"#10b981":t.status==="InProgress"?"#3b82f6":"#f59e0b"}`},children:(B=t.status)==null?void 0:B.toUpperCase()}):null]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"24px",fontFamily:"Georgia, serif"},children:[r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Report ID:"}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.id})]}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Reported Date:"}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px"},children:w(t.reportedAt)})]}),r.jsxs("div",{children:[r.jsxs("strong",{style:{color:"#4b5563",fontSize:"14px"},children:[t.creatorStation?"Creator Station":"Booking Reference",":"]}),r.jsx("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:t.creatorStation?t.creatorStation:t.bookingId?`${String(t.bookingId).slice(0,16)}...`:""})]}),t.stationId&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"14px"},children:"Station ID:"}),r.jsxs("div",{style:{color:"#1f2937",marginTop:"4px",fontFamily:"monospace"},children:[t.stationId.slice(0,16),"..."]})]})]}),r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[r.jsx("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Incident Description:"}),r.jsx("p",{style:{color:"#1f2937",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.description})]}),t.images&&t.images.length>0&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs("strong",{style:{color:"#4b5563",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:["Evidence Photos (",t.images.length,"):"]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:t.images.map((A,E)=>r.jsx("a",{href:A,target:"_blank",rel:"noopener noreferrer",style:{display:"block"},children:r.jsx("img",{src:A,alt:`Evidence ${E+1}`,style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",border:"2px solid #d4af37",cursor:"pointer",transition:"transform 0.2s"},onMouseOver:M=>M.currentTarget.style.transform="scale(1.05)",onMouseOut:M=>M.currentTarget.style.transform="scale(1)"})},E))})]}),u?r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"white",borderRadius:"8px",border:"2px solid #3b82f6"},children:[r.jsx("strong",{style:{fontSize:"16px",display:"block",marginBottom:"12px"},children:"Update Incident:"}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Status:"}),r.jsxs("select",{value:m,onChange:A=>g(A.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"},children:[r.jsx("option",{value:"Pending",children:"Pending"}),r.jsx("option",{value:"InProgress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"})]})]}),r.jsxs("div",{style:{marginBottom:"12px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Resolution Notes:"}),r.jsx("textarea",{value:y,onChange:A=>k(A.target.value),rows:4,placeholder:"Enter resolution details...",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Cost Incurred (VND):"}),r.jsx("input",{type:"number",value:v,onChange:A=>x(A.target.value),placeholder:"0",min:"0",style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #d1d5db",fontSize:"14px"}})]})]}):r.jsxs(r.Fragment,{children:[t.resolutionNotes&&r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#d1fae5",borderRadius:"8px",border:"1px solid #10b981"},children:[r.jsx("strong",{style:{color:"#065f46",fontSize:"16px",display:"block",marginBottom:"12px",fontFamily:"Georgia, serif"},children:"Resolution Notes:"}),r.jsx("p",{style:{color:"#047857",lineHeight:"1.6",margin:0,fontSize:"15px",whiteSpace:"pre-wrap"},children:t.resolutionNotes})]}),t.costIncurred!=null&&r.jsxs("div",{style:{marginBottom:"24px",padding:"16px",background:"#fee2e2",borderRadius:"8px",border:"1px solid #dc2626"},children:[r.jsx("strong",{style:{color:"#991b1b",fontSize:"16px",display:"block",marginBottom:"8px",fontFamily:"Georgia, serif"},children:"Cost Incurred:"}),r.jsx("div",{style:{color:"#dc2626",fontSize:"24px",fontWeight:"bold",fontFamily:"Georgia, serif"},children:N(t.costIncurred)})]})]}),r.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"20px",borderTop:"2px solid #e5e7eb",flexWrap:"wrap"},children:d||(u?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>f(!1),disabled:C,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer",opacity:C?.6:1},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]}),r.jsxs("button",{onClick:T,disabled:C,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer",opacity:C?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",C?"Saving...":"Save Changes"]})]}):r.jsxs(r.Fragment,{children:[l&&r.jsxs("button",{onClick:R,disabled:C,style:{padding:"10px 20px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer",marginRight:"auto"},children:[r.jsx("i",{className:"fas fa-trash"})," Delete"]}),t.status!=="Resolved"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:b,disabled:C,style:{padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit"]}),r.jsxs("button",{onClick:I,disabled:C,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:C?"not-allowed":"pointer"},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",C?"Resolving...":"Mark Resolved"]})]}),r.jsx("button",{onClick:n,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Close"})]}))})]})})}function FS({incidents:e=[],bookings:t=[],onCreateIncident:n,onUpdateIncident:s,onResolveIncident:o,onDeleteIncident:a,onRefresh:l,canDelete:d=!0,stationFilter:u=null}){const[f,m]=_.useState(!1),[g,y]=_.useState(!1),[k,v]=_.useState(null),[x,C]=_.useState(""),[j,w]=_.useState(""),N=e.filter(A=>{if(x&&A.status!==x)return!1;if(j){const E=j.toLowerCase(),M=(A.description||"").toLowerCase(),G=(A.id||"").toLowerCase(),Y=(A.bookingId||"").toLowerCase();if(!M.includes(E)&&!G.includes(E)&&!Y.includes(E))return!1}return!0}),b=A=>{v(A),y(!0)},T=async A=>{await n(A)},I=async(A,E)=>{await s(A,E),l&&await l(),y(!1)},R=async(A,E,M)=>{await o(A,E,M),l&&await l()},B=async A=>{await a(A),l&&await l()};return r.jsxs("div",{id:"incident",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsxs("button",{className:"incident-add-btn",onClick:()=>m(!0),children:[r.jsx("i",{className:"fas fa-plus"})," Report Incident"]}),r.jsxs("div",{className:"incident-filters",style:{flex:1,display:"flex",gap:"12px"},children:[r.jsxs("select",{className:"incident-filter-select",value:x,onChange:A=>C(A.target.value),children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"Pending",children:"Pending"}),r.jsx("option",{value:"InProgress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"})]}),r.jsx("input",{className:"incident-search-input",type:"text",placeholder:"Search by description, ID, or booking...",value:j,onChange:A=>w(A.target.value)})]})]}),r.jsx("div",{style:{padding:"8px 8px 16px",color:"#6b7280",fontSize:"14px",fontWeight:"500"},children:N.length===0?"No incidents found":`Showing ${N.length} incident${N.length>1?"s":""}`}),N.length>0?r.jsx("div",{className:"incident-grid",children:N.map(A=>r.jsx(Ey,{incident:A,onClick:b},A.id))}):r.jsxs("div",{className:"incident-empty-state",children:[r.jsx("i",{className:"fas fa-clipboard-check"}),r.jsx("h3",{children:"No Incidents"}),r.jsx("p",{children:j||x?"No incidents match your filters":"No incidents have been reported yet"})]}),r.jsx(MS,{open:f,onClose:()=>m(!1),onSubmit:T,bookings:t}),r.jsx(Ty,{open:g,incident:k,onClose:()=>y(!1),onUpdate:I,onResolve:R,onDelete:B,canDelete:d})]})}const US=[],OS=[];function DS(){var ze,pe,nt,sn;const[e,t]=_.useState("booking"),[n,s]=_.useState(US),[o,a]=_.useState(OS),[l,d]=_.useState(()=>{try{const he=localStorage.getItem("staff_sidebar_visible");return he==null?!0:he==="1"}catch{return!0}}),[u,f]=_.useState(""),[m,g]=_.useState(""),[y,k]=_.useState([]),[v,x]=_.useState([]),[C,j]=_.useState(!1),[w,N]=_.useState(""),[b,T]=_.useState(!1),[I,R]=_.useState(!1),[B,A]=_.useState(!1),[E,M]=_.useState(""),[G,Y]=_.useState(""),[z,X]=_.useState(""),[K,F]=_.useState(null),$=async he=>{try{await We.confirmBooking(he.id,"Cash",""),s(oe=>oe.map(le=>le.id===he.id?{...le,status:"booked"}:le))}catch(oe){M((oe==null?void 0:oe.message)||"Failed to proceed to payment")}},ge=async(he,oe="")=>{var le;try{await We.cancelBooking(he.id,oe||""),s(ye=>ye.map(de=>de.id===he.id?{...de,status:"denied"}:de))}catch(ye){const de=(le=ye==null?void 0:ye.response)==null?void 0:le.status;if(de===401||de===403){alert("You don't have permission to cancel this booking.");return}M((ye==null?void 0:ye.message)||"Failed to cancel booking")}},re=async(he,oe)=>{let le=oe;try{if(le==null)try{const de=await We.getBookingById(he),ke=(de==null?void 0:de.statusCode)??(de==null?void 0:de.StatusCode)??(de==null?void 0:de.bookingStatus)??(de==null?void 0:de.BookingStatus)??(de==null?void 0:de.status)??(de==null?void 0:de.Status);if(ke!=null&&(typeof ke=="number"||/^\d+$/.test(String(ke)))){const tt=Number(ke);tt===0?le="pending":tt===1?le="booked":tt===2?le="waiting-checkin":tt===3?le="checked-in":tt===4?le="checkout-pending":tt===5?le="completed":tt===6?le="cancelled-pending":tt===7&&(le="cancelled")}else{const tt=String(ke||"").toLowerCase();tt.includes("pending")||tt.includes("wait")?le="pending":tt.includes("check")&&tt.includes("in")?le="checked-in":tt.includes("complete")||tt.includes("finish")?le="completed":tt.includes("cancel")?le="cancelled":le="booked"}}catch(de){console.warn(" Failed to refresh booking status for",he,(de==null?void 0:de.message)||de)}}catch(de){console.warn(" Error resolving status for booking update:",(de==null?void 0:de.message)||de)}const ye=le==="pending"?"Pending":le==="booked"?"Active Rental":le==="waiting-checkin"?"Waiting Check-in":le==="checked-in"?"Checked-in":le==="checkout-pending"?"Check-out Pending":le==="completed"?"Completed":le==="cancelled-pending"?"Cancelled (Pending Refund)":le==="cancelled"?"Cancelled":le;le!==void 0&&s(de=>de.map(ke=>ke.id===he?{...ke,status:le,statusLabel:ye}:ke))},fe=async he=>{var oe;try{const le=he.get("bookingId")||"",ye=he.get("description")||"";let de=[];try{de=he.getAll?he.getAll("images"):[]}catch{de=[]}const ke=await We.createIncident(le,ye,de);try{alert("Incident gi thnh cng. Cm n bn.")}catch{}return ke}catch(le){throw console.error(" create incident failed",((oe=le==null?void 0:le.response)==null?void 0:oe.data)||(le==null?void 0:le.message)||le),le}},_e=async he=>{if(!he){x([]);return}j(!0);try{const oe=await We.getAllIncidents(he,null,null,null,1,200),ye=((oe==null?void 0:oe.incidents)||[]||[]).map(de=>({id:de.id||de.Id||de.incidentId||de.IncidentId||de._id&&String(de._id),description:de.description||de.Description||de.details||"",bookingId:de.bookingId||de.BookingId||de.booking||null,images:de.images||de.Images||[],status:de.status||de.Status||"Pending",reportedAt:de.reportedAt||de.ReportedAt||de.createdAt||de.CreatedAt||de.date||null,costIncurred:de.costIncurred??de.CostIncurred??de.cost??null,stationId:de.stationId||de.StationId||null,raw:de}));x(ye)}catch(oe){console.error(" failed to load incidents for station",oe),x([])}finally{j(!1)}},se=async(he,oe)=>{try{await We.updateIncident(he,oe),await _e(w)}catch(le){throw console.error(" update incident failed",le),le}},O=async(he,oe,le)=>{try{await We.resolveIncident(he,oe,Number(le)||0),await _e(w)}catch(ye){throw console.error(" resolve incident failed",ye),ye}},ne=async he=>{try{await We.deleteIncident(he),await _e(w)}catch(oe){throw console.error(" delete incident failed",oe),oe}},q=async he=>{try{if(!w){M("Please select a station before creating a vehicle.");return}const oe={...he};oe.currentStationId=w,oe.stationId=w,oe.StationId=w,oe.rentalPricePerDate!=null&&oe.rentalPricePerDay==null&&(oe.rentalPricePerDay=oe.rentalPricePerDate),oe.rentalPricePerDay!=null&&oe.rentalPricePerDate==null&&(oe.rentalPricePerDate=oe.rentalPricePerDay),oe.batteryCapacity!=null&&oe.BatteryCapacity==null&&(oe.BatteryCapacity=oe.batteryCapacity),oe.currentBatteryLevel!=null&&oe.CurrentBatteryLevel==null&&(oe.CurrentBatteryLevel=oe.currentBatteryLevel);const le=await We.createCar(oe),ye=le||{},de=ke=>({id:ke.id||ke.Id||ke.carId||ke.CarId,name:ke.name||ke.Name||[ke.brand,ke.model].filter(Boolean).join(" ")||"Car",model:ke.model||ke.Model||null,brand:ke.brand||ke.Brand||null,licensePlate:ke.licensePlate||ke.LicensePlate||null,img:ke.imageUrl||ke.image||ke.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(ke.name||ke.Name||ke.model||"Car")}`,battery:Number.isFinite(ke.currentBatteryLevel)?Math.round(ke.currentBatteryLevel):void 0,tech:ke.condition??ke.status??ke.Status??null,issue:ke.issue??ke.issueDescription??null,capacity:ke.batteryCapacity??ke.BatteryCapacity??ke.capacity??ke.capacityKWh??ke.batteryCapacityKWh??null});return a(ke=>[...ke,de(ye)]),await Ne(w),le}catch(oe){throw M((oe==null?void 0:oe.message)||"Failed to create vehicle"),oe}},we=async he=>{var oe;try{await We.deleteCar(he),a(le=>le.filter(ye=>ye.id!==he)),await Ne(w)}catch(le){const ye=(oe=le==null?void 0:le.response)==null?void 0:oe.status;if(ye===401||ye===403){Y("You don't have permission to delete vehicles. Please contact an administrator.");return}try{const de=["Deleted","Inactive","Removed","Unavailable","Deactivated"];let ke=!1;for(const tt of de)try{await We.updateStatus(he,tt),ke=!0;break}catch{}if(ke){a(tt=>tt.filter(Qn=>Qn.id!==he));return}}catch{}M((le==null?void 0:le.message)||"Failed to delete vehicle")}},Le=async(he,oe)=>{try{if(oe.battery!==void 0&&oe.battery!==""){let le=Number(oe.battery);Number.isNaN(le)||(le=Math.max(0,Math.min(100,Math.round(le))),await We.updateBatteryLevel(he,le))}if(oe.tech&&await We.updateStatus(he,oe.tech),oe.issue)try{await We.updateCarDescription(he,oe.issue)}catch{await We.updateCar(he,{description:oe.issue})}}catch(le){M((le==null?void 0:le.message)||"Failed to update vehicle")}a(le=>le.map(ye=>ye.id===he?{...ye,...oe}:ye))},Ne=async he=>{if(!he){F(null);return}try{const oe=await We.getCarStatusReport(he,null);oe&&F({totalCars:oe.totalCars||0,availableCars:oe.availableCars||0})}catch(oe){console.warn("Failed to load station slots:",oe)}};_.useEffect(()=>{l?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[l]),_.useEffect(()=>{try{localStorage.setItem("staff_sidebar_visible",l?"1":"0")}catch{}},[l]);const Se=[{key:"booking",label:"Booking",icon:"fas fa-calendar-alt",onClick:()=>t("booking")},{key:"vehicle",label:"Vehicle",icon:"fas fa-car",onClick:()=>t("vehicle")},{key:"incident",label:"Incident",icon:"fas fa-exclamation-triangle",onClick:()=>t("incident")},{key:"profile",label:"Profile",icon:"fas fa-user-circle",onClick:()=>t("profile")}];return _.useEffect(()=>{let he=!0;async function oe(){try{const ye=await authApi.getMe(),de=(ye==null?void 0:ye.role)||(ye==null?void 0:ye.Role)||(ye==null?void 0:ye.roleName)||(ye==null?void 0:ye.userRole)||(Array.isArray(ye==null?void 0:ye.roles)?ye.roles[0]:"");he&&X(de||"")}catch{try{const ye=localStorage.getItem("token");if(ye){const de=decodeJwt(ye),ke=(de==null?void 0:de.role)||(de==null?void 0:de.Role)||de["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];he&&X(ke||"")}}catch{}}}async function le(){try{R(!0);const ye=localStorage.getItem("stationId");if(ye){console.log(" Staff assigned station from localStorage:",ye),he&&N(ye);try{const ke=await We.getAllStations(1,100);he&&k(ke||[])}catch(ke){console.warn(" Failed to load stations for display:",ke)}return}console.warn(" No stationId found in localStorage for staff user");const de=await We.getAllStations(1,100);if(!he)return;k(de||[])}catch(ye){if(!he)return;M((ye==null?void 0:ye.message)||"Failed to load stations")}finally{he&&R(!1)}}return oe(),le(),()=>{he=!1}},[]),_.useEffect(()=>{let he=!0;async function oe(){try{T(!0);let ye=[];if(w){let Ie=[],D=[];try{Ie=await We.getCarsByStation(w)}catch{}try{D=await We.getAvailableCarsByStation(w)}catch{}const Ke=Ae=>Array.isArray(Ae)?Ae:Ae?[Ae]:[],Ve=Ke(Ie),Ee=Ke(D),ie=new Map;for(const Ae of[...Ve,...Ee]){const ot=String((Ae==null?void 0:Ae.id)||(Ae==null?void 0:Ae.Id)||(Ae==null?void 0:Ae.carId)||(Ae==null?void 0:Ae.CarId)||(Ae==null?void 0:Ae.licensePlate)||(Ae==null?void 0:Ae.LicensePlate)||Math.random());ie.has(ot)||ie.set(ot,Ae)}ye=Array.from(ie.values());try{const Ae=await We.getAllCars(1,1e3),ot=Me=>Me==null?"":String(Me).replace(/[{}]/g,"").toLowerCase(),At=ot(w),Sn=(Ae||[]).filter(Me=>{var Xn,Cn,Et,rt;return[Me.currentStationId,Me.CurrentStationId,Me.currentStationID,Me.stationId,Me.StationId,Me.stationID,(Xn=Me.station)==null?void 0:Xn.id,(Cn=Me.station)==null?void 0:Cn.Id,(Et=Me.station)==null?void 0:Et.stationId,(rt=Me.station)==null?void 0:rt.StationId].some(Or=>Or!=null&&ot(Or)===At)});for(const Me of Sn){const ut=String((Me==null?void 0:Me.id)||(Me==null?void 0:Me.Id)||(Me==null?void 0:Me.carId)||(Me==null?void 0:Me.CarId)||(Me==null?void 0:Me.licensePlate)||(Me==null?void 0:Me.LicensePlate));ut&&!ie.has(ut)&&ie.set(ut,Me)}ye=Array.from(ie.values())}catch{}}else try{ye=await We.getAllCars(1,1e3)}catch{try{ye=await We.listCars({page:1,pageSize:1e3})}catch{ye=[]}}if(Array.isArray(ye)||(ye=ye?[ye]:[]),!he)return;const de=Ie=>{const D=Number(Ie);return Number.isFinite(D)&&D>=0&&D<=100?Math.round(D):null},ke=(ye||[]).map(Ie=>{var Ae,ot,At,Sn;const Ke=((...Me)=>Me.find(ut=>ut!=null&&ut!==""))(Ie.currentStationId,Ie.CurrentStationId,Ie.currentStationID,Ie.stationId,Ie.StationId,Ie.stationID,(Ae=Ie.station)==null?void 0:Ae.id,(ot=Ie.station)==null?void 0:ot.Id,(At=Ie.station)==null?void 0:At.stationId,(Sn=Ie.station)==null?void 0:Sn.StationId),Ve=Me=>Me==null?"":String(Me).replace(/[{}]/g,"").toLowerCase(),Ee=Ke||"",ie=(()=>{if(!Ee)return null;const Me=y.find(ut=>Ve(ut.id||ut.Id)===Ve(Ee))||null;return Me&&(Me.name||Me.Name)||null})();return{id:Ie.id||Ie.Id||Ie.carId||Ie.CarId,name:Ie.name||Ie.Name||Ie.model||Ie.CarName||"Car",model:Ie.model||Ie.Model||null,brand:Ie.brand||Ie.Brand||null,licensePlate:Ie.licensePlate||Ie.LicensePlate||null,img:Ie.imageUrl||Ie.image||Ie.thumbnailUrl||`https://via.placeholder.com/440x280?text=${encodeURIComponent(Ie.name||Ie.Name||"Car")}`,battery:de(Ie.currentBatteryLevel??Ie.CurrentBatteryLevel??Ie.batteryPercent??Ie.battery),tech:Ie.condition??Ie.status??Ie.Status??null,issue:Ie.issue??Ie.issueDescription??null,capacity:Ie.batteryCapacity??Ie.BatteryCapacity??Ie.capacity??Ie.capacityKWh??Ie.batteryCapacityKWh??null,stationId:Ee,stationName:ie||null}});a(ke);const tt=ke.filter(Ie=>Ie.battery==null),Qn=ke.filter(Ie=>Ie.capacity==null);if(tt.length>0)try{const Ie=await Promise.all(tt.map(async D=>{try{const Ke=await We.getCarBattery(D.id);return{id:D.id,battery:de(Ke)}}catch{return{id:D.id,battery:null}}}));if(!he)return;a(D=>D.map(Ke=>{const Ve=Ie.find(Ee=>Ee.id===Ke.id);return Ve&&Ve.battery!=null?{...Ke,battery:Ve.battery}:Ke}))}catch{}if(Qn.length>0)try{const Ie=await Promise.all(Qn.map(async D=>{try{const Ke=await We.getCarCapacity(D.id);return{id:D.id,capacity:Ke}}catch{return{id:D.id,capacity:null}}}));if(!he)return;a(D=>D.map(Ke=>{const Ve=Ie.find(Ee=>Ee.id===Ke.id);return Ve&&Ve.capacity!=null?{...Ke,capacity:Ve.capacity}:Ke}))}catch{}}catch(ye){if(!he)return;M((ye==null?void 0:ye.message)||"Failed to load vehicles")}finally{he&&T(!1)}}async function le(){he&&await Ne(w)}return oe(),le(),()=>{he=!1}},[w,y]),_.useEffect(()=>{let he=!0;async function oe(){try{A(!0);let le=[];if(w){console.log(" Loading active bookings for station:",w);try{le=await We.getBookingsByStation(w,1,200),console.log(" Loaded active bookings:",le==null?void 0:le.length)}catch(D){console.error(" Error loading bookings:",D),le=[]}}else console.warn(" No station ID set"),le=[];if(!he)return;const ye=(le||[]).map(D=>{var Hi,V,ee,ae,ce,Be,Ue,je,ve,ft,H,Re,$e,xe,W,Ze,lt,Pe,jt,an,on,Nn,xr,Mt,kt,bt,Un,Zi,Vi,Dr,On,zr,$r,Dn,qe,it,tr,kn,bn,vr,Oe,ct,_r,nr,Ft,vi,rr;const Ke=D.id||D.Id||D.bookingId||D.BookingId,Ve=((Hi=D.car)==null?void 0:Hi.brand)||((V=D.car)==null?void 0:V.Brand)||((ee=D.vehicle)==null?void 0:ee.brand)||((ae=D.vehicle)==null?void 0:ae.Brand)||D.carBrand||D.CarBrand||null,Ee=((ce=D.car)==null?void 0:ce.model)||((Be=D.car)==null?void 0:Be.Model)||((Ue=D.vehicle)==null?void 0:Ue.model)||((je=D.vehicle)==null?void 0:je.Model)||D.carModel||D.CarModel||null;let ie=D.carName||D.vehicleName||((ve=D.car)==null?void 0:ve.name)||((ft=D.car)==null?void 0:ft.Name)||null;!ie&&(Ve||Ee)&&(ie=[Ve,Ee].filter(Boolean).join(" ").trim()||null),!ie&&typeof D.carInfo=="string"&&D.carInfo.trim()&&(ie=D.carInfo.trim()),!ie&&typeof D.CarInfo=="string"&&D.CarInfo.trim()&&(ie=D.CarInfo.trim()),ie=ie||"Booking";const Ae=((H=D.user)==null?void 0:H.firstName)||((Re=D.customer)==null?void 0:Re.firstName)||D.firstName||D.FirstName||(($e=D.user)==null?void 0:$e.FirstName)||((xe=D.customer)==null?void 0:xe.FirstName),ot=((W=D.user)==null?void 0:W.lastName)||((Ze=D.customer)==null?void 0:Ze.lastName)||D.lastName||D.LastName||((lt=D.user)==null?void 0:lt.LastName)||((Pe=D.customer)==null?void 0:Pe.LastName),At=[Ae,ot].filter(Boolean).join(" "),Sn=At||D.customerName||D.userFullName||((jt=D.user)==null?void 0:jt.fullName)||((an=D.customer)==null?void 0:an.name)||((on=D.user)==null?void 0:on.name)||"Customer",Me=D.userId||D.UserId||((Nn=D.user)==null?void 0:Nn.id)||((xr=D.user)==null?void 0:xr.Id)||D.customerId||D.CustomerId||D.appUserId||D.AppUserId||D.accountId||D.AccountId||D.UserID||D.ownerId||D.OwnerId||D.createdById||D.CreatedById||"",ut=((Mt=D.user)==null?void 0:Mt.userName)||((kt=D.user)==null?void 0:kt.UserName)||((bt=D.user)==null?void 0:bt.username)||D.userName||D.UserName||D.username||null,Xn=((Un=D.user)==null?void 0:Un.email)||D.customerEmail||D.email||D.userEmail||"",Cn=((Zi=D.user)==null?void 0:Zi.address)||D.customerAddress||D.address||"",Et=D.statusCode??D.StatusCode??D.bookingStatus??D.BookingStatus??D.status??D.Status;let rt="booked";if(Et!=null&&(typeof Et=="number"||/^\d+$/.test(String(Et)))){const Je=Number(Et);Je===0?rt="pending":Je===1?rt="booked":Je===2?rt="waiting-checkin":Je===3?rt="checked-in":Je===4?rt="checkout-pending":Je===5?rt="completed":Je===6?rt="cancelled-pending":Je===7&&(rt="cancelled")}else{const Je=String(Et||"").toLowerCase();Je.includes("pending")||Je.includes("wait")?rt="pending":Je.includes("check")&&Je.includes("in")?rt="checked-in":Je.includes("complete")||Je.includes("finish")?rt="completed":Je.includes("cancel")?rt="cancelled":rt="booked"}const Or=rt==="pending"?"Pending":rt==="booked"?"Active Rental":rt==="waiting-checkin"?"Waiting Check-in":rt==="checked-in"?"Checked-in":rt==="checkout-pending"?"Check-out Pending":rt==="completed"?"Completed":rt==="cancelled-pending"?"Cancelled (Pending Refund)":rt==="cancelled"?"Cancelled":String(Et||"")||"Booked",Fn=String(Et||"").toLowerCase(),$i=Number(Et)===0||Fn.includes("pending")||Fn.includes("wait")?"waiting-payment":Fn.includes("check")&&Fn.includes("in")&&(Fn.includes("pay")||Fn.includes("payment"))?"checkin-payment":null;let yr=D.date||D.createdAt||D.bookingDate||"";if(yr)try{const Je=new Date(yr);isNaN(Je.getTime())||(yr=Je.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:void 0}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5"))}catch{}const Hs=D.carImageUrl||((Vi=D.car)==null?void 0:Vi.imageUrl)||((Dr=D.vehicle)==null?void 0:Dr.imageUrl)||`https://via.placeholder.com/440x280?text=${encodeURIComponent(ie)}`,er=Je=>{if(!Je)return null;try{const dt=new Date(Je);if(!isNaN(dt.getTime()))return dt.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+), (\d+):(\d+)/,"$3-$2-$1 $4:$5")}catch{}return Je},Wi=er(D.PickupDateTime||D.pickupDate||D.rentalStartDate||D.startDateTime||D.startDate||D.StartTime||D.startTime||D.Start||D.start),Zs=er(D.ExpectedReturnDateTime||D.returnDate||D.rentalEndDate||D.endDateTime||D.endDate||D.EndTime||D.endTime||D.End||D.end||D.ActualReturnDateTime||D.actualReturnDateTime);return{id:Ke,title:ie,firstName:Ae||null,lastName:ot||null,fullName:At||D.userFullName||((On=D.user)==null?void 0:On.fullName)||((zr=D.customer)==null?void 0:zr.name)||(($r=D.user)==null?void 0:$r.name)||null,customer:Sn,userId:Me,userName:ut,email:Xn,address:Cn,status:rt,statusLabel:Or,uiStage:$i,date:yr,pickupDate:Wi,returnDate:Zs,img:Hs,carId:D.carId||D.CarId||((Dn=D.car)==null?void 0:Dn.id)||((qe=D.car)==null?void 0:qe.Id)||((it=D.vehicle)==null?void 0:it.id)||((tr=D.vehicle)==null?void 0:tr.Id)||null,cccdFrontUrl:D.cccdFrontUrl||D.identityFrontUrl||D.idFrontUrl||D.frontImageUrl||D.frontIdUrl||D.cccdFrontImageUrl||((kn=D.customer)==null?void 0:kn.cccdFrontUrl)||((bn=D.user)==null?void 0:bn.cccdFrontUrl),cccdBackUrl:D.cccdBackUrl||D.identityBackUrl||D.idBackUrl||D.backImageUrl||D.backIdUrl||D.cccdBackImageUrl||((vr=D.customer)==null?void 0:vr.cccdBackUrl)||((Oe=D.user)==null?void 0:Oe.cccdBackUrl),gplxFrontUrl:D.gplxFrontUrl||D.driverLicenseFrontUrl||D.gplxImageUrl_Front||((ct=D.customer)==null?void 0:ct.gplxImageUrl_Front)||((_r=D.user)==null?void 0:_r.gplxImageUrl_Front),gplxBackUrl:D.gplxBackUrl||D.driverLicenseBackUrl||D.gplxImageUrl_Back||((nr=D.customer)==null?void 0:nr.gplxImageUrl_Back)||((Ft=D.user)==null?void 0:Ft.gplxImageUrl_Back),idString:D.customerIdNumber||((vi=D.user)==null?void 0:vi.identityNumber)||"",phone:D.customerPhone||((rr=D.user)==null?void 0:rr.phoneNumber)||""}});s(ye);const de=ye.filter(D=>D.userId&&!(D.firstName&&D.lastName));if(de.length>0)try{const D=Array.from(new Set(de.map(Ee=>Ee.userId))),Ke=await Promise.all(D.map(async Ee=>{try{const ie=await We.getUserById(Ee),Ae=(ie==null?void 0:ie.firstName)||(ie==null?void 0:ie.FirstName)||(ie==null?void 0:ie.givenName)||(ie==null?void 0:ie.GivenName)||null,ot=(ie==null?void 0:ie.lastName)||(ie==null?void 0:ie.LastName)||(ie==null?void 0:ie.surname)||(ie==null?void 0:ie.Surname)||null,At=(ie==null?void 0:ie.fullName)||(ie==null?void 0:ie.FullName)||[Ae,ot].filter(Boolean).join(" ")||null,Sn=(ie==null?void 0:ie.userName)||(ie==null?void 0:ie.UserName)||(ie==null?void 0:ie.username)||(ie==null?void 0:ie.user_name)||null,Me=(ie==null?void 0:ie.address)||(ie==null?void 0:ie.Address)||"";return{uid:Ee,firstName:Ae,lastName:ot,fullName:At,userName:Sn,address:Me}}catch{return{uid:Ee,firstName:null,lastName:null,fullName:null,userName:null,address:""}}}));if(!he)return;const Ve=new Map(Ke.map(Ee=>[Ee.uid,Ee]));s(Ee=>Ee.map(ie=>{if(ie.userId&&Ve.has(ie.userId)){const Ae=Ve.get(ie.userId),ot=ie.fullName||Ae.fullName||[Ae.firstName,Ae.lastName].filter(Boolean).join(" ");return{...ie,firstName:ie.firstName??Ae.firstName??null,lastName:ie.lastName??Ae.lastName??null,fullName:ot||ie.customer||ie.userName||null,userName:ie.userName??Ae.userName,address:ie.address||Ae.address}}return ie}))}catch{}const ke=D=>{var Ke,Ve,Ee,ie;return D.carId||D.CarId||D.vehicleId||D.VehicleId||((Ke=D.car)==null?void 0:Ke.id)||((Ve=D.car)==null?void 0:Ve.Id)||((Ee=D.vehicle)==null?void 0:Ee.id)||((ie=D.vehicle)==null?void 0:ie.Id)},tt=ye.filter(D=>(!D.title||D.title==="Booking")&&ke(D));if(tt.length>0)try{const D=Array.from(new Set(tt.map(ke).filter(Boolean))),Ke=await Promise.all(D.map(async Ee=>{try{let ie=await We.getCarById(Ee);if(!ie||!ie.id&&!ie.Id)try{ie=await We.getCarByIdRest(Ee)}catch{}const Ae=(ie==null?void 0:ie.name)||(ie==null?void 0:ie.Name)||[ie==null?void 0:ie.brand,ie==null?void 0:ie.model].filter(Boolean).join(" ")||null,ot=(ie==null?void 0:ie.imageUrl)||(ie==null?void 0:ie.thumbnailUrl)||null;return{cid:Ee,name:Ae,img:ot}}catch{return{cid:Ee,name:null,img:null}}})),Ve=new Map(Ke.map(Ee=>[String(Ee.cid),Ee]));s(Ee=>Ee.map(ie=>{const Ae=ke(ie),ot=Ae!=null?String(Ae):null;if(ot&&Ve.has(ot)){const At=Ve.get(ot);return{...ie,title:ie.title&&ie.title!=="Booking"?ie.title:At.name||ie.title,img:ie.img||At.img||ie.img}}return ie}))}catch{}const Ie=(D=>D.filter(Ke=>!Ke.title||Ke.title==="Booking"))(ye);if(Ie.length>0)try{const D=await Promise.all(Ie.map(async Ve=>{try{const Ee=await We.getVehicleModelFromBooking(Ve.id),ie=(Ee==null?void 0:Ee.name)||[Ee==null?void 0:Ee.brand,Ee==null?void 0:Ee.model].filter(Boolean).join(" ")||null;return{id:Ve.id,title:ie}}catch{return{id:Ve.id,title:null}}})),Ke=new Map(D.map(Ve=>[Ve.id,Ve.title]));s(Ve=>Ve.map(Ee=>Ke.has(Ee.id)&&Ke.get(Ee.id)?{...Ee,title:Ke.get(Ee.id)}:Ee))}catch{}}catch(le){if(!he)return;M((le==null?void 0:le.message)||"Failed to load bookings")}finally{he&&A(!1)}}return oe(),()=>{he=!1}},[w]),_.useEffect(()=>{_e(w)},[w]),r.jsxs("div",{className:"app-layout",children:[r.jsx(xS,{toggleSidebar:()=>d(he=>!he),sidebarVisible:l}),r.jsx("div",{className:`sidebar-wrapper ${l?"visible":""}`,children:r.jsx(by,{title:"FEC Staff",menuItems:Se,isOpen:l,toggleSidebar:()=>d(he=>!he),onSelect:t,activeKey:e})}),r.jsxs("main",{className:`main-content ${l?"shifted":""}`,children:[G&&r.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:G}),E&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:E}),e==="booking"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((ze=y.find(he=>(he.id||he.Id)===w))==null?void 0:ze.name)||((pe=y.find(he=>(he.id||he.Id)===w))==null?void 0:pe.Name)||w}),B&&r.jsx("span",{children:"Loading bookings"})]}),!B&&n.length===0&&r.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),r.jsx(bS,{bookings:n,search:u,setSearch:f,statusFilter:m,setStatusFilter:g,onContinuePayment:$,onCancelBooking:ge,onStatusUpdated:re})]}),e==="vehicle"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsx("span",{style:{padding:"8px 12px",background:"#f0f0f0",borderRadius:4,fontWeight:500},children:((nt=y.find(he=>(he.id||he.Id)===w))==null?void 0:nt.name)||((sn=y.find(he=>(he.id||he.Id)===w))==null?void 0:sn.Name)||w}),b&&r.jsx("span",{children:"Loading vehicles"})]}),r.jsx(BS,{vehicles:o,onAdd:q,onRemove:we,onUpdate:Le,stationId:w,canDelete:String(z).toLowerCase()==="admin",stationSlots:K})]}),e==="incident"&&r.jsx(FS,{incidents:v,bookings:n,onCreateIncident:fe,onUpdateIncident:se,onResolveIncident:O,onDeleteIncident:ne,onRefresh:async()=>{await _e(w)},canDelete:!0,stationFilter:w}),e==="profile"&&r.jsx(AS,{})]})]})}const zS="modulepreload",$S=function(e){return"/"+e},vp={},WS=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=$S(u),u in vp)return;vp[u]=!0;const f=u.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":zS,f||(g.as="script"),g.crossOrigin="",g.href=u,d&&g.setAttribute("nonce",d),document.head.appendChild(g),f)return new Promise((y,k)=>{g.addEventListener("load",y),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return o.then(l=>{for(const d of l||[])d.status==="rejected"&&a(d.reason);return t().catch(a)})};function HS({toggleSidebar:e,sidebarVisible:t}){return r.jsxs("header",{className:"header-bar",children:[r.jsx("div",{className:"header-left",children:r.jsx("button",{className:"sidebar-toggle","aria-label":t?"Close sidebar":"Open sidebar",onClick:e,children:r.jsx("i",{className:t?"fas fa-times":"fas fa-bars"})})}),r.jsx("div",{className:"header-title",children:"Admin Page"}),r.jsx("a",{className:"header-home-btn",href:"/",children:"Home"})]})}const Rc={createStation:async e=>{if(!e)throw new Error("station is required");try{const t=await te.post("/Stations/Create",e,{headers:{"Content-Type":"application/json"}}),n=t==null?void 0:t.data;if(n&&typeof n=="object"&&"data"in n){if(n.isSuccess===!1){const s=n.message||(Array.isArray(n.errors)?n.errors.join("; "):"Request failed"),o=new Error(s);throw o.body=n,o}return n.data}return n}catch(t){throw t}},updateStation:async(e,t)=>{if(!e)throw new Error("stationId is required");if(!t)throw new Error("station payload is required");const s=`/Stations/Update-By-${encodeURIComponent(e)}`;try{const o=await te.put(s,t,{headers:{"Content-Type":"application/json"}}),a=o==null?void 0:o.data;if(a&&typeof a=="object"&&"data"in a){if(a.isSuccess===!1){const l=a.message||(Array.isArray(a.errors)?a.errors.join("; "):"Request failed"),d=new Error(l);throw d.body=a,d}return a.data}return a}catch(o){throw o}},deleteStation:async e=>{if(!e)throw new Error("stationId is required");const n=`/Stations/Delete-By-${encodeURIComponent(e)}`;try{const s=await te.delete(n),o=s==null?void 0:s.data;if(o&&typeof o=="object"&&"data"in o){if(o.isSuccess===!1){const a=o.message||(Array.isArray(o.errors)?o.errors.join("; "):"Request failed"),l=new Error(a);throw l.body=o,l}return o.data}return o}catch(s){throw s}}},Ac={getFeedbacks:async(e={page:1,pageSize:10,search:"",sortBy:""})=>{var n;const t={pageNumber:e.page??e.pageNumber??1,pageSize:e.pageSize??10};e.search&&(t.search=e.search),e.sortBy&&(t.sortBy=e.sortBy);try{const s=await te.get("/Feedback/Get-All",{params:t}),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(n=s==null?void 0:s.response)==null?void 0:n.status;if(o&&o!==404&&o!==405)throw s;return{items:[],totalCount:0}}}},Te={confirmBooking:Xt.confirmBooking,cancelBooking:Xt.cancelBooking,completeBooking:Xt.completeBooking,getBookingById:Xt.getBookingById,listBookings:async(e={})=>{var t;try{const{page:n=1,pageSize:s=100}=e;console.log(` Listing bookings: page=${n}, pageSize=${s}`);const o=await te.get("/Bookings/Get-All",{params:{pageNumber:n,pageSize:s}}),a=o==null?void 0:o.data;return Array.isArray(a)?a:a!=null&&a.data&&Array.isArray(a.data)?a.data:(t=a==null?void 0:a.data)!=null&&t.data&&Array.isArray(a.data.data)?a.data.data:a!=null&&a.items&&Array.isArray(a.items)?a.items:(console.warn(" No bookings array found in listBookings response"),[])}catch(n){return console.error(" Error listing bookings:",n.message),[]}},createCar:Qe.createCar,deleteCar:Qe.deleteCar,softDeleteCar:Qe.softDeleteCar,restoreCar:Qe.restoreCar,getDeletedCars:Qe.getDeletedCars,updateCar:Qe.updateCar,updateStatus:Qe.updateStatus,updateBatteryLevel:Qe.updateBatteryLevel,updateCarDescription:Qe.updateCarDescription,getAllCars:Qe.getAllCars,getCarById:Qe.getCarById,getAvailableCarsByStation:Qe.getAvailableCarsByStation,getCarStatusReport:We.getCarStatusReport,getCarsByStation:We.getCarsByStation,getAllStations:We.getAllStations,getBookingsByStation:We.getBookingsByStation,createStation:Rc.createStation,updateStation:Rc.updateStation,deleteStation:Rc.deleteStation,getFeedbacks:(Ac==null?void 0:Ac.getFeedbacks)||(async e=>{try{const t=await te.get("/Feedback/Get-All",{params:{pageNumber:(e==null?void 0:e.page)??1,pageSize:(e==null?void 0:e.pageSize)??10,search:(e==null?void 0:e.search)||""}}),n=t==null?void 0:t.data;return n&&typeof n=="object"&&"data"in n?n.data:n||{items:[],totalCount:0}}catch(t){return console.warn(" Failed to load feedbacks:",t.message),{items:[],totalCount:0}}}),getAllUsers:async(e=1,t=100,n=null)=>{var a,l;const s={pageNumber:e,pageSize:t};n&&(s.role=n);const o=[{url:"/Users/Get-All",params:s},{url:"/Admin/Users",params:s},{url:"/users",params:s}];for(const d of o)try{const u=await te.get(d.url,{params:d.params}),f=u==null?void 0:u.data;if(Array.isArray(f))return f;if(Array.isArray((a=f==null?void 0:f.data)==null?void 0:a.data))return f.data.data;if(Array.isArray(f==null?void 0:f.data))return f.data;if(Array.isArray(f==null?void 0:f.items))return f.items}catch(u){const f=(l=u==null?void 0:u.response)==null?void 0:l.status;if(f&&f!==404&&f!==405)throw u}return[]},assignStaffRole:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Assign-Staff-Role${s}`,`/Users/${n}/Assign-Staff-Role${s}`,`/Admin/Users/Assign-Staff-Role${s}`];for(const l of o)try{const d=await te.post(l,t?{userId:e,reason:t}:{userId:e}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Assign staff role endpoint not found")},removeStaffRole:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Remove-Staff-Role${s}`,`/Users/${n}/Remove-Staff-Role${s}`,`/Admin/Users/Remove-Staff-Role${s}`];for(const l of o)try{const d=await te.post(l,t?{userId:e,reason:t}:{userId:e}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Remove staff role endpoint not found")},getStaffByStation:async e=>{var s;if(!e)return[];const t=encodeURIComponent(e),n=[`/Admin/Staff/By-Station/${t}`,`/Staff/By-Station/${t}`,{url:"/Admin/Staff/By-Station",params:{stationId:e}}];for(const o of n)try{const a=typeof o=="string"?await te.get(o):await te.get(o.url,{params:o.params}),l=a==null?void 0:a.data;if(Array.isArray(l))return l;if(Array.isArray(l==null?void 0:l.data))return l.data;if(Array.isArray(l==null?void 0:l.items))return l.items}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return[]},getStationByStaff:async e=>{var s;if(!e)throw new Error("staffId is required");const t=encodeURIComponent(e),n=[`/Admin/Staff/${t}/Station`,`/Staff/${t}/Station`,`/Admin/Users/${t}/Station`,`/Users/${t}/Station`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data,d=l&&typeof l=="object"&&"data"in l?l.data:l;if(d)return d}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}return null},getCustomerProfile:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Customers/${t}/Profile`,`/Admin/Users/${t}/Profile`,`/Users/${t}/Profile`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Customer profile endpoint not found")},getUserDocuments:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Documents`,`/Users/${t}/Documents`];for(const o of n)try{const a=await te.get(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("User documents endpoint not found")},softDeleteUser:async(e,t="")=>{var a;if(!e)throw new Error("userId is required");const n=encodeURIComponent(e),s=t?`?reason=${encodeURIComponent(t)}`:"",o=[`/Admin/Users/${n}/Soft-Delete${s}`,`/Users/${n}/Soft-Delete${s}`];for(const l of o)try{const d=await te.post(l,t?{reason:t}:{}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Soft delete user endpoint not found")},restoreUser:async e=>{var s;if(!e)throw new Error("userId is required");const t=encodeURIComponent(e),n=[`/Admin/Users/${t}/Restore`,`/Users/${t}/Restore`];for(const o of n)try{const a=await te.post(o),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Restore user endpoint not found")},getDeletedAccounts:async(e=1,t=20,n=null)=>{var a;(!e||e<1)&&(e=1),(!t||t<1)&&(t=20);const s=new URLSearchParams({page:e.toString(),pageSize:t.toString()});n&&s.append("role",n);const o=[`/Admin/Users/Deleted-Accounts?${s}`,`/Users/Deleted-Accounts?${s}`];for(const l of o)try{const d=await te.get(l),u=d==null?void 0:d.data,f=u&&typeof u=="object"&&"data"in u?u.data:u;return(f==null?void 0:f.deletedAccounts)||f||[]}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Get deleted accounts endpoint not found")},getAdminDashboard:async()=>{var t;const e=["/Admin/Dashboard","/Dashboard"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}throw new Error("Dashboard endpoint not found")},getFleetOverview:async()=>{var t;const e=["/Admin/Fleet/Overview","/Fleet/Overview"];for(const n of e)try{const s=await te.get(n),o=s==null?void 0:s.data;return o&&typeof o=="object"&&"data"in o?o.data:o}catch(s){const o=(t=s==null?void 0:s.response)==null?void 0:t.status;if(o&&o!==404&&o!==405)throw s}return null},getCarStatusReport:async(e=null,t=null)=>{try{if(!e)return console.warn(" stationId is required for getCarStatusReport"),null;const n=await Te.getCarsByStation(e);return{totalCars:Array.isArray(n)?n.length:0,availableCars:Array.isArray(n)?n.length:0,cars:n||[]}}catch(n){return console.warn(" getCarStatusReport error:",n.message),null}},transferCar:async(e,t,n="")=>{var a;if(!e||!t)throw new Error("carId and targetStationId are required");const s={carId:e,targetStationId:t};n&&(s.reason=n);const o=["/Admin/Fleet/Transfer-Car","/Fleet/Transfer-Car"];for(const l of o)try{const d=await te.post(l,null,{params:s}),u=d==null?void 0:d.data;return u&&typeof u=="object"&&"data"in u?u.data:u}catch(d){const u=(a=d==null?void 0:d.response)==null?void 0:a.status;if(u&&u!==404&&u!==405)throw d}throw new Error("Transfer car endpoint not found")},assignStaffToStation:async(e,t)=>{var s;if(!e||!t)throw new Error("stationId and staffId are required");const n=[{url:`/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}},{url:`/Admin/Stations/${encodeURIComponent(e)}/Assign-Staff`,params:{staffId:t}}];for(const o of n)try{const a=await te.post(o.url,null,{params:o.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Assign staff to station endpoint not found")},unassignStaffFromStation:async e=>{var n;if(!e)throw new Error("staffId is required");const t=[{url:"/Stations/Unassign-Staff",params:{staffId:e}},{url:"/Admin/Stations/Unassign-Staff",params:{staffId:e}}];for(const s of t)try{const o=await te.post(s.url,null,{params:s.params}),a=o==null?void 0:o.data;return a&&typeof a=="object"&&"data"in a?a.data:a}catch(o){const a=(n=o==null?void 0:o.response)==null?void 0:n.status;if(a&&a!==404&&a!==405)throw o}throw new Error("Unassign staff from station endpoint not found")},reassignStaff:async(e,t)=>{var s;if(!e||!t)throw new Error("staffId and toStationId are required");const n=[{url:"/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}},{url:"/Admin/Stations/Reassign-Staff",params:{staffId:e,toStationId:t}}];for(const o of n)try{const a=await te.post(o.url,null,{params:o.params}),l=a==null?void 0:a.data;return l&&typeof l=="object"&&"data"in l?l.data:l}catch(a){const l=(s=a==null?void 0:a.response)==null?void 0:s.status;if(l&&l!==404&&l!==405)throw a}throw new Error("Reassign staff endpoint not found")},post:async(e,t,n={})=>{const s=await te.post(e,t,n);return s==null?void 0:s.data},get:async(e,t={})=>{const n=await te.get(e,t);return n==null?void 0:n.data},put:async(e,t,n={})=>{const s=await te.put(e,t,n);return s==null?void 0:s.data},patch:async(e,t,n={})=>{const s=await te.patch(e,t,n);return s==null?void 0:s.data},delete:async(e,t={})=>{const n=await te.delete(e,t);return n==null?void 0:n.data}};async function ZS(e){if(!e)throw new Error("accessToken is required");const t=`${Di}/Admin/Dashboard`,n=await fetch(t,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${e}`}});if(!n.ok){const s=await n.text();throw new Error(`Request failed: ${n.status} ${s}`)}return n.json()}Te.getAdminDashboardWithToken=ZS;function VS({booking:e,onClose:t,onProceed:n,onCancel:s,onStatusUpdated:o}){var _e,se;const[a,l]=_.useState(!1),[d,u]=_.useState(!1),[f,m]=_.useState(!1),[g,y]=_.useState(!1),[k,v]=_.useState(""),[x,C]=_.useState(!1),[j,w]=_.useState(!1),[N,b]=_.useState(null),[T,I]=_.useState(!1),[R,B]=_.useState(null),[A,E]=_.useState(""),[M,G]=_.useState(""),[Y,z]=_.useState(""),[X,K]=_.useState(null);if(_.useEffect(()=>{if(!e)return;l(!1),u(!1),m(!1),y(!1),v(""),K(null);const O=e.carId||e.CarId;O&&Qe.getCarById(O).then(Se=>{const ze=(Se==null?void 0:Se.imageUrl)||(Se==null?void 0:Se.ImageUrl)||"/Picture/E car 1.jpg";K(ze),console.log(" Loaded car image:",ze)}).catch(Se=>{console.warn(" Failed to load car image:",Se.message),K("/Picture/E car 1.jpg")});const ne=(Se,ze)=>[Se,ze].filter(Boolean).join(" "),q=e.fullName||ne(e.firstName,e.lastName);if(!(!q||/^customer$/i.test(q)||q==="")){v(q);return}if(!e.id)return;let Le=!1;async function Ne(){C(!0);try{const{firstName:Se,lastName:ze}=await Te.getUserNameByBookingId(e.id);Le||v(ne(Se,ze))}catch{}finally{Le||C(!1)}}return Ne(),()=>{Le=!0}},[e]),!e)return null;const F=(e==null?void 0:e.status)==="booked"?a&&d:!1,$=()=>{if(!e)return;const O=window.prompt("Enter a reason for cancellation (optional):","")||"";s==null||s(e,O)},ge=async()=>{var O,ne,q,we,Le;if(e!=null&&e.id){E(""),w(!0);try{const Ne=await Te.createPayment(e.id,"Rental","Rental payment at check-in");try{localStorage.setItem("currentBookingId",e.id)}catch{}const Se=(Ne==null?void 0:Ne.checkoutUrl)||((O=Ne==null?void 0:Ne.data)==null?void 0:O.checkoutUrl)||(Ne==null?void 0:Ne.url)||"",ze=(Ne==null?void 0:Ne.qrCode)||((ne=Ne==null?void 0:Ne.data)==null?void 0:ne.qrCode)||"";if(G(Se),z(ze),b(Ne),Se)try{window.open(Se,"_blank","noopener,noreferrer")}catch{}}catch(Ne){const Se=(q=Ne==null?void 0:Ne.response)==null?void 0:q.status;if(Se&&Se!==400&&Se!==409){w(!1),E(((Le=(we=Ne==null?void 0:Ne.response)==null?void 0:we.data)==null?void 0:Le.message)||(Ne==null?void 0:Ne.message)||"Failed to create payment");return}}w(!1)}},re=async()=>{var O,ne;if(e!=null&&e.id){E(""),w(!0);try{await Te.syncPaymentStatus(e.id),B(new Date);const q=await Te.getBookingById(e.id),we=(q==null?void 0:q.statusCode)??(q==null?void 0:q.StatusCode)??(q==null?void 0:q.bookingStatus)??(q==null?void 0:q.BookingStatus)??(q==null?void 0:q.status)??(q==null?void 0:q.Status),Le=_S(we);if(Le&&Le!==e.status){o==null||o(e.id,Le),t==null||t();return}alert("Synced. Status unchanged; try again shortly if the gateway is still processing.")}catch(q){E(((ne=(O=q==null?void 0:q.response)==null?void 0:O.data)==null?void 0:ne.message)||(q==null?void 0:q.message)||"Retry sync failed")}finally{w(!1)}}},fe=async()=>{var O,ne;if(e!=null&&e.id){I(!0),E("");try{const q=await Te.getPaymentByBooking(e.id);b(q)}catch(q){E(((ne=(O=q==null?void 0:q.response)==null?void 0:O.data)==null?void 0:ne.message)||(q==null?void 0:q.message)||"Unable to load payment info")}finally{I(!1)}}};return r.jsx("div",{id:"bookingModal",className:"modal-overlay",style:{display:"flex"},children:r.jsx("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(920px,95vw)",maxHeight:"90vh",overflow:"auto",margin:"0 auto"},children:r.jsxs(Ly,{booking:e,onClose:t,actions:null,children:[r.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"0 0 220px",textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("img",{id:"modalImage",src:X||"/Picture/E car 1.jpg",alt:"Vehicle",onError:O=>O.currentTarget.src="/Picture/E car 1.jpg",style:{width:"100%",height:160,borderRadius:8,objectFit:"cover",display:"block"}}),r.jsx("h3",{id:"modalTitle",style:{marginTop:12},children:e.title}),r.jsxs("div",{id:"modalStatus",style:{marginTop:6},children:["Status: ",e.statusLabel||e.status]}),r.jsxs("div",{id:"modalVehicle",style:{marginTop:4,color:"#555"},children:["Vehicle: ",e.title||e.carName||e.vehicleName||((_e=e.car)==null?void 0:_e.name)||((se=e.car)==null?void 0:se.Name)||""]}),r.jsxs("div",{id:"modalCustomer",style:{marginTop:6},children:["Customer: ",k||e.fullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||e.customer||(x?"Loading":"")]}),r.jsxs("div",{id:"modalDate",style:{marginTop:2},children:["Date: ",Py(e.date)]})]}),r.jsxs("div",{style:{flex:"1 1 380px",display:"flex",flexDirection:"column",gap:14},children:[r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"ID Number (CMND/CCCD):"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalIDValue",style:{fontWeight:600},children:e.idString||""})})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{style:{fontWeight:600},children:"Address:"}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:r.jsx("span",{id:"modalAddressValue",style:{fontWeight:600},children:e.address||""})})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"CCCD Images:"}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),e.cccdFrontUrl?r.jsx("a",{href:e.cccdFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.cccdFrontUrl,alt:"CCCD Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:a,onChange:O=>l(O.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),e.cccdBackUrl?r.jsx("a",{href:e.cccdBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.cccdBackUrl,alt:"CCCD Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:d,onChange:O=>u(O.target.checked)})," Verified"]})]})]})]}),e.status==="booked"&&r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Driver License (GPLX) Images:"}),r.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Front"}),e.gplxFrontUrl?r.jsx("a",{href:e.gplxFrontUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.gplxFrontUrl,alt:"GPLX Front",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:O=>m(O.target.checked)})," Verified"]})]}),r.jsxs("div",{style:{flex:"1 1 180px",minWidth:160},children:[r.jsx("div",{style:{marginBottom:6},children:"Back"}),e.gplxBackUrl?r.jsx("a",{href:e.gplxBackUrl,target:"_blank",rel:"noreferrer",children:r.jsx("img",{src:e.gplxBackUrl,alt:"GPLX Back",style:{width:"100%",height:120,objectFit:"cover",borderRadius:8,border:"1px solid #eee"}})}):r.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#fafafa",border:"1px dashed #ddd",borderRadius:8,color:"#999"},children:"No image"}),r.jsxs("label",{style:{display:"block",marginTop:6},children:[r.jsx("input",{type:"checkbox",checked:g,onChange:O=>y(O.target.checked)})," Verified"]})]})]})]}),r.jsxs("div",{className:"bg-gray-100",style:{padding:14,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{style:{fontWeight:600},children:"Phone Number:"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{id:"customerPhone",style:{padding:6},children:e.phone||""}),e.phone&&r.jsx("a",{href:`tel:${e.phone}`,style:{background:"#1565c0",color:"#fff",padding:"6px 10px",borderRadius:6,textDecoration:"none"},children:"Call"})]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[e.status==="booked"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{id:"checkInBtn",onClick:()=>n==null?void 0:n(e),disabled:!F,style:{background:F?"#43a047":"#9e9e9e",color:"white",padding:"8px 16px",borderRadius:14},children:"Check In"}),r.jsx("button",{onClick:$,style:{background:"#fb8c00",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Cancel Booking"})]}),e.status==="checked-in"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:ge,disabled:j,style:{background:"#43a047",color:"#fff",padding:"8px 16px",borderRadius:14},children:j?"Processing":"Confirm Check In"}),r.jsx("button",{onClick:re,disabled:j,style:{background:"#1565c0",color:"#fff",padding:"8px 16px",borderRadius:14},children:"Retry Sync"}),r.jsx("button",{onClick:fe,disabled:T,style:{background:"#455a64",color:"#fff",padding:"8px 16px",borderRadius:14},children:T?"Loading":"View Payment Status"})]})]}),A&&r.jsx("div",{style:{marginTop:8,color:"#b00020"},children:A}),R&&r.jsxs("div",{style:{marginTop:4,color:"#555",fontSize:12},children:["Last sync: ",R.toLocaleTimeString()]}),(Y||M)&&r.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #e0e0e0",borderRadius:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Complete Payment"}),Y?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("img",{alt:"Pay QR",src:Y,style:{width:160,height:160,objectFit:"contain",border:"1px solid #eee",borderRadius:6}}),r.jsx("div",{style:{color:"#555"},children:'Scan the QR to pay. After payment completes, use "Retry Sync" to update the booking.'})]}):r.jsx("div",{style:{color:"#555"},children:'Open the checkout to complete your payment, then return and press "Retry Sync".'}),M&&r.jsx("div",{style:{marginTop:10},children:r.jsx("a",{href:M,target:"_blank",rel:"noreferrer",style:{background:"#1565c0",color:"#fff",padding:"8px 14px",borderRadius:10,textDecoration:"none"},children:"Open Checkout"})})]}),N&&r.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid #eee",borderRadius:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Payment"}),r.jsxs("div",{children:["Status: ",String(N.status||N.Status||N.paymentStatus||"")]}),r.jsxs("div",{children:["Gateway: ",String(N.gatewayStatus||N.GatewayStatus||N.providerStatus||"")]}),r.jsxs("div",{children:["Amount: ",N.amount??N.Amount??""]}),r.jsxs("div",{children:["Transaction: ",N.transactionId||N.TransactionId||N.txnId||""]}),r.jsxs("div",{children:["Updated: ",N.updatedAt||N.UpdatedAt||N.lastUpdated||""]})]})]})]}),r.jsxs("div",{id:"modalTransactionInfo",style:{marginTop:24,width:"100%",display:e.status==="completed"?"block":"none"},children:[r.jsx("h4",{children:"Transaction Details"}),r.jsxs("ul",{style:{fontSize:"1rem"},children:[r.jsx("li",{children:"Find rental location on map"}),r.jsx("li",{children:"View available vehicles (type, battery, price)"}),r.jsx("li",{children:"Book in advance or on-site"}),r.jsx("li",{children:"Check-in at counter/app"}),r.jsx("li",{children:"Sign electronic contract"}),r.jsx("li",{children:"Confirm handover with staff (vehicle check, photo)"}),r.jsx("li",{children:"Return vehicle at rental location"}),r.jsx("li",{children:"Staff checks and confirms vehicle condition"}),r.jsx("li",{children:"Pay any additional fees"})]})]})]})})})}function qS({bookings:e,search:t,setSearch:n,statusFilter:s,setStatusFilter:o,onContinuePayment:a,onCancelBooking:l,onStatusUpdated:d}){const[u,f]=_.useState(null),[m,g]=_.useState(null),y=Array.isArray(e)?e.filter(I=>(String(I.title||"").toLowerCase().includes(String(t).toLowerCase())||String(I.customer||"").toLowerCase().includes(String(t).toLowerCase())||String(I.userName||"").toLowerCase().includes(String(t).toLowerCase())||String(I.email||"").toLowerCase().includes(String(t).toLowerCase()))&&(s===""||I.status===s)):[],[k,v]=_.useState({}),[x,C]=_.useState(""),[j,w]=_.useState("asc"),N=I=>{x===I?w(R=>R==="asc"?"desc":"asc"):(C(I),w(I==="date"?"desc":"asc"))},b=I=>{var R,B,A,E;return I.carId||I.CarId||I.vehicleId||I.VehicleId||((R=I.car)==null?void 0:R.id)||((B=I.car)==null?void 0:B.Id)||((A=I.vehicle)==null?void 0:A.id)||((E=I.vehicle)==null?void 0:E.Id)||null};_.useEffect(()=>{let I=!0;const R=new Set;for(const B of y){const A=b(B);!(B.img||B.carImage||A&&k[A])&&A&&R.add(String(A))}if(R.size!==0)return(async()=>{const B=Array.from(R).slice(0,50).map(async A=>{try{const E=await Te.getCarById(A),M=(E==null?void 0:E.imageUrl)||(E==null?void 0:E.ImageUrl)||null;return{cid:A,imageUrl:M}}catch{return{cid:A,imageUrl:null}}});try{const A=await Promise.all(B);if(!I)return;v(E=>{const M={...E};for(const G of A)G.imageUrl&&(M[G.cid]=G.imageUrl);return M})}catch{}})(),()=>{I=!1}},[y]);const T=(()=>{const I=Array.isArray(y)?[...y]:[];if(!x)return I;if(x==="date"){const R=B=>{const A=B.date||B.createdAt||B.bookingDate||"",E=Date.parse(String(A));return Number.isFinite(E)?E:0};return I.sort((B,A)=>j==="asc"?R(B)-R(A):R(A)-R(B)),I}return I.sort((R,B)=>{const A=x==="vehicle"?String(R.title||"").toLowerCase():String(R.fullName||R.customer||"").toLowerCase(),E=x==="vehicle"?String(B.title||"").toLowerCase():String(B.fullName||B.customer||"").toLowerCase();return A===E?0:j==="asc"?A.localeCompare(E):E.localeCompare(A)}),I})();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Search bookings...",value:t,onChange:I=>n(I.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd",flex:"1 1 320px"}}),r.jsxs("select",{value:s,onChange:I=>o(I.target.value),style:{padding:"8px 10px",borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"",children:"All statuses"}),r.jsx("option",{value:"booked",children:"Booked"}),r.jsx("option",{value:"waiting_payment",children:"Waiting Payment"}),r.jsx("option",{value:"checked-in",children:"Checked In"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),T&&T.length>0?r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:800},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"2px solid #eee"},children:[r.jsx("th",{style:{padding:"8px 12px"},children:"Image"}),r.jsxs("th",{style:{padding:"8px 12px",cursor:"pointer"},onClick:()=>N("vehicle"),children:["Vehicle ",x==="vehicle"?j==="asc"?"":"":""]}),r.jsxs("th",{style:{padding:"8px 12px",cursor:"pointer"},onClick:()=>N("customer"),children:["Customer ",x==="customer"?j==="asc"?"":"":""]}),r.jsx("th",{style:{padding:"8px 12px"},children:"Phone / Email"}),r.jsx("th",{style:{padding:"8px 12px"},children:"Status"}),r.jsxs("th",{style:{padding:"8px 12px",cursor:"pointer"},onClick:()=>N("date"),children:["Date ",x==="date"?j==="asc"?"":"":""]}),r.jsx("th",{style:{padding:"8px 12px",width:220},children:"Actions"})]})}),r.jsx("tbody",{children:T.map(I=>r.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:r.jsx("img",{src:I.img||I.carImage||k[String(b(I))]||Ku(I.img)||"/Picture/E car 1.jpg",alt:I.title,onError:R=>Yu(R.currentTarget),style:{width:100,height:56,objectFit:"cover",borderRadius:6}})}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:I.title}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:I.fullName||[I.firstName,I.lastName].filter(Boolean).join(" ")||I.customer||""}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:I.phone||I.email||""}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:(()=>{const R=(I.status||"").toString().toLowerCase(),B=R.includes("pending")?"booking-status-pending":R.includes("waiting")?"booking-status-waiting-checkin":R.includes("check")&&R.includes("in")?"booking-status-checkedin":R.includes("complete")||R.includes("completed")?"booking-status-completed":R.includes("cancel")||R.includes("denied")?"booking-status-cancelled":"booking-status-booked",A=I.statusLabel||(I.status||"").toString();return r.jsx("span",{className:`booking-status-chip table-status-badge ${B}`,children:A})})()}),r.jsx("td",{style:{padding:"10px 12px",verticalAlign:"middle"},children:I.date||""}),r.jsx("td",{style:{padding:"8px 12px",verticalAlign:"middle"},children:r.jsx("div",{style:{display:"flex",gap:8},children:r.jsx("button",{onClick:()=>f(I),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:"pointer"},children:"Details"})})})]},I.id))})]})}):r.jsx("div",{style:{padding:24,color:"#666"},children:"No bookings found"})]}),r.jsx(VS,{booking:u,onClose:()=>f(null),onProceed:()=>{u&&(g(u),f(null))},onCancel:()=>{u&&(l==null||l(u))},onStatusUpdated:d}),m&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{width:"min(720px,95vw)",maxHeight:"90vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:()=>g(null),children:""}),r.jsx(vS,{booking:m,onClick:()=>f(m)})]})})]})}function GS({vehicle:e,onOpen:t}){return r.jsxs("div",{className:"vehicle-card",onClick:t,style:{cursor:"pointer"},children:[r.jsx("img",{src:e.img,alt:e.name}),r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-title",children:e.name}),r.jsxs("div",{className:"vehicle-station",children:["Station: ",e.stationName||(e.stationId?`ID ${String(e.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{className:"vehicle-battery",children:["Battery: ",e.battery??"N/A","%"]}),r.jsxs("div",{className:"vehicle-capacity",children:["Capacity: ",e.capacity!=null?`${e.capacity} kWh`:"N/A"]}),r.jsxs("div",{className:"vehicle-tech",children:["Condition: ",e.tech??"N/A"]}),r.jsxs("div",{className:"vehicle-issue",children:["Issue: ",e.issue??"None"]})]})]})}function YS({open:e,onClose:t,onSubmit:n,stationId:s}){const[o,a]=_.useState(""),[l,d]=_.useState(""),[u,f]=_.useState(""),[m,g]=_.useState(""),[y,k]=_.useState(""),[v,x]=_.useState(""),[C,j]=_.useState(""),[w,N]=_.useState(""),[b,T]=_.useState(""),[I,R]=_.useState(""),[B,A]=_.useState(null),[E,M]=_.useState(""),G=5*1024*1024,Y=["image/jpeg","image/png","image/webp","image/jpg"];if(!e)return null;async function z(){var _e;if(M(""),!s){M("Please select a station before creating a vehicle.");return}if(!o.trim()||!l.trim()||!m.trim()||!y.trim()||!u||!v||!C||!w||!b||!I){M("Please fill all required fields: Brand, Model, Color, Year, License Plate, Battery Capacity, Current Battery, Seats, Price/hour, Price/day.");return}const X=Number(u),K=Number(v),F=Number(C),$=Number(w),ge=Number(b),re=Number(I);if(!Number.isFinite(X)||X<1900||X>2100){M("Year must be between 1900 and 2100.");return}if(!Number.isFinite(K)||K<0||K>1e4){M("Battery Capacity must be a positive number (kWh).");return}if(!Number.isFinite(F)||F<0||F>100){M("Current Battery must be between 0 and 100 (%).");return}if(!Number.isFinite($)||$<=0||!Number.isFinite(ge)||ge<=0){M("Rental prices must be positive numbers.");return}if(!Number.isFinite(re)||re<=0){M("Seats must be a positive number.");return}if(B){if(!Y.includes(B.type)){M(`Invalid file type. Allowed: ${Y.join(", ")}`);return}if(B.size>G){M(`File size must be less than ${G/1024/1024}MB. Current: ${(B.size/1024/1024).toFixed(2)}MB`);return}}const fe=new FormData;fe.append("Brand",o.trim()),fe.append("Model",l.trim()),fe.append("Year",X),fe.append("Color",m.trim()),fe.append("LicensePlate",y.trim()),fe.append("BatteryCapacity",K),fe.append("CurrentBatteryLevel",F),fe.append("RentalPricePerHour",$),fe.append("RentalPricePerDay",ge),fe.append("Seats",re),fe.append("CurrentStationId",s),B&&(fe.append("CarImage",B,B.name),console.log(" Added CarImage:",B.name,"size:",B.size,"type:",B.type));try{await n(fe),a(""),d(""),f(""),g(""),k(""),x(""),j(""),N(""),T(""),R(""),A(null),t()}catch(se){console.error("Create vehicle error:",se);const O=(_e=se==null?void 0:se.response)==null?void 0:_e.data;let ne=(se==null?void 0:se.message)||"Failed to create vehicle";if(O)if(typeof O=="string")ne=O;else if(O.message)ne=O.message;else if(O.errors)try{const q=Object.keys(O.errors)[0],we=O.errors[q];ne=Array.isArray(we)?we[0]:String(we)}catch{ne=JSON.stringify(O.errors)}else ne=JSON.stringify(O);M(ne||"Failed to create vehicle")}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",width:"90%",maxHeight:"85vh",overflow:"auto"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Add Vehicle"}),E&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:E}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},children:[r.jsx("input",{value:o,onChange:X=>a(X.target.value),placeholder:"Brand *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:l,onChange:X=>d(X.target.value),placeholder:"Model *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:u,onChange:X=>f(X.target.value),placeholder:"Year *",type:"number",min:1900,max:2100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:m,onChange:X=>g(X.target.value),placeholder:"Color *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:y,onChange:X=>k(X.target.value),placeholder:"License Plate *",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:v,onChange:X=>x(X.target.value),placeholder:"Battery Capacity (kWh) *",type:"number",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:C,onChange:X=>j(X.target.value),placeholder:"Current Battery (%) *",type:"number",min:0,max:100,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:w,onChange:X=>N(X.target.value),placeholder:"Price / hour *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:b,onChange:X=>T(X.target.value),placeholder:"Price / day *",type:"number",step:"0.01",min:0,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{value:I,onChange:X=>R(X.target.value),placeholder:"Seats *",type:"number",min:1,style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),r.jsx("input",{type:"file",accept:"image/*",onChange:X=>{var F;const K=((F=X.target.files)==null?void 0:F[0])||null;if(K){if(!Y.includes(K.type)){M(`Invalid file type. Allowed: ${Y.join(", ")}`),A(null);return}if(K.size>G){M(`File size must be less than ${G/1024/1024}MB. Current: ${(K.size/1024/1024).toFixed(2)}MB`),A(null);return}M(""),A(K)}else A(null)},placeholder:"Car Image",style:{padding:"10px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",gridColumn:"1 / -1"}})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:t,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:z,style:{padding:"10px 24px",background:"#43a047",color:"white",border:"none",borderRadius:"6px",fontSize:"15px",fontWeight:"500",cursor:"pointer"},children:"Create Vehicle"})]})]})})}function KS({open:e,onClose:t,vehicle:n,onSubmit:s}){const[o,a]=_.useState(""),[l,d]=_.useState(""),[u,f]=_.useState("");if(_.useEffect(()=>{n&&(a(n.battery??""),d(n.tech??""),f(n.issue??""))},[n]),!e||!n)return null;function m(){s(n.id,{battery:o,tech:l,issue:u}),t()}return r.jsx("div",{className:"vehicle-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"vehicle-modal-content",children:[r.jsx("span",{className:"vehicle-modal-close",onClick:t,children:""}),r.jsx("h3",{children:"Update Vehicle Status / Report Issue"}),r.jsx("label",{children:"Battery Status"}),r.jsx("input",{value:o,onChange:g=>a(g.target.value),placeholder:"e.g. 80"}),r.jsx("label",{children:"Condition"}),r.jsxs("select",{value:l,onChange:g=>d(g.target.value),children:[r.jsx("option",{children:"Open"}),r.jsx("option",{children:"Running"}),r.jsx("option",{children:"Rented"}),r.jsx("option",{children:"Maintained"})]}),r.jsx("label",{children:"Issue"}),r.jsx("textarea",{value:u,onChange:g=>f(g.target.value)}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:m,children:"Submit Update"})})]})})}function JS({open:e,vehicle:t,onClose:n,onEdit:s,onTransfer:o,onUpdate:a,onDelete:l}){const[d,u]=_.useState(!1),[f,m]=_.useState(""),[g,y]=_.useState(""),[k,v]=_.useState(""),[x,C]=_.useState(!0),[j,w]=_.useState(!1);if(!e||!t)return null;const N=t.img,b=()=>{m(t.battery??""),y(t.tech??""),v(t.issue??""),C(t.isAvailable!==!1&&t.isAvailable!==0),u(!0)},T=async()=>{if(a){w(!0);try{await a(t.id,{battery:f,tech:g,issue:k,isAvailable:x}),u(!1)}catch(R){alert((R==null?void 0:R.message)||"Failed to update vehicle")}finally{w(!1)}}},I=()=>{u(!1),m(""),y(""),v(""),C(!0)};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{display:"flex",flexDirection:"column",width:"min(840px, 95vw)",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsx("img",{src:N,alt:t.name,style:{position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.15,filter:"grayscale(10%)",pointerEvents:"none",borderRadius:12}}),r.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",gap:24,flexWrap:"wrap",padding:8},children:[r.jsxs("div",{style:{flex:"1 1 260px",minWidth:240},children:[r.jsx("h3",{style:{marginTop:4},children:t.name}),r.jsx("div",{style:{color:"#555",margin:"6px 0 12px"},children:t.desc||"No description provided."}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Detail:"}),r.jsx("div",{children:t.detail||"N/A"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Station:"})," ",t.stationName||(t.stationId?`ID ${String(t.stationId).slice(0,8)}`:"Unknown")]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Battery:"}),d?r.jsx("input",{type:"number",min:"0",max:"100",value:f,onChange:R=>m(R.target.value),style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"80px"}}):r.jsxs("span",{children:[" ",t.battery??"N/A","%"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Capacity:"})," ",t.capacity!=null?`${t.capacity} kWh`:"N/A"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Condition:"}),d?r.jsx("input",{type:"text",value:g,onChange:R=>y(R.target.value),placeholder:"e.g., Good, Available",style:{marginLeft:"8px",padding:"4px 8px",border:"1px solid #ddd",borderRadius:"4px",width:"150px"}}):r.jsxs("span",{children:[" ",t.tech??"N/A"]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10,marginBottom:10},children:[r.jsx("strong",{children:"Active Status:"}),d?r.jsxs("label",{style:{marginLeft:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"8px"},children:[r.jsx("input",{type:"checkbox",checked:x,onChange:R=>C(R.target.checked),style:{cursor:"pointer",width:"18px",height:"18px"}}),r.jsx("span",{style:{fontSize:"14px"},children:x?" Available":" Unavailable"})]}):r.jsx("span",{style:{marginLeft:"8px",fontWeight:"600",color:t.isAvailable!==!1&&t.isAvailable!==0?"#10b981":"#ef4444"},children:t.isAvailable!==!1&&t.isAvailable!==0?" Available":" Unavailable"})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.85)",padding:12,borderRadius:10},children:[r.jsx("strong",{children:"Issue:"}),d?r.jsx("textarea",{value:k,onChange:R=>v(R.target.value),placeholder:"Describe any issues...",style:{marginTop:"8px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",width:"100%",minHeight:"60px",resize:"vertical",display:"block"}}):r.jsxs("span",{children:[" ",t.issue??"None"]})]})]}),r.jsx("div",{style:{flex:"1 1 300px",minWidth:260,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:N,alt:`${t.name} preview`,style:{width:"100%",maxWidth:380,borderRadius:12,objectFit:"cover",boxShadow:"0 4px 16px rgba(0,0,0,0.12)"}})})]}),r.jsx("div",{style:{position:"relative",zIndex:1,display:"flex",gap:"12px",padding:"16px 8px 8px",justifyContent:"center",flexWrap:"wrap"},children:d?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:T,disabled:j,style:{padding:"10px 24px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:j?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:j?.6:1},children:[r.jsx("i",{className:"fas fa-save"})," ",j?"Saving...":"Save Changes"]}),r.jsxs("button",{onClick:I,disabled:j,style:{padding:"10px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:j?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-times"})," Cancel"]})]}):r.jsxs(r.Fragment,{children:[a&&r.jsxs("button",{onClick:b,style:{padding:"10px 24px",background:"#0ea5e9",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-edit"})," Edit Vehicle"]}),o&&r.jsxs("button",{onClick:()=>{n(),o()},style:{padding:"10px 24px",background:"#8b5cf6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-exchange-alt"})," Transfer Station"]}),l&&r.jsxs("button",{onClick:async()=>{if(confirm("Delete this vehicle?"))try{await l(t.id||t.Id||t.carId),n&&n()}catch(R){alert((R==null?void 0:R.message)||"Delete failed")}},style:{padding:"10px 24px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("i",{className:"fas fa-trash"})," Delete Vehicle"]})]})})]})})}function QS({stationSlots:e}){if(!e)return null;const t=(e==null?void 0:e.totalSlots)??0,n=(e==null?void 0:e.carsCount)??0;return r.jsxs("div",{style:{padding:"8px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"6px",fontSize:"14px",fontWeight:"500",color:"#0369a1"},children:[r.jsx("i",{className:"fas fa-parking"})," ",n," Slot Taken / ",t," Slot"]})}function XS({open:e,onClose:t,vehicle:n,stations:s,currentStationId:o,onSubmit:a}){const[l,d]=_.useState(""),[u,f]=_.useState("Fleet rebalancing"),[m,g]=_.useState(!1);if(!e||!n)return null;const y=s.filter(v=>{const x=v.id||v.Id;return x&&x!==o}),k=async v=>{if(v.preventDefault(),!l){alert("Please select a station");return}g(!0);try{await a(n,l,u),d(""),f("Fleet rebalancing"),t()}catch(x){console.error("Transfer failed:",x)}finally{g(!1)}};return r.jsx("div",{className:"modal-backdrop",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{className:"modal-content",onClick:v=>v.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 10px 40px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[r.jsxs("h2",{style:{margin:0,fontSize:"20px",fontWeight:"600"},children:[r.jsx("i",{className:"fas fa-exchange-alt",style:{marginRight:"8px",color:"#0ea5e9"}}),"Transfer Vehicle"]}),r.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",padding:"0",width:"32px",height:"32px"},children:""})]}),r.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",marginBottom:"20px"},children:[r.jsx("div",{style:{fontWeight:"600",marginBottom:"4px"},children:n.name}),r.jsxs("div",{style:{fontSize:"14px",color:"#6b7280"},children:["Current Station: ",n.stationName||"Unknown"]})]}),r.jsxs("form",{onSubmit:k,children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsxs("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:["Transfer to Station ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsxs("select",{value:l,onChange:v=>d(v.target.value),required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"white"},children:[r.jsx("option",{value:"",children:"-- Select Station --"}),y.map(v=>{const x=v.id||v.Id,C=v.name||v.Name||`Station ${x}`;return r.jsx("option",{value:x,children:C},x)})]})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"8px",fontSize:"14px"},children:"Reason (optional)"}),r.jsx("textarea",{value:u,onChange:v=>f(v.target.value),placeholder:"Enter reason for transfer...",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{style:{display:"flex",gap:"12px"},children:[r.jsx("button",{type:"button",onClick:t,disabled:m,style:{flex:1,padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",background:"white",fontSize:"14px",fontWeight:"500",cursor:m?"not-allowed":"pointer",opacity:m?.6:1},children:"Cancel"}),r.jsx("button",{type:"submit",disabled:m||!l,style:{flex:1,padding:"10px",border:"none",borderRadius:"6px",background:l&&!m?"#0ea5e9":"#9ca3af",color:"white",fontSize:"14px",fontWeight:"500",cursor:l&&!m?"pointer":"not-allowed"},children:m?"Transferring...":"Transfer Vehicle"})]})]})]})})}function e1({vehicles:e,deletedVehicles:t=[],onAdd:n,onRemove:s,onUpdate:o,onRestore:a,stationId:l,canDelete:d=!0,stationSlots:u=null,onTransferCar:f,stations:m}){const[g,y]=_.useState(null),[k,v]=_.useState(!1),[x,C]=_.useState(!1),[j,w]=_.useState(!1),[N,b]=_.useState(!1),[T,I]=_.useState(null),[R,B]=_.useState(""),[A,E]=_.useState("active"),M=e.filter(K=>{if(!R)return!0;const F=R.toLowerCase(),$=(K.name||"").toLowerCase(),ge=(K.model||"").toLowerCase(),re=(K.brand||"").toLowerCase(),fe=(K.licensePlate||"").toLowerCase();return $.includes(F)||ge.includes(F)||re.includes(F)||fe.includes(F)});function G(K){y(K),w(!0)}function Y(K){y(K),v(!0)}function z(K){I(K),b(!0)}const X=async(K,F,$)=>{f&&await f(K,F,$)};return r.jsxs("div",{id:"vehicle",className:"section",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",flexWrap:"wrap"},children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>C(!0),children:[r.jsx("i",{className:"fas fa-plus"})," Add Vehicle"]}),r.jsx("input",{type:"text",placeholder:"Search by name, model, brand, or plate...",value:R,onChange:K=>B(K.target.value),style:{flex:"1",minWidth:"250px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"}}),l&&u&&r.jsx(QS,{stationSlots:u})]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[r.jsx("button",{onClick:()=>E("active"),style:{padding:"6px 12px",borderRadius:8,border:A==="active"?"2px solid #0ea5e9":"1px solid #ddd",background:A==="active"?"#e6f7ff":"white",cursor:"pointer",fontWeight:A==="active"?"600":"normal"},children:"Active"}),r.jsxs("button",{onClick:()=>E("deleted"),style:{padding:"6px 12px",borderRadius:8,border:A==="deleted"?"2px solid #f97316":"1px solid #ddd",background:A==="deleted"?"#fff4e6":"white",cursor:"pointer",fontWeight:A==="deleted"?"600":"normal"},children:["Deleted (",t.length,")"]})]}),r.jsxs("div",{className:"vehicle-grid",id:"vehicleGrid",children:[A==="active"&&(!M||M.length===0)&&r.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:R?"No vehicles match your search.":"No vehicles available to display."}),A==="active"&&M.map((K,F)=>r.jsx("div",{children:r.jsx(GS,{vehicle:K,onOpen:()=>Y(K)})},K.id||K.licensePlate||`${K.name}-${K.stationId||""}-${F}`)),A==="deleted"&&(t&&t.length>0?t.map((K,F)=>r.jsxs("div",{style:{padding:"12px",border:"1px solid #eee",borderRadius:8,background:"#fff",display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:700},children:K.name||K.model||"Vehicle"}),r.jsx("div",{style:{color:"#666",fontSize:13},children:K.licensePlate||""})]}),r.jsx("div",{style:{fontSize:12,color:"#999"},children:K.stationName||""})]}),a&&r.jsx("button",{onClick:async()=>{confirm("Restore this vehicle?")&&await a(K)},style:{background:"#10b981",color:"white",border:"none",padding:"6px 10px",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:"500"},children:" Restore"})]},K.id||K.licensePlate||`${K.name}-${F}`)):r.jsx("div",{style:{padding:"12px 8px",color:"#555"},children:"No deleted vehicles recorded."}))]}),r.jsx(YS,{open:x,onClose:()=>C(!1),onSubmit:n,stationId:l}),r.jsx(KS,{open:j,onClose:()=>w(!1),vehicle:g,onSubmit:o}),r.jsx(JS,{open:k,vehicle:g,onClose:()=>v(!1),onEdit:g?()=>G(g):null,onTransfer:f&&g?()=>z(g):null,onUpdate:o,onDelete:s}),r.jsx(XS,{open:N,onClose:()=>{b(!1),I(null)},vehicle:T,stations:m||[],currentStationId:l,onSubmit:X})]})}function t1({user:e,onClick:t}){const n=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",s=e.email||e.Email||"",o=e.role||e.Role||e.userRole||"Customer",a=e.phoneNumber||e.PhoneNumber||e.phone||"";return r.jsxs("div",{className:"user-card",onClick:t,children:[r.jsx("div",{className:"user-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsxs("div",{className:"user-info",children:[r.jsx("div",{className:"user-name",children:n}),r.jsx("div",{className:"user-email",children:s}),r.jsx("div",{className:"user-role",children:o}),a!==""&&r.jsx("div",{className:"user-phone",children:a})]})]})}function n1({userId:e,userName:t,onClose:n}){const[s,o]=_.useState([]),[a,l]=_.useState(!0),[d,u]=_.useState(""),[f,m]=_.useState(""),[g,y]=_.useState("newest");_.useEffect(()=>{k()},[e]);const k=async()=>{var j,w;try{l(!0),u(""),console.log(" Fetching bookings for user:",e);const N=await Xt.getUserBookings(e);console.log(" Bookings loaded:",N),o(N||[])}catch(N){console.error(" Error loading bookings:",N),u(((w=(j=N==null?void 0:N.response)==null?void 0:j.data)==null?void 0:w.message)||"Failed to load booking history")}finally{l(!1)}},v=j=>{const w={0:{text:"Pending",class:"status-pending",color:"#ff9800"},1:{text:"Active",class:"status-active",color:"#2196f3"},2:{text:"Waiting for check-in",class:"status-waiting",color:"#ff5722"},3:{text:"Checked-in",class:"status-checked-in",color:"#4caf50"},4:{text:"Check-out pending",class:"status-checkout-pending",color:"#9c27b0"},5:{text:"Completed",class:"status-completed",color:"#4caf50"},6:{text:"Cancelled pending refund",class:"status-cancelled-refund",color:"#f44336"},7:{text:"Cancelled",class:"status-cancelled",color:"#9e9e9e"}},N=Number(j);return w[N]||w[0]},x=j=>{if(!j)return"N/A";try{const w=new Date(j);return isNaN(w.getTime())?j:w.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return j}};let C=[...s];return f&&(C=C.filter(j=>String(j.bookingStatus)===f)),C.sort((j,w)=>{switch(g){case"oldest":return new Date(j.createdAt)-new Date(w.createdAt);case"price-high":return(w.totalAmount||0)-(j.totalAmount||0);case"price-low":return(j.totalAmount||0)-(w.totalAmount||0);default:return new Date(w.createdAt)-new Date(j.createdAt)}}),r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:n,children:r.jsxs("div",{style:{background:"white",borderRadius:"12px",width:"100%",maxWidth:"900px",maxHeight:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,marginBottom:"4px"},children:"Booking History"}),r.jsxs("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:["for ",t]})]}),r.jsx("button",{onClick:n,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#999",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),r.jsxs("div",{style:{padding:"15px 20px",borderBottom:"1px solid #eee",display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("label",{style:{fontWeight:500},children:"Status:"}),r.jsxs("select",{value:f,onChange:j=>m(j.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"0",children:"Pending"}),r.jsx("option",{value:"1",children:"Active"}),r.jsx("option",{value:"2",children:"Waiting for check-in"}),r.jsx("option",{value:"3",children:"Checked-in"}),r.jsx("option",{value:"4",children:"Check-out pending"}),r.jsx("option",{value:"5",children:"Completed"}),r.jsx("option",{value:"6",children:"Cancelled pending refund"}),r.jsx("option",{value:"7",children:"Cancelled"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("label",{style:{fontWeight:500},children:"Sort by:"}),r.jsxs("select",{value:g,onChange:j=>y(j.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[r.jsx("option",{value:"newest",children:"Newest"}),r.jsx("option",{value:"oldest",children:"Oldest"}),r.jsx("option",{value:"price-high",children:"Price (High to Low)"}),r.jsx("option",{value:"price-low",children:"Price (Low to High)"})]})]}),r.jsx("button",{onClick:k,style:{padding:"8px 16px",background:"#1976d2",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:" Refresh"})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[a&&r.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[r.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"10px"}}),"Loading bookings..."]}),d&&r.jsxs("div",{style:{background:"#ffebee",color:"#c62828",padding:"15px",borderRadius:"8px",marginBottom:"15px",border:"1px solid #ef5350"},children:[r.jsx("strong",{children:"Error:"})," ",d]}),!a&&C.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[r.jsx("i",{className:"fas fa-inbox",style:{fontSize:"36px",marginBottom:"15px",display:"block"}}),r.jsx("p",{children:"No bookings found"})]}),!a&&C.length>0&&r.jsx("div",{style:{display:"grid",gap:"15px"},children:C.map((j,w)=>{const N=v(j.bookingStatus),b=x(j.startTime||j.pickupDateTime),T=x(j.endTime||j.expectedReturnDateTime),I=j.carInfo||"Car Rental",R=j.pickupStationName||"N/A",B=j.id||j.bookingId||"N/A";return r.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"15px",background:"#fafafa",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:"15px",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Car"}),r.jsx("div",{style:{fontWeight:500},children:I}),r.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:["Booking ID: ",B]})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Pick-up"}),r.jsx("div",{style:{fontSize:"13px"},children:R}),r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:b})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Return"}),r.jsx("div",{style:{fontSize:"13px"},children:T})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"12px",color:"#999",marginBottom:"4px"},children:"Total"}),r.jsx("div",{style:{fontWeight:600,fontSize:"15px",color:"#1976d2"},children:Yt(j.totalAmount||0)})]}),r.jsx("div",{style:{padding:"6px 12px",background:N.color,color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:500,textAlign:"center",whiteSpace:"nowrap"},children:N.text})]},w)})})]})]})})}function r1({user:e,onClose:t,onAssignStaff:n,onDelete:s}){const[o,a]=_.useState(!1),[l,d]=_.useState(!1);if(!e)return null;const u=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"User",f=e.email||e.Email||"",m=e.phoneNumber||e.PhoneNumber||e.phone||"",g=e.role||e.Role||e.userRole||"Customer",y=e.id||e.Id||e.userId||e.UserId;if(l)return r.jsx(n1,{userId:y,userName:u,onClose:()=>d(!1)});const k=async()=>{const x=window.prompt("Enter reason for promoting to staff (optional):")||"";if(x!==null){a(!0);try{await(n==null?void 0:n(e,x)),t==null||t()}catch(C){alert((C==null?void 0:C.message)||"Failed to assign staff role")}finally{a(!1)}}},v=async()=>{if(!window.confirm(`Are you sure you want to delete ${u}?`))return;const x=window.prompt("Enter reason for deletion (optional):")||"";a(!0);try{await(s==null?void 0:s(e,x)),t==null||t()}catch(C){alert((C==null?void 0:C.message)||"Failed to delete user")}finally{a(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsxs("div",{style:{textAlign:"center",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{"aria-hidden":!0,style:{width:"120px",height:"120px",borderRadius:"50%",background:"#eceff1",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"15px",color:"#607d8b"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsx("h2",{style:{margin:"10px 0"},children:u}),r.jsx("div",{style:{color:"#666",marginBottom:"20px"},children:g})]}),r.jsxs("div",{style:{padding:"0 20px 20px"},children:[r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:f})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Phone:"}),r.jsx("span",{children:m})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"User ID:"}),r.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:y})]})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[r.jsxs("button",{onClick:()=>d(!0),style:{background:"#1976d2",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:"pointer",opacity:o?.6:1},children:[r.jsx("i",{className:"fas fa-history",style:{marginRight:"6px"}}),"Booking History"]}),r.jsx("button",{onClick:k,disabled:o,style:{background:"#43a047",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:o?"Processing...":"Promote to Staff"}),r.jsx("button",{onClick:v,disabled:o,style:{background:"#d32f2f",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:o?"Processing...":"Delete User"})]})]})})}function i1({open:e,onClose:t,onSuccess:n}){const[s,o]=_.useState(""),[a,l]=_.useState(""),[d,u]=_.useState(""),[f,m]=_.useState(""),[g,y]=_.useState(!1),[k,v]=_.useState(""),x=async C=>{var j,w;C.preventDefault(),v(""),y(!0);try{await Te.post("/Auth/Register",{fullName:s,email:a,phoneNumber:d,password:f}),o(""),l(""),u(""),m(""),n==null||n(),t()}catch(N){const b=((w=(j=N==null?void 0:N.response)==null?void 0:j.data)==null?void 0:w.message)||(N==null?void 0:N.message)||"Failed to create user";v(b)}finally{y(!1)}};return e?r.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:r.jsxs("div",{className:"modal-content",onClick:C=>C.stopPropagation(),children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h2",{children:"Create New User"}),r.jsxs("form",{onSubmit:x,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:s,onChange:C=>o(C.target.value),placeholder:"Full Name",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:a,onChange:C=>l(C.target.value),placeholder:"Email",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:d,onChange:C=>u(C.target.value),placeholder:"Phone",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:f,onChange:C=>m(C.target.value),placeholder:"Password",required:!0,disabled:g}),r.jsx("i",{className:"fas fa-lock"})]}),k&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:k}),r.jsx("button",{type:"submit",disabled:g,children:g?"Creating Account...":"Create User"})]})]})}):null}function s1({user:e,onClick:t}){const n=e.fullName||e.FullName||"Unknown User",s=e.email||e.Email||"N/A",o=e.userRole||e.role||e.Role||"N/A",a=e.deactivatedAt||"Unknown",l=e.daysDeactivated||0;return r.jsxs("div",{className:"user-card deleted-user-card",onClick:t,children:[r.jsxs("div",{className:"user-card-header",children:[r.jsx("div",{className:"user-avatar deleted",children:r.jsx("i",{className:"fas fa-user-slash"})}),r.jsxs("div",{className:"user-info",children:[r.jsx("h4",{className:"user-name",children:n}),r.jsx("p",{className:"user-email",children:s})]})]}),r.jsxs("div",{className:"user-card-body",children:[r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Role:"}),r.jsx("span",{className:"value",children:o})]}),r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Deleted:"}),r.jsx("span",{className:"value",children:a})]}),r.jsxs("div",{className:"user-detail",children:[r.jsx("span",{className:"label",children:"Days Inactive:"}),r.jsxs("span",{className:"value deleted-badge",children:[l," days"]})]})]}),r.jsx("div",{className:"user-card-footer",children:r.jsxs("span",{className:"user-status deleted-status",children:[r.jsx("i",{className:"fas fa-ban"})," Deleted"]})})]})}function a1({users:e,deletedUsers:t=[],loadingDeleted:n=!1,onAssignStaff:s,onDeleteUser:o,onRestoreUser:a,onUserCreated:l,onLoadDeleted:d}){const[u,f]=_.useState(null),[m,g]=_.useState(null),[y,k]=_.useState(""),[v,x]=_.useState(!1),[C,j]=_.useState("active");_.useEffect(()=>{C==="deleted"&&t.length===0&&!n&&d&&d()},[C,t.length,n,d]);const w=e.filter(T=>{const I=(T.role||T.Role||T.userRole||"").toLowerCase();return(y===""||(T.fullName||T.FullName||"").toLowerCase().includes(y.toLowerCase())||(T.email||T.Email||"").toLowerCase().includes(y.toLowerCase())||(T.userName||T.UserName||"").toLowerCase().includes(y.toLowerCase()))&&I!=="station staff"&&I!=="stationstaff"&&I!=="admin"}),N=t.filter(T=>y===""||(T.fullName||T.FullName||"").toLowerCase().includes(y.toLowerCase())||(T.email||T.Email||"").toLowerCase().includes(y.toLowerCase())||(T.userName||T.UserName||"").toLowerCase().includes(y.toLowerCase())),b=C==="active"?w:N;return r.jsxs("div",{id:"users",className:"section",children:[r.jsxs("div",{className:"filter-bar",children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>x(!0),style:{marginRight:"12px"},children:[r.jsx("i",{className:"fas fa-plus"})," Create User"]}),r.jsxs("div",{className:"view-mode-toggle",style:{marginRight:"12px"},children:[r.jsxs("button",{className:`toggle-btn ${C==="active"?"active":""}`,onClick:()=>j("active"),children:[r.jsx("i",{className:"fas fa-users"})," Active Users"]}),r.jsxs("button",{className:`toggle-btn ${C==="deleted"?"active":""}`,onClick:()=>j("deleted"),children:[r.jsx("i",{className:"fas fa-user-slash"})," Deleted Users"]})]}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or username...",value:y,onChange:T=>k(T.target.value)}),r.jsxs("div",{style:{color:"#666",fontSize:"14px"},children:["Showing ",b.length," ",C==="active"?"active":"deleted"," users"]})]}),n&&C==="deleted"&&r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Loading deleted users..."}),!n&&r.jsxs("div",{className:"user-grid",children:[C==="active"&&w.map(T=>r.jsx(t1,{user:T,onClick:()=>f(T)},T.id||T.Id)),C==="deleted"&&N.map(T=>r.jsx(s1,{user:T,onClick:()=>g(T)},T.userId||T.id||T.Id))]}),b.length===0&&!n&&r.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:["No ",C==="deleted"?"deleted":""," users found"]}),r.jsx(r1,{user:u,onClose:()=>f(null),onAssignStaff:s,onDelete:o}),m&&r.jsx("div",{className:"modal-overlay",onClick:()=>g(null),children:r.jsxs("div",{className:"modal-content",onClick:T=>T.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Deleted User Details"}),r.jsx("button",{className:"modal-close",onClick:()=>g(null),children:r.jsx("i",{className:"fas fa-times"})})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"user-detail-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Name:"}),r.jsx("span",{children:m.fullName||m.FullName||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:m.email||m.Email||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Role:"}),r.jsx("span",{children:m.userRole||m.role||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Deleted At:"}),r.jsx("span",{children:m.deactivatedAt||"N/A"})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("strong",{children:"Days Deactivated:"}),r.jsxs("span",{children:[m.daysDeactivated||0," days"]})]})]}),r.jsx("div",{className:"modal-actions",style:{marginTop:"20px"},children:r.jsxs("button",{className:"btn-restore",onClick:()=>{a&&(a(m),g(null))},children:[r.jsx("i",{className:"fas fa-undo"})," Restore User"]})})]})]})}),r.jsx(i1,{open:v,onClose:()=>x(!1),onSuccess:l})]})}function o1({staff:e,stations:t,onClick:n}){const s=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",o=e.email||e.Email||"",a=e.avatarUrl||e.AvatarUrl||"",l=a||`https://via.placeholder.com/100x100?text=${encodeURIComponent(s.charAt(0))}`,[d,u]=_.useState(!1),f=e.phoneNumber||e.PhoneNumber||e.phone||"",m=e.stationId||e.StationId,g=t.find(v=>(v.id||v.Id)===m),y=g?g.name||g.Name:e.stationName||e.StationName||(m?`Station ${m.substring(0,8)}...`:"Not Assigned"),k=!m&&!e.stationName&&!e.StationName;return r.jsxs("div",{className:"staff-card",onClick:n,children:[a&&!d?r.jsx("img",{src:l,alt:s,className:"staff-avatar",onError:()=>u(!0)}):r.jsx("div",{className:"staff-avatar","aria-hidden":!0,style:{background:"#eceff1",color:"#607d8b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),r.jsxs("div",{className:"staff-info",children:[r.jsx("div",{className:"staff-name",children:s}),r.jsx("div",{className:"staff-email",children:o}),r.jsxs("div",{className:"staff-station",style:{color:k?"#ff9800":"inherit"},children:[k?"":""," ",y]}),f!==""&&r.jsxs("div",{className:"staff-phone",children:[" ",f]})]})]})}function l1({staff:e,stations:t,onClose:n,onRemoveStaff:s,onAssignStation:o,onUnassignStation:a}){const[l,d]=_.useState(!1),[u,f]=_.useState("");if(!e)return null;const m=e.fullName||e.FullName||[e.firstName,e.lastName].filter(Boolean).join(" ")||"Staff",g=e.email||e.Email||"",y=e.phoneNumber||e.PhoneNumber||e.phone||"",k=e.avatarUrl||e.AvatarUrl||`https://via.placeholder.com/150x150?text=${encodeURIComponent(m.charAt(0))}`,v=e.id||e.Id||e.userId||e.UserId,x=e.stationId||e.StationId,C=t.find(I=>(I.id||I.Id)===x),j=C?C.name||C.Name:e.stationName||e.StationName||(x?`Station ${x.substring(0,8)}...`:"Not Assigned"),w=x||e.stationName||e.StationName,N=async()=>{if(!window.confirm(`Are you sure you want to remove staff role from ${m}?`))return;const I=window.prompt("Enter reason for removing staff role (optional):")||"";d(!0);try{await(s==null?void 0:s(e,I)),n==null||n()}catch(R){alert((R==null?void 0:R.message)||"Failed to remove staff role")}finally{d(!1)}},b=async()=>{if(!u){alert("Please select a station");return}if(window.confirm(`Assign ${m} to this station?`)){d(!0);try{await(o==null?void 0:o(e,u)),n==null||n()}catch(I){alert((I==null?void 0:I.message)||"Failed to assign station")}finally{d(!1)}}},T=async()=>{if(window.confirm(`Unassign ${m} from ${j}?`)){d(!0);try{await(a==null?void 0:a(e)),n==null||n()}catch(I){alert((I==null?void 0:I.message)||"Failed to unassign station")}finally{d(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",width:"90%"},children:[r.jsx("span",{className:"close-btn",onClick:n,children:""}),r.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[r.jsx("img",{src:k,alt:m,style:{width:"120px",height:"120px",borderRadius:"50%",objectFit:"cover",marginBottom:"15px"}}),r.jsx("h2",{style:{margin:"10px 0"},children:m}),r.jsx("div",{style:{color:"#43a047",fontWeight:600,marginBottom:"20px"},children:"Station Staff"})]}),r.jsxs("div",{style:{padding:"0 20px 20px"},children:[r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Email:"}),r.jsx("span",{children:g})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Phone:"}),r.jsx("span",{children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"Station:"}),r.jsx("span",{children:j})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("strong",{children:"User ID:"}),r.jsx("span",{style:{fontSize:"12px",wordBreak:"break-all"},children:v})]})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #eee"},children:[r.jsx("h4",{style:{marginBottom:"12px",color:"#333"},children:w?"Reassign to Different Station":"Assign to Station"}),r.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:w?"10px":"0"},children:[r.jsxs("select",{value:u,onChange:I=>f(I.target.value),style:{flex:1,padding:"10px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},disabled:l,children:[r.jsx("option",{value:"",children:"Select a station..."}),t.map(I=>r.jsxs("option",{value:I.id||I.Id,disabled:(I.id||I.Id)===x,children:[I.name||I.Name||`Station ${I.id||I.Id}`,(I.id||I.Id)===x?" (Current)":""]},I.id||I.Id))]}),r.jsx("button",{onClick:b,disabled:l||!u,style:{background:"#2196f3",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:l||!u?"not-allowed":"pointer",opacity:l||!u?.6:1,whiteSpace:"nowrap"},children:l?"Assigning...":w?"Reassign":"Assign"})]}),w&&a&&r.jsx("button",{onClick:T,disabled:l,style:{background:"#ff9800",color:"white",padding:"8px 16px",borderRadius:"8px",border:"none",cursor:l?"not-allowed":"pointer",opacity:l?.6:1,fontSize:"13px",width:"100%"},children:l?"Unassigning...":" Unassign from Station"})]}),r.jsx("div",{style:{padding:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"center"},children:r.jsx("button",{onClick:N,disabled:l,style:{background:"#ff9800",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},children:l?"Processing...":"Remove Staff Role"})})]})})}function c1({open:e,onClose:t,stations:n,onSuccess:s}){const[o,a]=_.useState(""),[l,d]=_.useState(""),[u,f]=_.useState(""),[m,g]=_.useState(""),[y,k]=_.useState(""),[v,x]=_.useState(!1),[C,j]=_.useState(""),w=async N=>{var b,T,I,R;N.preventDefault(),j(""),x(!0);try{const B=await Te.post("/Auth/Register",{fullName:o,email:l,phoneNumber:u,password:m}),A=((b=B==null?void 0:B.data)==null?void 0:b.id)||((T=B==null?void 0:B.data)==null?void 0:T.userId);if(!A)throw new Error("Failed to get user ID from registration response");try{await Te.assignStaffRole(A,"Assigned to station staff role during creation")}catch(E){throw console.warn("Failed to assign staff role:",E),new Error("User created but failed to assign staff role")}if(y)try{await Te.assignStaffToStation(y,A)}catch(E){console.warn("Staff role assigned but station assignment failed:",E)}a(""),d(""),f(""),g(""),k(""),s==null||s(),t()}catch(B){const A=((R=(I=B==null?void 0:B.response)==null?void 0:I.data)==null?void 0:R.message)||(B==null?void 0:B.message)||"Failed to create staff member";j(A)}finally{x(!1)}};return e?r.jsx("div",{className:"modal-overlay",style:{display:"flex"},onClick:t,children:r.jsxs("div",{className:"modal-content",onClick:N=>N.stopPropagation(),children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h2",{children:"Create New Staff Member"}),r.jsxs("form",{onSubmit:w,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:o,onChange:N=>a(N.target.value),placeholder:"Full Name",required:!0,disabled:v}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:l,onChange:N=>d(N.target.value),placeholder:"Email",required:!0,disabled:v}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:u,onChange:N=>f(N.target.value),placeholder:"Phone",required:!0,disabled:v}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:m,onChange:N=>g(N.target.value),placeholder:"Password",required:!0,disabled:v}),r.jsx("i",{className:"fas fa-lock"})]}),r.jsxs("div",{className:"input-group",style:{marginBottom:"15px"},children:[r.jsxs("select",{value:y,onChange:N=>k(N.target.value),required:!0,disabled:v,style:{width:"100%",padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",paddingLeft:"40px"},children:[r.jsx("option",{value:"",children:"Select Station"}),n.map(N=>r.jsx("option",{value:N.id||N.Id,children:N.name||N.Name||`Station ${N.id||N.Id}`},N.id||N.Id))]}),r.jsx("i",{className:"fas fa-map-marker-alt",style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",color:"#999"}})]}),C&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:C}),r.jsx("button",{type:"submit",disabled:v,children:v?"Creating Staff Member...":"Create Staff"})]})]})}):null}function d1({users:e,staffByStation:t=[],stations:n,onRemoveStaff:s,onAssignStation:o,onUnassignStation:a,onStaffCreated:l}){const[d,u]=_.useState(null),[f,m]=_.useState(""),[g,y]=_.useState(""),[k,v]=_.useState(!1),C=_.useMemo(()=>{const j=new Map;return t.forEach(w=>{const N=w.userId||w.id||w.Id;N&&j.set(N,w)}),e.forEach(w=>{const N=(w.role||w.Role||w.userRole||"").toLowerCase();if(N==="station staff"||N==="stationstaff"){const b=w.id||w.Id||w.userId;b&&!j.has(b)&&j.set(b,w)}}),Array.from(j.values())},[e,t]).filter(j=>{const w=f===""||(j.fullName||j.FullName||"").toLowerCase().includes(f.toLowerCase())||(j.email||j.Email||"").toLowerCase().includes(f.toLowerCase())||(j.userName||j.UserName||"").toLowerCase().includes(f.toLowerCase()),N=g===""||(j.stationId||j.StationId||"")===g;return w&&N});return r.jsxs("div",{id:"staff",className:"section",children:[r.jsxs("div",{className:"filter-bar",children:[r.jsxs("button",{className:"vehicle-add-btn",onClick:()=>v(!0),style:{marginRight:"12px"},children:[r.jsx("i",{className:"fas fa-plus"})," Create Staff"]}),r.jsx("input",{type:"text",placeholder:"Search staff by name, email, or username...",value:f,onChange:j=>m(j.target.value)}),r.jsxs("select",{value:g,onChange:j=>y(j.target.value),style:{padding:"10px 15px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"All Stations"}),n.map(j=>r.jsx("option",{value:j.id||j.Id,children:j.name||j.Name||`Station ${j.id||j.Id}`},j.id||j.Id))]}),r.jsxs("div",{style:{color:"#666",fontSize:"14px",whiteSpace:"nowrap"},children:[C.length," staff"]})]}),r.jsx("div",{className:"staff-grid",children:C.map(j=>r.jsx(o1,{staff:j,stations:n,onClick:()=>u(j)},j.id||j.Id))}),C.length===0&&r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No staff members found"}),r.jsx(l1,{staff:d,stations:n,onClose:()=>u(null),onRemoveStaff:s,onAssignStation:o,onUnassignStation:a}),r.jsx(c1,{open:k,onClose:()=>v(!1),stations:n,onSuccess:l})]})}function u1({open:e,onClose:t,inline:n=!1}){const[s,o]=_.useState(!1),[a,l]=_.useState({}),[d,u]=_.useState({}),[f,m]=_.useState("");if(_.useEffect(()=>{if(!e)return;let T=!0;async function I(){var R,B,A;try{o(!0),m("");let E={},M={};try{E=await yt.getMyProfile()}catch(G){((R=G==null?void 0:G.response)==null?void 0:R.status)===401&&console.warn("Get-My-Profile unauthorized (401)")}try{M=await yt.getMe()}catch(G){((B=G==null?void 0:G.response)==null?void 0:B.status)===401&&console.warn("/Auth/Me unauthorized (401)")}if(!T)return;l(E||{}),u(M||{});try{let G=(E==null?void 0:E.id)||(E==null?void 0:E.userId)||(M==null?void 0:M.userId)||(M==null?void 0:M.id);if(!G){const z=typeof localStorage<"u"?localStorage.getItem("token"):null;if(z){const X=Er(z);G=X["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]||X.nameidentifier||X.sub||X.userId||X.UserId||X.id||X.Id}}if(!(M!=null&&M.role)&&!(E!=null&&E.role))try{const z=typeof localStorage<"u"?localStorage.getItem("token"):null;if(z){const X=Er(z),K=(X==null?void 0:X.role)||(X==null?void 0:X.Role)||X["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];K&&(M={...M,role:K})}}catch{}const Y=!(E!=null&&E.userName)&&!(M!=null&&M.userName)||!(E!=null&&E.address)||!(E!=null&&E.stationName);if(G&&Y)try{const z=await yt.getUserById(G);if(!T)return;const X={...E};X.userName||(X.userName=(z==null?void 0:z.userName)||(z==null?void 0:z.UserName)||(z==null?void 0:z.username)||""),X.address||(X.address=(z==null?void 0:z.address)||(z==null?void 0:z.Address)||""),X.stationName||(X.stationName=(z==null?void 0:z.stationName)||((A=z==null?void 0:z.station)==null?void 0:A.name)||(z==null?void 0:z.StationName)||""),l(X)}catch{}}catch{}if((!E||Object.keys(E).length===0)&&(!M||Object.keys(M).length===0)){const G=typeof localStorage<"u"&&!!localStorage.getItem("token");m(G?"You may not have permission to view this profile.":"You are not logged in. Please log in with a admin account.")}}catch(E){if(!T)return;m((E==null?void 0:E.message)||"Failed to load profile")}finally{T&&o(!1)}}return I(),()=>{T=!1}},[e]),!e)return null;let g=a.userName||a.username||d.userName||d.username||"";if(!g)try{const T=typeof localStorage<"u"?localStorage.getItem("token"):null;if(T){const I=Er(T);g=(I==null?void 0:I.preferred_username)||(I==null?void 0:I.unique_name)||(I==null?void 0:I.userName)||(I==null?void 0:I.username)||(I==null?void 0:I.name)||""}}catch{}const y=a.firstName?`${a.firstName} ${a.lastName||""}`.trim():a.fullName||d.fullName||d.name||"",k=a.email||d.email||"",v=a.phoneNumber||d.phoneNumber||"",x=a.address||d.address||"",C=a.createdAt||d.createdAt||"",j=a.employeeId||a.id||d.userId||d.id||"",w=a.stationName||a.station||"",N=a.role||d.role||(Array.isArray(d.roles)?d.roles.join(", "):d.roles||""),b=a.avatarUrl||d.avatarUrl||"https://via.placeholder.com/180x180?text=Admin";return n?r.jsxs("div",{className:"admin-profile-page",children:[r.jsx("div",{className:"admin-cover",children:r.jsx("div",{className:"admin-cover-gradient"})}),r.jsx("div",{className:"admin-header",children:r.jsxs("div",{className:"admin-header-inner",children:[r.jsx("div",{className:"admin-avatar",children:r.jsx("img",{src:b,alt:"Avatar"})}),r.jsxs("div",{className:"admin-title",children:[r.jsx("h1",{children:y}),r.jsxs("div",{className:"admin-meta",children:[r.jsx("span",{className:"admin-role",children:N||""}),r.jsx("span",{className:"admin-sep",children:""}),r.jsx("span",{className:"admin-station",children:w})]})]})]})}),r.jsxs("div",{className:"admin-content",children:[r.jsx("div",{className:"admin-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"About"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Full Name"}),r.jsx("span",{className:"value",children:y})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Role"}),r.jsx("span",{className:"value",children:N||""})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Station"}),r.jsx("span",{className:"value",children:w})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Employee ID"}),r.jsx("span",{className:"value",children:j})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Joined"}),r.jsx("span",{className:"value",children:String(C).toString().slice(0,10)||""})]})]})]})}),r.jsx("div",{className:"admin-col",children:r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:"Contact"}),r.jsxs("div",{className:"card-body info-list",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Email"}),r.jsx("span",{className:"value",children:k})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Phone"}),r.jsx("span",{className:"value",children:v})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"label",children:"Address"}),r.jsx("span",{className:"value",children:x})]})]})]})})]}),f&&r.jsx("div",{className:"admin-error",children:f})]}):r.jsx("div",{className:"profile-modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"profile-modal-content",children:[r.jsx("span",{className:"profile-modal-close",onClick:t,children:""}),r.jsx("h2",{children:"Admin Profile"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsx("img",{src:b,alt:"Admin",style:{borderRadius:"50%"}}),s?r.jsx("div",{style:{padding:16},children:"Loading profile"}):r.jsxs("div",{className:"profile-info-grid",children:[r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Name"}),r.jsx("div",{children:y})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Email"}),r.jsx("div",{children:k})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Role"}),r.jsx("div",{children:N||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Phone"}),r.jsx("div",{children:v})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Address"}),r.jsx("div",{children:x})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Joined"}),r.jsx("div",{children:String(C).toString().slice(0,10)||""})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Employee ID"}),r.jsx("div",{children:j})]}),r.jsxs("div",{className:"profile-info-card",children:[r.jsx("strong",{children:"Station"}),r.jsx("div",{children:w})]})]})]})})}function h1(){return r.jsx("div",{id:"profile",className:"section",style:{padding:24},children:r.jsx(u1,{open:!0,inline:!0,onClose:()=>{}})})}function f1({open:e=!1,incident:t=null,onClose:n=()=>{},onAssigned:s=()=>{}}){const[o,a]=_.useState([]),[l,d]=_.useState(""),[u,f]=_.useState(!1);_.useEffect(()=>{if(!e)return;let k=!0;async function v(){try{const x=await Te.getAllStations(1,200);if(!k)return;a(x||[])}catch(x){console.error("Failed to load stations",x),a([])}}return v(),()=>{k=!1}},[e]),_.useEffect(()=>{t&&d(t.stationId||"")},[t]);const m=((t==null?void 0:t.status)||(t==null?void 0:t.Status)||"").toString().toUpperCase()==="RESOLVED";if(!e||!t)return null;const g=async()=>{var k;if(!l){alert("Please choose a station");return}f(!0);try{try{console.log("[AdminIncidentModal] Assigning",{incidentId:t==null?void 0:t.id,station:l});const j=new FormData;j.append("stationId",l),j.append("StationId",l),j.append("status","Pending"),j.append("Status","Pending");const w=await Pn.updateIncident(t.id,j);console.log("[AdminIncidentModal] FormData assign response:",w),alert("Assigned successfully"),s();return}catch(j){console.warn("[AdminIncidentModal] FormData update failed, will try JSON fallback",j)}const v=encodeURIComponent(t.id),x=[`/Incidents/Update-By-${v}`,`/Incidents/Update-By-Id/${v}`,`/Incidents/Update/${v}`,`/Incidents/${v}`];let C=null;for(const j of x)try{const w={stationId:l,StationId:l,status:"Pending",Status:"Pending"};console.log("[AdminIncidentModal] Trying JSON PUT",{url:j,body:w});const N=await te.put(j,w);console.log("[AdminIncidentModal] JSON PUT response for",j,N==null?void 0:N.status,N==null?void 0:N.data),alert("Assigned successfully"),s();return}catch(w){C=w;const N=(k=w==null?void 0:w.response)==null?void 0:k.status;if(N&&N!==404&&N!==405){console.error("[AdminIncidentModal] Assign JSON PUT failed on",j,w);break}console.warn("[AdminIncidentModal] JSON PUT 404/405 or not found for",j)}throw C||new Error("Assign failed")}catch(v){console.error("Failed to assign station",v),alert((v==null?void 0:v.message)||"Failed to assign")}finally{f(!1)}},y=r.jsxs("div",{style:{width:"100%"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Renter:"})," ",t.renterName||""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Phone:"})," ",t.renterPhone||""]}),r.jsxs("div",{style:{margin:"12px 0"},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Select station to assign"}),m&&r.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:"Assignment disabled for resolved incidents."}),r.jsxs("select",{value:l,onChange:k=>d(k.target.value),style:{width:"100%",padding:8},disabled:m||u,children:[r.jsx("option",{value:"",children:"-- Choose station --"}),o.map(k=>r.jsx("option",{value:k.id||k.Id,children:k.name||k.Name||k.stationName||k.station},k.id||k.Id))]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",width:"100%"},children:[r.jsxs("button",{onClick:n,disabled:u,style:{padding:"10px 20px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:u?"not-allowed":"pointer"},children:[r.jsx("i",{})," Cancel"]}),r.jsxs("button",{onClick:g,disabled:u||m,style:{padding:"10px 20px",background:"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:u||m?"not-allowed":"pointer"},children:[r.jsx("i",{className:"fas fa-check-circle"})," ",m?"Assign (disabled)":u?"Assigning":"Assign"]})]})]});return r.jsx(Ty,{open:e,incident:t,onClose:n,onUpdate:async(k,v)=>Pn.updateIncident(k,v),onResolve:async(k,v,x)=>Pn.resolveIncident(k,v,x),footerExtras:y})}function p1(){const[e,t]=_.useState([]),[n,s]=_.useState(!1),[o,a]=_.useState(null),[l,d]=_.useState(!1),u=async()=>{s(!0);try{const g=await Pn.getAllIncidents(null,null,null,null,1,500),k=((g==null?void 0:g.incidents)||[]||[]).map(x=>{var C,j,w,N,b,T,I,R,B,A,E,M;return{id:x.id||x.Id||x.incidentId||x.IncidentId||x._id&&String(x._id),description:x.description||x.Description||x.details||"",stationId:x.stationId||x.StationId||null,status:x.status||x.Status||"Pending",bookingId:x.bookingId||x.BookingId||((C=x.booking)==null?void 0:C.id)||((j=x.booking)==null?void 0:j.BookingId)||null,reportedAt:x.reportedAt||x.ReportedAt||x.createdAt||x.CreatedAt||x.date||null,costIncurred:x.costIncurred??x.CostIncurred??x.cost??null,renterName:x.renterName||x.RenterName||((w=x.raw)==null?void 0:w.renterName)||((N=x.raw)==null?void 0:N.RenterName)||((T=(b=x.booking)==null?void 0:b.user)==null?void 0:T.fullName)||null,renterPhone:x.renterPhone||x.RenterPhone||((I=x.raw)==null?void 0:I.renterPhone)||((R=x.raw)==null?void 0:R.RenterPhone)||((A=(B=x.booking)==null?void 0:B.user)==null?void 0:A.phoneNumber)||null,staffId:x.staffId||x.StaffId||((E=x.raw)==null?void 0:E.staffId)||((M=x.raw)==null?void 0:M.StaffId)||null,images:x.images||x.Images||x.imageUrls||x.ImageUrls||(typeof x.imageUrls=="string"&&x.imageUrls?x.imageUrls.split(";"):null)||[],Images:x.images||x.Images||x.imageUrls||x.ImageUrls||(typeof x.imageUrls=="string"&&x.imageUrls?x.imageUrls.split(";"):null)||[],raw:x}}),v=await Promise.all(k.map(async x=>{var w,N,b;let C=null;const j=x.staffId||((w=x.raw)==null?void 0:w.staffId)||((N=x.raw)==null?void 0:N.StaffId)||((b=x.raw)==null?void 0:b.StaffId);if(j)try{const T=await Te.getStationByStaff(j);C=(T==null?void 0:T.name)||(T==null?void 0:T.stationName)||(T==null?void 0:T.Name)||null}catch{C=null}return{...x,creatorStation:C}}));t(v)}catch(g){console.error("Failed to load incidents",g),t([])}finally{s(!1)}};_.useEffect(()=>{u()},[]);const f=g=>{a(g),d(!0)},m=async()=>{d(!1),a(null),await u()};return r.jsxs("div",{className:"section",children:[r.jsx("h3",{style:{marginTop:0},children:"Incidents"}),n&&r.jsx("div",{children:"Loading incidents"}),!n&&e.length===0&&r.jsx("div",{style:{padding:12},children:"No incidents found."}),!n&&e.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:12},children:e.map(g=>r.jsx(Ey,{incident:g,onClick:y=>f(y)},g.id))}),r.jsx(f1,{open:l,incident:o,onClose:()=>{d(!1),a(null)},onAssigned:m})]})}async function m1(e){const t={};e&&(t.headers={Authorization:`Bearer ${e}`});const n=await te.get("/Admin/Dashboard",t);return n==null?void 0:n.data}xt.create({baseURL:Di,headers:{Accept:"application/json"}});async function g1(e,t,n){const o={params:{}};e&&(o.headers={Authorization:`Bearer ${e}`});const a=await te.get("/Admin/Reports/Car-Utilization",o);return a==null?void 0:a.data}function y1(){const[e,t]=_.useState(!0),[n,s]=_.useState(null),[o,a]=_.useState([]),[l,d]=_.useState([]),[u,f]=_.useState(""),[m,g]=_.useState("asc"),[y,k]=_.useState("none");_.useEffect(()=>{v()},[]);async function v(){t(!0),s(null);try{const N=localStorage.getItem("token"),b=await Te.getAllStations(1,200).catch(()=>[]),T=10,I=[];for(let R=0;R<b.length;R+=T){const A=b.slice(R,R+T).map(async M=>{const G=M.id||M.Id||M.stationId||M.StationId;try{const Y=await uS(G,{token:N}),z=(Y==null?void 0:Y.data)||Y||{},X=z.totalRevenue??z.TotalRevenue??z.total??z.Total??z.revenue??0,K=z.revenue??z.thisMonth??z.ThisMonth??z.month??z.Month??z.revenueThisMonth??0;return{StationId:G||null,StationName:M.name||M.Name||M.stationName||M.station||`Station ${G}`,TotalRevenue:X,ThisMonth:K,raw:z}}catch{return{StationId:G||null,StationName:M.name||M.Name||M.stationName||M.station||`Station ${G}`,TotalRevenue:0,ThisMonth:0,raw:null}}}),E=await Promise.all(A);I.push(...E)}I.sort((R,B)=>{const A=String(R.StationName||"").toLowerCase(),E=String(B.StationName||"").toLowerCase();return A<E?-1:A>E?1:0}),a(I),d(b||[])}catch(N){s((N==null?void 0:N.message)||String(N))}finally{t(!1)}}const x=()=>v(),C=o.filter(N=>{const b=u.trim().toLowerCase();if(!b)return!0;const T=String(N.StationName||N.stationName||N.Station||"").toLowerCase(),I=String(N.StationId||N.stationId||"").toLowerCase();return T.includes(b)||I.includes(b)}),j=(()=>{const N=[...C];return N.sort((b,T)=>{const I=String(b.StationName||"").toLowerCase(),R=String(T.StationName||"").toLowerCase();return I<R?m==="asc"?-1:1:I>R?m==="asc"?1:-1:0}),y&&y!=="none"&&N.sort((b,T)=>{const I=Number(b.TotalRevenue??b.totalRevenue??b.Total??0),R=Number(T.TotalRevenue??T.totalRevenue??T.Total??0);return y==="asc"?I-R:R-I}),N})(),w={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"100%"};return e?r.jsx("div",{style:{padding:12},children:"Loading station revenue"}):n?r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",n]}):r.jsxs("div",{style:{marginTop:16},children:[r.jsx("h3",{style:{margin:0,marginBottom:8},children:"Stations Revenue"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{placeholder:"Search station name or id",value:u,onChange:N=>f(N.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd",flex:1}}),r.jsxs("select",{value:m,onChange:N=>g(N.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"asc",children:"Name: A  Z"}),r.jsx("option",{value:"desc",children:"Name: Z  A"})]}),r.jsxs("select",{value:y,onChange:N=>k(N.target.value),style:{padding:8,borderRadius:6,border:"1px solid #ddd"},children:[r.jsx("option",{value:"none",children:"Revenue: (none)"}),r.jsx("option",{value:"desc",children:"Revenue: High  Low"}),r.jsx("option",{value:"asc",children:"Revenue: Low  High"})]}),r.jsx("button",{onClick:x,style:{padding:"8px 12px",borderRadius:6},children:"Refresh"})]}),r.jsxs("div",{style:{display:"grid",gap:12},children:[j.length===0&&r.jsx("div",{style:{color:"#666"},children:"No station revenue data available."}),j.map((N,b)=>r.jsx("div",{style:w,children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700},children:N.StationName||N.stationName||N.Station||"Station"}),r.jsx("div",{style:{color:"#666",fontSize:12},children:N.StationId||N.stationId?String(N.StationId||N.stationId):""})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"This Month"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:x1(N.ThisMonth??N.thisMonth??N.Month??N.month??0)})]})]})},N.StationId||N.stationId||b))]})]})}function x1(e){if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t.toLocaleString(void 0,{style:"currency",currency:"VND",maximumFractionDigits:0}):String(e)}function v1(){const[e,t]=_.useState([]),[n,s]=_.useState(!1),[o,a]=_.useState(null);_.useEffect(()=>{l()},[]);async function l(){s(!0),a(null);try{let u=function(x,C=[]){if(!x||typeof x!="object")return C;if(Array.isArray(x)){C.push(x);for(const j of x)u(j,C);return C}for(const j of Object.keys(x))u(x[j],C);return C};const f=localStorage.getItem("token"),m=await g1(f),g=m&&(m.data||m)||{},y=u(g);let k=[];y.length?(y.sort((x,C)=>C.length-x.length),k=y[0]):Array.isArray(g)?k=g:k=[];const v=k.map(x=>({carId:x.carId??"",brand:x.brand??"",model:x.model??"",licensePlate:x.licensePlate??"",currentStation:x.currentStation??"",totalBookings:Number(x.totalBookings??0)||0,totalHoursUsed:Number(x.totalHoursUsed??0)||0,utilizationRate:Number(x.utilizationRate??0)||0,revenue:Number(x.revenue??0)||0,averageBatteryLevel:Number(x.averageBatteryLevel??0)||0,status:x.status??""}));t(v)}catch(u){a((u==null?void 0:u.message)||String(u))}finally{s(!1)}}const d={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"100%"};return r.jsxs("div",{style:{marginTop:16},children:[r.jsx("h3",{style:{margin:0,marginBottom:8},children:"Station Vehicles"}),r.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:r.jsx("button",{onClick:l,style:{padding:"8px 12px",borderRadius:6},children:"Refresh"})}),n&&r.jsx("div",{style:{padding:12},children:"Loading vehicles"}),o&&r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",o]}),r.jsxs("div",{style:{display:"grid",gap:12},children:[e.length===0&&!n&&r.jsx("div",{style:{color:"#666"},children:"No vehicles found."}),e.map(u=>r.jsxs("div",{style:d,children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700},children:u.brand&&u.model?`${u.brand} ${u.model}`:u.carId||"Vehicle"}),r.jsx("div",{style:{color:"#666",fontSize:12},children:u.licensePlate}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:6},children:u.currentStation})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Utilization"}),r.jsxs("div",{style:{fontSize:16,fontWeight:700},children:[u.utilizationRate,"%"]}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Revenue"}),r.jsx("div",{style:{fontSize:14,fontWeight:700},children:u.revenue}),r.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Status"}),r.jsx("div",{style:{fontSize:14,fontWeight:700},children:u.status})]})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,color:"#444",fontSize:13},children:[r.jsxs("div",{children:["Total bookings: ",r.jsx("strong",{children:u.totalBookings})]}),r.jsxs("div",{children:["Total hours: ",r.jsx("strong",{children:u.totalHoursUsed})]}),r.jsxs("div",{children:["Avg battery: ",r.jsxs("strong",{children:[u.averageBatteryLevel,"%"]})]})]})]},u.carId||u.licensePlate||JSON.stringify(u)))]})]})}function _1(){const[e,t]=_.useState(!0),[n,s]=_.useState(null),[o,a]=_.useState(null);if(_.useEffect(()=>{let y=!0;async function k(){t(!0),s(null);try{const v=localStorage.getItem("token"),x=await m1(v),C=(x==null?void 0:x.data)||x;if(!y)return;a(C)}catch(v){if(!y)return;s((v==null?void 0:v.message)||String(v))}finally{if(!y)return;t(!1)}}return k(),()=>{y=!1}},[]),e)return r.jsx("div",{style:{padding:12},children:"Loading analytics"});if(n)return r.jsxs("div",{style:{padding:12,color:"#b00020"},children:["Error: ",n]});if(!o)return r.jsx("div",{style:{padding:12},children:"No analytics data"});const l=o.data||o,d=(l==null?void 0:l.overview)||{},u=(l==null?void 0:l.userStatistics)||{},f=(l==null?void 0:l.fleetStatistics)||{},m=(l==null?void 0:l.bookingStatistics)||{};l!=null&&l.revenueStatistics;const g={background:"#fff",borderRadius:8,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"};return r.jsxs("div",{style:{display:"grid",gap:16},children:[r.jsx("h2",{style:{margin:0,marginBottom:6},children:"Analytics"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12},children:[r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Users"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalUsers??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Cars"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalCars??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Bookings"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.totalBookings??""})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Active Bookings"}),r.jsx("div",{style:{fontSize:20,fontWeight:700},children:d.activeBookings??""})]})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsxs("div",{style:g,children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:r.jsx("div",{style:{fontWeight:700},children:"User Statistics"})}),r.jsx("div",{style:{marginTop:8},children:r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Active"}),r.jsx("div",{style:{fontSize:18,fontWeight:700},children:u.totalActive??""})]}),r.jsxs("div",{style:{flex:2},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"By Role"}),r.jsx("div",{style:{marginTop:6,display:"flex",gap:8},children:u.byRole?Object.entries(u.byRole).map(([y,k])=>r.jsxs("div",{style:{background:"#f5f7fb",padding:"6px 8px",borderRadius:6},children:[r.jsx("div",{style:{fontSize:12,color:"#333"},children:y}),r.jsx("div",{style:{fontWeight:700},children:k})]},y)):r.jsx("div",{children:""})})]})]})})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{fontWeight:700},children:"Fleet Statistics"}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:8},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total Cars"}),r.jsx("div",{style:{fontWeight:700},children:f.totalCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Available"}),r.jsx("div",{style:{fontWeight:700},children:f.availableCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"In Use"}),r.jsx("div",{style:{fontWeight:700},children:f.inUseCars??""})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Low Battery"}),r.jsx("div",{style:{fontWeight:700},children:f.lowBatteryCars??""})]})]})]}),r.jsxs("div",{style:g,children:[r.jsx("div",{style:{fontWeight:700},children:"Booking Statistics"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:8,marginTop:8},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Total"}),r.jsx("div",{style:{fontWeight:700},children:m.total??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Pending"}),r.jsx("div",{style:{fontWeight:700},children:m.pending??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Checked-in"}),r.jsx("div",{style:{fontWeight:700},children:m.checkedIn??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Completed"}),r.jsx("div",{style:{fontWeight:700},children:m.completed??""})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{color:"#666",fontSize:12},children:"Cancelled"}),r.jsx("div",{style:{fontWeight:700},children:m.cancelled??""})]})]})]})]})}),r.jsx("div",{style:{marginTop:12},children:r.jsx(w1,{})})]})}function w1(){const[e,t]=_.useState("stations");return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{onClick:()=>t("stations"),style:{padding:"8px 12px",borderRadius:6,background:e==="stations"?"#eef":"#fff"},children:"Stations"}),r.jsx("button",{onClick:()=>t("vehicles"),style:{padding:"8px 12px",borderRadius:6,background:e==="vehicles"?"#eef":"#fff"},children:"Vehicles"})]}),r.jsxs("div",{children:[e==="stations"&&r.jsx(y1,{}),e==="vehicles"&&r.jsx(v1,{})]})]})}function j1({open:e,onClose:t,onSubmit:n}){const[s,o]=_.useState(""),[a,l]=_.useState(""),[d,u]=_.useState(0),[f,m]=_.useState(""),[g,y]=_.useState(!1);if(!e)return null;async function k(v){if(v.preventDefault(),m(""),!s.trim()||!a.trim()){m("Name and address are required");return}y(!0);try{const x={name:s.trim(),address:a.trim(),totalSlots:Number(d)};await n(x),o(""),l(""),u(0),t&&t()}catch(x){m((x==null?void 0:x.message)||"Create failed")}finally{y(!1)}}return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"520px",width:"92%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:"Create Station"}),f&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:f}),r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsx("input",{value:s,onChange:v=>o(v.target.value),placeholder:"Station name"}),r.jsx("input",{value:a,onChange:v=>l(v.target.value),placeholder:"Address"}),r.jsx("input",{type:"number",value:d,onChange:v=>u(v.target.value),placeholder:"Total slots",min:0})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:[r.jsx("button",{onClick:t,style:{padding:"10px 20px"},children:"Cancel"}),r.jsx("button",{onClick:k,disabled:g,style:{padding:"10px 20px"},children:g?"Creating":"Create Station"})]})]})})}function S1({open:e,onClose:t,station:n,onUpdated:s,onDeleted:o}){const[a,l]=_.useState(!1),[d,u]=_.useState(""),[f,m]=_.useState(""),[g,y]=_.useState(0),[k,v]=_.useState(!1),[x,C]=_.useState("");if(_.useEffect(()=>{n&&(u(n.name||n.Name||""),m(n.address||n.Address||""),y(n.totalSlots??n.TotalSlots??0))},[n]),!e||!n)return null;const j=n.id||n.Id,w=async()=>{C(""),v(!0);try{const b={name:d.trim(),address:f.trim(),totalSlots:Number(g)},T=await Te.updateStation(j,b);s&&s(T||{...n,...b}),l(!1)}catch(b){C((b==null?void 0:b.message)||"Update failed")}finally{v(!1)}},N=async()=>{if(confirm("Delete this station?")){v(!0);try{await Te.deleteStation(j),o&&o(j),t&&t()}catch(b){C((b==null?void 0:b.message)||"Delete failed")}finally{v(!1)}}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"640px",width:"96%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:a?"Edit Station":"Station Details"}),x&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:x}),a?r.jsxs("div",{style:{display:"grid",gap:12},children:[r.jsx("input",{value:d,onChange:b=>u(b.target.value),placeholder:"Name"}),r.jsx("input",{value:f,onChange:b=>m(b.target.value),placeholder:"Address"}),r.jsx("input",{type:"number",value:g,onChange:b=>y(b.target.value),placeholder:"Total slots",min:0})]}):r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("div",{style:{fontWeight:600},children:n.name||n.Name||`Station ${j}`}),r.jsx("div",{style:{color:"#555"},children:n.address||n.Address||""}),r.jsxs("div",{style:{color:"#555"},children:["Slots: ",n.totalSlots??n.TotalSlots??""]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:a?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l(!1),disabled:k,children:"Cancel"}),r.jsx("button",{onClick:w,disabled:k,children:k?"Saving":"Save"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>l(!0),children:"Edit"}),r.jsx("button",{onClick:N,style:{background:"#dc2626",color:"#fff"},children:"Delete"})]})})]})})}function C1({open:e,onClose:t,feedback:n}){var k;if(!e||!n)return null;const[s,o]=_.useState(null),[a,l]=_.useState(null);n.id||n.Id;const d=n.subject||n.title||"Feedback",u=n.message||n.description||n.content||"",f=n.rating??n.rate??null,m=n.comment??"",g=s||n.userName||((k=n.user)==null?void 0:k.fullName)||n.userEmail||n.email||"Anonymous",y=new Date(n.createdAt||n.createdDate||n.created||Date.now()).toLocaleString();return _.useEffect(()=>{let v=!0;async function x(){try{if(n.userId&&!n.userName){const C=await $l.getUserById(n.userId);if(v&&C){const j=C.fullName||C.name||C.userName||C.displayName||C.email||null;j&&o(j)}}}catch{}try{if(n.carId){const C=await Qe.getCarById(n.carId);if(v&&C){const j=C.brand||C.Brand||C.make||C.manufacturer||null,w=C.model||C.Model||C.name||null,N=[j,w].filter(Boolean).join(" ").trim()||null;N&&l(N)}}}catch{}}return x(),()=>{v=!1}},[n]),r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",style:{maxWidth:"720px",width:"96%"},children:[r.jsx("span",{className:"close-btn",onClick:t,children:""}),r.jsx("h3",{style:{marginTop:0},children:d}),r.jsx("div",{style:{color:"#555",marginBottom:12},children:u}),f!=null&&r.jsxs("div",{style:{fontSize:14,color:"#333",marginBottom:8},children:["Rating: ",f," / 5"]}),m&&r.jsxs("div",{style:{color:"#444",marginBottom:8},children:[r.jsx("strong",{children:"Comment:"})," ",m]}),a&&r.jsxs("div",{style:{fontSize:13,color:"#555",marginTop:6},children:["Car: ",a]}),r.jsxs("div",{style:{fontSize:12,color:"#777"},children:["From: ",g,"  ",y]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:12},children:r.jsx("button",{onClick:t,children:"Close"})})]})})}function N1({initialSearch:e="",initialPage:t=1,pageSize:n=10}){const[s,o]=_.useState([]),[a,l]=_.useState(!1),[d,u]=_.useState(e),[f,m]=_.useState(t),[g,y]=_.useState(null),[k,v]=_.useState(!1),x=async(C=f,j=n,w=d)=>{l(!0);try{const N=await Te.getFeedbacks({page:C,pageSize:j,search:w}),b=(N==null?void 0:N.items)||(N==null?void 0:N.data)||[];o(b),m(C)}catch(N){console.error("Failed to load feedbacks",N),o([])}finally{l(!1)}};return _.useEffect(()=>{x(1,n,d)},[]),r.jsxs("div",{style:{width:"100%"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:24,margin:0},children:"Feedbacks"}),r.jsx("div",{style:{flex:1}}),r.jsx("input",{placeholder:" Search feedbacks...",value:d,onChange:C=>{u(C.target.value)},onKeyPress:C=>{C.key==="Enter"&&x(1,n,C.target.value)},style:{padding:"10px 14px",border:"1px solid #ddd",borderRadius:6,minWidth:280,fontSize:14}}),r.jsx("button",{onClick:()=>x(1,n,d),style:{padding:"10px 16px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:14,transition:"background-color 0.2s"},onMouseOver:C=>C.target.style.backgroundColor="#2980b9",onMouseOut:C=>C.target.style.backgroundColor="#3498db",children:"Search"})]}),a?r.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:" Loading feedbacks"}):r.jsxs("div",{children:[(!s||s.length===0)&&r.jsx("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,color:"#666"},children:r.jsx("p",{style:{fontSize:16,margin:0},children:"No feedbacks found."})}),(s||[]).length>0&&r.jsx("div",{style:{display:"grid",gap:12},children:(s||[]).map((C,j)=>{var w;return r.jsxs("div",{style:{padding:16,border:"1px solid #e0e0e0",borderRadius:8,backgroundColor:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"flex-start",cursor:"pointer"},onMouseOver:N=>{N.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",N.currentTarget.style.transform="translateY(-2px)"},onMouseOut:N=>{N.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)",N.currentTarget.style.transform="translateY(0)"},children:[r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:6,color:"#333"},children:C.subject||C.title||"Feedback"}),r.jsx("div",{style:{color:"#666",fontSize:14,marginBottom:10,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:(C.message||C.description||C.content||"No message").slice(0,300)}),r.jsxs("div",{style:{fontSize:12,color:"#999",display:"flex",gap:12,alignItems:"center"},children:[r.jsxs("span",{children:[" ",C.userName||((w=C.user)==null?void 0:w.fullName)||C.userEmail||C.email||"Anonymous"]}),r.jsxs("span",{children:[" ",new Date(C.createdAt||C.createdDate||C.created||Date.now()).toLocaleDateString("vi-VN")]})]})]}),r.jsx("button",{onClick:()=>{y(C),v(!0)},style:{marginLeft:16,padding:"8px 14px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:4,fontWeight:600,cursor:"pointer",fontSize:13,whiteSpace:"nowrap",transition:"background-color 0.2s"},onMouseOver:N=>N.target.style.backgroundColor="#27ae60",onMouseOut:N=>N.target.style.backgroundColor="#2ecc71",children:"View"})]},C.id||C.Id||`feedback-${j}`)})}),(s||[]).length>0&&r.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginTop:32,paddingTop:20,paddingBottom:20,borderTop:"1px solid #e0e0e0",position:"sticky",bottom:0,backgroundColor:"white",zIndex:10},children:[r.jsx("button",{disabled:f<=1,onClick:()=>x(Math.max(1,f-1),n,d),style:{padding:"8px 16px",backgroundColor:f<=1?"#eee":"#3498db",color:f<=1?"#999":"white",border:"none",borderRadius:4,cursor:f<=1?"not-allowed":"pointer",fontWeight:600,fontSize:13,transition:"background-color 0.2s"},children:" Previous"}),r.jsxs("div",{style:{fontSize:13,color:"#666",minWidth:60,textAlign:"center"},children:["Page ",r.jsx("strong",{children:f})]}),r.jsx("button",{onClick:()=>x(f+1,n,d),style:{padding:"8px 16px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:600,fontSize:13,transition:"background-color 0.2s"},onMouseOver:C=>C.target.style.backgroundColor="#2980b9",onMouseOut:C=>C.target.style.backgroundColor="#3498db",children:"Next "})]})]}),r.jsx(C1,{open:k,onClose:()=>{v(!1),y(null)},feedback:g})]})}const k1=[],b1=[];function I1(){const[e,t]=_.useState("booking"),[n,s]=_.useState(k1),[o,a]=_.useState(b1),[l,d]=_.useState([]),[u,f]=_.useState([]),[m,g]=_.useState([]),[y,k]=_.useState(!1),[v,x]=_.useState([]),[C,j]=_.useState(()=>{try{const V=localStorage.getItem("admin_sidebar_visible");return V==null?!0:V==="1"}catch{return!0}}),[w,N]=_.useState(""),[b,T]=_.useState(""),[I,R]=_.useState([]),[B,A]=_.useState(""),[E,M]=_.useState(!1),[G,Y]=_.useState(!1),[z,X]=_.useState(!1),[K,F]=_.useState(!1),[$,ge]=_.useState(!1),[re,fe]=_.useState(!1),[_e,se]=_.useState(""),[O,ne]=_.useState(""),[q,we]=_.useState(""),[Le,Ne]=_.useState(null),[Se,ze]=_.useState(!1),[pe,nt]=_.useState(!1),[sn,he]=_.useState(null),[oe,le]=_.useState([]),[ye,de]=_.useState(!1),[ke,tt]=_.useState(""),[Qn,Ie]=_.useState(1),[D,Ke]=_.useState(10),Ve=async V=>{try{await Te.confirmBooking(V.id,"Cash",""),s(ee=>ee.map(ae=>ae.id===V.id?{...ae,status:"booked"}:ae))}catch(ee){se((ee==null?void 0:ee.message)||"Failed to proceed to payment")}},Ee=async(V,ee="")=>{var ae;try{await Te.cancelBooking(V.id,ee||""),s(ce=>ce.map(Be=>Be.id===V.id?{...Be,status:"denied"}:Be))}catch(ce){const Be=(ae=ce==null?void 0:ce.response)==null?void 0:ae.status;if(Be===401||Be===403){alert("You don't have permission to cancel this booking.");return}se((ce==null?void 0:ce.message)||"Failed to cancel booking")}},ie=(V,ee)=>{const ae=ee==="pending"?"Pending":ee==="booked"?"Booked":ee==="checked-in"?"Check-in Pending":ee==="completed"?"Completed":ee==="denied"?"Denied":ee;s(ce=>ce.map(Be=>Be.id===V?{...Be,status:ee,statusLabel:ae}:Be))},Ae=async V=>{var ee;try{const ae=await Te.createCar(V),ce=ae||{},Be=Ue=>({id:Ue.id||Ue.Id||Ue.carId||Ue.CarId,name:Ue.name||Ue.Name||[Ue.brand,Ue.model].filter(Boolean).join(" ")||"Car",model:Ue.model||Ue.Model||null,brand:Ue.brand||Ue.Brand||null,licensePlate:Ue.licensePlate||Ue.LicensePlate||null,img:Ue.imageUrl||Ue.image||Ue.thumbnailUrl||null,battery:Number.isFinite(Ue.currentBatteryLevel)?Math.round(Ue.currentBatteryLevel):void 0,tech:Ue.condition??Ue.status??Ue.Status??null,issue:Ue.issue??Ue.issueDescription??null,capacity:Ue.batteryCapacity??Ue.BatteryCapacity??Ue.capacity??Ue.capacityKWh??Ue.batteryCapacityKWh??null});return a(Ue=>[...Ue,Be(ce)]),B&&await er(B),ae}catch(ae){console.error("Add vehicle failed:",ae);const ce=(ee=ae==null?void 0:ae.response)==null?void 0:ee.data;let Be=(ae==null?void 0:ae.message)||"Failed to create vehicle";if(ce)if(typeof ce=="string")Be=ce;else if(ce.message)Be=ce.message;else if(ce.errors)try{const Ue=Object.keys(ce.errors)[0],je=ce.errors[Ue];Be=Array.isArray(je)?je[0]:String(je)}catch{Be=JSON.stringify(ce.errors)}else Be=JSON.stringify(ce);throw se(Be||"Failed to create vehicle"),ae}},ot=async V=>{var ee;try{await Te.softDeleteCar(V),a(ae=>ae.filter(ce=>ce.id!==V)),await At(),await er(B)}catch(ae){const ce=(ee=ae==null?void 0:ae.response)==null?void 0:ee.status;if(ce===401||ce===403){ne("You don't have permission to delete vehicles. Please contact an administrator.");return}se((ae==null?void 0:ae.message)||"Failed to delete vehicle")}},At=async()=>{k(!0);try{const V=await Te.getDeletedCars();d(V||[])}catch(V){se((V==null?void 0:V.message)||"Failed to load deleted vehicles")}finally{k(!1)}},Sn=async V=>{try{const ee=V.id||V.Id||V.carId||V.CarId;await Te.restoreCar(ee),d(ae=>ae.filter(ce=>String(ce.id||ce.Id)!==String(ee))),a(ae=>[V,...ae||[]]),await er(B),alert("Vehicle restored successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to restore vehicle")}},Me=async(V,ee)=>{try{if(ee.battery!==void 0&&ee.battery!==""){let ae=Number(ee.battery);Number.isNaN(ae)||(ae=Math.max(0,Math.min(100,Math.round(ae))),await Te.updateBatteryLevel(V,ae))}if(ee.tech&&await Te.updateStatus(V,ee.tech),ee.issue)try{await Te.updateCarDescription(V,ee.issue)}catch{await Te.updateCar(V,{description:ee.issue})}ee.isAvailable!==void 0&&await(await WS(async()=>{const{default:ce}=await Promise.resolve().then(()=>Ej);return{default:ce}},void 0)).default.updateCarAvailability(V,ee.isAvailable?1:0)}catch(ae){se((ae==null?void 0:ae.message)||"Failed to update vehicle")}a(ae=>ae.map(ce=>ce.id===V?{...ce,...ee}:ce))},ut=async()=>{F(!0);try{const ee=(await Te.getAllUsers(1,1e3)||[]).filter(ae=>ae.isActive!==!1&&ae.IsActive!==!1);f(ee)}catch(V){se((V==null?void 0:V.message)||"Failed to load users")}finally{F(!1)}},Xn=async()=>{ge(!0);try{const V=await Te.getDeletedAccounts(1,1e3);g(V||[])}catch(V){se((V==null?void 0:V.message)||"Failed to load deleted users")}finally{ge(!1)}},Cn=async V=>{if(!V){x([]);return}fe(!0);try{const ee=await Te.getStaffByStation(V);x(ee||[])}catch(ee){se((ee==null?void 0:ee.message)||"Failed to load staff by station"),x([])}finally{fe(!1)}},Et=async(V,ee)=>{try{await Te.assignStaffRole(V.id||V.Id||V.userId,ee),await ut(),B&&await Cn(B),alert("User promoted to Station Staff successfully")}catch(ae){alert((ae==null?void 0:ae.message)||"Failed to assign staff role")}},rt=async(V,ee)=>{try{await Te.removeStaffRole(V.id||V.Id||V.userId,ee),await ut(),B&&await Cn(B),alert("Staff role removed successfully")}catch(ae){alert((ae==null?void 0:ae.message)||"Failed to remove staff role")}},Or=async(V,ee)=>{try{const ae=V.id||V.Id||V.userId;V.stationId||V.StationId?await Te.reassignStaff(ae,ee):await Te.assignStaffToStation(ee,ae),await ut(),B&&await Cn(B),alert("Staff assigned to station successfully")}catch(ae){alert((ae==null?void 0:ae.message)||"Failed to assign staff to station")}},Fn=async V=>{try{const ee=V.id||V.Id||V.userId;await Te.unassignStaffFromStation(ee),await ut(),B&&await Cn(B),alert("Staff unassigned from station successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to unassign staff from station")}},$i=async(V,ee)=>{try{const ae=V.id||V.Id||V.userId;await Te.softDeleteUser(ae,ee),f(ce=>ce.filter(Be=>(Be.id||Be.Id||Be.userId)!==ae)),await ut(),alert("User deleted successfully")}catch(ae){alert((ae==null?void 0:ae.message)||"Failed to delete user")}},yr=async V=>{try{const ee=V.userId||V.id||V.Id;await Te.restoreUser(ee),g(ae=>ae.filter(ce=>(ce.userId||ce.id||ce.Id)!==ee)),await Xn(),await ut(),alert("User restored successfully")}catch(ee){alert((ee==null?void 0:ee.message)||"Failed to restore user")}},Hs=async(V,ee,ae)=>{try{await Te.transferCar(V.id,ee,ae||"");const ce=I.find(Be=>(Be.id||Be.Id)===ee);alert(`Vehicle transferred successfully to ${(ce==null?void 0:ce.name)||(ce==null?void 0:ce.Name)||"target station"}`),await Wi(B),await er(B)}catch(ce){throw alert((ce==null?void 0:ce.message)||"Failed to transfer vehicle"),ce}},er=async V=>{if(!V){Ne(null);return}try{const ee=await Te.getCarStatusReport(V,null);if(ee){const ae=(I||[]).find(Be=>String(Be.id||Be.Id)===String(V)),ce=ae?ae.totalSlots??ae.TotalSlots??0:0;Ne({totalSlots:ce,carsCount:ee.totalCars||0,cars:ee.cars||[]})}}catch(ee){console.warn("Failed to load station slots:",ee)}},Wi=async V=>{try{M(!0);let ee=[];if(V){let je=[],ve=[];try{je=await Te.getCarsByStation(V)}catch{}try{ve=await Te.getAvailableCarsByStation(V)}catch{}const ft=xe=>Array.isArray(xe)?xe:xe?[xe]:[],H=ft(je),Re=ft(ve),$e=new Map;for(const xe of[...H,...Re]){const W=String((xe==null?void 0:xe.id)||(xe==null?void 0:xe.Id)||(xe==null?void 0:xe.carId)||(xe==null?void 0:xe.CarId)||(xe==null?void 0:xe.licensePlate)||(xe==null?void 0:xe.LicensePlate)||Math.random());$e.has(W)||$e.set(W,xe)}ee=Array.from($e.values());try{const xe=await Te.getAllCars(1,1e3),W=Pe=>Pe==null?"":String(Pe).replace(/[{}]/g,"").toLowerCase(),Ze=W(V),lt=(xe||[]).filter(Pe=>{var an,on,Nn,xr;return[Pe.currentStationId,Pe.CurrentStationId,Pe.currentStationID,Pe.stationId,Pe.StationId,Pe.stationID,(an=Pe.station)==null?void 0:an.id,(on=Pe.station)==null?void 0:on.Id,(Nn=Pe.station)==null?void 0:Nn.stationId,(xr=Pe.station)==null?void 0:xr.StationId].some(Mt=>Mt!=null&&W(Mt)===Ze)});for(const Pe of lt){const jt=String((Pe==null?void 0:Pe.id)||(Pe==null?void 0:Pe.Id)||(Pe==null?void 0:Pe.carId)||(Pe==null?void 0:Pe.CarId)||(Pe==null?void 0:Pe.licensePlate)||(Pe==null?void 0:Pe.LicensePlate));jt&&!$e.has(jt)&&$e.set(jt,Pe)}ee=Array.from($e.values())}catch{}}else try{ee=await Te.getAllCars(1,1e3)}catch{try{ee=await Te.listCars({page:1,pageSize:1e3})}catch{ee=[]}}Array.isArray(ee)||(ee=ee?[ee]:[]);const ae=je=>{const ve=Number(je);return Number.isFinite(ve)&&ve>=0&&ve<=100?Math.round(ve):null},ce=(ee||[]).map(je=>{var xe,W,Ze,lt;const ft=((...Pe)=>Pe.find(jt=>jt!=null&&jt!==""))(je.currentStationId,je.CurrentStationId,je.currentStationID,je.stationId,je.StationId,je.stationID,(xe=je.station)==null?void 0:xe.id,(W=je.station)==null?void 0:W.Id,(Ze=je.station)==null?void 0:Ze.stationId,(lt=je.station)==null?void 0:lt.StationId),H=Pe=>Pe==null?"":String(Pe).replace(/[{}]/g,"").toLowerCase(),Re=ft||"",$e=(()=>{if(!Re)return null;const Pe=I.find(jt=>H(jt.id||jt.Id)===H(Re))||null;return Pe&&(Pe.name||Pe.Name)||null})();return{id:je.id||je.Id||je.carId||je.CarId,name:je.name||je.Name||je.model||je.CarName||"Car",model:je.model||je.Model||null,brand:je.brand||je.Brand||null,licensePlate:je.licensePlate||je.LicensePlate||null,img:je.imageUrl||je.image||je.thumbnailUrl||null,battery:ae(je.currentBatteryLevel??je.CurrentBatteryLevel??je.batteryPercent??je.battery),tech:je.condition??je.status??je.Status??null,issue:je.issue??je.issueDescription??null,capacity:je.batteryCapacity??je.BatteryCapacity??je.capacity??je.capacityKWh??je.batteryCapacityKWh??null,stationId:Re,stationName:$e||null}});a(ce);const Be=ce.filter(je=>je.battery==null),Ue=ce.filter(je=>je.capacity==null);if(Be.length>0)try{const je=await Promise.all(Be.map(async ve=>{try{const ft=await Te.getCarBattery(ve.id);return{id:ve.id,battery:ae(ft)}}catch{return{id:ve.id,battery:null}}}));a(ve=>ve.map(ft=>{const H=je.find(Re=>Re.id===ft.id);return H&&H.battery!=null?{...ft,battery:H.battery}:ft}))}catch{}if(Ue.length>0)try{const je=await Promise.all(Ue.map(async ve=>{try{const ft=await Te.getCarCapacity(ve.id);return{id:ve.id,capacity:ft}}catch{return{id:ve.id,capacity:null}}}));a(ve=>ve.map(ft=>{const H=je.find(Re=>Re.id===ft.id);return H&&H.capacity!=null?{...ft,capacity:H.capacity}:ft}))}catch{}}catch(ee){se((ee==null?void 0:ee.message)||"Failed to load vehicles")}finally{M(!1)}};_.useEffect(()=>{C?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[C]),_.useEffect(()=>{try{localStorage.setItem("admin_sidebar_visible",C?"1":"0")}catch{}},[C]);const Zs=[{key:"booking",label:"Booking",icon:"fas fa-calendar-alt",onClick:()=>t("booking")},{key:"vehicle",label:"Vehicle",icon:"fas fa-car",onClick:()=>t("vehicle")},{key:"user",label:"User",icon:"fas fa-users",onClick:()=>t("user")},{key:"staff",label:"Staff",icon:"fas fa-user-tie",onClick:()=>t("staff")},{key:"station",label:"Stations",icon:"fas fa-map-marker-alt",onClick:()=>t("station")},{key:"feedback",label:"Feedback",icon:"fas fa-comment-dots",onClick:()=>t("feedback")},{key:"incident",label:"Incident",icon:"fas fa-exclamation-triangle",onClick:()=>t("incident")},{key:"analytics",label:"Analytics",icon:"fas fa-chart-line",onClick:()=>t("analytics")},{key:"profile",label:"Profile",icon:"fas fa-user-circle",onClick:()=>t("profile")}];_.useEffect(()=>{let V=!0;async function ee(){try{const ce=await yt.getMe(),Be=(ce==null?void 0:ce.role)||(ce==null?void 0:ce.Role)||(ce==null?void 0:ce.roleName)||(ce==null?void 0:ce.userRole)||(Array.isArray(ce==null?void 0:ce.roles)?ce.roles[0]:"");V&&we(Be||"")}catch{try{const ce=localStorage.getItem("token");if(ce){const Be=Er(ce),Ue=(Be==null?void 0:Be.role)||(Be==null?void 0:Be.Role)||Be["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"];V&&we(Ue||"")}}catch{}}}async function ae(){try{Y(!0);const ce=await Te.getAllStations(1,100);if(!V)return;R(ce||[]),A(Be=>Be||"")}catch(ce){if(!V)return;se((ce==null?void 0:ce.message)||"Failed to load stations")}finally{V&&Y(!1)}}return ee(),ae(),ut(),At(),()=>{V=!1}},[]),_.useEffect(()=>{let V=!0;async function ee(){V&&(await Wi(B),await er(B))}return ee(),()=>{V=!1}},[B,I]),_.useEffect(()=>{let V=!0;async function ee(){try{X(!0);let ae=[];if(B){try{ae=await Te.getBookingsByStation(B)}catch{ae=[]}if(!ae||ae.length===0)try{const H=await Te.listBookings({page:1,pageSize:200}),Re=String(B);ae=(H||[]).filter($e=>{var W,Ze;const xe=$e.stationId||$e.StationId||((W=$e.station)==null?void 0:W.id)||((Ze=$e.station)==null?void 0:Ze.Id)||$e.pickupStationId||$e.PickupStationId;return xe!=null&&String(xe)===Re})}catch{}if(ae&&ae.length>0){const H=String(B);ae=ae.filter(Re=>{var xe,W,Ze,lt,Pe,jt,an;return[Re.stationId,Re.StationId,(xe=Re.station)==null?void 0:xe.id,(W=Re.station)==null?void 0:W.Id,Re.pickupStationId,Re.PickupStationId,Re.pickUpStationId,Re.PickUpStationId,Re.startStationId,Re.StartStationId,Re.originStationId,Re.OriginStationId,Re.fromStationId,Re.FromStationId,(Ze=Re.car)==null?void 0:Ze.stationId,(lt=Re.car)==null?void 0:lt.StationId,(Pe=Re.car)==null?void 0:Pe.currentStationId,(jt=Re.vehicle)==null?void 0:jt.stationId,(an=Re.vehicle)==null?void 0:an.StationId].some(on=>on!=null&&String(on)===H)})}}else ae=await Te.listBookings({page:1,pageSize:100});if(!V)return;const ce=(ae||[]).map(H=>{var On,zr,$r,Dn,qe,it,tr,kn,bn,vr,Oe,ct,_r,nr,Ft,vi,rr,Je,dt,ir,Wr,Hr,qi,Zr,Gi,Yi,_i,Ki,Ji,wi,Vs,Qi,eo,De,gn,st,qs,Xi,es,ts,sr,ns,Vr,It,ar,Gs,Ys;const Re=H.id||H.Id||H.bookingId||H.BookingId,$e=((On=H.car)==null?void 0:On.brand)||((zr=H.car)==null?void 0:zr.Brand)||(($r=H.vehicle)==null?void 0:$r.brand)||((Dn=H.vehicle)==null?void 0:Dn.Brand)||H.carBrand||H.CarBrand||null,xe=((qe=H.car)==null?void 0:qe.model)||((it=H.car)==null?void 0:it.Model)||((tr=H.vehicle)==null?void 0:tr.model)||((kn=H.vehicle)==null?void 0:kn.Model)||H.carModel||H.CarModel||null;let W=H.carName||H.vehicleName||((bn=H.car)==null?void 0:bn.name)||((vr=H.car)==null?void 0:vr.Name)||null;!W&&($e||xe)&&(W=[$e,xe].filter(Boolean).join(" ").trim()||null),!W&&typeof H.carInfo=="string"&&H.carInfo.trim()&&(W=H.carInfo.trim()),!W&&typeof H.CarInfo=="string"&&H.CarInfo.trim()&&(W=H.CarInfo.trim()),W=W||"Booking";const Ze=((Oe=H.user)==null?void 0:Oe.firstName)||((ct=H.customer)==null?void 0:ct.firstName)||H.firstName||H.FirstName||((_r=H.user)==null?void 0:_r.FirstName)||((nr=H.customer)==null?void 0:nr.FirstName),lt=((Ft=H.user)==null?void 0:Ft.lastName)||((vi=H.customer)==null?void 0:vi.lastName)||H.lastName||H.LastName||((rr=H.user)==null?void 0:rr.LastName)||((Je=H.customer)==null?void 0:Je.LastName),Pe=[Ze,lt].filter(Boolean).join(" "),jt=Pe||H.customerName||H.userFullName||((dt=H.user)==null?void 0:dt.fullName)||((ir=H.customer)==null?void 0:ir.name)||((Wr=H.user)==null?void 0:Wr.name)||"Customer",an=H.userId||H.UserId||((Hr=H.user)==null?void 0:Hr.id)||((qi=H.user)==null?void 0:qi.Id)||H.customerId||H.CustomerId||H.appUserId||H.AppUserId||H.accountId||H.AccountId||H.UserID||H.ownerId||H.OwnerId||H.createdById||H.CreatedById||"",on=((Zr=H.user)==null?void 0:Zr.userName)||((Gi=H.user)==null?void 0:Gi.UserName)||((Yi=H.user)==null?void 0:Yi.username)||H.userName||H.UserName||H.username||null,Nn=((_i=H.user)==null?void 0:_i.email)||H.customerEmail||H.email||H.userEmail||"",xr=((Ki=H.user)==null?void 0:Ki.address)||H.customerAddress||H.address||"",Mt=H.statusCode??H.StatusCode??H.bookingStatus??H.BookingStatus??H.status??H.Status;let kt="booked",bt="Booked";if(Mt!=null&&(typeof Mt=="number"||/^\d+$/.test(String(Mt)))){const Tt=Number(Mt);Tt===0?(kt="pending",bt="Pending"):Tt===1?(kt="booked",bt="Active"):Tt===2?(kt="waiting-checkin",bt="Waiting for check-in"):Tt===3?(kt="checked-in",bt="Checked-in"):Tt===4?(kt="checkout-pending",bt="Check-out pending"):Tt===5?(kt="completed",bt="Completed"):Tt===6?(kt="cancelled-refund",bt="Cancelled pending refund"):Tt===7&&(kt="cancelled",bt="Cancelled")}else{const Tt=String(Mt||"").toLowerCase();Tt.includes("pending")||Tt.includes("wait")?(kt="pending",bt="Pending"):Tt.includes("active")?(kt="booked",bt="Active"):Tt.includes("check")&&Tt.includes("in")?(kt="checked-in",bt="Checked-in"):Tt.includes("complete")||Tt.includes("finish")?(kt="completed",bt="Completed"):Tt.includes("cancel")?(kt="cancelled",bt="Cancelled"):(kt="booked",bt="Booked")}const Un=String(Mt||"").toLowerCase(),Zi=Number(Mt)===0||Un.includes("pending")||Un.includes("wait")?"waiting-payment":Un.includes("check")&&Un.includes("in")&&(Un.includes("pay")||Un.includes("payment"))?"checkin-payment":null,Vi=H.date||H.createdAt||H.bookingDate||"",Dr=H.carImageUrl||((Ji=H.car)==null?void 0:Ji.imageUrl)||((wi=H.vehicle)==null?void 0:wi.imageUrl)||null;return{id:Re,title:W,firstName:Ze||null,lastName:lt||null,fullName:Pe||H.userFullName||((Vs=H.user)==null?void 0:Vs.fullName)||((Qi=H.customer)==null?void 0:Qi.name)||((eo=H.user)==null?void 0:eo.name)||null,customer:jt,userId:an,userName:on,email:Nn,address:xr,status:kt,statusLabel:bt,uiStage:Zi,date:Vi,img:Dr,carId:H.carId||H.CarId||((De=H.car)==null?void 0:De.id)||((gn=H.car)==null?void 0:gn.Id)||((st=H.vehicle)==null?void 0:st.id)||((qs=H.vehicle)==null?void 0:qs.Id)||null,cccdFrontUrl:H.cccdFrontUrl||H.identityFrontUrl||H.idFrontUrl||H.frontImageUrl||H.frontIdUrl||H.cccdFrontImageUrl||((Xi=H.customer)==null?void 0:Xi.cccdFrontUrl)||((es=H.user)==null?void 0:es.cccdFrontUrl),cccdBackUrl:H.cccdBackUrl||H.identityBackUrl||H.idBackUrl||H.backImageUrl||H.backIdUrl||H.cccdBackImageUrl||((ts=H.customer)==null?void 0:ts.cccdBackUrl)||((sr=H.user)==null?void 0:sr.cccdBackUrl),gplxFrontUrl:H.gplxFrontUrl||H.driverLicenseFrontUrl||H.gplxImageUrl_Front||((ns=H.customer)==null?void 0:ns.gplxImageUrl_Front)||((Vr=H.user)==null?void 0:Vr.gplxImageUrl_Front),gplxBackUrl:H.gplxBackUrl||H.driverLicenseBackUrl||H.gplxImageUrl_Back||((It=H.customer)==null?void 0:It.gplxImageUrl_Back)||((ar=H.user)==null?void 0:ar.gplxImageUrl_Back),idString:H.customerIdNumber||((Gs=H.user)==null?void 0:Gs.identityNumber)||"",phone:H.customerPhone||((Ys=H.user)==null?void 0:Ys.phoneNumber)||""}});s(ce);const Be=ce.filter(H=>H.userId&&!(H.firstName&&H.lastName));if(Be.length>0)try{const H=Array.from(new Set(Be.map(xe=>xe.userId))),Re=await Promise.all(H.map(async xe=>{try{const W=await yt.getUserById(xe),Ze=(W==null?void 0:W.firstName)||(W==null?void 0:W.FirstName)||(W==null?void 0:W.givenName)||(W==null?void 0:W.GivenName)||null,lt=(W==null?void 0:W.lastName)||(W==null?void 0:W.LastName)||(W==null?void 0:W.surname)||(W==null?void 0:W.Surname)||null,Pe=(W==null?void 0:W.fullName)||(W==null?void 0:W.FullName)||[Ze,lt].filter(Boolean).join(" ")||null,jt=(W==null?void 0:W.userName)||(W==null?void 0:W.UserName)||(W==null?void 0:W.username)||(W==null?void 0:W.user_name)||null,an=(W==null?void 0:W.address)||(W==null?void 0:W.Address)||"",on=(W==null?void 0:W.identityNumber)||(W==null?void 0:W.identityNo)||(W==null?void 0:W.idNumber)||(W==null?void 0:W.IdNumber)||(W==null?void 0:W.cmnd)||(W==null?void 0:W.CMND)||(W==null?void 0:W.citizenId)||(W==null?void 0:W.CitizenId)||"",Nn=(W==null?void 0:W.phoneNumber)||(W==null?void 0:W.phone)||(W==null?void 0:W.Phone)||(W==null?void 0:W.mobile)||(W==null?void 0:W.Mobile)||(W==null?void 0:W.PhoneNumber)||"";return{uid:xe,firstName:Ze,lastName:lt,fullName:Pe,userName:jt,address:an,idNumber:on,phone:Nn}}catch{return{uid:xe,firstName:null,lastName:null,fullName:null,userName:null,address:"",idNumber:"",phone:""}}}));if(!V)return;const $e=new Map(Re.map(xe=>[xe.uid,xe]));s(xe=>xe.map(W=>{if(W.userId&&$e.has(W.userId)){const Ze=$e.get(W.userId),lt=W.fullName||Ze.fullName||[Ze.firstName,Ze.lastName].filter(Boolean).join(" ");return{...W,firstName:W.firstName??Ze.firstName??null,lastName:W.lastName??Ze.lastName??null,fullName:lt||W.customer||W.userName||null,userName:W.userName??Ze.userName,address:W.address||Ze.address,idString:W.idString||Ze.idNumber||W.idString||"",phone:W.phone||Ze.phone||W.phone||""}}return W}))}catch{}const Ue=H=>{var Re,$e,xe,W;return H.carId||H.CarId||H.vehicleId||H.VehicleId||((Re=H.car)==null?void 0:Re.id)||(($e=H.car)==null?void 0:$e.Id)||((xe=H.vehicle)==null?void 0:xe.id)||((W=H.vehicle)==null?void 0:W.Id)},je=ce.filter(H=>(!H.title||H.title==="Booking")&&Ue(H));if(je.length>0)try{const H=Array.from(new Set(je.map(Ue).filter(Boolean))),Re=await Promise.all(H.map(async xe=>{try{let W=await Te.getCarById(xe);if(!W||!W.id&&!W.Id)try{W=await Te.getCarByIdRest(xe)}catch{}const Ze=(W==null?void 0:W.name)||(W==null?void 0:W.Name)||[W==null?void 0:W.brand,W==null?void 0:W.model].filter(Boolean).join(" ")||null,lt=(W==null?void 0:W.imageUrl)||(W==null?void 0:W.thumbnailUrl)||null;return{cid:xe,name:Ze,img:lt}}catch{return{cid:xe,name:null,img:null}}})),$e=new Map(Re.map(xe=>[String(xe.cid),xe]));s(xe=>xe.map(W=>{const Ze=Ue(W),lt=Ze!=null?String(Ze):null;if(lt&&$e.has(lt)){const Pe=$e.get(lt);return{...W,title:W.title&&W.title!=="Booking"?W.title:Pe.name||W.title,img:W.img||Pe.img||W.img}}return W}))}catch{}const ft=(H=>H.filter(Re=>!Re.title||Re.title==="Booking"))(ce);if(ft.length>0)try{const H=await Promise.all(ft.map(async $e=>{try{const xe=await Te.getVehicleModelFromBooking($e.id),W=(xe==null?void 0:xe.name)||[xe==null?void 0:xe.brand,xe==null?void 0:xe.model].filter(Boolean).join(" ")||null;return{id:$e.id,title:W}}catch{return{id:$e.id,title:null}}})),Re=new Map(H.map($e=>[$e.id,$e.title]));s($e=>$e.map(xe=>Re.has(xe.id)&&Re.get(xe.id)?{...xe,title:Re.get(xe.id)}:xe))}catch{}}catch(ae){if(!V)return;se((ae==null?void 0:ae.message)||"Failed to load bookings")}finally{V&&X(!1)}}return ee(),()=>{V=!1}},[B]),_.useEffect(()=>{e==="staff"&&B&&Cn(B),e==="feedback"&&Hi()},[e,B]);const Hi=async(V=Qn,ee=D,ae=ke)=>{de(!0);try{const ce=await Te.getFeedbacks({page:V,pageSize:ee,search:ae}),Be=(ce==null?void 0:ce.items)||(ce==null?void 0:ce.data)||[];le(Be),Ie(V),Ke(ee)}catch(ce){se((ce==null?void 0:ce.message)||"Failed to load feedbacks"),le([])}finally{de(!1)}};return r.jsxs("div",{className:"app-layout",children:[r.jsx(HS,{toggleSidebar:()=>j(V=>!V),sidebarVisible:C}),r.jsx("div",{className:`sidebar-wrapper ${C?"visible":""}`,children:r.jsx(by,{title:"FEC Admin",menuItems:Zs,isOpen:C,toggleSidebar:()=>j(V=>!V),onSelect:t,activeKey:e})}),r.jsxs("main",{className:`main-content ${C?"shifted":""}`,children:[O&&r.jsx("div",{style:{background:"#fff7e6",color:"#8a6d3b",padding:"8px 12px",borderRadius:6,marginBottom:12,border:"1px solid #ffe1b3"},children:O}),_e&&r.jsx("div",{style:{background:"#ffecec",color:"#b00020",padding:"8px 12px",borderRadius:6,marginBottom:12},children:_e}),e==="booking"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsxs("select",{value:B,onChange:V=>A(V.target.value),disabled:G,children:[r.jsx("option",{value:"",children:"All stations"}),I.map(V=>{const ee=V.id||V.Id,ae=V.name||V.Name||V.stationName||`Station ${ee}`;return r.jsx("option",{value:ee,children:ae},ee)})]}),z&&r.jsx("span",{children:"Loading bookings"})]}),!z&&n.length===0&&r.jsx("div",{style:{padding:"10px 12px",color:"#555"},children:"No bookings to display for this station."}),r.jsx(qS,{bookings:n,search:w,setSearch:N,statusFilter:b,setStatusFilter:T,onContinuePayment:Ve,onCancelBooking:Ee,onStatusUpdated:ie})]}),e==="vehicle"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("label",{style:{fontWeight:600},children:"Station:"}),r.jsxs("select",{value:B,onChange:V=>A(V.target.value),disabled:G,children:[r.jsx("option",{value:"",children:"All stations"}),I.map(V=>{const ee=V.id||V.Id,ae=V.name||V.Name||V.stationName||`Station ${ee}`;return r.jsx("option",{value:ee,children:ae},ee)})]}),E&&r.jsx("span",{children:"Loading vehicles"})]}),r.jsx(e1,{vehicles:o,deletedVehicles:l,onAdd:Ae,onRemove:ot,onUpdate:Me,onRestore:Sn,stationId:B,canDelete:!0,stationSlots:Le,onTransferCar:Hs,stations:I})]}),e==="station"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:24,margin:0},children:"Stations Management"}),r.jsx("div",{style:{flex:1}}),r.jsx("button",{onClick:()=>ze(!0),style:{padding:"10px 16px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:14,transition:"background-color 0.2s"},onMouseOver:V=>V.target.style.backgroundColor="#27ae60",onMouseOut:V=>V.target.style.backgroundColor="#2ecc71",children:"+ Add Station"})]}),r.jsx("div",{style:{width:"100%"},children:!I||I.length===0?r.jsx("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,color:"#666"},children:r.jsx("p",{style:{fontSize:16,margin:0},children:"No stations found. Create one to get started."})}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:I.map(V=>r.jsxs("div",{style:{padding:16,border:"1px solid #ddd",borderRadius:8,backgroundColor:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"box-shadow 0.2s, transform 0.2s",cursor:"pointer"},onMouseOver:ee=>{ee.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",ee.currentTarget.style.transform="translateY(-2px)"},onMouseOut:ee=>{ee.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.05)",ee.currentTarget.style.transform="translateY(0)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:12},children:r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:700,fontSize:16,marginBottom:4},children:[" ",V.name||V.Name||`Station ${V.id||V.Id}`]}),r.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:8},children:V.address||V.Address||"No address provided"})]})}),V.phoneNumber&&r.jsxs("div",{style:{fontSize:12,color:"#555",marginBottom:4},children:[" ",V.phoneNumber]}),V.capacity&&r.jsxs("div",{style:{fontSize:12,color:"#555",marginBottom:8},children:[" Capacity: ",V.capacity," vehicles"]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,paddingTop:12,borderTop:"1px solid #eee"},children:[r.jsx("button",{onClick:()=>{he(V),nt(!0)},style:{flex:1,padding:"8px 12px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600,transition:"background-color 0.2s"},onMouseOver:ee=>ee.target.style.backgroundColor="#2980b9",onMouseOut:ee=>ee.target.style.backgroundColor="#3498db",children:"Details"}),r.jsx("button",{onClick:()=>{A(V.id||V.Id),t("booking")},style:{flex:1,padding:"8px 12px",backgroundColor:"#9b59b6",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:13,fontWeight:600,transition:"background-color 0.2s"},onMouseOver:ee=>ee.target.style.backgroundColor="#8e44ad",onMouseOut:ee=>ee.target.style.backgroundColor="#9b59b6",children:"Bookings"})]})]},V.id||V.Id))})}),r.jsx(j1,{open:Se,onClose:()=>ze(!1),onSubmit:async V=>{const ee=await Te.createStation(V);R(ae=>[ee,...ae||[]]),ze(!1)}}),r.jsx(S1,{open:pe,onClose:()=>{nt(!1),he(null)},station:sn,onUpdated:V=>R(ee=>ee.map(ae=>(ae.id||ae.Id)===(V.id||V.Id)?V:ae)),onDeleted:V=>R(ee=>ee.filter(ae=>(ae.id||ae.Id)!==V))})]}),e==="feedback"&&r.jsx(r.Fragment,{children:r.jsx(N1,{})}),e==="user"&&r.jsxs(r.Fragment,{children:[K&&r.jsx("div",{style:{padding:"10px 12px"},children:"Loading users..."}),r.jsx(a1,{users:u,deletedUsers:m,loadingDeleted:$,onAssignStaff:Et,onDeleteUser:$i,onRestoreUser:yr,onUserCreated:ut,onLoadDeleted:Xn})]}),e==="staff"&&r.jsxs(r.Fragment,{children:[(K||re)&&r.jsx("div",{style:{padding:"10px 12px"},children:"Loading staff..."}),r.jsx(d1,{users:u,staffByStation:v,stations:I,onRemoveStaff:rt,onAssignStation:Or,onUnassignStation:Fn,onStaffCreated:ut})]}),e==="incident"&&r.jsx(r.Fragment,{children:r.jsx(p1,{})}),e==="analytics"&&r.jsx(r.Fragment,{children:r.jsx(_1,{})}),e==="profile"&&r.jsx(h1,{})]})]})}const By=_.createContext(null);function Ms(){return _.useContext(By)}function L1({children:e}){const[t,n]=_.useState(()=>{try{return JSON.parse(localStorage.getItem("user"))||null}catch{return null}}),[s,o]=_.useState(()=>localStorage.getItem("token")||null),[a,l]=_.useState(!1),[d,u]=_.useState(!1);_.useEffect(()=>{s?localStorage.setItem("token",s):localStorage.removeItem("token")},[s]),_.useEffect(()=>{t?(localStorage.setItem("user",JSON.stringify(t)),t.email&&localStorage.setItem("userEmail",t.email)):(localStorage.removeItem("user"),localStorage.removeItem("userEmail"))},[t]),_.useEffect(()=>{function k(v){try{if(!v){o(localStorage.getItem("token")||null);const x=localStorage.getItem("user");n(x?JSON.parse(x):null);return}if(v.key==="token"){o(localStorage.getItem("token")||null);return}if(v.key==="user"){const x=localStorage.getItem("user");try{n(x?JSON.parse(x):null)}catch{n(null)}return}if(v.key==="userRole"||v.key==="stationId"){const x=localStorage.getItem("user");try{n(x?JSON.parse(x):null)}catch{}return}}catch(x){console.warn("Error handling storage event in AuthContext:",x)}}return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[]);async function f(k,v){var w,N,b,T;const x=await yt.login(k,v),C=x.token||((w=x.payload)==null?void 0:w.token)||((N=x.raw)==null?void 0:N.token);C&&o(C);const j=((b=x.payload)==null?void 0:b.user)||((T=x.raw)==null?void 0:T.user)||x.payload&&x.payload.user||JSON.parse(localStorage.getItem("user"));return j&&n(j),l(!1),x}async function m(k,v,x,C){return await yt.register({fullName:k,email:v,phoneNumber:x,password:C})}function g(){o(null),n(null),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userEmail"),localStorage.removeItem("stationId"),localStorage.removeItem("userRole")}const y={user:t,token:s,login:f,logout:g,register:m,showLogin:a,setShowLogin:l,showRegister:d,setShowRegister:u};return r.jsx(By.Provider,{value:y,children:e})}function _p({children:e,requireStaff:t=!1,requireAdmin:n=!1}){const{user:s,token:o}=Ms(),a=(s==null?void 0:s.role)||(s==null?void 0:s.Role)||(s==null?void 0:s.roleName)||(s==null?void 0:s.userRole)||(Array.isArray(s==null?void 0:s.roles)?s.roles[0]:null),l=typeof window<"u"?localStorage.getItem("userRole"):null,d=a||l||"",u=d&&(d.includes("Staff")||d.toLowerCase().includes("staff")||d==="StationManager"||d.toLowerCase().includes("manager")),f=d&&(d.includes("Admin")||d.toLowerCase().includes("admin")||d==="SystemAdmin"||d.toLowerCase().includes("administrator"));return n?!o||!f?r.jsx(Ic,{to:"/",replace:!0}):e:t?!o||!u&&!f?r.jsx(Ic,{to:"/",replace:!0}):e:o?e:r.jsx(Ic,{to:"/",replace:!0})}function P1(){const{user:e,logout:t,setShowLogin:n,setShowRegister:s}=Ms(),o=rn(),[a,l]=_.useState(!1),[d,u]=_.useState({isOpen:!1,type:"info",title:"",message:""});function f(){l(y=>!y)}_.useEffect(()=>{const y=()=>{console.log(" Navigating to update profile page"),o("/update-profile"),l(!1)};return window.addEventListener("openUpdateProfile",y),()=>window.removeEventListener("openUpdateProfile",y)},[o]),_.useEffect(()=>{function y(k){a&&!k.target.closest(".user-menu")&&l(!1)}return document.addEventListener("click",y),()=>document.removeEventListener("click",y)},[a]);const m=e&&e.userRole==="Station Staff",g=e&&e.userRole==="Admin";return r.jsxs(r.Fragment,{children:[r.jsx("header",{className:"header",children:r.jsxs("div",{className:"container header-container",children:[r.jsx("div",{className:"logo",children:r.jsx("a",{href:"/",children:"FEC"})}),r.jsxs("nav",{className:"nav",children:[r.jsxs("div",{className:"navbar-left",children:[m&&r.jsxs("a",{href:"/staff",className:"staff-portal-btn",children:[r.jsx("i",{className:"fas fa-user-shield"})," Staff Portal"]}),g&&r.jsxs("a",{href:"/admin",className:"admin-portal-btn",children:[r.jsx("i",{className:"fas fa-user-shield"})," Admin Portal"]})]}),r.jsxs("div",{className:"navbar-right",children:[!e&&r.jsx("button",{id:"loginBtn",onClick:()=>n(!0),className:"login-nav-btn",children:"Log in"}),e&&r.jsxs("div",{className:"user-menu",children:[r.jsxs("button",{className:"user-menu-btn",onClick:f,children:[r.jsx("i",{className:"fas fa-user-circle"}),r.jsx("i",{className:"fas fa-chevron-down"})]}),r.jsxs("div",{className:`user-dropdown ${a?"show":""}`,children:[r.jsxs("div",{className:"dropdown-header",children:[r.jsx("i",{className:"fas fa-user-circle"}),r.jsx("span",{id:"userEmail",children:e.email||"User Account"})]}),r.jsx("hr",{}),r.jsxs("a",{href:"/profile",children:[" ",r.jsx("i",{className:"fas fa-user-cog"})," User Profile"]}),r.jsxs("a",{href:"/update-profile",children:[" ",r.jsx("i",{className:"fas fa-edit"})," Update Profile"]}),r.jsxs("a",{href:"/booking-history",children:[" ",r.jsx("i",{className:"fas fa-history"})," Booking History"]}),r.jsxs("a",{href:"#",onClick:y=>{y.preventDefault();const k=(e==null?void 0:e.email)||"User";t(),l(!1),u({isOpen:!0,type:"success",title:"Logged Out Successfully! ",message:`You have been logged out.
Goodbye, ${k}!`,autoCloseMs:2e3}),setTimeout(()=>o("/"),2e3)},children:[" ",r.jsx("i",{className:"fas fa-sign-out-alt"})," Logout"]})]})]})]})]})]})}),r.jsx(Ur,{isOpen:d.isOpen,type:d.type,title:d.title,message:d.message,autoCloseMs:d.autoCloseMs,onClose:()=>u(y=>({...y,isOpen:!1}))})]})}function E1(){return r.jsx("footer",{className:"footer",children:r.jsx("div",{className:"container",children:r.jsx("p",{children:" 2025 FEC. All rights reserved."})})})}const T1=()=>{const[e,t]=_.useState({soHopDong:"",ngayKy:new Date().getDate().toString(),thangKy:(new Date().getMonth()+1).toString(),namKy:new Date().getFullYear().toString(),benA:{hoTen:""},xe:{bienSo:""},thoiHanThueSo:"1",thoiHanThueChu:"mt",giaThueSo:"10,000,000",giaThueChu:"mi triu ng",phuongThucThanhToan:"Chuyn khon",ngayThanhToan:"15 hng thng"}),[n,s]=_.useState(""),[o,a]=_.useState(""),[l,d]=_.useState(null),[u,f]=_.useState(!1),m=rn(),g=k=>{const{name:v,value:x}=k.target;if(v.includes(".")){const[C,j]=v.split(".");t(w=>({...w,[C]:{...w[C],[j]:x}}))}else t(C=>({...C,[v]:x}))},y=async k=>{k.preventDefault(),f(!0),d(null);try{const v={...e,thoiHanThue:1,donViThoiHan:"thang",gplx:{hang:"B1",so:"123456789",hanSuDung:"31/12/2030"}},x=await gr.createHopDong(v,n,o);x&&x.isSuccess!==!1?(alert("Contract created successfully!"),m(`/contract/${x}`)):d((x==null?void 0:x.message)||"Failed to create contract")}catch(v){d(v.message||"An error occurred."),console.error("Create contract error:",v)}f(!1)};return r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Create New Contract"})}),r.jsx("div",{className:"card-body",children:r.jsxs("form",{onSubmit:y,children:[r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Booking ID"}),r.jsx("input",{type:"text",className:"form-control",value:n,onChange:k=>s(k.target.value),required:!0})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Renter ID"}),r.jsx("input",{type:"text",className:"form-control",value:o,onChange:k=>a(k.target.value),required:!0})]})]}),r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Contract Number"}),r.jsx("input",{type:"text",name:"soHopDong",className:"form-control",value:e.soHopDong,onChange:g,required:!0})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"Renter's Full Name"}),r.jsx("input",{type:"text",name:"benA.hoTen",className:"form-control",value:e.benA.hoTen,onChange:g,required:!0})]})]}),r.jsx("div",{className:"row",children:r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"License Plate"}),r.jsx("input",{type:"text",name:"xe.bienSo",className:"form-control",value:e.xe.bienSo,onChange:g,required:!0})]})}),l&&r.jsx("div",{className:"alert alert-danger",children:l}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?"Creating...":"Create Contract"})]})})]})},B1=()=>{const[e,t]=_.useState([]),[n,s]=_.useState(!0),[o,a]=_.useState(null),l=localStorage.getItem("userId")||"3fa85f64-5717-4562-b3fc-2c963f66afa6";_.useEffect(()=>{(async()=>{try{const f=await gr.getContractsByRenter(l);f&&f.length>0?t(f):t([])}catch(f){console.error("Fetch contracts error:",f),a(f.message||"An error occurred while fetching contracts.")}s(!1)})()},[l]);const d=async(u,f)=>{try{const m=await gr.downloadContractById(u),g=window.URL.createObjectURL(new Blob([m])),y=document.createElement("a");y.href=g,y.setAttribute("download",`HopDong_${f||u}.docx`),document.body.appendChild(y),y.click(),y.remove(),window.URL.revokeObjectURL(g)}catch(m){a(m.message||"An error occurred while downloading the contract.")}};return n?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):o?r.jsxs("p",{className:"text-danger",children:["Error: ",o]}):r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[r.jsx("h2",{className:"card-title mb-0",children:"My Contracts"}),r.jsx(Lc,{to:"/contract/new",className:"btn btn-primary",children:"Create New Contract"})]}),r.jsx("div",{className:"card-body",children:r.jsxs("table",{className:"table table-striped",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Contract Number"}),r.jsx("th",{children:"Booking ID"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Created At"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.length>0?e.map(u=>r.jsxs("tr",{children:[r.jsx("td",{children:u.soHopDong||"N/A"}),r.jsx("td",{children:r.jsx(Lc,{to:`/contract/${u.contractId}`,children:u.bookingId})}),r.jsx("td",{children:r.jsx("span",{className:`badge bg-${u.isConfirmed?"success":"warning"}`,children:u.isConfirmed?"Confirmed":"Pending"})}),r.jsx("td",{children:new Date(u.createdAt).toLocaleDateString()}),r.jsxs("td",{children:[r.jsx(Lc,{to:`/contract/${u.contractId}`,className:"btn btn-sm btn-info me-2",children:"View"}),r.jsx("button",{onClick:()=>d(u.contractId,u.soHopDong),className:"btn btn-sm btn-secondary",children:"Download"})]})]},u.contractId)):r.jsx("tr",{children:r.jsx("td",{colSpan:"5",className:"text-center",children:"No contracts found."})})})]})})]})},R1=()=>{const{id:e}=Wg(),[t,n]=_.useState(null),[s,o]=_.useState(!0),[a,l]=_.useState(null),[d,u]=_.useState("");_.useEffect(()=>{(async()=>{try{const g=await gr.getContractByBooking(e);g?n(g):l("Failed to fetch contract")}catch(g){l(g.message||"An error occurred while fetching the contract.")}o(!1)})()},[e]);const f=async()=>{if(!d){l("Please enter an email address.");return}try{await gr.sendConfirmationEmail(t.contractId,d),alert("Confirmation email sent successfully!"),u("")}catch(m){l(m.message||"Failed to send confirmation email.")}};return s?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):a?r.jsxs("p",{className:"text-danger",children:["Error: ",a]}):t?r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Contract Details"})}),r.jsxs("div",{className:"card-body",children:[r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Contract ID:"})," ",t.contractId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Booking ID:"})," ",t.bookingId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Renter ID:"})," ",t.renterId]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Status:"}),r.jsx("span",{className:`badge bg-${t.isConfirmed?"success":"warning"} ms-2`,children:t.isConfirmed?"Confirmed":"Pending"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Created At:"})," ",new Date(t.createdAt).toLocaleString()]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("strong",{children:"Contract Content:"}),r.jsx("pre",{className:"border p-3",children:t.contractContent})]}),!t.isConfirmed&&r.jsxs("div",{className:"mt-4",children:[r.jsx("h5",{children:"Confirm Contract"}),r.jsxs("div",{className:"input-group mb-3",children:[r.jsx("input",{type:"email",className:"form-control",placeholder:"Enter email to receive confirmation link",value:d,onChange:m=>u(m.target.value)}),r.jsx("button",{className:"btn btn-primary",onClick:f,children:"Send Confirmation"})]})]})]})]}):r.jsx("p",{children:"No contract found."})},A1=()=>{const[e]=Gg(),t=rn(),n=e.get("token"),[s,o]=_.useState(""),[a,l]=_.useState(null),[d,u]=_.useState(!0),[f,m]=_.useState(null),[g,y]=_.useState(!1),[k,v]=_.useState(!1),[x,C]=_.useState(!1),[j,w]=_.useState(!1);_.useEffect(()=>{if(!n){m("No confirmation token provided."),u(!1);return}(async()=>{try{const T=await gr.getContractForConfirmation(n);T?(l(T),o(T.noiDungHtml||T.htmlContent||"")):m("Failed to fetch contract for confirmation.")}catch(T){m(T.message||"An error occurred.")}u(!1)})()},[n]);const N=async()=>{y(!0),m(null);try{console.log(" Signing contract with token:",n);const b=await gr.signContract(n);console.log(" Sign response:",b),console.log(" Response type:",typeof b),console.log(" Response is truthy:",!!b),console.log(" Contract signed successfully!"),w(!0),setTimeout(()=>{v(!0),console.log(" Redirecting to booking history..."),t("/booking-history")},4e3)}catch(b){console.error(" Error signing contract:",b),m(b.message||"An error occurred while signing.")}y(!1)};return d?r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"spinner-border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):f?r.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1050},children:r.jsxs("div",{style:{textAlign:"center",width:"100%",maxWidth:"680px"},children:[r.jsx("p",{className:"text-danger",style:{fontWeight:700,marginBottom:"1rem"},children:"Bn  k hp ng ny ri!!! Vui lng xem lch s t xe ca bn"}),r.jsx("button",{className:"btn btn-secondary",style:{display:"block",margin:"0 auto",width:"100%",maxWidth:"280px"},onClick:()=>t("/booking-history"),children:"XEM LCH S T XE"})]})}):k?r.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"100vh"},children:r.jsxs("div",{className:"alert alert-success text-center",style:{maxWidth:"600px"},children:[r.jsx("h4",{className:"alert-heading",children:" Sign Successfully!"}),r.jsx("p",{children:"Your contract has been signed successfully."}),r.jsx("p",{style:{fontSize:"14px",color:"#666"},children:"You will be redirected to booking history in a moment..."})]})}):r.jsxs(r.Fragment,{children:[r.jsx(Ur,{isOpen:j,type:"success",title:"Sign Successfully!",message:"Your contract has been signed successfully. You will be redirected to booking history in a moment...",onClose:()=>w(!1),autoCloseMs:4e3}),r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"card-header",children:[r.jsx("h2",{className:"card-title mb-3",children:"Confirm and Sign Contract"}),a&&r.jsx("div",{className:"contract-info",children:r.jsx("div",{className:"row",children:r.jsx("div",{className:"col-md-4"})})})]}),r.jsxs("div",{className:"card-body",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{className:"border p-4 mb-4",style:{maxWidth:"800px",width:"100%",maxHeight:"600px",overflowY:"auto",backgroundColor:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontFamily:"'Times New Roman', serif",fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:s}}),r.jsx("hr",{style:{width:"100%",maxWidth:"800px"}}),r.jsxs("div",{className:"form-check mb-3",style:{maxWidth:"800px",width:"100%"},children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"agreeCheck",checked:x,onChange:b=>C(b.target.checked)}),r.jsx("label",{className:"form-check-label",htmlFor:"agreeCheck",children:"I have read and agree to the terms of the contract."})]}),r.jsx("button",{className:"btn btn-primary btn-lg",style:{maxWidth:"800px",width:"100%"},onClick:N,disabled:g||!x,children:g?"Signing...":"Click to Sign"})]})]})]})},M1=()=>{const[e,t]=_.useState(!1),[n,s]=_.useState(null),[o,a]=_.useState(!1);_.useEffect(()=>{l()},[]);const l=async()=>{var d,u,f,m;t(!0),s(null),a(!1);try{const g=await gr.downloadMyLatestContract(),y=window.URL.createObjectURL(new Blob([g])),k=document.createElement("a");k.href=y,k.setAttribute("download",`latest_contract_${new Date().getTime()}.docx`),document.body.appendChild(k),k.click(),k.remove(),window.URL.revokeObjectURL(y),a(!0)}catch(g){console.error("Download error:",g);const y=((u=(d=g.response)==null?void 0:d.data)==null?void 0:u.message)||g.message||"An error occurred while downloading.";((f=g.response)==null?void 0:f.status)===401?s("Unauthorized: Token khng hp l hoc  ht hn. Vui lng ng nhp li."):((m=g.response)==null?void 0:m.status)===404?s("Khng tm thy hp ng no. Vui lng kim tra li."):s(y)}t(!1)};return r.jsxs("div",{className:"card w-50 mx-auto",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{className:"card-title",children:"Ti Xung Hp ng Mi Nht"})}),r.jsxs("div",{className:"card-body",children:[r.jsx("p",{children:"Ti xung hp ng mi nht ca bn da trn token ng nhp."}),e&&r.jsxs("div",{className:"alert alert-info",children:[r.jsx("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"ang ti xung..."]}),n&&r.jsxs("div",{className:"alert alert-danger",role:"alert",children:[r.jsx("strong",{children:"Li:"})," ",n,r.jsx("div",{className:"mt-3",children:r.jsx("button",{className:"btn btn-primary btn-sm",type:"button",onClick:l,disabled:e,children:"Th li"})})]}),o&&r.jsx("div",{className:"alert alert-success",role:"alert",children:" Hp ng  c ti xung thnh cng!"}),!e&&!n&&!o&&r.jsx("button",{className:"btn btn-primary",type:"button",onClick:l,children:"Ti Xung"})]})]})};function F1(){const e=xi(),t=e.pathname.startsWith("/staff")||e.pathname.startsWith("/admin");return r.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",flex:1},children:[!t&&r.jsx(P1,{}),r.jsx("main",{style:{flex:1},children:r.jsxs(W0,{children:[r.jsx(Ot,{path:"/",element:r.jsx(lS,{})}),r.jsx(Ot,{path:"/cars",element:r.jsx(cS,{})}),r.jsx(Ot,{path:"/cars/:id",element:r.jsx(dS,{})}),r.jsx(Ot,{path:"/payment",element:r.jsx(hS,{})}),r.jsx(Ot,{path:"/payment-success",element:r.jsx(fS,{})}),r.jsx(Ot,{path:"/payment-cancel",element:r.jsx(pS,{})}),r.jsx(Ot,{path:"/transaction",element:r.jsx(mS,{})}),r.jsx(Ot,{path:"/booking-history",element:r.jsx(yS,{})}),r.jsx(Ot,{path:"/profile",element:r.jsx(Lj,{})}),r.jsx(Ot,{path:"/update-profile",element:r.jsx(Pj,{})}),r.jsx(Ot,{path:"/contract/new",element:r.jsx(T1,{})}),r.jsx(Ot,{path:"/contract/list",element:r.jsx(B1,{})}),r.jsx(Ot,{path:"/contract/:id",element:r.jsx(R1,{})}),r.jsx(Ot,{path:"/contract/download-latest",element:r.jsx(M1,{})}),r.jsx(Ot,{path:"/xac-nhan-hop-dong",element:r.jsx(A1,{})}),r.jsx(Ot,{path:"/staff",element:r.jsx(_p,{requireStaff:!0,children:r.jsx(DS,{})})}),r.jsx(Ot,{path:"/admin",element:r.jsx(_p,{requireAdmin:!0,children:r.jsx(I1,{})})})]})}),!t&&r.jsx(E1,{})]})}function U1(){return r.jsx(J0,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:r.jsx(F1,{})})}function O1({isOpen:e,userEmail:t,onClose:n,onSuccess:s}){const[o,a]=_.useState({firstName:"",lastName:"",phoneNumber:"",address:"",dateOfBirth:"",yearOfBirth:"",identityNumber:"",driverLicenseNumber:"",driverLicenseExpiry:"",driverLicenseClass:""}),[l,d]=_.useState(!1),[u,f]=_.useState(""),[m,g]=_.useState(!1),[y,k]=_.useState([]);mr.useEffect(()=>{if(e){const w=t||localStorage.getItem("userEmail")||"";console.log(" UpdateProfileModal opened with email:",w),v()}},[e,t]);const v=async()=>{try{g(!0),console.log(" Loading profile data from API...");const w=await yt.getMyProfile();console.log(" Profile data loaded:",w);const N=[];(!w.address||w.address.trim()==="")&&N.push("address"),(!w.driverLicenseNumber||w.driverLicenseNumber.trim()==="")&&N.push("driverLicenseNumber"),(!w.driverLicenseExpiry||w.driverLicenseExpiry.trim()==="")&&N.push("driverLicenseExpiry"),k(N),console.log(" Missing fields:",N),a({firstName:w.firstName||w.FirstName||"",lastName:w.lastName||w.LastName||"",phoneNumber:w.phoneNumber||w.PhoneNumber||"",address:w.address||w.Address||"",dateOfBirth:w.dateOfBirth||w.DateOfBirth||"",yearOfBirth:w.yearOfBirth||w.YearOfBirth||"",identityNumber:w.identityNumber||w.IdentityNumber||"",driverLicenseNumber:w.driverLicenseNumber||w.DriverLicenseNumber||"",driverLicenseExpiry:w.driverLicenseExpiry||w.DriverLicenseExpiry||"",driverLicenseClass:w.driverLicenseClass||w.DriverLicenseClass||""})}catch(w){console.error(" Error loading profile:",w)}finally{g(!1)}},x=w=>{const{name:N,value:b}=w.target;a(T=>({...T,[N]:b})),f("")},C=()=>o.firstName.trim()?o.lastName.trim()?o.phoneNumber.trim()?o.phoneNumber.match(/^[0-9]{10,11}$/)?!o.address||o.address.trim()===""?(f("Address is required"),!1):!o.dateOfBirth||o.dateOfBirth.trim()===""?(f("Date of Birth is required"),!1):!o.driverLicenseNumber||o.driverLicenseNumber.trim()===""?(f("Driver License Number is required"),!1):!o.driverLicenseExpiry||o.driverLicenseExpiry.trim()===""?(f("Driver License Expiry is required"),!1):!0:(f("Phone number must be 10-11 digits"),!1):(f("Phone number is required"),!1):(f("Last name is required"),!1):(f("First name is required"),!1),j=async w=>{var N,b;if(w.preventDefault(),console.log(" Form submitted"),!C()){console.log(" Form validation failed");return}d(!0);try{if(console.log(" Updating profile with data:",o),!localStorage.getItem("userId")){f("User ID not found"),d(!1);return}const I={firstName:o.firstName,lastName:o.lastName,phoneNumber:o.phoneNumber,address:o.address||"",dateOfBirth:o.dateOfBirth||"",yearOfBirth:o.yearOfBirth?parseInt(o.yearOfBirth):null,identityNumber:o.identityNumber||"",driverLicenseNumber:o.driverLicenseNumber||"",driverLicenseExpiry:o.driverLicenseExpiry||"",driverLicenseClass:o.driverLicenseClass||""},R=await $l.updateMyProfile(I);console.log(" Profile updated successfully:",R),localStorage.setItem("userFirstName",o.firstName),localStorage.setItem("userLastName",o.lastName),localStorage.setItem("userPhone",o.phoneNumber),s&&s(o),console.log(" Closing UpdateProfileModal"),n()}catch(T){console.error(" Error updating profile:",T),f(((b=(N=T.response)==null?void 0:N.data)==null?void 0:b.message)||"Failed to update profile. Please try again.")}finally{d(!1)}};return e?(console.log(" UpdateProfileModal: Rendering with isOpen=true"),m?r.jsx("div",{className:"modal-backdrop modal-backdrop-active",children:r.jsxs("div",{className:"modal-content modal-update-profile",children:[r.jsx("div",{className:"modal-header",children:r.jsx("h2",{children:"Loading Profile..."})}),r.jsx("div",{style:{padding:"20px",textAlign:"center"},children:r.jsx("p",{children:"Loading your profile data..."})})]})}):r.jsx("div",{className:"modal-backdrop modal-backdrop-active",children:r.jsxs("div",{className:"modal-content modal-update-profile",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:" Complete Your Profile"}),r.jsx("p",{className:"modal-subtitle",children:"Please fill in your information to complete registration"}),y.length>0&&r.jsxs("p",{className:"modal-subtitle",style:{marginTop:"10px",fontSize:"12px",color:"rgba(255,255,255,0.8)"},children:[" Missing: ",y.map(w=>w==="address"?"Address":w==="driverLicenseNumber"?"Driver License Number":w==="driverLicenseExpiry"?"Driver License Expiry":w).join(", ")]})]}),r.jsxs("form",{onSubmit:j,className:"update-profile-form",children:[u&&r.jsxs("div",{className:"form-error",children:[" ",u]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"firstName",children:"First Name *"}),r.jsx("input",{type:"text",id:"firstName",name:"firstName",value:o.firstName,onChange:x,placeholder:"John",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),r.jsx("input",{type:"text",id:"lastName",name:"lastName",value:o.lastName,onChange:x,placeholder:"Doe",required:!0})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email (Pre-filled)"}),r.jsx("input",{type:"email",id:"email",value:t||localStorage.getItem("userEmail")||"",disabled:!0,className:"form-control-disabled"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number *"}),r.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:o.phoneNumber,onChange:x,placeholder:"0912345678",required:!0})]})]}),r.jsxs("div",{className:`form-group ${y.includes("address")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"address",children:["Address",y.includes("address")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"text",id:"address",name:"address",value:o.address,onChange:x,placeholder:"123 Main St, City, Country",style:y.includes("address")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),r.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",value:o.dateOfBirth,onChange:x})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"yearOfBirth",children:"Year of Birth"}),r.jsx("input",{type:"number",id:"yearOfBirth",name:"yearOfBirth",value:o.yearOfBirth,onChange:x,placeholder:"1990",min:"1900",max:new Date().getFullYear()})]})]}),r.jsx("div",{className:"form-divider",children:r.jsx("span",{children:"Driver License Information"})}),r.jsxs("div",{className:`form-group ${y.includes("driverLicenseNumber")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseNumber",children:["Driver License Number",y.includes("driverLicenseNumber")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"text",id:"driverLicenseNumber",name:"driverLicenseNumber",value:o.driverLicenseNumber,onChange:x,placeholder:"ABC123456",style:y.includes("driverLicenseNumber")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:`form-group ${y.includes("driverLicenseExpiry")?"field-missing":""}`,children:[r.jsxs("label",{htmlFor:"driverLicenseExpiry",children:["Driver License Expiry",y.includes("driverLicenseExpiry")&&r.jsx("span",{style:{color:"#FF6B35",marginLeft:"4px"},children:" Required"})]}),r.jsx("input",{type:"date",id:"driverLicenseExpiry",name:"driverLicenseExpiry",value:o.driverLicenseExpiry,onChange:x,style:y.includes("driverLicenseExpiry")?{borderColor:"#FF6B35",backgroundColor:"#fff5f0"}:{}})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"driverLicenseClass",children:"Driver License Class"}),r.jsxs("select",{id:"driverLicenseClass",name:"driverLicenseClass",value:o.driverLicenseClass,onChange:x,children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"A",children:"Class A"}),r.jsx("option",{value:"A1",children:"Class A1"}),r.jsx("option",{value:"B",children:"Class B"}),r.jsx("option",{value:"C",children:"Class C"}),r.jsx("option",{value:"D",children:"Class D"}),r.jsx("option",{value:"E",children:"Class E"})]})]})]}),r.jsx("div",{className:"form-divider",children:r.jsx("span",{children:"Additional Information (Optional)"})}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"identityNumber",children:"Identity Number (CCCD)"}),r.jsx("input",{type:"text",id:"identityNumber",name:"identityNumber",value:o.identityNumber,onChange:x,placeholder:"123456789012"})]})}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:n,disabled:l,children:"Skip for Now"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?" Updating...":" Save Profile"})]})]})]})})):(console.log(" UpdateProfileModal: isOpen is false, not rendering"),null)}function D1(){const{showLogin:e,setShowLogin:t,login:n,setShowRegister:s,setShowForgotPassword:o}=Ms(),[a,l]=_.useState(""),[d,u]=_.useState(""),[f,m]=_.useState(""),[g,y]=_.useState({isOpen:!1,type:"info",title:"",message:""}),[k,v]=_.useState(!1),[x,C]=_.useState(!1);if(!e&&!g.isOpen&&!x)return null;const j=async T=>{try{console.log(" Checking profile completeness for user:",T);const I=await yt.getMyProfile();console.log(" Profile data from /Users/Get-My-Profile:",I);const R=[];return(!I.address||I.address.trim()==="")&&R.push("Address"),(!I.dateOfBirth||I.dateOfBirth.trim()==="")&&R.push("Date of Birth"),(!I.driverLicenseNumber||I.driverLicenseNumber.trim()==="")&&R.push("Driver License Number"),(!I.driverLicenseExpiry||I.driverLicenseExpiry.trim()==="")&&R.push("Driver License Expiry"),R.length>0?(console.log(" Incomplete profile fields:",R),!0):(console.log(" Profile is complete"),!1)}catch(I){return console.error(" Error checking profile:",I),!1}};async function w(T){var I,R;T.preventDefault(),m(""),v(!0);try{console.log(" Logging in user:",a);const B=await n(a,d),A=localStorage.getItem("userRole")||(B==null?void 0:B.role);console.log(" User role:",A);const E=A&&(A.includes("Renter")||A.includes("Customer"));if(console.log(" Is renter?",E),E&&await j(localStorage.getItem("userId"))){console.log(" Opening UpdateProfileModal directly"),C(!0),t(!1),v(!1);return}y({isOpen:!0,type:"success",title:"Log in Successful! ",message:"Welcome back!",autoCloseMs:2e3}),l(""),u(""),setTimeout(()=>{t(!1)},500)}catch(B){console.error(" Login error:",B);const A=B.message||((R=(I=B.response)==null?void 0:I.data)==null?void 0:R.message)||"Login failed";m(A),y({isOpen:!0,type:"error",title:"Login Failed ",message:A,autoCloseMs:3e3})}finally{v(!1)}}function N(){t(!1),s(!0)}function b(){t(!1),o(!0)}return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""})," ",r.jsx("br",{}),r.jsxs("form",{onSubmit:w,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:a,onChange:T=>l(T.target.value),placeholder:"Email",required:!0,disabled:k}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:d,onChange:T=>u(T.target.value),placeholder:"Password",required:!0,disabled:k}),r.jsx("i",{className:"fas fa-lock"})]}),f&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:f}),r.jsx("button",{type:"submit",disabled:k,children:k?"Logging in...":"Log in"}),r.jsx("p",{children:r.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),b()},children:"Forgotten password?"})}),r.jsx("p",{className:"modal-footer-text",children:r.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),N()},children:"Create new account"})})]})]})}),"// Notification Modal",r.jsx(Ur,{isOpen:g.isOpen,type:g.type,title:g.title,message:g.message,onClose:()=>y({...g,isOpen:!1})}),r.jsx(O1,{isOpen:x,userEmail:localStorage.getItem("userEmail")||a,onClose:()=>{C(!1),y({isOpen:!0,type:"success",title:"Login Successful! ",message:"Your profile has been updated. Welcome!"}),setTimeout(()=>{t(!1),y({...g,isOpen:!1})},1500)},onSuccess:()=>{console.log(" Profile updated successfully after login"),C(!1)}})]})}function z1(){const{showRegister:e,setShowRegister:t,register:n}=Ms(),{user:s,logout:o,setShowLogin:a}=Ms(),[l,d]=_.useState(""),[u,f]=_.useState(""),[m,g]=_.useState(""),[y,k]=_.useState(""),[v,x]=_.useState(""),[C,j]=_.useState({isOpen:!1,type:"info",title:"",message:""}),[w,N]=_.useState(!1);if(!e&&!C.isOpen)return null;async function b(T){var I,R;T.preventDefault(),x(""),N(!0);try{console.log(" Registering user:",u),await n(l,u,m,y),j({isOpen:!0,type:"success",title:"Account Created Successfully! ",message:`Your account has been created.
Email: ${u}

You can now login and complete your profile.`,autoCloseMs:2500}),d(""),f(""),g(""),k(""),setTimeout(()=>{console.log(" Registration complete - closing register modal"),t(!1)},500)}catch(B){console.error(" Registration error:",B);const A=B.message||((R=(I=B.response)==null?void 0:I.data)==null?void 0:R.message)||"Registration failed";x(A),j({isOpen:!0,type:"error",title:"Registration Failed ",message:A,autoCloseMs:3e3})}finally{N(!1)}}return r.jsxs(r.Fragment,{children:[e&&r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),r.jsx("h2",{children:"Create a new account"}),r.jsxs("form",{onSubmit:b,children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:l,onChange:T=>d(T.target.value),placeholder:"Full Name",required:!0,disabled:w}),r.jsx("i",{className:"fas fa-user"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"email",value:u,onChange:T=>f(T.target.value),placeholder:"Email",required:!0,disabled:w}),r.jsx("i",{className:"fas fa-envelope"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{value:m,onChange:T=>g(T.target.value),placeholder:"Phone",required:!0,disabled:w}),r.jsx("i",{className:"fas fa-phone"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",value:y,onChange:T=>k(T.target.value),placeholder:"Password",required:!0,disabled:w}),r.jsx("i",{className:"fas fa-lock"})]}),v&&r.jsx("div",{style:{color:"red",marginBottom:"10px"},children:v}),r.jsx("button",{type:"submit",disabled:w,children:w?"Creating Account...":"Sign Up"}),r.jsx("p",{className:"modal-footer-text",children:r.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),a(!0),t(!1)},children:"Already have an account?"})})]})]})}),r.jsx(Ur,{isOpen:C.isOpen,type:C.type,title:C.title,message:C.message,onClose:()=>j({...C,isOpen:!1})})]})}function $1(){const{showForgotPassword:e,setShowForgotPassword:t}=Ms(),[n,s]=_.useState(""),[o,a]=_.useState(""),[l,d]=_.useState(null),[u,f]=_.useState(!1);if(!e)return null;const m=async g=>{var y,k;g.preventDefault(),f(!0),d(null),a("");try{const v=await yt.forgotPassword(n);v.data.isSuccess?a(v.data.message||"Request is sent successfully. Please check your email."):d(v.data.message||"An error occurred. Please try again.")}catch(v){d(((k=(y=v.response)==null?void 0:y.data)==null?void 0:k.message)||"An error occurred. Please try again.")}finally{f(!1)}};return r.jsx("div",{className:"modal-overlay",style:{display:"flex"},children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-btn",onClick:()=>t(!1),children:""}),r.jsx("br",{}),r.jsxs("form",{onSubmit:m,children:[r.jsx("h3",{children:"Type your email"}),o&&r.jsxs("p",{style:{color:"green"},children:[" ",o]}),l&&r.jsxs("p",{style:{color:"red"},children:[" ",l]}),r.jsx("input",{type:"email",placeholder:"Your email",value:n,onChange:g=>s(g.target.value),required:!0}),r.jsx("button",{type:"submit",disabled:u,children:u?"Sending...":"Send Request"})]})]})})}const W1=Mg(document.getElementById("root"));W1.render(r.jsx(L1,{children:r.jsxs(Bj,{children:[r.jsx(U1,{}),r.jsx(D1,{}),r.jsx(z1,{}),r.jsx($1,{})]})}));
