# üöó H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng APIs Cho Ng∆∞·ªùi Thu√™ Xe (EV Renter)

## üìã M·ª•c L·ª•c
1. [T·ªïng Quan](#t·ªïng-quan)
2. [X√°c Th·ª±c (Authentication)](#x√°c-th·ª±c)
3. [T√¨m Ki·∫øm Xe](#t√¨m-ki·∫øm-xe)
4. [Quy Tr√¨nh ƒê·∫∑t Xe](#quy-tr√¨nh-ƒë·∫∑t-xe)
5. [Nh·∫≠n Xe (Check-in)](#nh·∫≠n-xe-check-in)
6. [Tr·∫£ Xe (Check-out)](#tr·∫£-xe-check-out)
7. [Qu·∫£n L√Ω Booking](#qu·∫£n-l√Ω-booking)

---

## üåü T·ªïng Quan

H·ªá th·ªëng EV Station-based Rental System cung c·∫•p c√°c APIs cho ph√©p ng∆∞·ªùi thu√™ xe:
- ‚úÖ T√¨m ki·∫øm v√† xem th√¥ng tin xe c√≥ s·∫µn
- ‚úÖ ƒê·∫∑t xe tr∆∞·ªõc ho·∫∑c ƒë·∫øn tr·ª±c ti·∫øp t·∫°i ƒëi·ªÉm
- ‚úÖ Check-in nh·∫≠n xe v·ªõi h·ª£p ƒë·ªìng ƒëi·ªán t·ª≠
- ‚úÖ Check-out tr·∫£ xe v√† thanh to√°n c√°c chi ph√≠ ph√°t sinh

### URL C∆° S·ªü
```
http://localhost:5054/api
```

### Swagger UI
```
http://localhost:5054/swagger
```

---

## üîê X√°c Th·ª±c (Authentication)

### 1. ƒêƒÉng K√Ω T√†i Kho·∫£n

**Endpoint:** `POST /api/Auth/Register`

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "Password123!",
  "fullName": "Nguy·ªÖn VƒÉn A",
  "phoneNumber": "0123456789"
}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "User registered successfully",
  "data": {
    "id": "guid-here",
    "email": "user@example.com",
    "firstName": "Nguy·ªÖn VƒÉn",
    "lastName": "A",
    "phoneNumber": "0123456789",
    "userRole": "EV Renter",
    "isActive": true,
    "createdAt": "2025-01-14T10:00:00Z"
  }
}
```

### 2. ƒêƒÉng Nh·∫≠p

**Endpoint:** `POST /api/Auth/Login`

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "Password123!"
}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "Login successful",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "refresh-token-here",
    "user": {
      "id": "guid-here",
      "email": "user@example.com",
      "firstName": "Nguy·ªÖn VƒÉn",
      "lastName": "A",
      "userRole": "EV Renter"
    }
  }
}
```

**‚ö†Ô∏è L∆∞u √Ω:** S·ª≠ d·ª•ng `token` trong header `Authorization: Bearer {token}` cho c√°c request ti·∫øp theo.

---

## üîç T√¨m Ki·∫øm Xe

### 1. Xem Danh S√°ch Xe C√≥ S·∫µn

**Endpoint:** `GET /api/Cars/Search-Available`

**Query Parameters:**
| Tham s·ªë | Lo·∫°i | B·∫Øt bu·ªôc | M√¥ t·∫£ |
|---------|------|----------|-------|
| stationId | Guid | Kh√¥ng | L·ªçc theo tr·∫°m c·ª• th·ªÉ |
| brand | string | Kh√¥ng | L·ªçc theo h√£ng xe (VinFast, Tesla, ...) |
| model | string | Kh√¥ng | L·ªçc theo model xe |
| minPrice | decimal | Kh√¥ng | Gi√° thu√™ t·ªëi thi·ªÉu (VNƒê/gi·ªù) |
| maxPrice | decimal | Kh√¥ng | Gi√° thu√™ t·ªëi ƒëa (VNƒê/gi·ªù) |
| minBatteryLevel | decimal | Kh√¥ng | M·ª©c pin t·ªëi thi·ªÉu (%) |
| page | int | Kh√¥ng | Trang hi·ªán t·∫°i (m·∫∑c ƒë·ªãnh: 1) |
| pageSize | int | Kh√¥ng | S·ªë l∆∞·ª£ng/trang (m·∫∑c ƒë·ªãnh: 20) |

**Example Request:**
```http
GET /api/Cars/Search-Available?brand=VinFast&minBatteryLevel=80&minPrice=50000&maxPrice=150000
Authorization: Bearer {your-token}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "Found 5 available cars",
  "data": [
    {
      "id": "car-guid-1",
      "brand": "VinFast",
      "model": "VF e34",
      "year": 2024,
      "color": "Tr·∫Øng",
      "licensePlate": "30A-12345",
      "batteryCapacity": 42.0,
      "currentBatteryLevel": 95.0,
      "rentalPricePerHour": 100000,
      "isAvailable": true,
      "currentStationId": "station-guid",
      "currentStationName": "Tr·∫°m Qu·∫≠n 1",
      "isActive": true
    }
  ]
}
```

### 2. Xem Xe T·∫°i M·ªôt Tr·∫°m

**Endpoint:** `GET /api/Cars/Get-Available-By-Station/{stationId}`

**Example Request:**
```http
GET /api/Cars/Get-Available-By-Station/station-guid-here
Authorization: Bearer {your-token}
```

### 3. Xem Chi Ti·∫øt M·ªôt Xe

**Endpoint:** `GET /api/Cars/Get-By-{id}`

**Example Request:**
```http
GET /api/Cars/Get-By-car-guid-here
Authorization: Bearer {your-token}
```

---

## üìÖ Quy Tr√¨nh ƒê·∫∑t Xe

### B∆∞·ªõc 1: T·∫°o Booking

**Endpoint:** `POST /api/Bookings/Create`

**üéØ H·ªó tr·ª£ 2 lo·∫°i ƒë·∫∑t xe:**
1. **ƒê·∫∑t tr∆∞·ªõc:** `pickupDateTime` trong t∆∞∆°ng lai
2. **ƒê·∫øn tr·ª±c ti·∫øp (Walk-in):** `pickupDateTime` = th·ªùi gian hi·ªán t·∫°i ho·∫∑c trong v√≤ng 30 ph√∫t

**Request:**
```http
POST /api/Bookings/Create?userId=your-user-id
Authorization: Bearer {your-token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "carId": "car-guid-here",
  "pickupStationId": "station-guid-here",
  "returnStationId": "station-guid-here",
  "pickupDateTime": "2025-01-15T10:00:00Z",
  "expectedReturnDateTime": "2025-01-15T18:00:00Z"
}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "",
  "data": {
    "bookingId": "booking-guid",
    "userId": "user-guid",
    "carId": "car-guid",
    "carInfo": "VinFast VF e34 (30A-12345)",
    "pickupStationName": "Tr·∫°m Qu·∫≠n 1",
    "pickupDateTime": "2025-01-15T10:00:00Z",
    "expectedReturnDateTime": "2025-01-15T18:00:00Z",
    "bookingStatus": "Pending",
    "totalAmount": 800000,
    "paymentStatus": "Pending"
  }
}
```

### B∆∞·ªõc 2: X√°c Nh·∫≠n Sau Thanh To√°n

**Endpoint:** `POST /api/Bookings/Confirm`

**Request Body:**
```json
{
  "bookingId": "booking-guid-here",
  "paymentMethod": "VNPay",
  "paymentTransactionId": "TXN123456789"
}
```

**Response:**
```json
{
  "isSuccess": true,
  "data": {
    "bookingId": "booking-guid",
    "bookingStatus": "Confirmed",
    "paymentStatus": "Paid",
    "totalAmount": 800000
  }
}
```

---

## üöò Nh·∫≠n Xe (Check-in)

### B∆∞·ªõc 3: Check-in T·∫°i Tr·∫°m

**Endpoint:** `POST /api/Bookings/Check-In`

**üìù Quy tr√¨nh:**
1. ‚úÖ ƒê·∫øn tr·∫°m ƒë√∫ng gi·ªù h·∫πn
2. ‚úÖ X√°c nh·∫≠n v·ªõi nh√¢n vi√™n
3. ‚úÖ Ki·ªÉm tra t√¨nh tr·∫°ng xe
4. ‚úÖ Ch·ª•p ·∫£nh xe (t√πy ch·ªçn)
5. ‚úÖ K√Ω h·ª£p ƒë·ªìng ƒëi·ªán t·ª≠ (t·ª± ƒë·ªông t·∫°o)
6. ‚úÖ Nh·∫≠n xe

**Request Body:**
```json
{
  "bookingId": "booking-guid-here",
  "checkInNotes": "Xe trong t√¨nh tr·∫°ng t·ªët, ƒë·∫ßy ƒë·ªß ph·ª• ki·ªán",
  "checkInPhotoUrl": "https://storage.example.com/check-in-photos/photo1.jpg"
}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "Check-in th√†nh c√¥ng. H·ª£p ƒë·ªìng ƒë√£ ƒë∆∞·ª£c t·∫°o.",
  "data": {
    "bookingId": "booking-guid",
    "bookingStatus": "CheckedIn",
    "actualStartTime": "2025-01-15T10:05:00Z",
    "contractId": "contract-guid-here"
  }
}
```

**‚ö†Ô∏è L∆∞u √Ω:**
- Ph·∫£i c√≥ tr·∫°ng th√°i `Confirmed` m·ªõi ƒë∆∞·ª£c check-in
- H·ª£p ƒë·ªìng ƒëi·ªán t·ª≠ ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông
- L∆∞u URL ·∫£nh ƒë·ªÉ l√†m b·∫±ng ch·ª©ng khi c·∫ßn

---

## üèÅ Tr·∫£ Xe (Check-out)

### B∆∞·ªõc 4: Check-out T·∫°i Tr·∫°m

**Endpoint:** `POST /api/Bookings/Check-Out`

**üìù Quy tr√¨nh:**
1. ‚úÖ Tr·∫£ xe ƒë√∫ng ƒëi·ªÉm (ho·∫∑c ƒëi·ªÉm kh√°c n·∫øu ƒë∆∞·ª£c ph√©p)
2. ‚úÖ Nh√¢n vi√™n ki·ªÉm tra t√¨nh tr·∫°ng xe
3. ‚úÖ Ch·ª•p ·∫£nh xe khi tr·∫£
4. ‚úÖ T√≠nh ph√≠ tr·ªÖ h·∫°n (n·∫øu c√≥)
5. ‚úÖ T√≠nh ph√≠ h∆∞ h·ªèng (n·∫øu c√≥)

**Request Body:**
```json
{
  "bookingId": "booking-guid-here",
  "checkOutNotes": "Xe tr·∫£ ƒë√∫ng gi·ªù, kh√¥ng c√≥ h∆∞ h·ªèng",
  "checkOutPhotoUrl": "https://storage.example.com/check-out-photos/photo1.jpg",
  "lateFee": 0,
  "damageFee": 0
}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "Check-out th√†nh c√¥ng",
  "data": {
    "bookingId": "booking-guid",
    "bookingStatus": "CheckedOut",
    "actualReturnDateTime": "2025-01-15T18:00:00Z",
    "totalAmount": 800000,
    "lateFee": 0,
    "damageFee": 0,
    "finalAmount": 800000,
    "paymentStatus": "Pending"
  }
}
```

**üí∞ T√≠nh Ph√≠ Ph√°t Sinh:**

| Lo·∫°i Ph√≠ | C√°ch T√≠nh |
|----------|-----------|
| **Ph√≠ tr·ªÖ h·∫°n** | M·ªói gi·ªù tr·ªÖ = gi√° thu√™ theo gi·ªù √ó 1.5 |
| **Ph√≠ h∆∞ h·ªèng** | Do nh√¢n vi√™n ƒë√°nh gi√° |
| **T·ªïng c·ªông** | TotalAmount + LateFee + DamageFee |

### B∆∞·ªõc 5: Ho√†n T·∫•t Booking

**Endpoint:** `POST /api/Bookings/Complete-By-{bookingId}`

**Request:**
```http
POST /api/Bookings/Complete-By-booking-guid-here
Authorization: Bearer {your-token}
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "Booking ƒë√£ ho√†n t·∫•t",
  "data": {
    "bookingId": "booking-guid",
    "bookingStatus": "Completed",
    "paymentStatus": "Paid",
    "finalAmount": 800000
  }
}
```

---

## üìä Qu·∫£n L√Ω Booking

### 1. Xem Booking ƒêang Ho·∫°t ƒê·ªông

**Endpoint:** `GET /api/Bookings/Get-Active-By-User/{userId}`

**Response:**
```json
{
  "isSuccess": true,
  "data": {
    "bookingId": "booking-guid",
    "bookingStatus": "CheckedIn",
    "car": {
      "brand": "VinFast",
      "model": "VF e34",
      "licensePlate": "30A-12345"
    },
    "pickupStation": {
      "name": "Tr·∫°m Qu·∫≠n 1",
      "address": "123 Nguy·ªÖn Hu·ªá, Q1, HCM"
    }
  }
}
```

### 2. Xem L·ªãch S·ª≠ ƒê·∫∑t Xe

**Endpoint:** `GET /api/Bookings/Get-History-By-User/{userId}`

**Response:**
```json
{
  "isSuccess": true,
  "data": [
    {
      "bookingId": "booking-guid-1",
      "carInfo": "VinFast VF e34 (30A-12345)",
      "pickupStationName": "Tr·∫°m Qu·∫≠n 1",
      "pickupDateTime": "2025-01-10T10:00:00Z",
      "actualReturnDateTime": "2025-01-10T18:00:00Z",
      "totalAmount": 800000,
      "bookingStatus": "Completed"
    }
  ]
}
```

### 3. H·ªßy Booking

**Endpoint:** `POST /api/Bookings/Cancel-By-{id}`

**Request:**
```http
POST /api/Bookings/Cancel-By-booking-guid?userId=your-user-id
Authorization: Bearer {your-token}
Content-Type: application/json

"L√Ω do h·ªßy: C√≥ vi·ªác ƒë·ªôt xu·∫•t"
```

**Response:**
```json
{
  "isSuccess": true,
  "message": "Booking ƒë√£ ƒë∆∞·ª£c h·ªßy",
  "data": "Cancelled"
}
```

**‚ö†Ô∏è Ch√≠nh S√°ch H·ªßy:**
- H·ªßy tr∆∞·ªõc 24h: Ho√†n ti·ªÅn 100%
- H·ªßy tr∆∞·ªõc 12h: Ho√†n ti·ªÅn 50%
- H·ªßy trong v√≤ng 12h: Kh√¥ng ho√†n ti·ªÅn

### 4. T√≠nh To√°n Chi Ph√≠

**Endpoint:** `GET /api/Bookings/Calculate-Cost`

**Query Parameters:**
```
?carId=car-guid&startTime=2025-01-15T10:00:00Z&endTime=2025-01-15T18:00:00Z
```

**Response:**
```json
{
  "isSuccess": true,
  "data": 800000,
  "message": "Estimated cost for 8 hours"
}
```

---

## üì± Flow Diagram - Quy Tr√¨nh Ho√†n Ch·ªânh

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. ƒêƒÇNG K√ù/ƒêƒÇNG NH·∫¨P                                        ‚îÇ
‚îÇ    POST /api/Auth/Register ho·∫∑c /api/Auth/Login            ‚îÇ
‚îÇ    ‚ûú Nh·∫≠n JWT Token                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. T√åM KI·∫æM XE                                              ‚îÇ
‚îÇ    GET /api/Cars/Search-Available                           ‚îÇ
‚îÇ    ‚ûú Ch·ªçn xe ph√π h·ª£p (lo·∫°i, gi√°, pin, tr·∫°m)                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. T·∫†O BOOKING                                              ‚îÇ
‚îÇ    POST /api/Bookings/Create                                ‚îÇ
‚îÇ    ‚ûú Status: Pending                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. THANH TO√ÅN & X√ÅC NH·∫¨N                                    ‚îÇ
‚îÇ    POST /api/Bookings/Confirm                               ‚îÇ
‚îÇ    ‚ûú Status: Confirmed                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. CHECK-IN (NH·∫¨N XE)                                       ‚îÇ
‚îÇ    POST /api/Bookings/Check-In                              ‚îÇ
‚îÇ    ‚ûú Ki·ªÉm tra xe, ch·ª•p ·∫£nh, k√Ω h·ª£p ƒë·ªìng                    ‚îÇ
‚îÇ    ‚ûú Status: CheckedIn                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 6. S·ª¨ D·ª§NG XE                                               ‚îÇ
‚îÇ    ‚è±Ô∏è Th·ªùi gian s·ª≠ d·ª•ng                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 7. CHECK-OUT (TR·∫¢ XE)                                       ‚îÇ
‚îÇ    POST /api/Bookings/Check-Out                             ‚îÇ
‚îÇ    ‚ûú Ki·ªÉm tra xe, t√≠nh ph√≠ ph√°t sinh                       ‚îÇ
‚îÇ    ‚ûú Status: CheckedOut                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 8. HO√ÄN T·∫§T                                                 ‚îÇ
‚îÇ    POST /api/Bookings/Complete-By-{bookingId}               ‚îÇ
‚îÇ    ‚ûú Thanh to√°n ph√≠ ph√°t sinh                              ‚îÇ
‚îÇ    ‚ûú Status: Completed                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚ö° V√≠ D·ª• Th·ª±c T·∫ø

### Scenario: Thu√™ xe VinFast VF e34 trong 1 ng√†y

#### 1. T√¨m xe ph√π h·ª£p
```bash
curl -X GET "http://localhost:5054/api/Cars/Search-Available?brand=VinFast&minBatteryLevel=80" \
  -H "Authorization: Bearer {your-token}"
```

#### 2. T·∫°o booking
```bash
curl -X POST "http://localhost:5054/api/Bookings/Create?userId={your-user-id}" \
  -H "Authorization: Bearer {your-token}" \
  -H "Content-Type: application/json" \
  -d '{
    "carId": "{car-id}",
    "pickupStationId": "{station-id}",
    "pickupDateTime": "2025-01-15T08:00:00Z",
    "expectedReturnDateTime": "2025-01-15T20:00:00Z"
  }'
```

#### 3. X√°c nh·∫≠n booking
```bash
curl -X POST "http://localhost:5054/api/Bookings/Confirm" \
  -H "Authorization: Bearer {your-token}" \
  -H "Content-Type: application/json" \
  -d '{
    "bookingId": "{booking-id}",
    "paymentMethod": "VNPay",
    "paymentTransactionId": "TXN123"
  }'
```

#### 4. Check-in
```bash
curl -X POST "http://localhost:5054/api/Bookings/Check-In" \
  -H "Authorization: Bearer {your-token}" \
  -H "Content-Type: application/json" \
  -d '{
    "bookingId": "{booking-id}",
    "checkInNotes": "Xe t·ªët",
    "checkInPhotoUrl": "https://example.com/photo.jpg"
  }'
```

#### 5. Check-out
```bash
curl -X POST "http://localhost:5054/api/Bookings/Check-Out" \
  -H "Authorization: Bearer {your-token}" \
  -H "Content-Type: application/json" \
  -d '{
    "bookingId": "{booking-id}",
    "checkOutNotes": "Tr·∫£ xe ƒë√∫ng gi·ªù",
    "lateFee": 0,
    "damageFee": 0
  }'
```

---

## üÜò X·ª≠ L√Ω L·ªói Th∆∞·ªùng G·∫∑p

| M√£ L·ªói | Nguy√™n Nh√¢n | Gi·∫£i Ph√°p |
|---------|-------------|-----------|
| 401 Unauthorized | Token h·∫øt h·∫°n | L√†m m·ªõi token b·∫±ng `/api/Auth/Refresh-Token` |
| 400 Bad Request | D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá | Ki·ªÉm tra l·∫°i request body |
| 404 Not Found | Kh√¥ng t√¨m th·∫•y t√†i nguy√™n | Ki·ªÉm tra l·∫°i ID |
| 409 Conflict | Xe ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t | Ch·ªçn xe kh√°c ho·∫∑c th·ªùi gian kh√°c |

---

## üìû H·ªó Tr·ª£

N·∫øu c·∫ßn h·ªó tr·ª£, vui l√≤ng li√™n h·ªá:
- üìß Email: support@evstation.com
- üì± Hotline: 1900-xxxx
- üåê Website: https://evstation.com

---

**Phi√™n b·∫£n:** 1.0  
**C·∫≠p nh·∫≠t l·∫ßn cu·ªëi:** 14/01/2025

